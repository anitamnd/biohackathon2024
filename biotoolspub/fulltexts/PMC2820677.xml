<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2820677</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp692</article-id>
    <article-id pub-id-type="publisher-id">btp692</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Bo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruotti</surname>
          <given-names>Victor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>Ron M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomson</surname>
          <given-names>James A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dewey</surname>
          <given-names>Colin N.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Department of Computer Sciences, University of Wisconsin, Madison, WI 53706, <sup>2</sup> Morgridge Institute for Research, Madison, WI 53707 and <sup>3</sup> Department of Biostatistics and Medical Informatics, University of Wisconsin, Madison, WI 53706, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Joaquin Dopazo</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>12</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>4</issue>
    <fpage>493</fpage>
    <lpage>500</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>11</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>12</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2009. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> RNA-Seq is a promising new technology for accurately measuring gene expression levels. Expression estimation with RNA-Seq requires the mapping of relatively short sequencing reads to a reference genome or transcript set. Because reads are generally shorter than transcripts from which they are derived, a single read may map to multiple genes and isoforms, complicating expression analyses. Previous computational methods either discard reads that map to multiple locations or allocate them to genes heuristically.</p>
      <p><bold>Results:</bold> We present a generative statistical model and associated inference methods that handle read mapping uncertainty in a principled manner. Through simulations parameterized by real RNA-Seq data, we show that our method is more accurate than previous methods. Our improved accuracy is the result of handling read mapping uncertainty with a statistical model and the estimation of gene expression levels as the sum of isoform expression levels. Unlike previous methods, our method is capable of modeling non-uniform read distributions. Simulations with our method indicate that a read length of 20–25 bases is optimal for gene-level expression estimation from mouse and maize RNA-Seq data when sequencing throughput is fixed.</p>
      <p><bold>Availability:</bold> An initial C++ implementation of our method that was used for the results presented in this article is available at <ext-link ext-link-type="uri" xlink:href="http://deweylab.biostat.wisc.edu/rsem">http://deweylab.biostat.wisc.edu/rsem</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>cdewey@biostat.wisc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary data</ext-link> are available at Bioinformatics on</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Taking advantage of rapidly advancing sequencing technology, researchers are now using high-throughput sequencers to measure gene expression with a protocol called RNA-Seq (Nagalakshmi <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2008</xref>; Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2009</xref>). RNA-Seq is the transcriptome analog to whole-genome shotgun sequencing (Staden, <xref ref-type="bibr" rid="B16">1979</xref>), with a key difference being that RNA-Seq is primarily used for estimating the copy number of transcripts in a sample. The main steps in the protocol are (i) RNA is isolated from a sample, (ii) RNA is converted to cDNA fragments via reverse-transcription and fragmentation, (iii) a high-throughput sequencer [such as those from Illumina (San Diego, CA, USA), Applied Biosystems (Foster City, CA, USA) and Roche 454 Life Science (Branford, CT, USA)] is used to generate millions of reads from the cDNA fragments, (iv) reads are mapped to a reference genome or transcript set with an alignment tool and (v) counts of reads mapped to each gene are used to estimate expression levels. Because the primary outputs of RNA-Seq are counts of reads, they are referred to as ‘digital’ gene expression measurements, as opposed to the ‘analog’ fluorescence intensities from microarrays.</p>
    <p>RNA-Seq is a promising replacement for microarrays as initial studies have shown that RNA-Seq expression estimates are highly reproducible (Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>) and often more accurate, based on quantitative PCR (qPCR) and spike-in experiments (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>; Nagalakshmi <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2008</xref>). Although still a young technology, RNA-Seq has matured enough to be used in studies of transcription in yeast (Nagalakshmi <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2008</xref>), <italic>Arabidopsis</italic> (Lister <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2008</xref>), mouse (Cloonan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>), and human (Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>; Morin <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2008</xref>). The primary advantages of RNA-Seq are its large dynamic range (spanning five orders of magnitude), low background noise, requirement of less sample RNA and ability to detect novel transcripts, even in the absence of a sequenced genome (Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2009</xref>). To allow the technology to reach its full potential, a number of experimental and computational challenges need to be addressed, including the handling of read mapping uncertainty, sequencing non-uniformity, estimation of potentially novel isoform (alternatively spliced transcript) expression levels and efficient storage and alignment of RNA-Seq reads.</p>
    <p>In this article, we present our work in addressing the computational issue of read mapping uncertainty. Because RNA-Seq reads do not span entire transcripts, the transcripts from which they are derived are not always uniquely determined. Paralogous gene families, low-complexity sequence and high sequence similarity between alternatively spliced isoforms of the same gene are primary factors contributing to mapping uncertainty. In addition, polymorphisms, reference sequence errors and sequencing errors require that mismatches and indels be allowed in read alignments and further contribute to lower our confidence in mappings. Due to these factors, a significant number of reads are <italic>multireads</italic>: reads that have high-scoring alignments to multiple positions in a reference genome or transcript set (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>). We will refer to reads that map to multiple genes as <italic>gene multireads</italic> and reads that map to a single gene but multiple isoforms as <italic>isoform multireads</italic>. The fraction of mappable reads that are gene multireads varies and depends on the transcriptome and read length. For the datasets we analyzed, this fraction ranged between 17% (mouse) and 52% (maize), representing a significant proportion of RNA-Seq data.</p>
    <p>Two strategies have been previously used for handling gene multireads. The first simply discards them, keeping only uniquely mapping reads for expression estimation (Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>; Nagalakshmi <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2008</xref>). A slightly more sophisticated method using only uniquely mapping reads adjusts exon coverage by the fraction of exon positions that would give rise to uniquely mapping reads (Morin <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2008</xref>). A second strategy has been to ‘rescue’ multireads by allocating fractions of them to genes in proportion to coverage by uniquely mapping reads (Faulkner <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2008</xref>; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>). These rescue strategies have been shown to give expression estimates that are in better agreement with microarrays than those from only using uniquely mapping reads (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>). A more recent method handles isoform multireads by explicitly estimating isoform expression levels but does not handle gene multireads (Jiang and Wong, <xref ref-type="bibr" rid="B7">2009</xref>).</p>
    <p>We present a method for estimating expression in the presence of multireads that treats mapping uncertainty in a statistically rigorous manner. Using a generative model of RNA-Seq data, we unify the notions of gene and isoform multireads through latent random variables representing the true mappings. Model parameters correspond to isoform expression levels, read distributions across transcripts and sequencing error. We estimate maximum likelihood (ML) expression levels using an Expectation–Maximization (EM) algorithm and show that previous rescue methods are roughly equivalent to one iteration of EM. Our inference method can be thought of as the RNA-Seq analog of methods for correcting for SAGE sequencing errors (Beissbarth <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2004</xref>) and microarray cross-hybridization (Kapur <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2008</xref>).</p>
    <p>Like the statistical method of Jiang and Wong (<xref ref-type="bibr" rid="B7">2009</xref>), our model can be used to estimate individual isoform expression levels. In contrast with their method, our method incorporates gene multireads into a statistical model and does not require knowledge of which isoforms share exonic sequence. In addition, our model can accommodate non-uniform read distributions across transcripts (e.g. 3′ biases), which may be simultaneously learned from the data.</p>
    <p>Results from simulations with parameters derived from real data indicate that our method gives more accurate gene expression estimates than those using only unique reads or rescue strategies. We show that estimation of gene expression levels as the sum of estimated isoform expression levels improves gene-level accuracy. We found a slight 3′ bias in the read distributions of a real dataset and determined that taking such non-uniformities into account can improve accuracy, depending on the strength of the bias. Last, through simulations with varying read lengths, we show that the optimal length for RNA-Seq is around 20–25 bases for the mouse and maize transcriptomes when our method is used to handle multireads.</p>
    <sec id="SEC1.1">
      <title>1.1 Problem statement</title>
      <p>The goal of expression analysis is to estimate a <italic>transcriptome</italic>: the set of all expressed transcripts and their frequencies in a cell at a given time. By itself, RNA-Seq data allow us to estimate the <italic>relative</italic> expression levels of isoforms in a sample. Combined with accurate physical sample size or spike-in measurements, absolute expression may be estimated (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>), but that is a separate issue that we will not discuss here.</p>
      <p>There are two natural measures of relative expression: the <italic>fraction of transcripts</italic> and the <italic>fraction of nucleotides</italic> of the transcriptome made up by a given gene or isoform. For isoform <italic>i</italic>, we will denote these two quantities by τ<sub><italic>i</italic></sub> and ν<sub><italic>i</italic></sub>, respectively. At the isoform level, these quantities are related by the equations
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btp692m1"/></disp-formula>
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btp692m2"/></disp-formula>
where ℓ<sub><italic>i</italic></sub> is the length, in nucleotides, of isoform <italic>i</italic>. At the gene level, expression is simply the sum of the expression of possible isoforms. For ease of notation, we give expression levels in terms of <italic>nucleotides per million</italic> (NPM) and <italic>transcripts per million</italic> (TPM), which are obtained by multiplying ν and τ by 10<sup>6</sup>, respectively.</p>
      <p>The problem addressed in this article is that of using a set of RNA-Seq data to estimate the ν and τ values for a set of previously identified isoforms and genes. We assume that the RNA-Seq data comes in the form of <italic>N</italic> sequence reads, each of length <italic>L</italic>. Reference sequences, but not necessarily genomic coordinates, are assumed to be available for all <italic>M</italic> isoforms. Sequence clustering or genomic coordinates may be used to group isoforms into genes, if desired.</p>
      <p>The fundamental assumption of RNA-Seq is that the fraction of reads derived from isoform <italic>i</italic> is a function of ν<sub><italic>i</italic></sub>. Assuming uniformly distributed reads, all of which can be assigned to isoforms, and poly(A)+mRNA, we have that <italic>c</italic><sub><italic>i</italic></sub>/<italic>N</italic> approaches ν<sub><italic>i</italic></sub> as <italic>N</italic>→∞, where <italic>c</italic><sub><italic>i</italic></sub> is the number of reads from isoform <italic>i</italic>. Even if reads are not uniformly distributed along the lengths of isoforms, so long as they are sampled in proportion to ν<sub><italic>i</italic></sub>, this result still holds.</p>
      <sec id="SEC1.1.1">
        <title>1.1.1 Comparison to RPKM estimation</title>
        <p>We compare the problem of estimating ν and τ values with that of computing expression in terms of <italic>reads per kilobase per million mapped reads</italic> (RPKM; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>). The measured level of isoform <italic>i</italic>, in RPKM, is defined as 10<sup>9</sup> × <italic>c</italic><sub><italic>i</italic></sub>/(<italic>N</italic><sub><italic>m</italic></sub>ℓ<sub><italic>i</italic></sub>), where <italic>c</italic><sub><italic>i</italic></sub> is the number of reads mapping to isoform <italic>i</italic>, <italic>N</italic><sub><italic>m</italic></sub> is the total number of mappable reads and ℓ<sub><italic>i</italic></sub> is the length of isoform <italic>i</italic>. Under the assumption of uniformly distributed reads, we note that RPKM measures are estimates of 10<sup>9</sup> × ν<sub><italic>i</italic></sub>/ℓ<sub><italic>i</italic></sub>, which is an unnormalized value of τ<sub><italic>i</italic></sub>. The normalization factor is
<disp-formula><graphic xlink:href="btp692um1"/></disp-formula>
which is proportional to the mean length of a transcript in the transcriptome. When the mean expressed transcript length is 1 kb, 1 TPM is equivalent to 1 RPKM, which corresponds to roughly one transcript per cell in mouse (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>).</p>
        <p>Because the mean expressed transcript length may vary between samples, we prefer the use of ν and τ over RPKM measures. For example, an isoform with the same fraction of transcripts in two samples will have different RPKM values if the expression of other genes changes such that the mean expressed transcript length differs. In addition, τ values are comparable between two species even if mRNA lengths tend to be larger in one of the species.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Generative model</title>
      <p>We estimate gene and isoform expression levels with a generative model of the RNA-Seq read sequencing process. We use the directed graphical model (Bayesian network) shown in <xref ref-type="fig" rid="F1">Figure 1</xref>. The model generates <italic>N</italic> i.i.d. reads of length <italic>L</italic>. The read sequences are represented by the <italic>R</italic><sub><italic>n</italic></sub> random variables and are the observed data. Each read is associated with three latent random variables, <italic>G</italic><sub><italic>n</italic></sub>, <italic>S</italic><sub><italic>n</italic></sub> and <italic>O</italic><sub><italic>n</italic></sub>, which represent the isoform, start position and orientation, respectively, from which the read was derived. The primary parameters of the model are θ=[θ<sub>0</sub>,…, θ<sub><italic>M</italic></sub>], which correspond to the expression levels. The complete data likelihood for this model is
<disp-formula><graphic xlink:href="btp692um2"/></disp-formula>
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>The graphical model for RNA-Seq data used by our method.</p></caption><graphic xlink:href="btp692f1"/></fig></p>
      <p>We assume that we are given all <italic>M</italic> isoforms that may be present in a transcriptome. The random variable <italic>G</italic><sub><italic>n</italic></sub> takes a value in [0, <italic>M</italic>], with the value 0 representing a ‘noise’ isoform, which generates reads that do not map to known isoforms. We let <italic>P</italic>(<italic>G</italic><sub><italic>n</italic></sub>=<italic>i</italic>|θ)=θ<sub><italic>i</italic></sub>, where ∑<sub><italic>i</italic></sub>θ<sub><italic>i</italic></sub>=1.</p>
      <p>The random variable <italic>S</italic><sub><italic>n</italic></sub> takes a value in [1, max<sub><italic>i</italic></sub>ℓ<sub><italic>i</italic></sub>], where ℓ<sub><italic>i</italic></sub> is the length of isoform <italic>i</italic>. We call <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>=<italic>j</italic>|<italic>G</italic><sub><italic>n</italic>=<italic>i</italic></sub>) the <italic>read start position distribution</italic> (RSPD). Assuming that reads are generated uniformly across transcripts, <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>=<italic>j</italic>|<italic>G</italic><sub><italic>n</italic></sub>=<italic>i</italic>)=ℓ<sub><italic>i</italic></sub><sup>−1</sup>. Here, we are also assuming that mRNAs have poly(A) tails, which allow for reads to start at the last positions of isoforms and extend into the poly(A) tails. For poly(A)- mRNA samples, the RSPD becomes <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>=<italic>j</italic>|<italic>G</italic><sub><italic>n</italic></sub>=<italic>i</italic>)=(ℓ<sub><italic>i</italic></sub>−<italic>L</italic>+1)<sup>−1</sup>. We present a non-uniform RSPD model in a following section.</p>
      <p>The random variable <italic>O</italic><sub><italic>n</italic></sub> is binary, with <italic>O</italic><sub><italic>n</italic></sub>=0 indicating that the sequence of read <italic>n</italic> is in the same orientation as that of its parent isoform, and <italic>O</italic><sub><italic>n</italic></sub>=1 indicating that it is reverse complemented. This random variable allows us to model RNA-Seq protocols that are not strand-specific, such as the one used in Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>). For such protocols, we set <italic>P</italic>(<italic>O</italic><sub><italic>n</italic></sub>=0|<italic>G</italic><sub><italic>n</italic></sub>≠0)=0.5. For strand-specific protocols, we may simply set <italic>P</italic>(<italic>O</italic><sub><italic>n</italic></sub>=0|<italic>G</italic><sub><italic>n</italic></sub>≠0)=1.</p>
      <p>The observed data of the model are the read sequences, which we represent by the <italic>R</italic><sub><italic>n</italic></sub> random variables. For simplicity of notation, we summarize the hidden random variables for the <italic>n</italic>-th read with a set of indicator random variables <italic>Z</italic><sub><italic>nijk</italic></sub>, where <italic>Z</italic><sub><italic>nijk</italic></sub>=1 if (<italic>G</italic><sub><italic>n</italic></sub>, <italic>S</italic><sub><italic>n</italic></sub>, <italic>O</italic><sub><italic>n</italic></sub>)=(<italic>i</italic>, <italic>j</italic>, <italic>k</italic>). When the protocol is strand-specific, we use variables <italic>Z</italic><sub><italic>nij</italic></sub>=<italic>Z</italic><sub><italic>nij</italic>0</sub>. The conditional probability of a read sequence derived from isoform <italic>i</italic>&gt;0 is given by
<disp-formula><graphic xlink:href="btp692um3"/></disp-formula>
where γ<sup><italic>i</italic></sup> is the sequence of isoform <italic>i</italic>, <inline-formula><inline-graphic xlink:href="btp692i1.jpg"/></inline-formula> is its reverse complement and <italic>w</italic><sub><italic>t</italic></sub>(<italic>a</italic>, <italic>b</italic>) is a position-specific substitution matrix. The value of <italic>w</italic><sub><italic>t</italic></sub>(<italic>a</italic>, <italic>b</italic>) is the probability that we observe character <italic>a</italic> at position <italic>t</italic> of the read given that the corresponding character in the reference isoform sequence is <italic>b</italic>. The conditional probability distributions given by the <italic>w</italic> matrices allow us to model read position and base-dependent substitution processes. For example, base-call errors are often more frequent in the last positions of a read, and thus <italic>w</italic><sub><italic>L</italic></sub> may give a higher substitution probability than <italic>w</italic><sub>1</sub>. In addition to sequencing error, factors such as polymorphism and reference sequence error may lead to observed substitutions between an isoform sequence and a derived read. Our current model does not distinguish between these processes and summarizes their effects through the <italic>w</italic> matrices.</p>
      <p>Reads derived from the ‘noise’ isoform (<italic>i</italic>=0) are generated from a position-independent background distribution, β, with
<disp-formula><graphic xlink:href="btp692um4"/></disp-formula>
The random variables <italic>S</italic><sub><italic>n</italic></sub> and <italic>O</italic><sub><italic>n</italic></sub> are irrelevant when <italic>G</italic><sub><italic>n</italic></sub>=0, and thus we set <italic>P</italic>(<italic>O</italic><sub><italic>n</italic></sub>=0|<italic>G</italic><sub><italic>n</italic></sub>=0)=1, <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>=1|<italic>G</italic><sub><italic>n</italic></sub>=0)=1 and ℓ<sub>0</sub>=1.</p>
      <sec id="SEC2.1.1">
        <title>2.1.1 Non-uniform RSPDs</title>
        <p>The distributions of read start positions are often non-uniform (Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2009</xref>). Such non-uniformity may be due to a variety of factors, including fragmentation protocols and composition biases (Dohm <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>). To take these non-uniformities into account, we allow the use of an empirical RSPD in our model. Currently, we use a RSPD that depends on the fraction along an isoform's length of a given start position. Specifically, we use
<disp-formula><graphic xlink:href="btp692um5"/></disp-formula>
where <italic>ecdf</italic><sub>RSPD</sub> is an empirical cumulative density function over [0, 1], represented as a piecewise linear function with <italic>B</italic> parameters, ϕ=ϕ<sub>1</sub>…ϕ<sub><italic>B</italic></sub>. We use one RSPD for all isoforms, as there is often not enough data to estimate these distributions for individual isoforms. This scheme allows us to model general phenomena, such as 5′ or 3′ biases, but does not take into account isoform-specific effects (e.g. sequence composition).</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Inference with the EM algorithm</title>
      <p>For isoform expression-level estimation, we are interested in inferring the values of the model parameters θ=[θ<sub>0</sub>, θ<sub>1</sub>,…, θ<sub><italic>M</italic></sub>]. Under the assumption that reads are uniformly sampled from the transcriptome, these parameters correspond to relative expression levels. With this assumption, we estimate ν<sub><italic>i</italic></sub> by <inline-formula><inline-graphic xlink:href="btp692i2.jpg"/></inline-formula> and use Equation (<xref ref-type="disp-formula" rid="M2">2</xref>) for converting to τ<sub><italic>i</italic></sub>.</p>
      <p>Given RNA-Seq data, we estimate expression levels by finding the values of θ that maximize the observed data likelihood:
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btp692m3"/></disp-formula>
Equation (<xref ref-type="disp-formula" rid="M3">3</xref>) shows that our goal is to find the ML proportions of a mixture model. We use the EM algorithm (Dempster <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">1977</xref>) to find the ML values for θ. We assume that all other parameters of the model, i.e. those involved in <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>G</italic><sub><italic>n</italic>=<italic>i</italic></sub>) are either fixed or estimated ahead of time. For fixed <italic>P</italic>(<italic>r</italic><sub><italic>n</italic></sub>|<italic>G</italic><sub><italic>n</italic>=<italic>i</italic></sub>), the observed data likelihood [Equation (<xref ref-type="disp-formula" rid="M3">3</xref>)] is concave (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Material</ext-link>), and thus the EM algorithm is guaranteed to find ML values. However, even with infinite data, it is possible for the parameters to be non-identifiable, depending on the structural relationships between isoforms (Lacroix <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>). Such a case would correspond to a plateau in the likelihood surface.</p>
      <p>The implementation of the EM algorithm for our model is straightforward and the details are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Material</ext-link>. A key aspect of the algorithm is the E-step: the computation of the expected values of the <italic>Z</italic><sub><italic>nij</italic></sub> (or <italic>Z</italic><sub><italic>nijk</italic></sub>) random variables, given the current parameter values, θ<sup>(<italic>t</italic>)</sup>. For a uniform RSPD and a strand-specific protocol, this computation is
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btp692m4"/></disp-formula></p>
      <sec id="SEC2.2.1">
        <title>2.2.1 Approximation via read alignment</title>
        <p>Due to the large number of reads, isoforms and read start positions, it is not practical to compute expected values for all <italic>Z</italic><sub><italic>nij</italic></sub>. Thus, we approximate the likelihood function by only allowing a small number of the <italic>Z</italic><sub><italic>nij</italic></sub> variables to be non-zero. To determine which variables to consider, we align the reads to the isoform sequences and keep all alignments with at most <italic>x</italic> mismatches. Letting π<sup><italic>x</italic></sup><sub><italic>n</italic></sub> denote the set of all (<italic>i</italic>, <italic>j</italic>) pairs for alignments of read <italic>n</italic> with at most <italic>x</italic> mismatches, and the noise pair (0, 1), we approximate the likelihood function by
<disp-formula><graphic xlink:href="btp692um6"/></disp-formula>
Equation (<xref ref-type="disp-formula" rid="M4">4</xref>) is similarly approximated by
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btp692m5"/></disp-formula>
Noting that θ<sup>(<italic>t</italic>)</sup><sub><italic>i</italic></sub>/ℓ<sub><italic>i</italic></sub> is proportional to the RPKM of isoform <italic>i</italic>, we observe that Equation (<xref ref-type="disp-formula" rid="M5">5</xref>) is roughly equivalent to the rescue scheme of Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>) when a read is considered to align equally well to all candidate positions in π<sub><italic>n</italic></sub> and the noise isoform is not considered. Thus, the rescue scheme can be thought of as a single iteration of the EM algorithm with initial parameters, θ<sup>(0)</sup>, derived from only uniquely mapping reads.</p>
        <p>To speed up computations, we also filter reads that align to a large number of positions and adjust our θ estimates to account for these discarded alignments (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Material</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Simulation experiments</title>
      <p>In the absence of RNA-Seq data from samples for which we know all true mRNA quantities, we performed simulations to validate our method and assess its performance with respect to other RNA-Seq expression-level estimators. We used our generative model to simulate reads from two reference transcript sets, one from mouse and the other from maize. The estimates from our method, as well as those from two other methods, were compared with the sample expression values in each simulation.</p>
      <sec id="SEC3.1.1">
        <title>3.1.1 Methods for comparison</title>
        <p>We compared the gene expression-level estimates of our method with those of two previously used methods for handling multireads. Neither of these prior methods is capable of estimating isoform expression levels, and thus we compared only gene expression estimates. The first and simplest method, <monospace>unique</monospace>, estimates expression solely from uniquely mapping reads. A read is considered to be uniquely mapped if it only aligns to isoforms of a single gene. This method computes expression levels as
<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btp692m6"/></disp-formula>
where <italic>c</italic><sub><italic>i</italic></sub><sup>uni</sup> is the number of uniquely mapping reads that map to gene <italic>i</italic> and <italic>c</italic><sup>uni</sup> is the total number of uniquely mapping reads. The transcript fractions are then computed by
<disp-formula id="M7"><label>(7)</label><graphic xlink:href="btp692m7"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btp692i3.jpg"/></inline-formula> is the effective length of gene <italic>i</italic>. For genes with a single isoform, <inline-formula><inline-graphic xlink:href="btp692i4.jpg"/></inline-formula> is simply the length of that isoform. For alternatively spliced genes, we take <inline-formula><inline-graphic xlink:href="btp692i5.jpg"/></inline-formula> to be the length of the union of all genomic intervals corresponding to exons of isoforms of gene <italic>i</italic>, as is done in the ERANGE software package (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>).</p>
        <p>A second method, which we call <monospace>rescue</monospace>, allocates multireads to genes in proportion to the τ<sub><italic>i</italic></sub><sup>uni</sup> values. This method was introduced in Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>) and is currently used in the ERANGE software package, as well as in the RSAT package (Jiang and Wong, <xref ref-type="bibr" rid="B7">2009</xref>). The <monospace>rescue</monospace> method computes the count for gene <italic>i</italic> as
<disp-formula id="M8"><label>(8)</label><graphic xlink:href="btp692m8"/></disp-formula>
where π<sub><italic>n</italic></sub> is the set of indices of genes to which read <italic>n</italic> maps. A multiread that maps only to genes for which τ<sup>uni</sup>=0 is divided evenly among those genes. The values of ν<sub><italic>i</italic></sub><sup>rescue</sup> and τ<sub><italic>i</italic></sub><sup>rescue</sup> are then calculated similarly to Equations (<xref ref-type="disp-formula" rid="M6">6</xref>) and (<xref ref-type="disp-formula" rid="M7">7</xref>).</p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Simulation procedure</title>
        <p>We first derived simulation parameters from the mouse liver RNA-Seq data described in Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>). Nucleotide fractions (ν) were computed from this data with the <monospace>rescue</monospace> method (so as to reduce the bias toward our method) and the mouse UCSC Genes (Hsu <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2006</xref>) as the reference gene set. For genes with multiple isoforms, these fractions were divided randomly amongst the isoforms. We estimated position-specific substitution matrices (<italic>w</italic><sub><italic>t</italic></sub>) from uniquely mapping reads and a ‘noise’ read model (β) from unmappable reads, which made up 46.2% of the data. We obtained read mappings by running the Bowtie aligner (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2009</xref>) with at most two mismatches allowed. Using these parameters, a uniform RSPD and a non-strand-specific model, we simulated 30 million reads of length 25 from the mouse reference gene set with our generative model.</p>
        <p>An additional simulation set with the same size and read length was generated from a maize gene set. We chose maize to assess how variations in genome repetitiveness affect expression estimation. The maize gene set used was release 3b.50 of the working gene set obtained from <ext-link ext-link-type="uri" xlink:href="http://maizesequence.org">http://maizesequence.org</ext-link>, with duplicate mRNAs removed. Expression levels for each maize gene were sampled, with replacement, from the mouse liver gene expression estimates.</p>
        <p>We mapped simulated reads with Bowtie, allowing at most two mismatches per alignment. <xref ref-type="table" rid="T1">Table 1</xref> summarizes the read mapping results on the real and simulated datasets. Gene multireads made up 17% and 52% of mappable reads in the mouse and maize datasets, respectively. The distribution of the numbers of genes and isoforms to which the reads mapped are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Figure 6</ext-link>.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Fractions of reads that are unmappable, map uniquely, map to multiple genes or are filtered in three RNA-Seq datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Dataset</th><th align="left" rowspan="1" colspan="1">% unmapped</th><th align="left" rowspan="1" colspan="1">% unique</th><th align="left" rowspan="1" colspan="1">% multi</th><th align="left" rowspan="1" colspan="1">% filtered</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">Mouse Real</td><td align="left" rowspan="1" colspan="1">46.2</td><td align="left" rowspan="1" colspan="1">44.4</td><td align="left" rowspan="1" colspan="1">9.2</td><td align="left" rowspan="1" colspan="1">0.2</td></tr><tr><td align="left" rowspan="1" colspan="1">Mouse Sim</td><td align="left" rowspan="1" colspan="1">47.6</td><td align="left" rowspan="1" colspan="1">43.2</td><td align="left" rowspan="1" colspan="1">8.7</td><td align="left" rowspan="1" colspan="1">0.6</td></tr><tr><td align="left" rowspan="1" colspan="1">Maize Sim</td><td align="left" rowspan="1" colspan="1">47.5</td><td align="left" rowspan="1" colspan="1">25.0</td><td align="left" rowspan="1" colspan="1">27.1</td><td align="left" rowspan="1" colspan="1">0.4</td></tr></tbody></table></table-wrap>
</p>
      </sec>
      <sec id="SEC3.1.3">
        <title>3.1.3 Simulation results</title>
        <p>The <monospace>unique</monospace>, <monospace>rescue</monospace> and <monospace>em</monospace> methods were run with the same set of alignments as input to estimate gene expression levels. Estimates were compared with the sample values, i.e. the expression estimates given the true counts of sample reads derived from each isoform [via Equations (<xref ref-type="disp-formula" rid="M6">6</xref>) and (<xref ref-type="disp-formula" rid="M2">2</xref>) with the true read counts]. We compare with the sample values instead of the model parameters because the sample values are the best estimates one could make if all latent variables were observed. Comparisons with the model parameters are affected by sampling error, which affects all methods equally and obscures the differences between them.</p>
        <p>We used two measures of error of the expression estimates. First, as a general measure of accuracy that is robust to outliers, we computed the median percent error (MPE) with respect to the sample values. Second, we computed the fraction of genes for which the estimates were significantly different (percent error &gt; 5%) from the sample values. We refer to this second statistic as the <italic>error fraction</italic> (EF). For these two measures, we only consider genes with sample ν or τ no less than 1 NPM or 1 TPM, respectively. We additionally calculate a false positive rate, which is the fraction of genes with sample τ below 1 TPM that are estimated to have τ at least 1 TPM. <xref ref-type="table" rid="T2">Table 2</xref> gives the MPE and EF statistics for estimates on the mouse and maize simulated data. Scatter plots of estimates versus sample values are given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Figures 1 and 2</ext-link>.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Gene expression estimation accuracy varies with read length given fixed base throughput (<italic>T</italic>). The curves are (1) mouse liver, <italic>T</italic>=375 × 10<sup>6</sup>, (2) mouse liver, <italic>T</italic>=750 × 10<sup>6</sup>, (3) mouse liver, <italic>T</italic>=1.5 × 10<sup>7</sup>, (4) mouse brain, <italic>T</italic>=750 × 10<sup>6</sup> and (5) maize, <italic>T</italic>=750 × 10<sup>6</sup>. The τ MPE was calculated with respect to the true expression values for all genes with true level at least 1 TPM.</p></caption><graphic xlink:href="btp692f2"/></fig>
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Error of the <monospace>unique</monospace>, <monospace>rescue</monospace> and <monospace>em</monospace> estimated gene expression levels with respect to sample expression values from simulations of mouse and maize RNA-Seq data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th align="center" colspan="6" rowspan="1">Sample gene expression in NPM (ν) or TPM (τ)<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th align="right" rowspan="1" colspan="1">[1, 10)</th><th align="right" rowspan="1" colspan="1">[10, 10<sup>2</sup>)</th><th align="right" rowspan="1" colspan="1">[10<sup>2</sup>, 10<sup>3</sup>)</th><th align="right" rowspan="1" colspan="1">[10<sup>3</sup>, 10<sup>4</sup>)</th><th align="right" rowspan="1" colspan="1">[10<sup>4</sup>, 10<sup>5</sup>)</th><th align="right" rowspan="1" colspan="1">All</th></tr></thead><tbody align="left"><tr><td align="left" colspan="9" rowspan="1">Simulation of mouse RNA-Seq data<hr/></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">N</td><td align="right" rowspan="1" colspan="1">5577</td><td align="right" rowspan="1" colspan="1">5240</td><td align="right" rowspan="1" colspan="1">1028</td><td align="right" rowspan="1" colspan="1">114</td><td align="right" rowspan="1" colspan="1">9</td><td align="right" rowspan="1" colspan="1">11968</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">MPE</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">18.9</td><td align="right" rowspan="1" colspan="1">18.7</td><td align="right" rowspan="1" colspan="1">19.1</td><td align="right" rowspan="1" colspan="1">19.9</td><td align="right" rowspan="1" colspan="1">20.7</td><td align="right" rowspan="1" colspan="1">18.8</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">2.8</td><td align="right" rowspan="1" colspan="1">1.1</td><td align="right" rowspan="1" colspan="1">0.8</td><td align="right" rowspan="1" colspan="1">0.7</td><td align="right" rowspan="1" colspan="1">1.2</td><td align="right" rowspan="1" colspan="1">1.6</td></tr><tr><td align="left" rowspan="1" colspan="1">ν</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1"><bold>2.3</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.8</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.4</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.2</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.3</bold></td><td align="right" rowspan="1" colspan="1"><bold>1.1</bold></td></tr><tr><td rowspan="1" colspan="1"/><td colspan="8" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">EF</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">93.9</td><td align="right" rowspan="1" colspan="1">96.2</td><td align="right" rowspan="1" colspan="1">96.5</td><td align="right" rowspan="1" colspan="1">100.0</td><td align="right" rowspan="1" colspan="1">100.0</td><td align="right" rowspan="1" colspan="1">95.2</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">26.9</td><td align="right" rowspan="1" colspan="1">6.1</td><td align="right" rowspan="1" colspan="1">6.4</td><td align="right" rowspan="1" colspan="1">7.9</td><td align="right" rowspan="1" colspan="1">33.3</td><td align="right" rowspan="1" colspan="1">15.9</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1">18.8</td><td align="right" rowspan="1" colspan="1">2.0</td><td align="right" rowspan="1" colspan="1">0.8</td><td align="right" rowspan="1" colspan="1">0.0</td><td align="right" rowspan="1" colspan="1">0.0</td><td align="right" rowspan="1" colspan="1">9.7</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">N</td><td align="right" rowspan="1" colspan="1">6279</td><td align="right" rowspan="1" colspan="1">4025</td><td align="right" rowspan="1" colspan="1">886</td><td align="right" rowspan="1" colspan="1">111</td><td align="right" rowspan="1" colspan="1">15</td><td align="right" rowspan="1" colspan="1">11316</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">MPE</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">29.6</td><td align="right" rowspan="1" colspan="1">29.2</td><td align="right" rowspan="1" colspan="1">30.9</td><td align="right" rowspan="1" colspan="1">32.8</td><td align="right" rowspan="1" colspan="1">32.1</td><td align="right" rowspan="1" colspan="1">29.6</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">12.6</td><td align="right" rowspan="1" colspan="1">6.8</td><td align="right" rowspan="1" colspan="1">6.1</td><td align="right" rowspan="1" colspan="1">5.9</td><td align="right" rowspan="1" colspan="1">5.8</td><td align="right" rowspan="1" colspan="1">8.2</td></tr><tr><td align="left" rowspan="1" colspan="1">τ</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1"><bold>2.6</bold></td><td align="right" rowspan="1" colspan="1"><bold>1.0</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.4</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.3</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.4</bold></td><td align="right" rowspan="1" colspan="1"><bold>1.5</bold></td></tr><tr><td rowspan="1" colspan="1"/><td colspan="8" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">EF</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">93.7</td><td align="right" rowspan="1" colspan="1">93.9</td><td align="right" rowspan="1" colspan="1">95.6</td><td align="right" rowspan="1" colspan="1">99.1</td><td align="right" rowspan="1" colspan="1">100.0</td><td align="right" rowspan="1" colspan="1">94.0</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">79.5</td><td align="right" rowspan="1" colspan="1">73.2</td><td align="right" rowspan="1" colspan="1">72.2</td><td align="right" rowspan="1" colspan="1">69.4</td><td align="right" rowspan="1" colspan="1">66.7</td><td align="right" rowspan="1" colspan="1">76.6</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1">27.8</td><td align="right" rowspan="1" colspan="1">6.2</td><td align="right" rowspan="1" colspan="1">1.1</td><td align="right" rowspan="1" colspan="1">0.0</td><td align="right" rowspan="1" colspan="1">0.0</td><td align="right" rowspan="1" colspan="1">17.7</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td colspan="9" align="left" rowspan="1">Simulation of maize RNA-Seq data<hr/></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">N</td><td align="right" rowspan="1" colspan="1">8934</td><td align="right" rowspan="1" colspan="1">4737</td><td align="right" rowspan="1" colspan="1">988</td><td align="right" rowspan="1" colspan="1">119</td><td align="right" rowspan="1" colspan="1">14</td><td align="right" rowspan="1" colspan="1">14792</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">MPE</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">86.8</td><td align="right" rowspan="1" colspan="1">87.8</td><td align="right" rowspan="1" colspan="1">88.7</td><td align="right" rowspan="1" colspan="1">88.1</td><td align="right" rowspan="1" colspan="1">85.9</td><td align="right" rowspan="1" colspan="1">87.3</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">11.3</td><td align="right" rowspan="1" colspan="1">3.3</td><td align="right" rowspan="1" colspan="1">0.9</td><td align="right" rowspan="1" colspan="1">0.6</td><td align="right" rowspan="1" colspan="1">0.7</td><td align="right" rowspan="1" colspan="1">6.6</td></tr><tr><td align="left" rowspan="1" colspan="1">ν</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1"><bold>3.7</bold></td><td align="right" rowspan="1" colspan="1"><bold>1.2</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.6</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.5</bold></td><td align="right" rowspan="1" colspan="1">0.4</td><td align="right" rowspan="1" colspan="1"><bold>2.3</bold></td></tr><tr><td rowspan="1" colspan="1"/><td colspan="8" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">EF</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">97.3</td><td align="right" rowspan="1" colspan="1">97.3</td><td align="right" rowspan="1" colspan="1">97.5</td><td align="right" rowspan="1" colspan="1">93.3</td><td align="right" rowspan="1" colspan="1">100.0</td><td align="right" rowspan="1" colspan="1">97.3</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">65.8</td><td align="right" rowspan="1" colspan="1">42.6</td><td align="right" rowspan="1" colspan="1">22.7</td><td align="right" rowspan="1" colspan="1">11.8</td><td align="right" rowspan="1" colspan="1">7.1</td><td align="right" rowspan="1" colspan="1">55.0</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1">40.5</td><td align="right" rowspan="1" colspan="1">16.5</td><td align="right" rowspan="1" colspan="1">6.4</td><td align="right" rowspan="1" colspan="1">2.5</td><td align="right" rowspan="1" colspan="1">21.4</td><td align="right" rowspan="1" colspan="1">30.2</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">N</td><td align="right" rowspan="1" colspan="1">9210</td><td align="right" rowspan="1" colspan="1">4931</td><td align="right" rowspan="1" colspan="1">1040</td><td align="right" rowspan="1" colspan="1">113</td><td align="right" rowspan="1" colspan="1">12</td><td align="right" rowspan="1" colspan="1">15306</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">MPE</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">86.1</td><td align="right" rowspan="1" colspan="1">84.2</td><td align="right" rowspan="1" colspan="1">85.2</td><td align="right" rowspan="1" colspan="1">80.5</td><td align="right" rowspan="1" colspan="1">96.3</td><td align="right" rowspan="1" colspan="1">85.5</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">21.3</td><td align="right" rowspan="1" colspan="1">11.8</td><td align="right" rowspan="1" colspan="1">8.9</td><td align="right" rowspan="1" colspan="1">8.5</td><td align="right" rowspan="1" colspan="1">7.7</td><td align="right" rowspan="1" colspan="1">16.0</td></tr><tr><td align="left" rowspan="1" colspan="1">τ</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1"><bold>4.6</bold></td><td align="right" rowspan="1" colspan="1"><bold>1.5</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.6</bold></td><td align="right" rowspan="1" colspan="1"><bold>0.5</bold></td><td align="right" rowspan="1" colspan="1">0.3</td><td align="right" rowspan="1" colspan="1"><bold>2.8</bold></td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">EF</td><td align="left" rowspan="1" colspan="1"><monospace>unique</monospace></td><td align="right" rowspan="1" colspan="1">97.2</td><td align="right" rowspan="1" colspan="1">96.7</td><td align="right" rowspan="1" colspan="1">97.1</td><td align="right" rowspan="1" colspan="1">98.2</td><td align="right" rowspan="1" colspan="1">100.0</td><td align="right" rowspan="1" colspan="1">97.0</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>rescue</monospace></td><td align="right" rowspan="1" colspan="1">89.4</td><td align="right" rowspan="1" colspan="1">88.3</td><td align="right" rowspan="1" colspan="1">85.8</td><td align="right" rowspan="1" colspan="1">82.3</td><td align="right" rowspan="1" colspan="1">91.7</td><td align="right" rowspan="1" colspan="1">88.8</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>em</monospace></td><td align="right" rowspan="1" colspan="1">47.5</td><td align="right" rowspan="1" colspan="1">18.8</td><td align="right" rowspan="1" colspan="1">6.1</td><td align="right" rowspan="1" colspan="1">4.4</td><td align="right" rowspan="1" colspan="1">16.7</td><td align="right" rowspan="1" colspan="1">35.1</td></tr></tbody></table><table-wrap-foot><fn><p>Error measures are given for genes at different levels of expression, as well as for all genes with expression at least 1 NPM (ν) or 1 TPM (τ). Bold values indicate that the estimates are significantly (<italic>P</italic>&lt;0.05) more accurate, as assessed by a paired Wilcoxon signed rank test. In all but one category, <monospace>em</monospace> is significantly more accurate than the others. For the highly expressed category (10<sup>4</sup>−10<sup>5</sup> NPM) in maize, <monospace>em</monospace> actually performs slightly worse in terms of ν EF than <monospace>rescue</monospace>. We attribute this oddity to a couple of repetitive genes within the small number of genes (14) in this category.</p></fn></table-wrap-foot></table-wrap>
</p>
        <p>For mouse, the <monospace>rescue</monospace> and <monospace>em</monospace> methods both estimate ν to within a few percent for most genes, with the <monospace>em</monospace> estimates being generally more accurate (paired Wilcoxon signed rank test, <italic>P</italic>=7.2 × 10<sup>−273</sup>). The <monospace>unique</monospace> method gives much poorer estimates, with an overall MPE of 18.8% and an EF of 95.2%. The accuracies of <monospace>rescue</monospace> and <monospace>em</monospace> are highest for genes with high expression as more data are available to allocate multireads for these genes. The EF statistic shows a greater difference in the accuracy of the methods, with <monospace>em</monospace> producing the smallest number of outlier estimates (overall ν EF of 9.7%, compared with 15.9% for <monospace>rescue</monospace>). Even larger differences between the methods are seen with respect to τ estimates. This difference is largely due to the fact that <monospace>rescue</monospace> does not estimate individual isoform expression levels and instead uses a single ‘effective’ length in order to calculate τ. Lastly, the false positive rates for the <monospace>unique</monospace>, <monospace>rescue</monospace> and <monospace>em</monospace> methods on the mouse data were 1.8%, 0.97% and 0.89%, respectively.</p>
        <p>For the maize dataset, extensive recent gene paralogy makes RNA-Seq analysis challenging, as uniquely mapping reads are in the minority of all mappable reads. Nevertheless, the overall ν MPE for <monospace>em</monospace> estimates on this set is 2.3%, as compared with 6.6% for <monospace>rescue</monospace> estimates. The EF for ν estimates is much higher than in mouse, however, with values of 30.2% and 55.0% for <monospace>em</monospace> and <monospace>rescue</monospace>, respectively. The false positive rates on the maize dataset are also much higher, with the <monospace>unique</monospace>, <monospace>rescue</monospace> and <monospace>em</monospace> methods giving false positive rates of 4.2%, 7.7% and 4.4%, respectively.</p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Non-uniform RSPDs</title>
      <p>We explored the uniformity of RSPDs in RNA-Seq data and analyzed how using a non-uniform model affects the accuracy of expression estimates. First, we learned an RSPD (<italic>B</italic>=10000) from the mouse liver dataset (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Fig. 3</ext-link>). Our learned RSPD indicates a 3′ bias in the RNA-Seq protocol used in Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>), despite attempts by the generators of this data to eliminate such biases through alternative fragmentation methods.</p>
      <p>We then simulated a set of reads from the mouse and maize reference gene set, as in the previous section, but with our estimated non-uniform RSPD. A model assuming a uniform RSPD (<monospace>em uniform</monospace>) and a model that learns a RSPD (<monospace>em rspd</monospace>) were used to estimate expression levels from this dataset. Although the ν and τ estimates from the two models were similar, <monospace>em rspd</monospace> estimates were generally more accurate (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Table 1</ext-link>). An additional set of experiments in mouse and maize with a more extreme 3′-biased RSPD (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Fig. 4</ext-link>) further differentiated the two models (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Table 2</ext-link>). These results indicate that incorporating a non-uniform RSPD into a RNA-Seq model helps to increase accuracy, although the benefits of the more sophisticated model are only noticeable when the RSPD is highly non-uniform.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Determination of optimal read length</title>
      <p>Sequencing technologies vary in the number and lengths of reads they can produce. Assuming an economic model in which the cost of RNA-Seq is proportional to the number of bases sequenced, we wished to determine the read length that allows for the highest accuracy in expression estimation. Given a fixed throughput, one can produce a large number of short reads or a smaller number of long reads. Longer reads reduce estimation error due to mapping uncertainty, whereas a larger number of reads reduces error due to sampling. The optimal read length achieves a balance between these two sources of error.</p>
      <p>We performed simulations with fixed throughput and varying read lengths to analyze this trade-off. To assess differences across species and tissues, we simulated from the mouse liver, mouse brain and maize transcriptomes. As for the mouse liver simulation, parameters for the mouse brain simulation were determined from data from Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>). We fixed the throughput at 750 million bases (roughly that of the mouse liver data) and generated read sets with lengths ranging from 20 to 40 bases. Given this fixed throughput, the number of reads in each set ranged from 18.75 million (<italic>L</italic>=40) to 37.5 million (<italic>L</italic>=20). For mouse liver, we performed additional experiments with twice the throughput (1.5 billion) and half the throughput (375 million) as the other three experiments. Reads were simulated according to the expression-level parameters of the corresponding tissue and species and with a position-independent error rate of 1%. The maximum number of mismatches allowed in alignments was one for <italic>L</italic>≤22 and two for longer reads. Five simulations were run for each read length and expression levels were estimated using our method. <xref ref-type="fig" rid="F2">Figure 2</xref> shows the mean τ MPE for the estimates on these sets. The trends are identical for the ν and EF measures (data not shown). Our results indicate that a read length between 20 and 25 bases gives the highest accuracy for the transcriptomes and throughputs considered.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Estimation on mouse liver data</title>
      <p>We reanalyzed the mouse liver dataset using our method and have made the results available on our method's web site. To assess the variance in the expression estimates produced by our method, we computed standard error estimates for each gene using the non-parametric bootstrap technique. As expected for a multinomial model, the variance of the ν estimates are roughly proportional to their means (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp692/DC1">Supplementary Fig. 5</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>In this article, we have shown that a statistical model for RNA-Seq can be used to address read mapping uncertainty, and therefore, to produce more accurate gene expression estimates than simpler methods. Through simulations that closely modeled real data, we confirmed that our method improved accuracy for experiments in both mouse and maize. The improvement in accuracy is most striking for repetitive genomes, such as maize, which give rise to large fractions of multireads. In addition, our results on τ estimation accuracy show that estimating individual isoform expression levels is critical to calculating gene-level estimates in terms of fractions of transcripts.</p>
    <p>We chose to focus on gene-level accuracy as our preliminary work has indicated that isoform-level estimation is only feasible for the most highly expressed genes with current read throughputs. When gene multireads are negligible, we expect our isoform estimates to be comparable with those produced by the method of Jiang and Wong (<xref ref-type="bibr" rid="B7">2009</xref>), as it is based on a similar model. When gene multireads are significant, we have shown that our method gives better gene-level accuracy than the <monospace>rescue</monospace> method, which is used in Jiang and Wong (<xref ref-type="bibr" rid="B7">2009</xref>) for allocating gene multireads.</p>
    <p>Our optimal read length results may have significant implications for future RNA-Seq analyses. We show that given a fixed sequencer throughput, the optimal read length for gene expression estimation from RNA-Seq experiments on organisms with known genomes is surprisingly short. We determined this length to be between 20 and 25 bases for the transcriptomes of maize and two mouse tissues. This result suggests that sequencing technology developers should strive for larger numbers of reads rather than longer reads when the target application is gene expression. Longer reads certainly help to reduce mapping uncertainty, but with methods that can handle this uncertainty, greater accuracy is achieved with a larger number of short reads. Researchers performing RNA-Seq experiments should generally use the full length of the reads produced by their sequencer kits, but if given the choice between kits that trade read length for read quantity, they should opt for the one that produces more reads.</p>
    <p>Our optimal read length result depends on the assumptions that (i) all possible isoforms in a transcriptome are known, (ii) only gene-level expression estimates are needed and (iii) accuracy across all genes is the primary objective, rather than accuracy on a specific subset. When these assumptions do not hold, longer reads may be beneficial. In addition, the optimal read length is likely to be dependent on the target species and throughput and thus additional experiments should be done for other conditions to determine appropriate read lengths.</p>
    <p>Although our accuracy results are based on simulations, we believe they are a fair test of expression estimation methods as the simulations are of RNA-Seq data that follow standard assumptions. The primary assumption of the simulations is that reads are generated uniformly across the transcriptome, or at least in proportion to ν<sub><italic>i</italic></sub> for each isoform (in the case of non-uniformity across a transcript's length). All current methods, including our own, rely on this assumption. One alternative to simulation would have been to compare to microarray estimates, as has been done to validate RNA-Seq technology in general (Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>). However, microarray estimates cannot be considered to be the ground truth and, in fact, offer less precision than those from RNA-Seq (Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2009</xref>). Ideally, we would assess accuracy using an RNA-Seq dataset for which isoform levels have been determined via qPCR, but such a dataset is difficult to obtain due to the relatively low-throughput nature of qPCR.</p>
    <p>As our primary motivation has been read mapping uncertainty, the usefulness of our method is dependent on the number of multireads in an RNA-Seq dataset. With sequencers producing longer read lengths each year, one might expect the number of multireads to drop significantly. However, there are several reasons why multireads will remain relevant until reads span entire RNA molecules. First, longer and paired-end reads do not decrease the number of multireads by as much as one might expect. Our simulations with 75 base reads and paired-end 75 base reads (200 base insert) on the mouse transcriptome give rise to 10% and 8% gene multireads, respectively. These are still significant fractions compared with 17% multireads for 25 base reads. Second, our results suggest that the best sequencers for RNA-Seq should produce large numbers of short reads (20–25 bases), in which case multireads are highly relevant. Third, isoform multireads are prominent even for long read lengths as alternate isoforms often share a significant fraction of their sequence. Since accurate expression estimation depends on identifying expression of individual isoforms, correctly handling isoform multireads will remain an important issue.</p>
    <p>Our future work will include a number of refinements to more closely model the RNA-Seq read generation process. For example, we will extend the model to incorporate sequencer quality scores, paired-end reads, variable read lengths (such as in 454 data), and allow for indels in reads. Other non-uniformities of RNA-Seq data, such as biases toward certain base compositions (Dohm <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>), will also be addressed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btp692_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btp692_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank members of the Thomson lab for helpful discussions regarding RNA-Seq protocols. We also acknowledge Ali Mortazavi for help in analyzing the data from Mortazavi <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>). Lastly, we thank two anonymous reviewers for their constructive comments on the initial version of this article.</p>
    <p><italic>Funding</italic>: MacArthur Professorship funds (to J.T. and in part to B.L.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beissbarth</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical modeling of sequencing errors in SAGE libraries</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>Suppl. 1</issue>
        <fpage>i31</fpage>
        <lpage>i39</lpage>
        <pub-id pub-id-type="pmid">15262778</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cloonan</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stem cell transcriptome profiling via massive-scale mRNA sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>613</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="pmid">18516046</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J. R. Stat. Soc. Ser. B (Methodol.)</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faulkner</surname>
            <given-names>GJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A rescue strategy for multimapping short sequence tags refines surveys of transcriptional activity by CAGE</article-title>
        <source>Genomics</source>
        <year>2008</year>
        <volume>91</volume>
        <fpage>281</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="pmid">18178374</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC known genes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1036</fpage>
        <lpage>1046</lpage>
        <pub-id pub-id-type="pmid">16500937</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1026</fpage>
        <lpage>1032</lpage>
        <pub-id pub-id-type="pmid">19244387</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapur</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross-hybridization modeling on Affymetrix exon arrays</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2887</fpage>
        <lpage>2893</lpage>
        <pub-id pub-id-type="pmid">18984598</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exact transcriptome reconstruction from short sequence reads</article-title>
        <source>Proceedings of the 8th International Workshop on Algorithms in Bioinformatics.</source>
        <year>2008</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>50</fpage>
        <lpage>63</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lister</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>133</volume>
        <fpage>523</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="pmid">18423832</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: An assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morin</surname>
            <given-names>RD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling the HeLa S3 transcriptome using randomly primed cDNA and massively parallel short-read sequencing</article-title>
        <source>BioTechniques</source>
        <year>2008</year>
        <volume>45</volume>
        <fpage>81</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="pmid">18611170</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1344</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staden</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A strategy of DNA sequencing employing computer programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1979</year>
        <volume>6</volume>
        <fpage>2601</fpage>
        <lpage>2610</lpage>
        <pub-id pub-id-type="pmid">461197</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
