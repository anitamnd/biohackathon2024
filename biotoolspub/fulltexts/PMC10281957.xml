<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10281957</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad071</article-id>
    <article-id pub-id-type="publisher-id">vbad071</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>tidytof: a user-friendly framework for scalable and reproducible high-dimensional cytometry data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0423-9679</contrib-id>
        <name>
          <surname>Keyes</surname>
          <given-names>Timothy J</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Medical Scientist Training Program, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Data Science, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Koladiya</surname>
          <given-names>Abhishek</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lo</surname>
          <given-names>Yu-Chen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nolan</surname>
          <given-names>Garry P</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="equal">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pathology, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7182-2592</contrib-id>
        <name>
          <surname>Davis</surname>
          <given-names>Kara L</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Center for Cancer Cell Therapy, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <xref rid="vbad071-cor1" ref-type="corresp"/>
        <!--kardavis@stanford.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Yu</surname>
          <given-names>Guoqiang</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad071-cor1">To whom correspondence should be addressed. <email>kardavis@stanford.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-09">
      <day>09</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad071</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad071.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>While many algorithms for analyzing high-dimensional cytometry data have now been developed, the software implementations of these algorithms remain highly customized—this means that exploring a dataset requires users to learn unique, often poorly interoperable package syntaxes for each step of data processing. To solve this problem, we developed {tidytof}, an open-source R package for analyzing high-dimensional cytometry data using the increasingly popular ‘tidy data’ interface.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>{tidytof} is available at <ext-link xlink:href="https://github.com/keyes-timothy/tidytof" ext-link-type="uri">https://github.com/keyes-timothy/tidytof</ext-link> and is released under the MIT license. It is supported on Linux, MS Windows and MacOS. Additional documentation is available at the package website (<ext-link xlink:href="https://keyes-timothy.github.io/tidytof/" ext-link-type="uri">https://keyes-timothy.github.io/tidytof/</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1F31CA239365-01</award-id>
        <award-id>U54CA209971</award-id>
        <award-id>U54HG010426</award-id>
        <award-id>U19AI100627</award-id>
        <award-id>R01 CA251858-01A1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Over the past decade, high-dimensional cytometry has become a prominent technology for high-throughput single-cell analysis of both human and animal tissues (<xref rid="vbad071-B21" ref-type="bibr">Spitzer and Nolan, 2016</xref>). Platforms including mass cytometry (or Cytometry by Time-Of-Flight), full-spectrum flow cytometry and sequence-based cytometry have now enabled the collection of large datasets of multiplexed proteomic measurements from millions of cells per experiment (<xref rid="vbad071-B3" ref-type="bibr">Bendall <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="vbad071-B10" ref-type="bibr">Jaimes <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="vbad071-B11" ref-type="bibr">Keyes <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad071-B20" ref-type="bibr">Salomon <italic toggle="yes">et al.</italic>, 2020</xref>). To derive insights from these complex datasets, recent years have also seen the development of dozens of algorithms for analyzing high-dimensional cytometry data at the single-cell, cell subpopulation and whole-sample levels (<xref rid="vbad071-F1" ref-type="fig">Fig. 1A</xref>) [for comprehensive reviews, see <xref rid="vbad071-B11" ref-type="bibr">Keyes <italic toggle="yes">et al.</italic> (2020)</xref>, <xref rid="vbad071-B17" ref-type="bibr">Olsen <italic toggle="yes">et al.</italic> (2019)</xref> and <xref rid="vbad071-B9" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> (2022)</xref>]. However, navigating the selection, use and interoperability requirements for each of these methods remains a significant challenge for many biologists.</p>
    <fig position="float" id="vbad071-F1">
      <label>Figure 1.</label>
      <caption>
        <p>{tidytof} implements a ‘grammar’ of single-cell data analysis at the single-cell, cluster and whole-sample levels. (<bold>A</bold>) Mass cytometry data contains biological insights at multiple levels of observation. The cell level (left) contains information about individual cells’ marker expression profiles. The cluster level (middle) contains information about the cell subpopulations that predominate among single-cell phenotypes. The whole-sample level (right) contains information about patient outcomes or experimental conditions that can be associated with single-cell and cluster-level information. (<bold>B</bold>) ‘Tidy’ data structures can be used to represent high-dimensional cytometry data at the single-cell, cluster and sample levels. At the cell level (left), a tidy data frame represents each cell as a row and each protein measurement as a column (each square in the image represents a single numeric measurement). Cells from multiple samples can be grouped by their sample-of-origin (represented using the color of each row) and bound row-wise into a single tidy data frame (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for an expanded representation). At the cluster level (middle), cluster membership can be represented by assigning a cluster identifier to each cell, allowing cells to be regrouped according to cluster membership. Finally, information from the single-cell and cluster levels can then be aggregated by computing summary statistics (such as each cluster’s abundance and mean marker expression) and joined with sample-level metadata to form a tidy data frame in which each row represents a sample and each column represents an aggregated biological feature or piece of metadata (right). (<bold>C</bold>) {tidytof} functions associated with the cell, cluster and whole-sample levels of data analysis. For expanded versions of these tables, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>. (<bold>D</bold>) Example code snippets that use {tidytof} functions to process and visualize high-dimensional cytometry data at the cell (left), cluster (middle) and whole-sample (right) levels. {tidytof} functions are chained together into mix-and-match data processing pipelines using R’s native pipe operator (‘|&gt;’). In the snippets, ‘data_path’ represents a file path to input .fcs or .csv files, ‘cyto_data’ represents a high-dimensional cytometry dataset in tidy format, and <bold>…</bold> represents function-specific arguments abbreviated for clarity. See Supplementary vignettes for additional details</p>
      </caption>
      <graphic xlink:href="vbad071f1" position="float"/>
    </fig>
    <p>Within the same time-period, the concept of ‘tidy data’—i.e. data represented in flexible, two-dimensional tables (called <italic toggle="yes">data frames</italic>) in which each row represents an observation and each column represents an experimental variable—has constituted a paradigm shift within the field of data science (<xref rid="vbad071-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) (<xref rid="vbad071-B23" ref-type="bibr">Wickham, 2014</xref>). The central concept of data ‘tidiness’ is that representing data in a consistent, tidy format makes data processing simpler (and often faster) by standardizing the tools needed to build an analytical pipeline. As such, adopting tidy data practices generally encourages the use of intuitive, human-centered design principles in statistical software engineering, allowing researchers to apply similar analytical frameworks across tools and research domains by expressing common data processing operations using a self-consistent vocabulary. In the context of scientific computing, using tidy data is particularly powerful because it results in code that is easy-to-read (and thereby easy-to-maintain), making it error-resistant, reproducible and relatively easy to write and debug. Because of these useful qualities, tidy workflows are emerging for bioinformatics applications in genomic (<xref rid="vbad071-B13" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2019</xref>) and transcriptomic analysis (<xref rid="vbad071-B15" ref-type="bibr">Mangiola <italic toggle="yes">et al.</italic>, 2021a</xref>, <xref rid="vbad071-B16" ref-type="bibr">b</xref>). Here, we build on this previous work by presenting {tidytof}, an R package implementing a comprehensive, performant and extensible framework for analyzing high-dimensional cytometry data with a tidy interface. Comprehensive documentation and tutorials for how to use {tidytof} are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes S1 and S2</xref> and in the {tidytof} package vignettes.</p>
  </sec>
  <sec>
    <title>2 Software design</title>
    <p>{tidytof} consolidates popular methods of high-dimensional cytometry data analysis, such as file reading, preprocessing, batch correction, quality control, clustering, dimensionality reduction, differential expression analysis, feature extraction and visualization into a composable, easy-to-use application programming interface (API) suitable for both experienced and beginner programmers (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>). It does so by organizing common data analysis tasks—including state-of-the-art statistical analyses and machine-learning algorithms—into verbs, or modular function families that represent specific mathematical operations like dimensionality reduction and clustering (<xref rid="vbad071-F1" ref-type="fig">Fig. 1C</xref>). Each {tidytof} verb accepts user commands with the same structure: a tidy data frame is accepted as input, and a tidy data frame is returned as output. Specifically, {tidytof} stores high-dimensional cytometry data in a specialized data structure called a <italic toggle="yes">tof_tbl</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). <italic toggle="yes">tof_tbl’</italic>s are an extension of R’s <italic toggle="yes">data.frame</italic> class that are customized to store cytometry data in a tidy format: cells are represented as rows, protein (or transcript) measurements are represented as columns and metadata about the cytometry panel used during data acquisition is stored as a class attribute. In addition, <italic toggle="yes">tof_tbl’</italic>s can also incorporate columns (using tidytof verbs’ <italic toggle="yes">augment</italic> flag) that store additional information about each cell—e.g. a cluster assignment, a low-dimensional embedding, or metadata information about the sample from which the cell was collected. Unlike other data structures commonly used to store single-cell data (such as <italic toggle="yes">SingleCellExperiment</italic> or <italic toggle="yes">flowSet</italic> objects), <italic toggle="yes">tof_tbl’</italic>s directly inherit behavior from <italic toggle="yes">data.frame’</italic>s, enabling them to dispatch any of the many existing methods for the <italic toggle="yes">data.frame</italic> class (<xref rid="vbad071-B1" ref-type="bibr">Amezquita <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad071-B6" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic>, 2021</xref>). Furthermore, a key feature of {tidytof}’s API is its ability to assemble multiple functions into modular, multistep pipelines that combine several analytical steps but remain easily human-readable by iteratively transforming a <italic toggle="yes">tof_tbl</italic> one step at a time (<xref rid="vbad071-F1" ref-type="fig">Fig. 1D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes S1 and S2</xref>). Thus, tidytof stores cell-level data in the rows of a <italic toggle="yes">tof_tbl</italic>, allowing cluster- and sample-level data to be quickly aggregated using {tidytof} verbs’ grouped operations.</p>
    <p>This design strategy has three major benefits. First, it allows {tidytof} to simplify how users access algorithms that perform the same fundamental task in different ways. For example, the <italic toggle="yes">tof_cluster</italic> verb provides a single interface to multiple clustering algorithms (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) that, despite their distinct underlying implementations, can all be applied easily using {tidytof}’s consistently tidy input and output data formats. This means that users can focus their efforts on interpreting and refining the results of a data analysis pipeline rather than on maintaining large code bases, which {tidytof} can simplify into relatively few lines of code (<xref rid="vbad071-F2" ref-type="fig">Fig. 2</xref>). Second, {tidytof} verbs’ modular design means that they can be combined to perform flexible analyses at each level of biological scope inherent to single-cell data: the single-cell level, the cell subpopulation level and the whole-sample level. {tidytof} provides verbs for computation and visualization within each of these levels as well as for transforming data between them. This results in a concise and intuitive domain-specific language for single-cell data analysis designed to answer questions at multiple levels of biological interest (<xref rid="vbad071-B7" ref-type="bibr">Fowler, 2010</xref>). Third, as an extension of the high-performing tidyverse ecosystem of data analysis tools in R, {tidytof} provides superior computational performance relative to existing packages for single-cell data analysis.</p>
    <fig position="float" id="vbad071-F2">
      <label>Figure 2.</label>
      <caption>
        <p>{tidytof} simplifies the code needed to perform high-dimensional cytometry data analysis. (<bold>A</bold>) Raw code from the body of LoadCleanFCS(), a function used for reading, preprocessing and downsampling FCS files in <xref rid="vbad071-B12" ref-type="bibr">Ko <italic toggle="yes">et al.</italic> (2020)</xref>. This code is replicated without editing, and the original source is available here: <ext-link xlink:href="https://github.com/zunderlab/FLOWMAP/blob/master/R/load-from-FCS.R" ext-link-type="uri">https://github.com/zunderlab/FLOWMAP/blob/master/R/load-from-FCS.R</ext-link>. Note that in the original function, the variable <italic toggle="yes">fcs.file.names</italic> is a character vector containing the file path to each FCS file to be read into memory, and the variable <italic toggle="yes">subsamples</italic> is an integer indicating how many cells to samples from each FCS file. (<bold>B</bold>) {tidytof} code that provides the same functionality as that provided in (<bold>A</bold>). <italic toggle="yes">fcs.file.names</italic> and <italic toggle="yes">subsamples</italic> are variables defined as in (A). (<bold>C</bold>) Raw lines of code needed to perform equivalent analyses using {tidytof} and other open-source single-cell data analysis packages, including base R, {cytofkit}, {flowCore}, {immunoCluster} and {Spectre}. Functions used to perform the code comparisons are provided at the following GitHub link: <ext-link xlink:href="https://github.com/keyes-timothy/tidytof-manuscript/blob/72c2d347241660156b1751cfdad1f0849df3dccb/benchmarking/benchmarking_functions.R" ext-link-type="uri">https://github.com/keyes-timothy/tidytof-manuscript/blob/72c2d347241660156b1751cfdad1f0849df3dccb/benchmarking/benchmarking_functions.R</ext-link>. For comprehensive coding burden comparisons with other packages, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3 and S4</xref></p>
      </caption>
      <graphic xlink:href="vbad071f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Performance benchmarking</title>
    <p>We benchmarked {tidytof}’s speed and memory performance against equivalent workflows in two low-level APIs (base R and {flowCore}) as well as three high-level APIs ({cytofkit}, {immunoCluster} and {Spectre}) with similar capabilities (<xref rid="vbad071-B2" ref-type="bibr">Ashhurst <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad071-B6" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B18" ref-type="bibr">Opzoomer <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B19" ref-type="bibr">R Core Team, 2021</xref>). Workflows—which included reading input files, preprocessing, downsampling, clustering, dimensionality reduction and feature extraction—were evaluated on the basis of their computational speed and memory performance on datasets sampled from a publicly available cohort of mass cytometry samples (<xref rid="vbad071-B8" ref-type="bibr">Good <italic toggle="yes">et al.</italic>, 2018</xref>). Across all workflows, {tidytof}’s computational performance rivaled or surpassed existing tools (<xref rid="vbad071-F3" ref-type="fig">Fig. 3A–I</xref>), and {tidytof}’s total time across all workflows was the smallest for all datasets used for benchmarking (<xref rid="vbad071-F3" ref-type="fig">Fig. 3J</xref>).</p>
    <fig position="float" id="vbad071-F3">
      <label>Figure 3.</label>
      <caption>
        <p>{tidytof}’s computational speed rivals or improves upon equivalent approaches using existing tools. Benchmark plots indicating the elapsed time for (<bold>A</bold>) reading FCS files, (<bold>B</bold>) reading CSV files, (<bold>C</bold>) preprocessing single-cell data, (<bold>D</bold>) downsampling single-cell data, (<bold>E</bold>) performing FlowSOM clustering, (<bold>F</bold>) sample-level feature extraction, (<bold>G</bold>) performing principal component analysis (PCA), (<bold>H</bold>) performing <italic toggle="yes">t</italic>-stochastic neighborhood embedding (tSNE), or (<bold>I</bold>) performing UMAP embedding using {tidytof}, base R, {flowCore}, {cytofkit}, {immunoCluster} and {Spectre}. Panel (<bold>J</bold>) shows the sum of runtimes from panels (A–F) for each tool [because panels (G–I) were run on different datasets, they could not be combined with the other panels] In all panels, points represent the median runtime for each workflow from 10 independent repetitions and error bars represent the interquartile range of runtimes</p>
      </caption>
      <graphic xlink:href="vbad071f3" position="float"/>
    </fig>
    <p>Notably, {tidytof}’s competitive performance is primarily attributable to efficient usage of the tidyverse package ecosystem, which interfaces easily with many other packages as an extension of the base R environment. This is exemplified by {tidytof}’s superior performance at file reading and downsampling compared to {cytofkit}, whose non-modular design results in redundant computations; by its superior performance at feature extraction compared to {Spectre}, which suffers a substantial performance penalty due to its use of for-loops; and its superior wrapping of uniform manifold approximation and projection (UMAP) compared to {immunoCluster} and {Spectre}, both of which are substantially slowed by their need to convert to and from <italic toggle="yes">data.table</italic> and <italic toggle="yes">SingleCellExperiment</italic> data objects, respectively. Despite this, {tidytof} is also as memory efficient as other tools for high-dimensional cytometry data analysis, suggesting that its speed does not derive from a tradeoff between data storage and computational performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). For comprehensive details and additional benchmarking, see the ‘{tidytof} performance benchmarking’ section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In summary, {tidytof} provides a tidy interface for analyzing high-dimensional cytometry data with an easy-to-use API and seamless integration with many existing tools created by the data science and bioinformatics communities (<xref rid="vbad071-B24" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic>, 2019</xref>). In doing so, {tidytof} decreases the coding burden of applying standard tools to high-dimensional cytometry datasets, thereby increasing the accessibility of advanced analytical methods to researchers with limited programming experience. While explicitly focused on cytometry data, {tidytof} also proposes a more general framework for creating a unified ‘grammar’ of single-cell data analysis—one that involves standard strategies for reading/writing data, preprocessing, clustering, feature engineering/aggregation and statistical modeling. This framework is widely extensible beyond cytometric technologies themselves. Our future engineering efforts will include both implementing new data processing features as additional verbs as well as extending existing verbs’ compatibility with other emerging single-cell technologies, such as high-dimensional imaging (<xref rid="vbad071-B4" ref-type="bibr">Black <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B14" ref-type="bibr">Levenson <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad071-B22" ref-type="bibr">Ståhl <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad071_Supplementary_Data</label>
      <media xlink:href="vbad071_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Astraea Jager, Brooks Benard, Caterina Colón, Jeremy D’Silva, Jolanda Sarno, Pablo Domizi and the R/Medicine community for helpful discussions.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>Timothy Keyes (Conceptualization [lead], Data curation [lead], Formal analysis [lead], Funding acquisition [lead], Investigation [lead], Methodology [lead], Project administration [lead], Resources [lead], Software [lead], Validation [lead], Visualization [lead], Writing—original draft [lead], Writing—review &amp; editing [lead]), Abhishek Koladiya (Data curation [equal], Formal analysis [equal], Investigation [equal], Methodology [equal], Validation [equal], Visualization [equal], Writing—review &amp; editing [equal]), Yu-Chen Lo (Formal analysis [equal], Investigation [equal], Methodology [equal], Validation [equal], Visualization [equal], Writing—review &amp; editing [equal]), Garry Nolan (Conceptualization [equal], Funding acquisition [equal], Investigation [equal], Project administration [equal], Resources [equal], Supervision [equal], Writing—original draft [equal], Writing—review &amp; editing [equal]), and Kara L Davis (Conceptualization [equal], Data curation [equal], Formal analysis [equal], Funding acquisition [lead], Investigation [equal], Methodology [equal], Project administration [equal], Resources [equal], Supervision [equal], Validation [equal], Writing—original draft [equal], Writing—review &amp; editing [equal])</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [grant numbers 1F31CA239365-01 to T.J.K., U54CA209971, U54HG010426, U19AI100627 to G.P.N. and R01 CA251858-01A1 to K.L.D.]; the Stanford Maternal and Child Health Research Institute; the Mark Foundation for Cancer Research; the Andrew McDonough B+ (Be Positive) Foundation; and a Point Foundation Graduate Student Scholarship (to T.J.K.).</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of Interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Mass cytometry data used for performance benchmarking are available at <ext-link xlink:href="https://github.com/kara-davis-lab/DDPR/releases" ext-link-type="uri">https://github.com/kara-davis-lab/DDPR/releases</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad071-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashhurst</surname><given-names>T.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Integration, exploration, and analysis of high-dimensional single-cell cytometry data using Spectre</article-title>. <source>Cytometry A</source>, <volume>101</volume>, <fpage>237</fpage>–<lpage>253</lpage>.<pub-id pub-id-type="pmid">33840138</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendall</surname><given-names>S.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>. <source>Science</source>, <volume>332</volume>, <fpage>687</fpage>–<lpage>696</lpage>.<pub-id pub-id-type="pmid">21551058</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>CODEX multiplexed tissue imaging with DNA-conjugated antibodies</article-title>. <source>Nat. Protoc</source>., <volume>16</volume>, <fpage>3802</fpage>–<lpage>3835</lpage>.<pub-id pub-id-type="pmid">34215862</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Cytofkit: a bioconductor package for an integrated mass cytometry data analysis pipeline</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1005112</fpage>.<pub-id pub-id-type="pmid">27662185</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) flowCore: basic structures for flow cytometry data.</mixed-citation>
    </ref>
    <ref id="vbad071-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fowler</surname><given-names>M.</given-names></string-name></person-group> (<year>2010</year>) <source>Domain-Specific Languages</source>. <publisher-name>Addison-Wesley</publisher-name>, <publisher-loc>Upper Saddle River, NJ</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="vbad071-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Good</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Single-cell developmental classification of B cell precursor acute lymphoblastic leukemia at diagnosis reveals predictors of relapse</article-title>. <source>Nat. Med</source>., <volume>24</volume>, <fpage>474</fpage>–<lpage>483</lpage>.<pub-id pub-id-type="pmid">29505032</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Application of machine learning for cytometry data</article-title>. <source>Front. Immunol</source>., <volume>12</volume>, <fpage>787574</fpage>.<pub-id pub-id-type="pmid">35046945</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaimes</surname><given-names>M.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Full spectrum flow cytometry and mass cytometry: a 32-marker panel comparison</article-title>. <source>Cytometry A</source>, <volume>101</volume>, <fpage>942</fpage>–<lpage>959</lpage>.<pub-id pub-id-type="pmid">35593221</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keyes</surname><given-names>T.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>A cancer biologist's primer on machine learning applications in high-dimensional cytometry</article-title>. <source>Cytometry A</source>, <volume>97</volume>, <fpage>782</fpage>–<lpage>799</lpage>.<pub-id pub-id-type="pmid">32602650</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ko</surname><given-names>M.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>FLOW-MAP: a graph-based, force-directed layout algorithm for trajectory mapping in single-cell time course datasets</article-title>. <source>Nat. Protoc</source>., <volume>15</volume>, <fpage>398</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">31932774</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>plyranges: a grammar of genomic data transformation</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>4</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-018-1597-8</pub-id>.<pub-id pub-id-type="pmid">30609939</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levenson</surname><given-names>R.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Immunohistochemistry and mass spectrometry for highly multiplexed cellular molecular imaging</article-title>. <source>Lab. Invest</source>., <volume>95</volume>, <fpage>397</fpage>–<lpage>405</lpage>.<pub-id pub-id-type="pmid">25730370</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangiola</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021a</year>) <article-title>Interfacing Seurat with the R tidy universe</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>4100</fpage>–<lpage>4107</lpage>.<pub-id pub-id-type="pmid">34028547</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangiola</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021b</year>) <article-title>tidybulk: an R tidy framework for modular transcriptomic data analysis</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>42</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02233-7</pub-id>.<pub-id pub-id-type="pmid">33482892</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olsen</surname><given-names>L.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The anatomy of single cell mass cytometry data</article-title>. <source>Cytometry A</source>, <volume>95</volume>, <fpage>156</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30277658</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Opzoomer</surname><given-names>J.W.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>ImmunoCluster provides a computational framework for the nonspecialist to profile high-dimensional cytometry data</article-title>. <source>Elife</source>, <volume>10</volume>, <fpage>e62915</fpage>.<pub-id pub-id-type="pmid">33929322</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B19">
      <mixed-citation publication-type="other"><collab>R Core Team</collab> (<year>2021</year>) <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>. R Foundation for Statistical Computing, Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="vbad071-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salomon</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Genomic cytometry and new modalities for deep single-cell interrogation</article-title>. <source>Cytometry A</source>, <volume>97</volume>, <fpage>1007</fpage>–<lpage>1016</lpage>.<pub-id pub-id-type="pmid">32794624</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spitzer</surname><given-names>M.H.</given-names></string-name>, <string-name><surname>Nolan</surname><given-names>G.P.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Mass cytometry: single cells, many features</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>780</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">27153492</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>P.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>, <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Tidy data</article-title>. <source>J. Stat. Softw</source>., <volume>59</volume>, <fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">26917999</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Welcome to the tidyverse</article-title>. <source>JOSS</source>, <volume>4</volume>, <fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10281957</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad071</article-id>
    <article-id pub-id-type="publisher-id">vbad071</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>tidytof: a user-friendly framework for scalable and reproducible high-dimensional cytometry data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0423-9679</contrib-id>
        <name>
          <surname>Keyes</surname>
          <given-names>Timothy J</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Medical Scientist Training Program, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Data Science, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Koladiya</surname>
          <given-names>Abhishek</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lo</surname>
          <given-names>Yu-Chen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nolan</surname>
          <given-names>Garry P</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="equal">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pathology, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7182-2592</contrib-id>
        <name>
          <surname>Davis</surname>
          <given-names>Kara L</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Pediatrics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Center for Cancer Cell Therapy, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <xref rid="vbad071-cor1" ref-type="corresp"/>
        <!--kardavis@stanford.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Yu</surname>
          <given-names>Guoqiang</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad071-cor1">To whom correspondence should be addressed. <email>kardavis@stanford.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-09">
      <day>09</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad071</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad071.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>While many algorithms for analyzing high-dimensional cytometry data have now been developed, the software implementations of these algorithms remain highly customized—this means that exploring a dataset requires users to learn unique, often poorly interoperable package syntaxes for each step of data processing. To solve this problem, we developed {tidytof}, an open-source R package for analyzing high-dimensional cytometry data using the increasingly popular ‘tidy data’ interface.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>{tidytof} is available at <ext-link xlink:href="https://github.com/keyes-timothy/tidytof" ext-link-type="uri">https://github.com/keyes-timothy/tidytof</ext-link> and is released under the MIT license. It is supported on Linux, MS Windows and MacOS. Additional documentation is available at the package website (<ext-link xlink:href="https://keyes-timothy.github.io/tidytof/" ext-link-type="uri">https://keyes-timothy.github.io/tidytof/</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1F31CA239365-01</award-id>
        <award-id>U54CA209971</award-id>
        <award-id>U54HG010426</award-id>
        <award-id>U19AI100627</award-id>
        <award-id>R01 CA251858-01A1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Over the past decade, high-dimensional cytometry has become a prominent technology for high-throughput single-cell analysis of both human and animal tissues (<xref rid="vbad071-B21" ref-type="bibr">Spitzer and Nolan, 2016</xref>). Platforms including mass cytometry (or Cytometry by Time-Of-Flight), full-spectrum flow cytometry and sequence-based cytometry have now enabled the collection of large datasets of multiplexed proteomic measurements from millions of cells per experiment (<xref rid="vbad071-B3" ref-type="bibr">Bendall <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="vbad071-B10" ref-type="bibr">Jaimes <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="vbad071-B11" ref-type="bibr">Keyes <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad071-B20" ref-type="bibr">Salomon <italic toggle="yes">et al.</italic>, 2020</xref>). To derive insights from these complex datasets, recent years have also seen the development of dozens of algorithms for analyzing high-dimensional cytometry data at the single-cell, cell subpopulation and whole-sample levels (<xref rid="vbad071-F1" ref-type="fig">Fig. 1A</xref>) [for comprehensive reviews, see <xref rid="vbad071-B11" ref-type="bibr">Keyes <italic toggle="yes">et al.</italic> (2020)</xref>, <xref rid="vbad071-B17" ref-type="bibr">Olsen <italic toggle="yes">et al.</italic> (2019)</xref> and <xref rid="vbad071-B9" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> (2022)</xref>]. However, navigating the selection, use and interoperability requirements for each of these methods remains a significant challenge for many biologists.</p>
    <fig position="float" id="vbad071-F1">
      <label>Figure 1.</label>
      <caption>
        <p>{tidytof} implements a ‘grammar’ of single-cell data analysis at the single-cell, cluster and whole-sample levels. (<bold>A</bold>) Mass cytometry data contains biological insights at multiple levels of observation. The cell level (left) contains information about individual cells’ marker expression profiles. The cluster level (middle) contains information about the cell subpopulations that predominate among single-cell phenotypes. The whole-sample level (right) contains information about patient outcomes or experimental conditions that can be associated with single-cell and cluster-level information. (<bold>B</bold>) ‘Tidy’ data structures can be used to represent high-dimensional cytometry data at the single-cell, cluster and sample levels. At the cell level (left), a tidy data frame represents each cell as a row and each protein measurement as a column (each square in the image represents a single numeric measurement). Cells from multiple samples can be grouped by their sample-of-origin (represented using the color of each row) and bound row-wise into a single tidy data frame (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for an expanded representation). At the cluster level (middle), cluster membership can be represented by assigning a cluster identifier to each cell, allowing cells to be regrouped according to cluster membership. Finally, information from the single-cell and cluster levels can then be aggregated by computing summary statistics (such as each cluster’s abundance and mean marker expression) and joined with sample-level metadata to form a tidy data frame in which each row represents a sample and each column represents an aggregated biological feature or piece of metadata (right). (<bold>C</bold>) {tidytof} functions associated with the cell, cluster and whole-sample levels of data analysis. For expanded versions of these tables, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>. (<bold>D</bold>) Example code snippets that use {tidytof} functions to process and visualize high-dimensional cytometry data at the cell (left), cluster (middle) and whole-sample (right) levels. {tidytof} functions are chained together into mix-and-match data processing pipelines using R’s native pipe operator (‘|&gt;’). In the snippets, ‘data_path’ represents a file path to input .fcs or .csv files, ‘cyto_data’ represents a high-dimensional cytometry dataset in tidy format, and <bold>…</bold> represents function-specific arguments abbreviated for clarity. See Supplementary vignettes for additional details</p>
      </caption>
      <graphic xlink:href="vbad071f1" position="float"/>
    </fig>
    <p>Within the same time-period, the concept of ‘tidy data’—i.e. data represented in flexible, two-dimensional tables (called <italic toggle="yes">data frames</italic>) in which each row represents an observation and each column represents an experimental variable—has constituted a paradigm shift within the field of data science (<xref rid="vbad071-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) (<xref rid="vbad071-B23" ref-type="bibr">Wickham, 2014</xref>). The central concept of data ‘tidiness’ is that representing data in a consistent, tidy format makes data processing simpler (and often faster) by standardizing the tools needed to build an analytical pipeline. As such, adopting tidy data practices generally encourages the use of intuitive, human-centered design principles in statistical software engineering, allowing researchers to apply similar analytical frameworks across tools and research domains by expressing common data processing operations using a self-consistent vocabulary. In the context of scientific computing, using tidy data is particularly powerful because it results in code that is easy-to-read (and thereby easy-to-maintain), making it error-resistant, reproducible and relatively easy to write and debug. Because of these useful qualities, tidy workflows are emerging for bioinformatics applications in genomic (<xref rid="vbad071-B13" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2019</xref>) and transcriptomic analysis (<xref rid="vbad071-B15" ref-type="bibr">Mangiola <italic toggle="yes">et al.</italic>, 2021a</xref>, <xref rid="vbad071-B16" ref-type="bibr">b</xref>). Here, we build on this previous work by presenting {tidytof}, an R package implementing a comprehensive, performant and extensible framework for analyzing high-dimensional cytometry data with a tidy interface. Comprehensive documentation and tutorials for how to use {tidytof} are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes S1 and S2</xref> and in the {tidytof} package vignettes.</p>
  </sec>
  <sec>
    <title>2 Software design</title>
    <p>{tidytof} consolidates popular methods of high-dimensional cytometry data analysis, such as file reading, preprocessing, batch correction, quality control, clustering, dimensionality reduction, differential expression analysis, feature extraction and visualization into a composable, easy-to-use application programming interface (API) suitable for both experienced and beginner programmers (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2–S4</xref>). It does so by organizing common data analysis tasks—including state-of-the-art statistical analyses and machine-learning algorithms—into verbs, or modular function families that represent specific mathematical operations like dimensionality reduction and clustering (<xref rid="vbad071-F1" ref-type="fig">Fig. 1C</xref>). Each {tidytof} verb accepts user commands with the same structure: a tidy data frame is accepted as input, and a tidy data frame is returned as output. Specifically, {tidytof} stores high-dimensional cytometry data in a specialized data structure called a <italic toggle="yes">tof_tbl</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). <italic toggle="yes">tof_tbl’</italic>s are an extension of R’s <italic toggle="yes">data.frame</italic> class that are customized to store cytometry data in a tidy format: cells are represented as rows, protein (or transcript) measurements are represented as columns and metadata about the cytometry panel used during data acquisition is stored as a class attribute. In addition, <italic toggle="yes">tof_tbl’</italic>s can also incorporate columns (using tidytof verbs’ <italic toggle="yes">augment</italic> flag) that store additional information about each cell—e.g. a cluster assignment, a low-dimensional embedding, or metadata information about the sample from which the cell was collected. Unlike other data structures commonly used to store single-cell data (such as <italic toggle="yes">SingleCellExperiment</italic> or <italic toggle="yes">flowSet</italic> objects), <italic toggle="yes">tof_tbl’</italic>s directly inherit behavior from <italic toggle="yes">data.frame’</italic>s, enabling them to dispatch any of the many existing methods for the <italic toggle="yes">data.frame</italic> class (<xref rid="vbad071-B1" ref-type="bibr">Amezquita <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad071-B6" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic>, 2021</xref>). Furthermore, a key feature of {tidytof}’s API is its ability to assemble multiple functions into modular, multistep pipelines that combine several analytical steps but remain easily human-readable by iteratively transforming a <italic toggle="yes">tof_tbl</italic> one step at a time (<xref rid="vbad071-F1" ref-type="fig">Fig. 1D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes S1 and S2</xref>). Thus, tidytof stores cell-level data in the rows of a <italic toggle="yes">tof_tbl</italic>, allowing cluster- and sample-level data to be quickly aggregated using {tidytof} verbs’ grouped operations.</p>
    <p>This design strategy has three major benefits. First, it allows {tidytof} to simplify how users access algorithms that perform the same fundamental task in different ways. For example, the <italic toggle="yes">tof_cluster</italic> verb provides a single interface to multiple clustering algorithms (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) that, despite their distinct underlying implementations, can all be applied easily using {tidytof}’s consistently tidy input and output data formats. This means that users can focus their efforts on interpreting and refining the results of a data analysis pipeline rather than on maintaining large code bases, which {tidytof} can simplify into relatively few lines of code (<xref rid="vbad071-F2" ref-type="fig">Fig. 2</xref>). Second, {tidytof} verbs’ modular design means that they can be combined to perform flexible analyses at each level of biological scope inherent to single-cell data: the single-cell level, the cell subpopulation level and the whole-sample level. {tidytof} provides verbs for computation and visualization within each of these levels as well as for transforming data between them. This results in a concise and intuitive domain-specific language for single-cell data analysis designed to answer questions at multiple levels of biological interest (<xref rid="vbad071-B7" ref-type="bibr">Fowler, 2010</xref>). Third, as an extension of the high-performing tidyverse ecosystem of data analysis tools in R, {tidytof} provides superior computational performance relative to existing packages for single-cell data analysis.</p>
    <fig position="float" id="vbad071-F2">
      <label>Figure 2.</label>
      <caption>
        <p>{tidytof} simplifies the code needed to perform high-dimensional cytometry data analysis. (<bold>A</bold>) Raw code from the body of LoadCleanFCS(), a function used for reading, preprocessing and downsampling FCS files in <xref rid="vbad071-B12" ref-type="bibr">Ko <italic toggle="yes">et al.</italic> (2020)</xref>. This code is replicated without editing, and the original source is available here: <ext-link xlink:href="https://github.com/zunderlab/FLOWMAP/blob/master/R/load-from-FCS.R" ext-link-type="uri">https://github.com/zunderlab/FLOWMAP/blob/master/R/load-from-FCS.R</ext-link>. Note that in the original function, the variable <italic toggle="yes">fcs.file.names</italic> is a character vector containing the file path to each FCS file to be read into memory, and the variable <italic toggle="yes">subsamples</italic> is an integer indicating how many cells to samples from each FCS file. (<bold>B</bold>) {tidytof} code that provides the same functionality as that provided in (<bold>A</bold>). <italic toggle="yes">fcs.file.names</italic> and <italic toggle="yes">subsamples</italic> are variables defined as in (A). (<bold>C</bold>) Raw lines of code needed to perform equivalent analyses using {tidytof} and other open-source single-cell data analysis packages, including base R, {cytofkit}, {flowCore}, {immunoCluster} and {Spectre}. Functions used to perform the code comparisons are provided at the following GitHub link: <ext-link xlink:href="https://github.com/keyes-timothy/tidytof-manuscript/blob/72c2d347241660156b1751cfdad1f0849df3dccb/benchmarking/benchmarking_functions.R" ext-link-type="uri">https://github.com/keyes-timothy/tidytof-manuscript/blob/72c2d347241660156b1751cfdad1f0849df3dccb/benchmarking/benchmarking_functions.R</ext-link>. For comprehensive coding burden comparisons with other packages, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3 and S4</xref></p>
      </caption>
      <graphic xlink:href="vbad071f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Performance benchmarking</title>
    <p>We benchmarked {tidytof}’s speed and memory performance against equivalent workflows in two low-level APIs (base R and {flowCore}) as well as three high-level APIs ({cytofkit}, {immunoCluster} and {Spectre}) with similar capabilities (<xref rid="vbad071-B2" ref-type="bibr">Ashhurst <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad071-B6" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B18" ref-type="bibr">Opzoomer <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B19" ref-type="bibr">R Core Team, 2021</xref>). Workflows—which included reading input files, preprocessing, downsampling, clustering, dimensionality reduction and feature extraction—were evaluated on the basis of their computational speed and memory performance on datasets sampled from a publicly available cohort of mass cytometry samples (<xref rid="vbad071-B8" ref-type="bibr">Good <italic toggle="yes">et al.</italic>, 2018</xref>). Across all workflows, {tidytof}’s computational performance rivaled or surpassed existing tools (<xref rid="vbad071-F3" ref-type="fig">Fig. 3A–I</xref>), and {tidytof}’s total time across all workflows was the smallest for all datasets used for benchmarking (<xref rid="vbad071-F3" ref-type="fig">Fig. 3J</xref>).</p>
    <fig position="float" id="vbad071-F3">
      <label>Figure 3.</label>
      <caption>
        <p>{tidytof}’s computational speed rivals or improves upon equivalent approaches using existing tools. Benchmark plots indicating the elapsed time for (<bold>A</bold>) reading FCS files, (<bold>B</bold>) reading CSV files, (<bold>C</bold>) preprocessing single-cell data, (<bold>D</bold>) downsampling single-cell data, (<bold>E</bold>) performing FlowSOM clustering, (<bold>F</bold>) sample-level feature extraction, (<bold>G</bold>) performing principal component analysis (PCA), (<bold>H</bold>) performing <italic toggle="yes">t</italic>-stochastic neighborhood embedding (tSNE), or (<bold>I</bold>) performing UMAP embedding using {tidytof}, base R, {flowCore}, {cytofkit}, {immunoCluster} and {Spectre}. Panel (<bold>J</bold>) shows the sum of runtimes from panels (A–F) for each tool [because panels (G–I) were run on different datasets, they could not be combined with the other panels] In all panels, points represent the median runtime for each workflow from 10 independent repetitions and error bars represent the interquartile range of runtimes</p>
      </caption>
      <graphic xlink:href="vbad071f3" position="float"/>
    </fig>
    <p>Notably, {tidytof}’s competitive performance is primarily attributable to efficient usage of the tidyverse package ecosystem, which interfaces easily with many other packages as an extension of the base R environment. This is exemplified by {tidytof}’s superior performance at file reading and downsampling compared to {cytofkit}, whose non-modular design results in redundant computations; by its superior performance at feature extraction compared to {Spectre}, which suffers a substantial performance penalty due to its use of for-loops; and its superior wrapping of uniform manifold approximation and projection (UMAP) compared to {immunoCluster} and {Spectre}, both of which are substantially slowed by their need to convert to and from <italic toggle="yes">data.table</italic> and <italic toggle="yes">SingleCellExperiment</italic> data objects, respectively. Despite this, {tidytof} is also as memory efficient as other tools for high-dimensional cytometry data analysis, suggesting that its speed does not derive from a tradeoff between data storage and computational performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). For comprehensive details and additional benchmarking, see the ‘{tidytof} performance benchmarking’ section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In summary, {tidytof} provides a tidy interface for analyzing high-dimensional cytometry data with an easy-to-use API and seamless integration with many existing tools created by the data science and bioinformatics communities (<xref rid="vbad071-B24" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic>, 2019</xref>). In doing so, {tidytof} decreases the coding burden of applying standard tools to high-dimensional cytometry datasets, thereby increasing the accessibility of advanced analytical methods to researchers with limited programming experience. While explicitly focused on cytometry data, {tidytof} also proposes a more general framework for creating a unified ‘grammar’ of single-cell data analysis—one that involves standard strategies for reading/writing data, preprocessing, clustering, feature engineering/aggregation and statistical modeling. This framework is widely extensible beyond cytometric technologies themselves. Our future engineering efforts will include both implementing new data processing features as additional verbs as well as extending existing verbs’ compatibility with other emerging single-cell technologies, such as high-dimensional imaging (<xref rid="vbad071-B4" ref-type="bibr">Black <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad071-B14" ref-type="bibr">Levenson <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad071-B22" ref-type="bibr">Ståhl <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad071_Supplementary_Data</label>
      <media xlink:href="vbad071_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Astraea Jager, Brooks Benard, Caterina Colón, Jeremy D’Silva, Jolanda Sarno, Pablo Domizi and the R/Medicine community for helpful discussions.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>Timothy Keyes (Conceptualization [lead], Data curation [lead], Formal analysis [lead], Funding acquisition [lead], Investigation [lead], Methodology [lead], Project administration [lead], Resources [lead], Software [lead], Validation [lead], Visualization [lead], Writing—original draft [lead], Writing—review &amp; editing [lead]), Abhishek Koladiya (Data curation [equal], Formal analysis [equal], Investigation [equal], Methodology [equal], Validation [equal], Visualization [equal], Writing—review &amp; editing [equal]), Yu-Chen Lo (Formal analysis [equal], Investigation [equal], Methodology [equal], Validation [equal], Visualization [equal], Writing—review &amp; editing [equal]), Garry Nolan (Conceptualization [equal], Funding acquisition [equal], Investigation [equal], Project administration [equal], Resources [equal], Supervision [equal], Writing—original draft [equal], Writing—review &amp; editing [equal]), and Kara L Davis (Conceptualization [equal], Data curation [equal], Formal analysis [equal], Funding acquisition [lead], Investigation [equal], Methodology [equal], Project administration [equal], Resources [equal], Supervision [equal], Validation [equal], Writing—original draft [equal], Writing—review &amp; editing [equal])</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [grant numbers 1F31CA239365-01 to T.J.K., U54CA209971, U54HG010426, U19AI100627 to G.P.N. and R01 CA251858-01A1 to K.L.D.]; the Stanford Maternal and Child Health Research Institute; the Mark Foundation for Cancer Research; the Andrew McDonough B+ (Be Positive) Foundation; and a Point Foundation Graduate Student Scholarship (to T.J.K.).</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of Interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Mass cytometry data used for performance benchmarking are available at <ext-link xlink:href="https://github.com/kara-davis-lab/DDPR/releases" ext-link-type="uri">https://github.com/kara-davis-lab/DDPR/releases</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad071-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashhurst</surname><given-names>T.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Integration, exploration, and analysis of high-dimensional single-cell cytometry data using Spectre</article-title>. <source>Cytometry A</source>, <volume>101</volume>, <fpage>237</fpage>–<lpage>253</lpage>.<pub-id pub-id-type="pmid">33840138</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendall</surname><given-names>S.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>. <source>Science</source>, <volume>332</volume>, <fpage>687</fpage>–<lpage>696</lpage>.<pub-id pub-id-type="pmid">21551058</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>CODEX multiplexed tissue imaging with DNA-conjugated antibodies</article-title>. <source>Nat. Protoc</source>., <volume>16</volume>, <fpage>3802</fpage>–<lpage>3835</lpage>.<pub-id pub-id-type="pmid">34215862</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Cytofkit: a bioconductor package for an integrated mass cytometry data analysis pipeline</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1005112</fpage>.<pub-id pub-id-type="pmid">27662185</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) flowCore: basic structures for flow cytometry data.</mixed-citation>
    </ref>
    <ref id="vbad071-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fowler</surname><given-names>M.</given-names></string-name></person-group> (<year>2010</year>) <source>Domain-Specific Languages</source>. <publisher-name>Addison-Wesley</publisher-name>, <publisher-loc>Upper Saddle River, NJ</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="vbad071-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Good</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Single-cell developmental classification of B cell precursor acute lymphoblastic leukemia at diagnosis reveals predictors of relapse</article-title>. <source>Nat. Med</source>., <volume>24</volume>, <fpage>474</fpage>–<lpage>483</lpage>.<pub-id pub-id-type="pmid">29505032</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Application of machine learning for cytometry data</article-title>. <source>Front. Immunol</source>., <volume>12</volume>, <fpage>787574</fpage>.<pub-id pub-id-type="pmid">35046945</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaimes</surname><given-names>M.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Full spectrum flow cytometry and mass cytometry: a 32-marker panel comparison</article-title>. <source>Cytometry A</source>, <volume>101</volume>, <fpage>942</fpage>–<lpage>959</lpage>.<pub-id pub-id-type="pmid">35593221</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keyes</surname><given-names>T.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>A cancer biologist's primer on machine learning applications in high-dimensional cytometry</article-title>. <source>Cytometry A</source>, <volume>97</volume>, <fpage>782</fpage>–<lpage>799</lpage>.<pub-id pub-id-type="pmid">32602650</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ko</surname><given-names>M.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>FLOW-MAP: a graph-based, force-directed layout algorithm for trajectory mapping in single-cell time course datasets</article-title>. <source>Nat. Protoc</source>., <volume>15</volume>, <fpage>398</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">31932774</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>plyranges: a grammar of genomic data transformation</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>4</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-018-1597-8</pub-id>.<pub-id pub-id-type="pmid">30609939</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levenson</surname><given-names>R.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Immunohistochemistry and mass spectrometry for highly multiplexed cellular molecular imaging</article-title>. <source>Lab. Invest</source>., <volume>95</volume>, <fpage>397</fpage>–<lpage>405</lpage>.<pub-id pub-id-type="pmid">25730370</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangiola</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021a</year>) <article-title>Interfacing Seurat with the R tidy universe</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>4100</fpage>–<lpage>4107</lpage>.<pub-id pub-id-type="pmid">34028547</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangiola</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021b</year>) <article-title>tidybulk: an R tidy framework for modular transcriptomic data analysis</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>42</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02233-7</pub-id>.<pub-id pub-id-type="pmid">33482892</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olsen</surname><given-names>L.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The anatomy of single cell mass cytometry data</article-title>. <source>Cytometry A</source>, <volume>95</volume>, <fpage>156</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30277658</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Opzoomer</surname><given-names>J.W.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>ImmunoCluster provides a computational framework for the nonspecialist to profile high-dimensional cytometry data</article-title>. <source>Elife</source>, <volume>10</volume>, <fpage>e62915</fpage>.<pub-id pub-id-type="pmid">33929322</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B19">
      <mixed-citation publication-type="other"><collab>R Core Team</collab> (<year>2021</year>) <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>. R Foundation for Statistical Computing, Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="vbad071-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salomon</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Genomic cytometry and new modalities for deep single-cell interrogation</article-title>. <source>Cytometry A</source>, <volume>97</volume>, <fpage>1007</fpage>–<lpage>1016</lpage>.<pub-id pub-id-type="pmid">32794624</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spitzer</surname><given-names>M.H.</given-names></string-name>, <string-name><surname>Nolan</surname><given-names>G.P.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Mass cytometry: single cells, many features</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>780</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">27153492</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>P.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>, <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Tidy data</article-title>. <source>J. Stat. Softw</source>., <volume>59</volume>, <fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">26917999</pub-id></mixed-citation>
    </ref>
    <ref id="vbad071-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Welcome to the tidyverse</article-title>. <source>JOSS</source>, <volume>4</volume>, <fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
