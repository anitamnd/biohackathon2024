<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10307938</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad080</article-id>
    <article-id pub-id-type="publisher-id">vbad080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">snHiC</italic>: a complete and simplified snakemake pipeline for grouped Hi-C data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9209-5403</contrib-id>
        <name>
          <surname>Gregoricchio</surname>
          <given-names>Sebastian</given-names>
        </name>
        <aff><institution>Division of Oncogenomics, Netherlands Cancer Institute, Oncode Institute</institution>, 1066CX Amsterdam, <country country="NL">The Netherlands</country></aff>
        <xref rid="vbad080-cor1" ref-type="corresp"/>
        <!--s.gregoricchio@nki.nl-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9823-7289</contrib-id>
        <name>
          <surname>Zwart</surname>
          <given-names>Wilbert</given-names>
        </name>
        <aff><institution>Division of Oncogenomics, Netherlands Cancer Institute, Oncode Institute</institution>, 1066CX Amsterdam, <country country="NL">The Netherlands</country></aff>
        <xref rid="vbad080-cor1" ref-type="corresp"/>
        <!--w.zwart@nki.nl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Fraternali</surname>
          <given-names>Franca</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad080-cor1">To whom correspondence should be addressed. <email>s.gregoricchio@nki.nl</email> or <email>w.zwart@nki.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-21">
      <day>21</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad080</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Genome-wide chromosome conformation capture (Hi-C) is a technique that allows the study of 3D genome organization. Despite being widely used, analysis of Hi-C data is technically challenging and involves several time-consuming steps that often require manual involvement making it error prone, potentially affecting data reproducibility. In order to facilitate and simplify these analyses we implemented <italic toggle="yes">snHiC</italic>, a snakemake-based pipeline that allows for the generation of contact matrices at multiple resolutions in one single run, aggregation of individual samples into user-specified groups, detection of domains, compartments, loops and stripes and performance of differential compartment and chromatin interaction analyses.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Source code is freely available at <ext-link xlink:href="https://github.com/sebastian-gregoricchio/snHiC" ext-link-type="uri">https://github.com/sebastian-gregoricchio/snHiC</ext-link>. A yaml-formatted file (snHiC/workflow/envs/snHiC_conda_env_stable.yaml) is available to build a compatible conda environment.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Oncode Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/501100021821</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In the past decades, the epigenetics field has been revolutionized by the introduction of new techniques that allow for the interrogation of long-range DNA–DNA interactions and enable researchers to study the genome organization in three-dimensional space. Genome-wide chromosome conformation capture (Hi-C) (<xref rid="vbad080-B6" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>) is considered one of the most advanced 3D genome analysis technologies. Hi-C, coupled to high-throughput sequencing, allows for the identification of DNA–DNA physical contacts that occur between regions contacting in 3D genome space while localized several megabase-pairs (Mb) away from each other in the linear genome.</p>
    <p>The use of Hi-C in biomedical research is quickly increasing, but the analysis of these data remains challenging. Indeed, in contrast to RNA-seq and Chromatin ImmunoPrecipitation (ChIP)-seq data for which golden standard file formats are available, many different tools with their corresponding formats exist for the analysis of Hi-C data.</p>
    <p>While many different pipelines are available for the analysis of Hi-C data [reviewed in <xref rid="vbad080-B4" ref-type="bibr">Han and Wei (2017)</xref> and <xref rid="vbad080-B5" ref-type="bibr">Hansen <italic toggle="yes">et al.</italic> (2019)</xref>], only few of them include a comprehensive generation of downstream data such as Topologically Associated Domains (TADs) calls, loops and stripes calls, A/B compartments and differential compartmentalization and interactions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
    <p>With the implementation of <italic toggle="yes">snHiC</italic> (publicly available at <ext-link xlink:href="https://github.com/sebastian-gregoricchio/snHiC" ext-link-type="uri">https://github.com/sebastian-gregoricchio/snHiC</ext-link>) we aim to fill these gaps by providing a user-friendly snakemake-based pipeline for a complete and customizable analysis of Hi-C data with the possibility to automatically repeat the same analyses by sample group and multiple resolutions.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>Our pipeline, <italic toggle="yes">snHiC</italic>, is a workflow organized in different sequential steps (rules) managed by a snakemake system (<xref rid="vbad080-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data</xref>). The input data required for the pipeline are paired-end fastq files that are mapped to the reference genome and subsequently processed to generate normalized and corrected contact matrices, to ensure reproducibility and consistency in output data (as opposed to preprocessed contact matrices). Subsequently, the contact matrices are then used to detect TADs, loops, stripes and A/B compartments. Furthermore, <italic toggle="yes">snHiC</italic> can also perform differential Hi-C chromatin interactions and compartments analyses between sample groups.</p>
    <fig position="float" id="vbad080-F1">
      <label>Figure 1.</label>
      <caption>
        <p><italic toggle="yes">snHiC</italic> pipeline workflow. Sequential steps are performed in the <italic toggle="yes">snHiC</italic> pipeline starting from paired-end.fastq files (indicated by the bold box border). Software/tools/functions used in each step are indicated by rectangular boxes, while output files generated are indicated in either folded-corner boxes (text files and plots) or wave-bottom boxes (Hi-C data files, such as alignment files or contact matrices). Computational interactions are indicated by diamonds, while key user defined parameters collected from the groups_configuration file are contained in the trapezoid box</p>
      </caption>
      <graphic xlink:href="vbad080f1" position="float"/>
    </fig>
    <p>To ensure ease of use and stability, we provide a .yaml file to build a custom conda environment which is available in the <italic toggle="yes">snHiC</italic>’s GitHub repository (snHiC/workflow/envs/snHiC_conda_env_stable.yaml).</p>
    <p>The minimal pipeline consists of a snakemake file, containing the rules to be executed, and a yaml-formatted configuration file. The latter contains all the parameters that can be customized by the user (for details, see the dedicate GitHub Wiki) and is subdivided in two parts: (i) experiment-specific parameters (e.g., reference genome, restriction enzyme used, inclusion or not of specific analyses); (ii) default parameters suitable for most of the experiments (e.g., normalization and correction methods, filters, software-specific parameters). If the user aims to perform grouped analyses, a sample configuration table is required. This table indicates to which group each sample belongs and is used to define which samples should be merged and analyzed together (e.g., replicates, tissue type, experimental conditions, etc.).</p>
    <sec>
      <title>2.1 Fastq mapping and contact matrices</title>
      <p>To reduce computation time, the fastq files are aligned using the accelerated version of the Burrows-Wheeler Aligner (<italic toggle="yes">BWA</italic>) (<xref rid="vbad080-B10" ref-type="bibr">Vasimuddin <italic toggle="yes">et al.</italic>, 2019</xref>). In order to account for the chimeric reads generated by the Hi-C library preparation procedure, specific BWA options are used: ‘<italic toggle="yes">bwa-mem2 mem -A1 -B4 -E50 -L0</italic>’.</p>
      <p>The aligned reads are then processed using <italic toggle="yes">HiCExplorer</italic> (<xref rid="vbad080-B11" ref-type="bibr">Wolff <italic toggle="yes">et al.</italic>, 2020</xref>) to generate Hi-C contact matrices (<italic toggle="yes">hicBuildMatrix</italic>) in .h5/.cool/.hicpro format which are then normalized (<italic toggle="yes">hicNormalize</italic>) among all the samples and corrected for technical biases (<italic toggle="yes">hicCorrectMatrix</italic>).</p>
      <p>Notably, matrices at multiple resolutions can be computed sequentially in one single run, by merging <italic toggle="yes">n</italic> contiguous bins in the lowest resolution matrix (<italic toggle="yes">hicMergeMatrixBins</italic>). When sample groups are specified, new group matrices are generated by summing the matrices of the individual samples (<italic toggle="yes">hicSumMatrices</italic>).</p>
    </sec>
    <sec>
      <title>2.2 Hi-C quality controls and sample correlation</title>
      <p>The <italic toggle="yes">snHiC</italic> pipeline generates multiple quality control files including a ‘diagnostic plot’ showing the distribution of the coverage per bin, a Hi-C MultiQC report (including library depth, <italic toggle="yes">cis</italic>-to-<italic toggle="yes">trans</italic> contacts distribution, length of the contacts, etc.), distribution of the intra-chromosomal distance and, sample correlation heatmaps and scatter plots.</p>
      <p>Differential chromatin interactions among groups can be performed for each chromosome by <italic toggle="yes">SELFISH</italic> (<xref rid="vbad080-B2" ref-type="bibr">Ardakany <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>2.3 TADs, loops, stripes and compartments calling</title>
      <p>For each sample/group, TADs [<italic toggle="yes">HiCExplorer</italic> or <italic toggle="yes">GENOVA</italic> (<xref rid="vbad080-B9" ref-type="bibr">van der Weide <italic toggle="yes">et al.</italic>, 2021</xref>)], loops [<italic toggle="yes">HiCExplorer</italic> or <italic toggle="yes">Mustache</italic> (<xref rid="vbad080-B8" ref-type="bibr">Roayaei Ardakany <italic toggle="yes">et al.</italic>, 2020</xref>)] and stripes [<italic toggle="yes">STRIPENN</italic> (<xref rid="vbad080-B12" ref-type="bibr">Yoon <italic toggle="yes">et al.</italic>, 2022</xref>)].</p>
      <p>The A/B compartment calling and differential compartment analyses are performed by <italic toggle="yes">dcHiC</italic> (<xref rid="vbad080-B3" ref-type="bibr">Chakraborty <italic toggle="yes">et al.</italic>, 2022</xref>) at all user-defined Hi-C resolutions. This tool allows for the selection of the best Principal Component (PC) in calling compartments, performs multivariate differential comparison of Hi-C datasets at high-resolution (up to 5 kb), and provides IGV-reports to directly visualize the results.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>In this work, we introduce <italic toggle="yes">snHiC</italic>, a new snakemake-based pipeline to facilitate Hi-C data analyses. The strength of this workflow is that automates and standardizes the processing of Hi-C data, providing an all-in-one tool to perform diverse analysis types (i.e. TADs, loops, stripes) as well as inter-group differential analyses (i.e. compartments and chromatin interactions).</p>
    <p>Furthermore, the outputs of this pipeline are compatible with the most commonly used Hi-C visualization tools/packages—available in the conda environment—such as <italic toggle="yes">GENOVA</italic> (<xref rid="vbad080-B9" ref-type="bibr">van der Weide <italic toggle="yes">et al.</italic>, 2021</xref>), <italic toggle="yes">HiCPlotter</italic> (<xref rid="vbad080-B1" ref-type="bibr">Akdemir and Chin, 2015</xref>) and <italic toggle="yes">pyGenomeTracks</italic> (<xref rid="vbad080-B7" ref-type="bibr">Lopez-Delisle <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad080_Supplementary_Data</label>
      <media xlink:href="vbad080_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to acknowledge the Research High Performance Computing (RHPC) facility of the Netherlands Cancer Institute (NKI) to have enabled us to perform all the computations required to implement and test this pipeline, and the NKI Genomics Core Facility for bioinformatics support. We express gratitude also to Tesa M. Severson, Joseph Siefert and the other members of the Zwart lab for the helpful scientific discussions.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Oncode Institute.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad080-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akdemir</surname><given-names>K.C.</given-names></string-name>, <string-name><surname>Chin</surname><given-names>L.</given-names></string-name></person-group> (<year>2015</year>) <article-title>HiCPlotter integrates genomic data with interaction matrices</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>198</fpage>.<pub-id pub-id-type="pmid">26392354</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ardakany</surname><given-names>A.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Selfish: discovery of differential chromatin interactions via a self-similarity measure</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i145</fpage>–<lpage>i153</lpage>.<pub-id pub-id-type="pmid">31510653</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chakraborty</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>dcHiC detects differential compartments across multiple Hi-C datasets</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>6827</fpage>.<pub-id pub-id-type="pmid">36369226</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Computational tools for Hi-C data analysis</article-title>. <source>Quant. Biol</source>., <volume>5</volume>, <fpage>215</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hansen</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Computational processing and quality control of Hi-C, capture Hi-C and Capture-C data</article-title>. <source>Genes</source>, <volume>10</volume>, <fpage>548</fpage>.<pub-id pub-id-type="pmid">31323892</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Comprehensive mapping of long range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez-Delisle</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>pyGenomeTracks: reproducible plots for multivariate genomic datasets</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>422</fpage>–<lpage>423</lpage>.<pub-id pub-id-type="pmid">32745185</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roayaei Ardakany</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Mustache: multi-scale detection of chromatin loops from Hi-C and Micro-C maps using scale-space representation</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>256</fpage>.<pub-id pub-id-type="pmid">32998764</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Weide</surname><given-names>R.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Hi-C analyses with GENOVA: a case study with cohesin variants</article-title>. <source>NAR Genomics Bioinf</source>., <volume>3</volume>, <fpage>lqab040</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Vasimuddin</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) Efficient Architecture-Aware Acceleration of BWA-MEM for Multicore Systems. In: <italic toggle="yes">2019 IEEE International Parallel and Distributed Processing Symposium (IPDPS)</italic>, Rio de Janeiro, Brazil, pp. <fpage>314</fpage>–<lpage>324</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolff</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>W177</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">32301980</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoon</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Stripenn detects architectural stripes from chromatin conformation data using computer vision</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>1602</fpage>.<pub-id pub-id-type="pmid">35332165</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10307938</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad080</article-id>
    <article-id pub-id-type="publisher-id">vbad080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">snHiC</italic>: a complete and simplified snakemake pipeline for grouped Hi-C data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9209-5403</contrib-id>
        <name>
          <surname>Gregoricchio</surname>
          <given-names>Sebastian</given-names>
        </name>
        <aff><institution>Division of Oncogenomics, Netherlands Cancer Institute, Oncode Institute</institution>, 1066CX Amsterdam, <country country="NL">The Netherlands</country></aff>
        <xref rid="vbad080-cor1" ref-type="corresp"/>
        <!--s.gregoricchio@nki.nl-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9823-7289</contrib-id>
        <name>
          <surname>Zwart</surname>
          <given-names>Wilbert</given-names>
        </name>
        <aff><institution>Division of Oncogenomics, Netherlands Cancer Institute, Oncode Institute</institution>, 1066CX Amsterdam, <country country="NL">The Netherlands</country></aff>
        <xref rid="vbad080-cor1" ref-type="corresp"/>
        <!--w.zwart@nki.nl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Fraternali</surname>
          <given-names>Franca</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad080-cor1">To whom correspondence should be addressed. <email>s.gregoricchio@nki.nl</email> or <email>w.zwart@nki.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-21">
      <day>21</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad080</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Genome-wide chromosome conformation capture (Hi-C) is a technique that allows the study of 3D genome organization. Despite being widely used, analysis of Hi-C data is technically challenging and involves several time-consuming steps that often require manual involvement making it error prone, potentially affecting data reproducibility. In order to facilitate and simplify these analyses we implemented <italic toggle="yes">snHiC</italic>, a snakemake-based pipeline that allows for the generation of contact matrices at multiple resolutions in one single run, aggregation of individual samples into user-specified groups, detection of domains, compartments, loops and stripes and performance of differential compartment and chromatin interaction analyses.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Source code is freely available at <ext-link xlink:href="https://github.com/sebastian-gregoricchio/snHiC" ext-link-type="uri">https://github.com/sebastian-gregoricchio/snHiC</ext-link>. A yaml-formatted file (snHiC/workflow/envs/snHiC_conda_env_stable.yaml) is available to build a compatible conda environment.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Oncode Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/501100021821</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In the past decades, the epigenetics field has been revolutionized by the introduction of new techniques that allow for the interrogation of long-range DNA–DNA interactions and enable researchers to study the genome organization in three-dimensional space. Genome-wide chromosome conformation capture (Hi-C) (<xref rid="vbad080-B6" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>) is considered one of the most advanced 3D genome analysis technologies. Hi-C, coupled to high-throughput sequencing, allows for the identification of DNA–DNA physical contacts that occur between regions contacting in 3D genome space while localized several megabase-pairs (Mb) away from each other in the linear genome.</p>
    <p>The use of Hi-C in biomedical research is quickly increasing, but the analysis of these data remains challenging. Indeed, in contrast to RNA-seq and Chromatin ImmunoPrecipitation (ChIP)-seq data for which golden standard file formats are available, many different tools with their corresponding formats exist for the analysis of Hi-C data.</p>
    <p>While many different pipelines are available for the analysis of Hi-C data [reviewed in <xref rid="vbad080-B4" ref-type="bibr">Han and Wei (2017)</xref> and <xref rid="vbad080-B5" ref-type="bibr">Hansen <italic toggle="yes">et al.</italic> (2019)</xref>], only few of them include a comprehensive generation of downstream data such as Topologically Associated Domains (TADs) calls, loops and stripes calls, A/B compartments and differential compartmentalization and interactions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
    <p>With the implementation of <italic toggle="yes">snHiC</italic> (publicly available at <ext-link xlink:href="https://github.com/sebastian-gregoricchio/snHiC" ext-link-type="uri">https://github.com/sebastian-gregoricchio/snHiC</ext-link>) we aim to fill these gaps by providing a user-friendly snakemake-based pipeline for a complete and customizable analysis of Hi-C data with the possibility to automatically repeat the same analyses by sample group and multiple resolutions.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>Our pipeline, <italic toggle="yes">snHiC</italic>, is a workflow organized in different sequential steps (rules) managed by a snakemake system (<xref rid="vbad080-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data</xref>). The input data required for the pipeline are paired-end fastq files that are mapped to the reference genome and subsequently processed to generate normalized and corrected contact matrices, to ensure reproducibility and consistency in output data (as opposed to preprocessed contact matrices). Subsequently, the contact matrices are then used to detect TADs, loops, stripes and A/B compartments. Furthermore, <italic toggle="yes">snHiC</italic> can also perform differential Hi-C chromatin interactions and compartments analyses between sample groups.</p>
    <fig position="float" id="vbad080-F1">
      <label>Figure 1.</label>
      <caption>
        <p><italic toggle="yes">snHiC</italic> pipeline workflow. Sequential steps are performed in the <italic toggle="yes">snHiC</italic> pipeline starting from paired-end.fastq files (indicated by the bold box border). Software/tools/functions used in each step are indicated by rectangular boxes, while output files generated are indicated in either folded-corner boxes (text files and plots) or wave-bottom boxes (Hi-C data files, such as alignment files or contact matrices). Computational interactions are indicated by diamonds, while key user defined parameters collected from the groups_configuration file are contained in the trapezoid box</p>
      </caption>
      <graphic xlink:href="vbad080f1" position="float"/>
    </fig>
    <p>To ensure ease of use and stability, we provide a .yaml file to build a custom conda environment which is available in the <italic toggle="yes">snHiC</italic>’s GitHub repository (snHiC/workflow/envs/snHiC_conda_env_stable.yaml).</p>
    <p>The minimal pipeline consists of a snakemake file, containing the rules to be executed, and a yaml-formatted configuration file. The latter contains all the parameters that can be customized by the user (for details, see the dedicate GitHub Wiki) and is subdivided in two parts: (i) experiment-specific parameters (e.g., reference genome, restriction enzyme used, inclusion or not of specific analyses); (ii) default parameters suitable for most of the experiments (e.g., normalization and correction methods, filters, software-specific parameters). If the user aims to perform grouped analyses, a sample configuration table is required. This table indicates to which group each sample belongs and is used to define which samples should be merged and analyzed together (e.g., replicates, tissue type, experimental conditions, etc.).</p>
    <sec>
      <title>2.1 Fastq mapping and contact matrices</title>
      <p>To reduce computation time, the fastq files are aligned using the accelerated version of the Burrows-Wheeler Aligner (<italic toggle="yes">BWA</italic>) (<xref rid="vbad080-B10" ref-type="bibr">Vasimuddin <italic toggle="yes">et al.</italic>, 2019</xref>). In order to account for the chimeric reads generated by the Hi-C library preparation procedure, specific BWA options are used: ‘<italic toggle="yes">bwa-mem2 mem -A1 -B4 -E50 -L0</italic>’.</p>
      <p>The aligned reads are then processed using <italic toggle="yes">HiCExplorer</italic> (<xref rid="vbad080-B11" ref-type="bibr">Wolff <italic toggle="yes">et al.</italic>, 2020</xref>) to generate Hi-C contact matrices (<italic toggle="yes">hicBuildMatrix</italic>) in .h5/.cool/.hicpro format which are then normalized (<italic toggle="yes">hicNormalize</italic>) among all the samples and corrected for technical biases (<italic toggle="yes">hicCorrectMatrix</italic>).</p>
      <p>Notably, matrices at multiple resolutions can be computed sequentially in one single run, by merging <italic toggle="yes">n</italic> contiguous bins in the lowest resolution matrix (<italic toggle="yes">hicMergeMatrixBins</italic>). When sample groups are specified, new group matrices are generated by summing the matrices of the individual samples (<italic toggle="yes">hicSumMatrices</italic>).</p>
    </sec>
    <sec>
      <title>2.2 Hi-C quality controls and sample correlation</title>
      <p>The <italic toggle="yes">snHiC</italic> pipeline generates multiple quality control files including a ‘diagnostic plot’ showing the distribution of the coverage per bin, a Hi-C MultiQC report (including library depth, <italic toggle="yes">cis</italic>-to-<italic toggle="yes">trans</italic> contacts distribution, length of the contacts, etc.), distribution of the intra-chromosomal distance and, sample correlation heatmaps and scatter plots.</p>
      <p>Differential chromatin interactions among groups can be performed for each chromosome by <italic toggle="yes">SELFISH</italic> (<xref rid="vbad080-B2" ref-type="bibr">Ardakany <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>2.3 TADs, loops, stripes and compartments calling</title>
      <p>For each sample/group, TADs [<italic toggle="yes">HiCExplorer</italic> or <italic toggle="yes">GENOVA</italic> (<xref rid="vbad080-B9" ref-type="bibr">van der Weide <italic toggle="yes">et al.</italic>, 2021</xref>)], loops [<italic toggle="yes">HiCExplorer</italic> or <italic toggle="yes">Mustache</italic> (<xref rid="vbad080-B8" ref-type="bibr">Roayaei Ardakany <italic toggle="yes">et al.</italic>, 2020</xref>)] and stripes [<italic toggle="yes">STRIPENN</italic> (<xref rid="vbad080-B12" ref-type="bibr">Yoon <italic toggle="yes">et al.</italic>, 2022</xref>)].</p>
      <p>The A/B compartment calling and differential compartment analyses are performed by <italic toggle="yes">dcHiC</italic> (<xref rid="vbad080-B3" ref-type="bibr">Chakraborty <italic toggle="yes">et al.</italic>, 2022</xref>) at all user-defined Hi-C resolutions. This tool allows for the selection of the best Principal Component (PC) in calling compartments, performs multivariate differential comparison of Hi-C datasets at high-resolution (up to 5 kb), and provides IGV-reports to directly visualize the results.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>In this work, we introduce <italic toggle="yes">snHiC</italic>, a new snakemake-based pipeline to facilitate Hi-C data analyses. The strength of this workflow is that automates and standardizes the processing of Hi-C data, providing an all-in-one tool to perform diverse analysis types (i.e. TADs, loops, stripes) as well as inter-group differential analyses (i.e. compartments and chromatin interactions).</p>
    <p>Furthermore, the outputs of this pipeline are compatible with the most commonly used Hi-C visualization tools/packages—available in the conda environment—such as <italic toggle="yes">GENOVA</italic> (<xref rid="vbad080-B9" ref-type="bibr">van der Weide <italic toggle="yes">et al.</italic>, 2021</xref>), <italic toggle="yes">HiCPlotter</italic> (<xref rid="vbad080-B1" ref-type="bibr">Akdemir and Chin, 2015</xref>) and <italic toggle="yes">pyGenomeTracks</italic> (<xref rid="vbad080-B7" ref-type="bibr">Lopez-Delisle <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad080_Supplementary_Data</label>
      <media xlink:href="vbad080_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to acknowledge the Research High Performance Computing (RHPC) facility of the Netherlands Cancer Institute (NKI) to have enabled us to perform all the computations required to implement and test this pipeline, and the NKI Genomics Core Facility for bioinformatics support. We express gratitude also to Tesa M. Severson, Joseph Siefert and the other members of the Zwart lab for the helpful scientific discussions.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Oncode Institute.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad080-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akdemir</surname><given-names>K.C.</given-names></string-name>, <string-name><surname>Chin</surname><given-names>L.</given-names></string-name></person-group> (<year>2015</year>) <article-title>HiCPlotter integrates genomic data with interaction matrices</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>198</fpage>.<pub-id pub-id-type="pmid">26392354</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ardakany</surname><given-names>A.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Selfish: discovery of differential chromatin interactions via a self-similarity measure</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i145</fpage>–<lpage>i153</lpage>.<pub-id pub-id-type="pmid">31510653</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chakraborty</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>dcHiC detects differential compartments across multiple Hi-C datasets</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>6827</fpage>.<pub-id pub-id-type="pmid">36369226</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Computational tools for Hi-C data analysis</article-title>. <source>Quant. Biol</source>., <volume>5</volume>, <fpage>215</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hansen</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Computational processing and quality control of Hi-C, capture Hi-C and Capture-C data</article-title>. <source>Genes</source>, <volume>10</volume>, <fpage>548</fpage>.<pub-id pub-id-type="pmid">31323892</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Comprehensive mapping of long range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez-Delisle</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>pyGenomeTracks: reproducible plots for multivariate genomic datasets</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>422</fpage>–<lpage>423</lpage>.<pub-id pub-id-type="pmid">32745185</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roayaei Ardakany</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Mustache: multi-scale detection of chromatin loops from Hi-C and Micro-C maps using scale-space representation</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>256</fpage>.<pub-id pub-id-type="pmid">32998764</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Weide</surname><given-names>R.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Hi-C analyses with GENOVA: a case study with cohesin variants</article-title>. <source>NAR Genomics Bioinf</source>., <volume>3</volume>, <fpage>lqab040</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Vasimuddin</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) Efficient Architecture-Aware Acceleration of BWA-MEM for Multicore Systems. In: <italic toggle="yes">2019 IEEE International Parallel and Distributed Processing Symposium (IPDPS)</italic>, Rio de Janeiro, Brazil, pp. <fpage>314</fpage>–<lpage>324</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad080-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolff</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>W177</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">32301980</pub-id></mixed-citation>
    </ref>
    <ref id="vbad080-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoon</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Stripenn detects architectural stripes from chromatin conformation data using computer vision</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>1602</fpage>.<pub-id pub-id-type="pmid">35332165</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
