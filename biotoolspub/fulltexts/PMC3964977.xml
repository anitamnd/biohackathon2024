<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub November-12-2013?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3964977</article-id>
    <article-id pub-id-type="pmid">24225318</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkt1065</article-id>
    <article-id pub-id-type="publisher-id">gkt1065</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>V. Human genome, model organisms, comparative genomics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Selectome update: quality control and computational improvements to a database of positive selection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Moretti</surname>
          <given-names>Sébastien</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="gkt1065-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laurenczy</surname>
          <given-names>Balazs</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gharib</surname>
          <given-names>Walid H.</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Castella</surname>
          <given-names>Briséïs</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuzniar</surname>
          <given-names>Arnold</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schabauer</surname>
          <given-names>Hannes</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Studer</surname>
          <given-names>Romain A.</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valle</surname>
          <given-names>Mario</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salamin</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stockinger</surname>
          <given-names>Heinz</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson-Rechavi</surname>
          <given-names>Marc</given-names>
        </name>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkt1065-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="gkt1065-COR2">*</xref>
      </contrib>
      <aff id="gkt1065-AFF1"><sup>1</sup>Department of Ecology and Evolution, Biophore, University of Lausanne, CH-1015 Lausanne, Switzerland, <sup>2</sup>Evolutionary Bioinformatics group, SIB Swiss Institute of Bioinformatics, CH-1015 Lausanne, Switzerland, <sup>3</sup>Vital-IT group, SIB Swiss Institute of Bioinformatics, CH-1015 Lausanne, Switzerland, <sup>4</sup>Computational Phylogenetics group, SIB Swiss Institute of Bioinformatics, CH-1015 Lausanne, Switzerland, <sup>5</sup>Division of Biosciences, Institute of Structural and Molecular Biology, University College London, Gower Street, London, WC1E 6BT, UK and <sup>6</sup>Swiss National Supercomputing Centre (CSCS), CH-6900, Lugano, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <corresp id="gkt1065-COR2">*To whom correspondence should be addressed. Tel: <phone>+41 692 4221</phone>; Fax: <fax>+41 21 692 4165</fax>; Email: <email>Sebastien.Moretti@unil.ch</email></corresp>
      <corresp id="gkt1065-COR1">Correspondence may also be addressed to Marc Robinson-Rechavi. Tel: <phone>+41 21 692 4220</phone>; Fax: <fax>+41 21 692 4165</fax>; Email: <email>marc.robinson-rechavi@unil.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>11</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>11</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>42</volume>
    <issue>Database issue</issue>
    <issue-title>Database issue</issue-title>
    <fpage>D917</fpage>
    <lpage>D921</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>9</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>10</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</uri>), which permits non-commercial reuse, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Selectome (<ext-link ext-link-type="uri" xlink:href="http://selectome.unil.ch/">http://selectome.unil.ch/</ext-link>) is a database of positive selection, based on a branch-site likelihood test. This model estimates the number of nonsynonymous substitutions (dN) and synonymous substitutions (dS) to evaluate the variation in selective pressure (dN/dS ratio) over branches and over sites. Since the original release of Selectome, we have benchmarked and implemented a thorough quality control procedure on multiple sequence alignments, aiming to provide minimum false-positive results. We have also improved the computational efficiency of the branch-site test implementation, allowing larger data sets and more frequent updates. Release 6 of Selectome includes all gene trees from Ensembl for Primates and Glires, as well as a large set of vertebrate gene trees. A total of 6810 gene trees have some evidence of positive selection. Finally, the web interface has been improved to be more responsive and to facilitate searches and browsing.</p>
    </abstract>
    <counts>
      <page-count count="5"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>1 January 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>INTRODUCTION</title>
    <p>Selectome is a database of positive selection (<xref rid="gkt1065-B1" ref-type="bibr">1</xref>). It provides users with access to precomputed estimates of positive selection from the branch-site test (<xref rid="gkt1065-B2" ref-type="bibr">2</xref>) mapped to branches of gene trees (including speciations and duplications), and to amino-acid sites of multiple sequence alignments (MSAs). This allows the detection of episodic selection, which is an important component of protein evolution (<xref rid="gkt1065-B3" ref-type="bibr">3</xref>). Selectome's first release was based on TreeFam A (PLACEHOLDER FOR NAR DATABASE UPDATE). While this choice was made to ensure high quality, it posed two problems: one is that TreeFam A was, by design, incomplete, and the other is that TreeFam has not been regularly updated. We have thus decided to move to Ensembl Compara (<xref rid="gkt1065-B4" ref-type="bibr">4</xref>) to receive gene trees and MSAs. Ensembl Compara provides a set of gene trees and MSAs as complete as possible, updated with every release of Ensembl (<xref rid="gkt1065-B5" ref-type="bibr">5</xref>). Moreover, using Ensembl's gene trees and MSAs allow easy extension to other taxonomic groups, which are covered by the Ensembl Genomes projects (<xref rid="gkt1065-B6" ref-type="bibr">6</xref>).</p>
    <p>The transition from TreeFam A to TreeFam A + B then to Ensembl Compara has raised two major challenges: (i) computing branch-site positive selection (<xref rid="gkt1065-B2" ref-type="bibr">2</xref>) on hundreds of thousands of branches from thousands of gene trees is a major computational challenge, especially considering that CodeML from PAML (<xref rid="gkt1065-B7" ref-type="bibr">7</xref>) has never been optimized with respect to computational efficiency; (ii) the MSAs provided by the automated Compara pipeline, while sufficient for many purposes, contain many misaligned regions, which induce false positives in tests for positive selection, especially for the branch-site test (<xref rid="gkt1065-B8" ref-type="bibr">8–10</xref>) (the same is true of other pipelines). These false-positive issues led us to label ‘<italic>beta</italic>’ several releases after the transition away from TreeFam A.</p>
    <p>We present the latest release of Selectome (release 6), which is the first release based on Ensembl Compara to take advantage of improvements concerning both computational efficiency and MSA quality control.</p>
  </sec>
  <sec>
    <title>CHANGES IN DATABASE CONTENT</title>
    <p>A summary of the content of Selectome release 6 is presented in <xref ref-type="table" rid="gkt1065-T1">Table 1</xref>. We define taxon-specific subtrees as monophyletic groups, which contain only sequences from the target taxon (<xref ref-type="fig" rid="gkt1065-F1">Figure 1</xref>). We have computed branch-site tests for positive selection for all internal branches of all gene trees of Primates and of Glires, which contained at least six sequences (leaves of the subtree) after alignment quality control. We have also computed the tests for all internal branches of small- to medium-sized gene trees, which cover all Euteleostomi. As in previous releases of Selectome (<xref rid="gkt1065-B1" ref-type="bibr">1</xref>), multiple testing is controlled with a q-value of 10% computed over the union of all test results (all branches, all trees); this was done separately for each taxonomic group (i.e. Primates, Glires, Euteleostomi).
<fig id="gkt1065-F1" position="float"><label>Figure 1.</label><caption><p>Selectome subtrees from Ensembl Compara gene tree. Left, the tree for human gene ENSGT00410000025651 from Ensembl release 68. Right, the subtrees selected for use in Selectome. Note that (i) as the tree is rooted in <italic>Amniota</italic> (i.e. there are no homologs detected outside <italic>Amniota</italic>), which is a subset of <italic>Euteleostomi</italic>, this node was chosen for the subtree for <italic>Euteleostomi</italic>; (ii) there are four <italic>Primate</italic> subtrees, due to gene duplications; (iii) only the <italic>Glires</italic> subtree with at least six sequences was used; (iv) some <italic>Primate</italic> or <italic>Glires</italic> subtrees can differ from the Ensembl tree because they use later Ensembl releases (<xref ref-type="table" rid="gkt1065-T1">Table 1</xref>).</p></caption><graphic xlink:href="gkt1065f1p"/></fig>
<table-wrap id="gkt1065-T1" position="float"><label>Table 1.</label><caption><p>Statistics on release 06 of Selectome</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Taxonomic group</th><th rowspan="1" colspan="1">Species number</th><th rowspan="1" colspan="1">Ensembl release</th><th colspan="4" align="center" rowspan="1">Subtrees<xref ref-type="table-fn" rid="gkt1065-TF1"><sup>a</sup></xref><hr/></th><th colspan="2" align="center" rowspan="1">Sequences per subtree<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Total</th><th rowspan="1" colspan="1">Filtered<xref ref-type="table-fn" rid="gkt1065-TF2"><sup>b</sup></xref></th><th rowspan="1" colspan="1">Computed</th><th rowspan="1" colspan="1">With positive selection</th><th rowspan="1" colspan="1">Median</th><th rowspan="1" colspan="1">Max</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Euteleostomi</td><td rowspan="1" colspan="1">54</td><td rowspan="1" colspan="1">68</td><td rowspan="1" colspan="1">19 940</td><td rowspan="1" colspan="1">15 923</td><td rowspan="1" colspan="1">13 695<xref ref-type="table-fn" rid="gkt1065-TF3"><sup>c</sup></xref></td><td rowspan="1" colspan="1">6543</td><td rowspan="1" colspan="1">32</td><td rowspan="1" colspan="1">139</td></tr><tr><td rowspan="1" colspan="1">Glires</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">71</td><td rowspan="1" colspan="1">20 114</td><td rowspan="1" colspan="1">4656<xref ref-type="table-fn" rid="gkt1065-TF4"><sup>d</sup></xref></td><td rowspan="1" colspan="1">4656</td><td rowspan="1" colspan="1">136</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">257</td></tr><tr><td rowspan="1" colspan="1">Primates</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">20 300</td><td rowspan="1" colspan="1">15 738</td><td rowspan="1" colspan="1">15 738</td><td rowspan="1" colspan="1">131</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">180</td></tr></tbody></table><table-wrap-foot><fn id="gkt1065-TF1"><p><sup>a</sup>Pruned from larger Ensembl Compara trees, according to the taxonomic group.</p></fn><fn id="gkt1065-TF2"><p><sup>b</sup>Subtrees with at least six sequences after alignment quality filtering.</p></fn><fn id="gkt1065-TF3"><p><sup>c</sup>The largest gene trees were not computed.</p></fn><fn id="gkt1065-TF4"><p><sup>d</sup>Many Glires subtrees do not have six sequences before or after our filtering.</p></fn></table-wrap-foot></table-wrap></p>
    <p>Since Selectome is now based on Ensembl, all cross-references, taxonomic information, keywords, and other information are now from Ensembl, and no longer from TreeFam.</p>
    <p>We have first tackled the computational challenge of updating Selectome by a better use of computing infrastructure. CodeML has been ported to the Swiss multi-scientific computing grid SMSCG (<ext-link ext-link-type="uri" xlink:href="http://www.smscg.ch">http://www.smscg.ch</ext-link>). All computations for Primates data were done on this infrastructure, using a customized GC3pie framework (<xref rid="gkt1065-B11" ref-type="bibr">11</xref>), which notably manages submissions and error messages. We experienced a failure rate of 0.7%, i.e. submission/execution issues that are due to the Grid infrastructure (including exceeding allocated execution time for single jobs). All erroneous jobs were successfully resubmitted. Thus, 67 054 job pairs (H0 and H1 hypotheses of the test sequentially on the same node) were successfully computed on SMSCG, and 276 were computed on the Vital-IT computer cluster (<ext-link ext-link-type="uri" xlink:href="http://www.vital-it.ch">http://www.vital-it.ch</ext-link>), because they exceeded the runtime limit of SMSCG.</p>
    <p>Secondly, we have optimized CodeML for the branch-site test. Briefly, SlimCodeML (<xref rid="gkt1065-B12" ref-type="bibr">12</xref>) is an optimized sequential version of CodeML, which provides identical results to the original code. All computations for Euteleostomi and Glires were performed using SlimCodeML on the Vital-IT cluster. For Euteleostomi, the 2228 largest subtrees were not computed because of time limitations on the cluster. This showed again an intrinsic performance/scalability problem of (Slim)CodeML with respect to large data sets.</p>
    <p>In the original Selectome pipeline, poorly aligned regions were removed using GBLOCKS (<xref rid="gkt1065-B13" ref-type="bibr">13</xref>), but both our experience and published benchmarks (<xref rid="gkt1065-B8" ref-type="bibr">8–10</xref>,<xref rid="gkt1065-B14" ref-type="bibr">14</xref>) indicate that this is insufficient to remove unreliable regions of MSAs, which cause false positives for the branch-site test of positive selection. The Selectome pipeline now includes the following: realignment with PAGAN (<xref rid="gkt1065-B15" ref-type="bibr">15</xref>); masking of amino-acids that have a low consistency score from M-Coffee (<xref rid="gkt1065-B16" ref-type="bibr">16</xref>); and masking of amino-acids that have a low score from GUIDANCE (<xref rid="gkt1065-B17" ref-type="bibr">17</xref>). In addition, MaxAlign (<xref rid="gkt1065-B18" ref-type="bibr">18</xref>) is used to remove sequences that have few unambiguous sites, relative to the rest of the alignment, and TrimAl (<xref rid="gkt1065-B19" ref-type="bibr">19</xref>) is used to remove columns with few unambiguous sites. Detailed procedures and thresholds for each release are provided at <ext-link ext-link-type="uri" xlink:href="http://selectome.unil.ch/cgi-bin/methods.cgi">http://selectome.unil.ch/cgi-bin/methods.cgi</ext-link>. Of note, Privman <italic>et al.</italic> (<xref rid="gkt1065-B14" ref-type="bibr">14</xref>) showed that the loss of true positives by filtering was outweighed by the removal of false positives. In total, 8.7% of MSA columns were removed before selection computations for Primates, versus 4.4% in Selectome 5 (GBLOCKS based pipeline); 12% of columns were removed for Glires, and 34% of columns for Euteleostomi, consistent with the expectation that more divergent sequences are more difficult to align reliably. More in detail, in Selectome 5, in Primates we identified 246 678 out of 1 149 639 sites (21%) as under positive selection, including long continuous stretches of ‘positively selected’ sites, which manual examination showed to be alignment or gene model errors [consistent with (<xref rid="gkt1065-B10" ref-type="bibr">10</xref>)]. In Selectome 6, filtering reduced the number of sites analyzed to 392 104, of which 61 119 are identified as under positive selection (16%); there are no more long stretches of sites, and manual inspection does not identify any obvious false positives. Further benchmarking of this pipeline shows that it masks not only MSA regions, which are difficult to align because of low complexity or alignment heuristics, but also gene model errors, which are a major source of false positives in MSAs from genomics (Moretti and Robinson-Rechavi, in preparation). By gene model errors, we mean errors in exon boundaries, in coding sequence start or stop, in prediction or choice of transcript from the gene; all these can lead to the alignment of nonhomologous sites.</p>
    <p>MSAs, which have less than six sequences or no aligned columns left after the filtering pipeline are not included in Selectome; this is notably the case for many Glires subtrees (<xref ref-type="table" rid="gkt1065-T1">Table 1</xref>).</p>
  </sec>
  <sec>
    <title>CHANGES IN WEB INTERFACE</title>
    <p>The Selectome web interface is similar to the original TreeFam interface, but with specific enrichments. We list here the main improvements of the interface since Selectome release 1.</p>
    <p>Improved search: For keyword search, queries are faster, thanks to the use of Sphinx (<ext-link ext-link-type="uri" xlink:href="http://sphinxsearch.com">http://sphinxsearch.com</ext-link>), and queries are automatically restricted to the most relevant field (e.g. gene, species, cross-reference), which can then be manually modified. For advanced search, a species tree of interest can be chosen (i.e. Euteleostomi, Primates, Glires). Query results can now be viewed by genes or by gene families (subtrees), and sorting is possible according to each column (e.g. selection, taxon, gene name). Moreover, results can be filtered by species or keyword.</p>
    <p>Improved graphical user interface: Each query result includes a preview of the gene tree with selection highlighted. On the gene family (subtree) view, positive selection is now indicated by a highlight of the whole branch, rather than a discrete box on the node; there is easy navigation between subtrees from the same Ensembl family; and it is possible to change the size of the gene tree image. For MSA visualization (with the annotation of detected sites under positive selection) in Jalview (<xref rid="gkt1065-B20" ref-type="bibr">20</xref>), unreliably aligned sites (not used for computation) can be masked (indicated by the character ‘x’). Finally, we provide a DAS service (<ext-link ext-link-type="uri" xlink:href="http://selectome.unil.ch/das/selectome">http://selectome.unil.ch/das/selectome</ext-link>) for integration with other resources [distributed annotation system (<xref rid="gkt1065-B21" ref-type="bibr">21</xref>)]. Selectome is also indexed and searchable by the ExPASy portal (<ext-link ext-link-type="uri" xlink:href="http://expasy.org/">http://expasy.org/</ext-link>), and external links to Ensembl point toward the version of Ensembl used for each result to ensure consistency; of note, linking to specific versions is not yet possible for Ensembl Genomes.</p>
  </sec>
  <sec>
    <title>CONCLUSIONS AND PERSPECTIVES</title>
    <p>Selectome presents, to our knowledge, the only phylogenomic database of branch-site positive selection (discussion of other resources in 1). The most significant progress since the first release is the improved MSA filtering, which dramatically reduces false positives, and allows us to use different input sources: if the input includes low-quality sequences, gene or transcript models or alignments, they are not used for positive selection inference. The use of Ensembl and the improved computational efficiency allow us to present for the first time a database with complete computations of branch-site positive selection for the two most studied mammalian clades: Primates, Glires. The next release of Selectome will also include the <italic>Drosophila</italic> clade.</p>
    <p>The major future challenge of Selectome is to further increase computational efficiency, to allow complete computations on large clades such as vertebrates (Euteleostomi), arthropods or green plants. The use of Ensembl and the existence of the Ensembl Genomes projects provide consistent data sources for most clades of interest. We have recently confirmed that the branch-site test can be reliably used even on deep nodes of such clades (<xref rid="gkt1065-B22" ref-type="bibr">22</xref>); the results of our partial release on Euteleostomi moreover confirm that with these larger gene trees, we have satisfactory power to detect positive selection (<xref ref-type="table" rid="gkt1065-T1">Table 1</xref>). The proportion of Euteleostomi genes with positive selection (48%) is lower than the 77% reported previously on a smaller sample (<xref rid="gkt1065-B23" ref-type="bibr">23</xref>) (biased toward genes conserved among vertebrates), but remains high, and should be further investigated. A potential problem, which we have not yet addressed, is synonymous rate variation between sites (<xref rid="gkt1065-B24" ref-type="bibr">24</xref>), which has been shown to be a problem for the site-test but has not been investigated for the branch-site test. As methods of detecting episodic positive selection improve, they will be taken into account in Selectome.</p>
    <p>Given the runtime issues for large data sets, we have developed a new, parallel and highly optimized software for the branch-site model: FastCodeML (Valle <italic>et al.</italic>, in preparation; <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.vital-it.ch/tools/FastCodeML/">ftp://ftp.vital-it.ch/tools/FastCodeML/</ext-link>). Tests show that running this software on a supercomputer allows computing positive selection even on the largest Ensembl Compara gene trees. Future Selectome releases will thus use FastCodeML on a mixture of commodity computers as well as large cluster computer systems and eventually computational grids. Our aim is to provide yearly updates that cover Ensembl-type data as completely as possible, given the constraints on MSA quality.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Project UNIL.5 (Grid/Selectome) of the <funding-source>‘AAA/SWITCH–e-infrastructure for e-science’</funding-source> program; the <funding-source>Swiss Platform for High-Performance and High-Productivity Computing (HP2C)</funding-source>; the <funding-source>Swiss National Science Foundation</funding-source> [<award-id>31003A 133011/1</award-id> to M.R.R. and <award-id>CR32I3_143768</award-id> to N.S. and M.R.R.]; <funding-source>Etat de Vaud</funding-source>; <funding-source>Fondation du 450ème anniversaire de l'Université de Lausanne</funding-source> and <funding-source>Swiss National Science Foundation</funding-source> [<award-id>132476</award-id> and <award-id>136477</award-id> to R.A.S.]. Cluster computations were performed at the Vital-IT (<ext-link ext-link-type="uri" xlink:href="http://www.vital-it.ch">http://www.vital-it.ch</ext-link>) Center for high-performance computing of the <funding-source>SIB Swiss Institute of Bioinformatics</funding-source>. Funding for open access charge: Etat de Vaud.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gkt1065-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Proux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Studer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Moretti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Selectome: a database of positive selection</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D404</fpage>
        <lpage>D407</lpage>
        <pub-id pub-id-type="pmid">18957445</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of an improved branch-site likelihood method for detecting positive selection at the molecular level</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2005</year>
        <volume>22</volume>
        <fpage>2472</fpage>
        <lpage>2479</lpage>
        <pub-id pub-id-type="pmid">16107592</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Studer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Evidence for an episodic model of protein sequence evolution</article-title>
        <source>Biochem. Soc. Trans.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>783</fpage>
        <lpage>786</lpage>
        <pub-id pub-id-type="pmid">19614594</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Severin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ureta-Vidal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>EnsemblCompara GeneTrees: complete, duplication-aware phylogenetic trees in vertebrates</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>327</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="pmid">19029536</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carvalho-Silva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Clapham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Coates</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fairley</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2013</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>D48</fpage>
        <lpage>D55</lpage>
        <pub-id pub-id-type="pmid">23203987</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kersey</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Staines</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kulesha</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Derwent</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Humphrey</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Keenan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kerhornou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koscielny</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl Genomes: an integrative resource for genome-scale data from non-vertebrate species</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D91</fpage>
        <lpage>D97</lpage>
        <pub-id pub-id-type="pmid">22067447</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>1586</fpage>
        <lpage>1591</lpage>
        <pub-id pub-id-type="pmid">17483113</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>The effect of insertions, deletions and alignment errors on the branch-site test of positive selection</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>2257</fpage>
        <lpage>2267</lpage>
        <pub-id pub-id-type="pmid">20447933</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jordan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The effects of alignment error and alignment filtering on the sitewise detection of positive selection</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>1125</fpage>
        <lpage>1139</lpage>
        <pub-id pub-id-type="pmid">22049066</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markova-Raina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Petrov</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>High sensitivity to aligner and high rate of false positives in the estimates of positive selection in the 12 Drosophila genomes</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>863</fpage>
        <lpage>874</lpage>
        <pub-id pub-id-type="pmid">21393387</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moretti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murri</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Maffioletti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kuzniar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Castella</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salamin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stockinger</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>gcodeml: a grid-enabled tool for detecting positive selection in biological evolution</article-title>
        <source>Stud. Health Technol. Inform.</source>
        <year>2012</year>
        <volume>175</volume>
        <fpage>59</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="pmid">22941988</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schabauer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Valle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pacher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stockinger</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salamin</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>SlimCodeML: an optimized version of CodeML for the branch-site model</article-title>
        <source>In: IEEE International Workshop on High Performance Computational Biology (HiCOMB’12) Shanghai</source>
        <year>2012</year>
        <publisher-loc>P.R. China</publisher-loc>
        <fpage>706</fpage>
        <lpage>714</lpage>
      </element-citation>
    </ref>
    <ref id="gkt1065-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Improvement of phylogenies after removing divergent and ambiguously aligned blocks from protein sequence alignments</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>564</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">17654362</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Privman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Penn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Pupko</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Improving the performance of positive selection inference by filtering unreliable alignment regions</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">21772063</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1684</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>O'Sullivan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>M-Coffee: combining multiple sequence alignment methods with T-Coffee</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>1692</fpage>
        <lpage>1699</lpage>
        <pub-id pub-id-type="pmid">16556910</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Penn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Privman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Landan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Graur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pupko</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An alignment confidence score capturing robustness to guide-tree uncertainty</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>1759</fpage>
        <lpage>1767</lpage>
        <pub-id pub-id-type="pmid">20207713</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouveia-Oliveira</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sackett</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MaxAlign: maximizing usable data in an alignment</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>312</fpage>
        <pub-id pub-id-type="pmid">17725821</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capella-Gutiérrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Silla-Martínez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1972</fpage>
        <lpage>1973</lpage>
        <pub-id pub-id-type="pmid">19505945</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Jalview Version 2—a multiple sequence alignment editor and analysis workbench</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jokerst</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>The distributed annotation system</article-title>
        <source>BMC Bioinformatics</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="pmid">11667947</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gharib</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The branch-site test of positive selection is surprisingly robust but lacks power under synonymous substitution saturation and variation in GC</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2013</year>
        <volume>30</volume>
        <fpage>1675</fpage>
        <lpage>1686</lpage>
        <pub-id pub-id-type="pmid">23558341</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Studer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Penel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duret</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pervasive positive selection on duplicated and nonduplicated vertebrate protein coding genes</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1393</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="pmid">18562677</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt1065-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubinstein</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Doron-Faigenboim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mayrose</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pupko</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary models accounting for layers of selection in protein-coding genes and their impact on the inference of positive selection</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2011</year>
        <volume>28</volume>
        <fpage>3297</fpage>
        <lpage>3308</lpage>
        <pub-id pub-id-type="pmid">21690564</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
