<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Med (Lausanne)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Med (Lausanne)</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Med.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2296-858X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7668389</article-id>
    <article-id pub-id-type="doi">10.3389/fmed.2020.597774</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Medicine</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PPGSynth: An Innovative Toolbox for Synthesizing Regular and Irregular Photoplethysmography Waveforms</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Qunfeng</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1088991/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Zhencheng</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1117505/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Allen</surname>
          <given-names>John</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/613289/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alian</surname>
          <given-names>Aymen</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1034374/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Menon</surname>
          <given-names>Carlo</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/76764/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ward</surname>
          <given-names>Rabab</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elgendi</surname>
          <given-names>Mohamed</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
        <xref ref-type="aff" rid="aff8">
          <sup>8</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/499556/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Electrical and Computer Engineering, University of British Columbia</institution>, <addr-line>Vancouver, BC</addr-line>, <country>Canada</country></aff>
    <aff id="aff2"><sup>2</sup><institution>School of Electronic Engineering and Automation, Guilin University of Electronic Technology</institution>, <addr-line>Guilin</addr-line>, <country>China</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Faculty of Medical Sciences, Population Health Sciences Institute, Newcastle University</institution>, <addr-line>Newcastle upon Tyne</addr-line>, <country>United Kingdom</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Research Centre for Intelligent Healthcare, Coventry University</institution>, <addr-line>Coventry</addr-line>, <country>United Kingdom</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Yale School of Medicine, Yale University</institution>, <addr-line>New Haven, CT</addr-line>, <country>United States</country></aff>
    <aff id="aff6"><sup>6</sup><institution>School of Mechatronic Systems Engineering, Simon Fraser University</institution>, <addr-line>Burnaby, BC</addr-line>, <country>Canada</country></aff>
    <aff id="aff7"><sup>7</sup><institution>Faculty of Medicine, University of British Columbia</institution>, <addr-line>Vancouver, BC</addr-line>, <country>Canada</country></aff>
    <aff id="aff8"><sup>8</sup><institution>BC Children's &amp; Women's Hospital</institution>, <addr-line>Vancouver, BC</addr-line>, <country>Canada</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Ovidiu Constantin Baltatu, Khalifa University, United Arab Emirates</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Paolo Crippa, Marche Polytechnic University, Italy; Aniruddha Sinha, Tata Consultancy Services, India</p>
      </fn>
      <corresp id="c001">*Correspondence: Mohamed Elgendi <email>moe.elgendi@gmail.com</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>This article was submitted to Translational Medicine, a section of the journal Frontiers in Medicine</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>02</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>597774</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Tang, Chen, Allen, Alian, Menon, Ward and Elgendi.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Tang, Chen, Allen, Alian, Menon, Ward and Elgendi</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Photoplethysmography (PPG) is increasingly used in digital health, exceptionally in smartwatches. The PPG signal contains valuable information about heart activity, and there is lots of research interest in its means and analysis for cardiovascular diseases. Unfortunately, to our knowledge, there is no arrhythmic PPG dataset publicly available—this paper attempt to provide a toolbox that can generate synthesized arrhythmic PPG signals. The model of a single PPG pulse in this toolbox utilizes two combined Gaussian functions. This toolbox supports synthesizing PPG waveform with regular heartbeats and three irregular heartbeats: compensation, interpolation, and reset. The user can generate a large amount of PPG data with a certain irregularity, with different sampling frequency, time length, and a range of noise types (Gaussian noise and multi-frequency noise) can be added to the synthesized PPG which can all be modified from the interface, and different types of arrhythmic PPGs (as calculated by the model) generated. The generation for large PPG datasets that simulate PPG collected from real humans could be used for testing the robustness of developed algorithms that are targeting arrhythmic PPG signals. Our PPG synthesis tool is publicly available.</p>
    </abstract>
    <kwd-group>
      <kwd>digital health</kwd>
      <kwd>data modeling</kwd>
      <kwd>data generation</kwd>
      <kwd>big data</kwd>
      <kwd>biosignal generation</kwd>
      <kwd>PPG construction</kwd>
      <kwd>signal simulation</kwd>
      <kwd>generative model</kwd>
    </kwd-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <equation-count count="6"/>
      <ref-count count="10"/>
      <page-count count="7"/>
      <word-count count="3686"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>Photoplethysmogram (PPG) signal contains rich information about the cardiovascular system (<xref rid="B1" ref-type="bibr">1</xref>). In the past decade, some studies have used PPG to calculate heart rate, oxygen saturation, blood pressure, cardiac output, cardiac index, peripheral vascular resistance, and other indicators of cardiovascular function, and many algorithms were developed to calculate these indices (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>Four PPG databases, at time of writing, are publicly available: Multiparameter Intelligent Monitoring in Intensive Care (MIMIC) (<xref rid="B3" ref-type="bibr">3</xref>), the University of Queensland Vital Signs Dataset (<xref rid="B4" ref-type="bibr">4</xref>), Vortal Dataset (<xref rid="B5" ref-type="bibr">5</xref>), and PPG-BP (<xref rid="B6" ref-type="bibr">6</xref>). The sampling frequency and time length of PPG signals are different in different databases; however, most algorithms designed for these databases are signal-independent. Additionally, it is still a challenge to evaluate the performance of these algorithms under different PPG types and different signal-to-noise ratios (SNR).</p>
    <p>PPGSynth is developed to generate PPG signals across a wider range of sampling frequencies and time lengths. Three types of irregular PPG signals also can be generated by the PPGSynth tool. It can also conveniently manage parameters and graphical output through a graphical user interface (GUI). This toolbox does not require highly experienced users, but it is recommended that you have basic knowledge of PPG signal and cardiac irregularities.</p>
  </sec>
  <sec id="s2">
    <title>2. Heartbeat Classification</title>
    <p>The amplitude, duration, and waveform shape of PPG pulses tend to vary between persons, and they even differ from moment to moment in the same person. Premature heartbeats are typical irregular PPG beats. There are two different types of premature heartbeats, premature atrial contractions and premature ventricular contractions. This study only focuses on irregular PPG signals that have premature atrial contractions. Premature atrial contraction changes the waveform of PPG for two consecutive beats. In this study, these two beats are defined as the premature group, and the first beat of the premature group and the second beat of the premature group are defined as the first beat and second beat, respectively. The beats without the influence of premature contractions are defined as reference beats. The first beat duration is always less than the reference beat duration. Based on the difference between the durations of the first beat and second beat, Roskamm and Csapo (<xref rid="B7" ref-type="bibr">7</xref>), classified heartbeats into four types: compensation, reset, interpolation, and re-entry. Based on their analysis, these four types are defined as follows:</p>
    <list list-type="bullet">
      <list-item>
        <p>Compensation: the second beat is prolonged, and the sum of the first beat duration and second beat duration is equal to the duration of two reference beats.</p>
      </list-item>
      <list-item>
        <p>Reset: the second beat is prolonged, but the sum of the first beat duration and second beat duration is less than the duration of two reference beats.</p>
      </list-item>
      <list-item>
        <p>Interpolation: the sum of the first beat duration and second beat duration is equal to one reference beat duration.</p>
      </list-item>
      <list-item>
        <p>Re-entry: the sum of the first beat duration and second beat duration is less than one reference beat duration. We could not find a template, within the four databases mentioned above, that satisfies the definition of re-entry. Therefore, the re-entry is not included in the current analysis.</p>
      </list-item>
    </list>
    <p>A previous attempt (<xref rid="B8" ref-type="bibr">8</xref>) on the use of heartbeat classification using ECG signals inspired the classification of heartbeats in PPG signals. Based on the previous heartbeat classification (<xref rid="B8" ref-type="bibr">8</xref>), <xref ref-type="fig" rid="F1">Figure 1A</xref> shows the regular heartbeats where the first beat, second beat, and third beat have equal durations (e.g., <italic>d</italic><sub>0</sub> = <italic>d</italic><sub>1</sub> = <italic>d</italic><sub>2</sub> = 1, 000 ms). On the other hand, <xref ref-type="fig" rid="F1">Figure 1B</xref> shows the compensation phase, the second beat (e.g., <italic>d</italic><sub>1</sub> = 850 ms) is followed by a prolonged beat (e.g., <italic>d</italic><sub>2</sub> = 1150 ms) to compensate the two beats duration of 2,000 ms. During the reset phase (<xref ref-type="fig" rid="F1">Figure 1C</xref>), the second beat (e.g., <italic>d</italic><sub>1</sub> = 650 ms) is followed by a prolonged beat (e.g., 1,150 ms), while in the interpolation (<xref ref-type="fig" rid="F1">Figure 1D</xref>), the second beat (e.g., <italic>d</italic><sub>1</sub> = 400 ms) is followed by an irregular beat (e.g., <italic>d</italic><sub>2</sub> = 600 ms).</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Types of heartbeat classification based sinus node response to atrial premature depolarization [adapted from (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B8" ref-type="bibr">8</xref>)]. <bold>(A)</bold> Regular: d<sub>0</sub> = d<sub>1</sub> = d<sub>2</sub>. <bold>(B)</bold> Compensation: d<sub>1</sub> + d<sub>2</sub> = 2d<sub>0</sub>. <bold>(C)</bold> Reset: d<sub>0</sub> &lt; d<sub>1</sub> + d<sub>2</sub> &lt; 2d<sub>0</sub>. <bold>(D)</bold> Interpolation: d<sub>1</sub> + d<sub>2</sub> = d<sub>0</sub>.</p>
      </caption>
      <graphic xlink:href="fmed-07-597774-g0001"/>
    </fig>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>3. Methodology</title>
    <p>The PPGSynth consists of three main parts: the model of a single PPG pulse, the pulse duration generator, and the noise generator.</p>
    <sec>
      <title>3.1. Model of Single PPG Pulse</title>
      <p>The single PPG pulse step is based on a recently published model (<xref rid="B9" ref-type="bibr">9</xref>) that simulates fingertip PPG waveforms. Note that the adopted model (<xref rid="B9" ref-type="bibr">9</xref>) is an early work on healthy subjects; however, this paper is about arrhythmic PPG beats relating to cardiovascular patient simulated recordings, which is definitely a new concept.</p>
      <p>The construction of a PPG waveform is regarded as a motion trajectory in the three-dimensional space established by the coordinate system (<italic>x, y, z</italic>). As shown in <xref ref-type="fig" rid="F2">Figure 2</xref>, the periodicity of PPG is represented by a circular motion.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Motion trajectory of a single synthesized PPG waveform. This figure shows how the Gaussian model simulates a heartbeat of a PPG waveform.</p>
        </caption>
        <graphic xlink:href="fmed-07-597774-g0002"/>
      </fig>
      <p>The motion trajectory in the (<italic>x, y</italic>) plane is the unit circle. One cycle of movement on the circle corresponds to a peak-to-peak interval or heartbeat. The trajectory in the <italic>z</italic> direction is the PPG signal. The systolic wave and diastolic wave are simulated in Gaussian functions. The equation of (<italic>x, y, z</italic>) is defined as follows:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1">
          <mml:mrow>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mi>cos</mml:mi>
                        <mml:mtext> </mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>ω</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>t</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mi>sin</mml:mi>
                        <mml:mtext> </mml:mtext>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>ω</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>t</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>z</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mstyle displaystyle="true">
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>a</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mi>exp</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mo>−</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>θ</mml:mi>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                    <mml:mo>−</mml:mo>
                                    <mml:msub>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:msubsup>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>i</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic>t</italic> is time, ω is the angular velocity (which is used to control the pulse duration), <italic>t</italic><sub>0</sub> is the end time of the previous beat,π is used to align the initial point of this model to the position of the onset in a PPG waveform, and <italic>a</italic><sub><italic>i</italic></sub>, θ<sub><italic>i</italic></sub>, and <italic>b</italic><sub><italic>i</italic></sub> are the amplitude of the peak, the position of the center of the peak, and the standard deviation of Gaussian functions, respectively. Additionally, ω is calculated by:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>ω</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mi>π</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>T</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>T</italic> is the PPG pulse duration. θ is the four-quadrant inverse tangent of (<italic>x, y</italic>), which is introduced as an independent variable for motion in the <italic>z</italic> direction and is defined as:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>θ</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mn>2</mml:mn>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>with the changes to (<italic>x, y</italic>), θ is in the range of (−π, π).</p>
      <p>The corresponding changes to <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> over a single period are shown in <xref ref-type="fig" rid="F2">Figure 2</xref>; these are repeated in the next pulses. In this figure, the pulse duration was 1 s, and the sampling frequency was 125 Hz. Obtaining a waveform of the synthetic PPG pulse that is close as possible to the real PPG pulse through calculation of model parameters is an optimization problem (finding the optimal parameters). The objective function was expressed as follows:</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mo class="qopname">arg</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mo class="qopname">min</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mstyle>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>-</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mi>o</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                            <mml:mi>s</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>such that <italic>p</italic> = {<italic>a</italic><sub>1</sub>, θ<sub>1</sub>, <italic>b</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, θ<sub>2</sub>, <italic>b</italic><sub>2</sub>},</p>
      <p>with the constraints:</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5">
          <mml:mrow>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mo>≤</mml:mo>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>≤</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mo>≤</mml:mo>
                        <mml:msub>
                          <mml:mi>b</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>b</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>≤</mml:mo>
                        <mml:mn>3</mml:mn>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo>≤</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>≤</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic>z</italic><sub><italic>p</italic></sub>(<italic>n</italic>) is the synthetic PPG, <italic>l</italic> is the length of the real PPG <italic>s</italic>(<italic>n</italic>), and <italic>corr</italic> is Pearson's linear correlation coefficient.</p>
      <p>In this study, the interior-point (<xref rid="B10" ref-type="bibr">10</xref>) method was used to solve the optimization problem.</p>
    </sec>
    <sec>
      <title>3.2. Variability of Parameters</title>
      <p>In real-world PPG, the waveform often varies between pulses—sometimes dramatically so. To make the synthesized PPG closer to a real PPG, we used a Gaussian distribution to generate random parameters for our model. In this paper, the mean value and standard deviation of each parameter's Gaussian distribution are derived from real PPG signals, set by modeling a PPG pulse (from start of a pulse to the start of the consecutive pulse). For a PPG trace which has regular beats; we modeled all pulses in a 5-min PPG from the MIMIC database (<xref rid="B3" ref-type="bibr">3</xref>). However, for a PPG trace which has irregular beats, the waveform of the first beat and second beat in the premature group is distinct from the reference beat. We model three compensation segments (include the first beat and second beat) from one record of the Queensland database (<xref rid="B4" ref-type="bibr">4</xref>) to get the distribution of parameters in the compensation type. For reset, four reset segments from one record of the MIMIC database are used to get the distribution. For interpolation, three interpolation segments in one record from the Queensland database are used to calculate the parameters. The mean and standard deviation of these parameters are shown in <xref rid="T1" ref-type="table">Table 1</xref>. Note that since we do not have a high-quality re-entry PPG in our database, this toolbox does not support generating re-entry PPGs. To not change the irregular category, the duration ratio of irregular beat and regular beat in synthetic PPG uses a fixed value instead of a random number obeying Gaussian distribution. These fixed values are the mean of the ratio of the pulse duration of the irregular beat and regular beat in <xref rid="T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>The optimal parameters for each PPG template.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">
                <bold>PPG type</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>Beat</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>
                  <italic>a</italic>
                  <sub>1</sub>
                </bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>
                  <italic>a</italic>
                  <sub>2</sub>
                </bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>
                  <italic>b</italic>
                  <sub>1</sub>
                </bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>
                  <italic>b</italic>
                  <sub>2</sub>
                </bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>θ<sub>1</sub></bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>θ<sub>2</sub></bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>Ratio of pulse duration</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Regular</td>
              <td valign="top" align="center" rowspan="1" colspan="1">-</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.997 ± 0.028</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.225 ± 0.030</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.641 ± 0.034</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.937 ± 0.161</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.471 ± 0.147</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.019 ± 0.102</td>
              <td valign="top" align="center" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Compensation</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1<italic>stBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.829 ± 0.010</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.420 ± 0.018</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.732 ± 0.033</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.219 ± 0.021</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.008 ± 0.147</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.450 ± 0.167</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.830 ± 0.061</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Compensation</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2<italic>ndBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.785 ± 0.034</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.405 ± 0.049</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.678 ± 0.036</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.115 ± 0.065</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.792 ± 0.080</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.607 ± 0.107</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.170 ± 0.061</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Reset</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1<italic>stBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.774 ± 0.012</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.774 ± 0.012</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.647 ± 0.041</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.007 ± 0.046</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.378 ± 0.180</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.173 ± 0.180</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.607 ± 0.019</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Reset</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2<italic>ndBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.995 ± 0.002</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.197 ± 0.024</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.778 ± 0.055</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.045 ± 0.341</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.809 ± 0.203</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.892 ± 0.325</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.596 ± 0.484</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Interpolation</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1<italic>stBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.668 ± 0.151</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.490 ± 0.006</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.893 ± 0.034</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.428 ± 0.062</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.627 ± 0.292</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.442 ± 0.635</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.561 ± 0.028</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Interpolation</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2<italic>ndBeat</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.595 ± 0.084</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.537 ± 0.092</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.889 ± 0.170</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.321 ± 0.289</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−1.049 ± 0.207</td>
              <td valign="top" align="center" rowspan="1" colspan="1">−0.289 ± 0.480</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.475 ± 0.028</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><italic>Here, θ<sub>1</sub> and θ<sub>2</sub> are the locations of the first Gaussian distribution and the second Gaussian distribution, respectively. Here, a<sub>1</sub> and a<sub>2</sub> are the amplitudes, and, b<sub>1</sub> and b<sub>2</sub> are the widths of the first and second Gaussian distributions, respectively. Note that in the regular PPG heartbeat, all beats have similar durations based on the standard deviation</italic>.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.3. Pulse Duration</title>
      <p>In this study, the PPG pulse duration is defined as the valley-to-valley interval. To generate a sequence of PPGs, a series of PPG pulse durations were needed. In this toolbox, reference pulse durations are generated based on the basic heart rate and signal time lengths, and then the reference pulse durations are randomly replaced by two consecutive irregular beats. The ratios of the first beat duration and second beat duration to the reference beat duration are calculated from each type of PPG templates, and the results are shown in <xref rid="T1" ref-type="table">Table 1</xref>.</p>
    </sec>
    <sec>
      <title>3.4. Adding Noise</title>
      <p>Two types of noise are available in this toolbox: white Gaussian noise and multi-frequency noise. Multi-frequency noise is a set of noises that have different amplitudes and frequencies. Each noise is generated as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>n</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>A</mml:mi>
                <mml:mo class="qopname">sin</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mi>π</mml:mi>
                <mml:mi>f</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>A</italic> is the amplitude of the peak of the noise and <italic>f</italic> is the frequency of the noise.</p>
      <p>If necessary, users can add one or more different amplitudes and frequency noises to the clean synthetic PPG signals.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>4. Cubic Interpolation</title>
    <p>The variability of parameters will make the endpoint value of one beat differ from the next beat's onset value. In this paper, cubic interpolation was used to smooth the synthetic PPG. Cubic spline interpolation involves a spline where each piece is a third-degree polynomial specified by its values and first derivatives at the corresponding domain interval's endpoints. The interpolation involved a total of 0.2 s around the onset. The previous sampling points of 0.05 s and the last sampling points of 0.05 s were used to fit the interpolation function. The middle 0.1-s samples' value is replaced by the corresponding samples' value generated by the interpolation function.</p>
  </sec>
  <sec id="s5">
    <title>5. The Graphical User Interface</title>
    <p><xref ref-type="fig" rid="F3">Figure 3</xref> shows the main dialogue of the GUI. The first step is to select the type of synthetic PPG using the drop-down button in the upper left corner. Available options are regular or three types of irregular PPG. Then we can modify the sampling frequency and signal length in the “Basic Info” panel. Once we change any data, the GUI will attempt to generate the synthetic PPG and show it at the bottom of the dialogue.</p>
    <fig id="F3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>The graphical interface of PPGSynth. The left side is the main dialogue. The edited parameters dialogue on the right side will pop up after pressing the “Edit” button. The red text show the numbered steps for generating PPGs. This figure shows how to use the graphical interface of PPGSynth.</p>
      </caption>
      <graphic xlink:href="fmed-07-597774-g0003"/>
    </fig>
    <p>By pressing the “Edit” button, users can modify the parameters of pulses in the pop-up dialogue. For a regular PPG, this toolbox uses the same parameters for different pulses. But for irregular PPGs, parameters are different in the first beat of the premature group, the second beat of the premature group, and the reference beat. Users can also modify the ratio of first beat duration and second beat duration to reference beat duration. The default value is shown in <xref rid="T1" ref-type="table">Table 1</xref>. Once done with editing pulse parameters, press the “OK” button to save these parameters and go to the main dialogue.</p>
    <p>After setting the basic info, users should set some parameters to generate the pulse duration. For a regular PPG, users can modify the mean heart rate and standard deviation of the RR intervals in the “Pulse Duration Info” panel. For irregular PPG types, this panel changes to an “Irregular Duration Info” panel, where users can modify the basic heart rate and irregular times of the synthetic PPG. The basic heart rate and mean heart rate are in the range of 50 to 180. A warning dialogue pops up when the “Irregular Times” value is too large or too small relative the signal length. In this case, users should either decrease the irregular times or increase the length of the signals.</p>
    <p>If necessary, users can add noise to synthetic PPG. Two types of noise are available in the “Noise Info” panel: White Gaussian noise and multi-frequency noise. For white Gaussian noise, users can modify the signal-to-noise ratio (SNR). A 5-s regular PPG with white Gaussian noise is shown in <xref ref-type="fig" rid="F4">Figure 4A</xref>. Additionally, for multi-frequency noise, see as <xref ref-type="fig" rid="F4">Figures 4B–D</xref>. “Amplitude” is the amplitude of the peak of the noise signals, and “Frequency” describes the noise frequencies. The number of values in “Amplitude” and “Frequency” should be the same.</p>
    <fig id="F4" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Four types of PPG heartbeat generated using the PPGSynth. <bold>(A)</bold> A 5-s regular PPG with white Gaussian noise. <bold>(B)</bold> A 10 s compensation PPG with multi-frequency noise. <bold>(C)</bold> A 10-s interpolation PPG with multi-frequency noise. <bold>(D)</bold> A 10-s reset PPG with multi-frequency noise. The parameters of each type shown at each subfigure. Additionally, the pulse parameters associated with each type are shown in <xref rid="T1" ref-type="table">Table 1</xref>.</p>
      </caption>
      <graphic xlink:href="fmed-07-597774-g0004"/>
    </fig>
    <p>After synthesizing signals, users can press the “Save” button to save the synthetic PPG to comma-separated values file (.csv), Microsoft Excel file (.xlsx), and MAT-file (.mat).</p>
  </sec>
  <sec id="s6">
    <title>6. Limitations of Study and Future Work</title>
    <p>Generating regular PPG signal using certain parameters is reproducible. If we add noise, the PPG signal cannot be reproduced as the noise addition is carried out randomly. On the other hand, generating irregular PPG signals is non-reproducible because the duration of each beat is randomly getting set. Adding noise to the generated irregular PPG signal makes it highly non-reproducible.</p>
    <p>The next step is to generate re-entry irregular heartbeats in PPG signals, and potentially other types of abnormalities to the toolbox. The main focus of the current study was not on detecting events in irregular PPG signals with irregular heartbeats; rather, the focus was on generating irregularity in PPG signals. Another aspect of future development is to generate PPG signals with certain hemodynamic parameters (e.g., blood pressure levels) simulating the PPG templates and their associated hemodynamics parameters. This toolbox is released as version 1 (PPGSynth v1.0,) and the more templates we include the more the toolbox will be more able to generate PPG waveforms covering different irregularities (simulated cardiovascular patient groups) and noise types. One of the next steps is to generate normotensive and hypertensive PPG signals.</p>
  </sec>
  <sec id="s7">
    <title>7. Summary</title>
    <p>PPGSynth, a new publicly available toolbox, is described as a means to generate synthetic PPG waveforms. Users can easily generate a waveform across a range of sampling frequencies and can also set the length of regular and irregular PPGs. The utility can also generate specific shapes of PPGs by modifying the pulse parameter settings. These characteristics make the new toolbox useful for less experienced users that would like to generate synthetic PPGs for their research and training in physiological measurements.</p>
  </sec>
  <sec sec-type="data-availability" id="s8">
    <title>Data Availability Statement</title>
    <p>The PPGSynth MATLAB toolbox is publicly available. The code can be downloaded via this link: <ext-link ext-link-type="uri" xlink:href="https://github.com/Elgendi/PPG-Synthesis/tree/master/code">https://github.com/Elgendi/PPG-Synthesis/tree/master/code</ext-link> and the .exe file can be downloaded via this link: <ext-link ext-link-type="uri" xlink:href="https://github.com/Elgendi/PPG-Synthesis/tree/master/exe">https://github.com/Elgendi/PPG-Synthesis/tree/master/exe</ext-link>.</p>
  </sec>
  <sec id="s9">
    <title>Author Contributions</title>
    <p>ME designed the study, led the investigation, drafted the manuscript for submission with revisions, and feedback from the contributing authors. QT, ZC, JA, AA, CM, RW, and ME conceived the study, provided directions, feedback, and revised the manuscript. All authors approved the final manuscript.</p>
  </sec>
  <sec id="s10">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This research was supported by the NSERC grant RGPIN-2014-04462 and Canada Research Chairs (CRC) program. RW was supported by NPRP grant # NPRP12S-0305-190231 from the Qatar National Research Fund (a member of Qatar Foundation). The findings achieved herein are solely the responsibility of the authors.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>J</given-names></name></person-group>. <article-title>Photoplethysmography and its application in clinical physiological measurement</article-title>. <source>Physiol Meas.</source> (<year>2007</year>) <volume>28</volume>:<fpage>R1</fpage>–<lpage>39</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/28/3/R01</pub-id><?supplied-pmid 17322588?><pub-id pub-id-type="pmid">17322588</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgendi</surname><given-names>M</given-names></name></person-group>. <article-title>On the analysis of fingertip photoplethysmogram signals</article-title>. <source>Curr Cardiol Rev.</source> (<year>2012</year>) <volume>8</volume>:<fpage>14</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.2174/157340312801215782</pub-id><?supplied-pmid 22845812?><pub-id pub-id-type="pmid">22845812</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>AE</given-names></name><name><surname>Pollard</surname><given-names>TJ</given-names></name><name><surname>Shen</surname><given-names>L</given-names></name><name><surname>Lehman</surname><given-names>LH</given-names></name><name><surname>Feng</surname><given-names>M</given-names></name><name><surname>Ghassemi</surname><given-names>M</given-names></name><etal/></person-group>. <article-title>MIMIC-III, a freely accessible critical care database</article-title>. <source>Sci Data.</source> (<year>2016</year>) <volume>3</volume>:<fpage>160035</fpage>. <pub-id pub-id-type="doi">10.1038/sdata.2016.35</pub-id><?supplied-pmid 27219127?><pub-id pub-id-type="pmid">27219127</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Gorges</surname><given-names>M</given-names></name><name><surname>Jenkins</surname><given-names>SA</given-names></name></person-group>. <article-title>University of Queensland vital signs dataset: development of an accessible repository of anesthesia patient monitoring data for research</article-title>. <source>Anesthesia Analgesia.</source> (<year>2012</year>) <volume>114</volume>:<fpage>584</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1213/ANE.0b013e318241f7c0</pub-id><?supplied-pmid 22190558?><pub-id pub-id-type="pmid">22190558</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlton</surname><given-names>PH</given-names></name><name><surname>Bonnici</surname><given-names>T</given-names></name><name><surname>Tarassenko</surname><given-names>L</given-names></name><name><surname>Clifton</surname><given-names>DA</given-names></name><name><surname>Beale</surname><given-names>R</given-names></name><name><surname>Watkinson</surname><given-names>PJ</given-names></name></person-group>. <article-title>An assessment of algorithms to estimate respiratory rate from the electrocardiogram and photoplethysmogram</article-title>. <source>Physiol Meas.</source> (<year>2016</year>) <volume>37</volume>:<fpage>610</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/37/4/610</pub-id><?supplied-pmid 27027672?><pub-id pub-id-type="pmid">27027672</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Elgendi</surname><given-names>M</given-names></name></person-group>. <article-title>A new, short-recorded photoplethysmogram dataset for blood pressure monitoring in China</article-title>. <source>Sci Data.</source> (<year>2018</year>) <volume>5</volume>:<fpage>180020</fpage>. <pub-id pub-id-type="doi">10.1038/sdata.2018.20</pub-id><?supplied-pmid 29485624?><pub-id pub-id-type="pmid">29485624</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Roskamm</surname><given-names>H</given-names></name><name><surname>Csapo</surname><given-names>G</given-names></name></person-group><source>Disorders of Cardiac Function</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>M. Dekker</publisher-name> (<year>1982</year>).</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgendi</surname><given-names>M</given-names></name><name><surname>Eskofier</surname><given-names>B</given-names></name><name><surname>Abbott</surname><given-names>D</given-names></name></person-group>. <article-title>Fast T wave detection calibrated by clinical knowledge with annotation of P and T waves</article-title>. <source>Sensors</source>. (<year>2015</year>) <volume>15</volume>:<fpage>17693</fpage>–<lpage>714</lpage>. <pub-id pub-id-type="doi">10.3390/s150717693</pub-id><?supplied-pmid 26197321?><pub-id pub-id-type="pmid">26197321</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Q</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Ward</surname><given-names>R</given-names></name><name><surname>Elgendi</surname><given-names>M</given-names></name></person-group>. <article-title>Synthetic photoplethysmogram generation using two Gaussian functions</article-title>. <source>Sci Rep.</source> (<year>2020</year>) <volume>10</volume>:<fpage>13883</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-020-69076-x</pub-id><?supplied-pmid 32807897?><pub-id pub-id-type="pmid">32807897</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrd</surname><given-names>RH</given-names></name><name><surname>Hribar</surname><given-names>ME</given-names></name><name><surname>Nocedal</surname><given-names>J</given-names></name></person-group><article-title>An interior point algorithm for large-scale nonlinear programming</article-title>. <source>SIAM J Optimizat.</source> (<year>1999</year>) <volume>9</volume>:<fpage>877</fpage>–<lpage>900</lpage>. <pub-id pub-id-type="doi">10.1137/S1052623497325107</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
