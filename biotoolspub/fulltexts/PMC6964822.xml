<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6964822</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-33446</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0226770</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolites</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pharmacology</subject>
          <subj-group>
            <subject>Pharmacokinetics</subject>
            <subj-group>
              <subject>Drug Metabolism</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Analytical Chemistry</subject>
            <subj-group>
              <subject>Mass Spectrometry</subject>
              <subj-group>
                <subject>Mass Spectra</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Mass Spectrometry</subject>
            <subj-group>
              <subject>Mass Spectra</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Metabolic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Physics</subject>
            <subj-group>
              <subject>Molecular Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Chemical Physics</subject>
            <subj-group>
              <subject>Molecular Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Machine Learning Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MESSAR: Automated recommendation of metabolite substructures from tandem mass spectra</article-title>
      <alt-title alt-title-type="running-head">MESSAR: MEtabolite SubStructure Auto-Recommender</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1449-3841</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Youzhong</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="econtrib001">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mrzic</surname>
          <given-names>Aida</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="econtrib001">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5903-633X</contrib-id>
        <name>
          <surname>Meysman</surname>
          <given-names>Pieter</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8692-425X</contrib-id>
        <name>
          <surname>De Vijlder</surname>
          <given-names>Thomas</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1847-6272</contrib-id>
        <name>
          <surname>Romijn</surname>
          <given-names>Edwin P.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valkenborg</surname>
          <given-names>Dirk</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3105-1359</contrib-id>
        <name>
          <surname>Bittremieux</surname>
          <given-names>Wout</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8217-2564</contrib-id>
        <name>
          <surname>Laukens</surname>
          <given-names>Kris</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Mathematics and Computer Science, University of Antwerp, Antwerp, Belgium</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Biomedical Informatics Network Antwerpen (biomina), University of Antwerp, Antwerp, Belgium</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Pharmaceutical Development &amp; Manufacturing Sciences (PDMS), Janssen Research &amp; Development, Beerse, Belgium</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Interuniversity Institute for Biostatistics and Statistical Bioinformatics, Hasselt University, Diepenbeek, Belgium</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Skaggs School of Pharmacy and Pharmaceutical Sciences, University of California San Diego, La Jolla, San Diego, CA, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Virginia, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>TDV and EPR are employed by and receive salary from Janssen Pharmaceutica NV. This does not alter our adherence with PLOS ONE policies on sharing data and materials.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ Authors contributed equally and should be considered co-first authors.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>kris.laukens@uantwerpen.be</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>e0226770</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Liu et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Liu et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0226770.pdf"/>
    <abstract>
      <p>Despite the increasing importance of non-targeted metabolomics to answer various life science questions, extracting biochemically relevant information from metabolomics spectral data is still an incompletely solved problem. Most computational tools to identify tandem mass spectra focus on a limited set of molecules of interest. However, such tools are typically constrained by the availability of reference spectra or molecular databases, limiting their applicability of generating structural hypotheses for unknown metabolites. In contrast, recent advances in the field illustrate the possibility to expose the underlying biochemistry without relying on metabolite identification, in particular via substructure prediction. We describe an automated method for substructure recommendation motivated by association rule mining. Our framework captures potential relationships between spectral features and substructures learned from public spectral libraries. These associations are used to recommend substructures for any unknown mass spectrum. Our method does not require any predefined metabolite candidates, and therefore it can be used for the hypothesis generation or partial identification of unknown unknowns. The method is called MESSAR (MEtabolite SubStructure Auto-Recommender) and is implemented in a free online web service available at <ext-link ext-link-type="uri" xlink:href="http://messar.biodatamining.be">messar.biodatamining.be</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>VLAIO</institution>
        </funding-source>
        <award-id>HBC.2016.0890</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>FWO</institution>
        </funding-source>
        <award-id>postdoctoral fellowship</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3105-1359</contrib-id>
          <name>
            <surname>Bittremieux</surname>
            <given-names>Wout</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>W.B. is a postdoctoral researcher of the Research Foundation – Flanders (FWO). WB was supported by a post-doctoral fellowship of the Belgian American Educational Foundation (BAEF). TD, ER, KL, and DV were supported by the VlAIO (Vlaams Agentschap Innovatie &amp; Ondernemen) grant HBC.2016.0890. The computational resources and services used in this work were provided by the VSC (Flemish Supercomputer Center), funded by the Research Foundation – Flanders (FWO) and the Flemish Government – department EWI. TDV and EPR are employed by and receive salary from Janssen Pharmaceutica NV. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>MESSAR is implemented in a free online web service available at <ext-link ext-link-type="uri" xlink:href="http://messar.biodatamining.be">http://messar.biodatamining.be</ext-link>. The source code is publicly available: <ext-link ext-link-type="uri" xlink:href="https://github.com/daniellyz/MESSAR">https://github.com/daniellyz/MESSAR</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>MESSAR is implemented in a free online web service available at <ext-link ext-link-type="uri" xlink:href="http://messar.biodatamining.be">http://messar.biodatamining.be</ext-link>. The source code is publicly available: <ext-link ext-link-type="uri" xlink:href="https://github.com/daniellyz/MESSAR">https://github.com/daniellyz/MESSAR</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Metabolomics is an emerging “omics” science involving the high-throughput analysis of metabolites or small biomolecules, with highly relevant applications in drug and biomarker discovery [<xref rid="pone.0226770.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0226770.ref002" ref-type="bibr">2</xref>]. One standard method for metabolite analysis is mass spectrometry (MS), preceded by a separation technique, such as gas chromatography (GC) or liquid chromatography (LC). Advances in MS instrumentation enable the simultaneous detection and quantification of thousands of metabolites in a biological sample. Chemical identification of these metabolites is a key step towards biochemical interpretation of studied samples. To obtain structural information, tandem MS (MS/MS) is applied to record the fragment <italic>m</italic>/<italic>z</italic> of targeted molecules. Structure elucidation from MS/MS data has always been a challenging and time-consuming task with a vast number of potentially interesting metabolites that are still unknowns. The main reason is that current MS/MS databases (spectral libraries) only contain a limited number of historical spectra, far below the number of metabolites in reality [<xref rid="pone.0226770.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0226770.ref004" ref-type="bibr">4</xref>].</p>
    <p>Advances in computational tools have led to a considerable extension of the search space that can be examined and have resulted in an improvement of the identification accuracy by using massive molecular databases (for example, PubChem currently contains about 100 million compounds [<xref rid="pone.0226770.ref005" ref-type="bibr">5</xref>]). These tools start by filtering the molecular database using the precursor <italic>m</italic>/<italic>z</italic> of the unknown spectra, yielding up to thousands of structure candidates.</p>
    <p>To subsequently score and rank these candidates two categories of algorithms have been proposed. First, <italic>in silico</italic> fragmentation tools simulate theoretical spectra for each candidate metabolite and compare those with the query spectrum [<xref rid="pone.0226770.ref006" ref-type="bibr">6</xref>–<xref rid="pone.0226770.ref009" ref-type="bibr">9</xref>]. Second, machine learning (ML) methods learn intermediate representations, such as molecular fingerprints [<xref rid="pone.0226770.ref010" ref-type="bibr">10</xref>] from historical spectrum–structure relationships. These representations are then used to score spectrum–candidate matches. A typical example hereof is the CSI:FingerID tool [<xref rid="pone.0226770.ref011" ref-type="bibr">11</xref>]. However, both types of algorithms still have certain limitations. For example, <italic>in silico</italic> fragmentation tools only cover simple fragmentations and cannot accurately simulate complex rearrangement reactions [<xref rid="pone.0226770.ref012" ref-type="bibr">12</xref>]. Additionally, none of these tools can identify “unknown unknowns”, i.e. compounds that have not been structurally described yet and are therefore not present in any molecular database. As a result typically only a fraction of compounds can be identified correctly [<xref rid="pone.0226770.ref013" ref-type="bibr">13</xref>].</p>
    <p>Recently a third category of computational tools has been introduced in non-targeted metabolomics. With a focus on the hypothesis generation for unknown structures, these tools aim to predict substructures rather than the full metabolite structure. The basic concept for this strategy is that metabolites often share substructures, resulting in similar patterns in their MS/MS spectra. Typical spectral features are productions, neutral losses, or mass differences [<xref rid="pone.0226770.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0226770.ref017" ref-type="bibr">17</xref>].</p>
    <p>One important tool to explore spectral similarity is the Global Natural Products Social Molecular Networking (GNPS) resource [<xref rid="pone.0226770.ref018" ref-type="bibr">18</xref>]. GNPS consists of a large metabolite network where metabolites with similar MS/MS spectra are connected so that structurally annotated metabolites can be used for the identification of their neighbors. However, such a network-based approach may fail to connect metabolite pairs if they have a low spectral similarities despite sharing important substructures such as small functional groups. Additionally, the annotation of neighboring nodes still requires manual intervention.</p>
    <p>MS2LDA is a recent framework proposed by van der Hooft et al. [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>–<xref rid="pone.0226770.ref021" ref-type="bibr">21</xref>]. It decomposes unlabeled MS/MS spectra into patterns of co-occurring fragments and losses, referred to as “Mass2Motifs”, which are indicative of biological substructures. These Mass2Motifs patterns are automatically extracted from complex MS/MS spectra using unsupervised text mining techniques. However, the extracted motifs have to be structurally annotated based on expert knowledge, which requires extensive domain expertise and is time-consuming.</p>
    <p>Here we introduce a new method for the recommendation of substructures for MS/MS spectra, working independently from molecular databases. Our tool, called MESSAR (MEtabolite SubStructure Auto-Recommender), is inspired by the concept of association rule mining (ARM). ARM has been designed to discover interesting relations based on frequently co-occurring items, and it has previously been used to find relations between unassigned mass spectra [<xref rid="pone.0226770.ref022" ref-type="bibr">22</xref>–<xref rid="pone.0226770.ref024" ref-type="bibr">24</xref>].</p>
    <p>We use a collection of labeled spectra (reference spectra with a known corresponding molecular structure from a spectral library) to mine co-occurring patterns of the form “MS/MS features + substructures”, yielding “MS/MS feature(s) → substructure” rules. These rules capture recurring patterns found in mass spectra and assign them potential substructures. As such, they can be used to partially replace expert-driven annotations in tools such as MS2LDA.</p>
    <p>The current MESSAR model is a database of 8378 “MS/MS feature(s) → substructure” rules derived from the GNPS spectral library. All rules were statistically evaluated on training and independent testing spectra, and compared with rules generated from a decoy GNPS spectral library. When annotating a new spectrum, MESSAR identifies all of its spectral features that match the rule database, after which any rules suggesting similar substructures are aggregated and maximal common substructures (MCS) are reported.</p>
    <p>MESSAR is currently designed for positive ion mode LC-MS/MS data. It is available as a free online web service at <ext-link ext-link-type="uri" xlink:href="http://messar.biodatamining.be">messar.biodatamining.be</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Training spectral libraries</title>
      <p>MESSAR generates rules from target and decoy GNPS spectral libraries built by Scheubert et al. (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1A</xref>). According to the data descriptions [<xref rid="pone.0226770.ref025" ref-type="bibr">25</xref>], the target library consists of 4138 positive ion high-quality labeled spectra acquired on Q-TOF instruments. For each spectrum, Scheubert et al. have computed a fragmentation tree that annotates a subset of fragments with molecular formulas and removed peaks that usually represent isotopic peaks, chemical noise and other unexplained fragments [<xref rid="pone.0226770.ref011" ref-type="bibr">11</xref>]. Meanwhile, neutral exact masses were assigned to formula annotated fragments. The decoy library was a randomized version of the target library. The decoy process kept the library labels (molecular structures) and all edges of the fragmentation tree, while generating randomized mass spectra via tree rearrangement (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1A</xref>). Such process mimics very “noisy” experimental spectra, therefore extracted patterns can probably reflect spurious feature-substructure relations in the target library. For both target and decoy libraries, mass spectra representing the same structure were combined, and duplicated fragments were removed. The final training data consists of 3146 target and decoy spectra (<xref ref-type="supplementary-material" rid="pone.0226770.s008">S1 Data</xref>).</p>
      <fig id="pone.0226770.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Workflow for target and decoy rule generation.</title>
          <p>Based on training data from an LC-MS/MS spectral library substructure recommendations are generated. Our method consists of (A) retrieving training MS/MS spectra, (B) extracting spectral features (neutral exact masses and mass differences) from the target library, (C) generating molecular substructures, (D) extracting spectral features from the decoy library, (E) rule mining using substructures and target spectral features, (F) rule mining using substructures and decoy spectral features, (G) statistical evaluation of target and decoy rules, filtering target rules and saving valid rules to the final database.</p>
        </caption>
        <graphic xlink:href="pone.0226770.g001"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Spectral feature extraction</title>
      <p>Both fragment masses and distances between fragments (mass differences) were interesting spectral features for model training. However, as an example, if a training spectrum has 20 mass peaks, extracted spectral features consist of <inline-formula id="pone.0226770.e001"><alternatives><graphic xlink:href="pone.0226770.e001.jpg" id="pone.0226770.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mn>20</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>190</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> mass differences. If we use all mass differences, rule generation can be computationally expensive and highly dominated by mass differences with no structural information. Therefore, we only used edges of fragmentation trees as target spectral features since they represent losses due to fragmentation reactions and probably hold structural information (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1B</xref>). Since decoy spectra were derived from the same set of edges as their corresponding target spectra, to introduce randomness, a subset of 20% spectral features were arbitrarily extracted from all mass differences of the decoy spectra (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1D</xref>). In the end, a similar amount of spectral features was used to generate target and decoy rules.</p>
    </sec>
    <sec id="sec005">
      <title>Substructure generation</title>
      <p>For every metabolite in the spectral library a set of substructures is created by combining two approaches: i) by checking the presence of predefined substructures, ii) through “breaking of retrosynthetically interesting chemical substructures” (BRICS) algorithm [<xref rid="pone.0226770.ref026" ref-type="bibr">26</xref>] (RDKit <ext-link ext-link-type="uri" xlink:href="https://www.rdkit.org/">https://www.rdkit.org/</ext-link> in Python). For i), we took 1483 CSI:FingerID molecular fingerprints (all types except for ECFP4) and converted them into substructures [<xref rid="pone.0226770.ref011" ref-type="bibr">11</xref>]. The SMILES code of corresponding substructures are available in <xref ref-type="supplementary-material" rid="pone.0226770.s008">S1 Data</xref>. For the second approach, we disconnected one or two chemical bonds in the metabolite and collected the resulting two or three substructures obtained from every iteration (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1C</xref>). CHON substructures that contain less than five carbon and oxygen atoms were considered trivial and therefore discarded. All substructures were represented by SMILES codes in the rule database.</p>
    </sec>
    <sec id="sec006">
      <title>Rule generation, statistical analysis and filtering</title>
      <p>After combining substructures with extracted spectral features, association rules were mined separately for target and decoy libraries (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1E and 1F</xref>). Details about ARM can be found in <xref ref-type="supplementary-material" rid="pone.0226770.s001">S1 Text</xref>.</p>
      <p>A MESSAR rule with shape <italic>X</italic> ⇒ <italic>Y</italic> describes the potential dependency of a substructure (<italic>Y</italic>) on a spectral feature pattern/feature set (<italic>X</italic> can contain up to three co-occurring masses and mass differences). Therefore, each rule can be considered as a binary classifier that decides whether a metabolite contains a substructure according to the corresponding spectral feature presence/absence. The predictive power of the rules was evaluated based on a confusion matrix, as follows (<xref rid="pone.0226770.t001" ref-type="table">Table 1</xref>):</p>
      <table-wrap id="pone.0226770.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Confusion matrix for the MESSAR rule <italic>X</italic> → <italic>Y</italic>.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0226770.t001g" xlink:href="pone.0226770.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Y</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">¬<italic>Y</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>X</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">True Positive (TP)</td>
                <td align="left" rowspan="1" colspan="1">False Positive (FP)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">¬<italic>X</italic></td>
                <td align="left" rowspan="1" colspan="1">False Negative (FN)</td>
                <td align="left" rowspan="1" colspan="1">True Negative (TN)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><italic>Supp</italic>(<italic>X</italic>) = <italic>TP</italic> + <italic>FP</italic>, Number of spectra that contain the set of spectral feature(s) <italic>X</italic>;</p>
          </fn>
          <fn id="t001fn002">
            <p><italic>Supp</italic>(<italic>Y</italic>) = <italic>TP</italic> + <italic>FN</italic>, Number of compounds that contain the substructure <italic>Y</italic>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We calculated two statistical metrics for each target and decoy rule, namely <italic>precision</italic> and <italic>recall</italic> (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1G</xref>). A perfect <italic>precision</italic> score of 1.0 means that the metabolite always contains substructure <italic>Y</italic> if we detect the spectra feature set <italic>X</italic> whereas a <italic>recall</italic> of 1.0 means that all metabolites containing substructure <italic>Y</italic> must have feature set <italic>X</italic> in their spectra:
<disp-formula id="pone.0226770.e002"><alternatives><graphic xlink:href="pone.0226770.e002.jpg" id="pone.0226770.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>→</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>→</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>Target rules were filtered by defining a <italic>recall</italic> threshold for 1% FDR (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1G</xref>). Based on the target-decoy method, the simple FDR associated with a particular <italic>recall</italic> threshold is the ratio between the number of accepted decoy rules (above the threshold) and target rules [<xref rid="pone.0226770.ref027" ref-type="bibr">27</xref>]. The simple FDR was estimated using the <italic>prozor</italic> package in R (<ext-link ext-link-type="uri" xlink:href="https://github.com/protviz/prozor">https://github.com/protviz/prozor</ext-link>).</p>
    </sec>
    <sec id="sec007">
      <title>Test data</title>
      <p>The predictive power of individual target rules was first evaluated on an independent “MASSBANK” data set (<xref ref-type="supplementary-material" rid="pone.0226770.s009">S2 Data</xref>). This test set contained 5164 labeled TOF-MS/MS spectra derived from the MASSBANK spectral library (<ext-link ext-link-type="uri" xlink:href="http://mona.fiehnlab.ucdavis.edu/">http://mona.fiehnlab.ucdavis.edu/</ext-link>). Compounds behind these spectra are metabolites, drugs and natural products.</p>
      <p>The second test data set “MASSBANK_CASMI” (<xref ref-type="supplementary-material" rid="pone.0226770.s009">S2 Data</xref>) was used to assess substructure recommendation for unknown spectra. This test set consists of 185 labeled TOF-MS/MS data, including 34 drugs and 126 metabolites from MASSBANK, as well as 25 spectra from the open contest CASMI 2017 (<ext-link ext-link-type="uri" xlink:href="http://casmi-contest.org/2017">http://casmi-contest.org/2017</ext-link>).</p>
      <p>When creating both test sets, we discarded all compounds that overlapped with the MESSAR training set based on the first block of InChiKey. “MASSBANK_CASMI” does not contain any compounds used for CSI:FingerID model training (<ext-link ext-link-type="uri" xlink:href="https://bio.informatik.uni-jena.de/software/sirius/">https://bio.informatik.uni-jena.de/software/sirius/</ext-link>). Mass spectra representing the same structure in each test set were combined, and duplicate fragments were removed.</p>
    </sec>
    <sec id="sec008">
      <title>Maximum common substructure</title>
      <p>When using MESSAR rules to annotate unknown spectra, we computed the maximum common substructures (MCSs) of a matched rule set in order to extract meaningful core substructures and to reduce the uncertainty of prediction. We first screened all matched rule pairs to identify “analogous rules” in which the head of rules had a Tanimoto similarity score higher than 0.5 [<xref rid="pone.0226770.ref028" ref-type="bibr">28</xref>]. We extracted from all analogous rule pairs maximum common substructures using the <italic>rcdk</italic> package in R. For motif annotation, the most frequent MCS of a rule set was reported. For unknown spectra annotation, each extracted MCS was scored by summing the <italic>recall</italic> of all relevant rules.</p>
    </sec>
    <sec id="sec009">
      <title>MESSAR webtool</title>
      <p>The MESSAR web tool recommends substructures for an input spectrum based on the pre-trained rule database (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1</xref>). MESSAR expects as input a list of MS/MS peaks and the precursor <italic>m</italic>/<italic>z</italic>. MESSAR then uses the fragments and the computed mass differences to query its database. The matched rules are ranked by their <italic>recall</italic>. Users could use these rules to generate structural hypotheses. In addition, rules that suggest similar (or identical) substructure can be aggregated, leading to a ranked list of substructure recommendations. Three rule aggregation algorithms are available in the web tool: i)“Exhaustive”: maximum common substructures computed from all rules; ii) “Fast”: MCS calculation on 20 most sensitive rules; iii) “Naive”: simply combining rules that suggest identical substructures. For all three algorithms, the score of each substructure is the sum of <italic>recall</italic> of all responsible rules. We recommend users to try out all three algorithms to discover the most reliable and meaningful substructures, but we only present results based on the “Exhaustive” algorithm in this paper. The client interface of the web tool was developed using the R Shiny framework.</p>
    </sec>
    <sec id="sec010">
      <title>Substructure recommendation by CSI:FingerID and MS2LDA</title>
      <p>CSI:FingerID (Windows GUI SIRIUS-4.0.1) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://bio.informatik.uni-jena.de/software/sirius/">https://bio.informatik.uni-jena.de/software/sirius/</ext-link>. The “MASSBANK_CASMI” data was submitted to the GUI as an mgf format file. The precursor formula was not available for fragmentation tree building, and all elements were considered (classical CHNOPS along with Br, Cl, F and I since they might be present in drug compounds). The annotation tolerance was set to 20 ppm. Only the best precursor formula (the one with the highest score) was submitted for substructure annotation. CSI:FingerID predicted five types of molecular fingerprints that can be translated into substructures (1483 substructures in total), namely CDK, PubChem CACTVS, Klekota-Roth, FP3 and MACCS. Substructures were ranked by probability. We only considered recommendations with a probability above 0.5.</p>
      <p>The same mgf file was submitted to <ext-link ext-link-type="uri" xlink:href="http://ms2lda.org/">http://ms2lda.org/</ext-link> for M2M searching and annotation. The minimum intensity of MS2 peaks was set at 1, and the width of MS2 bins at 0.005 Da. The motifs found were further inferred using predefined 500 GNPS motifs. The results are available online at <ext-link ext-link-type="uri" xlink:href="http://ms2lda.org/basicviz/summary/951/">http://ms2lda.org/basicviz/summary/951/</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Results and discussion</title>
    <p>First, we briefly describe the model training (rule generation) procedure and illustrate the statistical performance of generated rules on training and test spectra. Second, the biochemical relevance of these rules is revealed through a comparison with MS2LDA patterns. Third, MESSAR was validated on two independent sets of test spectra for the prediction power of individual rules and all rules together. The performance of MESSAR for unknown spectra annotation was compared with CSI:FingerID. Finally, the usefulness of the MESSAR output for structural hypothesis generation was evaluated alongside CSI:FingerID and MS2LDA through 185 test spectra.</p>
    <sec id="sec012">
      <title>Outline of MESSAR rule generation</title>
      <p>MESSAR predicts molecular substructures from an MS/MS spectrum based on meaningful “MS/MS feature(s) → substructure”-like patterns (rules) derived from existing labeled spectra. To find such patterns, the classical ARM algorithm was applied on a subset of the GNPS spectral library. The algorithm discovers rules among labeled spectra based on user-defined parameters (<xref ref-type="supplementary-material" rid="pone.0226770.s001">S1 Text</xref>). An overview of the rule generation procedure from the spectral library is depicted in <xref ref-type="fig" rid="pone.0226770.g001">Fig 1</xref>. This includes the following steps described in the Materials and Methods section: (A) retrieving training data: target and decoy GNPS spectral libraries used by passatutto software [<xref rid="pone.0226770.ref025" ref-type="bibr">25</xref>], (B) extracting spectral features from the target library, (C) generating molecular substructures of training compounds, (D) extracting spectral features from the decoy library, (E) ARM on target features and substructures, (F) generating random rules from the decoy database, (G) statistical evaluation of target and decoy rules, filtering target rules by FDR estimation with the target-decoy method. All target rules above the score threshold chosen were saved in the MESSAR rule database.</p>
    </sec>
    <sec id="sec013">
      <title>Statistical properties of MESSAR rules</title>
      <p>Using the procedures described in <xref ref-type="supplementary-material" rid="pone.0226770.s001">S1 Text</xref>, we have generated 20747 and 15480 rules from target and decoy spectral libraries, respectively (before FDR-based filtering in step G). In the target database we can observe several expected substructure recommendations. For example, mass features in rules 1–3 (<xref rid="pone.0226770.t002" ref-type="table">Table 2</xref>) reflect the molecular weight of recommended substructure. We found about 3% such rules that captured the direct link between masses/mass differences and the presence/loss of substructures (<xref ref-type="supplementary-material" rid="pone.0226770.s011">S1 File</xref>). The remaining 97% rules describe potential latent associations between spectral features and substructures (<xref rid="pone.0226770.t002" ref-type="table">Table 2</xref>, Rules 4–9, <xref ref-type="supplementary-material" rid="pone.0226770.s011">S1 File</xref>) and cannot be explained directly.</p>
      <table-wrap id="pone.0226770.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Examples of MESSAR rules from the target database.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0226770.t002g" xlink:href="pone.0226770.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">ID</th>
                <th align="left" rowspan="1" colspan="1">Type</th>
                <th align="left" rowspan="1" colspan="1">Body (<italic>X</italic>)</th>
                <th align="left" rowspan="1" colspan="1">Head (<italic>Y</italic>)</th>
                <th align="left" rowspan="1" colspan="1">Precision</th>
                <th align="left" rowspan="1" colspan="1">Recall</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">MDiff.</td>
                <td align="left" rowspan="1" colspan="1">43.0422</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>CCF</italic>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.10</td>
                <td align="char" char="." rowspan="1" colspan="1">0.23</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">MDiff.</td>
                <td align="left" rowspan="1" colspan="1">35.9767</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>CCl</italic>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">1.0</td>
                <td align="char" char="." rowspan="1" colspan="1">0.73</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">Mass</td>
                <td align="left" rowspan="1" colspan="1">119.0855</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>CCCCCCCCCC</italic>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.54</td>
                <td align="char" char="." rowspan="1" colspan="1">0.47</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">Mass</td>
                <td align="left" rowspan="1" colspan="1">172.0757</td>
                <td align="left" rowspan="1" colspan="1"><italic>CC</italic>(<italic>C</italic>)<italic>CNC</italic> = <italic>O</italic></td>
                <td align="char" char="." rowspan="1" colspan="1">0.26</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">Mass</td>
                <td align="left" rowspan="1" colspan="1">172.0757</td>
                <td align="left" rowspan="1" colspan="1"><italic>CNCC</italic>1<italic>CCC</italic>2 = <italic>CC</italic> = <italic>CC</italic>(= <italic>O</italic>)<italic>N</italic>2<italic>C</italic>1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.45</td>
                <td align="char" char="." rowspan="1" colspan="1">0.60</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">Mass</td>
                <td align="left" rowspan="1" colspan="1">172.0757</td>
                <td align="left" rowspan="1" colspan="1"><italic>O</italic> = <italic>C</italic>(<italic>COC</italic>1<italic>CCC</italic>2<italic>CCC</italic>(= <italic>O</italic>)<italic>OC</italic>2<italic>C</italic>1)<italic>N</italic>3<italic>CCCCC</italic>3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.96</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">Mass</td>
                <td align="left" rowspan="1" colspan="1">143.0855</td>
                <td align="left" rowspan="1" colspan="1"><italic>C</italic>#<italic>CC</italic>1(<italic>O</italic>)<italic>CCC</italic>2<italic>C</italic>3<italic>CCC</italic>4 = <italic>CC</italic>(= <italic>O</italic>)<italic>CCC</italic>4<italic>C</italic>3<italic>CCC</italic>21<italic>C</italic></td>
                <td align="char" char="." rowspan="1" colspan="1">0.11</td>
                <td align="char" char="." rowspan="1" colspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">Mass, MDiff.</td>
                <td align="left" rowspan="1" colspan="1">105.0699, 52.0313</td>
                <td align="left" rowspan="1" colspan="1"><italic>C</italic>#<italic>CC</italic>1(<italic>O</italic>)<italic>CCC</italic>2<italic>C</italic>3<italic>CCC</italic>4 = <italic>CC</italic>(= <italic>O</italic>)<italic>CCC</italic>4<italic>C</italic>3<italic>CCC</italic>21<italic>C</italic></td>
                <td align="char" char="." rowspan="1" colspan="1">0.12</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">Mass, Mass, Mass</td>
                <td align="left" rowspan="1" colspan="1">117.0699, 129.0699, 105.0699</td>
                <td align="left" rowspan="1" colspan="1"><italic>C</italic>#<italic>CC</italic>1(<italic>O</italic>)<italic>CCC</italic>2<italic>C</italic>3<italic>CCC</italic>4 = <italic>CC</italic>(= <italic>O</italic>)<italic>CCC</italic>4<italic>C</italic>3<italic>CCC</italic>21<italic>C</italic></td>
                <td align="char" char="." rowspan="1" colspan="1">0.13</td>
                <td align="char" char="." rowspan="1" colspan="1">0.63</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In total, the 20747 target rules covered 215 sets of spectral features and 732 substructures. The same set of spectral features can recommend several different substructures (Rules 4-6), and reciprocally, the same substructure can be associated with multiple feature patterns (Rules 7-9). In the first scenario, the recommended substructures are usually very much alike, which can be explained by the presence of the same spectral feature(s) in similar training molecules with a minor substructure difference (<xref ref-type="supplementary-material" rid="pone.0226770.s003">S2 Fig</xref>). The second scenario is consistent with the concept of Mass2Motifs [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>], that is, a complex substructure is indeed associated to co-occurring molecular fragments and losses (spectral patterns).</p>
      <p>However, not all target MESSAR rules are meaningful because ARM can find spectral features-substructure associations that are present by chance. Since a direct biochemical evaluation (e.g. via molecular weight) is not feasible for most rules, we verified whether the statistical measures, <italic>precision</italic> and <italic>recall</italic>, can be used to select meaningful rules. The most meaningful rule can be selected based on the highest <italic>precision</italic> or <italic>recall</italic> (<xref rid="pone.0226770.t002" ref-type="table">Table 2</xref>). Using the entire training set, we created confusion matrices for each rule and evaluated the two statistical measures. The decoy rules served as negative controls and were evaluated in the same way as the target rules (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1G</xref>).</p>
      <p>First, there was no correlation between the two metrics (<xref ref-type="fig" rid="pone.0226770.g002">Fig 2A</xref>). Points representing target/decoy rules can be separated based on <italic>recall</italic>. We further compared the distributions of <italic>precision</italic> and <italic>recall</italic> (<xref ref-type="fig" rid="pone.0226770.g002">Fig 2B and 2C</xref>). It can be seen that the <italic>precision</italic> of most target and decoy rules lies between 0 and 0.4, and target/decoy distributions overlap over the entire <italic>precision</italic> range. In contrast, the <italic>recall</italic> of the decoy rules centers around 0.07 and ranges mostly between 0 and 0.2, while target rules display a skewed Poisson-like distribution around 0.16 with a long right tail up to 1 (<xref ref-type="fig" rid="pone.0226770.g002">Fig 2C</xref>). Moreover, there was little overlap between target/decoy distributions.</p>
      <fig id="pone.0226770.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Statistical evaluation of MESSAR rules.</title>
          <p>(A) scatter plot between precision and recall, (B) precision and (C) recall distribution of target and decoy rules.</p>
        </caption>
        <graphic xlink:href="pone.0226770.g002"/>
      </fig>
      <p>In summary, <italic>recall</italic> appears to be more suitable to distinguish meaningful rules from spurious patterns. It will be the only metrics used for FDR control and model validation (substructure recommendation) in the manuscript. After filtering rules for statistical soundness and for 1% FDR (threshold defined based on the shape of the curve in <xref ref-type="supplementary-material" rid="pone.0226770.s004">S3 Fig</xref>), target rules with a <italic>recall</italic> higher than 0.20 were kept. The final MESSAR database consists of 8378 association rules (<xref ref-type="supplementary-material" rid="pone.0226770.s011">S1 File</xref>).</p>
    </sec>
    <sec id="sec014">
      <title>Comparison between MESSAR rules and MS2LDA patterns</title>
      <p>MS2LDA [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>, <xref rid="pone.0226770.ref021" ref-type="bibr">21</xref>] is an unsupervised tool that discovers patterns across fragmentation spectra. As it operates within a similar scope as MESSAR, a detailed comparison is warranted. The major difference between MESSAR and MS2LDA is that MS2LDA requires frequent patterns of spectral features (fragments and neutral losses) extracted from raw MS/MS spectra to be manually annotated by MS experts. These two steps result in a set of annotated “Mass2Motifs” (M2Ms) that couple spectral features to descriptive sub-structures (e.g. “Amine loss—Indicative for free NH2 group in fragmented molecule”), comparable to MESSAR rules. Moreover, spectral feature–substructure associations in M2Ms are highly confident, and as such they can be used as a ground truth to assess the biochemical relevance of MESSAR rules.</p>
      <p>We compared the 8378 MESSAR rules with the 500 positive ion mode M2Ms derived from GNPS [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>]. Each M2M consists of up to 200 motif features (fragments and losses), sorted by their probabilities (<xref ref-type="fig" rid="pone.0226770.g003">Fig 3</xref> left panel). The fifty most probable features were searched against the MESSAR target rules using a 20 ppm mass window around the MESSAR spectral features, and feature types were required to agree.</p>
      <fig id="pone.0226770.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Comparison between Mass2Motifs and MESSAR rules.</title>
          <p>A) An example of comparison. The fifty most probable features (fragments or losses) of the Motif 25 were searched against the MESSAR target rules. A 20 ppm mass window was used and feature types were required to agree (“Fragment” = “Mass”, “Loss” = “MDiff”). Recall was used as the tie-breaker to select the most meaningful rules, and MCS was computed if multiple selected rules have the same recall. The MESSAR substructure recommendations for Motif 25 were compared with the annotation by MS experts. B) Matching between 8378 MESSAR target rules—500 MS2LDA motifs as well as two negative control experiments: target rules vs random motifs (matching results based on the median of 10 replicates); decoy rules vs MS2LDA motifs.</p>
        </caption>
        <graphic xlink:href="pone.0226770.g003"/>
      </fig>
      <p>In practice, M2M features can never completely overlap with MESSAR rule features. One reason is that some M2M features can be isotopic peaks, noise,…,while such features were removed before training MESSAR rules. To understand what a “reliable overlap” is, we performed two negative control experiments: i) searching “random motifs” consisting of only features taken from other motifs against MESSAR target rules; ii) searching motif features against decoy rules. After repeating i) 10 times and taking the median, 459 motifs overlapped with MESSAR rules by at least 1 feature, however, 0 motif shared more than 5 common features with MESSAR rules (<xref ref-type="fig" rid="pone.0226770.g003">Fig 3B</xref>, <xref ref-type="supplementary-material" rid="pone.0226770.s012">S2 File</xref>). Based on i), we consider a “reliable overlap if a M2M shares more than 5 common features with MESSAR rules. Among 500 motifs, we found 77 reliable M2M-rule matches. In comparison, 29 motifs overlapped with decoy rules in ii) by more than 5 features (or 10% for M2Ms with fewer than 50 features). Likewise, much fewer M2M-decoy rule matches (than 77) were observed when decoy rules were derived from two other algorithms of passatutto (<xref ref-type="supplementary-material" rid="pone.0226770.s012">S2 File</xref>).</p>
      <p>We further investigated the underlying biochemical link based on these 77 reliable matches. Briefly, we used MESSAR rules to annotate their matched motifs. The substructure annotation was achieved based on the set of MESSAR rules associated with a M2M via common spectral features (<xref ref-type="fig" rid="pone.0226770.g003">Fig 3A</xref>). If several matched rules were associated with the same feature set, <italic>recall</italic> was used as tiebreaker to select the most important rule. For instance, among rules b), c) and d) in <xref ref-type="fig" rid="pone.0226770.g003">Fig 3A</xref>, rule b) with the highest <italic>recall</italic> was selected, and only the substructure recommended by b) was kept for evaluation. If <italic>recall</italic> could not break the tie (such as rules f, g and h in <xref ref-type="fig" rid="pone.0226770.g003">Fig 3A</xref>), we reported the MCS of substructures predicted from all such rules. The MESSAR prediction for all 77 M2Ms can be found in <xref ref-type="supplementary-material" rid="pone.0226770.s010">S3 data</xref>.</p>
      <p>Among these 77 M2Ms, 28 have also received expert annotations in [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>]. Using these motifs, we validated the biochemical relevance of MESSAR rules by comparing substructures predicted with ground-truth expert annotation (<xref ref-type="supplementary-material" rid="pone.0226770.s005">S1 Table</xref>). Interestingly, the MESSAR-predicted substructures showed a striking similarity to expert knowledge, ranging from simple (e.g ethyl phenol of Motif 21) to complex (e.g. indole substructure of Motif 25, 26, 194) substructures. According to experts’ knowledge, ground-truth annotations of 26 motifs (out of 28) were identical or very similar to the substructure predicted by at least one matched MESSAR rule. On average, 40% of <italic>recall</italic>-selected rules correctly predicted the motif substructure (exact number of correct rules in <xref ref-type="supplementary-material" rid="pone.0226770.s012">S2 File</xref>). In addition, matched rules can capture structural similarity between motifs. For example, most rules matching with motifs 1, 32, 39, 50 and 274, which are all steroid-related, correctly recommended the steroid core (<xref ref-type="supplementary-material" rid="pone.0226770.s005">S1 Table</xref>).</p>
      <p>The MESSSAR rules also recommended substructures for the remaining 49 M2M (out of 77) that were not annotated in [<xref rid="pone.0226770.ref019" ref-type="bibr">19</xref>]. The examples in <xref ref-type="supplementary-material" rid="pone.0226770.s006">S2 Table</xref> and <xref ref-type="supplementary-material" rid="pone.0226770.s010">S3 Data</xref> show the ability of MESSAR to assign meaningful substructures, allowing biochemical interpretations of unknown M2Ms.</p>
      <p>Overall, we found a reliable overlap between 8378 MESSSAR rules and 77 M2Ms (out of 500). The matched and <italic>recall</italic>-selected rule set not only validated most expert annotations of M2Ms but also recommended substructures for unknown M2Ms. However, in broad terms, MESSAR and MS2LDA are strongly complementary, since rules and M2Ms show completely different formats: MESSAR rules link spectral features (with exact masses) with specific substructures, while M2Ms are spectral patterns derived from raw experimental spectra with descriptive substructure annotation (<xref ref-type="fig" rid="pone.0226770.g003">Fig 3</xref>). Although strong biochemical links were revealed from overlapping rules and motifs, the remaining rules and motifs can not be compared directly. We will further illustrate their complementarity in following sections.</p>
    </sec>
    <sec id="sec015">
      <title>Validating MESSAR rules using authentic standards</title>
      <p>MESSAR rules were characterized by their <italic>recall</italic> calculated based on the entire training set. This metrics describes the probability that a feature set (<italic>X</italic>) is detected if the substructure (<italic>Y</italic>) is in the training molecule. Target-decoy comparison shows the ability of <italic>recall</italic> to select non-random rules. In the MS2LDA-MESSAR comparison, rules with the highest <italic>recall</italic> correctly predicted motif substructures from overlapped motif features. To demonstrate that the rest of rules were not only beyond random but also meaningful and reliable, 8378 MESSAR rules were individually validated on an independent test set of 5164 MASSBANK standards (<xref ref-type="supplementary-material" rid="pone.0226770.s009">S2 Data</xref>).</p>
      <p>For each rule <italic>X</italic> ⇒ <italic>Y</italic>, we counted how many test spectra contain the feature set <italic>X</italic> while the substructure <italic>Y</italic> is present in the corresponding chemical standards, in other words, the number of true positives (<xref rid="pone.0226770.t001" ref-type="table">Table 1</xref>). Consistent with the model training procedure, 4743 rules with <italic>TP</italic> ≥ 5 were statistically evaluated (<xref ref-type="supplementary-material" rid="pone.0226770.s001">S1 Text</xref>). We could not evaluate the rest of rules due to their rare occurrence in the test set. In addition to the <italic>TP</italic>s, we counted the frequency of substructure (<italic>Supp</italic>(<italic>Y</italic>)) for each rule, from which <italic>recall</italic> was reported (<xref ref-type="fig" rid="pone.0226770.g004">Fig 4</xref>, <xref ref-type="supplementary-material" rid="pone.0226770.s013">S3 File</xref>).</p>
      <fig id="pone.0226770.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Statistical evaluation of MESSAR rules on testing data.</title>
          <p>Recall distribution of 4743 evaluated rules. The red dash line indicates the 0.2 threshold used to define spurious rules.</p>
        </caption>
        <graphic xlink:href="pone.0226770.g004"/>
      </fig>
      <p>In <xref ref-type="fig" rid="pone.0226770.g004">Fig 4</xref>, half of evaluated rules (2364 out of 4743 rules) had a <italic>recall</italic> higher than 0.6, while only 10% (463 out of 4743) might be spurious due to a <italic>recall</italic> lower than 0.2. This result was not biased by the rule filtering step (<xref ref-type="fig" rid="pone.0226770.g001">Fig 1G</xref>) since we have only applied a 0.2 filter on training data-derived <italic>recall</italic>. A global high <italic>recall</italic> indicates that MESSAR rules are meaningful and powerful in capturing characteristic spectral features of a substructure. As an example, with a <italic>recall</italic> of 1, the rule 21850 (<xref ref-type="supplementary-material" rid="pone.0226770.s013">S3 File</xref>) implies that the fragment 160.0757 appears in all testing compounds that involve cytisine substructure.</p>
    </sec>
    <sec id="sec016">
      <title>Substructure recommendation for unknown spectra</title>
      <p>We can use the entire rule set to annotate unknown spectra. This functionality is available to users in the MESSAR web tool. The intermediate steps of the substructure prediction procedure are illustrated in <xref ref-type="fig" rid="pone.0226770.g005">Fig 5A</xref> using the example of Ochratoxin B ethyl ester (Inchikey: XXAVUHHKDMGGBR-UHFFFAOYSA-N, Challenge ID: 38 in <xref ref-type="supplementary-material" rid="pone.0226770.s009">S2 Data</xref> “MASSBANK_CASMI”). We queried the rule database based on the peaks and mass differences extracted from the test spectrum. With a 20 ppm mass window, the query resulted in 202 matched rules predicting 192 substructures. According to expert knowledge, most rules recommended benzene rings, aromatic amines and indole-related substrutures (<xref ref-type="supplementary-material" rid="pone.0226770.s014">S4 File</xref>). Such conclusion can be drawn after examining all matched rules. For ease of interpretation, we proposed an additional simplification step through analogous rules aggregation so that final recommended substructures were MCSs of rules head (<italic>Y</italic>). Accordingly, the score of each MCS was the sum of <italic>recall</italic> of all responsible rules. We have aggregated 202 rules into 26 ranked substructures (<xref ref-type="supplementary-material" rid="pone.0226770.s014">S4 File</xref>). This last step, available in our web tool, is optional but strongly recommended.</p>
      <fig id="pone.0226770.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0226770.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Substructure recommendation and interpretation for unknown spectra.</title>
          <p>A) Spectral features of the test spectrum are searched against the rule database. The matched rules are aggregated through MCS calculation of analogous rules. The final recommendations are MCSs scored by the sum of <italic>recall</italic>. The top recommendations are verified against the ground-truth in terms of exact structural match and biochemical relevance. B) Number of test spectra annotated by MESSAR, CSI:FingerID and their combined use (since some spectra cannot be processed by either tool) and number of “good annotations” under four criteria of accuracy. C) Based on top 3 outputs of MESSAR, test spectra 46, 59 and 142 can be grouped for sharing potentially the indole substructure.</p>
        </caption>
        <graphic xlink:href="pone.0226770.g005"/>
      </fig>
      <p>In practice, only top-ranked substructures are recommended to end users for <italic>de novo</italic> identification or approximate characterization of unknown metabolites. In other words, the top candidates of a good substructure prediction tool should contain both accurate and meaningful (e.g. biochemically-relevant) structural knowledge. Therefore, both quantitative (accuracy of tools) and qualitative (meaningfulness) aspects were considered when comparing MESSAR output (top-ranked substructures aggregated from matched rules) with two other substructure recommendation tools i.e. CSI:FingerID and MS2LDA.</p>
      <p>The 185 test spectra from “MASSBANK_CASMI” (<xref ref-type="supplementary-material" rid="pone.0226770.s009">S2 Data</xref>) were submitted to all three software. The accuracy of MESSAR was only compared with CSI:FingerID since MS2LDA output was text descriptions of substructures thus not eligible for quantitative comparison. Small substructures with fewer than 5 non-hydrogen atoms were discarded. Based on the output of both tools, we retrieved the number of hits (when the predicted substructure is an exact match of ground-truth) among top 3, 5 and 10 recommended substructures. We counted the number of “properly annotated” test spectra under four fixed criteria (<xref ref-type="fig" rid="pone.0226770.g005">Fig 5B</xref>): i) at least one hit among top 3; ii) 2 or 3 hits among top 3; iii) at least 3 hits among top 5 and iv) at least 5 hits among top 10 candidates (<xref ref-type="fig" rid="pone.0226770.g005">Fig 5B</xref>). These criteria reflect how trustworthy the tools are if users only look at the top substructure recommendations. Among spectra that MESSAR or CSI:FingerID were able to process, 28% and 38% were correctly annotated, respectively, according to a strict criterion such as i).</p>
      <p>Based on independent spectra, CSI:FingerID allows more accurate substructure prediction over MESSAR (e.g. 52% against 42% of test spectra with at least one hit among top 3). Here, the better performance with CSI:FingerID can be explained by the additional spectra pre-processing step in SIRIUS and by its massive training spectra (8210 unique compounds against 3146 in MESSAR). Interestingly, after concatenating the top results from both tools (i.e. top 3, 5 and 10 substructures) and filtering duplicates, nearly 50% processed spectra were correctly annotated based on criterion i) and 72% with criterion ii). While CSI:FingerID allowed more exact substructure matches, the combined approach consistently outperforms either tool.</p>
      <p>On the other hand, an exact substructure match to test compounds does not mean that the output is meaningful or useful to reveal the ground-truth. For instance, a substructure with the SMILES code “CC(CCC)CC” is probably an exact match to diverse metabolites, but it cannot assist structural hypothesis generation or the understanding of the biochemical origin of unknowns. Therefore, a qualitative evaluation of software output by an external expert is preferred. Here we collected the output of all three software for the 185 spectra as well as the ground-truth in <xref ref-type="supplementary-material" rid="pone.0226770.s007">S3 Table</xref>. MESSAR and CSI:FingerID outputs were top 3 substructure candidates, and MS2LDA output was the interpretation of matched GNPS motif. The external expert performed a blinded evaluation and suggested for each spectrum the appropriate tool(s) based on: i) how useful the predicted substructures are (e.g. indication of chemical family); ii) biochemical relevance of output with regard to ground-truth. In the example of Ochratoxin B ethyl ester (Challenge ID: 38), MESSAR and CSI:FingerID were equally considered useful since they correctly predicted the aromatic ring and amine group, respectively (<xref ref-type="supplementary-material" rid="pone.0226770.s007">S3 Table</xref>).</p>
      <p>According to the expert, 124 out of 185 test spectra received reliable and useful annotations from at least one software (<xref ref-type="supplementary-material" rid="pone.0226770.s007">S3 Table</xref>). MESSAR, CSI:FingerID and MS2LDA reliably predicted substructures for 68, 65 and 32 times, and they were the single appropriate tool for 39, 41 and 6 test spectra, respectively. These numbers indicate a strong orthogonality between these tools. Specifically, MESSAR was most powerful for capturing polycyclic aromatic (e.g. Challenge ID: 3,9,16,36,58,78…), indole (ID: 6, 46, 59, 60, 142…) and chlorobenzene (ID: 40, 66) substructures. CSI:FingerID provided reliable prediction of amino acids (ID: 41, 119, 153, 179) and other nitrogen-containing functional groups such as pyrimidine (ID: 13, 94) and benzenesulfonylamide (93, 182). MS2LDA was able to elucidate sterone-related (ID: 3, 36, 84, 146) and conjugated sugar (ID: 76, 169).</p>
      <p>In <xref ref-type="supplementary-material" rid="pone.0226770.s007">S3 Table</xref>, there were 14 cases where both MESSAR and CSI:FingerID allowed useful annotations. Interestingly, for 8 such spectra (ID: 18, 21, 55, 96, 119, 145, 157 and 158), the correct substructures predicted were not redundant. In the example of ID: 119, MESSAR correctly predicted the phenol substructure, while CSI:FingerID annotated the underlying compound as an amino acid. <italic>De novo</italic> annotation can be improved by combining both information. Such complementarity was also observed between MESSAR and MS2LDA. In fact, the combined use of three tools would allow a broader coverage of metabolite families and increased reliability of hypothesis generation. On the other hand, one tool can be more preferable if user has prior knowledge about biochemical origins of the unknown. It will be interesting to evaluate this aspect in future research.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Conclusions</title>
    <p>MESSAR was inspired by the idea that the presence of spectral features in an MS/MS spectrum is linked to substructures of the metabolite. We have implemented a data-driven approach to unravel such relations from public spectral library. Our approach was inspired from association rule mining. Statistical evaluation of target/decoy rules and validation on independent spectra characterized such relations as “good <italic>recall</italic> but lower <italic>precision</italic>”. It means that some spectral features are constantly present for compounds containing a certain substructure. In fact, rules with high <italic>recall</italic> in <xref ref-type="supplementary-material" rid="pone.0226770.s011">S1 File</xref> reveal characteristic ions for several important substructure. However, learning a specific substructures from one or a few spectral features could be challenging due to the low <italic>precision</italic>.</p>
    <p>Although individual MESSAR rules have a low predictive power in terms of <italic>precision</italic>, the strength of our approach lies in two aspects: i) rules with higher <italic>recall</italic> predict meaningful substructures, useful for <italic>de novo</italic> identification; ii) the sparsity of rules enables the prediction of diverse substructures, making our tool a good structural hypothesis generator. On the other hand, rules matched to an unknown spectrum can usually be aggregated through MCS search, leading to accurate and reliable substructure recommendation.</p>
    <p>We developed MESSAR web tool to assist the <italic>de novo</italic> annotation of unknown metabolites, for example, to identify functional classes of unknown spectra that share substructures (<xref ref-type="fig" rid="pone.0226770.g005">Fig 5C</xref>), to corroborate results from other chemical identification tools, etc. Although our tool and CSI:FingerID share similar concept and work on a similar scope, the machine-learning model behind is fundamentally different. First, CSI:FingerID starts by converting the training spectra into fragmentation trees before predicting substructure presence based on fragmentation tree similarity. In contrast, MESSAR directly explores the relationships between spectral features and molecular substructures. Second, CSI:FingerID relies on molecular fingerprints to train SVM (support vector machine) models, while MESSAR employs both predefined substructures (molecular fingerprints) and less common ones by breaking chemical bonds of training compounds. The difference in machine-learning model can explain the difference in performance and the orthogonality of reliable predictions (depending on compound classes). MESSAR is inherently complementary to recently-published software MS2LDA as MS2LDA extracts co-occurring spectral features while MESSAR provides an automated structural annotation of these features. Similarly, we anticipate that MESSAR will be useful for the functional analysis of complex biological matrices as it can quickly recognize substructure patterns.</p>
    <p>Through both quantitative and qualitative evaluation, we have demonstrated that MESSAR uses orthogonal information to improve state of the art. In practice, combining MESSAR with MS2LDA and CSI:FingerID will enhance structural hypothesis generation, allowing reliable biological interpretation from diverse MS/MS spectra.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec018">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0226770.s001">
      <label>S1 Text</label>
      <caption>
        <title>Supporting method.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0226770.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s002">
      <label>S1 Fig</label>
      <caption>
        <title>Supplementary statistical evaluation of rules.</title>
        <p>A) Distribution of target/decoy rule <italic>specificity</italic>. B) Dependency between <italic>recall</italic> of target rules and <italic>support</italic>.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pone.0226770.s002.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s003">
      <label>S2 Fig</label>
      <caption>
        <title>Examples of GNPS training spectra.</title>
        <p>The peak 172.075 is present in all examples, while the underlying training molecules were structurally similar—little or no substructure difference was observed.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pone.0226770.s003.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s004">
      <label>S3 Fig</label>
      <caption>
        <title>Filtering target rules via FDR control.</title>
        <p>A) <italic>Recall</italic> distribution of target and decoy rules. B) FDR score of rules as a function <italic>recall</italic>. The red vertical line in both plots indicates the <italic>recall</italic> threshold estimated for 1% FDR.</p>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pone.0226770.s004.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s005">
      <label>S1 Table</label>
      <caption>
        <title>Annotation of 26 M2M motifs by MESSAR rules and comparison with ground-truth.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0226770.s005.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s006">
      <label>S2 Table</label>
      <caption>
        <title>Examples of unexplained positive ion mode M2Ms annotated by MESSAR rules.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0226770.s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s007">
      <label>S3 Table</label>
      <caption>
        <title>Direct comparison between MESSAR, CSI:FingerID and MS2LDA for 185 testing spectra, including ground-truth and expert’s decision of meaningful output.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0226770.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s008">
      <label>S1 Data</label>
      <caption>
        <title>MESSAR training data and molecular fingerprints used for substructure generation.</title>
        <p>GNPS spectral library and its decoy version in mgf format. The datasets are derived from <ext-link ext-link-type="uri" xlink:href="https://bio.informatik.uni-jena.de/passatutto">https://bio.informatik.uni-jena.de/passatutto</ext-link>. The molecular fingerprints are retrieved from the SIRIUS-4.0.1.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0226770.s008.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s009">
      <label>S2 Data</label>
      <caption>
        <title>MESSAR testing data.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0226770.s009.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s010">
      <label>S3 Data</label>
      <caption>
        <title>MESSAR rules that reliably overlapped with M2M motifs.</title>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0226770.s010.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s011">
      <label>S1 File</label>
      <caption>
        <title>FDR-filtered target MESSAR rule database and statistical metrics based on training data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0226770.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s012">
      <label>S2 File</label>
      <caption>
        <title>Overlapping statistics between rules and motifs.</title>
        <p>i) target MESSAR rules and motifs, ii) target MESSAR rules and “random” motifs, iii) decoy MESSAR rules and motifs.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0226770.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s013">
      <label>S3 File</label>
      <caption>
        <title>Statistical evaluation of MESSAR rules on independent testing data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0226770.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0226770.s014">
      <label>S4 File</label>
      <caption>
        <title>MESSAR substructure recommendation for a testing spectrum.</title>
        <p>i) all matched rules sorted by <italic>recall</italic>. ii) rules were aggregated and obtained MCSs were scored and ranked.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0226770.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Special thanks goes to Sara Forcisi for evaluating the output of substructure recommendations. We also thank Danh Bui-Thi and Charlie Beirnaert for insightful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0226770.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wishart</surname><given-names>DS</given-names></name>. <article-title>Emerging applications of metabolomics in drug discovery and precision medicine</article-title>. <source>Nature Reviews Drug Discovery</source>. <year>2016</year>;<volume>15</volume>(<issue>7</issue>):<fpage>473</fpage>–<lpage>484</lpage>. <pub-id pub-id-type="doi">10.1038/nrd.2016.32</pub-id><?supplied-pmid 26965202?><pub-id pub-id-type="pmid">26965202</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Armitage</surname><given-names>EG</given-names></name>, <name><surname>Barbas</surname><given-names>C</given-names></name>. <article-title>Metabolomics in cancer biomarker discovery: Current trends and future perspectives</article-title>. <source>Journal of Pharmaceutical and Biomedical Analysis</source>. <year>2014</year>;<volume>87</volume>:<fpage>1</fpage>—<lpage>11</lpage>. <pub-id pub-id-type="doi">10.1016/j.jpba.2013.08.041</pub-id><?supplied-pmid 24091079?><pub-id pub-id-type="pmid">24091079</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Patti</surname><given-names>GJ</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>. <source>Nature Reviews Molecular Cell Biology</source>. <year>2012</year>;<volume>13</volume>(<issue>4</issue>):<fpage>263</fpage>–<lpage>269</lpage>. <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id><?supplied-pmid 22436749?><pub-id pub-id-type="pmid">22436749</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>DH</given-names></name>, <name><surname>Nguyen</surname><given-names>CH</given-names></name>, <name><surname>Mamitsuka</surname><given-names>H</given-names></name>. <article-title>Recent advances and prospects of computational methods for metabolite identification: a review with emphasis on machine learning approaches</article-title>. <source>Briefings in Bioinformatics</source>.</mixed-citation>
    </ref>
    <ref id="pone.0226770.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>S</given-names></name>, <name><surname>Thiessen</surname><given-names>PA</given-names></name>, <name><surname>Bolton</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Fu</surname><given-names>G</given-names></name>, <name><surname>Gindulyte</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>PubChem Substance and Compound databases</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>D1</issue>):<fpage>D1202</fpage>–<lpage>D1213</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv951</pub-id><?supplied-pmid 26400175?><pub-id pub-id-type="pmid">26400175</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>S</given-names></name>, <name><surname>Schmidt</surname><given-names>S</given-names></name>, <name><surname>Müller-Hannemann</surname><given-names>M</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>In silico fragmentation for computer assisted identification of metabolite mass spectra</article-title>. <source>BMC Bioinformatics 2010</source>. <year>2010</year>;<volume>148</volume>:<fpage>11</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0226770.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ridder</surname><given-names>L</given-names></name>, <name><surname>van der Hooft</surname><given-names>JJJ</given-names></name>, <name><surname>Verhoeven</surname><given-names>S</given-names></name>, <name><surname>de Vos</surname><given-names>RC</given-names></name>, <name><surname>van Schaik</surname><given-names>R</given-names></name>, <name><surname>Vervoort</surname><given-names>J</given-names></name>. <article-title>Substructure-based annotation of high-resolution multistage MS(n) spectral trees</article-title>. <source>Rapid Communication in Mass Spectrometry</source>. <year>2012</year>;<volume>26</volume>(<issue>20</issue>):<fpage>2461</fpage>–<lpage>2471</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.6364</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Tsugawa</surname><given-names>H</given-names></name>, <name><surname>Kind</surname><given-names>T</given-names></name>, <name><surname>Nakabayashi</surname><given-names>R</given-names></name>, <name><surname>Yukihira</surname><given-names>D</given-names></name>, <name><surname>Tanaka</surname><given-names>W</given-names></name>, <name><surname>Cajka</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Hydrogen Rearrangement Rules: Computational MS/MS Fragmentation and Structure Elucidation Using MS-FINDER Software</article-title>. <source>Analytical Chemistry</source>. <year>2016</year>;<volume>88</volume>(<issue>16</issue>):<fpage>7946</fpage>–<lpage>7958</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.6b00770</pub-id><?supplied-pmid 27419259?><pub-id pub-id-type="pmid">27419259</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>F</given-names></name>, <name><surname>Greiner</surname><given-names>R</given-names></name>, <name><surname>Wishart</surname><given-names>D</given-names></name>. <article-title>Competitive fragmentation modeling of ESI-MS/MS spectra for putative metabolite identification</article-title>. <source>Metabolomics</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>98</fpage>–<lpage>110</lpage>. <pub-id pub-id-type="doi">10.1007/s11306-014-0676-4</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Cereto-Massagué</surname><given-names>A</given-names></name>, <name><surname>Ojeda</surname><given-names>MJ</given-names></name>, <name><surname>Valls</surname><given-names>C</given-names></name>, <name><surname>Mulero</surname><given-names>M</given-names></name>, <name><surname>Garcia-Vallvé</surname><given-names>S</given-names></name>, <name><surname>Pujadas</surname><given-names>G</given-names></name>. <article-title>Molecular fingerprint similarity search in virtual screening</article-title>. <source>Methods</source>. <year>2015</year>;<volume>71</volume>:<fpage>58</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.08.005</pub-id><?supplied-pmid 25132639?><pub-id pub-id-type="pmid">25132639</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dührkop</surname><given-names>K</given-names></name>, <name><surname>Shen</surname><given-names>H</given-names></name>, <name><surname>Meusel</surname><given-names>M</given-names></name>, <name><surname>Rousu</surname><given-names>J</given-names></name>, <name><surname>Böcker</surname><given-names>S</given-names></name>. <article-title>Searching molecular structure databases with tandem mass spectra using CSI:FingerID</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2015</year>;<volume>112</volume>(<issue>41</issue>):<fpage>12580</fpage>–<lpage>12585</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1509788112</pub-id><?supplied-pmid 26392543?><pub-id pub-id-type="pmid">26392543</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Demarque</surname><given-names>DP</given-names></name>, <name><surname>Crotti</surname><given-names>AEM</given-names></name>, <name><surname>Vessecchi</surname><given-names>R</given-names></name>, <name><surname>Lopes</surname><given-names>JLC</given-names></name>, <name><surname>Lopes</surname><given-names>NP</given-names></name>. <article-title>Fragmentation reactions using electrospray ionization mass spectrometry: an important tool for the structural elucidation and characterization of synthetic and natural products</article-title>. <source>Natural Product Reports</source>. <year>2016</year>;<volume>33</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>455</lpage>. <pub-id pub-id-type="doi">10.1039/c5np00073d</pub-id><?supplied-pmid 26673733?><pub-id pub-id-type="pmid">26673733</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Blaženović</surname><given-names>I</given-names></name>, <name><surname>Kind</surname><given-names>T</given-names></name>, <name><surname>Torbašinović</surname><given-names>H</given-names></name>, <name><surname>Obrenović</surname><given-names>S</given-names></name>, <name><surname>Mehta</surname><given-names>SS</given-names></name>, <name><surname>Tsugawa</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Comprehensive comparison of in silico MS/MS fragmentation tools of the CASMI contest: database boosting is needed to achieve 93% accuracy</article-title>. <source>Journal of Cheminformatics</source>. <year>2017</year>;<volume>9</volume><pub-id pub-id-type="doi">10.1186/s13321-017-0219-x</pub-id><?supplied-pmid 29086039?><pub-id pub-id-type="pmid">29086039</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>JY</given-names></name>, <name><surname>Sanchez</surname><given-names>LM</given-names></name>, <name><surname>Rath</surname><given-names>CM</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Boudreau</surname><given-names>PD</given-names></name>, <name><surname>Bruns</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Molecular Networking as a Dereplication Strategy</article-title>. <source>Journal of Natural Products</source>. <year>2013</year>;<volume>76</volume>(<issue>9</issue>):<fpage>1686</fpage>–<lpage>1699</lpage>. <pub-id pub-id-type="doi">10.1021/np400413s</pub-id><?supplied-pmid 24025162?><pub-id pub-id-type="pmid">24025162</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Aguilar-Mogas</surname><given-names>A</given-names></name>, <name><surname>Sales-Pardo</surname><given-names>M</given-names></name>, <name><surname>Navarro</surname><given-names>M</given-names></name>, <name><surname>Guimerá</surname><given-names>R</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>. <article-title>iMet: A Network-Based Computational Tool To Assist in the Annotation of Metabolites from Tandem Mass Spectra</article-title>. <source>Analytical Chemistry</source>. <year>2017</year>;<volume>86</volume>(<issue>6</issue>):<fpage>3474</fpage>–<lpage>3482</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.6b04512</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Mrzic</surname><given-names>A</given-names></name>, <name><surname>Lermyte</surname><given-names>F</given-names></name>, <name><surname>Vu</surname><given-names>TN</given-names></name>, <name><surname>Valkenborg</surname><given-names>D</given-names></name>, <name><surname>Laukens</surname><given-names>K</given-names></name>. <article-title>InSourcerer: a high-throughput method to search for unknown metabolite modifications by mass spectrometry</article-title>. <source>Rapid Communications in Mass Spectrometry</source>. <year>2017</year>;<volume>31</volume>(<issue>17</issue>):<fpage>1396</fpage>–<lpage>1404</lpage>. <pub-id pub-id-type="doi">10.1002/rcm.7910</pub-id><?supplied-pmid 28569011?><pub-id pub-id-type="pmid">28569011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Mahieu</surname><given-names>NG</given-names></name>, <name><surname>Spalding</surname><given-names>JL</given-names></name>, <name><surname>Gelman</surname><given-names>SJ</given-names></name>, <name><surname>Patti</surname><given-names>GJ</given-names></name>. <article-title>Defining and Detecting Complex Peak Relationships in Mass Spectral Data: The Mz.unity Algorithm</article-title>. <source>Analytical Chemistry</source>. <year>2016</year>;<volume>88</volume>(<issue>18</issue>):<fpage>9037</fpage>–<lpage>9046</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.6b01702</pub-id><?supplied-pmid 27513885?><pub-id pub-id-type="pmid">27513885</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Carver</surname><given-names>JJ</given-names></name>, <name><surname>Phelan</surname><given-names>VV</given-names></name>, <name><surname>Sanchez</surname><given-names>LM</given-names></name>, <name><surname>Garg</surname><given-names>N</given-names></name>, <name><surname>Peng</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Sharing and community curation of mass spectrometry data with GNPS</article-title>. <source>Nature biotechnology</source>. <year>2016</year>;<volume>34</volume>(<issue>8</issue>):<fpage>828</fpage>–<lpage>837</lpage>. <?supplied-pmid 27504778?><pub-id pub-id-type="pmid">27504778</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>van der Hooft</surname><given-names>JJJ</given-names></name>, <name><surname>Wandy</surname><given-names>J</given-names></name>, <name><surname>Barrett</surname><given-names>MP</given-names></name>, <name><surname>Burgess</surname><given-names>KEV</given-names></name>, <name><surname>Rogers</surname><given-names>S</given-names></name>. <article-title>Topic modeling for untargeted substructure exploration in metabolomics</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2016</year>;<volume>113</volume>(<issue>48</issue>):<fpage>13738</fpage>–<lpage>13743</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1608041113</pub-id><?supplied-pmid 27856765?><pub-id pub-id-type="pmid">27856765</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>van der Hooft</surname><given-names>JJJ</given-names></name>, <name><surname>Wandy</surname><given-names>J</given-names></name>, <name><surname>Young</surname><given-names>F</given-names></name>, <name><surname>Padmanabhan</surname><given-names>S</given-names></name>, <name><surname>Gerasimidis</surname><given-names>K</given-names></name>, <name><surname>Burgess</surname><given-names>KEV</given-names></name>, <etal>et al</etal><article-title>Unsupervised discovery and comparison of structural families across multiple samples in untargeted metabolomics</article-title>. <source>Analytical Chemistry</source>;in press.</mixed-citation>
    </ref>
    <ref id="pone.0226770.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Wandy</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>van der Hooft</surname><given-names>JJJ</given-names></name>, <name><surname>Daly</surname><given-names>R</given-names></name>, <name><surname>Barrett</surname><given-names>MP</given-names></name>, <name><surname>Rogers</surname><given-names>S</given-names></name>. <article-title>Ms2lda. org: web-based topic modelling for substructure discovery in mass spectrometry</article-title>. <source>Bioinformatics</source>;<volume>34</volume>(<issue>2</issue>):<fpage>317</fpage>–<lpage>318</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx582</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Naulaerts</surname><given-names>S</given-names></name>, <name><surname>P</surname><given-names>M</given-names></name>, <name><surname>Bittremieux</surname><given-names>W</given-names></name>, <name><surname>Vu</surname><given-names>TN</given-names></name>, <name><surname>Vanden Berghe</surname><given-names>W</given-names></name>, <name><surname>Goethals</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>A primer to frequent itemset mining for bioinformatics</article-title>. <source>Briefings in Bioinformatics</source>. <year>2015</year>;<volume>16</volume>(<issue>2</issue>):<fpage>216</fpage>–<lpage>231</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbt074</pub-id><?supplied-pmid 24162173?><pub-id pub-id-type="pmid">24162173</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Vu</surname><given-names>TN</given-names></name>, <name><surname>Bittremieux</surname><given-names>W</given-names></name>, <name><surname>Valkenborg</surname><given-names>D</given-names></name>, <name><surname>Goethals</surname><given-names>B</given-names></name>, <name><surname>Lemière</surname><given-names>F</given-names></name>, <name><surname>Laukens</surname><given-names>K</given-names></name>. <article-title>Efficient Reduction of Candidate Matches in Peptide Spectrum Library Searching Using the Top k Most Intense Peaks</article-title>. <source>Journal of Proteome Research</source>. <year>2014</year>;<volume>13</volume>(<issue>9</issue>):<fpage>4175</fpage>–<lpage>4183</lpage>. <pub-id pub-id-type="doi">10.1021/pr401269z</pub-id><?supplied-pmid 25004400?><pub-id pub-id-type="pmid">25004400</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Vu</surname><given-names>TN</given-names></name>, <name><surname>Mrzic</surname><given-names>A</given-names></name>, <name><surname>Valkenborg</surname><given-names>D</given-names></name>, <name><surname>Maes</surname><given-names>E</given-names></name>, <name><surname>Lemière</surname><given-names>F</given-names></name>, <name><surname>Goethals</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Unravelling associations between unassigned mass spectrometry peaks with frequent itemset mining techniques</article-title>. <source>Proteome science</source>. <year>2014</year>;<volume>12</volume>(<issue>1</issue>):<fpage>54</fpage><pub-id pub-id-type="doi">10.1186/s12953-014-0054-1</pub-id><?supplied-pmid 25429250?><pub-id pub-id-type="pmid">25429250</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Scheubert</surname><given-names>K</given-names></name>, <name><surname>Hufsky</surname><given-names>F</given-names></name>, <name><surname>Petras</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Nothias</surname><given-names>LF</given-names></name>, <name><surname>Dührkop</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Significance estimation for large scale metabolomics annotations by spectral matching</article-title>. <source>Nature Communications</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1494</fpage><pub-id pub-id-type="doi">10.1038/s41467-017-01318-5</pub-id><?supplied-pmid 29133785?><pub-id pub-id-type="pmid">29133785</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Degen</surname><given-names>J</given-names></name>, <name><surname>Wegscheid Gerlach</surname><given-names>C</given-names></name>, <name><surname>Zaliani</surname><given-names>A</given-names></name>, <name><surname>Rarey</surname><given-names>M</given-names></name>. <article-title>On the Art of Compiling and Using ‘Drug-Like’ Chemical Fragment Spaces</article-title>. <source>ChemMedChem</source>. <year>2008</year>;<volume>3</volume>(<issue>10</issue>):<fpage>1503</fpage>–<lpage>1507</lpage>. <pub-id pub-id-type="doi">10.1002/cmdc.200800178</pub-id><?supplied-pmid 18792903?><pub-id pub-id-type="pmid">18792903</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Käll</surname><given-names>L</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>, <name><surname>MacCoss</surname><given-names>MJ</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Assigning significance to peptides identified by tandem mass spectrometry using decoy databases</article-title>. <source>Journal of Proteome Research</source>. <year>2008</year>;<volume>7</volume>(<issue>1</issue>):<fpage>29</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1021/pr700600n</pub-id><?supplied-pmid 18067246?><pub-id pub-id-type="pmid">18067246</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0226770.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Reynolds</surname><given-names>CH</given-names></name>. <article-title>Performance of Similarity Measures in 2D Fragment-Based Similarity Searching: Comparison of Structural Descriptors and Similarity Coefficients</article-title>. <source>Journal of Chemical Information and Computer Sciences</source>. <year>2002</year>;<volume>11</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
