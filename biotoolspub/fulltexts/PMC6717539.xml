<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6717539</article-id>
    <article-id pub-id-type="pmid">31358979</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0500-1</article-id>
    <article-id pub-id-type="manuscript">nihpa1532783</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Protein Secondary Structure Detection in Intermediate Resolution Cryo-EM Maps Using Deep Learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Subramaniya</surname>
          <given-names>Sai Raghavendra Maddhuri Venkata</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Terashi</surname>
          <given-names>Genki</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kihara</surname>
          <given-names>Daisuke</given-names>
        </name>
        <xref rid="CR1" ref-type="corresp">*</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Computer Science, Purdue University, West Lafayette, IN, 47907, USA</aff>
    <aff id="A2"><label>2</label>Department of Biological Sciences, Purdue University, West Lafayette, IN, 47907, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1">Author Contributions</p>
        <p id="P2">D.K. conceived the study. S.R.M.V.S. designed the Emap2sec architecture with D.K. and G.T. and S.R.M.V.S. implemented it. The datasets were selected by S.R.M.V.S. and G.T. The experiments were designed by S.R.M.V.S. and D.K. and were carried out by S.R.M.V.S. S.R.M.V.S., G.T., and D.K. analyzed the results. The manuscript was drafted by S.R.M.V.S. D.K. administrated the project and wrote the manuscript.</p>
      </fn>
      <corresp id="CR1"><label>*</label>To whom correspondence should be addressed, <email>dkihara@purdue.edu</email>, Tel: 1-765-496-2284, Fax: 1-765-496-1189</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>25</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>9</issue>
    <fpage>911</fpage>
    <lpage>917</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0500-1-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P3">An increasing number of protein structures have been solved by cryo-electron microscopy (cryo-EM). Although structures determined at near-atomic resolution are now routinely reported, many density maps are still determined at an intermediate resolution, where extracting structure information is still a challenge. We have developed a computational method, Emap2sec, which identifies the secondary structures of proteins (α helices, β sheets, and other structures) in an EM map of 5 to 10 Å resolution. Emap2sec uses a 3D deep convolutional neural network to assign secondary structure to each grid point in an EM map. We tested Emap2sec on 6.0 and 10.0 Å resolution EM maps simulated from 34 structures, as well as on 43 maps determined experimentally at 5.0 to 9.5 Å resolution. Emap2sec was able to clearly identify the secondary structures in many maps tested, and showed substantially better performance than existing methods.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p id="P4">Cryo-electron microscopy (cryo-EM) has established its position in structural biology as an indispensable method for determining macromolecular structures due to recent technological breakthroughs<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref></sup>. Recent years have seen a steep increase in the number of biomolecular structures solved by cryo-EM, including those which were determined at a high, near-atomic resolution. On the other hand, there are still many structures being solved at intermediate resolutions, 5 to 10 Å, or even at lower resolutions. Of those deposited to Electron Microscopy Data Bank<sup><xref rid="R3" ref-type="bibr">3</xref></sup> (EMDB) in 2016 through 2018, over 50% were solved at intermediate resolution. Although the number of maps determined at near-atomic resolutions will undoubtedly increase, it is expected that a substantial number of maps will be still determined at intermediate resolutions over the coming decade, since the achievable map resolution is determined by various factors, including structural flexibility of protein chains, multiple functional states as well as noise from density images<sup><xref rid="R4" ref-type="bibr">4</xref></sup>, implying that not all proteins may be solvable at high resolutions.</p>
    <p id="P5">As the resolution of an EM map drops, structural interpretation of the map becomes apparently more difficult<sup><xref rid="R5" ref-type="bibr">5</xref></sup>. This is especially true in cases of de novo modeling, which is employed when the structure of the proteins have not been solved before or cannot be built by template-based modeling<sup><xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R10" ref-type="bibr">10</xref></sup>. When a map is at a high resolution of around 2 Å, software originally designed for X-ray crystallography<sup><xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R12" ref-type="bibr">12</xref></sup> can be used to build an atomic-resolution structure model. At around 4 Å resolution, a main-chain tracing method<sup><xref rid="R13" ref-type="bibr">13</xref>,<xref rid="R14" ref-type="bibr">14</xref></sup>, such as MAINMAST<sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>, can be applied for modeling. For maps around 5 to 8 Å, some fragments of the secondary structure of proteins are typically visible, but a full trace of the main-chain is very difficult. To aid structural interpretation of maps in this resolution range, several protein secondary structure detection methods have been developed. One type of such methods identifies density regions that are typical of helices<sup><xref rid="R17" ref-type="bibr">17</xref>,<xref rid="R18" ref-type="bibr">18</xref></sup> or β sheets<sup><xref rid="R19" ref-type="bibr">19</xref>–<xref rid="R21" ref-type="bibr">21</xref></sup>, and then builds protein models<sup><xref rid="R22" ref-type="bibr">22</xref></sup> or finds known structures in PDB<sup><xref rid="R23" ref-type="bibr">23</xref></sup> that match the identified secondary structures<sup><xref rid="R24" ref-type="bibr">24</xref></sup>. Another approach used machine learning methods to detect characteristic density patterns of secondary structures<sup><xref rid="R25" ref-type="bibr">25</xref></sup>.</p>
    <p id="P6">Here, we developed a new method, Emap2sec, for detecting protein secondary structures in EM maps of intermediate resolution. Emap2sec uses a deep convolutional neural network (CNN)<sup><xref rid="R26" ref-type="bibr">26</xref>,<xref rid="R27" ref-type="bibr">27</xref></sup> at the core of its algorithm. CNN is very suitable for protein local structure identification in 3D EM maps because the method “convolves” local map density features to images of a larger region so that the local structure detection is made in the context of a large region of the map. The performance of Emap2sec was tested on two datasets of EM maps: a dataset of 6.0 and 10.0 Å resolution EM maps simulated from each of 34 structures and a dataset of 43 experimental EM maps with resolution ranging from 5.0 to 9.5 Å. The overall accuracy at each amino acid level was 83.1 % and 79.8 % on average for the simulated maps at 6.0 Å and 10.0 Å, respectively. On the experimental map dataset, the accuracy was 64.4 % on average with the highest recording 91.6 %.</p>
  </sec>
  <sec id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>The network architecture of Emap2sec</title>
      <p id="P7">Emap2sec scans a given EM map with a voxel of 11<sup>3</sup> Å<sup>3</sup> volume. The voxel reads the density values, which are processed through the deep CNN, and outputs a detected secondary structure, α helix, β sheet, or other structures for the structure at the center of the voxel (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). We adopt a two-phase stacked neural network architecture where densities from local protein structures captured in the first phase are fine-tuned in the subsequent second phase by incorporating the context of neighboring voxels.</p>
      <p id="P8"><xref rid="F1" ref-type="fig">Fig. 1b</xref> and <xref rid="F1" ref-type="fig">1c</xref> illustrate the two-phase architecture of Emap2sec. The first phase of the network (<xref rid="F1" ref-type="fig">Fig. 1b</xref>) contains five back-to-back convolutional layers, to which the input voxels of 11<sup>3</sup> Å<sup>3</sup> (i.e. 1331 density values) are fed. The convolutional layers capture local density patterns in an EM map as represented by pattern filters in the context of larger regions of the map. 32, 64, or 128 filters were used at each convolutional layer. Then, the output from the convolutional layers is processed through a max pooling layer and fully connected layers. Finally, a softmax layer outputs a probability value for each of α helix, β strand, or other structures. A stride of 1 was used uniformly in all the filters whereas a stride of 2 was used for the max pooling layer.</p>
      <p id="P9">The second phase of the network (<xref rid="F1" ref-type="fig">Fig. 1c</xref>) takes the predicted probability values from the first phase. An input of the second phase is the probability values for α helix, β strand, and other structures each in a voxel of 3<sup>3</sup> Å<sup>3</sup> size. Thus, there are 3<sup>3</sup> * 3 = 81 values. This input is fed to a network of five fully connected layers followed by a softmax layer, which finally gives a prediction of the secondary structure with a probability value for the center of target voxel. The purpose of the second phase network is to smooth predictions by considering predictions made to the neighboring voxels. For experimental maps, we set the phase 2 network to only change between α helix and β strand or from other structures to α helix/β strand, because there are more other structures in the experimental maps than in simulated maps. The two-phase network architecture is inspired by a sequence-based protein secondary structure prediction, PSIPRED<sup><xref rid="R28" ref-type="bibr">28</xref></sup>.</p>
    </sec>
    <sec id="S4">
      <title>Secondary structure detection on simulated maps</title>
      <p id="P10">We first evaluated the performance of Emap2sec on simulated EM maps computed from atomic-detailed protein structures. Parameters of the network were trained on a representative protein structure dataset obtained from the SCOPe protein domain structure database<sup><xref rid="R29" ref-type="bibr">29</xref></sup>. We tested Emap2sec on 34 simulated maps at two resolutions, 6.0 Å and 10.0 Å, which do not have overlap with data used for training (see <xref rid="S8" ref-type="sec">Methods</xref>).</p>
      <p id="P11"><xref rid="T1" ref-type="table">Table 1</xref> summarizes the accuracy of the secondary structure identification for three levels, the voxel-, residue-, and segment-levels. For each voxel to which Emap2sec makes individual structure identification, the correct secondary structure is defined as the one from the closest Cα atom within 3.0 Å to the center of the voxel. Emap2sec made fairly accurate structure detections overall. For the 6.0 Å maps, Emap2sec achieved an average overall accuracy of 0.798. Among the three secondary structure classes, α helices were detected with the highest accuracy (0.848), followed by β strands with an accuracy of 0.828. At the residue-level (Q3), accuracy higher than the voxel-level was recorded. At the segment-level, the accuracy values reached even higher, 0.872 overall. Since the residue- and the segment-level assignments were made by the majority vote from the one-step more detailed-level (i.e. the voxel- and the residue-level, respectively), the results indicate that our method was very successful in capturing overall main-chain level protein structures in the maps.</p>
      <p id="P12">We now compare the accuracy between maps simulated at 6.0 Å and at 10.0 Å (<xref rid="T1" ref-type="table">Table 1</xref>, <xref rid="F2" ref-type="fig">Fig. 2a</xref>). Looking at the Q3 accuracy in <xref rid="T1" ref-type="table">Table 1</xref>, naturally the accuracy dropped for 10.0 Å maps; however, the margin of the drop was surprisingly small. The average Q3 values of 6.0 Å and 10.0 Å maps were 0.831 and 0.798, respectively, thus the decrease was only 0.033 (3.97% relative to the 6.0 Å maps). This result is consistent with <xref rid="F2" ref-type="fig">Fig. 2a</xref>, where the Q3 values of individual maps are shown. Among the three secondary structure types, the smallest decrease of 0.023 (2.66%) was observed for α helices, indicating helices are the most tolerant to noise and visible in lower resolution maps.</p>
      <p id="P13">In <xref rid="F2" ref-type="fig">Fig. 2b</xref>, we show Q3 accuracy for individual fold classes for both 6.0 Å and 10.0 Å maps. Emap2sec performed best for the α class proteins while the accuracy for β class proteins was relatively low. We noticed that proteins in the α+β class had a higher accuracy than α/β class. This is partly because proteins in the α/β class had more residues in β strands than α+β proteins in this dataset. The average number of residues in β strands was 47.0 and 40.2 for the α/β and α+β class, respectively. Also, α+β proteins have helices and strands in spatially distinct regions by definition, which probably made identification easier for Emap2sec. The Q3 accuracy of α helices was on par, 0.854 and 0.848 for α/β and α+β while the β strand accuracy showed some gap, 0.788 and 0.840 for α/β and α+β, respectively.</p>
      <p id="P14">The last panel in <xref rid="F2" ref-type="fig">Fig. 2</xref> illustrates the effect of the two-phase network architecture of Emap2sec (<xref rid="F2" ref-type="fig">Fig. 2c</xref>). The results for maps at the two resolutions have the same trend: the phase 2 network improved the accuracy for α helices (red circles) and β strands (green downward triangles), and so did the overall accuracy (black circles). On average, the Q3 accuracies of overall, α helices, and β strands were improved by the phase 2 network by 0.011/0.011, 0.093/0.089, and 0.062/0.021, for 6.0/10.0 Å maps, respectively. Instead, the accuracy of other structures (yellow upward triangles) decreased for many maps, which indicates that the phase 2 network mainly changed assignments of other structures to either helices or strands. <xref rid="SD3" ref-type="supplementary-material">Supplementary Table 1</xref> provides all accuracy values from the phase 1 and phase 2 networks for all the simulated maps.</p>
      <p id="P15">The results shown so far are computed using the networks trained on 63 EM maps. We have also trained the networks on a larger dataset of 1963 maps (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 1</xref> and <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>) but only observed marginal improvement. Changes in the accuracies of individual maps is shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 1</xref>.</p>
      <p id="P16"><xref rid="F3" ref-type="fig">Figure 3</xref> shows examples of the structure identification by Emap2sec. The first four panels (a-d) are successful examples, one each for four fold classes, α, β, α/β, and α+β, respectively. <xref rid="F3" ref-type="fig">Fig. 3a</xref> and <xref rid="F3" ref-type="fig">3c</xref> are maps simulated at 6.0 Å while 3b and 3d are at 10.0 Å. As visualized, the identified secondary structures shown in colored spheres agree with the true structure very well. In the structure of <xref rid="F3" ref-type="fig">Fig. 3b</xref>, even small helices were correctly identified. In the α/β and α+β structures (<xref rid="F3" ref-type="fig">Fig. 3c</xref>, <xref rid="F3" ref-type="fig">3d</xref>), helices and strands are clearly distinguished.</p>
      <p id="P17">On the other hand, the two subsequent panels (<xref rid="F3" ref-type="fig">Fig. 3e</xref>, <xref rid="F3" ref-type="fig">3f</xref>) show examples where a part of the identification was apparently wrong. For these two cases, extended loop regions that have a somewhat wriggled conformation were misidentified as α helices. <xref rid="F3" ref-type="fig">Fig. 3g</xref> illustrates how the phase 2 network modifies the output from phase 1. The phase 1 output has more other structure assignments (green) even in helix regions, which were correctly changed to helix assignments in phase 2. Due to this modification by phase 2, the overall voxel-based accuracy improved from 0.705 to 0.810. The last panel (<xref rid="F3" ref-type="fig">Fig. 3h</xref>) shows an example of results for 6.0 Å and 10.0 Å maps of the same protein. The overall F1-score for the 6.0 Å map was 0.848, which deteriorated to 0.779 for the 10.0 Å map. Noticeable differences were circled on the figure of the 10.0 Å map results: some parts of β sheets were not correctly recognized, and some over-detections of α helices were observed.</p>
    </sec>
    <sec id="S5">
      <title>Structure detection in experimental maps</title>
      <p id="P18">Next, we tested Emap2sec on a dataset of 43 experimental maps with resolutions ranging from 5.0 Å to 9.5 Å. The number of residues of the proteins in these maps ranges from 664 to 11,475 and the number of chains ranges from 1 to 62. <xref rid="F4" ref-type="fig">Fig. 4a</xref> and <xref rid="F4" ref-type="fig">4b</xref> show the residue-based and the segment-based accuracy of α helices and β strands relative to the map resolution. At the residue-level (<xref rid="F4" ref-type="fig">Fig. 4a</xref>), the accuracy did not show a strong dependency on the map resolution. High accuracies of over 0.8 (0.808 to 0.916) were observed for all the maps within the resolution range of 5.0 Å to 5.7 Å. On the other hand, it is noteworthy that high accuracy was also observed for maps at around 9.0 Å resolution, 0.802 (EMD-1655, determined at a map resolution of 9.0 Å) and 0.757 (EMD-1263, map resolution: 9.1 Å).</p>
      <p id="P19">Compared with the simulated map cases, detecting structures in experimental maps is more difficult. For the simulated map dataset, the average residue-based accuracy was 0.831 and 0.798 for the resolution of 6.0 Å and 10.0 Å (<xref rid="T1" ref-type="table">Table 1</xref>), respectively. On the other hand, the average accuracy for experimental maps of 5.5 to 6.5 Å and those over 9.0 Å was 0.723 and 0.563, respectively, which is a decrease by 13 % and 29% from the simulated map counterpart.</p>
      <p id="P20"><xref rid="F4" ref-type="fig">Fig. 4b</xref> shows the accuracy change by the phase 2 network over the phase 1. Similar to results for the simulated map dataset (<xref rid="F2" ref-type="fig">Fig. 2c</xref>), the accuracy for α helices and β strands were improved consistently for almost all the maps by phase 2. With the phase 2 network, the residue-based accuracy of α helices and β strands improved on average from 0.454 and 0.401 to 0.565 (24.4%) and 0.473 (17.80%), respectively.</p>
      <p id="P21">The results shown for the experimental maps were obtained by using Emap2sec trained on experimental maps. Adding simulated maps in the training set to increase the training data size did not make consistent improvement of detection results. Adding the simulated maps improved the voxel-based F1-score for 14 maps (32.6%) but deteriorated for 22 maps (51.2%) (no change for 7 maps). As a consequence the overall average voxel-based F1-score slightly deteriorated (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 2</xref>). Thus, probably because of different nature of two types of maps, adding simulated maps in training did not help much for structure detection in experimental maps.</p>
      <p id="P22">We discuss several illustrative examples in <xref rid="F5" ref-type="fig">Fig. 5</xref>. The first four panels (5a – 5d) are cases where Emap2sec performed well. <xref rid="F5" ref-type="fig">Fig. 5a</xref> and <xref rid="F5" ref-type="fig">5b</xref> are α helix-rich and β strand-rich complex structures, respectively. The dominance of α helices in <xref rid="F5" ref-type="fig">Fig. 5a</xref> and β strands in <xref rid="F5" ref-type="fig">Fig. 5b</xref> was vividly captured, which yielded high accuracy values (see the figure caption). In addition, β sheets in <xref rid="F5" ref-type="fig">Fig. 5a</xref> and α helices in <xref rid="F5" ref-type="fig">fig. 5b</xref>, which share a small portion in the maps, were accurately detected. The next example (<xref rid="F5" ref-type="fig">Fig. 5c</xref>), archaeal 20S proteasome, is a more difficult case where α helices and β strands exist in almost the same amounts in the structure, 38.4% and 29.9% of all the residues, respectively. Despite the more complex structure, Emap2sec was able to detect the secondary structures distinctively as highlighted in the zoomed window and successfully captured the overall architecture of the structure that has layers of α helices and β sheet domains. <xref rid="F5" ref-type="fig">Fig. 5d</xref> is another example of structures with a similar amount of α helices (39.8%) and β strands (22.7%) except that the map resolution is lower, at 8.34 Å. Although the overall accuracy was lower than the previous example (<xref rid="F5" ref-type="fig">Fig. 5c</xref>), β strand-rich domain on the left in the figure and α helix-rich domain and structural details were well captured, including locations of β sheets in the α helix-rich domain and a single helix that bridges the two large domains (the zoomed window). The next one is an example where the detection did not work very well (<xref rid="F5" ref-type="fig">Fig. 5e</xref>). For this map determined at 9.1 Å, the overall Q3 accuracy was relatively low, 0.565, partly because many α helices on the left side of the structure were misrecognized as β strands. It turned out that it was because, as shown in the zoomed window, many such helices have lower density than β stands, often even almost outside the contour level, which is opposite to the usual case where α helices have higher density than β strands.</p>
      <p id="P23">In <xref rid="F5" ref-type="fig">Fig. 5f</xref> applied Emap2sec to an EM map determined at 7.94 Å that has no structural assignment (EMD-4361, mLRRC8A/C volume-gated anion channel<sup><xref rid="R30" ref-type="bibr">30</xref></sup>). Although this map does not have associated PDB files in EMDB, it turned out that the authors also deposited two additional higher resolution EM maps (EMD-4366 determined at 5.01 Å and EMD-4367 at 4.25 Å) that have associated PDB entries. When compared with those PDB structures, Emap2sec’s detection was quite correct, including β propeller structures on the top (two right panels) and β sheets at the bottom (the LRRC8A subunits) in the side-view (two left panels. α helices surrounding the β sheets are outside the author-recommended contour level hence not analyzed by Emap2sec). Thus, Emap2sec was able to perform structural assignment even with the map at 7.94 Å resolution.</p>
      <p id="P24">Detected secondary structure information will be useful for assigning subunit structures in an EM map. <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 3</xref> shows two such examples. In the first map, HIV capsid proteins in complex with antibodies (EMD-8693), the detected secondary structures would help assigning β-sandwich structures of Fab proteins as well as three other α-helical chains that are distinctively and accurately detected in the map. Similarly, in the second example, a map of Tor2 in complex with Lst8 (EMD-3229), the locations of two chains of Lst8, which has a round-shaped β-class structure, are clearly visible in the detected structure.</p>
    </sec>
    <sec id="S6">
      <title>Comparison with related works</title>
      <p id="P25">Emap2sec showed substantially better performance than two widely used protein structure modeling methods, Phenix<sup><xref rid="R12" ref-type="bibr">12</xref></sup> and ARP/wARP (ver. 8.0)<sup><xref rid="R31" ref-type="bibr">31</xref></sup> on the dataset of simulated maps at 6.0 Å and 10.0 Å (<xref rid="SD5" ref-type="supplementary-material">Supplementary Table 4</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 4</xref>).</p>
      <p id="P26">Emap2sec was also compared with two similar methods, HelixHunter<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, which uses a probe helix to identify helices in a map, and a more recent method by the Jing He group<sup><xref rid="R25" ref-type="bibr">25</xref></sup>, which uses CNN. Overall Emap2sec showed better performance than these two existing methods on the simulated maps used in their original papers (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 5</xref> and <xref rid="SD2" ref-type="supplementary-material">6</xref>).</p>
    </sec>
  </sec>
  <sec id="S7">
    <title>Discussion</title>
    <p id="P27">We developed Emap2sec, a novel approach that can detect protein secondary structures in an EM density map of intermediate resolution. This work shows that structure information of proteins can be obtained from an intermediate resolution EM maps more vividly and accurately than conventional methods partly owing to a recent advanced image processing algorithm. Expanding the approach to handle other molecules, such as DNAs, RNAs, lipids as well as large posttranslational modifications, is left for future work. Emap2sec will be able to push the limit of extracting structure information and aid for structural modeling and will be an indispensable tool for interpreting density maps in the era of cryo-EM structural biology.</p>
  </sec>
  <sec id="S8">
    <title>Methods</title>
    <sec id="S9">
      <title>Training the deep neural network of Emap2sec</title>
      <p id="P28">We used two datasets, simulated EM maps and experimental EM maps for training and testing Emap2sec. We explain the training procedure on the simulated EM map dataset as the process for the experimental EM map dataset is essentially the same.</p>
      <p id="P29">For the dataset of simulated maps, we downloaded one representative structure each from a superfamily level classification in the SCOPe database<sup><xref rid="R29" ref-type="bibr">29</xref></sup> (ver. 2.06), then structures were removed if they have over 25% sequence identity with another structure in the dataset. This remained 2000 structures. Next, we used the e2pdb2mrc program from EMAN2 package<sup><xref rid="R32" ref-type="bibr">32</xref></sup> (version 2.11) to generate simulated EM maps at 6.0 Å and 10.0 Å for each structure. Density values were normalized in each map to the range of 0.0 to 1.0 by subtracting the minimum density value in the map and then divide by the density difference between the maximum and the minimum density values. If there are negative density values, they were set to 0.0 before the normalization.</p>
      <p id="P30">The input density data of Emap2sec is a voxel of a size 11 Å *11 Å *11 Å. We have also tried a smaller size, 5 Å *5 Å *5 Å, but it performed substantially worse than the current setting. The data were obtained from a map by traversing each map along the three dimensions with the voxels with a stride of 2.0 Å. Each voxel was assigned with a closest Cα atom that is within 3.0 Å to the center of the voxels, to which a secondary structure type was assigned using STRIDE<sup><xref rid="R33" ref-type="bibr">33</xref></sup>. Residues that have structure codes of H, G, or I by STRIDE were labeled as α helix, while those with codes of B/b or E were labeled as β strand.</p>
      <p id="P31">The training dataset for the phase 1 network consisted of 31,951 voxels each for α helix, β strand, and other structures, thus in total of 95,853 voxels. To select these voxels, the 2000 maps were sorted by the abundance of voxels of each secondary structure, and voxels of the secondary structure were extracted from the top 8, 15, and 8 maps with the largest number of voxels of the secondary structure. Since the number of voxels was sufficient and helices and strands appear in various orientations in the voxels, we did not perform data augmentation by rotating maps. This training dataset was constructed at both 6.0 Å and 10.0 Å resolutions. The training was performed independently for 6.0 Å and 10.0 Å resolutions.</p>
      <p id="P32">The phase 1 network consists of five layers of convolutional neural network (CNN) followed by a fully connected network (<xref rid="F1" ref-type="fig">Fig. 1</xref>). With this training dataset, we performed a ten-fold cross-validation to determine hyper-parameters, which were regularization parameters for the CNN and the fully connected network, and the learning rate. L<sub>2</sub> and L<sub>1</sub> regularization were used for the CNN and the fully connected network, respectively. The regularization parameter values tested were [0.001, 0.005, 0.01, 0.05. 0.1, 0.5, 1, 10, 100] and the learning rate values tested were [0.0001, 0.001, 0.01, 0.1, 1, 10]. For the first fully connected layer (the connection between the layer with 1024 nodes and 256 nodes) we used the drop-out technique with a probability of 0.5. In the cross-validation, the dataset was split into ten subsets, nine among which were used for training under all the possible hyper-parameter combinations for 100–150 epochs using the Adam Optimizer to minimize the cross-entropy for the voxel-level accuracy in the softmax layer. Then, the best parameter combination was determined by the average performance on the ten testing subsets. The determined L<sub>2</sub> regularization parameter λ<sub>1</sub> of the CNN was 10, the L<sub>1</sub> regularization parameter λ<sub>2</sub> of the fully connected layer was 0.01, and the learning rate was determined to 0.001 by this procedure for both 6.0 Å and 10.0 Å resolutions.</p>
      <p id="P33">For training the phase 2 network, which is a five-layer fully connected network, we used a different dataset of 32 simulated EM maps (each for 6.0 Å and 10.0 Å). After the first phase network was fully trained, we input the 32 maps to the phase 1 network and obtained probability values for α helix, β strand, and other structures, which are input for the phase 2 network. We trained the phase 2 network for the L<sub>1</sub> regularization parameter in the same way with a fixed learning rate of 0.001. The obtained parameter was 0.1 for both 6.0 Å and 10.0 Å resolutions.</p>
      <p id="P34">We have also trained the phase 1 and 2 networks using all the maps except for the 34 test maps. They were 982 maps for training the phase 1 and other 981 maps for the phase 2 network. 3 maps were discarded because they caused errors when voxel data were generated. The results are shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 1</xref> and <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>.</p>
    </sec>
    <sec id="S10">
      <title>The dataset of experimental EM maps</title>
      <p id="P35">We also trained Emap2sec using actual EM maps retrieved from EMDB<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. Density maps that were determined at a resolution between 5.0 Å to 10.0 Å and have an associated atomic structure in PDB were selected. Then, to ensure that a map and its associated structure have sufficient structural agreement, the cross-correlation between the experimental map and the simulated map density at the resolution of the experimental map computed from the structure was examined<sup><xref rid="R34" ref-type="bibr">34</xref></sup> and only maps with a cross-correlation of over 0.65 were kept. Finally, we computed the sequence identity between underlined proteins in pairs of EM maps, and a map was removed from the dataset if its underlined protein has over 25% identity to a protein of another map in the dataset. If a map has multiple protein chains, the map was removed if at least one of the chains has over 25% identity to any chains in another map. This procedure remained 43 experimental EM maps. The grid size of the maps was unified to 1.0 Å by applying tri-linear interpolation of the electron density in the maps. Secondary structure detection by Emap2sec was evaluated only for voxels that have associated protein structures (and thus correct secondary structure of that position was known).</p>
      <p id="P36">The training and testing were performed using experimental maps of 6.0 to 10.0 Å resolution using the four-fold cross-validation. The same hyper-parameter values established for the simulated maps were used for experimental maps. The trained model was further applied to experimental maps of 5.0 to 6.0 Å resolution.</p>
    </sec>
  </sec>
  <sec id="S11">
    <title>Evaluation measures</title>
    <p id="P37">Secondary structure detection by Emap2sec was evaluated in three levels, i.e. the voxel, the amino acid residue, and the secondary structure fragment levels. Emap2sec assigns a secondary structure to each voxel in an EM map. For each voxel in the map, the “correct” secondary structure defined by STRIDE was assigned, which was taken from the closest atom that is within 3.0 Å to the center of the voxel, as discussed in the previous section. In <xref rid="T1" ref-type="table">Table 1</xref>, we also showed results with a relaxed measure, where a voxel is assigned with the secondary structure of all Cα atoms within 3.0 Å, thus potentially have multiple correct secondary structures. For the voxel-level evaluation, we used the F1-score, which is the harmonic mean of the precision and the recall of the assignments given to the entire map or to each secondary structure class:
<disp-formula id="FD1"><label>(Eq. 1)</label><mml:math display="block" id="M1" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">precision</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">recall</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">precision</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">recall</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where precision is the fraction of voxels with correct secondary structure detection over all the voxels with the secondary structure assignment by Emap2sec and recall is the fraction of the voxels with correct secondary structure detection over all the voxels that belong to the secondary structure class. The overall F1-score was computed as the weighted F1-score of the three secondary structure classes. For the residue-level evaluation, we reported the Q3 accuracy, which is the fraction of the number of residues with a correct secondary structure assignment for the entire protein and for each of the three secondary structure classes. The secondary structure of a Cα atom was considered as correctly predicted if a majority of neighboring voxels that are within 3.0 Å to the atom agreed to its secondary structure. We also reported the segment-level accuracy. A secondary structure segment is defined as a stretch of amino acids with the same secondary structure type, at least six amino acids for α helix and three residues for a β strand. A segment was considered as correctly detected if at least 50% of the voxels in that segment have the correctly assigned class label.</p>
    <sec id="S12">
      <title>Software used</title>
      <p id="P38">Software used in this work with the version and the download site information is provided in the Life Sciences Reporting Summary.</p>
    </sec>
    <sec sec-type="data-availability" id="S13">
      <title>Data Availability</title>
      <p id="P39">The raw data of accuracies are provided in <xref rid="SD2" ref-type="supplementary-material">Supplementary Information</xref>, <xref rid="SD3" ref-type="supplementary-material">Supplementary Table 1</xref>, <xref rid="SD4" ref-type="supplementary-material">3</xref>, and <xref rid="SD5" ref-type="supplementary-material">4</xref>. The experimental EM maps can be downloaded from EMDB. The data that support the findings of this study are available from the corresponding author upon request.</p>
    </sec>
    <sec id="S14">
      <title>Code Availability</title>
      <p id="P40">The Emap2sec program is freely available for academic use through <ext-link ext-link-type="uri" xlink:href="http://kiharalab.org/emap2sec/index.html">http://kiharalab.org/emap2sec/index.html</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/kiharalab/Emap2sec">https://github.com/kiharalab/Emap2sec</ext-link></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1532783-supplement-1.doc" orientation="portrait" xlink:type="simple" id="d36e646" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS1532783-supplement-2.pdf" orientation="portrait" xlink:type="simple" id="d36e650" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>3</label>
      <media xlink:href="NIHMS1532783-supplement-3.xlsx" orientation="portrait" xlink:type="simple" id="d36e654" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>4</label>
      <media xlink:href="NIHMS1532783-supplement-4.xlsx" orientation="portrait" xlink:type="simple" id="d36e658" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD5">
      <label>5</label>
      <media xlink:href="NIHMS1532783-supplement-5.xlsx" orientation="portrait" xlink:type="simple" id="d36e662" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD6">
      <label>6</label>
      <media xlink:href="NIHMS1532783-supplement-6.xlsx" orientation="portrait" xlink:type="simple" id="d36e666" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S15">
    <title>Acknowledgments</title>
    <p id="P41">The authors acknowledge Charles Christoffer for his help in finalizing the manuscript. This work was partly supported by the National Institutes of Health (R01GM123055), the National Science Foundation (DMS1614777, CMMI1825941), and the Purdue Institute of Drug Discovery.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P42"><bold>Competing Financial interests:</bold> The authors declare no competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhlbrandt</surname><given-names>W</given-names></name><article-title>Cryo-EM enters a new era</article-title>. <source>Elife</source><volume>3</volume>, <fpage>e03678</fpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">25122623</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>Y</given-names></name><article-title>Single-particle cryo-EM-How did it get here and where will it go</article-title>. <source>Science</source><volume>361</volume>, <fpage>876</fpage>–<lpage>880</lpage>, (<year>2018</year>).<pub-id pub-id-type="pmid">30166484</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Patwardhan</surname><given-names>A</given-names></name><article-title>Trends in the Electron Microscopy Data Bank (EMDB)</article-title>. <source>Acta Crystallogr D Struct Biol</source><volume>73</volume>, <fpage>503</fpage>–<lpage>508</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28580912</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Nogales</surname><given-names>E</given-names></name><article-title>The development of cryo-EM into a mainstream structural biology technique</article-title>. <source>Nat Methods</source><volume>13</volume>, <fpage>24</fpage>–<lpage>27</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27110629</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Esquivel-Rodriguez</surname><given-names>J</given-names></name> &amp; <name><surname>Kihara</surname><given-names>D</given-names></name>
<article-title>Computational methods for constructing protein structure models from 3D electron microscopy maps</article-title>. <source>J Struct Biol</source>
<volume>184</volume>, <fpage>93</fpage>–<lpage>102</lpage>, (<year>2013</year>).<pub-id pub-id-type="pmid">23796504</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Kirmizialtin</surname><given-names>S</given-names></name>, <name><surname>Loerke</surname><given-names>J</given-names></name>, <name><surname>Behrmann</surname><given-names>E</given-names></name>, <name><surname>Spahn</surname><given-names>CM</given-names></name> &amp; <name><surname>Sanbonmatsu</surname><given-names>KY</given-names></name>
<article-title>Using Molecular Simulation to Model High-Resolution Cryo-EM Reconstructions</article-title>. <source>Methods Enzymol</source>
<volume>558</volume>, <fpage>497</fpage>–<lpage>514</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">26068751</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Miyashita</surname><given-names>O</given-names></name>, <name><surname>Kobayashi</surname><given-names>C</given-names></name>, <name><surname>Mori</surname><given-names>T</given-names></name>, <name><surname>Sugita</surname><given-names>Y</given-names></name> &amp; <name><surname>Tama</surname><given-names>F</given-names></name>
<article-title>Flexible fitting to cryo-EM density map using ensemble molecular dynamics simulations</article-title>. <source>J Comput Chem</source>
<volume>38</volume>, <fpage>1447</fpage>–<lpage>1461</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28370077</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Esquivel-Rodriguez</surname><given-names>J</given-names></name> &amp; <name><surname>Kihara</surname><given-names>D</given-names></name>
<article-title>Fitting Multimeric Protein Complexes into Electron Microscopy Maps Using 3D Zernike Descriptors</article-title>. <source>J Phys Chem B</source>
<volume>116</volume>, <fpage>6854</fpage>–<lpage>6861</lpage>, (<year>2012</year>).<pub-id pub-id-type="pmid">22417139</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Saha</surname><given-names>M</given-names></name> &amp; <name><surname>Morais</surname><given-names>MC</given-names></name>
<article-title>FOLD-EM: automated fold recognition in medium- and low-resolution (4–15 A) electron density maps</article-title>. <source>Bioinformatics</source>
<volume>28</volume>, <fpage>3265</fpage>–<lpage>3273</lpage>, (<year>2012</year>).<pub-id pub-id-type="pmid">23131460</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name><article-title>Accurate flexible fitting of high-resolution protein structures into cryo-electron microscopy maps using coarse-grained pseudo-energy minimization</article-title>. <source>Biophys J</source><volume>100</volume>, <fpage>478</fpage>–<lpage>488</lpage>, (<year>2011</year>).<pub-id pub-id-type="pmid">21244844</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>A</given-names></name><etal/><article-title>Tools for macromolecular model building and refinement into electron cryo-microscopy reconstructions</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source><volume>71</volume>, <fpage>136</fpage>–<lpage>153</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">25615868</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Terwilliger</surname><given-names>TC</given-names></name><etal/><article-title>Iterative model building, structure refinement and density modification with the PHENIX AutoBuild wizard</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source><volume>64</volume>, <fpage>61</fpage>–<lpage>69</lpage>, (<year>2008</year>).<pub-id pub-id-type="pmid">18094468</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>DiMaio</surname><given-names>F</given-names></name><etal/><article-title>Atomic-accuracy models from 4.5-A cryo-electron microscopy data with density-guided iterative local refinement</article-title>. <source>Nat Methods</source><volume>12</volume>, <fpage>361</fpage>–<lpage>365</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">25707030</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>M</given-names></name>, <name><surname>Baldwin</surname><given-names>PR</given-names></name>, <name><surname>Ludtke</surname><given-names>SJ</given-names></name> &amp; <name><surname>Baker</surname><given-names>ML</given-names></name>
<article-title>De Novo modeling in cryo-EM density maps with Pathwalking</article-title>. <source>J Struct Biol</source>
<volume>196</volume>, <fpage>289</fpage>–<lpage>298</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27436409</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Terashi</surname><given-names>G</given-names></name> &amp; <name><surname>Kihara</surname><given-names>D</given-names></name>
<article-title>De novo main-chain modeling for EM maps using MAINMAST</article-title>. <source>Nat Commun</source>
<volume>9</volume>, <fpage>1618</fpage>, (<year>2018</year>).<pub-id pub-id-type="pmid">29691408</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Terashi</surname><given-names>G</given-names></name> &amp; <name><surname>Kihara</surname><given-names>D</given-names></name>
<article-title>De novo main-chain modeling with MAINMAST in 2015/2016 EM Model Challenge</article-title>. <source>J Struct Biol</source>
<volume>204</volume>, <fpage>351</fpage>–<lpage>359</lpage>, (<year>2018</year>).<pub-id pub-id-type="pmid">30075190</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>W</given-names></name>, <name><surname>Baker</surname><given-names>ML</given-names></name>, <name><surname>Ludtke</surname><given-names>SJ</given-names></name> &amp; <name><surname>Chiu</surname><given-names>W</given-names></name>
<article-title>Bridging the information gap: computational tools for intermediate resolution structure interpretation</article-title>. <source>J Mol Biol</source>
<volume>308</volume>, <fpage>1033</fpage>–<lpage>1044</lpage>, (<year>2001</year>).<pub-id pub-id-type="pmid">11352589</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Dou</surname><given-names>H</given-names></name>, <name><surname>Burrows</surname><given-names>DW</given-names></name>, <name><surname>Baker</surname><given-names>ML</given-names></name> &amp; <name><surname>Ju</surname><given-names>T</given-names></name>
<article-title>Flexible Fitting of Atomic Models into Cryo-EM Density Maps Guided by Helix Correspondences</article-title>. <source>Biophys J</source>
<volume>112</volume>, <fpage>2479</fpage>–<lpage>2493</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28636906</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Kong</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Baker</surname><given-names>TS</given-names></name> &amp; <name><surname>Ma</surname><given-names>J</given-names></name>
<article-title>A Structural-informatics approach for tracing beta-sheets: building pseudo-C(alpha) traces for beta-strands in intermediate-resolution density maps</article-title>. <source>J Mol Biol</source>
<volume>339</volume>, <fpage>117</fpage>–<lpage>130</lpage>, (<year>2004</year>).<pub-id pub-id-type="pmid">15123425</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Si</surname><given-names>D</given-names></name> &amp; <name><surname>He</surname><given-names>J</given-names></name>
<article-title>Modeling Beta-Traces for Beta-Barrels from Cryo-EM Density Maps</article-title>. <source>Biomed Res Int</source>
<comment>2017</comment>, <fpage>1793213</fpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28164115</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Si</surname><given-names>D</given-names></name> &amp; <name><surname>He</surname><given-names>J</given-names></name>
<article-title>Tracing beta strands using StrandTwister from cryo-EM density maps at medium resolutions</article-title>. <source>Structure</source>
<volume>22</volume>, <fpage>1665</fpage>–<lpage>1676</lpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">25308866</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Lindert</surname><given-names>S</given-names></name><etal/><article-title>EM-fold: de novo atomic-detail protein structure determination from medium-resolution density maps</article-title>. <source>Structure</source><volume>20</volume>, <fpage>464</fpage>–<lpage>478</lpage>, (<year>2012</year>).<pub-id pub-id-type="pmid">22405005</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Berman</surname><given-names>HM</given-names></name><etal/><article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source><volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>, (<year>2000</year>).<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Biswas</surname><given-names>A</given-names></name><etal/><article-title>An Effective Computational Method Incorporating Multiple Secondary Structure Predictions in Topology Determination for Cryo-EM Images</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source><volume>14</volume>, <fpage>578</fpage>–<lpage>586</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">27008671</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <mixed-citation publication-type="confproc"><name><surname>Li</surname><given-names>RJ</given-names></name>, <name><surname>Si</surname><given-names>D</given-names></name>, <name><surname>Zeng</surname><given-names>T</given-names></name>, <name><surname>Ji</surname><given-names>SW</given-names></name> &amp; <name><surname>He</surname><given-names>J</given-names></name>
<article-title>Deep Convolutional Neural Networks for Detecting Secondary Structures in Protein Density Maps from Cryo-Electron Microscopy</article-title>. <conf-name>2016 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</conf-name>, <fpage>41</fpage>–<lpage>46</lpage>, (<year>2016</year>).</mixed-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Russakovsky</surname><given-names>O</given-names></name><etal/><article-title>ImageNet large scale visual recognition challenge</article-title>. <source>International Journal of Computer Vision</source><volume>115</volume>, <fpage>1</fpage>–<lpage>42</lpage>, (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <mixed-citation publication-type="confproc"><name><surname>Maturana</surname><given-names>D</given-names></name> &amp; <name><surname>Scherer</surname><given-names>S</given-names></name>
<article-title>VoxNet: A 3D convolutional neural network for real-time object recognition</article-title>. <source>I</source><conf-name>EEE/RSJ International Conference on Intelligent Robots and Systems</conf-name>, <fpage>922</fpage>–<lpage>928</lpage>, (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>DT</given-names></name><article-title>Protein secondary structure prediction based on position-specific scoring matrices</article-title>. <source>J Mol Biol</source><volume>292</volume>, <fpage>195</fpage>, (<year>1999</year>).<pub-id pub-id-type="pmid">10493868</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Fox</surname><given-names>NK</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name> &amp; <name><surname>Chandonia</surname><given-names>JM</given-names></name>
<article-title>SCOPe: Structural Classification of Proteins--extended, integrating SCOP and ASTRAL data and classification of new structures</article-title>. <source>Nucleic Acids Res</source>
<volume>42</volume>, <fpage>D304</fpage>–<lpage>309</lpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">24304899</pub-id></mixed-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Deneka</surname><given-names>D</given-names></name>, <name><surname>Sawicka</surname><given-names>M</given-names></name>, <name><surname>Lam</surname><given-names>AKM</given-names></name>, <name><surname>Paulino</surname><given-names>C</given-names></name> &amp; <name><surname>Dutzler</surname><given-names>R</given-names></name>
<article-title>Structure of a volume-regulated anion channel of the LRRC8 family</article-title>. <source>Nature</source>
<volume>558</volume>, <fpage>254</fpage>–<lpage>259</lpage>, (<year>2018</year>).<pub-id pub-id-type="pmid">29769723</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Langer</surname><given-names>G</given-names></name>, <name><surname>Cohen</surname><given-names>SX</given-names></name>, <name><surname>Lamzin</surname><given-names>VS</given-names></name> &amp; <name><surname>Perrakis</surname><given-names>A</given-names></name>
<article-title>Automated macromolecular model building for X-ray crystallography using ARP/wARP version 7</article-title>. <source>Nat Protoc</source>
<volume>3</volume>, <fpage>1171</fpage>–<lpage>1179</lpage>, (<year>2008</year>).<pub-id pub-id-type="pmid">18600222</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>G</given-names></name><etal/><article-title>EMAN2: an extensible image processing suite for electron microscopy</article-title>. <source>J Struct Biol</source><volume>157</volume>, <fpage>38</fpage>–<lpage>46</lpage>, (<year>2007</year>).<pub-id pub-id-type="pmid">16859925</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Frishman</surname><given-names>D</given-names></name> &amp; <name><surname>Argos</surname><given-names>P</given-names></name>
<article-title>Knowledge-based protein secondary structure assignment</article-title>. <source>Proteins</source>
<volume>23</volume>, <fpage>566</fpage>–<lpage>579</lpage>, (<year>1995</year>).<pub-id pub-id-type="pmid">8749853</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Monroe</surname><given-names>L</given-names></name>, <name><surname>Terashi</surname><given-names>G</given-names></name> &amp; <name><surname>Kihara</surname><given-names>D</given-names></name>
<article-title>Variability of Protein Structure Models from Electron Microscopy</article-title>. <source>Structure</source>
<volume>25</volume>, <fpage>592</fpage>–<lpage>602 e592</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28262392</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1.</label>
    <caption>
      <p id="P43">The architecture of Emap2sec. <bold>a</bold>, the flowchart. Emap2sec takes a 3D EM density map as input, and scans it with a voxel of a size of 11<sup>3</sup>Å<sup>3</sup>. There are two phases in Emap2sec. The phase 1 network takes the normalized density values of a voxel and outputs the probability values of the three secondary structure classes. The phase 2 network takes the output from the phase 1 network and refines the assignment by considering assignments made to neighboring voxels. The input is a voxel of 3<sup>3</sup> Å<sup>3</sup> where each prediction (shown in a sphere) originates from a voxel of 11<sup>3</sup>Å<sup>3</sup> in the phase 1 network. Finally, each voxel is assigned with a secondary structure class, which is the one with the largest probability among the three structure types. <bold>b</bold>, the architecture of the phase 1 deep neural networks. It has five CNN layers followed by one max pooling layer. The first CNN has 32 filters of a 4<sup>3</sup> Å<sup>3</sup> size, the second and the third ones are with 64 filters of a 3<sup>3</sup> Å<sup>3</sup> size, and the fourth and the fifth ones with 128 filters of a 3<sup>3</sup> Å<sup>3</sup> size. The last layers of the network are two fully connected (FC) layers, which have 1024 and 256 nodes each. The FC layers are connected to the output layer, which uses the softmax function to compute the probabilities for the three secondary structure classes. <bold>c</bold>, the phase 2 network. It consists of five FC layers followed by an output layer.</p>
    </caption>
    <graphic xlink:href="nihms-1532783-f0001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2.</label>
    <caption>
      <p id="P44">The secondary structure assignment performance on the simulated map dataset. The dataset consists of maps of 34 protein structures computed at 6.0 Å and at 10.0 Å. <bold>a</bold>, Q3 residue-based accuracy by map resolution. <bold>b</bold>, the Q3 accuracy for four-fold classes defined in the SCOPe database shown in box plots. The number of structures in each class is α, 9; β, 4; α/β, 6; and α+β, 14. One protein from the small protein class in the dataset is not included in this plot. The box plots show the median (M), the first (1Q) and the third quartile (3Q), and the minimum (Mi) and the maximum (Mx) values. For α class, 6.0 Å: M: 0.912, 1Q: 0.889, 3Q: 0.934, Mi: 0.873, Mx: 0.948. 10.0 Å: M: 0.844, 1Q: 0.818, 3Q: 0.864, Mi: 0.757, Mx: 0.890. For β class, 6.0 Å: M: 0.792, 1Q: 0.771, 3Q: 0.799, Mi: 0.771, Mx: 0.804. 10.0 Å: M: 0.792, 1Q: 0.745, 3Q: 0.825, Mi: 0.677, Mx: 0.850. For α/β class, 6.0 Å: M: 0.801, 1Q: 0.768, 3Q: 0.806, Mi: 0.758, Mx: 0.821. 10.0 Å: M: 0.766, 1Q: 0.735, 3Q: 0.791, Mi: 0.709, Mx: 0.800. For α+β class, M: 0.835, 1Q: 0.816, 3Q: 0.852, Mi: 0.776, Mx: 0.890. 10.0 Å: M: 0.802, 1Q: 0.762, 3Q: 0.836, Mi: 0.696, Mx: 0.899. <bold>c</bold>, The Q3 accuracy before after applying the phase 2 network. The results for the 6.0 Å maps are shown on the top, and the bottom panel is for the 10.0 Å maps. Raw data of all the maps are provided in <xref rid="SD3" ref-type="supplementary-material">Supplementary Table 1</xref>.</p>
    </caption>
    <graphic xlink:href="nihms-1532783-f0002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3.</label>
    <caption>
      <p id="P45">Examples of the secondary structure assignment for simulated maps at 6.0 and 10.0 Å. For each panel, the main-chain structure of the protein in the simulated EM map is shown on the left while the right figure with small spheres shows the final structure assignments from the phase 2 network. Spheres in magenta are assignments of α helices; yellow, β strands; and green, other structures. See <xref rid="SD3" ref-type="supplementary-material">Supplementary Table 1</xref> for all accuracy values of the examples. <bold>a</bold>, an α class protein of 114 residue-long (SCOPe code: d1azta1). The map was simulated at 6.0 Å. The overall F1 score, voxel-based accuracy (Acc), Q3 accuracy, and the segment-based accuracy of α helices and β strands (Seg<sub>ab</sub>) were 0.908, 0.908, 0.948, and 1.0, respectively. <bold>b</bold>, a β class protein (d1a12a_), 401 residues. Resolution: 10.0 Å. F1: 0.642; Acc: 0.641; Q3: 0.677; Seg<sub>ab</sub>: 0.862. The segment-based accuracy for β strands was 0.862. <bold>c</bold>, an α/β class protein (d1acoa2), 527 residues. Resolution: 6.0 Å. F1: 0.750; Acc: 0.748; Q3: 0.799; Seg<sub>ab</sub>: 0.865. <bold>d</bold>, an α+β class protein (d1b25a2), 210 residues. Resolution: 10.0 Å. F1: 0.661; Acc: 0.665; Q3: 0.730; Seg<sub>ab</sub>: 0.941. <bold>e</bold>, a structure with a region of a low accuracy for other structures. A 138 residue-long α/β class protein (d1a9×a2). Resolution: 6.0 Å. F1: 0.633; Acc: 0.670; Q3: 0.676; Seg<sub>ab</sub>: 1.0. Accuracies for other structures: F1: 0.396; Acc: 0.283; Q3, 0.275. <bold>f</bold>, another structure with a low accuracy for other structures. An α/β class protein (d1atia1), 111 residues. Resolution: 10.0 Å. F1: 0.698; Acc: 0.711; Q3: 0.768; Seg<sub>ab</sub>: 1.0. Accuracies for other structures: F1: 0.581; Acc: 0.48; Q3, 0.533. <bold>g</bold>, an example of assignment changes from the phase 1 to phase 2 network. An α class protein (d1abva_), 105 residues. Resolution: 10.0 Å. Phase 1, F1: 0.752 (overall), 0.807 (α), and 0.469 (other structures). Phase 2, F1: 0.834 (overall), 0.889 (α), and 0.546 (other structures). <bold>h</bold>, an example of structure detection for 6.0 Å and 10.0 Å maps. db133n_, 67 residues. The map on the left is simulated at 6.0 Å. F1 scores of 6.0 Å /10.0 Å maps: 0.848/0.779 (overall), 0.788/0.756 (α), 0.893/0.820 (β), 0.851/0.764 (other structures).</p>
    </caption>
    <graphic xlink:href="nihms-1532783-f0003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4.</label>
    <caption>
      <p id="P46">The secondary structure detection accuracy on the 43 experimental maps. See <xref rid="SD4" ref-type="supplementary-material">Supplementary Table 3</xref> for details of the accuracy of each map. <bold>a</bold>, the Q3 accuracy relative to the map resolution. <bold>b</bold>, Q3 accuracy before after applying the phase 2 network. <xref rid="SD4" ref-type="supplementary-material">Supplementary Table 3</xref> provides raw data of all the maps.</p>
    </caption>
    <graphic xlink:href="nihms-1532783-f0004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5.</label>
    <caption>
      <p id="P47">Examples for experimental maps. The density map and the protein structures (associated PDB structure for the map listed in EMDB) are shown on the left and the secondary structure detection by Emap2sec is shown on the right. Spheres in magenta, yellow, and green show detected α helices, β strands, and other structures, respectively, by Emap2sec. The author-recommended contour level was used to visualize EM maps with a darker color than in <xref rid="F3" ref-type="fig">Fig. 3</xref>. <xref rid="SD4" ref-type="supplementary-material">Supplementary Table 3</xref> provides all evaluation values of these maps. <bold>a</bold>, Katanin hexamer, (EMD-8796). Resolution: 6.0 Å. This protein complex has six chains, 1662 residues in total, among which 47.7% are in α helices. The overall (α helices) F1: 0.434 (0.675); Acc: 0.495 (0.825); Q3: 0.622 (0.839); and Seg<sub>ab</sub> 0.957 (0.941). In the parentheses show are values for α helices. <bold>b</bold>, BG505 SOSIP.664 in complex with antibodies BG1 and 8ANC195 (EMD-8693). Resolution: 6.2 Å. 16 chains and 3940 residues, among which 42.0% are in β strands. The overall (β strands) F1: 0.505 (0.662); Acc: 0.529 (0.728); Q3: 0.676 (0.767); Seg<sub>ab</sub>: 0.797 (0.788). <bold>c</bold>, Archaeal 20S proteasome (EMD-1733). Resolution: 6.8 Å. 28 chains with 6020 residues. The overall (α helices/β strands) F1: 0.520 (0.677/0.593); Acc: 0.554 (0.797/0.619); Q3: 0.746 (0.8/0.632); Seg<sub>ab</sub>: 0.757 (0.923/0.740). In the parentheses shown are values for α helices and β strands. <bold>d</bold>, <italic>E. coli</italic> replicative DNA polymerase complex (EMD-3201). Resolution: 8.34 Å. 5 chains with 2219 residues. The overall (α helices/β strands) F1: 0.406 (0.587/0.381); Acc: 0.447 (0.735/0.398); Q3: 0.611 (0.756/0.413); Seg<sub>ab</sub> 0.560 (0.781/0.441). <bold>e</bold>, bacteriophage phi6 packaging hexamer P4 (EMD-3572). Resolution: 9.1 Å. F1: 0.398; Q3: 0.565. The domain on the right does not have structure assignment by the authors. <bold>f</bold>, mLRRC8A/C volume-gated anion channel (EMD-4361). Resolution: 7.94 Å. The PDB structure shown is from another EM map (EMD-4366) of the same protein (6g9l). F1: 0.571; Q3: 0.862. Two left panels, a side-view; right panels, a top-view. This map was not included in the dataset of 43 experimental maps because it does not have associated PDB structure.</p>
    </caption>
    <graphic xlink:href="nihms-1532783-f0005"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1.</label>
    <caption>
      <p id="P48">Summary of the secondary structure identification for simulated maps.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="center" valign="top" rowspan="1" colspan="1">Measure<sup><xref rid="TFN2" ref-type="table-fn">a</xref>)</sup></th>
          <th align="center" valign="top" rowspan="1" colspan="1">Resolution</th>
          <th align="center" valign="top" rowspan="1" colspan="1">α helices</th>
          <th align="center" valign="top" rowspan="1" colspan="1">β strands</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Others</th>
          <th align="center" valign="top" rowspan="1" colspan="1">All</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="2" align="center" valign="top" colspan="1">
            <bold>Voxel-based F1 score</bold>
          </td>
          <td align="center" valign="top" rowspan="1" colspan="1">6.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.844 (0.852)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.755 (0.771)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.713 (0.730)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">10.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.791 (0.799)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.729 (0.743)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.664 (0.680)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td rowspan="2" align="center" valign="top" colspan="1">
            <bold>Voxel-based Accuracy</bold>
          </td>
          <td align="center" valign="top" rowspan="1" colspan="1">6.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.848 (0.853)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.828 (0.839)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.672 (0.693)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.798 (0.811)</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">10.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.824 (0.828)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.753 (0.763)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.637 (0.657)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.756 (0.769)</td>
        </tr>
        <tr>
          <td rowspan="2" align="center" valign="top" colspan="1">
            <bold>Residue Q3</bold>
          </td>
          <td align="center" valign="top" rowspan="1" colspan="1">6.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.866 (0.866)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.866 (0.866)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.718 (0.718)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.831 (0.831)</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">10.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.843 (0.843)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.839 (0.839)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.681 (0.681)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.798 (0.798)</td>
        </tr>
        <tr>
          <td rowspan="2" align="center" valign="top" colspan="1">
            <bold>Segments</bold>
          </td>
          <td align="center" valign="top" rowspan="1" colspan="1">6.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.993</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.942</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.971<sup><xref rid="TFN3" ref-type="table-fn">b</xref>)</sup></td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">10.0 Å</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.960</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.905</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0.938<sup><xref rid="TFN3" ref-type="table-fn">b</xref>)</sup></td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <p id="P49">In parentheses for the F1 score, the accuracy and the residue Q3, values are shown for the relaxed measure, where multiple secondary structures may be considered as correct for a voxel if there are multiple Cα atoms within 3.0 Å that have different secondary structure assignments.</p>
      </fn>
      <fn id="TFN2">
        <label>a)</label>
        <p id="P50">the F1 score and the accuracy are cube-level evaluations. The F1 score is the harmonic mean of precision and recall while the accuracy is the recall. The residue Q3 is the accuracy is the residue-level accuracy (thus recall); and the segment considers the fraction of segments that are correctly identified. See Method for further details of the evaluation measures.</p>
      </fn>
      <fn id="TFN3">
        <label>b)</label>
        <p id="P51">only α helices and β strands were considered.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
