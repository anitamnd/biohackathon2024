<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8760685</article-id>
    <article-id pub-id-type="publisher-id">4546</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04546-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LuxRep: a technical replicate-aware method for bisulfite sequencing data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1739-0503</contrib-id>
        <name>
          <surname>Malonzo</surname>
          <given-names>Maia H.</given-names>
        </name>
        <address>
          <email>maia.malonzo@aalto.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Halla-aho</surname>
          <given-names>Viivi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Konki</surname>
          <given-names>Mikko</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lund</surname>
          <given-names>Riikka J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5373.2</institution-id><institution-id institution-id-type="ISNI">0000000108389418</institution-id><institution>Department of Computer Science, </institution><institution>Aalto University, </institution></institution-wrap>00076 Espoo, Finland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.1374.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 1371</institution-id><institution>Turku Bioscience Centre, </institution><institution>University of Turku and Åbo Akademi University, </institution></institution-wrap>20520 Turku, Finland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>41</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">DNA methylation is commonly measured using bisulfite sequencing (BS-seq). The quality of a BS-seq library is measured by its bisulfite conversion efficiency. Libraries with low conversion rates are typically excluded from analysis resulting in reduced coverage and increased costs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed a probabilistic method and software, LuxRep, that implements a general linear model and simultaneously accounts for technical replicates (libraries from the same biological sample) from different bisulfite-converted DNA libraries. Using simulations and actual DNA methylation data, we show that including technical replicates with low bisulfite conversion rates generates more accurate estimates of methylation levels and differentially methylated sites. Moreover, using variational inference speeds up computation time necessary for whole genome analysis.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this work we show that taking into account technical replicates (i.e. libraries) of BS-seq data of varying bisulfite conversion rates, with their corresponding experimental parameters, improves methylation level estimation and differential methylation detection.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Methylation</kwd>
      <kwd>Bisulfite sequencing</kwd>
      <kwd>Probabilistic</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par6">DNA methylation is a form of epigenetic regulation wherein cytosine is either methylated or demethylated. It is known to both repress and promote gene expression depending on its location relative to the target gene (e.g. CpG islands, shelves, shores or open sea) and pattern (hypomethylated or hypermethylated). As such, its dysregulation is associated with many diseases, including cancer. One of the most widely used methods for measuring DNA methylation is bisulfite sequencing [<xref ref-type="bibr" rid="CR1">1</xref>]. When single-stranded DNA reacts with bisulfite, unmethylated cytosine is converted into uracil whereas methylated cytosine does not. Subsequent sequencing generates thymine in place of the converted unmethylated cytosine. To determine methylation counts, the resulting sequences are mapped to a reference genome to identify cytosine loci and so differentiate between unmethylated cytosine and thymine loci.</p>
    <p id="Par7">Several methods have been developed to estimate methylation levels and analyze differential methylation. One of the methods, Methylkit, uses two approaches, logistic regression (for samples with replicates) and Fisher’s exact test [<xref ref-type="bibr" rid="CR2">2</xref>]. Another method, BSmooth, assumes that methylation count follows a binomial distribution and estimates methylation levels using a local likelihood smoother within a given window [<xref ref-type="bibr" rid="CR3">3</xref>]. Many of the methods use the beta-binomial distribution to model methylation levels. RADmeth uses the beta-binomial regression model (with the logit link function) to estimate methylation levels [<xref ref-type="bibr" rid="CR4">4</xref>]. BiSeq uses a binomial model in smoothing methylation levels within a window (cluster) with weights from a triangular kernel which is a function of distance between CpG loci [<xref ref-type="bibr" rid="CR5">5</xref>]. MethylSig uses a beta-binomial approach with an approximation method for estimating the beta parameters [<xref ref-type="bibr" rid="CR6">6</xref>]. MOABS, apart from using the beta-binomial model to estimate methylation levels, estimates a credible interval for the methylation difference between single cytosines (“credible methylation difference”) [<xref ref-type="bibr" rid="CR7">7</xref>]. The paper mentions a feature for estimating bisulfite conversion rate but does not elaborate or mention if the estimate is integrated into the model estimating methylation. DSS-general also uses beta-binomial regression to model count data and it uses the arcsine link function [<xref ref-type="bibr" rid="CR8">8</xref>]. DMRfinder clusters CpG sites into regions given a specified distance threshold then uses a hierarchical beta-binomial model [<xref ref-type="bibr" rid="CR9">9</xref>]. Save for MOABS, none of these methods estimate bisulfite conversion rate and none, including MOABS, takes this rate into account when estimating methylation level or detecting differential methylation.</p>
    <p id="Par8">In the optimal case, the bisulfite conversion rate of a DNA library is high (e.g. above 99%) [<xref ref-type="bibr" rid="CR10">10</xref>]. However, when an experiment yields a low conversion rate the common lab practice is to exclude the DNA library so as to avoid overestimation of methylation levels, resulting in additional costs or smaller sample size depending on whether a replacement library is prepared or not. An advanced computational approach to handle poor conversion rates would render exclusion of samples unnecessary. The methylation analysis method LuxGLM [<xref ref-type="bibr" rid="CR11">11</xref>] estimates methylation levels from bisulfite sequencing data using a probabilistic model that accounts for bisulfite conversion rate. It showed that taking into account experimental parameters like bisulfite conversion efficiency improved accuracy of methylation analysis. However, though this model was able to handle biological replicates with a general linear model component, it assumed data from each sample consisted of only a single bisulfite-converted DNA library. In this work we propose LuxRep, an improved method and software to allow use of replicates from different DNA libraries with varying bisulfite conversion rates. To make LuxRep tool computationally efficient and thus more applicable to genome-wide analysis we also propose to use variational inference.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par9">Our software consists of two modules: (1) estimation of experimental parameters from control data (“experimental parameters”) and (2) inference of methylation level (“biological parameters”) and differential methylation from DNA bisulfite sequencing data using the previously estimated experimental parameters. While LuxGLM was originally designed for analysis of both methylated (5mC) and hydroxymethylated cytosines (5hmC), the level for only one methylation modification (methylcytosine, 5mC) is included in this work (although our model can also be extended to 5hmC).<fig id="Fig1"><label>Fig. 1</label><caption><p>Plate diagram of LuxRep model for the module analyzing experimental parameters from control data</p></caption><graphic xlink:href="12859_2021_4546_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Plate diagram of the LuxRep model for estimating methylation level of a single cytosine with biological as well as technical replicates. The circles represent latent (white) and observed (gray) variables and the unbordered nodes represent constants</p></caption><graphic xlink:href="12859_2021_4546_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Plate diagram of LuxRep model for generating dummy control data</p></caption><graphic xlink:href="12859_2021_4546_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par10">To facilitate genome wide analysis, in our model implementation the experimental parameters are first computed from the control data since all cytosines per technical replicate have the same value for these parameters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Methylation levels are then determined individually for each cytosine, and differential methylation thereafter, using the pre-computed experimental parameters as fixed input (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). We will next describe these two models in detail in Sects. 2.1–2.2.</p>
    <sec id="Sec3">
      <title>Experimental parameters</title>
      <p id="Par11">Methylation estimates are a function of experimental parameters: bisulfite conversion rate (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq1.gif"/></alternatives></inline-formula>), sequencing error (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq2.gif"/></alternatives></inline-formula>) and incorrect bisulfite conversion rate (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq3.gif"/></alternatives></inline-formula>). A BS-seq library with low <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq4.gif"/></alternatives></inline-formula> results in overestimation of methylation levels. High <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq5.gif"/></alternatives></inline-formula>, on the other hand, can lead to both over and underestimation of methylation levels. Though typically not measured in high-throughput bisulfite sequencing experiments, high <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq6.gif"/></alternatives></inline-formula> leads to underestimation of methylation level.</p>
      <p id="Par12">To demonstrate that differences in technical parameters (specifically bisulfite conversion rate) is common we took a real bisulfite sequencing dataset [<xref ref-type="bibr" rid="CR12">12</xref>] and compared the bisulfite conversion efficiencies of the technical replicates (i.e. libraries) per biological replicate (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Most samples had significantly variable conversion rates, i.e. differences in technical parameters is common. Moreover, in practice, BS-seq datasets obtained with non-optimal conversion efficiencies are commonly ignored as currently there does not exist a statistical analysis tool that would allow analyzing BS-seq datasets with different conversion efficiencies. This in turn leads to loss of data, decrease in statistical power, loss of a biological sample, and increase in sequencing costs.</p>
      <p id="Par13">We start by briefly reviewing the underlying statistical model [<xref ref-type="bibr" rid="CR11">11</xref>] and then introduce our extension that can handle technical replicates. Briefly, the conditional probability of a sequencing readout being “C” in BS-seq data is a function of the experimental parameters that include <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq8.gif"/></alternatives></inline-formula>, and depends on the methylation level <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \in [0,1]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq9.gif"/></alternatives></inline-formula>. If a read was generated from an unmethylated cytosine (C), the conditional probability <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\rm{BS}}(\text{``C''|C})$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''|C</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq10.gif"/></alternatives></inline-formula> is given by<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\rm{BS}}(\text{``C''|C})=(1-\text{BS}_{\rm eff})(1-\text{seq}_{\rm err}) + \text{BS}_{\rm eff} \text{seq}_{\rm err}.$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''|C</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The term <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1-\text{BS}_{\rm eff})(1-\text{seq}_{\rm err})$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq11.gif"/></alternatives></inline-formula> refers to the condition wherein unmethylated cytosine is incorrectly not converted into uracil and correctly sequenced as “C” whereas the term <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff} \text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq12.gif"/></alternatives></inline-formula> represents the condition wherein the unmethylated cytosine is correctly converted into uracil but incorrectly sequenced as “C”. Similarly, in the case of methylated cytosine<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\rm BS}(\text{``C''|5mC}) = (1-\text{BS}^*_{\rm eff})(1-\text{seq}_{\rm err}) + \text{BS}^*_{\rm eff} \text{seq}_{\rm err},$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''|5mC</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1-\text{BS}^*_{\rm eff})(1-\text{seq}_{\rm err})$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq13.gif"/></alternatives></inline-formula> denotes the case that methylated cytosine is correctly not converted to uracil and correctly sequenced as “C” while the term <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff} \text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq14.gif"/></alternatives></inline-formula> represents the case that methylated cytosine is incorrectly converted to uracil and incorrectly sequenced as “C”.</p>
      <p id="Par14">In [<xref ref-type="bibr" rid="CR11">11</xref>], bisulfite conversion, sequencing error and incorrect bisulfite conversion rates were specific to each biological replicate, not technical replicate.</p>
      <p id="Par15">The experimental parameters follow a logistic normal distribution, where the bisulfite conversion rate <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq15.gif"/></alternatives></inline-formula> is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}=\text{logit}^{-1}(\mu _{\rm{BS}_{\rm eff}} + \sigma _{\rm{BS}_{\rm eff}}r_{\rm{BS}_{\rm eff}})$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>and its hyperparameters are<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{\rm{BS}_{\rm eff}} \sim {\mathcal {N}}(\psi ^{\mu ,\mu }_{\rm{BS}_{\rm eff}},\psi ^{\mu ,\sigma }_{\rm{BS}_{\rm eff}})$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{ln}(\sigma _{{{\rm BS}_{\rm eff}}}) \sim {\mathcal {N}}(\psi ^{\sigma ,\mu }_{\rm{BS}_{\rm eff}},\psi ^{\sigma ,\sigma }_{\rm{BS}_{\rm eff}})$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\rm{BS}_{\rm eff}} \sim {\mathcal {N}}(0,1),$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>such that <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{logit}(\text{BS}_{\rm eff}) \sim {\mathcal {N}}(\mu _{\rm{BS}_{\rm eff}},\sigma _{\rm{BS}_{\rm eff}})$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\rm{BS}_{\rm eff}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq17.gif"/></alternatives></inline-formula> is the mean and <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\rm{BS}_{\rm eff}}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq18.gif"/></alternatives></inline-formula> is the standard deviation (<inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{BS}_{\rm eff}}=4$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{BS}_{\rm eff}}=1.29$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.29</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{BS}_{\rm eff}}=0.4$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{BS}_{\rm eff}}=0.5$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq22.gif"/></alternatives></inline-formula>). See [<xref ref-type="bibr" rid="CR13">13</xref>] for details.</p>
      <p id="Par16">The sequencing error <inline-formula id="IEq23"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq23.gif"/></alternatives></inline-formula> is modeled similarly<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err} = \text{logit}^{-1}(\mu _{\rm{seq}_{\rm err}} + \sigma _{\rm{seq}_{\rm err}}r_{\rm{seq}_{\rm err}})$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\rm{seq}_{\rm err}} \sim {\mathcal {N}}(\psi ^{\mu ,\mu }_{\rm{seq}_{\rm err}},\psi ^{\mu ,\sigma }_{\rm{seq}_{\rm err}})$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{ln}(\sigma _{\rm{seq}_{\rm err}}) \sim {\mathcal {N}}(\psi ^{\sigma ,\mu }_{\rm{seq}_{\rm err}},\psi ^{\sigma ,\sigma }_{\rm{seq}_{\rm err}})$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\rm{seq}_{\rm err}} \sim {\mathcal {N}}(0,1),$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>such that <inline-formula id="IEq24"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{logit}(\text{seq}_{\rm err}) \sim {\mathcal {N}}(\mu _{\rm{seq}_{\rm err}},\sigma _{\rm{seq}_{\rm err}})$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq24.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{\rm{seq}_{\rm err}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq25.gif"/></alternatives></inline-formula> is the mean and <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{\rm{seq}_{\rm err}}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq26.gif"/></alternatives></inline-formula> is the standard deviation (<inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{seq}_{\rm err}}=-8$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{seq}_{\rm err}}=1.29$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1.29</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq28.gif"/></alternatives></inline-formula>, <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{seq}_{\rm err}}=0.4$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{seq}_{\rm err}}=0.5$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq30.gif"/></alternatives></inline-formula>).</p>
      <p id="Par17">The hyperparameter values above were used since they worked well in a previously published related work [<xref ref-type="bibr" rid="CR11">11</xref>] although we chose a lower <inline-formula id="IEq31"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{seq}_{\rm err}}$$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq31.gif"/></alternatives></inline-formula> since it generated more robust methylation estimates with mid-values of theta (i.e. 0.3 and 0.7). Other than that, to confirm that the results were not sensitive to hyperparameter values we tested different values ranging from low (<inline-formula id="IEq32"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{BS}_{\rm eff}}=1$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq32.gif"/></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{BS}_{\rm eff}}=1$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq33.gif"/></alternatives></inline-formula>, <inline-formula id="IEq34"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{BS}_{\rm eff}}=0.1$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq34.gif"/></alternatives></inline-formula>, <inline-formula id="IEq35"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{BS}_{\rm eff}}=0.1$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq35.gif"/></alternatives></inline-formula>, <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{seq}_{\rm err}}=-10$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{seq}_{\rm err}}=1$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq37.gif"/></alternatives></inline-formula>, <inline-formula id="IEq38"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{seq}_{\rm err}}=0.1$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq38.gif"/></alternatives></inline-formula> and <inline-formula id="IEq39"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{seq}_{\rm err}}=0.1$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq39.gif"/></alternatives></inline-formula>) to high (<inline-formula id="IEq40"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{BS}_{\rm eff}}=10$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{BS}_{\rm eff}}=10$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq41.gif"/></alternatives></inline-formula>, <inline-formula id="IEq42"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{BS}_{\rm eff}}=1$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq42.gif"/></alternatives></inline-formula>, <inline-formula id="IEq43"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{BS}_{\rm eff}}=1$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\mu }_{\rm{seq}_{\rm err}}=-1$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq44.gif"/></alternatives></inline-formula>, <inline-formula id="IEq45"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\mu ,\sigma }_{\rm{seq}_{\rm err}}=10$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\mu }_{\rm{seq}_{\rm err}}=1$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ^{\sigma ,\sigma }_{\rm{seq}_{\rm err}}=1$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq47.gif"/></alternatives></inline-formula>) hyperparameter values, relative to the values used in this paper, and indeed the methylation estimates were robust regardless of hyperparameter values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2).</p>
      <p id="Par18">The BS-seq experiments typically include completely unmethylated DNA fragments as controls (such as the lambda phage genome) that allow estimation of <inline-formula id="IEq48"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq49.gif"/></alternatives></inline-formula>. However, as BS-seq experiments typically do not include completely methylated DNA fragments as controls that would be needed to estimate the incorrect bisulfite conversion rate <inline-formula id="IEq50"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}$$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq50.gif"/></alternatives></inline-formula>, it is set to a constant value (e.g. <inline-formula id="IEq51"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}=0$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq51.gif"/></alternatives></inline-formula>, see Sections "<xref rid="Sec7" ref-type="sec">Estimating experimental parameters</xref>" and "<xref rid="Sec8" ref-type="sec">Estimating methylation levels</xref>" for specific values used in results). Note also that the bisulfite conversion rate and sequencing error parameters are specific for each biological samples and technical replicate.</p>
      <p id="Par19">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <inline-formula id="IEq52"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta ^{\text {control}}$$\end{document}</tex-math><mml:math id="M124"><mml:msup><mml:mi>θ</mml:mi><mml:mtext>control</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq52.gif"/></alternatives></inline-formula> represents the proportions of DNA methylation modifications in the control cytosine. In this case the proportion consists of unmethylated DNA, but this can be adjusted if additional DNA methylation modifications are included.</p>
      <p id="Par20">Following Eqs. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>, the observed total number of “C” readouts for a single control cytosine is binomially distributed,<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS,C}}^{\text {control}} \sim \text {Bin}(N_\text{BS}^{\text {control}},p_{\rm{BS}}\text{(``C'')}^{\text {control}}),$$\end{document}</tex-math><mml:math id="M126" display="block"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow><mml:mtext>control</mml:mtext></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext><mml:mtext>control</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:msup><mml:mtext>(``C'')</mml:mtext><mml:mtext>control</mml:mtext></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq53"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}^{\text {control}}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi></mml:mrow><mml:mtext>control</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq53.gif"/></alternatives></inline-formula> is the total number of reads and the probability of observing “C” is given by<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{\rm{BS}}(\text{``C''})^{\text {control}}&amp;= p_\text{BS}(\text{``C''} | \text{5mC})\theta ^{\text {control}} + p_\text{BS}(\text{``C''} | \text{C})(1-\theta ^{\text {control}}). \end{aligned}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>control</mml:mtext></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext>5mC</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mtext>control</mml:mtext></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mtext>control</mml:mtext></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>Using the sequencing read counts from the control cytosines <inline-formula id="IEq54"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS,C}}^{\text {control}}$$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow><mml:mtext>control</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}^{\text {control}}$$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi></mml:mrow><mml:mtext>control</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq55.gif"/></alternatives></inline-formula>, posterior distributions of unknowns in this model are obtained using the inference methods described in section "<xref rid="Sec5" ref-type="sec">Variational inference</xref>". Posterior means of <inline-formula id="IEq56"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq57.gif"/></alternatives></inline-formula> (and <inline-formula id="IEq58"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}$$\end{document}</tex-math><mml:math id="M140"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq58.gif"/></alternatives></inline-formula> if available) are then used in the actual methylation level analysis as described in the next section.</p>
    </sec>
    <sec id="Sec4">
      <title>Biological parameters</title>
      <p id="Par21">For computing the biological parameters, the observed total number of “C” readouts for a single noncontrol cytosine is similar to Eq.  <xref rid="Equ11" ref-type="">11</xref>, <inline-formula id="IEq59"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS,C}} \sim \text {Bin}(N_\text{BS},p_{\rm{BS}}\text{(``C'')})$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mtext>(``C'')</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq59.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq60"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq60.gif"/></alternatives></inline-formula> is the total number of reads and the probability of observing “C”, similar to Eq. <xref rid="Equ12" ref-type="">12</xref>, is given by<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\rm{BS}}(\text{``C''}) = p_\text{BS}(\text{``C''} | \text{5mC})\theta + p_\text{BS}(\text{``C''} | \text{C})(1-\theta )$$\end{document}</tex-math><mml:math id="M146" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext>5mC</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>``C''</mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq61"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta =p(\text{5mC})$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>5mC</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq61.gif"/></alternatives></inline-formula>.</p>
      <p id="Par22">LuxRep retains the general linear model with matrix normal distribution used by LuxGLM to handle covariates wherein matrix normal distribution is a generalisation of multivariate normal distribution to matrix-valued random variables. The following section summarizes the linear model (see [<xref ref-type="bibr" rid="CR11">11</xref>] for more details).</p>
      <p id="Par23">In the general linear model component of LuxGLM (Fig. <xref rid="Fig2" ref-type="fig">2</xref>)<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {Y}}={{\mathbf {D}}}{{\mathbf {B}}} + {\mathbf {E}},$$\end{document}</tex-math><mml:math id="M150" display="block"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq62"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {Y}} \in {\mathbb {R}}^{N \times 2}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq62.gif"/></alternatives></inline-formula> contains the unnormalized methylation fractions, <inline-formula id="IEq63"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {D}}$$\end{document}</tex-math><mml:math id="M154"><mml:mi mathvariant="bold">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq63.gif"/></alternatives></inline-formula> is the design matrix (size <italic>N</italic>-by-<italic>p</italic>, where <italic>p</italic> is the number of parameters), <inline-formula id="IEq64"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}} \in {\mathbb {R}}^{p \times 2}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq64.gif"/></alternatives></inline-formula> is the parameter matrix, and <inline-formula id="IEq65"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {E}} \in {\mathbb {R}}^{N \times 2}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq65.gif"/></alternatives></inline-formula> is the noise matrix.</p>
      <p id="Par24">To derive the (normalized) methylation proportions <inline-formula id="IEq66"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta } = (\theta _1,\ldots ,\theta _N)^T$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq66.gif"/></alternatives></inline-formula>, LuxGLM uses the softmax link function (or transformation)<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _i = \text{Softmax}(\text{row}_i({\mathbf {Y}})).$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Softmax</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>row</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>The softmax function is obtained when generalizing the logistic function to multiple dimensions. That is, the softmax function <inline-formula id="IEq67"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma : {\mathbb {R}}^K \rightarrow [0,1]^K$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>K</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq67.gif"/></alternatives></inline-formula> is defined by <inline-formula id="IEq68"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ({\mathbf {z}})_i =$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq68.gif"/></alternatives></inline-formula>
<inline-formula id="IEq69"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{e^{z_i}}{ \sum _{j=1}^{K} e^{z_j} }$$\end{document}</tex-math><mml:math id="M168"><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par25">In matrix normal distribution,<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}} \sim {{\mathcal {M}}}{{\mathcal {N}}}({\mathbf {M}},{\mathbf {U}},{\mathbf {V}})$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq70"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {M}}$$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="bold">M</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq70.gif"/></alternatives></inline-formula> is the location matrix and <inline-formula id="IEq71"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {U}}$$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="bold">U</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq71.gif"/></alternatives></inline-formula> and <inline-formula id="IEq72"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {V}}$$\end{document}</tex-math><mml:math id="M176"><mml:mi mathvariant="bold">V</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq72.gif"/></alternatives></inline-formula> are scale matrices. Alternatively, <inline-formula id="IEq73"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}$$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq73.gif"/></alternatives></inline-formula> (in Eq.  <xref rid="Equ16" ref-type="">16</xref>) can also be written as the multivariate normal distribution<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{vec}({\mathbf {X}}) \sim {\mathcal {N}}(\text{vec}({\mathbf {M}}),{\mathbf {U}} \otimes {\mathbf {V}}),$$\end{document}</tex-math><mml:math id="M180" display="block"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq74"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{vec}(\cdot )$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq74.gif"/></alternatives></inline-formula> denotes vectorization of a matrix and <inline-formula id="IEq75"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\otimes$$\end{document}</tex-math><mml:math id="M184"><mml:mo>⊗</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq75.gif"/></alternatives></inline-formula> denotes the Kronecker product.</p>
      <p id="Par26">Given Eq. <xref rid="Equ14" ref-type="">14</xref>, <inline-formula id="IEq76"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}}$$\end{document}</tex-math><mml:math id="M186"><mml:mi mathvariant="bold">B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {E}}$$\end{document}</tex-math><mml:math id="M188"><mml:mi mathvariant="bold">E</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq77.gif"/></alternatives></inline-formula> take on the following prior distributions<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {E}}|\mathbf {U_E},\mathbf {V_E} \sim {{\mathcal {M}}}{{\mathcal {N}}}({\mathbf {0}}, \mathbf {U_E}, \mathbf {V_E})$$\end{document}</tex-math><mml:math id="M190" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}}|\mathbf {M_B}, \mathbf {U_B}, \mathbf {V_B} \sim {{\mathcal {M}}}{{\mathcal {N}}}(\mathbf {M_B}, \mathbf {U_B}, \mathbf {V_B}).$$\end{document}</tex-math><mml:math id="M192" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>Using the vectorized multivariate normal distribution formulation of the matrix normal distribution, matrix <inline-formula id="IEq78"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {Y}}$$\end{document}</tex-math><mml:math id="M194"><mml:mi mathvariant="bold">Y</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq78.gif"/></alternatives></inline-formula> then becomes<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp;\text{vec}({\mathbf {Y}})|{\mathbf {D}}, {\mathbf {M_B}}, {\mathbf {U_B}}, {\mathbf {V_B}}, {\mathbf {U_E}}, {\mathbf {V_E}} \sim {\mathcal {N}}(({\mathbf {I}} \otimes {\mathbf {D}}) \text{vec} ({\mathbf {M_B}}), \\&amp;({\mathbf {I}} \otimes {\mathbf {D}})({\mathbf {V_B}} \otimes {\mathbf {U_B}})({\mathbf {I}} \otimes {\mathbf {D}})^{\mathbf {T}} + {\mathbf {V_E}} \otimes {\mathbf {U_E}}). \end{aligned}$$\end{document}</tex-math><mml:math id="M196" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>vec</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>Assuming the scale matrices <inline-formula id="IEq79"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {U_B}}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq79.gif"/></alternatives></inline-formula>, <inline-formula id="IEq80"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {V_B}}$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq80.gif"/></alternatives></inline-formula>, <inline-formula id="IEq81"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {U_E}}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {V_E}}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi mathvariant="bold">E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq82.gif"/></alternatives></inline-formula> are all diagonal with parameter and noise specific variances <inline-formula id="IEq83"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^\text{2}_{\mathbf {B}}$$\end{document}</tex-math><mml:math id="M206"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^\text{2}_{\mathbf {E}}$$\end{document}</tex-math><mml:math id="M208"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">E</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq84.gif"/></alternatives></inline-formula>, probability densities for <inline-formula id="IEq85"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}}$$\end{document}</tex-math><mml:math id="M210"><mml:mi mathvariant="bold">B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq85.gif"/></alternatives></inline-formula>, <inline-formula id="IEq86"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {E}}$$\end{document}</tex-math><mml:math id="M212"><mml:mi mathvariant="bold">E</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq86.gif"/></alternatives></inline-formula> and <inline-formula id="IEq87"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {Y}}$$\end{document}</tex-math><mml:math id="M214"><mml:mi mathvariant="bold">Y</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq87.gif"/></alternatives></inline-formula> can be stated as<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{vec} ({\mathbf {B}}) \sim \ {\mathcal {N}}(\text{vec}({\mathbf {0}}), \sigma ^\text{2}_{\mathbf {B}}({\mathbf {I}} \otimes {\mathbf {I}}))$$\end{document}</tex-math><mml:math id="M216" display="block"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mspace width="4pt"/><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{vec} ({\mathbf {E}}) \sim \ {\mathcal {N}}(\text{vec}({\mathbf {0}}), \sigma ^\text{2}_{\mathbf {E}}({\mathbf {I}} \otimes {\mathbf {I}}))$$\end{document}</tex-math><mml:math id="M218" display="block"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mspace width="4pt"/><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">E</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\text{vec}({\mathbf {Y}})|{\mathbf {D}},\sigma ^\text{2}_{\mathbf {B}}, \sigma ^\text{2}_{\mathbf {E}} \sim \ {\mathcal {N}}(\text{vec}({\mathbf {0}}), \nonumber \\&amp;\sigma ^\text{2}_{\mathbf {B}} ({\mathbf {I}} \otimes {\mathbf {D}})({\mathbf {I}} \otimes {\mathbf {I}}) ({\mathbf {I}} \otimes {\mathbf {D}})^{\mathbf {T}} + \sigma ^\text{2}_{\mathbf {E}}({\mathbf {I}} \otimes {\mathbf {I}})). \end{aligned}$$\end{document}</tex-math><mml:math id="M220" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">E</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mrow><mml:mo>∼</mml:mo><mml:mspace width="4pt"/><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">E</mml:mi><mml:mtext>2</mml:mtext></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig4"><label>Fig. 4</label><caption><p>Parameter estimates of <inline-formula id="IEq88"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq88.gif"/></alternatives></inline-formula> and <inline-formula id="IEq89"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq89.gif"/></alternatives></inline-formula>. The x-axis shows whether the samples were drawn from ‘G’ (good quality) or ‘B’ (bad/low quality) technical replicates corresponding to <inline-formula id="IEq90"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}^B$$\end{document}</tex-math><mml:math id="M226"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}^G$$\end{document}</tex-math><mml:math id="M228"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq91.gif"/></alternatives></inline-formula>, respectively, and grouped according to the two scenarios, discussed in section "<xref rid="Sec8" ref-type="sec">Estimating methylation levels</xref>", ‘GGB’ and ‘GBB’. Low and high coverage refer to <inline-formula id="IEq92"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}} = 1 \dotsc 3$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq92.gif"/></alternatives></inline-formula> and <inline-formula id="IEq93"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}} = 10$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq93.gif"/></alternatives></inline-formula>, respectively</p></caption><graphic xlink:href="12859_2021_4546_Fig4_HTML" id="MO27"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Plate diagram of LuxRep model for simulating data for estimating methylation level</p></caption><graphic xlink:href="12859_2021_4546_Fig5_HTML" id="MO28"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Plate diagram of the reduced LuxRep model that mimics the traditional approach of not accounting for experimental parameters</p></caption><graphic xlink:href="12859_2021_4546_Fig6_HTML" id="MO29"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Boxplots of estimates of methylation levels. Datasets were analysed with the full and reduced LuxRep models with varying methylation levels (columns, values shown at topmost panel), varying number of reads (rows, values shown on right panel), different combinations of replicates with varying <inline-formula id="IEq94"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq94.gif"/></alternatives></inline-formula> (‘G’ and ‘B’) (x-axis), and using either HMC or ADVI to evaluate or approximate the posterior, respectively. The boxplots show the posterior means (<inline-formula id="IEq95"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=100$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq95.gif"/></alternatives></inline-formula>)</p></caption><graphic xlink:href="12859_2021_4546_Fig7_HTML" id="MO30"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Plate diagram of model for generating dummy data for differential methylation analysis</p></caption><graphic xlink:href="12859_2021_4546_Fig8_HTML" id="MO31"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>AUROCs of differential methylation calls. Accuracy in determining differential methylation was measured by generating datasets consisting of two groups (A and B) with varying <inline-formula id="IEq96"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq96.gif"/></alternatives></inline-formula> (<inline-formula id="IEq97"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _A$$\end{document}</tex-math><mml:math id="M240"><mml:msub><mml:mi>θ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _B$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>θ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq98.gif"/></alternatives></inline-formula> levels are shown in top panels and when one or two of three replicates have low <inline-formula id="IEq99"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq99.gif"/></alternatives></inline-formula> (‘GGB’ and ‘GBB’, respectively.) For ‘GBB’ (top box) and ‘GGB’ (bottom box) <inline-formula id="IEq100"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}} = 10$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq100.gif"/></alternatives></inline-formula> and <inline-formula id="IEq101"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}} = 6$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq101.gif"/></alternatives></inline-formula>, respectively, for each technical replicate. X-axis shows whether HMC or ADVI was used to evaluate or approximate the posteriors</p></caption><graphic xlink:href="12859_2021_4546_Fig9_HTML" id="MO32"/></fig></p>
      <p id="Par27">Variance <inline-formula id="IEq102"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_{\mathbf {B}} = 5$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq102.gif"/></alternatives></inline-formula> and <inline-formula id="IEq103"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2_{\mathbf {E}} \sim \Gamma ^{-1}(\alpha ,\beta )$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="bold">E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:msup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq103.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq104"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \beta = 1$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq104.gif"/></alternatives></inline-formula>, are used in this work. We chose to use the hyperparameter value <inline-formula id="IEq105"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B^2=5$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq105.gif"/></alternatives></inline-formula> because that seems to be widely applicable and provides robust inference results. To confirm that the results are not sensitive to the particular choice of <inline-formula id="IEq106"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B^2$$\end{document}</tex-math><mml:math id="M258"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq106.gif"/></alternatives></inline-formula> value, we carried out an ablation study where we repeated the methylation level estimation experiment (from Fig. <xref rid="Fig7" ref-type="fig">7</xref>) with three different values of <inline-formula id="IEq107"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B^2$$\end{document}</tex-math><mml:math id="M260"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq107.gif"/></alternatives></inline-formula>: 1, 5, and 10. Our results in Fig. S3 confirm that the results have very little or no variation depending on the choice of <inline-formula id="IEq108"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B^2$$\end{document}</tex-math><mml:math id="M262"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq108.gif"/></alternatives></inline-formula> value.</p>
      <p id="Par28">The inverse gamma distribution was used as prior for <inline-formula id="IEq109"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _E^2$$\end{document}</tex-math><mml:math id="M264"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq109.gif"/></alternatives></inline-formula> since (with the alpha and beta hyperparameters used) it is uninformative and makes no strong assumptions with regards to the spread of the noise term. Also, the inverse gamma distribution is a conjugate prior to a normal distribution with known mean <inline-formula id="IEq110"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M266"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq110.gif"/></alternatives></inline-formula> and unknown variance <inline-formula id="IEq111"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M268"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq111.gif"/></alternatives></inline-formula>.</p>
      <p id="Par29">We extend the model to allow modelling of technical replicates wherein the methylation level <inline-formula id="IEq112"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M270"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq112.gif"/></alternatives></inline-formula> is the same for all different bisulfite-converted DNA libraries from the same biological sample but the experimental parameters (<inline-formula id="IEq113"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq114.gif"/></alternatives></inline-formula>) vary across both the biological replicates as well as the technical replicates.</p>
      <p id="Par30">In the modified model (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>), <inline-formula id="IEq115"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS,C}}$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">BS</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq115.gif"/></alternatives></inline-formula> and <inline-formula id="IEq116"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq116.gif"/></alternatives></inline-formula> represent the observed “C” and total counts, respectively, from each of the <inline-formula id="IEq117"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_i$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq117.gif"/></alternatives></inline-formula> technical replicates per biological sample <inline-formula id="IEq118"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left\{ 1,..,N\right\}$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq118.gif"/></alternatives></inline-formula>. Note that the experimental parameters <inline-formula id="IEq119"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq119.gif"/></alternatives></inline-formula> and <inline-formula id="IEq120"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq120.gif"/></alternatives></inline-formula>, taken from the posterior means, are sample and replicate-specific.</p>
      <p id="Par31">To detect differential methylation, hypothesis testing was done using Bayes factors (via the Savage-Dickey density ratio method) as implemented in [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Variational inference</title>
      <p id="Par32">[<xref ref-type="bibr" rid="CR11">11</xref>] used Hamiltonian Monte Carlo (HMC) for model inference (since the model is analytically intractable), whereas in variational inference (VI) the posterior <inline-formula id="IEq121"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(\phi |\mathbf{X} )$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq121.gif"/></alternatives></inline-formula> of a model is approximated with a simpler distribution <inline-formula id="IEq122"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(\phi ;\rho )$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq122.gif"/></alternatives></inline-formula>, which is selected from a chosen family of distributions by minimizing Kullback-Leibler divergence between <inline-formula id="IEq123"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(\phi |\mathbf{X} )$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq123.gif"/></alternatives></inline-formula> and <inline-formula id="IEq124"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(\phi ;\rho )$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq124.gif"/></alternatives></inline-formula>. We use the automatic differentiation variational inference algorithm (ADVI) from [<xref ref-type="bibr" rid="CR14">14</xref>], which is integrated into Stan. ADVI is used to generate samples from the approximative posterior <inline-formula id="IEq125"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(\phi ;\rho )$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq125.gif"/></alternatives></inline-formula>.</p>
      <p id="Par33">There are a few parameters which can be tuned to make the ADVI algorithm [<xref ref-type="bibr" rid="CR14">14</xref>] fast but accurate. These parameters are number samples used in Monte Carlo integration approximation of expectation lower bound (ELBO), number of samples used in Monte Carlo integration approximation of the gradients of the ELBO and number of samples taken from the approximative posterior distribution. The default values for gradient samples <inline-formula id="IEq126"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_G$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>N</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq126.gif"/></alternatives></inline-formula> and ELBO samples <inline-formula id="IEq127"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_E$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq127.gif"/></alternatives></inline-formula> are 100 and 1 respectively. Here we compare the computation times and preciseness of the Savage-Dickey estimate computed using HMC and ADVI with different <inline-formula id="IEq128"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_E$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_G$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>N</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq129.gif"/></alternatives></inline-formula> values. The tested values for <inline-formula id="IEq130"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_E$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq130.gif"/></alternatives></inline-formula> were 100, 200, 500 and 1000 and for <inline-formula id="IEq131"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_G$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mi>N</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq131.gif"/></alternatives></inline-formula> 1, 10 and 100. To make the HMC and ADVI methods comparable, the number of samples retrieved from the approximative posterior distribution is set to be the same for both methods.</p>
      <p id="Par34">To choose the best number of gradient samples and ELBO samples, simulation tests on LuxGLM model were executed. These tests were conducted in the following way: First, simulated data from the LuxGLM model was generated. The number of reads and replicates were varied (the tested values were 6, 12, 24 and 6, 10, 20 respectively) and for each combination data sets with differential methylation and without differential methylation were generated. The calculation of the Bayes factors was made using different <inline-formula id="IEq132"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_E$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq132.gif"/></alternatives></inline-formula> and <inline-formula id="IEq133"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_G$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>N</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq133.gif"/></alternatives></inline-formula> values. For each setting 100 data sets were simulated and Bayes factors were calculated. Using the computed Bayes factors, ROC curves and AUROC statistics were produced. Also, the computation times for each parameter value combination were taken down. The results of these tests for the case of 12 reads and 10 replicates are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S4 and S5.</p>
      <p id="Par35">In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4 the computation times for different parameter values are shown. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5 the computation time was plotted as a function of accuracy of the method when compared to the HMC approach. The average computation time for the HMC method is plotted in red. From the figures we can see that with the all tested parameter combinations the computing Savage-Dickey estimate with ADVI is faster than with HMC. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5, on the left side of the dashed line are the parameter combinations which gave better precision than HMC approach.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <sec id="Sec7">
      <title>Estimating experimental parameters</title>
      <p id="Par36">Samples prepared for BS-seq are typically spiked-in with unmethylated control DNA (often Lambda phage genome) that allows estimation of bisulfite conversion efficiency <inline-formula id="IEq134"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq134.gif"/></alternatives></inline-formula>. For demonstration purposes, dummy control cytosine data were generated using the model illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Based on a cursory examination of an actual dataset generated from spiked-in Lambda phage DNA (data not shown), bisulfite sequencing data for 444 control cytosine were simulated with number of reads per cytosine <inline-formula id="IEq135"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\text{BS} \in \{1, \dots ,3\}$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq135.gif"/></alternatives></inline-formula>. For comparison, another set-up was generated with coverage <inline-formula id="IEq136"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_\text{BS}=10$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq136.gif"/></alternatives></inline-formula>. Experimental parameters were set to fixed values while the methylation modification fractions <inline-formula id="IEq137"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta ^{\text{control}}$$\end{document}</tex-math><mml:math id="M320"><mml:msup><mml:mi>θ</mml:mi><mml:mtext>control</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq137.gif"/></alternatives></inline-formula> were drawn from <inline-formula id="IEq138"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Dir}(\alpha )$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mtext>Dir</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq138.gif"/></alternatives></inline-formula> (parameters listed below).<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \alpha _\text{control}&amp;= (999,1) \\ \text{BS}^*_{\rm eff}&amp;= 0.001\\ \text{seq}_{\rm err}&amp;= 0.001\\ \text{BS}_{\rm eff}&amp;\in \{0.995,0.9\}\\ K_\text{control}&amp;= 444\\ N_\text{BS}&amp;\in \{1 \dots 3, 10\}\\ \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M324" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>α</mml:mi><mml:mtext>control</mml:mtext></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>999</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0.995</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>K</mml:mi><mml:mtext>control</mml:mtext></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>444</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>The choice to use 90% as the low bisulfite conversion efficiency is based on Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 which shows low conversion efficiencies to be around 90%. To test our method also with a lower conversion efficiency (&lt;90%) we added the conversion efficiency 85% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). As the plots show, the full model generates more accurate median on average than the reduced model also at 85% conversion efficiency.</p>
      <p id="Par37">Sequencing error and bisulfite conversion rates were estimated using the model illustrated in the plate diagram in Fig. <xref rid="Fig1" ref-type="fig">1</xref> based on the dummy control cytosine data. Incorrect bisulfite conversion rate, <inline-formula id="IEq139"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}$$\end{document}</tex-math><mml:math id="M326"><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq139.gif"/></alternatives></inline-formula>, was set to a fixed value (0.1%) (in LuxGLM it was estimated from control data) because genome scale bisulfite sequencing typically do not include methylated cytosine control data. The data consists of <italic>N</italic> biological samples (<inline-formula id="IEq140"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1,\ldots ,N\}$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq140.gif"/></alternatives></inline-formula>), each of which has <inline-formula id="IEq141"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_i$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq141.gif"/></alternatives></inline-formula> technical replicates corresponding to different bisulfite-converted DNA library preparations. The LuxGLM model [<xref ref-type="bibr" rid="CR11">11</xref>] was modified to determine experimental parameters for each technical replicate separately (shown as the “replicates” plate in the diagram in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The circles represent latent (white) and observed (gray) variables and the squares/unbordered nodes represent fixed values (for parameters and hyperparameters).</p>
      <p id="Par38">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the estimates for the experimental parameters. LuxRep generated good estimates for <inline-formula id="IEq142"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq143.gif"/></alternatives></inline-formula>, particularly with technical replicates that had high <inline-formula id="IEq144"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq144.gif"/></alternatives></inline-formula> (99.5%), even with extremely low coverage (<inline-formula id="IEq145"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{BS}=1 \dotsc 3$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">BS</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq145.gif"/></alternatives></inline-formula>). Technical replicates with higher coverage (<inline-formula id="IEq146"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{BS}=10$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">BS</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq146.gif"/></alternatives></inline-formula>), though, were more accurate in terms of median closer to the actual values and lower variance.</p>
    </sec>
    <sec id="Sec8">
      <title>Estimating methylation levels</title>
      <p id="Par39">For estimating methylation levels and analyzing differential methylation, we first simulated technical replicates with low (<inline-formula id="IEq147"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}^B \sim \text{beta}(90,10)$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>90</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq147.gif"/></alternatives></inline-formula>) and high (<inline-formula id="IEq148"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}^G \sim \text{beta}(99.5,0.5)$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>99.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq148.gif"/></alternatives></inline-formula>) BS conversion rates with varying sequencing depth <inline-formula id="IEq149"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq149.gif"/></alternatives></inline-formula> and methylation level (<inline-formula id="IEq150"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \in [0.1,0.9]$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq150.gif"/></alternatives></inline-formula>). The datasets were generated following the model illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref> with methylation levels and experimental parameters generated following the beta distribution with parameters set to values listed below.<disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\text{BS}_{\rm eff}^B \sim \text{beta}(90,10)\\&amp;\text{BS}_{\rm eff}^G \sim \text{beta}(99.5,0.5)\\&amp;\text{seq}_{\rm err} \sim \text{beta}(0.1,99.9)\\&amp;\text{BS}^*_{\rm eff} \sim \text{beta}(0.1,99.9)\\&amp;N_\text{BS} \in \{6,12,24\}\\&amp;K_\text{cytosine}=4\\&amp;\theta _1 \sim \text{beta}(100,900)\\&amp;\theta _2 \sim \text{beta}(300,700)\\&amp;\theta _3 \sim \text{beta}(700,300)\\&amp;\theta _4 \sim \text{beta}(900,100)\\&amp;N^\text{control}_\text{BS}=20\\&amp;K^\text{control}_\text{cytosine}=100\\&amp;\theta ^\text{control} \sim \text{Dir}(999,1)\\ \end{aligned}$$\end{document}</tex-math><mml:math id="M350" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>90</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>99.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>99.9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>99.9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>24</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>cytosine</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>900</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>300</mml:mn><mml:mo>,</mml:mo><mml:mn>700</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>700</mml:mn><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mtext>beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>900</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext><mml:mtext>control</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mtext>cytosine</mml:mtext><mml:mtext>control</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mtext>control</mml:mtext></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Dir</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>999</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4546_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>where the Dirichlet distribution is denoted by Dir(<inline-formula id="IEq151"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot$$\end{document}</tex-math><mml:math id="M352"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq151.gif"/></alternatives></inline-formula>).</p>
      <p id="Par40">Two scenarios were simulated consisting of three technical replicates each: (i) two replicates with high <inline-formula id="IEq152"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq152.gif"/></alternatives></inline-formula> (i.e. good samples, ‘G’) and one with low <inline-formula id="IEq153"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq153.gif"/></alternatives></inline-formula> (i.e. bad sample, ‘B’)(‘GGB’), and (ii) one ‘G’ replicate and two ‘B’ replicates (‘GBB’). Each scenario was analyzed using (i) the <italic>full</italic> LuxRep model (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) and (ii) a <italic>reduced</italic> model with experimental parameters fixed to <inline-formula id="IEq154"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}=1$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq154.gif"/></alternatives></inline-formula>, <inline-formula id="IEq155"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{seq}_{\rm err}=0$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:msub><mml:mtext>seq</mml:mtext><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}^*_{\rm eff}=0$$\end{document}</tex-math><mml:math id="M362"><mml:mrow><mml:msubsup><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq156.gif"/></alternatives></inline-formula>, and using the “C” and “T” counts from only the ‘G’ samples (those with <inline-formula id="IEq157"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}=99.5\%$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>99.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq157.gif"/></alternatives></inline-formula> and above) to simulate the traditional approach of not accounting for experimental parameters (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Results from estimating the models with HMC and ADVI were also compared.</p>
      <p id="Par41">Datasets (<inline-formula id="IEq158"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=100$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq158.gif"/></alternatives></inline-formula>) were analysed with the full and reduced LuxRep models with varying methylation levels, varying number of reads, different combinations of replicates with varying <inline-formula id="IEq159"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq159.gif"/></alternatives></inline-formula> (‘G’ and ‘B’), and using either HMC or ADVI to evaluate or approximate the posterior, respectively (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). For each simulated data set we estimated the methylation level <inline-formula id="IEq160"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M370"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq160.gif"/></alternatives></inline-formula> using the posterior mean of samples (<inline-formula id="IEq161"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=1000$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq161.gif"/></alternatives></inline-formula>) drawn from the posterior (HMC) and approximate posterior (ADVI) distribution.</p>
      <p id="Par42">The variance of the estimates using the full model was generally lower compared to the reduced model across <inline-formula id="IEq162"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M374"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq162.gif"/></alternatives></inline-formula> and <inline-formula id="IEq163"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm {BS}}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq163.gif"/></alternatives></inline-formula> values (Fig. <xref rid="Fig7" ref-type="fig">7</xref>) demonstrating the utility of using LuxRep with replicates of varying <inline-formula id="IEq164"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq164.gif"/></alternatives></inline-formula>. The decrease in variance was generally greater with the second scenario (‘GBB’), highlighting the capability of LuxRep to make use of samples with low <inline-formula id="IEq165"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq165.gif"/></alternatives></inline-formula>. Improvements in the estimates were comparable when using HMC and ADVI. Notable also is the comparable accuracy between the two scenarios ‘GGB’ and ‘GBB’, i.e. ‘GBB’ was relatively as accurate as ‘GGB’ even though it had more replicates with low <inline-formula id="IEq166"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq166.gif"/></alternatives></inline-formula>.</p>
      <p id="Par43">To more directly address the question of whether the full model significantly improves accuracy compared with traditional methods we performed methylation estimation using the full and reduced (representing traditional methods) methods with varying bisulfite conversion rates, including all samples for both the full and reduced models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). Lower bisulfite conversion rates (85% and 90%) generated greater differences in estimates with the full model generally showing a more accurate median, specially with <inline-formula id="IEq167"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M384"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq167.gif"/></alternatives></inline-formula> values of 0.3 and 0.7. The median were generally similar with higher bisulfite conversion rates. In terms of variance, the differences varied according to methylation level and bisulfite conversion rate (e.g. the variance of the full model was generally slightly higher with <inline-formula id="IEq168"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M386"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq168.gif"/></alternatives></inline-formula> values of 0.1 and 0.3, whereas the variance of the reduced model was generally higher with theta 0.9).</p>
      <p id="Par44">Since most genomic regions tend to be unmethylated we queried the estimates when the actual methylation level approaches zero (<inline-formula id="IEq169"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta = 0.1$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq169.gif"/></alternatives></inline-formula>). As shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6, at low methylation levels (e.g. 0.1), the median is below the actual value, that is the methylation levels tend to be underestimated. It follows that for genomic regions that are unmethylated it is unlikely that the method will erroneously estimate a higher methylation level.</p>
      <p id="Par45">To test the utility of LuxRep on an actual bisulfite sequencing dataset, methylation levels were estimated from an RRBS dataset [<xref ref-type="bibr" rid="CR12">12</xref>] consisting of two individuals and three replicates each (two low and one high <inline-formula id="IEq170"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq170.gif"/></alternatives></inline-formula>, individual 1: 96.38%, 99.32% and 99.96%; individual 2: 94.59%, 98.67% and 99.98%). The replicate with high <inline-formula id="IEq171"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq171.gif"/></alternatives></inline-formula> was analyzed with the full model while the two low <inline-formula id="IEq172"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M394"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq172.gif"/></alternatives></inline-formula> replicates were analyzed with both the full and reduced models. The difference in the estimated methylation levels (1000 CpG sites) between the high <inline-formula id="IEq173"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq173.gif"/></alternatives></inline-formula> replicate and the low <inline-formula id="IEq174"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M398"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq174.gif"/></alternatives></inline-formula> replicates using the full and reduced models were measured by taking their Euclidean distance which showed greater similarity when using the full model (individual 1: reduced: 2.29, full: 2.23; individual 2: reduced: 2.55, full: 2.49).</p>
    </sec>
    <sec id="Sec9">
      <title>Detecting differential methylation</title>
      <p id="Par46">Accuracy in determining differential methylation was measured by generating datasets consisting of two groups (A and B) with varying methylation level difference <inline-formula id="IEq175"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq175.gif"/></alternatives></inline-formula> between the two groups and when one or two of three replicates have low <inline-formula id="IEq176"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq176.gif"/></alternatives></inline-formula> (‘GGB’ and ‘GBB’, respectively). Each group consisted of four biological replicates wherein each biological replicate had three technical replicates each (with different sequencing read coverage, <inline-formula id="IEq177"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}=10$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq177.gif"/></alternatives></inline-formula> or <inline-formula id="IEq178"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}=6$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq178.gif"/></alternatives></inline-formula>; the standard threshold for total sequencing read coverage is <inline-formula id="IEq179"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\rm{BS}}=10$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">BS</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq179.gif"/></alternatives></inline-formula>). The model for generating simulated data is described in Fig. <xref rid="Fig8" ref-type="fig">8</xref> (where <inline-formula id="IEq180"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \sim \text{Beta}(\alpha _\theta ,\beta _\theta )$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq180.gif"/></alternatives></inline-formula>, with parameters shown in Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p><inline-formula id="IEq181"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\theta }}$$\end{document}</tex-math><mml:math id="M412"><mml:mover><mml:mi>θ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq181.gif"/></alternatives></inline-formula> parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><inline-formula id="IEq182"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\theta }}$$\end{document}</tex-math><mml:math id="M414"><mml:mover><mml:mi>θ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq182.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq183"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _\theta$$\end{document}</tex-math><mml:math id="M416"><mml:msub><mml:mi>α</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq183.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq184"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _\theta$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>β</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq184.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">0.2</td><td align="left">200</td><td align="left">800</td></tr><tr><td align="left">0.3</td><td align="left">300</td><td align="left">700</td></tr><tr><td align="left">0.4</td><td align="left">400</td><td align="left">600</td></tr><tr><td align="left">0.5</td><td align="left">500</td><td align="left">500</td></tr><tr><td align="left">0.6</td><td align="left">600</td><td align="left">400</td></tr><tr><td align="left">0.7</td><td align="left">700</td><td align="left">300</td></tr><tr><td align="left">0.8</td><td align="left">800</td><td align="left">200</td></tr></tbody></table></table-wrap></p>
      <p id="Par47">Differential methylation was analysed using the full and reduced LuxRep models (see Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig6" ref-type="fig">6</xref>, respectively, and, for additional details of hyperpriors used, [<xref ref-type="bibr" rid="CR11">11</xref>]), evaluated with HMC and ADVI. Eq. <xref rid="Equ26" ref-type="">26</xref> shows the design matrix <inline-formula id="IEq185"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {D}}$$\end{document}</tex-math><mml:math id="M420"><mml:mi mathvariant="bold">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq185.gif"/></alternatives></inline-formula> and parameter matrix <inline-formula id="IEq186"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}}$$\end{document}</tex-math><mml:math id="M422"><mml:mi mathvariant="bold">B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq186.gif"/></alternatives></inline-formula> used in the general linear model component (Bayes factors were computed using the Savage-Dickey density ratio estimator using samples of <inline-formula id="IEq187"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_\text{2,1}$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi>b</mml:mi><mml:mtext>2,1</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq187.gif"/></alternatives></inline-formula> and <inline-formula id="IEq188"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_\text{2,2}$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>b</mml:mi><mml:mtext>2,2</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq188.gif"/></alternatives></inline-formula>, <inline-formula id="IEq189"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=1600$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1600</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=1000$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq190.gif"/></alternatives></inline-formula> from the posterior distributions approximated with HMC and ADVI, respectively).<disp-formula id="Equ26"><label>26</label><graphic xlink:href="12859_2021_4546_Equ26_HTML.gif" position="anchor"/></disp-formula>AUROCs were calculated based on <inline-formula id="IEq191"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M432"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq191.gif"/></alternatives></inline-formula>
<inline-formula id="IEq192"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$200$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq192.gif"/></alternatives></inline-formula> positive (<inline-formula id="IEq193"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta \ne 0$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq193.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq194"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M438"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq194.gif"/></alternatives></inline-formula>
<inline-formula id="IEq195"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$200$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq195.gif"/></alternatives></inline-formula> negative (<inline-formula id="IEq196"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta =0$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq196.gif"/></alternatives></inline-formula>) samples (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). The full model consistently generated higher AUROCs compared to the reduced model, moreso with the ‘GBB’ subsets, showing that LuxRep is able to utilize DNA libraries with low <inline-formula id="IEq197"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BS}_{\rm eff}$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mtext>BS</mml:mtext><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq197.gif"/></alternatives></inline-formula> to improve differential methylation analysis.<fig id="Fig10"><label>Fig. 10</label><caption><p>Select ROC curves of differential methylation calls generated from the full and reduced models (with technical replicates ‘GBB’ and ‘G’, respectively) where <inline-formula id="IEq198"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _\text{A}=0.2$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq198.gif"/></alternatives></inline-formula> and <inline-formula id="IEq199"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _\text{B}$$\end{document}</tex-math><mml:math id="M448"><mml:msub><mml:mi>θ</mml:mi><mml:mtext>B</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq199.gif"/></alternatives></inline-formula> was set to 0.3, 0.4 and 0.5 (top, middle and bottom panels, respectively). Samples were generated from the approximated posterior using variational inference</p></caption><graphic xlink:href="12859_2021_4546_Fig10_HTML" id="MO36"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>Comparison of running times using HMC and ADVI for model evaluation</p></caption><graphic xlink:href="12859_2021_4546_Fig11_HTML" id="MO37"/></fig></p>
      <p id="Par48">Select ROC curves generated from the full and reduced models show notable increase in AUROCs when using the full over the reduced model (Fig. <xref rid="Fig10" ref-type="fig">10</xref>). Moreover, the difference in AUROCs increases with decreasing <inline-formula id="IEq200"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \theta$$\end{document}</tex-math><mml:math id="M450"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq200.gif"/></alternatives></inline-formula>.</p>
      <p id="Par49">In addition to AUROC, to provide empirical statistical power, we calculated the true positive rates for differential methylation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). True positive rates were generally higher in the full model compared to the reduced model, as expected.</p>
    </sec>
    <sec id="Sec10">
      <title>Comparing running times</title>
      <p id="Par50">Running times were measured using the Stan [<xref ref-type="bibr" rid="CR15">15</xref>] time records and by a Python function, and with or without the additional time required for post-processing the output files (i.e. parsing relevant information), with varying number of reads (Fig.<xref rid="Fig11" ref-type="fig">11</xref>). The computations were performed using a computing cluster; a single core with 2GB memory was used for ADVI approximation (HMC sampling could be more efficiently run with one core for each MCMC chain hence run time was based on the slowest chain). Significant reduction in running times were observed with using ADVI over HMC.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par51">LuxRep tool described in this paper allows technical replicates with varying bisulfite conversion efficiency to be included in the analysis. LuxRep improves the accuracy of methylation level estimates and differential methylation analysis and lowers running time of model-based DNA methylation analysis by using ADVI.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4546_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Additional figures containing: (<bold>i</bold>) Demonstrating differences in technical parameters, (<bold>ii</bold>) Testing different hyperparameters for sequencing error and bisulfite conversion rates, (<bold>iii</bold>) Testing different <inline-formula id="IEq201"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma_B^2$$\end{document}</tex-math><mml:math id="M452"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4546_Article_IEq201.gif"/></alternatives></inline-formula> for methylation level estimation, (<bold>iv</bold>) Choosing parameters for variational inference, (<bold>v</bold>) Comparing full and reduced models in methylation level estimation, and (<bold>vi</bold>) True positive rates of differential methylation.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ADVI</term>
        <def>
          <p id="Par4">Automatic differentiation variational inference</p>
        </def>
      </def-item>
      <def-item>
        <term>BS-seq</term>
        <def>
          <p id="Par5">Bisulfite sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-021-04546-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the computational resources provided by the Aalto Science-IT project and the Finnish Functional Genomics Centre and Biocenter Finland.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>MM developed the package, VH contributed to the computational analysis. RL and MK performed lab experiments. MM, VH and HL wrote the manuscript. All authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Academy of Finland (292660, 311584, 335436). The funding body played no role in the design of the study, the collection, analysis, interpretation of data, or in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LuxRep is open source and freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/tare/LuxGLM/tree/master/LuxRep">https://github.com/tare/LuxGLM/tree/master/LuxRep</ext-link>. Datasets that support the findings of this study are available in [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par52">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent to publish</title>
      <p id="Par53">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par54">The authors declare that they have no competing interests.</p>
    </notes>
    <notes id="FPar5">
      <title>Availability and requirements</title>
      <p id="Par55">Project name: LuxRep. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/tare/LuxGLM/tree/master/LuxRep">https://github.com/tare/LuxGLM/tree/master/LuxRep</ext-link>. Operating system(s): Mac OSX and Linux. Programming language: Python, CmdStan, pystan, Numpy, Scipy. Other requirements: CmdStan (tested on version 2.18.0), Python (tested on version 3.7.5), pystan (tested on version 2.17.1.0), Numpy (tested on version 1.20.2), Scipy (tested on version 1.1.0). LuxRep is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tare/LuxGLM/tree/master/LuxRep">https://github.com/tare/LuxGLM/tree/master/LuxRep</ext-link> along with documentation. License: MIT License Any restrictions to use by non-academics: Not applicable.
</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frommer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Millar</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Collis</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Grigg</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Molloy</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual dna strand. Nucleic acids research</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>1827</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.89.5.1827</pub-id>
        <pub-id pub-id-type="pmid">1542678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akalin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kormaksson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>methylkit: a comprehensive r package for the analysis of genome-wide dna methylation profiles</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r87</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Hansen KD, B L, Irizarry RA. Bsmooth: from whole genome bisulfite sequencing reads to differentially methylated regions. Genome biology 2012; 3, 1–10.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolzhenko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Using beta-binomial regression for high-precision differential methylation analysis in multifactor whole-genome bisulfite sequencing experiments</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hans-Ulrich</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Detection of significantly differentially methylated regions in targeted bisulfite sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1647</fpage>
        <lpage>1653</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt263</pub-id>
        <pub-id pub-id-type="pmid">23658421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Figueroa</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Rozek</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Sartor</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Methylsig: a whole genome dna methylation analysis pipeline</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2414</fpage>
        <lpage>2422</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu339</pub-id>
        <pub-id pub-id-type="pmid">24836530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Meong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goodell</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Moabs: model based analysis of bisulfite sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0440-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential methylation analysis for bs-seq data under general experimental design</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1446</fpage>
        <lpage>1453</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw026</pub-id>
        <pub-id pub-id-type="pmid">26819470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaspar</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <article-title>Dmrfinder: efficiently identifying differentially methylated regions from methylc-seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1909-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wreczycka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gosdschan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yusuf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Assenov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Akalin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Strategies for analyzing bisulfite sequencing data</article-title>
        <source>J Biotechnol</source>
        <year>2017</year>
        <volume>261</volume>
        <fpage>105</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiotec.2017.08.007</pub-id>
        <pub-id pub-id-type="pmid">28822795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mannerström</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tsagaratou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A probabilistic generative model for quantification of dna modifications enables analysis of demethylation pathways</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0911-6</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malonzo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Lindgren</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ghimire</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Smolander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Scheinin</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laiho</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Elo</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Lönnberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Matias</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Kaprio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rinne</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Peripheral blood dna methylation differences in twin pairs discordant for alzheimer’s disease</article-title>
        <source>Clin Epigenet</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13148-019-0729-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Luxglm: a probabilistic covariate model for quantification of dna methylation modifications with complex experimental design</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>511</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw468</pub-id>
        <pub-id pub-id-type="pmid">26515819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Kucukelbir A, Ranganath R, Gelman A, Blei D. Automatic variational inference in stan. In: Cortes, C, Lee DD, Sugiyama M, R G (eds) Advances in neural information processing systems 28 (NIPS 2015), pp. 568–576 2015. Neural Information Processing Systems.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Betancourt</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Riddell</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Stan: a probabilistic programming language</article-title>
        <source>J Stat Software</source>
        <year>2017</year>
        <volume>76</volume>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
