<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5408915</article-id>
    <article-id pub-id-type="pmid">27797770</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw663</article-id>
    <article-id pub-id-type="publisher-id">btw663</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>KAT: a K-mer analysis toolkit to quality control NGS datasets and genome assemblies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mapleson</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="btw663-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garcia Accinelli</surname>
          <given-names>Gonzalo</given-names>
        </name>
        <xref ref-type="aff" rid="btw663-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kettleborough</surname>
          <given-names>George</given-names>
        </name>
        <xref ref-type="aff" rid="btw663-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wright</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref ref-type="aff" rid="btw663-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clavijo</surname>
          <given-names>Bernardo J</given-names>
        </name>
        <xref ref-type="corresp" rid="btw663-cor1"/>
        <xref ref-type="aff" rid="btw663-aff1"/>
        <!--<email>bernardo.clavijo@earlham.ac.uk</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btw663-aff1">Earlham Institute, Norwich Research Park, Norwich, UK</aff>
    <author-notes>
      <corresp id="btw663-cor1">To whom correspondence should be addressed. Email: <email>bernardo.clavijo@earlham.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2016-11-28">
      <day>28</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>4</issue>
    <fpage>574</fpage>
    <lpage>576</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw663.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p><italic>De novo</italic> assembly of whole genome shotgun (WGS) next-generation sequencing (NGS) data benefits from high-quality input with high coverage. However, in practice, determining the quality and quantity of useful reads quickly and in a reference-free manner is not trivial. Gaining a better understanding of the WGS data, and how that data is utilized by assemblers, provides useful insights that can inform the assembly process and result in better assemblies.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We present the K-mer Analysis Toolkit (KAT): a multi-purpose software toolkit for reference-free quality control (QC) of WGS reads and <italic>de novo</italic> genome assemblies, primarily via their k-mer frequencies and GC composition. KAT enables users to assess levels of errors, bias and contamination at various stages of the assembly process. In this paper we highlight KAT’s ability to provide valuable insights into assembly composition and quality of genome assemblies through pairwise comparison of k-mers present in both input reads and the assemblies.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>KAT is available under the GPLv3 license at: <ext-link ext-link-type="uri" xlink:href="https://github.com/TGAC/KAT">https://github.com/TGAC/KAT</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">BBSRC, Institute Strategic Programme</named-content>
        </funding-source>
        <award-id>BB/J004669/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Rapid analysis of high-throughput whole genome shotgun (WGS) datasets is challenging due to their large size (<xref rid="btw663-B5" ref-type="bibr">Metzker, 2010</xref>), with genome size and complexity creating additional challenges (<xref rid="btw663-B6" ref-type="bibr">Schatz <italic>et al.</italic>, 2012</xref>). Reference-free approaches for analyzing WGS data typically involve examining base calling quality, read length, GC content (<xref rid="btw663-B8" ref-type="bibr">Yang <italic>et al.</italic>, 2013</xref>) and exploring k-mer (words of size <italic>k</italic>) spectra (<xref rid="btw663-B2" ref-type="bibr">Chor <italic>et al.</italic>, 2009</xref>; <xref rid="btw663-B3" ref-type="bibr">Lo and Chain, 2014</xref>). A frequently used reference-free quality control tool is FastQC (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>).</p>
    <p>K-mer spectra reveal information not only about the data quality (level of errors, sequencing biases, completeness of sequencing coverage and potential contamination) but also of genomic complexity (size, karyotype, levels of heterozygosity and repeat content; <xref rid="btw663-B7" ref-type="bibr">Simpson, 2014</xref>). Additional information can be extracted through pairwise comparisons of WGS datasets (<xref rid="btw663-B1" ref-type="bibr">Anvar <italic>et al.</italic>, 2014</xref>), which can identify problematic samples by highlighting differences between spectra.</p>
    <p>KAT, the K-mer Analysis Tookit, is a suite of tools for rapidly counting, comparing and analysing spectra for k-mers of arbitrary length directly from sequence data (see Supplementary section 2 for a discussion on choice of <italic>k</italic> and Supplementary section 3 for a comparison of k-mer tools).</p>
  </sec>
  <sec>
    <title>2 The K-mer analysis toolkit</title>
    <p>KAT is a C ++11 application containing multiple tools, each of which exploits multi-core machines via multi-threading where possible. Core functionality is contained in a library designed to promote rapid development of new tools. Runtime and memory requirements depend on input data size, error and bias levels, and properties of the biological sample but as a rule of thumb, machines capable of <italic>de novo</italic> assembly of a dataset will be sufficient to run KAT on the dataset (see Supplementary section 4 for details). K-mer counting in KAT is performed by an integrated and modified version of Jellyfish2 (<xref rid="btw663-B4" ref-type="bibr">Marçais and Kingsford, 2011</xref>), which supports large <italic>k</italic> values and is among the fastest k-mer counters available (<xref rid="btw663-B9" ref-type="bibr">Zhang <italic>et al.</italic>, 2014</xref>).</p>
    <sec>
      <title>2.1 Assembly validation by comparison of read spectrum and assembly copy number</title>
      <p>The KAT <italic>comp</italic> tool generates a matrix, with a sequence set’s k-mer frequency on one axis, and another set's frequency on the other, with cells holding distinct k-mers counts at the given frequencies. When comparing reads against an assembly, KAT highlights properties of assembly composition and quality. If represented in a stacked histogram, read k-mer spectrum is split by copy number in the assembly (see Supplementary section 5 for a primer on how to interpret KAT’s stacked histograms). In addition, KAT provides the <italic>sect</italic> tool necessary to study specific assembled sequences and track the k-mer coverage across both the read and the assembly spectra. This can help identify assembly artefacts such as collapsing or expanding events, or detect repeat regions. <xref ref-type="fig" rid="btw663-F1">Figure 1</xref> shows plots relating to two <italic>Fraxinus excelsior</italic> assemblies created from the same dataset using the <italic>comp</italic> and <italic>sect</italic> tools. The plots highlight different strategies taken by the assembler, in (a) and (c) we see some homozygous content being duplicated, and in (b) and (d) some heterozygous content eliminated.</p>
      <fig id="btw663-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>(<bold>a</bold>) and (<bold>b</bold>), generated using KAT <italic>comp</italic>, show read k-mer frequency versus assembly copy number stacked histograms for two different assemblies of a heterozygous <italic>Fraxinus excelsior</italic> genome <ext-link ext-link-type="uri" xlink:href="http://ftp-oadb.tsl.ac.uk/fraxinus_excelsior">http://ftp-oadb.tsl.ac.uk/fraxinus_excelsior</ext-link>. Read content in black is absent from the assembly, red occurs once, purple twice, etc. Both k-mer spectra show an error distribution under 25×, heterozygous content around 50× and homozygous content around 100×. (a) contains most (but not all) the heterozygous content, and introduces more duplications on homozygous content. (b) is more collapsed, including mostly a single copy of the homozygous content and less of the heterozygous content. (<bold>c</bold>) and (<bold>d</bold>), generated using KAT <italic>sect</italic>, show kmer coverage across example assembled loci. The assembly k-mer coverage (black line) of assembly (a) in plot (c) shows that the assembly has two copies of this locus, whereas the read k-mer coverage (red line) implies there should be only a single copy. This incorrect duplication has been corrected in assembly (b) with the read and assembly k-mer coverage agreeing in plot (d). The increased read and assembly k-mer coverage at positions 100 and 400 indicates small regions of repetitive sequence in the genome. The halved read k-mer coverage after position 400 indicates a heterozygous locus, which likely caused the duplication of this locus in the assembly (a). See Supplementary Section 5 for a more extensive analysis of all sequences from this loci and their impact on (a) and (b)</p>
        </caption>
        <graphic xlink:href="btw663f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Other KAT tools</title>
      <p>KAT also includes the <italic>hist</italic> tool for computing spectrum from a single sequence set and the <italic>gcp</italic> tool to analyse gc content against k-mer frequency. The <italic>filter</italic> tool can be used to isolate sequences from a set according to their k-mer coverage or gc content from a given spectrum (see Supplementary section 1 for details on all the tools). These tools can be used for various tasks including contaminant detection and extraction both in raw reads and assemblies, analysis of the GC bias and consistency between paired end reads and other types of libraries.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Summary</title>
    <p>KAT is a user-friendly, scalable toolkit for rapidly counting, comparing and analyzing k-mers from various data sources. The tools in KAT assist the user with a wide range of tasks including error profiling, assessing sequencing bias and identifying contaminants and <italic>de novo</italic> genome assembly QC and validation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw663_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>Thanks to David Swarbreck and Federica Di Palma for their support and all KAT users for their valuable feedback. This research was supported in part by the NBIP Computing infrastructure for Science (CiS) group.</p>
    <sec>
      <title>Funding</title>
      <p>This work was strategically funded by the BBSRC, Institute Strategic Programme Grant BB/J004669/1.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btw663-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Anvar</surname><given-names>S.Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Determining the quality and complexity of next-generation sequencing data without a reference genome</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>555.</fpage><pub-id pub-id-type="pmid">25514851</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chor</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Genomic DNA k-mer spectra: models and modalities</article-title>. <source>Genome Biol</source>., <volume>10</volume>, <fpage>R108.</fpage><pub-id pub-id-type="pmid">19814784</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lo</surname><given-names>C.C.</given-names></name>, <name name-style="western"><surname>Chain</surname><given-names>P.S.G.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Rapid evaluation and quality control of next generation sequencing data with faqcs</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>366.</fpage><pub-id pub-id-type="pmid">25408143</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marçais</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Kingsford</surname><given-names>C.</given-names></name></person-group> (<year>2011</year>) 
<article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>764</fpage>–<lpage>770</lpage>.<pub-id pub-id-type="pmid">21217122</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Metzker</surname><given-names>M.L.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Sequencing technologies - the next generation</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>31</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">19997069</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schatz</surname><given-names>M.C.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Current challenges in de novo plant genome sequencing and assembly</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>243.</fpage><pub-id pub-id-type="pmid">22546054</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simpson</surname><given-names>J.T.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Exploring genome characteristics and sequence quality without a reference</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1228</fpage>–<lpage>1235</lpage>.<pub-id pub-id-type="pmid">24443382</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>HTQC: a fast quality control toolkit for illumina sequencing data</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>33.</fpage><pub-id pub-id-type="pmid">23363224</pub-id></mixed-citation>
    </ref>
    <ref id="btw663-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>These are not the k-mers you are looking for: efficient online k-mer counting using a probabilistic data structure</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e101271.</fpage><pub-id pub-id-type="pmid">25062443</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
