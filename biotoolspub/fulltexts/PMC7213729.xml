<?properties open_access?>
<?subarticle pone.0232822.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7213729</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-26904</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Random Variables</subject>
              <subj-group>
                <subject>Covariance</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Survey Research</subject>
            <subj-group>
              <subject>Surveys</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Metrics</subject>
            <subj-group>
              <subject>Age Distribution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Metrics</subject>
            <subj-group>
              <subject>Population Density</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Visualization</subject>
          <subj-group>
            <subject>Infographics</subject>
            <subj-group>
              <subject>Charts</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cell Processes</subject>
            <subj-group>
              <subject>Cell Cycle and Cell Division</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Dynamics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SimSurvey: An R package for comparing the design and analysis of surveys by simulating spatially-correlated populations</article-title>
      <alt-title alt-title-type="running-head">SimSurvey: An R package for comparing the design and analysis of sample surveys</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0318-2615</contrib-id>
        <name>
          <surname>Regular</surname>
          <given-names>Paul M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robertson</surname>
          <given-names>Gregory J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="author-notes" rid="currentaff001">
          <sup>¤</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lewis</surname>
          <given-names>Keith P.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Babyn</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Healey</surname>
          <given-names>Brian</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mowbray</surname>
          <given-names>Fran</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Fisheries and Oceans Canada, Northwest Atlantic Fisheries Center, St. John’s, Newfoundland and Labrador, Canada</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Maurice Lamontagne Institute, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <label>¤</label>
        <p>Current address: Environment and Climate Change Canada, Mount Pearl, Newfoundland and Labrador, Canada</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Paul.Regular@dfo-mpo.gc.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>5</issue>
    <elocation-id>e0232822</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Regular et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Regular et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0232822.pdf"/>
    <abstract>
      <p>Populations often show complex spatial and temporal dynamics, creating challenges in designing and implementing effective surveys. Inappropriate sampling designs can potentially lead to both under-sampling (reducing precision) and over-sampling (through the extensive and potentially expensive sampling of correlated metrics). These issues can be difficult to identify and avoid in sample surveys of fish populations as they tend to be costly and comprised of multiple levels of sampling. Population estimates are therefore affected by each level of sampling as well as the pathway taken to analyze such data. Though simulations are a useful tool for exploring the efficacy of specific sampling strategies and statistical methods, there are a limited number of tools that facilitate the simulation testing of a range of sampling and analytical pathways for multi-stage survey data. Here we introduce the R package <bold>SimSurvey</bold>, which has been designed to simplify the process of simulating surveys of age-structured and spatially-distributed populations. The package allows the user to simulate age-structured populations that vary in space and time and explore the efficacy of a range of built-in or user-defined sampling protocols to reproduce the population parameters of the known population. <bold>SimSurvey</bold> also includes a function for estimating the stratified mean and variance of the population from the simulated survey data. We demonstrate the use of this package using a case study and show that it can reveal unexpected sources of bias and be used to explore design-based solutions to such problems. In summary, <bold>SimSurvey</bold> can serve as a convenient, accessible and flexible platform for simulating a wide range of sampling strategies for fish stocks and other populations that show complex structuring. Various statistical approaches can then be applied to the results to test the efficacy of different analytical approaches.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the NSERC visiting-fellow program and Fisheries and Oceans Canada. The Science Branch of Fisheries and Oceans Canada initiated this project to assess the sampling design of trawl surveys conducted along the Newfoundland and Labrador shelf.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="4"/>
      <page-count count="28"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The simulated data used in this manuscript can be replicated using the code provided in the <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The simulated data used in this manuscript can be replicated using the code provided in the <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Good survey design is a critical prerequisite for obtaining accurate and precise estimates of a population of interest. The need for sound sampling techniques is as relevant today as it was in the 1930’s when much of the theory and principles behind the collection of scientific data were developed by statisticians such as R.A. Fisher and Jerzy Neyman [<xref rid="pone.0232822.ref001" ref-type="bibr">1</xref>]. Then and now, we are experiencing a period of increasing human activity and robust methods are required to detect the impacts of our actions on the natural world [<xref rid="pone.0232822.ref002" ref-type="bibr">2</xref>]. Survey quality is especially important for conservation-oriented science as monitoring data are used to identify species at risk of extinction [<xref rid="pone.0232822.ref003" ref-type="bibr">3</xref>], to assess the efficacy of recovery plans [<xref rid="pone.0232822.ref004" ref-type="bibr">4</xref>], and to determine precautionary levels of exploitation [<xref rid="pone.0232822.ref005" ref-type="bibr">5</xref>]. Surveys with a solid basis in sampling theory have therefore become a core component of many ecological monitoring programs throughout the world.</p>
    <p>One of the biggest challenges associated with surveys is the cost of planning and implementing effective and efficient sampling designs [<xref rid="pone.0232822.ref006" ref-type="bibr">6</xref>]. Despite their costs, surveys have become a mainstay in the management of dynamic fish stocks as survey data are not easily replaced by other sources of information [<xref rid="pone.0232822.ref007" ref-type="bibr">7</xref>]. For instance, large population declines can be overlooked by relying solely on catch and effort data from commercial fisheries [<xref rid="pone.0232822.ref008" ref-type="bibr">8</xref>]. Such difficulties have contributed to the growing reliance on fisheries-independent surveys to monitor fish populations. Planning or improving such surveys is an important but non-trivial task because of the inherent complexity of both the survey and target population. Specifically, fisheries-independent surveys usually involve multiple levels of sampling and fish populations often show size-structured spatial and temporal dynamics [<xref rid="pone.0232822.ref009" ref-type="bibr">9</xref>]. These features are not easily captured by simple statistical models, which makes it difficult to determine optimal sampling and sub-sampling schemes [<xref rid="pone.0232822.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0232822.ref012" ref-type="bibr">12</xref>]. In such situations it is common for practitioners to resort to simulations to test various sampling and analytical pathways (e.g. [<xref rid="pone.0232822.ref013" ref-type="bibr">13</xref>]). However, such tests are rare in fisheries research (but see [<xref rid="pone.0232822.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0232822.ref015" ref-type="bibr">15</xref>]), perhaps because of the complexities associated with fisheries-independent surveys.</p>
    <p>Here we document <bold>SimSurvey</bold>, an R package designed to facilitate realistic simulations of fisheries-independent trawl surveys. In short, the package allows for the simulation of random or stratified-random surveys of an age-structured population that varies in space and time. The package has two main components: the first focuses on mimicking realistic fish stocks by simulating a spatially and age-correlated population distributed across a habitat gradient, and the second component focuses on simulating various surveys of these virtual fish stocks. Although constructed to assess the design of fisheries-independent trawl surveys, this package can be used to model any population that shows complex spatial and age structure.</p>
    <p>This simulation framework has similarities to those presented by Schnute and Haigh [<xref rid="pone.0232822.ref014" ref-type="bibr">14</xref>] and Puerta et al. [<xref rid="pone.0232822.ref015" ref-type="bibr">15</xref>], however, we focused our efforts on developing a series of general and accessible functions to simplify the process of testing multiple sampling scenarios and analytical pathways. The steps taken to simulate surveys of spatial, age-structure populations are outlined below. We first outline the equations underlying the package (<bold>Model structure</bold> section) and then we demonstrate how to use its core functions (<bold>Core functions</bold> section). The core functions of the package are largely demonstrated using default settings, and these settings are based on a case study (see <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref> for details on the case study, and see <xref ref-type="supplementary-material" rid="pone.0232822.s002">S2 Appendix</xref> for guidance on how to modify default settings to suit specific needs). Several of the results from the case study are described and discussed in the <bold>Interpretation</bold> section as they highlight one use case of the package. Finally, we discuss the broader research opportunities and future directions of the package (<xref ref-type="sec" rid="sec014">Discussion</xref> section).</p>
  </sec>
  <sec id="sec002">
    <title>Model structure</title>
    <p>In this section, we describe the framework currently implemented in the <bold>SimSurvey</bold> package. With this framework, we tried to strike a balance between realism, simplicity, generality and computational feasibility. The framework follows four general steps: 1) simulate a spatially-aggregated age-structured population; 2) distribute the population throughout a spatial grid, imposing correlation across space, time and age; 3) sample the population using random sampling; and, 4) obtain population estimates using a design-based analysis. Though there is a degree of flexibility in each of these steps, users can circumvent specific components by applying user defined equations, inputs and/or analyses. Details on how to use the package and, if desired, circumvent some aspects of its structure are outlined in the <bold>Core functions</bold> section.</p>
    <sec id="sec003">
      <title>Simulate abundance</title>
      <p>The simulation starts with an exponential decay cohort model where the abundance at age <italic>a</italic> in year <italic>y</italic> (<italic>N</italic><sub><italic>a</italic>,<italic>y</italic></sub>) equals the abundance of that cohort in the previous year multiplied by the associated survival rate, which is expressed in terms of total mortality (<italic>Z</italic><sub><italic>a</italic>,<italic>y</italic></sub>):
<disp-formula id="pone.0232822.e001"><alternatives><graphic xlink:href="pone.0232822.e001.jpg" id="pone.0232822.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></disp-formula></p>
      <p>Here, numbers at age in the first year are filled via exponential decay, <inline-formula id="pone.0232822.e002"><alternatives><graphic xlink:href="pone.0232822.e002.jpg" id="pone.0232822.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1,1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mn>1,1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, numbers at age 1 (i.e. recruits) vary around a baseline value, <italic>log</italic>(<italic>N</italic><sub>1,<italic>y</italic></sub>) = <italic>log</italic>(<italic>μ</italic><sub><italic>r</italic></sub>) + <italic>ϵ</italic><sub><italic>y</italic></sub>, and total mortality is set to a baseline level plus process error, <italic>log</italic>(<italic>Z</italic><sub><italic>a</italic>,<italic>y</italic></sub>) = <italic>log</italic>(<italic>μ</italic><sub><italic>Z</italic></sub>) + <italic>δ</italic><sub><italic>a</italic>,<italic>y</italic></sub>. The error around the recruitment process was set to follow a random walk, <inline-formula id="pone.0232822.e003"><alternatives><graphic xlink:href="pone.0232822.e003.jpg" id="pone.0232822.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, and the process error was simulated using the covariance structure described in Cadigan [<xref rid="pone.0232822.ref016" ref-type="bibr">16</xref>], <italic>δ</italic><sub><italic>a</italic>,<italic>y</italic></sub> ∼ <italic>N</italic>(0,<italic>Σ</italic><sub><italic>a</italic>,<italic>y</italic></sub>). The covariance across ages and years is controlled by a process error variance parameter (<inline-formula id="pone.0232822.e004"><alternatives><graphic xlink:href="pone.0232822.e004.jpg" id="pone.0232822.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) along with age and year correlation parameters (<italic>φ</italic><sub><italic>δ</italic>,age</sub> and <italic>φ</italic><sub><italic>δ</italic>,year</sub>, respectively). This structure allows for autocorrelation in process errors across ages and years (i.e. total mortality can be made to be more similar for fish that are closer together in age and/or time). Note that a plus group is not modeled as the number of ages can easily be extended to include groups with zero fish.</p>
      <p>In practice, abundance at age is often inferred from length data as it is easier to collect. Abundance at length is therefore simulated from abundance at age using the original von Bertalanffy growth curve [<xref rid="pone.0232822.ref017" ref-type="bibr">17</xref>]:
<disp-formula id="pone.0232822.e005"><alternatives><graphic xlink:href="pone.0232822.e005.jpg" id="pone.0232822.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:math></alternatives></disp-formula>
Where <italic>L</italic><sub>∞</sub> is the mean asymptotic length, <italic>L</italic><sub>0</sub> is length at birth, <italic>K</italic> is the growth rate parameter and the error is assumed to follow the normal distribution, <inline-formula id="pone.0232822.e006"><alternatives><graphic xlink:href="pone.0232822.e006.jpg" id="pone.0232822.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi>ε</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Numbers at age are distributed across discrete length groups following a lognormal distribution by calculating the probability of being in a specific length group given age, <italic>ϕ</italic><sub><italic>a</italic>,<italic>l</italic></sub>. These probabilities are calculated using the standard normal cumulative density function <italic>Φ</italic> for a sequence of length groups <italic>l</italic> from length 0 to 10 times the maximum predicted length <italic>L</italic> at an interval of <inline-formula id="pone.0232822.e007"><alternatives><graphic xlink:href="pone.0232822.e007.jpg" id="pone.0232822.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>:
<disp-formula id="pone.0232822.e008"><alternatives><graphic xlink:href="pone.0232822.e008.jpg" id="pone.0232822.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Overall, this formulation facilitates the simulation of a dynamic length and age structured population. Though some typical relationships have yet to be implemented (e.g. stock-recruitment), sufficient information can be simulated to assess survey performance across a range of abundance levels across years, lengths and ages.</p>
    </sec>
    <sec id="sec004">
      <title>Simulate spatial distribution</title>
      <p>Rather than developing a full spatially-explicit model, population and spatial dynamics are modeled as independent processes for simplicity. The complexities of spatial population dynamics—such as larval dispersal, spatial differences in growth and population connectivity—are not explicitly accounted for and, as such, the model is a necessary simplification of reality. Despite this limitation, the approach taken facilitates the simulation of spatial, age-structured populations with sufficient complexity for testing the efficacy of various survey designs. The simplicity also limits the number of unknown parameters that need to be specified to simulate a population. Parameter estimates from spatially-aggregated age-structured models, which are commonly used in stock assessments, can therefore be used to simulate a population using the cohort model and the resultant abundance at age values can be distributed across a spatial grid. Here, a grid of <italic>s</italic> cells is generated where each cell has an area of <italic>S</italic> and depth <italic>d</italic>; depth is defined using a sigmoid curve, applied across one spatial axis, with a depth range of [<italic>d</italic><sub>min</sub>, <italic>d</italic><sub>max</sub>], shelf depth of <italic>d</italic><sub>shelf</sub> and a shelf width of <italic>w</italic><sub>shelf</sub>. We use depth as our main stratification variable, but note that any other appropriate stratification variables could be used. The grid can be divided into two hierarchical levels, management divisions and habitat-based survey strata. For demonstration purposes, we envision these levels as part of a stratified-random survey within international fishery divisions, i.e., <italic>H</italic><sub>strat</sub> depth-based strata within <italic>H</italic><sub>div</sub> divisions (e.g. NAFO or ICES divisions, or any other geographically bounded area). The simulated population is distributed through the grid by simulating spatial-temporal noise controlled by a parabolic relationship with depth and covariance between ages, years and space. This noise term, <italic>η</italic><sub><italic>a</italic>,<italic>y</italic>,<italic>s</italic></sub>, is scaled to sum to 1 to ensure that the total population of each age for each year through the grid equals the number simulated by the cohort model:
<disp-formula id="pone.0232822.e009"><alternatives><graphic xlink:href="pone.0232822.e009.jpg" id="pone.0232822.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Where <italic>d</italic><sub><italic>s</italic></sub> is the depth in a specific cell of the grid, <italic>μ</italic><sub><italic>d</italic></sub> is the mean depth where abundance is typically highest and <italic>σ</italic><sub><italic>d</italic></sub> controls the width or dispersion of abundance around the mean depth. Residual noise <italic>ξ</italic><sub><italic>a</italic>,<italic>y</italic>,<italic>s</italic></sub> is added to this depth relationship using a combination of Matérn covariance, to control the level of spatial aggregation within ages and years, and a two dimension AR1 age-year covariance described in Cadigan [<xref rid="pone.0232822.ref016" ref-type="bibr">16</xref>], to control the level of similarity in distributions across ages and years. The rate at which point-to-point spatial correlation decays with distance is controlled by a smoothing (<italic>λ</italic>) and a scaling parameter (<italic>κ</italic>) (here <italic>κ</italic> is approximated from range parameter <italic>r</italic>, <inline-formula id="pone.0232822.e010"><alternatives><graphic xlink:href="pone.0232822.e010.jpg" id="pone.0232822.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>8</mml:mn><mml:mi>λ</mml:mi></mml:msqrt><mml:mo>/</mml:mo><mml:mi>r</mml:mi></mml:math></alternatives></inline-formula>; [<xref rid="pone.0232822.ref018" ref-type="bibr">18</xref>]) and correlation across ages and years is controlled by <italic>φ</italic><sub><italic>ξ</italic>,age</sub> and <italic>φ</italic><sub><italic>ξ</italic>,year</sub>, respectively. The overall variance of the spatial process is controlled by <inline-formula id="pone.0232822.e011"><alternatives><graphic xlink:href="pone.0232822.e011.jpg" id="pone.0232822.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (see <xref ref-type="supplementary-material" rid="pone.0232822.s003">S3 Appendix</xref> for a more detailed description of the space-age-year covariance structure). In short, this formulation allows control of depth preferences, the level of spatial aggregation and the degree of age and year specific clustering.</p>
    </sec>
    <sec id="sec005">
      <title>Simulate survey</title>
      <p>The final step in the simulation is to sample the simulated population over the age-year-space array generated. The sampling is random or stratified random, emulating surveys conducted by many research institutions around the world. The area of each strata <italic>A</italic><sub>strat</sub> is calculated and this is used to define the number of sampling stations <italic>H</italic><sub>sets</sub>, hereafter referred to as sets, allocated to one or more strata under a particular set density, <italic>D</italic><sub>sets</sub> (i.e. <italic>H</italic><sub>sets</sub> = <italic>A</italic><sub>strat</sub>
<italic>D</italic><sub>sets</sub>). The allocated number of cells are randomly selected in each strata and the number of fish caught in each set is calculated by applying binomial sampling of the fish in each sampled cell by the proportion of the area covered by the trawl and the catchability of each age:
<disp-formula id="pone.0232822.e012"><alternatives><graphic xlink:href="pone.0232822.e012.jpg" id="pone.0232822.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
Where <italic>n</italic><sub><italic>a</italic>,<italic>y</italic>,<italic>s</italic></sub> is the number of fish of age <italic>a</italic> in year <italic>y</italic> sampled by a set at location <italic>s</italic>, <italic>A</italic><sub>trawl</sub> indicates the area covered by the trawl, <italic>A</italic><sub>cell</sub> is the area of a grid cell, and <italic>q</italic><sub><italic>a</italic></sub> is the catchability coefficient of each age (i.e. the ability of the trawling gear to catch specific age groups). Here, catchabilities were defined using a logistic curve controlled by a steepness, <italic>k</italic>, and midpoint parameter, <italic>x</italic><sub>0</sub>. In cases where there are multiple sets in one cell, the population in that cell is divided across the sets. While this means that numbers caught in an isolated simulation cannot exceed the numbers in the population, keep in mind that the survey, no matter how intense, is assumed to have no impact on the population from one year to the next.</p>
      <p>Once catches are simulated, lengths of the fish sampled by each set are simulated using the von Bertalanffy growth equation found above in the <bold>Simulate abundance</bold> section. Sub-sampling is then conducted whereby a subset of fish are sampled for length measurements and a subset of this subset are sampled for age determination. Specifically, a maximum number of lengths are measured per set (<italic>M</italic><sub>lengths</sub>) and a maximum number of ages (<italic>M</italic><sub>ages</sub>) are sampled per length group (<italic>l</italic><sub>group</sub>) per division, strata or set (<italic>s</italic><sub>group</sub>). Such sub-sampling is common in fisheries-independent surveys as it is costly, impractical and unnecessary to sample every fish captured. Age determination is especially time-consuming, which is why otoliths for age-determination tend to be sub-sampled by length-bin to obtain a representative age sample across a wider range of lengths than would be obtained via random sampling.</p>
    </sec>
    <sec id="sec006">
      <title>Stratified analysis</title>
      <p>While there are many model-based options for obtaining an abundance index from survey data (e.g. [<xref rid="pone.0232822.ref019" ref-type="bibr">19</xref>]), design-based approaches, such as stratified analyses, are often used. Here we apply formulae presented in Smith and Somerton [<xref rid="pone.0232822.ref020" ref-type="bibr">20</xref>] (equations are replicated in <xref ref-type="supplementary-material" rid="pone.0232822.s004">S4 Appendix</xref>) to calculate year <italic>y</italic> and simulation <italic>j</italic> specific stratified estimates of total abundance (<inline-formula id="pone.0232822.e013"><alternatives><graphic xlink:href="pone.0232822.e013.jpg" id="pone.0232822.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>), abundance at length (<inline-formula id="pone.0232822.e014"><alternatives><graphic xlink:href="pone.0232822.e014.jpg" id="pone.0232822.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) and abundance at age (<inline-formula id="pone.0232822.e015"><alternatives><graphic xlink:href="pone.0232822.e015.jpg" id="pone.0232822.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). Note that estimates of total abundance are based on total numbers caught at each set, <italic>n</italic><sub><italic>i</italic></sub>, while abundance at length requires the sub-sampled length frequencies at each set, <italic>m</italic><sub><italic>l</italic>,<italic>i</italic></sub>, to be scaled up using set-specific ratios of the number of fish measured, <italic>m</italic><sub><italic>i</italic></sub>, to numbers caught, <italic>n</italic><sub><italic>i</italic></sub>:
<disp-formula id="pone.0232822.e016"><alternatives><graphic xlink:href="pone.0232822.e016.jpg" id="pone.0232822.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Likewise, age frequencies need to be calculated to obtain stratified estimates of abundance at age. This is done by constructing an age-length key, which is the proportion of fish in each length bin that fall into specific age classes. Once these proportions are calculated, they are applied to the bumped up length frequencies, <italic>n</italic><sub><italic>l</italic>,<italic>i</italic></sub>, to approximate age frequencies, <italic>n</italic><sub><italic>a</italic>,<italic>i</italic></sub>, that is:
<disp-formula id="pone.0232822.e017"><alternatives><graphic xlink:href="pone.0232822.e017.jpg" id="pone.0232822.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></alternatives></disp-formula></p>
      <p>Here, the prime symbol ′ indicates that these values are tertiary sampling units as they represent fish sub-sampled for age determination from those sub-sampled for length measurements. Within this sub-sample, <inline-formula id="pone.0232822.e018"><alternatives><graphic xlink:href="pone.0232822.e018.jpg" id="pone.0232822.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> represents the number of fish within length bin <italic>l</italic> and from area <italic>g</italic>, and <inline-formula id="pone.0232822.e019"><alternatives><graphic xlink:href="pone.0232822.e019.jpg" id="pone.0232822.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> represents the number of fish within age-class <italic>a</italic>, length bin <italic>l</italic> and area <italic>g</italic>. The area <italic>g</italic> can be division, strata or set specific. Though age-length keys are typically constructed and applied over large spatial scales (e.g. division), Aanes and Vølstad [<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>] recommends calculating proportions at finer scales to better account for hierarchical sample designs.</p>
      <p>We used root-mean-squared error (RMSE) as a measure of the precision and bias of the abundance at age estimates from each survey:
<disp-formula id="pone.0232822.e020"><alternatives><graphic xlink:href="pone.0232822.e020.jpg" id="pone.0232822.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>×</mml:mo><mml:mi>Y</mml:mi><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:math></alternatives></disp-formula>
Where <italic>A</italic>, <italic>Y</italic>, and <italic>J</italic> are the number of ages, years and simulations, respectively, and <italic>I</italic><sub><italic>a</italic>,<italic>y</italic></sub> is the true abundance available to the survey (i.e. catchability corrected abundance; <italic>I</italic><sub><italic>a</italic>,<italic>y</italic></sub> = <italic>q</italic><sub><italic>a</italic></sub><italic>N</italic><sub><italic>a</italic>,<italic>y</italic></sub>). RMSE was also calculated for abundance at length estimates, where the above formula is indexed by length groups <italic>l</italic>, and total abundance, which lacks a group index of <italic>a</italic> or <italic>l</italic>.</p>
    </sec>
  </sec>
  <sec id="sec007">
    <title>Core functions</title>
    <p>The <bold>SimSurvey</bold> package was written in the programming language R [<xref rid="pone.0232822.ref022" ref-type="bibr">22</xref>] and it holds a series of functions for 1) simulating the abundance and distribution of virtual fish populations with correlation across space, time and age (sim_abundance, sim_distribution), 2) simulating surveys with a range of sampling strategies and intensities (sim_survey), and 3) estimating the stratified mean and variance of simulated survey data (run_strat; <xref rid="pone.0232822.t001" ref-type="table">Table 1</xref>). <bold>SimSurvey</bold> relies heavily on functions from the <bold>data.table</bold> [<xref rid="pone.0232822.ref023" ref-type="bibr">23</xref>], <bold>raster</bold> [<xref rid="pone.0232822.ref024" ref-type="bibr">24</xref>] and <bold>plotly</bold> [<xref rid="pone.0232822.ref025" ref-type="bibr">25</xref>] packages for their efficient data processing, geographic and plotting facilities, respectively. Package documentation has been published online using <bold>pkgdown</bold> (<ext-link ext-link-type="uri" xlink:href="https://paulregular.github.io/SimSurvey/">https://paulregular.github.io/SimSurvey/</ext-link>) and all the source R code behind <bold>SimSurvey</bold> is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/PaulRegular/SimSurvey">https://github.com/PaulRegular/SimSurvey</ext-link>). <bold>SimSurvey</bold> can be installed via GitHub using the <bold>remotes</bold> package:
<disp-formula id="pone.0232822.e022"><graphic xlink:href="pone.0232822.e022.jpg" id="pone.0232822.e022g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <table-wrap id="pone.0232822.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Names and descriptions of the key functions of SimSurvey.</title>
        <p>Functions in bold font are core functions and those in medium font are designed for use inside the core functions. The latter are typically closures, which are functions that contain data and return functions [<xref rid="pone.0232822.ref026" ref-type="bibr">26</xref>]; here they are used to store parameter values and return functions that require dimensions, such as ages or years, to be supplied.</p>
      </caption>
      <alternatives>
        <graphic id="pone.0232822.t001g" xlink:href="pone.0232822.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Function</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>sim_abundance</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Simulate a basic age-structured population dynamics model</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> sim_R, sim_Z, sim_N0, sim_vonB</td>
              <td align="left" rowspan="1" colspan="1">Closures, to use inside sim_abundance, for simulating recruitment, total mortality, initial abundance and growth, respectively</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>sim_distribution</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Simulate spatial and temporal distribution of an age-structured population</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> sim_ays_covar, sim_parabola</td>
              <td align="left" rowspan="1" colspan="1">Closures, to use inside sim_distribution, for simulating age-year-space covariance and parabolic relationships with covariates (e.g. depth), respectively</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> make_grid</td>
              <td align="left" rowspan="1" colspan="1">Make a basic depth stratified square grid to use inside sim_distribution</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>sim_survey</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Simulate a survey of a spatial, age-structured population</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> sim_logistic</td>
              <td align="left" rowspan="1" colspan="1">Closure, to use inside sim_survey, for simulating age-specific catchability as a logistic curve</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>run_strat</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Run a stratified analysis on simulated survey data</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>strat_error</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Calculate the error of stratified estimates (e.g. root mean squared error of stratified estimates from true values)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>test_surveys</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">Test the sampling design of multiple surveys using a stratified analysis (internally loops over sim_survey, run_strat and strat_error)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> expand_surveys</td>
              <td align="left" rowspan="1" colspan="1">Create a data frame, for use in test_surveys, with all combinations of supplied survey settings</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>The equations behind the functions listed in <xref rid="pone.0232822.t001" ref-type="table">Table 1</xref> are detailed in the <bold>Model structure</bold> section. Note that several of the core equations are implemented using “closures”, which are functions that contain data and return functions [<xref rid="pone.0232822.ref026" ref-type="bibr">26</xref>]. For example, sim_R returns a function that holds the supplied parameter values and requires a sequence of years to be supplied.
<disp-formula id="pone.0232822.e023"><graphic xlink:href="pone.0232822.e023.jpg" id="pone.0232822.e023g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>Here, the R_vec object holds 100 years of simulated recruitment values and each run of the R_fun function will result in different simulated values using the internal formulation and the parameters supplied to sim_R. The other closures included in the package operate in a similar way in that parameter inputs are supplied to the closure and the functions returned by the closure requires inputs such as ages and/or years. This was done to avoid the repeated specifications of key arguments, such as ages and years. Moreover, this approach provides an option for advanced R users to inspect and modify the closures implemented in the package to supply custom closures with alternate equations (see <ext-link ext-link-type="uri" xlink:href="https://paulregular.github.io/SimSurvey/articles/custom_closures.html">https://paulregular.github.io/SimSurvey/articles/custom_closures.html</ext-link> for a short vignette on creating custom closures). Also note that each of the closures implemented in the package includes a plot argument such that quick visuals can be obtained using a line of code like this: sim_R(log_mean = log(500), log_sd = 0.5, plot = TRUE)(years = 1:100)).</p>
  </sec>
  <sec id="sec008">
    <title>sim_abundance</title>
    <p>Abundance at age and length is simulated using the sim_abundance function and a default function call is described in <xref rid="pone.0232822.t002" ref-type="table">Table 2</xref> along with associated symbols from the equations outlined in the <bold>Simulate abundance</bold> section. This function has a simple structure and requires the specification of a series of ages and years along with a series of closures, such as sim_R, sim_Z and sim_vonB, for simulating recruitment (R), total mortality (Z) and growth (growth), respectively. Overall, the function provides a simple tool for simulating a range of dynamic age-structured populations. For instance, below we provide examples where we simulate a relatively long and short lived species (note that default variance, starting abundance and growth settings were used in both simulations).
<disp-formula id="pone.0232822.e024"><graphic xlink:href="pone.0232822.e024.jpg" id="pone.0232822.e024g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <table-wrap id="pone.0232822.t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Default sim_abundance function call, with descriptions, default values and associated parameter symbols of key arguments.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0232822.t002g" xlink:href="pone.0232822.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Function call</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
              <th align="left" rowspan="1" colspan="1">Symbol</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">sim_abundance(</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> ages = 1:20,</td>
              <td align="left" rowspan="1" colspan="1">Ages</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>a</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> years = 1:20,</td>
              <td align="left" rowspan="1" colspan="1">Years</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>y</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> R = sim_R(log_mean = log(30000000),</td>
              <td align="left" rowspan="1" colspan="1">Mean log recruitment<xref ref-type="table-fn" rid="t002fn001"><sup>1</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">
                <italic>μ</italic>
                <sub>
                  <italic>r</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">       log_sd = 0.5),</td>
              <td align="left" rowspan="1" colspan="1">Standard deviation of log recruitment</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>σ</italic>
                <sub>
                  <italic>r</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> Z = sim_Z(log_mean = log(0.5),</td>
              <td align="left" rowspan="1" colspan="1">Mean log total mortality<xref ref-type="table-fn" rid="t002fn002"><sup>2</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">
                <italic>μ</italic>
                <sub>
                  <italic>Z</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">      log_sd = 0.2,</td>
              <td align="left" rowspan="1" colspan="1">Standard deviation of log total mortality</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>σ</italic>
                <sub>
                  <italic>Z</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">      phi_age = 0.9,</td>
              <td align="left" rowspan="1" colspan="1">Correlation across ages in error around total mortality</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>φ</italic>
                <sub><italic>δ</italic>,age</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">      phi_year = 0.5),</td>
              <td align="left" rowspan="1" colspan="1">Correlation across years in error around total mortality</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>φ</italic>
                <sub><italic>δ</italic>,year</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> growth = sim_vonB(Linf = 120,</td>
              <td align="left" rowspan="1" colspan="1">Mean asymptotic length (cm)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>L</italic>
                <sub>∞</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">         L0 = 5,</td>
              <td align="left" rowspan="1" colspan="1">Length in birth year (cm)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>L</italic>
                <sub>0</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">         K = 0.1,</td>
              <td align="left" rowspan="1" colspan="1">Growth rate</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>K</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">         log_sd = 0.1,</td>
              <td align="left" rowspan="1" colspan="1">Standard deviation of the von Bertalanffy growth curve</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>σ</italic>
                <sub>
                  <italic>L</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">         length_group = 3))</td>
              <td align="left" rowspan="1" colspan="1">Length group bin size for abundance at length (cm)</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula id="pone.0232822.e021">
                  <alternatives>
                    <graphic id="pone.0232822.e021g" xlink:href="pone.0232822.e021"/>
                    <mml:math id="M21">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">g</mml:mi>
                          <mml:mi mathvariant="normal">r</mml:mi>
                          <mml:mi mathvariant="normal">o</mml:mi>
                          <mml:mi mathvariant="normal">u</mml:mi>
                          <mml:mi mathvariant="normal">p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:math>
                  </alternatives>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t002fn001">
          <p><sup>1</sup> Can be a vector of means with a length equal to the number of years in the simulation.</p>
        </fn>
        <fn id="t002fn002">
          <p><sup>2</sup> Can be a matrix of means with number of rows and columns equaling the number of ages and years in the simulation, respectively.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>The sim_abundance function returns a list with the sequence of ages (ages), sequence of years (years), sequence of lengths (lengths), numbers of recruits across all years (R), numbers at age in the first year (N0), total mortality matrix (Z), abundance at age matrix (N), abundance at length matrix (N_at_length) and the function supplied to the growth argument (sim_length). The growth function is retained for later use in sim_survey to simulate lengths given simulated catch at age in a simulated survey.</p>
    <p>The package also includes several plotting functions for making quick plotly-based [<xref rid="pone.0232822.ref025" ref-type="bibr">25</xref>] interactive visuals of the simulated population. For instance, the plot_surface function can be used to make quick visuals of matrices contained within the list returned by sim_abundance. As an example, we display the abundance at age matrix (object named N in the list produced by sim_abundance; <xref ref-type="fig" rid="pone.0232822.g001">Fig 1</xref>); other names can be supplied to the mat argument to visualize a different matrix from the sim_abundance list, such as Z.
<disp-formula id="pone.0232822.e025"><graphic xlink:href="pone.0232822.e025.jpg" id="pone.0232822.e025g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Surface plots of simulated abundance at age of a relatively a) long lived and b) short lived species.</title>
        <p>These plots were produced by plot_surface when supplied a list produced by sim_abundance.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g001"/>
    </fig>
  </sec>
  <sec id="sec009">
    <title>sim_distribution</title>
    <p>The equations outlined in the <bold>Simulate spatial distribution</bold> section are used in the make_grid, sim_ays_covar and sim_parabola functions, and these functions are used within sim_distribution to distribute a population simulated using sim_abundance throughout a grid (<xref rid="pone.0232822.t003" ref-type="table">Table 3</xref>). The output from make_grid is a raster object [<xref rid="pone.0232822.ref024" ref-type="bibr">24</xref>] with four layers: depth, cell, division and strat. If a more detailed and realistic grid is required, users can manually generate their own survey grid using real data and this grid can be supplied as a raster to sim_distribution if the same structure and correct projection is used. The package includes a manually constructed survey grid of NAFO Subdivision 3Ps off the southern coast of Newfoundland (named survey_grid) and the data-raw folder in the GitHub directory includes the data and code used to construct this grid. However, for simplicity, we use make_grid to construct a square grid for a default run of sim_distribution. Below we generate and plot (<xref ref-type="fig" rid="pone.0232822.g002">Fig 2</xref>) a default grid, another grid with the number of strata increased by increasing the number of strat_splits, and another with the number of divisions increased using n_div and a linear depth gradient (the sigmoid curve is forced to be linear when shelf_width is set to zero).
<disp-formula id="pone.0232822.e026"><graphic xlink:href="pone.0232822.e026.jpg" id="pone.0232822.e026g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Plots produced by plot_grid when supplied a raster object produced by make_grid a) using default settings, b) settings that increase the number of times depth strata are split (strat_splits = 3), and c) settings that produce a more linear depth gradient (shelf_width = 0) and increase the number of divisions (n_div = 4).</title>
        <p>In these plots, the yellow to purple color gradient represents depth, the thick grey lines delineate divisions and thin white lines delineate strata.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g002"/>
    </fig>
    <table-wrap id="pone.0232822.t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Default sim_distribution function call, with descriptions and associated parameter symbols of key arguments.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0232822.t003g" xlink:href="pone.0232822.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Function call</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
              <th align="left" rowspan="1" colspan="1">Symbol</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">sim_distribution(</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> sim,</td>
              <td align="left" rowspan="1" colspan="1">Simulated population from sim_abundance</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> grid = make_grid(x_range = c(-140, 140),</td>
              <td align="left" rowspan="1" colspan="1">Range of grid in the x dimension</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        y_range = c(-140, 140),</td>
              <td align="left" rowspan="1" colspan="1">Range of grid in the y dimension</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        res = c(3.5, 3.5),</td>
              <td align="left" rowspan="1" colspan="1">Grid resolution in x and y dimensions (km)—i.e. cell area</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>A</italic>
                <sub>cell</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        shelf_depth = 200,</td>
              <td align="left" rowspan="1" colspan="1">Shelf depth (m)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>d</italic>
                <sub>shelf</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        shelf_width = 100,</td>
              <td align="left" rowspan="1" colspan="1">Shelf width (km)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>w</italic>
                <sub>shelf</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        depth_range = c(0, 1000),</td>
              <td align="left" rowspan="1" colspan="1">Depth range from coast to slope (m)</td>
              <td align="left" rowspan="1" colspan="1">[<italic>d</italic><sub>min</sub>, <italic>d</italic><sub>max</sub>]</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        n_div = 1,</td>
              <td align="left" rowspan="1" colspan="1">Number of divisions</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>H</italic>
                <sub>div</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        strat_splits = 2,</td>
              <td align="left" rowspan="1" colspan="1">Number of strata within each depth class</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        strat_breaks = seq(0, 1000, 40)),</td>
              <td align="left" rowspan="1" colspan="1">Series of depth breaks for defining strata</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> ays_covar = sim_ays_covar(sd = 2.8,</td>
              <td align="left" rowspan="1" colspan="1">Standard deviation of age-year-space distribution</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>σ</italic>
                <sub>
                  <italic>ξ</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            range = 300,</td>
              <td align="left" rowspan="1" colspan="1">Range of spatial correlation (km)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>r</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            lambda = 1,</td>
              <td align="left" rowspan="1" colspan="1">Smoothness of spatial correlation</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>λ</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            phi_age = 0.5,</td>
              <td align="left" rowspan="1" colspan="1">Correlation across ages in spatial distribution</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>φ</italic>
                <sub><italic>ξ</italic>,age</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            phi_year = 0.9,</td>
              <td align="left" rowspan="1" colspan="1">Correlation across years in spatial distribution</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>φ</italic>
                <sub><italic>ξ</italic>,year</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            group_ages = 5:20,</td>
              <td align="left" rowspan="1" colspan="1">Make space-age-year noise equal across these ages<xref ref-type="table-fn" rid="t003fn001"><sup>1</sup></xref></td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            group_years = NULL),</td>
              <td align="left" rowspan="1" colspan="1">Make space-age-year noise equal across these years<xref ref-type="table-fn" rid="t003fn001"><sup>1</sup></xref></td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> depth_par = sim_parabola(mu = 200,</td>
              <td align="left" rowspan="1" colspan="1">Depth at which abundance is typically highest (m)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>μ</italic>
                <sub>
                  <italic>d</italic>
                </sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">            sigma = 70))</td>
              <td align="left" rowspan="1" colspan="1">Dispersion around depth of peak abundance (m)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>σ</italic>
                <sub>
                  <italic>d</italic>
                </sub>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t003fn001">
          <p><sup>1</sup> All ages or years are independent if argument values is NULL.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>In addition to supplying objects produced by sim_abundance and make_grid, the sim_distribution function requires two closures that describe the age-year-space covariance and the relationship with depth. Here we use sim_ays_covar and sim_parabola to control these relationships and a wide range of age and year specific distributions can be obtained by adjusting a few parameters in these closures (<xref ref-type="fig" rid="pone.0232822.g003">Fig 3</xref>). While here we only describe one option for simulating a spatial noise (see <xref ref-type="supplementary-material" rid="pone.0232822.s003">S3 Appendix</xref> for details), custom closures can be used that leverage simulation models provided by packages such as <bold>RandomFields</bold> [<xref rid="pone.0232822.ref027" ref-type="bibr">27</xref>] or <bold>INLA</bold> [<xref rid="pone.0232822.ref028" ref-type="bibr">28</xref>] (see the code behind sim_ays_covar_sped [<ext-link ext-link-type="uri" xlink:href="https://github.com/PaulRegular/SimSurvey/blob/master/R/sim_dist_spde.R">https://github.com/PaulRegular/SimSurvey/blob/master/R/sim_dist_spde.R</ext-link>] for an example of how the sim_ays_covar closure was modified to apply a Stochastic Partial Differential Equation approach using the <bold>INLA</bold> package). Below we run a default sim_distribution call, which generates a population that forms tight clusters that are more strongly correlated across years than ages, and another call that generates a population that is more diffuse (i.e. wider range) and exhibits stronger correlation across ages than years (i.e. lower phi_year and higher phi_age). Distributions can also be forced to be the same across ages and years by using the group_ages and group_years arguments, respectively, in the sim_ays_covar closure. Variance in the size of the clusters can also be modified by changing the sd argument in the sim_ays_covar function. In other words, these parameters can be modified to control the degree of age-specific clustering and inter-annual site-fidelity exhibited by the simulated population. Note that the resolution of the default grid is high and, as such, the simulations below may take minutes to complete. Also note that the key functions in the <bold>SimSurvey</bold> package have been set-up to be pipe (%&gt;%; [<xref rid="pone.0232822.ref029" ref-type="bibr">29</xref>]) friendly such that values from one function call are forwarded to the next function (i.e. output from the two calls below are functionally the same though the approach is slightly different).
<disp-formula id="pone.0232822.e027"><graphic xlink:href="pone.0232822.e027.jpg" id="pone.0232822.e027g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g003</object-id>
      <label>Fig 3</label>
      <caption>
        <title>Distribution plots of simulated populations that form a) tight clusters with stronger correlation through years than ages (default settings), and b) relatively diffuse clusters with stronger correlation through ages than years.</title>
        <p>This plot is a facet of plots produced by plot_distribution when supplied simulations from sim_distribution.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g003"/>
    </fig>
    <p>The sim_distribution function retains all the data simulated by sim_abundance and adds a data.table [<xref rid="pone.0232822.ref023" ref-type="bibr">23</xref>], named sp_N, with abundance (N) split by age, year and cell. The function also retains the grid object and converts these data into a data.table, named grid_xy, with headers x, y, depth, cell, division and strat. The sp_N object can be merged with the grid_xy data by cell to associate abundance with specific locations, depth, divisions or strata. The plot_distribution function can be used to provide a quick visual of the distribution across ages and years. The code below will generate interactive plots with an Age-Year slider, however, for this paper we present a facet plot of the simulated data (<xref ref-type="fig" rid="pone.0232822.g003">Fig 3</xref>).
<disp-formula id="pone.0232822.e028"><graphic xlink:href="pone.0232822.e028.jpg" id="pone.0232822.e028g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
  </sec>
  <sec id="sec010">
    <title>sim_survey</title>
    <p>The function sim_survey can be used to simulate data from one survey over a population created using sim_distribution. A default function call is described in <xref rid="pone.0232822.t004" ref-type="table">Table 4</xref>. The sim_survey function simulates the sampling process of the survey and, as such, requires a closure for defining catchability as a function of age and survey protocol settings. Specifically, the q argument requires a closure, such as sim_logistic, for defining the probability of catching specific age groups, trawl dimensions are defined in the trawl_dim argument, and set, length and age sampling effort are defined using the set_den, lengths_cap and ages_cap arguments, respectively. Also note that the min_sets argument imposes a minimum of number of sets to conduct per strata, regardless of its allocation given strata area and set density. This argument imposes a useful constraint for generating data to be analyzed using design-based approaches that require more than one value for the calculation of a mean.</p>
    <table-wrap id="pone.0232822.t004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.t004</object-id>
      <label>Table 4</label>
      <caption>
        <title>Default sim_survey function call, with descriptions and associated parameter symbols of key arguments.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0232822.t004g" xlink:href="pone.0232822.t004"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Function call</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
              <th align="left" rowspan="1" colspan="1">Symbol</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">sim_survey(</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> sim,</td>
              <td align="left" rowspan="1" colspan="1">Simulated spatial population from sim_distribution</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> n_sims = 1</td>
              <td align="left" rowspan="1" colspan="1">Number of times to repeat the survey</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> q = sim_logistic(k = 2,</td>
              <td align="left" rowspan="1" colspan="1">Steepness of logistic curve of catchability</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>k</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">        x0 = 3),</td>
              <td align="left" rowspan="1" colspan="1">Midpoint of logistic curve of catchability (age)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>x</italic>
                <sub>0</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> trawl_dim = c(1.5, 0.02),</td>
              <td align="left" rowspan="1" colspan="1">Trawl dimensions (distance towed, trawl width; km)—i.e. area trawled</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>A</italic>
                <sub>trawl</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> min_sets = 2</td>
              <td align="left" rowspan="1" colspan="1">Minimum number of sets to conduct per strata</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> set_den = 2/1000,</td>
              <td align="left" rowspan="1" colspan="1">Set density (km<sup>-2</sup>)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>D</italic>
                <sub>sets</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> lengths_cap = 500,</td>
              <td align="left" rowspan="1" colspan="1">Maximum number of lengths to collect / set</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>M</italic>
                <sub>lengths</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> ages_cap = 10,</td>
              <td align="left" rowspan="1" colspan="1">Maximum number of ages to sample / length group / spatial group <xref ref-type="table-fn" rid="t004fn001"><sup>1</sup></xref></td>
              <td align="left" rowspan="1" colspan="1">
                <italic>M</italic>
                <sub>ages</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> age_sampling = "stratified",</td>
              <td align="left" rowspan="1" colspan="1">Controls whether age sampling is length "stratified" or "random"</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> age_length_group = 1,</td>
              <td align="left" rowspan="1" colspan="1">Length group bin size for stratified age sampling (cm)</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>l</italic>
                <sub>group</sub>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> age_space_group = "division")</td>
              <td align="left" rowspan="1" colspan="1">Spatial scale of stratified age sampling ("division", "strat", "set")</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>s</italic>
                <sub>group</sub>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t004fn001">
          <p><sup>1</sup> Length group and spatial group are defined using the age_length_group and age_space_group arguments, respectively. These arguments are ignored if age_sampling is set to "random" and the value supplied to ages_cap represents the maximum number of ages to sample per set.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Like sim_abundance and sim_distribution, custom closures can be supplied to sim_survey to impose alternate parametric curves for catchability at age (i.e. a closure including an equation for a dome can be constructed and used in lieu of sim_logistic to impose a dome-shaped catchability). Multiple simulations of the same survey can be run using the n_sims argument, however, requesting large numbers of simulations can be computationally demanding depending on the processing capacity available. Below we use sim_survey to simulate two surveys over a default population, of which one is set-up to have higher set density (set_den) than the other.
<disp-formula id="pone.0232822.e029"><graphic xlink:href="pone.0232822.e029.jpg" id="pone.0232822.e029g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>Again, this function retains all the objects listed in the output of sim_distribution and adds data.tables that detail the set locations (setdet) and sampling details (samp). Catchability corrected abundance matrices (abundance at age matrix multiplied by survey catchability), named I and I_at_length, are also produced and added to the output; these matrices are useful for comparing the true abundance available to the survey to abundance estimates obtained using design-based or model-based analyses of the simulated survey data. Specific surveys can be explored using the plot_survey function, which uses plotly [<xref rid="pone.0232822.ref025" ref-type="bibr">25</xref>] and crosstalk [<xref rid="pone.0232822.ref030" ref-type="bibr">30</xref>] in the background to link the bubble plot of aggregate set catch to the histogram of lengths and ages sampled to facilitate explorations of set-specific catches (<xref ref-type="fig" rid="pone.0232822.g004">Fig 4</xref>).
<disp-formula id="pone.0232822.e030"><graphic xlink:href="pone.0232822.e030.jpg" id="pone.0232822.e030g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Bubble plots of abundance and histograms of set catches from a simulated stratified-random survey of a default population under relatively a) low and b) high sampling effort.</title>
        <p>Point size and color are scaled by abundance in the bubble plots. Histograms of length and age composition include the distribution of all fish caught next to those sampled overlaid with a line of the true distribution of lengths and ages available to the survey. Note that the first simulation of the survey in year 20 is depicted here. These plots are produced by plot_survey when supplied survey data simulated using sim_survey.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g004"/>
    </fig>
    <p>As noted above, available RAM may limit the utility of the sim_survey function for running thousands of simulations of the same survey. The sim_survey_parallel function was therefore constructed to facilitate this process. This function is set-up to run multiple sim_survey calls in parallel using the <bold>doParallel</bold> package [<xref rid="pone.0232822.ref031" ref-type="bibr">31</xref>] and, as such, multiple loops can be run using the n_loops argument and, within each loop, multiple simulations can be run (controlled using the n_sims argument). Total simulations will be the product of n_loops and n_sims arguments. If more than one core (cores) is specified, then the simulations will be run in parallel to speed up the process. Low numbers of n_sims and high numbers of n_loops will be easier on RAM, but may be slower. The optimum ratio of n_sims to n_loops will depend on the amount of RAM and number of cores in a given computer. In any case, this function simplifies the process of running thousands of simulations of the same survey and the simulated data can then be supplied to survey-based or model-based analyses that require simulation testing.</p>
  </sec>
  <sec id="sec011">
    <title>run_strat</title>
    <p>Stratified estimates of abundance are obtained by supplying the output from sim_survey to the run_strat function. There are only four arguments in the run_strat function: length_group, alk_scale, strat_data_fun, and strat_means_fun. The length_group argument defines the size of the length frequency bins for both abundance at length calculations and age-length key construction; this argument is set to "inherit", by default, to utilize the length_group value defined inside the closure supplied to the growth argument in sim_abundance. The alk_scale argument defines the scale at which to construct and apply age-length keys ("division" [default], "strat" or "set"). Finally, strat_data_fun and strat_means_fun allow users to supply custom functions for processing the simulated data and calculating stratified means, respectively; the built in functions strat_data and strat_means are supplied by default. RMSE of the stratified estimates from run_strat can then be calculated using the strat_error function. Results and error of a stratified analysis of one survey over a population are obtained using the following code (using default values):
<disp-formula id="pone.0232822.e031"><graphic xlink:href="pone.0232822.e031.jpg" id="pone.0232822.e031g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>The returned object will include all the objects accumulated through the sim_abundance to strat_error. The run_strat function adds three data.tables called total_strat, length_strat and age_strat that include stratified estimates of total abundance, abundance at length, and abundance at age, respectively. To this, strat_error adds data.tables ending with _strat_error or _strat_error_stats. The _strat_error objects simply contain stratified estimates of abundance (column named I_hat) with corresponding true values of abundance available to the survey (column named I) and the strat_error_stats data.frame includes metrics of mean error (ME), mean absolute error (MAE), mean-squared error (MSE), and root-mean-squared error (RMSE).</p>
  </sec>
  <sec id="sec012">
    <title>test_surveys</title>
    <p>Assuming a stratified analysis as the default method for obtaining an index of abundance, a series of survey protocols can be tested using the test_surveys function. Provided a simulated population from sim_distribution and a series of survey protocols from expand_surveys, this function will simulate and analyze data from each survey using the sim_survey, run_strat, and strat_error functions. Like sim_survey_parallel, this function operates in parallel and allows the specification of n_sims and n_loops, and the product of these two arguments equals the number of times each survey is simulated. Keep in mind that low numbers of n_sims and high numbers of n_loops will be less demanding on RAM, but may be slower, especially if the work is spread across few cores. Because most of the default settings of the functions match the case study settings, the code below will replicate the results from our case study (see <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref> for more detail). The expand_surveys function sets up a series of 175 surveys to test (i.e. all possible combinations of the set_den, lengths_cap and ages_cap vectors) and the test_surveys function will run 1000 simulations of each survey and compare stratified estimates of abundance to the true abundance available to the survey. While test_surveys is set-up for testing key sampling effort settings (set_den, lengths_cap, and ages_cap), other options can be assessed using independent calls of test_surveys as it accepts several arguments from sim_survey (q, trawl_dim, min_sets, age_sampling, age_length_group, and age_space_group) and run_strat (length_group and alk_scale).
<disp-formula id="pone.0232822.e032"><graphic xlink:href="pone.0232822.e032.jpg" id="pone.0232822.e032g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>Processing time will be system (i.e. amount of RAM and number of cores) and setting (i.e. n_loops and n_sims ratio) dependent. The test_survey function will print a progress bar, generated using the <bold>progress</bold> package [<xref rid="pone.0232822.ref032" ref-type="bibr">32</xref>], which details percent completion and will also include an estimate time of arrival (eta) after the first step of the loop completes. The test_surveys function therefore includes an option for exporting intermediate results to a local directory, via the export_dir argument, and the resume_test function can be used to resume a test_surveys run that had to be stopped part way through the process. The final object produced will be a list that includes all objects from sim_abundance and sim_distribution with the table of survey designs tested (named surveys) and tables produced by strat_error that end with the names _strat_error and _strat_error_stats. These tables include a survey column to allow merging of the survey protocol table with the error tables. Objects produced by sim_survey (set and sampling details) and run_strat (full stratified analysis results) are not retained to minimize object size.</p>
    <p>Like other core functions, some convenience functions are included in <bold>SimSurvey</bold> for creating interactive plots of the results from test_surveys. For instance a series of plotting functions ending in _fan produces fan charts where stratified estimates of abundance from each simulated survey are converted into a series of quantiles to depict the probability that estimates fall within a particular range. True values of abundance available to the survey are overlaid on the series of probability envelopes. These plots help visually assess the level of precision and bias from a specific set of survey protocol; ideally, the probability envelopes will be tightly centered around the true values. The three lines of code below will produce interactive fan charts for stratified estimates of total abundance, abundance at length and abundance at age, respectively (e.g. Figs <xref ref-type="fig" rid="pone.0232822.g005">5</xref>, <xref ref-type="fig" rid="pone.0232822.g006">6</xref> and <xref ref-type="fig" rid="pone.0232822.g007">7</xref>).
<disp-formula id="pone.0232822.e033"><graphic xlink:href="pone.0232822.e033.jpg" id="pone.0232822.e033g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Fan chart of stratified estimates of the trend in total abundance from surveys with different set densities, <italic>D</italic><sub>sets</sub>.</title>
        <p>The thick black line indicates the true trend in the total population available to the survey and the yellow to purple color gradient represents a range of probability envelopes from 10% to 90%. This plot is a facet of plots produced by plot_total_strat_fan when supplied results from test_surveys.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g005"/>
    </fig>
    <fig id="pone.0232822.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>Fan chart of stratified estimates of abundance at length from year seven of the simulation from surveys with different set densities, <italic>D</italic><sub>sets</sub>, and the maximum number of length samples, <italic>M</italic><sub>lengths</sub>.</title>
        <p>The thick black line indicates the true trend in the total population available to the survey and the yellow to purple color gradient represents a range of probability envelopes from 10% to 90%. This plot is a facet of plots produced by plot_total_strat_fan when supplied results from test_surveys.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g006"/>
    </fig>
    <fig id="pone.0232822.g007" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g007</object-id>
      <label>Fig 7</label>
      <caption>
        <title>Fan chart of stratified estimates of abundance at age from year seven of the simulation from surveys with different set densities, <italic>D</italic><sub>sets</sub>, and the maximum number of length samples, <italic>M</italic><sub>lengths</sub>.</title>
        <p>Number of ages sampled per length group, <italic>M</italic><sub>ages</sub>, was 10 in all scenarios. The thick black line indicates the true trend in the total population available to the survey and the yellow to purple color gradient represents a range of probability envelopes from 10% to 90%. This plot is a facet of plots produced by plot_total_strat_fan when supplied results from test_surveys.</p>
      </caption>
      <graphic xlink:href="pone.0232822.g007"/>
    </fig>
    <p>The relative performance of the surveys tested can be compared using plot_survey_rank and plot_error_surface. The plot_survey_rank function produces a divergent dot plot of the results which ranks the surveys by RMSE, where lower values indicate sampling strategies that minimize bias and maximize precision. Using the which_strat argument, the plot can be focused on total, length or age based stratified results (<xref ref-type="fig" rid="pone.0232822.g008">Fig 8</xref>). The plot_error_surface displays the age based stratified results by plotting a surface of RMSE (z-axis) by set (drop down selection), length (y-axis), and age (z-axis) sampling effort. The sampling effort axes can be rule or sample size based (plot_by = "rule" or plot_by = "samples", respectively; <xref ref-type="fig" rid="pone.0232822.g009">Fig 9</xref>).
<disp-formula id="pone.0232822.e034"><graphic xlink:href="pone.0232822.e034.jpg" id="pone.0232822.e034g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <fig id="pone.0232822.g008" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g008</object-id>
      <label>Fig 8</label>
      <caption>
        <title>Divergent dot plot of the precision and accuracy (root-mean-squared error; RMSE) of length based stratified estimates of abundance, and total sampling effort (number of sets [<italic>N</italic><sub>sets</sub>] and length measurements [<italic>N</italic><sub>measured</sub>]), under various sampling protocols (set density [<italic>D</italic><sub>sets</sub>] and maximum number of lengths measured per set [<italic>M</italic><sub>lengths</sub>]).</title>
        <p>Records are ranked by lowest to highest RMSE score. Within each plot, a yellow to purple color gradient is applied from lowest to highest value as an additional visual aid. Note that the exponent format of the axes defaults to SI unit symbols (e.g. M for million).</p>
      </caption>
      <graphic xlink:href="pone.0232822.g008"/>
    </fig>
    <fig id="pone.0232822.g009" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g009</object-id>
      <label>Fig 9</label>
      <caption>
        <title>Surface plots of root-mean-squared error (RMSE) from an array of surveys with different sampling protocol.</title>
        <p>Panels represent surveys with different set densities (<italic>D</italic><sub>sets</sub>), x-axes represent the maximum sampling effort of lengths per set (<italic>M</italic><sub>lengths</sub>), and y-axes represent the maximum number of ages to collect per length group (<italic>M</italic><sub>ages</sub>). This plot is a facet of plots produced by plot_error_surface when supplied results from test_surveys. Note that RMSE scales are different across <italic>D</italic><sub>sets</sub> panels. Note that the exponent format of the axes defaults to SI unit symbols (e.g. M for million).</p>
      </caption>
      <graphic xlink:href="pone.0232822.g009"/>
    </fig>
  </sec>
  <sec id="sec013">
    <title>Interpretation</title>
    <p>Results shown in the <bold>Core functions</bold> section demonstrates one use of the <bold>SimSurvey</bold> package that is focused on evaluating the efficacy of increasing the sampling effort of a stratified random survey of a cod population (see <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref> for details). These results largely align with expectations from sampling theory that 1) design-based estimators for stratified random surveys are unbiased, and 2) precision is increased by increasing the number of primary sampling units [<xref rid="pone.0232822.ref033" ref-type="bibr">33</xref>]. Specifically, estimates of total abundance and abundance at length are centered around true values and their probability envelopes tighten as set density increases (Figs <xref ref-type="fig" rid="pone.0232822.g005">5</xref> and <xref ref-type="fig" rid="pone.0232822.g006">6</xref>). Our case study results also echo the growing body of literature which concludes that extra sub-sampling is an ineffective means of improving estimates relative to sampling more locations [<xref rid="pone.0232822.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0232822.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0232822.ref034" ref-type="bibr">34</xref>–<xref rid="pone.0232822.ref036" ref-type="bibr">36</xref>]. This is exemplified by the relatively large drops in RMSE when set density is increased compared to when sub-sampling effort is increased (Figs <xref ref-type="fig" rid="pone.0232822.g008">8</xref> and <xref ref-type="fig" rid="pone.0232822.g009">9</xref>). Moreover, it appears that it is more advantageous to measure fewer total fish at more locations than measuring many fish at fewer locations (<xref ref-type="fig" rid="pone.0232822.g008">Fig 8</xref>). Again, this result was expected because the size-structured spatial clustering imposed by the simulation causes set-to-set variation to be greater than within-set variation in characteristics such as length and age. This structure was imposed because fish caught together tend to have similar characteristics and it is well known that this reduces the effective sample size [<xref rid="pone.0232822.ref010" ref-type="bibr">10</xref>]. Increasing sub-sampling effort, however, should not lead to poorer population estimates like those observed for abundance at age (Figs <xref ref-type="fig" rid="pone.0232822.g007">7</xref> and <xref ref-type="fig" rid="pone.0232822.g009">9</xref>). Bias, in particular, appears to be a problem with stratified estimates of abundance at age under certain scenarios (<xref ref-type="fig" rid="pone.0232822.g007">Fig 7</xref>); in contrast, there appears to be little bias in the stratified estimates of abundance at length (<xref ref-type="fig" rid="pone.0232822.g006">Fig 6</xref>). This result was unexpected as these estimates of abundance at age were presumed to be unbiased. The contrast between the length and age based analysis indicates that the problem lies with the intervening age-length-key.</p>
    <p>Age-length keys have long been used in conjunction with length frequency tables to estimate the age distribution of fish populations over large scales [<xref rid="pone.0232822.ref037" ref-type="bibr">37</xref>]. By default, sim_survey spreads length-stratified age sampling across the division and run_strat constructs and applies age-length keys at the division scale. This default was chosen because it is standard protocol for the actual survey the case study is based on. There is, however, a potential cost to the spatial scale of the key. Namely, it is unlikely that one age-length key is representative for the whole region as the probability of being a specific age given length varies in space [<xref rid="pone.0232822.ref038" ref-type="bibr">38</xref>]. Because different age groups sometimes occur in different places, the translation of lengths to ages may be biased by the samples used to generate the age-length key. In short, multi-stage sampling of a clustered population violates the assumption that the age-length key is generated from a simple random sample [<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>]. Bias introduced by this assumption can be resolved by explicitly accounting for the hierarchical sampling by using designed-based estimators [<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>]. For the case study, a proper design-based estimator will need to account for cluster sampling in a stratified random survey. Following recommendations in Aanes and Vølstad [<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>], we used <bold>SimSurvey</bold> to 1) conduct a survey with concurrent length and age sampling at every set, 2) construct and apply age-length keys on a set-by-set basis, and 3) weight the resultant age frequencies at each set using stratified random estimators. This test was accomplished using this code:
<disp-formula id="pone.0232822.e035"><graphic xlink:href="pone.0232822.e035.jpg" id="pone.0232822.e035g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>This is a minor modification of the code used in the <bold>test_surveys</bold> section whereby the same simulated population was used (pop object) but set density scenarios were reduced to one option for simplicity, and age sampling protocol and stratified analysis options were changed. That is, 1) age_length_group and age_space_group were changed to simulate a survey that conducts concurrent length and age sampling at every set (e.g. collect age samples from a maximum of 1 fish per 3 cm length group per set), 2) alk_scale was changed to "set" to construct and apply age-length keys on a set-by-set basis, and 3) the resultant age frequencies at each set are weighted accordingly using the design-based estimators built into run_strat. Again, results are visualized using plot_age_strat_fan and plot_error_surface:
<disp-formula id="pone.0232822.e036"><graphic xlink:href="pone.0232822.e036.jpg" id="pone.0232822.e036g" mimetype="image" position="anchor" orientation="portrait"/></disp-formula></p>
    <p>Unlike the default approach to collecting and analyzing age samples, results from this test appear to be unbiased and additional sub-sampling effort beyond a certain point appears to have little to no effect on the estimates (<xref ref-type="fig" rid="pone.0232822.g010">Fig 10</xref>). This is an important result with real-world implications as they imply that 1) inference from the actual survey can be improved by altering the sampling and analysis of ages and, 2) valuable survey time can be saved by cutting back on sub-sampling effort. This example demonstrates how <bold>SimSurvey</bold> can be used to reveal problems and explore solutions to the sampling designs of fisheries-independent surveys.</p>
    <fig id="pone.0232822.g010" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0232822.g010</object-id>
      <label>Fig 10</label>
      <caption>
        <title>Main results from an alternative design-based sampling and analysis procedure that accounts for multi-stage cluster sampling of ages.</title>
        <p>Specifically, a) is a fan chart of stratified estimates of abundance at age from year seven of the simulation from a survey with a set density (<italic>D</italic><sub>sets</sub>) of 0.002 sets / km<sup>2</sup>, maximum number of length samples (<italic>M</italic><sub>lengths</sub>) of 100, and maximum number of age samples per 3 cm length group per set (<italic>M</italic><sub>ages</sub>) (the thick black line indicates the true trend in the total population available to the survey and the yellow to purple color gradient represents a range of probability envelopes from 10% to 90%); and b) is a surface plot of root-mean-squared error (RMSE) from an array of surveys with set density (<italic>D</italic><sub>sets</sub>) fixed to 0.002 sets / km<sup>2</sup> but different sub-sampling effort, where the x-axes represent the maximum number of lengths to measure per set (<italic>M</italic><sub>lengths</sub>), and y-axes represent the maximum number of ages to collect per 3 cm length group per set (<italic>M</italic><sub>ages</sub>).</p>
      </caption>
      <graphic xlink:href="pone.0232822.g010"/>
    </fig>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Discussion</title>
    <p>Though somewhat narrow in scope, results from our case study demonstrate why it is important to evaluate the design and analysis of complex surveys. Specifically, we tested the design and analysis of a multi-staged stratified random survey of a cod population. This type of sampling is common in fisheries research, however, the clustered nature of the samples are rarely taken into consideration [<xref rid="pone.0232822.ref009" ref-type="bibr">9</xref>]. Instead, it is commonly assumed that individuals are randomly drawn from the target populations even though such sampling is virtually impossible to accomplish in practice. The assumption of simple random sampling implies that the characteristics of fish caught at the same location are independent and, if estimators that assume independence are used, this can introduce bias and underestimate variance [<xref rid="pone.0232822.ref009" ref-type="bibr">9</xref>,<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>]. Moreover, this assumption may contribute to the perception that more sub-samples will lead to better population estimates. Increasing sub-sampling effort, however, has been shown to be an ineffective means of improving estimates because samples at the same location are usually correlated; the best way to increase the number of independent samples is to sample more locations [<xref rid="pone.0232822.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0232822.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0232822.ref034" ref-type="bibr">34</xref>–<xref rid="pone.0232822.ref036" ref-type="bibr">36</xref>]. Results from the case study reiterate these points and indicate that there is room for improvements to the actual survey the case study was based on. Specifically, it appears that valuable human resources may be wasted by collecting excessive samples of correlated metrics, and abundance at age estimates may be biased by the assumption that age samples are from a simple random sample. We have used <bold>SimSurvey</bold> to identify solutions to these problems and, given current results, we suggest that time can be saved by decreasing sub-sampling effort and bias can be reduced by using an approach that account for the hierarchical design of the survey.</p>
    <sec id="sec015">
      <title>Research opportunities</title>
      <p>The case study used here provides one example of how <bold>SimSurvey</bold> can be used to simulation test the design of fisheries-independent trawl surveys. Default settings can, of course, be modified to emulate data from an array of different surveys of different populations (see <xref ref-type="supplementary-material" rid="pone.0232822.s002">S2 Appendix</xref> for guidance on how to modify default settings to suit specific needs). The package therefore facilitates the exploration of a range of research questions. Below we outline some examples where the <bold>SimSurvey</bold> package may aid future research efforts.</p>
      <sec id="sec016">
        <title>Design or model-based approach</title>
        <p>The analysis of data from fisheries-independent surveys have generally been confined to design-based mean and variance estimates of abundance using standard formulae (e.g. [<xref rid="pone.0232822.ref033" ref-type="bibr">33</xref>]). Nevertheless, there has long been interest in using model-based approaches to improve abundance estimates (e.g. [<xref rid="pone.0232822.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0232822.ref039" ref-type="bibr">39</xref>,<xref rid="pone.0232822.ref040" ref-type="bibr">40</xref>]). <bold>SimSurvey</bold> can serve as a convenient tool for simulation testing mean and variance estimates provided by a range of different approaches (design-based analyses, bootstrap estimates, generalized additive models, geostatistical models, etc.). Moreover, the full analytical pathway for obtaining age-disaggregated estimates of abundance has rarely been simulation tested. Existing and future approaches for calculating age-based indices of abundance can be simulation tested using <bold>SimSurvey</bold>.</p>
      </sec>
      <sec id="sec017">
        <title>Growth analyses</title>
        <p>Assessing ages for a large number of fish is very time-consuming and, as such, length-stratified sampling is often used to estimate age frequencies of fish populations. The resultant sub-sample is used to construct an age-length key (i.e. the probability a fish is a specific age given length) and age frequencies are obtained by applying this key to length-frequencies obtained via more expansive random sampling. One age-length key is typically assumed to be representative of the whole stock area, however, spatial variability in the relationship may introduce bias in abundance-at-age estimates [<xref rid="pone.0232822.ref021" ref-type="bibr">21</xref>,<xref rid="pone.0232822.ref038" ref-type="bibr">38</xref>]. Results from the case study (see <xref ref-type="supplementary-material" rid="pone.0232822.s001">S1 Appendix</xref>) reiterate this point and <bold>SimSurvey</bold> may serve as a platform for testing potential model-based solutions to this problem (e.g. [<xref rid="pone.0232822.ref038" ref-type="bibr">38</xref>]).</p>
      </sec>
      <sec id="sec018">
        <title>Random or stratified sampling</title>
        <p><bold>SimSurvey</bold> can be used to compare the precision and bias of population estimates obtained using random or stratified sampling. Simple random sampling can be implemented using a grid with one strata (e.g. make_grid(depth_range = c(0, 1000), strat_breaks = c(0, 1000), strat_split = 0)). Sub-sampling of ages can also be random rather than length-stratified by setting the age_sampling argument in the sim_survey function to "random" rather than "stratified". This can facilitate research similar to work presented in Puerta et al. [<xref rid="pone.0232822.ref015" ref-type="bibr">15</xref>].</p>
      </sec>
    </sec>
    <sec id="sec019">
      <title>Future directions</title>
      <p>Up to now, the package has focused on the effects of sampling design on the precision and bias of population estimates obtained from fisheries-independent surveys; however, the costs associated with sampling has yet to be considered. In future iterations of <bold>SimSurvey</bold>, we hope to add options for integrating data on the time and monetary costs associated with each level of sampling (sets, length measurements, age determination) to facilitate cost-benefit analyses. We also realize that a single fisheries-independent survey may have multiple goals as data obtained are often used to assess multiple species or to conduct community analyses. We will therefore endeavor to add functions for simulating multi-species surveys. Another limitation of the package is that we have yet to implement alternatives to random or stratified random survey designs (e.g. systematic sampling); expanding these options would allow for a more comprehensive evaluations of various designs. Finally, it would be useful to add an option for testing the consequences of surveys with partial coverage of a population as survey coverage is a frequent concern in stock assessment.</p>
    </sec>
    <sec id="sec020">
      <title>Assumptions</title>
      <p>Like any model, this simulation is a simplification of a much more complex reality. For instance, the population is assumed to aggregate by age-class and be uniformly distributed within a cell, instead fish may aggregate by length and form finer-scale clusters. The survey is also an instantaneous snapshot of the population, meaning that the population is assumed to be in the same location from the beginning to the end of the survey. Also, fish are aged at random within length bins and ages are estimated without error. Finally, area trawled is assumed to be perfectly standard. These assumptions, plus a range of others, will surely under-represent the natural variability of fish populations and survey protocol. Nevertheless, the <bold>SimSurvey</bold> package provides a relatively complex and flexible operating model for simulating survey data from a population that varies across age, year and space dimensions.</p>
    </sec>
    <sec id="sec021">
      <title>Summary</title>
      <p>The <bold>SimSurvey</bold> package serves as a tool for simulating sample surveys of dynamic populations that vary across ages, time and space. The core of the simulation is based on the widely used cohort equation and, even though the processes that define recruitment and total mortality are simple, a wide range of stock dynamics can be simulated by changing a few parameters. This base population can then be distributed through a grid and relationships with depth and correlation across ages, years and space can be defined. Together, two functions (sim_abundance and sim_distribution) are capable of simulating a wide range of populations with different life histories, depth associations and spatial properties. The next step to generating data similar to actual observations is to conduct a survey. In this package we implement a function, sim_survey, that conducts a survey of the population. The sampling process is governed by the area covered by the trawl as well as age-specific catchability. Sub-sampling protocol (length and age sampling) can also be varied. As such, data from a wide range of surveys can be simulated.</p>
      <p>A large number of statistical models can be tested using these simulated data, but, implementing a variety of analytical approaches was outside the scope of this package. Instead we focus on analyzing simulated stratified-random survey data using a design-based stratified analysis. A stratified analysis is facilitated using the run_strat function and the precision and accuracy of the results (e.g. RMSE) can be calculated using strat_error. This is a simple and widely-used analysis, and the speed at which it runs allows for a wide range of survey designs to be tested, via the test_surveys function, in a reasonable time-frame.</p>
      <p>Simulation testing is an important tool in the field of fisheries science as the inferred status of fish stocks hinge on the data and models used to assess fish populations. Simulations provide an opportunity to explore survey and model performance, and such explorations are becoming increasingly important as model complexity increases. It is also important to continually assess the efficacy and efficiency of sampling programs given their costs and the constant scrutiny of the value added by such surveys. These are some of the reasons multiple simulation frameworks, including <bold>SimSurvey</bold>, have been developed to test the design and analyses of complex surveys. We have made <bold>SimSurvey</bold> as open and accessible as possible to allow the broader community to validate, reuse and improve this package. We hope that open-source sharing will extend the value of such simulation frameworks and we encourage users to extend the package for their own needs and contribute to future versions.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0232822.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Case study.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0232822.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232822.s002">
      <label>S2 Appendix</label>
      <caption>
        <title>Parameterisation.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0232822.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232822.s003">
      <label>S3 Appendix</label>
      <caption>
        <title>Age-year-space covariance.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0232822.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232822.s004">
      <label>S4 Appendix</label>
      <caption>
        <title>Stratified analysis equations.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0232822.s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232822.s005">
      <label>S5 Appendix</label>
      <caption>
        <p>(HTML)</p>
      </caption>
      <media xlink:href="pone.0232822.s005.html">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0232822.s006">
      <label>S1 Fig</label>
      <caption>
        <p>(PNG)</p>
      </caption>
      <media xlink:href="pone.0232822.s006.png">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work has benefited from valuable feedback from numerous colleagues, including Aaron Adamack, Alejandro Buren, Noel Cadigan, Karen Dwyer, Geoff Evans, Paul Higdon, Danny Ings, Mariano Koen-Alonso, Joanne Morgan, Derek Osborne, Pierre Pepin, Dwayne Pittman, Don Power, Craig Purchase, Martha Robertson, Mark Simpson, Brad Squires, Don Stansbury and Peter Upward. We also thank Dave Cote and Joanne Morgan for providing constructive comments on a previous version of this manuscript. Finally, the package and the manuscript were greatly improved by feedback from editor Daniel Duplisea and two anonymous reviewers. This work was supported by the NSERC visiting-fellow program and Fisheries and Oceans Canada.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0232822.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fienberg</surname><given-names>SE</given-names></name>, <name><surname>Tanur</surname><given-names>JM</given-names></name>. <article-title>Reconsidering the fundamental contributions of Fisher and Neyman on experimentation and sampling</article-title>. <source>International Statistical Review</source>. <year>1996</year>; <fpage>237</fpage>–<lpage>253</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Nichols</surname><given-names>JD</given-names></name>, <name><surname>Williams</surname><given-names>BK</given-names></name>. <article-title>Monitoring for conservation</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2006</year>;<volume>21</volume>: <fpage>668</fpage>–<lpage>673</lpage>.<pub-id pub-id-type="pmid">16919361</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>J</given-names></name>, <name><surname>Kitchens</surname><given-names>WM</given-names></name>, <name><surname>Hines</surname><given-names>JE</given-names></name>. <article-title>Importance of well-designed monitoring programs for the conservation of endangered species: Case study of the snail kite</article-title>. <source>Conservation Biology</source>. <year>2007</year>;<volume>21</volume>: <fpage>472</fpage>–<lpage>481</lpage>. <?supplied-pmid 17391197?><pub-id pub-id-type="pmid">17391197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>SP</given-names></name>, <name><surname>Clark</surname><given-names>JA</given-names></name>, <name><surname>Crampton</surname><given-names>LH</given-names></name>, <name><surname>Guerry</surname><given-names>AD</given-names></name>, <name><surname>Hatch</surname><given-names>LT</given-names></name>, <name><surname>Hosseini</surname><given-names>PR</given-names></name>, <etal>et al</etal><article-title>An assessment of monitoring efforts in endangered species recovery plans</article-title>. <source>Ecological Applications</source>. <year>2002</year>;<volume>12</volume>: <fpage>674</fpage>–<lpage>681</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Sutherland</surname><given-names>WJ</given-names></name>. <article-title>Sustainable exploitation: A review of principles and methods</article-title>. <source>Wildlife Biology</source>. <year>2001</year>;<volume>7</volume>: <fpage>131</fpage>–<lpage>140</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Reynolds</surname><given-names>JH</given-names></name>, <name><surname>Thompson</surname><given-names>WL</given-names></name>, <name><surname>Russell</surname><given-names>B</given-names></name>. <article-title>Planning for success: Identifying effective and efficient survey designs for monitoring</article-title>. <source>Biological Conservation</source>. <year>2011</year>;<volume>144</volume>: <fpage>1278</fpage>–<lpage>1284</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pennington</surname><given-names>M</given-names></name>, <name><surname>Strømme</surname><given-names>T</given-names></name>. <article-title>Surveys as a research tool for managing dynamic stocks</article-title>. <source>Fisheries Research</source>. <year>1998</year>;<volume>37</volume>: <fpage>97</fpage>–<lpage>106</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Rose</surname><given-names>GA</given-names></name>, <name><surname>Kulka</surname><given-names>DW</given-names></name>. <article-title>Hyperaggregation of fish and fisheries: How catch-per-unit-effort increased as the northern cod (<italic>Gadus morhua</italic>) declined</article-title>. <source>Canadian Journal of Fisheries and Aquatic Sciences</source>. <year>1999</year>;<volume>56</volume>: <fpage>118</fpage>–<lpage>127</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Nelson</surname><given-names>GA</given-names></name>. <article-title>Cluster sampling: a pervasive, yet little recognized survey design in fisheries research</article-title>. <source>Transactions of the American Fisheries Society</source>. <year>2014</year>;<volume>143</volume>: <fpage>926</fpage>–<lpage>938</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Pennington</surname><given-names>M</given-names></name>, <name><surname>Vølstad</surname><given-names>JH</given-names></name>. <article-title>Assessing the effect of intra-haul correlation and variable density on estimates of population characteristics from marine surveys</article-title>. <source>Biometrics</source>. <year>1994</year>;<volume>50</volume>: <fpage>725</fpage>–<lpage>732</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Pennington</surname><given-names>M</given-names></name>, <name><surname>Burmeister</surname><given-names>L-M</given-names></name>, <name><surname>Hjellvik</surname><given-names>V</given-names></name>. <article-title>Assessing the precision of frequency distributions estimated from trawl-survey samples</article-title>. <source>Fisheries Bulletin</source>. <year>2002</year>;<volume>100</volume>: <fpage>74</fpage>–<lpage>80</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Stewart</surname><given-names>IJ</given-names></name>, <name><surname>Hamel</surname><given-names>OS</given-names></name>, <name><surname>Rose</surname><given-names>K</given-names></name>. <article-title>Bootstrapping of sample sizes for length- or age-composition data used in stock assessments</article-title>. <source>Canadian Journal of Fisheries &amp; Aquatic Sciences</source>. <year>2014</year>;<volume>71</volume>: <fpage>581</fpage>–<lpage>588</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>L</given-names></name>, <name><surname>Buckland</surname><given-names>ST</given-names></name>, <name><surname>Rexstad</surname><given-names>EA</given-names></name>, <name><surname>Laake</surname><given-names>JL</given-names></name>, <name><surname>Strindberg</surname><given-names>S</given-names></name>, <name><surname>Hedley</surname><given-names>SL</given-names></name>, <etal>et al</etal><article-title>Distance software: Design and analysis of distance sampling surveys for estimating population size</article-title>. <source>Journal of Applied Ecology</source>. <year>2010</year>;<volume>47</volume>: <fpage>5</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-2664.2009.01737.x</pub-id><?supplied-pmid 20383262?><pub-id pub-id-type="pmid">20383262</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Schnute</surname><given-names>JT</given-names></name>, <name><surname>Haigh</surname><given-names>R</given-names></name>. <article-title>A simulation model for designing groundfish trawl surveys</article-title>. <source>Canadian Journal of Fisheries and Aquatic Sciences</source>. <year>2003</year>;<volume>60</volume>: <fpage>640</fpage>–<lpage>656</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Puerta</surname><given-names>P</given-names></name>, <name><surname>Ciannelli</surname><given-names>L</given-names></name>, <name><surname>Johnson</surname><given-names>B</given-names></name>. <article-title>A simulation framework for evaluating multi-stage sampling designs in populations with spatially structured traits</article-title>. <source>PeerJ</source>. <year>2019</year>;<volume>7</volume>: <fpage>e6471</fpage><pub-id pub-id-type="doi">10.7717/peerj.6471</pub-id><?supplied-pmid 30828489?><pub-id pub-id-type="pmid">30828489</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Cadigan</surname><given-names>NG</given-names></name>. <article-title>A state-space stock assessment model for northern cod, including under-reported catches and variable natural mortality rates</article-title>. <source>Canadian Journal of Fisheries and Aquatic Sciences</source>. <year>2016</year>;<volume>73</volume>: <fpage>296</fpage>–<lpage>308</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Von Bertalanffy</surname><given-names>L</given-names></name>. <article-title>A quantitative theory of organic growth (inquiries on growth laws. II)</article-title>. <source>Human biology</source>. <year>1938</year>;<volume>10</volume>: <fpage>181</fpage>–<lpage>213</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Blangiardo</surname><given-names>M</given-names></name>, <name><surname>Cameletti</surname><given-names>M</given-names></name>. <source>Spatial and spatio-temporal bayesian models with R-INLA</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Thorson</surname><given-names>JT</given-names></name>, <name><surname>Shelton</surname><given-names>AO</given-names></name>, <name><surname>Ward</surname><given-names>EJ</given-names></name>, <name><surname>Skaug</surname><given-names>HJ</given-names></name>. <article-title>Geostatistical delta-generalized linear mixed models improve precision for estimated abundance indices for West Coast groundfishes</article-title>. <source>ICES Journal of Marine Science</source>. <year>2015</year>;<volume>72</volume>: <fpage>1297</fpage>–<lpage>1310</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">Smith S, Somerton G. STRAP: A User-Oriented Computer Analysis System for Groundfish Research Trawl Survey Data. Canadian Technical Report of Fisheries; Aquatic Sciences No. 1030; 1981. p. 66.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Aanes</surname><given-names>S</given-names></name>, <name><surname>Vølstad</surname><given-names>JH</given-names></name>. <article-title>Efficient statistical estimators and sampling strategies for estimating the age composition of fish</article-title>. <source>Canadian Journal of Fisheries and Aquatic Science</source>. <year>2015</year>;<volume>72</volume>: <fpage>938</fpage>–<lpage>953</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing [Internet]. Vienna, Austria: R Foundation for Statistical Computing; 2017. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Dowle M, Srinivasan A. Data.table: Extension of ‘data.frame‘ [Internet]. 2017. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref024">
      <label>24</label>
      <mixed-citation publication-type="other">Hijmans RJ. Raster: Geographic data analysis and modeling [Internet]. 2016. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Sievert C. Plotly for R [Internet]. 2018. <ext-link ext-link-type="uri" xlink:href="https://plotly-book.cpsievert.me">https://plotly-book.cpsievert.me</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Wickham H. Advanced R. Chapman; Hall/CRC; 2014.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Schlather M, Malinowski A, Oesting M, Boecker D, Strokorb K, Engelke S, et al. RandomFields: Simulation and analysis of random fields [Internet]. 2020. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=RandomFields">https://cran.r-project.org/package=RandomFields</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Rue</surname><given-names>H</given-names></name>, <name><surname>Martino</surname><given-names>S</given-names></name>, <name><surname>Chopin</surname><given-names>N</given-names></name>. <article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2009</year>;<volume>71</volume>: <fpage>319</fpage>–<lpage>392</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Bache SM, Wickham H. Magrittr: A forward-pipe operator for r [Internet]. 2014. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref030">
      <label>30</label>
      <mixed-citation publication-type="other">Cheng J. Crosstalk: Inter-widget interactivity for html widgets [Internet]. 2016. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=crosstalk">https://CRAN.R-project.org/package=crosstalk</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Revolution Analytics, Weston S. DoParallel: Foreach parallel adaptor for the ‘parallel’ package [Internet]. 2015. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=doParallel">https://CRAN.R-project.org/package=doParallel</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref032">
      <label>32</label>
      <mixed-citation publication-type="other">Csárdi G, FitzJohn R. Progress: Terminal progress bars [Internet]. 2016. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=progress">https://CRAN.R-project.org/package=progress</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0232822.ref033">
      <label>33</label>
      <mixed-citation publication-type="book"><name><surname>Cochran</surname><given-names>WG</given-names></name>. <source>Sampling techniques</source>. <edition designator="3">3rd ed</edition><publisher-name>John Wiley &amp; Sons</publisher-name>; <year>1977</year> p. <fpage>428</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Bogstad</surname><given-names>B</given-names></name>, <name><surname>Pennington</surname><given-names>M</given-names></name>, <name><surname>Vølstad</surname><given-names>JH</given-names></name>. <article-title>Cost-efficient survey designs for estimating food consumption by fish</article-title>. <source>Fisheries Research</source>. <year>1995</year>;<volume>23</volume>: <fpage>37</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Coggins</surname><given-names>LG</given-names></name>, <name><surname>Gwinn</surname><given-names>DC</given-names></name>, <name><surname>Allen</surname><given-names>MS</given-names></name>. <article-title>Evaluation of Age-Length Key Sample Sizes Required to Estimate Fish Total Mortality and Growth</article-title>. <source>Transactions of the American Fisheries Society</source>. <year>2013</year>;<volume>142</volume>: <fpage>832</fpage>–<lpage>840</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Cadrin</surname><given-names>SX</given-names></name>. <article-title>Estimating Effective Sample Size for Monitoring Length Distributions: A Comparative Study of Georges Bank Groundfish</article-title>. <source>Transactions of the American Fisheries Society</source>. <year>2013</year>;<volume>142</volume>: <fpage>59</fpage>–<lpage>67</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Fridriksson</surname><given-names>A</given-names></name>. <article-title>On the calculation of age-distribution within a stock of cod by means of relatively few age-determinations as a key to measurements on a large scale</article-title>. <source>Rapports Et Proces-Verbaux Des Reunions, Conseil International Pour l’Exploration De La Mer</source>. <year>1934</year>;<volume>86</volume>: <fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Berg</surname><given-names>CW</given-names></name>, <name><surname>Kristensen</surname><given-names>K</given-names></name>. <article-title>Spatial age-length key modelling using continuation ratio logits</article-title>. <source>Fisheries Research</source>. <year>2012</year>;<volume>129–130</volume>: <fpage>119</fpage>–<lpage>126</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>SJ</given-names></name>. <article-title>Use of statistical models for the estimation of abundance from groundfish trawl survey data</article-title>. <source>Canadian Journal of Fisheries and Aquatic Sciences</source>. <year>1990</year>;<volume>47</volume>: <fpage>894</fpage>–<lpage>903</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0232822.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Berg</surname><given-names>CW</given-names></name>, <name><surname>Nielsen</surname><given-names>A</given-names></name>, <name><surname>Kristensen</surname><given-names>K</given-names></name>. <article-title>Evaluation of alternative age-based methods for estimating relative abundance from survey data in relation to assessment models</article-title>. <source>Fisheries Research</source>. <year>2014</year>;<volume>151</volume>: <fpage>91</fpage>–<lpage>99</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0232822.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Daniel E. Duplisea</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Daniel E. Duplisea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Nov 2019</named-content>
    </p>
    <p>PONE-D-19-26904</p>
    <p>SimSurvey: an R package to optimize the design and analysis of fisheries surveys by simulating spatially-correlated fish stocks</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Regular,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>These two thorough reviews raise excellent points that should greatly improve the utility of the package if they can be addressed. Please consider each point particularly keeping in mind the research content of the manuscript beyond a description of the software.</p>
    <p>We would appreciate receiving your revised manuscript by Dec 28 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Daniel E. Duplisea, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>1. When submitting your revision, we need you to address these additional requirements.</p>
    <p>Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2.  Please include captions for your Supporting Information files at the end of your manuscript, and update any in-text citations to match accordingly. Please see our Supporting Information guidelines for more information: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/supporting-information">http://journals.plos.org/plosone/s/supporting-information</ext-link>.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: No</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: This paper describes the R package “SimSurvey” which is a package to test the design and analysis of fisheries independent surveys.</p>
    <p>I found the paper very interesting and the package of great potential value and interest to many fishery scientists. However, I have several comments that I would like the authors to address first before I recommend acceptance of this paper. My main comments relate to:</p>
    <p>1. Verify some of the equations and model description used in the model. I think that some of them lack description to fully understand what was done and few others are misleading, even incorrect. The detail can be found below but in general, they are linked to the problem of bias correction for log-normal distribution, re-scaling”, moving from abundance at age to abundance at length.</p>
    <p>2. Add additional explanation to justify the choices. E.g. why population dynamics is modeled independently of the spatial distribution. Is this reasonable, limitation, etc.</p>
    <p>3. Few suggestions (add-ons, renaming) to increase the generality of the paper (without requiring too much work)</p>
    <p>Detailed comments:</p>
    <p>Abstract:</p>
    <p>What about the flexibility to include new sampling strategies (user defined one) or including new estimation approaches</p>
    <p>Introduction:</p>
    <p>L43: quality of</p>
    <p>It would be good to add few references here e.g. L50,</p>
    <p>Method:</p>
    <p>L69-73: I think it would be good to add the reference to the specific function name listed in Table2. This way, I would be more explicit and avoid possible confusion. For example, in my case, when I first read the section header “simulate abundance”, I was expecting to see the way you dealt with the spatial distribution of abundance.</p>
    <p>L94&amp;95&amp;104: I just want to make sure that the bias correction has been applied to these two equations. If logN (or logZ) is normally distribution with mean mu and sigma, then the N (or Z) is lognormally distributed with mean exp(mu+sigma^2/2). Therefore, when you write “mean” in table 3 for R and Z, I hope that you modified in your actual equation for log(Z) to:</p>
    <p>log(Z) ~ normal(log(mean)-sigma^2/2, sigma)</p>
    <p>In other word, the mean(R) is not simply exp(meanR_log_scale). exp(meanR_log_scale) is the median of the distribution of R.</p>
    <p>L107: there is not enough description to understand how you converted the abundance at age to abundance at length. What were the choice of length bin groups? Every 5 cm, 10cm? Such information is also missing in the tables. Please add that. But then you have to calculate some cumulative distribution (until length l) for the length at age distribution (using the VB growth equation) and do some subtractions to be able to allocate the abundance at age to each length group.</p>
    <p>See equation A.1.14 in here for example. <ext-link ext-link-type="uri" xlink:href="https://www.nwfsc.noaa.gov/news/events/program_reviews/documents/C.2_Methot_Wetzel_SSTechnicalDescription.pdf">https://www.nwfsc.noaa.gov/news/events/program_reviews/documents/C.2_Methot_Wetzel_SSTechnicalDescription.pdf</ext-link></p>
    <p>“Simulate spatial distribution”:</p>
    <p>I have a few comments on this section:</p>
    <p>1. First of all, I think it is important to state that you assume that the population dynamic model and the spatial distribution is independent i.e. you do not have a spatially-explicit population dynamics model. And talk about what it means (is it realistic, limitation, etc).</p>
    <p>2. L161. I think it would be better to rename “depth” as “main covariate influencing the species distribution”. And “depth” happens to be one of them for many species, but there are cases when this is not the case.</p>
    <p>3. L161. I think it would be good to say upfront that there are two ways of defining the spatial structure. Using the function in the package or user defined</p>
    <p>4. L161: I think another possibility is to generate a random field by using the package “Randomfields” for example. This way you can generate a map where “depth” is patchily distributed (maybe more like an island type case study)</p>
    <p>5. L163-164: please add more description about the division or strata. How can we set it up and what do you specifically mean by division and strata? Is one nested within the other, or not necessarily? Your examples are based on Atlantic Ocean and people in other regions might not be familiar with how these divisions are created.</p>
    <p>6. L163: Why only focus on “depth-based strata”? I think it would be good to allow the user to choose their own stratification approach. It could be depth based as you did (which happens most often in surveys) but it could technically be any other thing (user supplied). This allows more flexibility.</p>
    <p>7. L167: the equation is misleading and I am not sure it is right based on what is written in the text. You mentioned later on L178: that you “re-scaled” so that the total number of fish in a specific year and age across space is equal to the single number from the population dynamics model. If so, the re-scaling should be done in the identify (natural) scale, not in log scale. In log scale, even if ,, sums to zero across space, the sum in the identity scale won’t match. This is often refer to as “bias correction” for the log normal models. And you should ideally show how the rescaling was done in terms of the equations too.</p>
    <p>8. L167: this “depth preference” function is very simplistic and gives only very “smooth” symmetric distribution. More often, fish have a skewed depth preference: often right-skewed.</p>
    <p>9. L173-174: I think it might be worth adding, in simpler terms, the meaning of the spatial smoothing and scaling parameters.</p>
    <p>10. L178: it is another question of scaling. How did you exactly do the scaling? In the identity scale? By dividing my the sum of the effects? I am asking this because depending on how you did the rescaling, your correlation structure in space and age might have been affected and is not the same as the one specified in L172. Did you verify that?</p>
    <p>Table 4. “group_ages”. Ok but how is the variance controlled for the other age classes?</p>
    <p>L189: “user supplied”. This is a good feature. However, I think it is important to mention here that user have to make sure that they use the correct projection method to ensure that each grid is of the same dimension.</p>
    <p>L216: reference to figure 3?</p>
    <p>L221: there is not “group_years” argument in Table 4.</p>
    <p>L237: “this function”. I think it would be better to replace “this function” with “sim_distribution” as you do not mention the word “sim_distribution” in the sentence above this.</p>
    <p>L158-251: In general, I think re-organising this section using sub-section headers could be useful. Just to guide the readers</p>
    <p>L254: you say that sampling is stratified random but SRS is also an option based on Table5. Please correct.</p>
    <p>L257: what does this mean? Does this control the number of set but how is this calculated?</p>
    <p>L257: I do not see how you control for the total number of set in the survey? How do you control it?</p>
    <p>L261: I think you should mention here that you can also force the sample size (as seen on table 5). Moreover, in table 5, it would be good to set-up a “ages_min” for the minimum number of ages to sample […]” so that it gives the ability to fix the sample size if needed by writing the same value for “ages_min” and “ages_cap”.</p>
    <p>L261: How are you making sure that the number of sampled fish for that specific cell, age and year won’t be above the total number of fish in that cell, age, and year? The probability value could be close to one and if you fish in a few a time, then you are at risk. Especially because your population dynamics model is not spatially explicit and is completely independent of the distribution function itself i.e. you can technically fish out all the fish in an area but it will be populated back the year after the way you implemented in this study… Maybe you need to put a condition (or just a note) for general users to make sure that this probability value is much below 1?</p>
    <p>L267: I recommend to clarify something here. 1. Depending on the number of fish caught? What do you mean? What is the rule you used? 2. The way you coded, sample by age is first decided, then the corresponding length is calculated, then age-subsample is determined. In reality, length sample is taken in the field, then age sub-samples are taken. While similar, I do not think it always equal. Especially, when you start including some correlation structure in the sampling. By the way, did you consider including some correlation structure in the sampling process to make more realistic?</p>
    <p>L275 Table 1 on should be table 5</p>
    <p>L275: Table5: “age_sammpling” should be “age_sampling”</p>
    <p>L275: “min_sets” you have not described it yet and what is it? You have sample from all cells? If no, this is not realistic.</p>
    <p>L279: Table5 not Table1?</p>
    <p>L285-286: Could you be more specific on how custom closures can be supplied and where?</p>
    <p>L306: how are these catchability corrected abundance matrices calculated? It is important to write this information somewhere (or write “please refer to the section “Stratified analysis” for further information on the calculation of abundance indices”) or something alike and Appendix S3.</p>
    <p>L336: I think it would be good to say that other methods exist and people can use it in this package (maybe)?</p>
    <p>L421: color gradient. Even though it is obvious it might be good to say green to purple gradient.</p>
    <p>L427: instead of “sampling protocol”, I think it would be more meaning full to say the maximum number of length samples.</p>
    <p>L452: say that the color ramps from yellow to purple</p>
    <p>S1 appendix: missing figure in S1</p>
    <p>Reviewer #2: This manuscript describes an R package called SimSurvey. The package includes a set of functions for simulating point-based fisheries survey designs, e.g. bottom trawl surveys, for estimating abundance indices. It focuses on number of stations and number of fish sampled ignores other constraints such as distance between stations and day-time duration which impose strong constraints on real surveys. The functions included allow the user to first simulate age-and length structured population dynamics, distribute individuals randomly in space (assuming a certain correlation structure), carry out a survey and finally calculate abundance indices from the simulated data. The package will likely be of interest to researchers wanting to explore the precision achievable with different survey designs. My comments regarding the package and the presentation are summarised below.</p>
    <p>1. Optimization</p>
    <p>The title announces a package for optimizing survey designs. As far as I can see the package does not allow survey design optimization, neither in terms of defining survey strata nor in terms of number of stations per stratum. The strata are defined by the user. The only option available for the number of stations is proportional to stratum surface; the user sets the minimum number of stations taken in the smallest stratum. It would be useful to be able to specify the total number of stations and test different allocation schemes, such as proportional to surface area (implemented), equal number per stratum, Neyman allocation (accounting for surface area and abundance variability), etc.</p>
    <p>Please consider revising the title (e.g. “compare” and instead of “optimize)” and spell out the available sampling design options.</p>
    <p>2. Manuscript structure</p>
    <p>The manuscript might be easier to follow if the manuscript was restructured: 1) Model description, 2) Using SimSurvey. The later section would then group all example code which could again be subdivided into running simulations and exploring results (plot functions).</p>
    <p>3. Parameterisation</p>
    <p>To use SimSurvey for a real world problem realistic parameter values are needed. The package comes with default values chosen for a particular case study. However, no mention is made in the manuscript how to choose appropriate values for the many model parameters to tailor the simulations to a population of interest. I suggest the authors add a section on parameterisation and a table summarizing all parameters with a column specifying how to parameterize. For example, parameters for population dynamics and growth could probably be taken from the literature (or a stock assessment report). However this is not possible for the parameters of the spatial distribution function sim_distribution() such as correlation between ages etc. Ideally the package would include a fitting function for estimating these parameters from actual data. These input data could come from a pilot survey and include location (lat, long) and numbers by length/age.</p>
    <p>Minor issues</p>
    <p>- line 93: I assume there is an age plus but this needs to be mentioned. Also, please specify how you set the initial numbers for plus group ().</p>
    <p>- line 121: I don’t understand the explanation of a closure. What do you mean by “return functions”? Do you mean it returns an object with different attributes?</p>
    <p>- line 125: the number of right and left brackets is unbalanced, please check</p>
    <p>- line 126 “This structure was chosen to avoid the repeated specifications of ages and years”. As far as I can see the example code only specifies years, not ages.</p>
    <p>- line 227 Please explain what a pipe is and how it is used. In the example I understand that the output of sim_abundance( ) is provided to (piped) into sim_distribution(). I am unclear what the object b contains. Is it the result of sim_distribution()?</p>
    <p>- There is no table 1, please revise table numbering.</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0232822.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">28 Dec 2019</named-content>
    </p>
    <p>Daniel E. Duplisea, PhD </p>
    <p>Fisheries and Oceans Canada </p>
    <p>850 Route de la Mer </p>
    <p>Mont‐Joli, Quebec </p>
    <p>G5H 3Z4, Canada</p>
    <p>2019-12-29</p>
    <p>Dear Dr. Duplisea,</p>
    <p>Thank you for considering a revision of the manuscript PONE-D-19-26904,</p>
    <p>**“`SimSurvey`: an `R` package to optimize the design and analysis of</p>
    <p>fisheries surveys by simulating spatially-correlated fish stocks”** by</p>
    <p>Paul M. Regular, Gregory J. Robertson, Keith P. Lewis, Jonathan Babyn,</p>
    <p>Brian Healey and Fran Mowbray. In accordance to one of the reviewers’</p>
    <p>suggestions, the paper has been renamed **“`SimSurvey`: an `R` package</p>
    <p>for comparing the design and analysis of fisheries surveys by simulating</p>
    <p>spatially-correlated fish stocks”**.</p>
    <p>We thank the Reviewers for their thoughtful and thorough comments which</p>
    <p>will clarify and improve the manuscript. We agree with many of the</p>
    <p>comments and have made every effort to incorporate these into the</p>
    <p>manuscript. Below are the reviewers’ comments with a brief accounting of</p>
    <p>our response to each concern or suggestion.</p>
    <p>We submit this revised manuscript for your consideration and look</p>
    <p>forward to your decision.</p>
    <p>Sincerely,</p>
    <p>Paul Regular </p>
    <p>Fisheries and Oceans Canada </p>
    <p>Northwest Atlantic Fisheries Center </p>
    <p>80 East White Hills, St. John’s, NL </p>
    <p>A1C 5X1, Canada </p>
    <p>E-mail:</p>
    <p>
      <email>Paul.Regular@dfo-mpo.gc.ca</email>
    </p>
    <p>Phone: (709) 772-2067</p>
    <p>------------------------------------------------------------------------</p>
    <p>Reviewer \\#1:</p>
    <p>This paper describes the R package “SimSurvey” which is a package to</p>
    <p>test the design and analysis of fisheries independent surveys.</p>
    <p>I found the paper very interesting and the package of great potential</p>
    <p>value and interest to many fishery scientists. However, I have several</p>
    <p>comments that I would like the authors to address first before I</p>
    <p>recommend acceptance of this paper. My main comments relate to:</p>
    <p>1. Verify some of the equations and model description used in the</p>
    <p> model. I think that some of them lack description to fully</p>
    <p> understand what was done and few others are misleading, even</p>
    <p> incorrect. The detail can be found below but in general, they are</p>
    <p> linked to the problem of bias correction for log-normal</p>
    <p> distribution, re-scaling”, moving from abundance at age to abundance</p>
    <p> at length.</p>
    <p>2. Add additional explanation to justify the choices. E.g. why</p>
    <p> population dynamics is modeled independently of the spatial</p>
    <p> distribution. Is this reasonable, limitation, etc.</p>
    <p>3. Few suggestions (add-ons, renaming) to increase the generality of</p>
    <p> the paper (without requiring too much work)</p>
    <p>*We hope we have addressed each of these main comments by a) clarifying</p>
    <p>several equations, b) adding more details and justifications, and c)</p>
    <p>modifying naming conventions and clarifying extensibility. See replies</p>
    <p>below for more details.*</p>
    <p>Detailed comments:</p>
    <p>Abstract:</p>
    <p>What about the flexibility to include new sampling strategies (user</p>
    <p>defined one) or including new estimation approaches</p>
    <p>*We have noted that both built-in and user-defined sampling strategies</p>
    <p>can be utilised.*</p>
    <p>Introduction:</p>
    <p>L43: quality of</p>
    <p>*We have made the suggested change.*</p>
    <p>It would be good to add few references here e.g. L50,</p>
    <p>*We have added references as suggested.*</p>
    <p>Method:</p>
    <p>L69-73: I think it would be good to add the reference to the specific</p>
    <p>function name listed in Table2. This way, I would be more explicit and</p>
    <p>avoid possible confusion. For example, in my case, when I first read the</p>
    <p>section header “simulate abundance”, I was expecting to see the way you</p>
    <p>dealt with the spatial distribution of abundance.</p>
    <p>*We have made the suggested change.*</p>
    <p>L94&amp;95&amp;104: I just want to make sure that the bias correction has been</p>
    <p>applied to these two equations. If logN (or logZ) is normally</p>
    <p>distribution with mean mu and sigma, then the N (or Z) is lognormally</p>
    <p>distributed with mean exp(mu+sigma^2/2). Therefore, when you write</p>
    <p>“mean” in table 3 for R and Z, I hope that you modified in your actual</p>
    <p>equation for log(Z) to: log(Z) ~ normal(log(mean)-sigma^2/2, sigma) In</p>
    <p>other word, the mean(R) is not simply exp(meanR\\_log\\_scale).</p>
    <p>exp(meanR\\_log\\_scale) is the median of the distribution of R.</p>
    <p>*Good catch. The answer to the question is no, bias correction was not</p>
    <p>applied, but nor was it needed, as all demographic parameters operated</p>
    <p>in log space. The issue is a matter of naming convention that we</p>
    <p>admittedly struggled with. When developing the functions, we vacillated</p>
    <p>on whether to use `log_mean` or `mean` as the argument name and we</p>
    <p>landed on mean as we believed this would be a more relatable value for</p>
    <p>users to supply. To be more explicit with regards to what value should</p>
    <p>be supplied, we have renamed the arguments to `log_mean`.*</p>
    <p>L107: there is not enough description to understand how you converted</p>
    <p>the abundance at age to abundance at length. What were the choice of</p>
    <p>length bin groups? Every 5 cm, 10cm? Such information is also missing in</p>
    <p>the tables. Please add that. But then you have to calculate some</p>
    <p>cumulative distribution (until length l) for the length at age</p>
    <p>distribution (using the VB growth equation) and do some subtractions to</p>
    <p>be able to allocate the abundance at age to each length group. See</p>
    <p>equation A.1.14 in here for example.</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://www.nwfsc.noaa.gov/news/events/program_reviews/documents/C.2_Methot_Wetzel_SSTechnicalDescription.pdf">https://www.nwfsc.noaa.gov/news/events/program_reviews/documents/C.2_Methot_Wetzel_SSTechnicalDescription.pdf</ext-link>
    </p>
    <p>*Another good catch as we did not provide enough information to</p>
    <p>replicate the approach. We have added more detail on the calculations</p>
    <p>behind the sim\\_vonB function; turns out our approach was similar to the</p>
    <p>one described in the exemplar the reviewer provided.*</p>
    <p>“Simulate spatial distribution”:</p>
    <p>I have a few comments on this section:</p>
    <p>1. First of all, I think it is important to state that you assume that</p>
    <p> the population dynamic model and the spatial distribution is</p>
    <p> independent i.e. you do not have a spatially-explicit population</p>
    <p> dynamics model. And talk about what it means (is it realistic,</p>
    <p> limitation, etc).</p>
    <p>*We have prefaced this section with the caveat that population and</p>
    <p>spatial dynamics are modeled as independent processes and we note the</p>
    <p>pros and cons of this approach. In short: the con is that the approach</p>
    <p>is a simplification of reality as it does not explicitly account for</p>
    <p>dynamics such as larval dispersal, spatial differences in growth and</p>
    <p>population connectivity; the pro is that this simplification limits the</p>
    <p>number of unknown parameters that need to be specified while</p>
    <p>facilitating the simulation of a sufficiently complex population for</p>
    <p>testing the efficacy of various survey designs.*</p>
    <p>1. L161. I think it would be better to rename “depth” as “main</p>
    <p> covariate influencing the species distribution”. And “depth” happens</p>
    <p> to be one of them for many species, but there are cases when this is</p>
    <p> not the case.</p>
    <p>*A good point, this variable could be used for any habitat gradient over</p>
    <p>which stratification is applied. However, we retain the term “depth” for</p>
    <p>three reasons: 1) it is an important covariate for many species (as the</p>
    <p>reviewer noted), 2) most surveys that we are aware of are</p>
    <p>depth-stratified (also noted by the reviewer below) and 3) it is a</p>
    <p>concise variable name (as opposed to something like “habitat\\_covar”).</p>
    <p>We therefore retained the “depth” naming as it ought to satisfy most use</p>
    <p>cases. We now note directly in the text that any covariate could be</p>
    <p>supplied and used as ‘depth’*</p>
    <p>1. L161. I think it would be good to say upfront that there are two</p>
    <p> ways of defining the spatial structure. Using the function in the</p>
    <p> package or user defined.</p>
    <p>*Given a suggestion from Reviewer \\#2, we have restructured the paper to</p>
    <p>have two core sections: “Model structure” and “Using **`SimSurvey`**”.</p>
    <p>We have included a blanket statement under the “Model structure” section</p>
    <p>noting that users can circumvent specific components of the</p>
    <p>**`SimSurvey`** framework and supply their own objects, including</p>
    <p>spatial structure of the survey grid.*</p>
    <p>1. L161: I think another possibility is to generate a random field by</p>
    <p> using the package “Randomfields” for example. This way you can</p>
    <p> generate a map where “depth” is patchily distributed (maybe more</p>
    <p> like an island type case study)</p>
    <p>*Good idea! We actually pursued this idea in an earlier iteration of</p>
    <p>`make_grid`, however, we abandoned the option because it was difficult</p>
    <p>to automate because the random field sometimes created small strata (one</p>
    <p>cell) or strata that were split in space. We would certainly welcome</p>
    <p>more development integrating other packages with **`SimSurvey`***</p>
    <p>1. L163-164: please add more description about the division or strata.</p>
    <p> How can we set it up and what do you specifically mean by division</p>
    <p> and strata? Is one nested within the other, or not necessarily? Your</p>
    <p> examples are based on Atlantic Ocean and people in other regions</p>
    <p> might not be familiar with how these divisions are created.</p>
    <p>*We have added more detail on the structure of the divisions and strata.</p>
    <p>In short, divisions are pre-defined areas, generally within which a</p>
    <p>fisheries management framework is applied. Age-length keys are specified</p>
    <p>at the level of the division, so for populations spanning large habitat</p>
    <p>gradients (in temperature for example) in which age-length relationships</p>
    <p>change along that gradient, multiple divisions can be supplied. Strata,</p>
    <p>on the other hand, are defined by an important habitat gradient. As</p>
    <p>structured in **`SimSurvey`**, strata are nested in divisions. *</p>
    <p>1. L163: Why only focus on “depth-based strata”? I think it would be</p>
    <p> good to allow the user to choose their own stratification approach.</p>
    <p> It could be depth based as you did (which happens most often in</p>
    <p> surveys) but it could technically be any other thing (user</p>
    <p> supplied). This allows more flexibility.</p>
    <p>*We agree, see reply to point 2. above, and note that any habitat</p>
    <p>variable could be used for stratification.*</p>
    <p>1. L167: the equation is misleading and I am not sure it is right based</p>
    <p> on what is written in the text. You mentioned later on L178: that</p>
    <p> you “re-scaled” so that the total number of fish in a specific year</p>
    <p> and age across space is equal to the single number from the</p>
    <p> population dynamics model. If so, the re-scaling should be done in</p>
    <p> the identify (natural) scale, not in log scale. In log scale, even</p>
    <p> if ,, sums to zero across space, the sum in the identity scale won’t</p>
    <p> match. This is often refer to as “bias correction” for the log</p>
    <p> normal models. And you should ideally show how the rescaling was</p>
    <p> done in terms of the equations too.</p>
    <p>*Right, the equation presented was not an accurate reflection of the</p>
    <p>calculations. We have revised the equation to explicitly show how the</p>
    <p>values were normalized to sum to 1.*</p>
    <p>1. L167: this “depth preference” function is very simplistic and gives</p>
    <p> only very “smooth” symmetric distribution. More often, fish have a</p>
    <p> skewed depth preference: often right-skewed.</p>
    <p>*True. Some users may find this parameterization insufficient for their</p>
    <p>species and we hope they will implement their own closure to use in the</p>
    <p>`sim_distribution` function to better simulate the effect. In addition</p>
    <p>to our blanket statement under the “Model structure” section, we have</p>
    <p>added a more specific statement under the “Using **`SimSurvey`**”</p>
    <p>section stating that alternate formulations can be used by supplying</p>
    <p>alternate closures to the core functions.*</p>
    <p>1. L173-174: I think it might be worth adding, in simpler terms, the</p>
    <p> meaning of the spatial smoothing and scaling parameters.</p>
    <p>*We have prefaced that sentence with “The rate at which point-to-point</p>
    <p>spatial correlation decays with distance is controlled by…”.*</p>
    <p>1. L178: it is another question of scaling. How did you exactly do the</p>
    <p> scaling? In the identity scale? By dividing my the sum of the</p>
    <p> effects? I am asking this because depending on how you did the</p>
    <p> rescaling, your correlation structure in space and age might have</p>
    <p> been affected and is not the same as the one specified in L172. Did</p>
    <p> you verify that?</p>
    <p>*See reply to point 7. above*</p>
    <p>Table 4. “group\\_ages”. Ok but how is the variance controlled for the</p>
    <p>other age classes?</p>
    <p>*“Variance” was a poor word choice. We have replaced it with “noise” as</p>
    <p>it is the simulated noise that we fix across multiple age groups.*</p>
    <p>L189: “user supplied”. This is a good feature. However, I think it is</p>
    <p>important to mention here that user have to make sure that they use the</p>
    <p>correct projection method to ensure that each grid is of the same</p>
    <p>dimension.</p>
    <p>*We have made the suggested change.*</p>
    <p>L216: reference to figure 3?</p>
    <p>*We have made the suggested change.*</p>
    <p>L221: there is not “group\\_years” argument in Table 4.</p>
    <p>*We have added it to the table.*</p>
    <p>L237: “this function”. I think it would be better to replace “this</p>
    <p>function” with “sim\\_distribution” as you do not mention the word</p>
    <p>“sim\\_distribution” in the sentence above this.</p>
    <p>*We have made the suggested change.*</p>
    <p>L158-251: In general, I think re-organising this section using</p>
    <p>sub-section headers could be useful. Just to guide the readers</p>
    <p>*This is an excellent suggestion. By following a suggestion by Reviewer</p>
    <p>\\#2 to re-organize the paper into two core sections we have added more</p>
    <p>headers to help guide the readers.*</p>
    <p>L254: you say that sampling is stratified random but SRS is also an</p>
    <p>option based on Table5. Please correct.</p>
    <p>*We have made the correction.*</p>
    <p>L257: what does this mean? Does this control the number of set but how</p>
    <p>is this calculated?</p>
    <p>*We have clarified how number of sets per strata is calculated.*</p>
    <p>L257: I do not see how you control for the total number of set in the</p>
    <p>survey? How do you control it?</p>
    <p>*We have clarified how number of sets per strata is calculated; it is</p>
    <p>done within the `sim_survey` function using the `set_den` argument, with</p>
    <p>further adjustment possible with the `min_sets` argument.*</p>
    <p>L261: I think you should mention here that you can also force the sample</p>
    <p>size (as seen on table 5). Moreover, in table 5, it would be good to</p>
    <p>set-up a “ages\\_min” for the minimum number of ages to sample \\[…\\]” so</p>
    <p>that it gives the ability to fix the sample size if needed by writing</p>
    <p>the same value for “ages\\_min” and “ages\\_cap”.</p>
    <p>*We are not sure what the reviewer would like to have implemented here.</p>
    <p>Is the suggestion to impose a minimum number of ages to collect across</p>
    <p>all length groups? In practice, an `ages_min` constraint is already</p>
    <p>applied for length bins where the total number of fish caught is lower</p>
    <p>than `ages_cap`. A specific `ages_min` constraint cannot really be</p>
    <p>applied, as if there are too few fish of a certain size caught in any</p>
    <p>one survey, there is no means of getting more fish of that size.*</p>
    <p>L261: How are you making sure that the number of sampled fish for that</p>
    <p>specific cell, age and year won’t be above the total number of fish in</p>
    <p>that cell, age, and year? The probability value could be close to one</p>
    <p>and if you fish in a few a time, then you are at risk. Especially</p>
    <p>because your population dynamics model is not spatially explicit and is</p>
    <p>completely independent of the distribution function itself i.e. you can</p>
    <p>technically fish out all the fish in an area but it will be populated</p>
    <p>back the year after the way you implemented in this study… Maybe you</p>
    <p>need to put a condition (or just a note) for general users to make sure</p>
    <p>that this probability value is much below 1?</p>
    <p>*The sampling is implemented such that the number of fish sampled in a</p>
    <p>cell cannot exceed the number of fish in a cell because the population</p>
    <p>is split across sets in cases where more than one set is conducted in a</p>
    <p>cell. We have added this missing detail to our manuscript. We also added</p>
    <p>a note that the survey is assumed to have no impact on the population</p>
    <p>from one year to the next, and users planning to conduct surveys at</p>
    <p>levels that will affect the overall population will need to use caution</p>
    <p>in interpreting their results.*</p>
    <p>L267: I recommend to clarify something here. 1. Depending on the number</p>
    <p>of fish caught? What do you mean? What is the rule you used? 2. The way</p>
    <p>you coded, sample by age is first decided, then the corresponding length</p>
    <p>is calculated, then age-subsample is determined. In reality, length</p>
    <p>sample is taken in the field, then age sub-samples are taken. While</p>
    <p>similar, I do not think it always equal. Especially, when you start</p>
    <p>including some correlation structure in the sampling. By the way, did</p>
    <p>you consider including some correlation structure in the sampling</p>
    <p>process to make more realistic?</p>
    <p>*Our wording “depending on the number of fish caught” was unfortunately</p>
    <p>vague and, in hindsight, is not adding anything to the paper. Therefore,</p>
    <p>we have removed the statement to minimize confusion. We have also</p>
    <p>clarified the sub-sampling sequence. Finally, we have yet to consider</p>
    <p>including correlation structure in the sampling process as we went about</p>
    <p>imposing correlation via the spatial correlation of age groups</p>
    <p>(i.e. age-specific clustering tends to result in sets with high</p>
    <p>intraclass correlation). Correlation in the sampling procedure could be</p>
    <p>a future development for **`SimSurvey`**, but we feel at this time the</p>
    <p>package is sufficiently complex and we did not want to overwhelm users</p>
    <p>with too many options.*</p>
    <p>L275 Table 1 on should be table 5</p>
    <p>*We have changed the page numbers accordingly.*</p>
    <p>L275: Table5: “age\\_sammpling” should be “age\\_sampling”</p>
    <p>*We have made the suggested change.*</p>
    <p>L275: “min\\_sets” you have not described it yet and what is it? You have</p>
    <p>sample from all cells? If no, this is not realistic.</p>
    <p>*We have clarified the meaning and utility of the `min_sets` argument</p>
    <p>(i.e. a small strata may be allocated only one set under a low set</p>
    <p>density scenario; this argument overrides the allocation and imposes the</p>
    <p>`min_sets` if it is greater than the allocation).*</p>
    <p>L279: Table5 not Table1?</p>
    <p>*We have changed the numbers accordingly.*</p>
    <p>L285-286: Could you be more specific on how custom closures can be</p>
    <p>supplied and where?</p>
    <p>*We have included an example in the second paragraph of the “Using</p>
    <p>**`SimSurvey`**” section that we hope will clarify how a user can supply</p>
    <p>a custom closure.*</p>
    <p>L306: how are these catchability corrected abundance matrices</p>
    <p>calculated? It is important to write this information somewhere (or</p>
    <p>write “please refer to the section “Stratified analysis” for further</p>
    <p>information on the calculation of abundance indices”) or something alike</p>
    <p>and Appendix S3.</p>
    <p>*We have clarified how this was calculated.*</p>
    <p>L336: I think it would be good to say that other methods exist and</p>
    <p>people can use it in this package (maybe)?</p>
    <p>*Good point, however, we think this is covered by referencing a paper</p>
    <p>that describes a geostatistical R package and we also note that other</p>
    <p>options can be used under the “Research opportunities” section.*</p>
    <p>L421: color gradient. Even though it is obvious it might be good to say</p>
    <p>green to purple gradient.</p>
    <p>*We have made the suggested change.*</p>
    <p>L427: instead of “sampling protocol”, I think it would be more meaning</p>
    <p>full to say the maximum number of length samples.</p>
    <p>*We have made the suggested change.*</p>
    <p>L452: say that the color ramps from yellow to purple</p>
    <p>*We have made the suggested change.*</p>
    <p>S1 appendix: missing figure in S1</p>
    <p>*We have included the figure*</p>
    <p>------------------------------------------------------------------------</p>
    <p>Reviewer \\#2:</p>
    <p>This manuscript describes an R package called SimSurvey. The package</p>
    <p>includes a set of functions for simulating point-based fisheries survey</p>
    <p>designs, e.g. bottom trawl surveys, for estimating abundance indices. It</p>
    <p>focuses on number of stations and number of fish sampled ignores other</p>
    <p>constraints such as distance between stations and day-time duration</p>
    <p>which impose strong constraints on real surveys. The functions included</p>
    <p>allow the user to first simulate age-and length structured population</p>
    <p>dynamics, distribute individuals randomly in space (assuming a certain</p>
    <p>correlation structure), carry out a survey and finally calculate</p>
    <p>abundance indices from the simulated data. The package will likely be of</p>
    <p>interest to researchers wanting to explore the precision achievable with</p>
    <p>different survey designs. My comments regarding the package and the</p>
    <p>presentation are summarised below.</p>
    <p>1. Optimization</p>
    <p>The title announces a package for optimizing survey designs. As far as I</p>
    <p>can see the package does not allow survey design optimization, neither</p>
    <p>in terms of defining survey strata nor in terms of number of stations</p>
    <p>per stratum. The strata are defined by the user. The only option</p>
    <p>available for the number of stations is proportional to stratum surface;</p>
    <p>the user sets the minimum number of stations taken in the smallest</p>
    <p>stratum. It would be useful to be able to specify the total number of</p>
    <p>stations and test different allocation schemes, such as proportional to</p>
    <p>surface area (implemented), equal number per stratum, Neyman allocation</p>
    <p>(accounting for surface area and abundance variability), etc. Please</p>
    <p>consider revising the title (e.g. “compare” and instead of “optimize)”</p>
    <p>and spell out the available sampling design options.</p>
    <p>*We agree with the Reviewer and retitled the ms “`SimSurvey`: an `R`</p>
    <p>package for comparing the design and analysis of fisheries surveys by</p>
    <p>simulating spatially-correlated fish stocks”. Currently the package</p>
    <p>provides options for stratified random sampling proportional to surface</p>
    <p>area, but other survey designs could added in future versions of</p>
    <p>**`SimSurvey`**.*</p>
    <p>1. Manuscript structure</p>
    <p>The manuscript might be easier to follow if the manuscript was</p>
    <p>restructured: 1) Model description, 2) Using SimSurvey. The later</p>
    <p>section would then group all example code which could again be</p>
    <p>subdivided into running simulations and exploring results (plot</p>
    <p>functions).</p>
    <p>*This is an excellent suggestion! We have re-structured our manuscript</p>
    <p>accordingly and feel that this structure will be much easier for a</p>
    <p>reader to follow.*</p>
    <p>1. Parameterisation To use SimSurvey for a real world problem realistic</p>
    <p> parameter values are needed. The package comes with default values</p>
    <p> chosen for a particular case study. However, no mention is made in</p>
    <p> the manuscript how to choose appropriate values for the many model</p>
    <p> parameters to tailor the simulations to a population of interest. I</p>
    <p> suggest the authors add a section on parameterisation and a table</p>
    <p> summarizing all parameters with a column specifying how to</p>
    <p> parameterize. For example, parameters for population dynamics and</p>
    <p> growth could probably be taken from the literature (or a stock</p>
    <p> assessment report). However this is not possible for the parameters</p>
    <p> of the spatial distribution function sim\\_distribution() such as</p>
    <p> correlation between ages etc. Ideally the package would include a</p>
    <p> fitting function for estimating these parameters from actual data.</p>
    <p> These input data could come from a pilot survey and include location</p>
    <p> (lat, long) and numbers by length/age.</p>
    <p>*This is yet another very helpful suggestion and, now that we have</p>
    <p>included a Parameterisation section, it is easy to see the value of such</p>
    <p>a section to prospective users of the package. Instead of a table that</p>
    <p>summarizes how to specify the parameters, we wrote an entire section</p>
    <p>that outlines recommended steps for setting up a their own simulation.</p>
    <p>We started drafting a table, however, it quickly became apparent that it</p>
    <p>would be too big and cumbersome and somewhat redundant with the core</p>
    <p>tables that describe the arguments and parameters. We hope that the</p>
    <p>narrative/outline we included will serve the practical purpose the</p>
    <p>reviewer had in mind.*</p>
    <p>Minor issues - line 93: I assume there is an age plus but this needs to</p>
    <p>be mentioned. Also, please specify how you set the initial numbers for</p>
    <p>plus group ().</p>
    <p>*We have now noted in the manuscript that a plus group is not modeled</p>
    <p>explicitly as the number of ages can easily be extended to include</p>
    <p>groups with zero fish. This choice simplifies the simulation, including</p>
    <p>the setting of initial numbers which is done via exponential decay.</p>
    <p>Further, the lack of a plus group is inconsequential for survey based</p>
    <p>estimates of abundance at age.*</p>
    <p>- line 121: I don’t understand the explanation of a closure. What do</p>
    <p> you mean by “return functions”? Do you mean it returns an object</p>
    <p> with different attributes?</p>
    <p>*We have improved our explanation of a closure at the beginning of the</p>
    <p>Using **`SimSurvey`** section*</p>
    <p>- line 125: the number of right and left brackets is unbalanced,</p>
    <p> please check</p>
    <p>*We have provided an improved description of a closure; the logic behind</p>
    <p>this line of code should be clearer now*</p>
    <p>- line 126 “This structure was chosen to avoid the repeated</p>
    <p> specifications of ages and years”. As far as I can see the example</p>
    <p> code only specifies years, not ages.</p>
    <p>*Again, we hope that our improved description of a closure will clarify</p>
    <p>what we mean by this.*</p>
    <p>- line 227 Please explain what a pipe is and how it is used. In the</p>
    <p> example I understand that the output of sim\\_abundance( ) is</p>
    <p> provided to (piped) into sim\\_distribution(). I am unclear what the</p>
    <p> object b contains. Is it the result of sim\\_distribution()?</p>
    <p>*We have clarified how a pipe works, noting that it forwards values from</p>
    <p>one function call to the next function call, and we now state that the</p>
    <p>output from the two examples provided (nested approach vs. pipe</p>
    <p>approach) are functionally the same though the approach is slightly</p>
    <p>different.*</p>
    <p>- There is no table 1, please revise table numbering.</p>
    <p>*We have made the suggested change.*</p>
    <supplementary-material content-type="local-data" id="pone.0232822.s007">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">rebuttal_letter.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0232822.s007.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0232822.r003" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Daniel E. Duplisea</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Daniel E. Duplisea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Jan 2020</named-content>
    </p>
    <p>PONE-D-19-26904R1</p>
    <p>SimSurvey: an R package for comparing the design and analysis of fisheries surveys by simulating spatially-correlated fish stocks</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Regular,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>
      <bold>Please see the detailed suggestions below.</bold>
    </p>
    <p>We would appreciate receiving your revised manuscript by Feb 20 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Daniel E. Duplisea, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (if provided):</p>
    <p>Dear Paul, you have made lots of excellent changes that I think help with the use of the package and responded to the many specific comments of reviewers which has no doubt corrected many technical issues and clarifications. The one thing I would say that you have not really done is get at the deeper research merits of this work beyond introducing a new piece of software. I think paper, as it stands, lacks a larger context and content which is important for the primary publication. My diagnosis for why this is is that the manuscript does not conform very well to more typical scientific reports (Intro, M&amp;M, Result, Discussion) which can make it difficult for readers to find the larger scientific merits of the work. It is useful of course for those who already understand the merits of this kind of work but this work is for primary publication and it needs to appeal more to the former than the latter group. There is a very "how-to" feel to it (e.g. line 64 "In this section") which I think detracts from getting at the larger purpose of the work.</p>
    <p>I would really like you to address this issue of moving it from a software manual to a primary scientific publication. I do not think it should involve that much work but there will be some restructuring of sections as well as places to put in content and bring out conclusions. Here are my suggestions for this:</p>
    <p>Try to follow a more traditional paper structure. This will help readers and it likely will also make it clearer for you on how you can inject content into the paper to move it beyond the software manual approach:</p>
    <p>Introduction:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>You need to talk about wider issues and examples. e.g. examples of when poor survey design meant that scientific questions could not be properly addressed when good survey design meant they were. Examples of when good survey design allowed researchers to address needs that were unanticipated at the time it was designed. i.e. you need to build a better case (not just cost) of why survey design is really important and it is most powerful to do this with examples. You should try to bring in ideas related to ecosystem and climate changes and being able to track communities. Perhaps bring in species at risk ideas and tracking decline, you could bring in ideas related to MSC certification. These are just examples of specifics but you get the idea: the Introduction needs to have more general information outlining in both a broad and specific sense why we should be concerned about this.</p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Keep in mind an educated reader who may not be in fisheries but is interested in why anyone should care about this or could, for example, be interested in surveying say caribou or songbirds or something outside of fisheries but where many of the motivation and concepts may be similar and they are doing a more general literature search before designing their own survey.</p>
        </list-item>
      </list>
    </p>
    <p>Methods:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>This will start at your "Model Structure" section. You should put a higher level heading just before that called Methods.</p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>I can see that it is hard to separate your Methods from Results. Your results are really in the section "Using SimSurvey" I would not be opposed to putting this as a separate Results section but I leave it to you to decide. Essentially what you have is a case study as an example of how it works and therefore specific results are less interesting than how you got there with the package. You might title it something like "Results: running a SimSurvey simulation". This section also has a lot of content without a lot of explanation. for example, you have several large and complicated figures in a row. You should discuss not only what figures are meant to offer in the package but also what they mean. So for example on line 473 you refer to three figures (5,6,7) but you offer little interpretation of those figures just why you can make them which is another example of the limitations of the how-to manual approach. So you need to think of it as a case study and help someone decide the implications of their survey design.</p>
        </list-item>
      </list>
    </p>
    <p>Results:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>see comment above</p>
        </list-item>
      </list>
    </p>
    <p>Discussion:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>This starts just before "Research Opportunities". You can keep these sections but there should be more preamble before jumping right into research opportunities. I suggest a general paragraph(s) that segue into your subsections of "research opportunities", "future research". In the Discussion you should address again some of the broader issues from the Introduction, e.g. how could spatial (depth) distribution changes anticipated under climate change for some population be tackled by survey design exploration now so that we can continue to track these changing populations 20 years down the road and do not lose the signal. How can this software help with that?</p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>I think something that can be useful for readers is to outline the steps in a thought process a researcher might undertake when setting up a survey (perhaps a separate subsection) and then how one might go about a SimSurvey run for this. It also gives you a good opportunity to discuss your multispecies ideas:<list list-type="bullet"><list-item><p>What is your current problem/needs</p></list-item><list-item><p>What are the constraints (HR and $ perspective)</p></list-item><list-item><p>What are the constraints from a biological, physical perspective</p></list-item><list-item><p>Resources available</p></list-item><list-item><p>What are your anticipated future needs (i.e. if climate change is going to make cod go deeper, will you be able to track it in 20 years?)</p></list-item><list-item><p>How could you consider some or all of these with SimSurvey</p></list-item></list></p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Your "Assumptions" section should come down into the Discussion</p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>"Future Directions" should say something about randomfields re: Reviewer 1. Even if you just outline that you have considered it. You might also try to say something about optimisation of design which Reviewer 2 mentioned.</p>
        </list-item>
      </list>
    </p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0232822.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">20 Feb 2020</named-content>
    </p>
    <p>Additional Editor Comments:</p>
    <p>Dear Paul, you have made lots of excellent changes that I think help with the use of the package and responded to the many specific comments of reviewers which has no doubt corrected many technical issues and clarifications. The one thing I would say that you have not really done is get at the deeper research merits of this work beyond introducing a new piece of software. I think paper, as it stands, lacks a larger context and content which is important for the primary publication. My diagnosis for why this is is that the manuscript does not conform very well to more typical scientific reports (Intro, M&amp;M, Result, Discussion) which can make it difficult for readers to find the larger scientific merits of the work. It is useful of course for those who already understand the merits of this kind of work but this work is for primary publication and it needs to appeal more to the former than the latter group. There is a very "how-to" feel to it (e.g. line 64 "In this section") which I think detracts from getting at the larger purpose of the work.</p>
    <p>I would really like you to address this issue of moving it from a software manual to a primary scientific publication. I do not think it should involve that much work but there will be some restructuring of sections as well as places to put in content and bring out conclusions. Here are my suggestions for this:</p>
    <p>Try to follow a more traditional paper structure. This will help readers and it likely will also make it clearer for you on how you can inject content into the paper to move it beyond the software manual approach:</p>
    <p>Introduction:</p>
    <p>- You need to talk about wider issues and examples. e.g. examples of when poor survey design meant that scientific questions could not be properly addressed when good survey design meant they were. Examples of when good survey design allowed researchers to address needs that were unanticipated at the time it was designed. i.e. you need to build a better case (not just cost) of why survey design is really important and it is most powerful to do this with examples. You should try to bring in ideas related to ecosystem and climate changes and being able to track communities. Perhaps bring in species at risk ideas and tracking decline, you could bring in ideas related to MSC certification. These are just examples of specifics but you get the idea: the Introduction needs to have more general information outlining in both a broad and specific sense why we should be concerned about this.</p>
    <p>- Keep in mind an educated reader who may not be in fisheries but is interested in why anyone should care about this or could, for example, be interested in surveying say caribou or songbirds or something outside of fisheries but where many of the motivation and concepts may be similar and they are doing a more general literature search before designing their own survey.</p>
    <p>*Thank you for thinking beyond a fisheries biologist audience, as this is the audience we have been targeting from the onset. In hindsight we see that was short-sighted so we have modified our introduction, as suggested, to pitch the concept to a broader audience. The reason we did not think beyond fisheries biology is because we tend to have access to extensive age-based data while others (e.g. songbird and caribou biologists) do not. However, there are certainly other marine or terrestrial situations that could use our approach, the general framework we now present should be useful to adapt our work to systems we have not even considered.*</p>
    <p>*Specifically, we have added an additional paragraph at the start of the paper discussing the importance of good survey design at a very general level. We also have removed references to fish and fisheries from some places in the abstract, to show our work can easily be generalized to other systems.*</p>
    <p>Methods:</p>
    <p>- This will start at your "Model Structure" section. You should put a higher level heading just before that called Methods.</p>
    <p>- I can see that it is hard to separate your Methods from Results. Your results are really in the section "Using SimSurvey" I would not be opposed to putting this as a separate Results section but I leave it to you to decide. Essentially what you have is a case study as an example of how it works and therefore specific results are less interesting than how you got there with the package. You might title it something like "Results: running a SimSurvey simulation". This section also has a lot of content without a lot of explanation. for example, you have several large and complicated figures in a row. You should discuss not only what figures are meant to offer in the package but also what they mean. So for example on line 473 you refer to three figures (5,6,7) but you offer little interpretation of those figures just why you can make them which is another example of the limitations of the how-to manual approach. So you need to think of it as a case study and help someone decide the implications of their survey design.</p>
    <p>*We really struggled to accommodate traditional Methods and Results sections because all of our re-structuring attempts defied the definitions of these sections. To maintain a logical flow that describes the how and why to use the package, we landed on a mix of methods and case study results/discussion through the body of the paper. We first describe the "Model structure", then the "Core functions", and then we describe and discuss the case study results in the "Interpretation" section.*</p>
    <p>*The new "Interpretation" section is essentially a shortened version of the appendix on the case study, however, this iteration of the manuscript includes one new result. In the process of revising the paper and reading more literature, we stumbled upon a potential design-based solution to the bias introduced by the division-level age-length key (default approach). The design-based fix was easily implemented using the package and, after running the necessary simulations, we discovered that the resultant estimates appear to be unbiased. We feel this is an interesting and useful addition to the paper as it shows that the package can be used to identify issues and explore solutions.*</p>
    <p>*We should also note that we have moved the "Parameterisation" section to an appendix. This was the section where we provide some guidance on how to modify default settings to suit specific needs. Following the addition of the "Interpretation" section, it became clear that this section no longer fits with the logical flow of the paper.*</p>
    <p>*Overall, we feel that the structural changes we have made to the paper have minimized the how-to content, and the increased focus on the case study should bring more meaning to the complex figures shown through the paper and highlight the real-world implications of the package.*</p>
    <p>*Below we discuss a number of our failed attempts to place the content into Methods and Results sections:*</p>
    <p>*1) We tried to start the methods section with "Model Structure", as suggested, and shunt the figures to a "Results" section; this, however, broke the flow and left a gap in the methods section which held demonstrations of the core simulation functions but not the plotting functions.*</p>
    <p>*2) We tried to keep the methods section as is and describe some of the case study results in the results section, however it seemed awkward to describe and discuss a solution to the age-length key problem in a results section.*</p>
    <p>*3) Earlier iterations of the paper were focused entirely on the case study, the format was traditional and the package was a side-note in the methods section. It became apparent, however, that the package was more interesting and generally applicable than the case study results. We then began re-working the paper into a how-to format and, while moving away from a conventional format, we looked to several papers as a guide on how to document a R package (e.g. <ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0092725">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0092725</ext-link>).*</p>
    <p>Results:</p>
    <p>- see comment above</p>
    <p>*Please see reply to Methods comment.*</p>
    <p>Discussion:</p>
    <p>- This starts just before "Research Opportunities". You can keep these sections but there should be more preamble before jumping right into research opportunities. I suggest a general paragraph(s) that segue into your subsections of "research opportunities", "future research". In the Discussion you should address again some of the broader issues from the Introduction, e.g. how could spatial (depth) distribution changes anticipated under climate change for some population be tackled by survey design exploration now so that we can continue to track these changing populations 20 years down the road and do not lose the signal. How can this software help with that?</p>
    <p>*In contrast to a Methods or Results section, a Discussion section was easier to accommodate and we have provided one. Here we lean on the case study results to reiterate the importance of planning a survey or testing an existing survey. We then use this preamble to segue into the "Research opportunities" section as suggested.*</p>
    <p>- I think something that can be useful for readers is to outline the steps in a thought process a researcher might undertake when setting up a survey (perhaps a separate subsection) and then how one might go about a SimSurvey run for this. It also gives you a good opportunity to discuss your multispecies ideas:</p>
    <p> - What is your current problem/needs</p>
    <p> - What are the constraints (HR and $ perspective)</p>
    <p> - What are the constraints from a biological, physical perspective</p>
    <p> - Resources available</p>
    <p> - What are your anticipated future needs (i.e. if climate change is going to make cod go deeper, will you be able to track it in 20 years?)</p>
    <p> - How could you consider some or all of these with SimSurvey</p>
    <p>*As much as we would like to address each of these points and work towards a survey design handbook, it would be hard to be as cohesive and comprehensive as Cochran (1977; "Sampling techniques") or Sutherland (2006; "Ecological census techniques: a handbook"). Moreover, we have yet to implement features that could help users assess some of these trade-offs (i.e. cost-benefit analysis). We are hopeful that these are questions that future versions of SimSurvey may be able to help address as more features are added to elevate it from a purely statistical toolbox to something that also considers the operational constraints of delivering a survey.*</p>
    <p>- Your "Assumptions" section should come down into the Discussion</p>
    <p>*Agreed, we have made the suggested change.*</p>
    <p>- "Future Directions" should say something about randomfields re: Reviewer 1. Even if you just outline that you have considered it. You might also try to say something about optimisation of design which Reviewer 2 mentioned.</p>
    <p>*Good point. We have noted in the "sim_distribution" section that a custom closure can be created that uses randomfields to simulate spatial noise. We have also noted in the "Future directions" section that we hope to implement alternatives to random or stratified random designs to allow for more comprehensive evaluations of various designs.*</p>
    <supplementary-material content-type="local-data" id="pone.0232822.s008">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_letter.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0232822.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0232822.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Daniel E. Duplisea</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Daniel E. Duplisea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">2 Apr 2020</named-content>
    </p>
    <p>PONE-D-19-26904R2</p>
    <p>SimSurvey: an R package for comparing the design and analysis of surveys by simulating spatially-correlated populations</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Regular,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>Please address the reviewer's new comments.</p>
    <p>We would appreciate receiving your revised manuscript by May 17 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Daniel E. Duplisea, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (if provided):</p>
    <p>The reviewer has provided some additional comments which should be addressed.</p>
    <p>Reviewer 2</p>
    <p>Reviewer 2</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: This is my second time reviewing this manuscript and the authors did a great job addressing people's comments. Great job for that. The manuscript is now much clearer and read well, I think.</p>
    <p>This time, I only have a few minor comments:</p>
    <p>L19 : «there is a limited number of»</p>
    <p>L103: Maybe it would be a good idea to justify why you are converting to abundance at length.</p>
    <p>L240-242: I think it could be a good idea to show how to exactly do this (maybe obvious to advanced people but not to the general audience). This could be a simple reference to an example on the github repo.</p>
    <p>Table 2: If bias correction was not implemented, I would suggest to change the labeling in the table here and elsewhere (if needed) and replace the “mean” by “median” (if the variable is transformed back to the original scale). If not, I would make clear that you talk about mean in log scale.</p>
    <p>L326: I did not see how one can use INLA or RandomFields in Appendix S3. This is a similar comment as the one for line 240-242.</p>
    <p>L481-490: the processing time is surprisingly long… it is not an issue in itself but this might refrain some people to using this package… I think some code optimization could help (e.g. vectorize, use matrix operation as much as possible, etc)</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0232822.r006" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r006</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 2</article-title>
    </title-group>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Apr 2020</named-content>
    </p>
    <p>Reviewer #1: This is my second time reviewing this manuscript and the authors did a great job addressing people's comments. Great job for that. The manuscript is now much clearer and read well, I think.</p>
    <p>*We thank the reviewer for the kind words.* </p>
    <p>This time, I only have a few minor comments: </p>
    <p>L19 : «there is a limited number of» </p>
    <p>*We have removed the 'the' that should not have been in that sentence.*</p>
    <p>L103: Maybe it would be a good idea to justify why you are converting to abundance at length. </p>
    <p>*Agreed, we have started a new paragraph regarding abundance at length which begins: "In practice, abundance at age is often inferred from length data as it is easier to collect. Abundance at length is therefore simulated from abundance at age using the original von Bertalanffy growth curve"*</p>
    <p>L240-242: I think it could be a good idea to show how to exactly do this (maybe obvious to advanced people but not to the general audience). This could be a simple reference to an example on the github repo. </p>
    <p>*Indeed, this is a helpful idea and we have now created a short vignette on creating closures and this can be accessed via the pkgdown site (<ext-link ext-link-type="uri" xlink:href="https://paulregular.github.io/SimSurvey/articles/custom_closures.html">https://paulregular.github.io/SimSurvey/articles/custom_closures.html</ext-link>). A link to this vignette has been added to the paper.*</p>
    <p>Table 2: If bias correction was not implemented, I would suggest to change the labeling in the table here and elsewhere (if needed) and replace the “mean” by “median” (if the variable is transformed back to the original scale). If not, I would make clear that you talk about mean in log scale. </p>
    <p>*Good catch, we have added log after mean to ensure that readers know the functions are operating in log scale.*</p>
    <p>L326: I did not see how one can use INLA or RandomFields in Appendix S3. This is a similar comment as the one for line 240-242. </p>
    <p>*We have added the following in parentheses: see the code behind `sim_ays_covar_sped` [<ext-link ext-link-type="uri" xlink:href="https://github.com/PaulRegular/SimSurvey/blob/master/R/sim_dist_spde.R">https://github.com/PaulRegular/SimSurvey/blob/master/R/sim_dist_spde.R</ext-link>] for an example of how the `sim_ays_covar` closure was modified to apply a Stochastic Partial Differential Equation approach using the `INLA` package.*</p>
    <p>L481-490: the processing time is surprisingly long… it is not an issue in itself but this might refrain some people to using this package… I think some code optimization could help (e.g. vectorize, use matrix operation as much as possible, etc) </p>
    <p>*We have stretched our programming skills to the limit to reduce the processing time as much as possible. Of course, said programming skills are largely self-taught, so there is surely room for improvement. While developing the package, we repeatedly profiled our code and vectorized as much as we could, leaning heavily on the `data.table` package. We have also applied parallel processing in places in an attempt to speed up the code. In other parts of the package, we learned that there is little we can do to reduce the processing time (e.g. Cholesky decomposition is a factor limiting the speed of the `sim_distribution` function). Another step to further optimize the code would be to translate some of the core functions to C++, however this is on the wish list and well outside the scope of the project at this point in time. We are hopeful that we have produced enough here to catalyze collaborations that help extend and optimize the package.*</p>
    <supplementary-material content-type="local-data" id="pone.0232822.s009">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_letter.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0232822.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0232822.r007" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r007</article-id>
    <title-group>
      <article-title>Decision Letter 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Daniel E. Duplisea</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Daniel E. Duplisea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj007" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">23 Apr 2020</named-content>
    </p>
    <p>SimSurvey: an R package for comparing the design and analysis of surveys by simulating spatially-correlated populations</p>
    <p>PONE-D-19-26904R3</p>
    <p>Dear Dr. Regular,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Daniel E. Duplisea, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
<sub-article id="pone.0232822.r008" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0232822.r008</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Duplisea</surname>
          <given-names>Daniel E.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Daniel E. Duplisea</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Daniel E. Duplisea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj008" ext-link-type="doi" xlink:href="10.1371/journal.pone.0232822" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">27 Apr 2020</named-content>
    </p>
    <p>PONE-D-19-26904R3 </p>
    <p>SimSurvey: an R package for comparing the design and analysis of surveys by simulating spatially-correlated populations </p>
    <p>Dear Dr. Regular:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr Daniel E. Duplisea </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
