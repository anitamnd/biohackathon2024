<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2216047</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-439</article-id>
    <article-id pub-id-type="pmid">17997843</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-439</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BGX: a Bioconductor package for the Bayesian integrated analysis of Affymetrix GeneChips</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Turro</surname>
          <given-names>Ernest</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ernest.turro@ic.ac.uk</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Bochkina</surname>
          <given-names>Natalia</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>n.bochkina@ed.ac.uk</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Hein</surname>
          <given-names>Anne-Mette K</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>anne.mette.hein@ki.au.dk</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>Sylvia</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>sylvia.richardson@imperial.ac.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Centre for Biostatistics, Imperial College London, UK</aff>
    <aff id="I2"><label>2</label>Department of Mathematics, University of Edinburgh, UK</aff>
    <aff id="I3"><label>3</label>Molecular Diagnostic Laboratory, Skejby Hospital, Aarhus University, Denmark</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>11</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>439</fpage>
    <lpage>439</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/439"/>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>9</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>11</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Turro et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Turro et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Turro
               Ernest
               
               ernest.turro@ic.ac.uk
            </dc:author><dc:title>
            BGX: a Bioconductor package for the Bayesian integrated analysis of Affymetrix GeneChips
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 439-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;439&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Affymetrix 3' GeneChip microarrays are widely used to profile the expression of thousands of genes simultaneously. They differ from many other microarray types in that GeneChips are hybridised using a single labelled extract and because they contain multiple 'match' and 'mismatch' sequences for each transcript. Most algorithms extract the signal from GeneChip experiments in a sequence of separate steps, including background correction and normalisation, which inhibits the simultaneous use of all available information. They principally provide a point estimate of gene expression and, in contrast to BGX, do not fully integrate the uncertainty arising from potentially heterogeneous responses of the probes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>BGX is a new Bioconductor R package that implements an integrated Bayesian approach to the analysis of 3' GeneChip data. The software takes into account additive and multiplicative error, non-specific hybridisation and replicate summarisation in the spirit of the model outlined in [<xref ref-type="bibr" rid="B1">1</xref>]. It also provides a posterior distribution for the expression of each gene. Moreover, BGX can take into account probe affinity effects from probe sequence information where available. The package employs a novel adaptive Markov chain Monte Carlo (MCMC) algorithm that raises considerably the efficiency with which the posterior distributions are sampled from. Finally, BGX incorporates various ways to analyse the results, such as ranking genes by expression level as well as statistically based methods for estimating the amount of up and down regulated genes between two conditions.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>BGX performs well relative to other widely used methods at estimating expression levels and fold changes. It has the advantage that it provides a statistically sound measure of uncertainty for its estimates. BGX includes various analysis functions to visualise and exploit the rich output that is produced by the Bayesian model.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Oligonucleotide microarrays allow biomedical researchers to estimate the expression of thousands of genes simultaneously through their mRNA transcripts. A labelled, fragmented version of the RNA may be hybridised onto an array containing hundreds of thousands of complementary oligonucleotides and then scanned. Affymetrix 3' GeneChip arrays represent genes by sets of probe pairs, each of which consists of an oligonucleotide of length 25 which matches a corresponding RNA subsequence perfectly (PM) and an identical probe with an inverted oligonucleotide on position 13 (MM) that is intended to measure non-specific hybridisation.</p>
    <p>The BGX model [<xref ref-type="bibr" rid="B1">1</xref>] is an integrated approach to the analysis of GeneChip microarrays in which correction for non-specific hybridisation and gene expression level estimation are performed simultaneously. Posterior distributions of parameters in the model may be obtained numerically. Based on these distributions, a powerful method for detecting differential expression has been developed [<xref ref-type="bibr" rid="B2">2</xref>].</p>
    <p>The probes on Affymetrix GeneChips have been found to exhibit varying propensities to "shine" according to the base composition of their sequences [<xref ref-type="bibr" rid="B3">3</xref>] and methods for estimating expression levels from GeneChips that incorporate probe affinity effects have shown demonstrable advances over methods in which these effects are ignored (see, e.g. [<xref ref-type="bibr" rid="B4">4</xref>]). We present a new Bioconductor [<xref ref-type="bibr" rid="B5">5</xref>] package that implements the BGX model, includes an extension to incorporate probe affinity effects, employs novel algorithmic techniques to sample effectively from posterior distributions, and provides various analysis and plotting functions.</p>
    <sec>
      <title>Implementation</title>
      <sec>
        <title>Basic model</title>
        <p>BGX [<xref ref-type="bibr" rid="B1">1</xref>] explicitly models probe intensities as arising partly from specific hybridisation, <italic>S </italic>(the signal), and partly from non-specific hybridisation, <italic>H</italic>, with only a fraction, <italic>φ</italic>, of the signal occuring at a PM probe also occurring at the corresponding MM probe. The <italic>S</italic>s and <italic>H</italic>s are gene (<italic>g</italic>), probe (<italic>j</italic>), condition (<italic>c</italic>) and replicate (<italic>r</italic>) specific, and the intensities are assumed to be affected by an additive array-specific noise:</p>
        <p>
          <disp-formula id="bmcM1">
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-439-i1" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>PM</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>~</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>S</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>H</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msubsup>
                    <mml:mi>τ</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaeeiuaaLaeeyta00aaSbaaSqaaiabdEgaNjabdQgaQjabdogaJjabdkhaYbqabaGccqGG+bGFcqWGobGtcqGGOaakcqWGtbWudaWgaaWcbaGaem4zaCMaemOAaOMaem4yamMaemOCaihabeaakiabgUcaRiabdIeainaaBaaaleaacqWGNbWzcqWGQbGAcqWGJbWycqWGYbGCaeqaaOGaeiilaWccciGae8hXdq3aa0baaSqaaiabdogaJjabdkhaYbqaaiabikdaYaaakiabcMcaPiabcYcaSaaa@4E51@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM2">
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-439-i2" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>MM</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>~</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>φ</mml:mi>
                  <mml:msub>
                    <mml:mi>S</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>H</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msubsup>
                    <mml:mi>τ</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaeeyta0Kaeeyta00aaSbaaSqaaiabdEgaNjabdQgaQjabdogaJjabdkhaYbqabaGccqGG+bGFcqWGobGtcqGGOaakiiGacqWFgpGzcqWGtbWudaWgaaWcbaGaem4zaCMaemOAaOMaem4yamMaemOCaihabeaakiabgUcaRiabdIeainaaBaaaleaacqWGNbWzcqWGQbGAcqWGJbWycqWGYbGCaeqaaOGaeiilaWIae8hXdq3aa0baaSqaaiabdogaJjabdkhaYbqaaiabikdaYaaakiabcMcaPiabc6caUaaa@5003@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>The log-transformed signal parameter, log(<italic>S</italic><sub><italic>gjcr </italic></sub>+ 1), is assumed to follow a gene and condition specific distribution, while the log-transformed non-specific hybridisation term, log(<italic>H</italic><sub><italic>gjcr </italic></sub>+ 1), is assumed to arise from an array-specific distribution:</p>
        <p>
          <disp-formula id="bmcM3">
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-439-i3" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>log</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>S</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>~</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>μ</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msubsup>
                    <mml:mi>σ</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGagiiBaWMaei4Ba8Maei4zaCMaeiikaGIaem4uam1aaSbaaSqaaiabdEgaNjabdQgaQjabdogaJjabdkhaYbqabaGccqGHRaWkcqaIXaqmcqGGPaqkcqGG+bGFcqWGubavcqWGobGtcqGGOaakiiGacqWF8oqBdaWgaaWcbaGaem4zaCMaem4yamgabeaakiabcYcaSiab=n8aZnaaDaaaleaacqWGNbWzcqWGJbWyaeaacqaIYaGmaaGccqGGPaqkcqGGSaalaaa@4C0A@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM4">
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-439-i4" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>log</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>H</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>~</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>λ</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msubsup>
                    <mml:mi>η</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGagiiBaWMaei4Ba8Maei4zaCMaeiikaGIaemisaG0aaSbaaSqaaiabdEgaNjabdQgaQjabdogaJjabdkhaYbqabaGccqGHRaWkcqaIXaqmcqGGPaqkcqGG+bGFcqWGubavcqWGobGtcqGGOaakiiGacqWF7oaBdaWgaaWcbaGaem4yamMaemOCaihabeaakiabcYcaSiab=D7aOnaaDaaaleaacqWGJbWycqWGYbGCaeaacqaIYaGmaaGccqGGPaqkcqGGSaalaaa@4C07@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>TN </italic>denotes the truncated normal distribution, truncated to the positive axis. The central parameter of equation (3), <italic>μ</italic><sub><italic>gc</italic></sub>, acts as the BGX expression measure, and equations (1) to (4) represent the basic BGX model.</p>
        <p>The core of the model is implemented in the C++ programming language for efficiency and uses MCMC to sample from the full posterior distributions of each parameter. Parameters are estimated using Gibbs sampling where possible (<italic>φ </italic>and <italic>τ</italic>) and a Random Walk Metropolis-Hastings algorithm elsewhere (<italic>S</italic>, <italic>H</italic>, <italic>μ</italic>, <italic>σ</italic>, <italic>λ </italic>and <italic>η</italic>). Three C++ class templates are used to instantiate zero, one and two-dimensional MCMC update objects for each parameter according to the dimensionality of the corresponding suffixes. Each of the instantiated objects is updated in sequence using references to all other necessary parameters during a burn-in period, which is discarded, and a sampling period, which is used for the posterior distributions.</p>
      </sec>
      <sec>
        <title>Probe affinity extension</title>
        <p>It has been observed that the propensity of probes to hybridise to mRNA is affected by their base composition [<xref ref-type="bibr" rid="B3">3</xref>]. In particular, probes with a high number of cytosine bases have a high propensity to hybridise while probes with a high number of adenine bases exhibit the opposite tendency. Moreover, the nearer the bases are to the centre of the oligonucleotide, the greater the effect. We account for this in an extension to the core model that incorporate affnity effects in the modelling of non-specific hybridisation. We categorise probes in the following way: let α be a function which, for each gene and probe pair, (<italic>g, j</italic>), gives the affnity category of a given probe: <italic>α </italic>: (<italic>g, j</italic>) → {1, ..., <italic>K</italic>} (defined below). We refine equation (4) by allowing for a category and array specific distribution of the non-specific hybridisation parameter:</p>
        <p>
          <disp-formula id="bmcM5">
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-439-i5" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>log</mml:mi>
                  <mml:mo>⁡</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>H</mml:mi>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>~</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msubsup>
                    <mml:mi>λ</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>g</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>,</mml:mo>
                  <mml:msubsup>
                    <mml:mi>η</mml:mi>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGagiiBaWMaei4Ba8Maei4zaCMaeiikaGIaemisaG0aaSbaaSqaaiabdEgaNjabdQgaQjabdogaJjabdkhaYbqabaGccqGHRaWkcqaIXaqmcqGGPaqkcqGG+bGFcqWGubavcqWGobGtcqGGOaakiiGacqWF7oaBdaqhaaWcbaGaem4yamMaemOCaihabaGae8xSdeMaeiikaGIaem4zaCMaeiilaWIaemOAaOMaeiykaKcaaOGaeiilaWIae83TdG2aa0baaSqaaiabdogaJjabdkhaYbqaaiabikdaYaaakiabcMcaPiabc6caUaaa@52EC@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>The extended model, which we denote GCBGX, is based on equations (1), (2), (3) and (5).</p>
        <p>The probes on the arrays are, prior to analysis, grouped into a number of probe affinity categories. This is done by: (a) calculating the probe affinities using the <italic>gcrma </italic>Bioconductor package [<xref ref-type="bibr" rid="B4">4</xref>], (b) rounding them to the first decimal place, (c) assigning each value to a preliminary probe affinity category and (d) ensuring that the final categories contain a sufficient number of probes by collapsing small preliminary categories together. We enumerate the resulting probe affinity categories 1, ... , <italic>K </italic>by increasing affinity. Once categorised, the affinity-specific parameters are estimated from the data, simultaneously with all other parameters.</p>
        <p>In some cases, Affymetrix do not directly provide the sequences for all probesets due to licensing restrictions and, consequently, there are Bioconductor probe packages that do not contain complete sequence information. For example, <italic>hgu95aprobe </italic>(version ≤ 1.16.2) lacks sequences for probes belonging to 172 probesets. We tackled this problem by treating <italic>α</italic>(<italic>g, j</italic>) as a random variable, taking values from 1 to <italic>K</italic>, with prior probability equal to the observed frequency of the categories, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-439-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaemiCaa3aaSbaaSqaaiabdUgaRbqabaGccqGH9aqpjuaGdaWcaaqaaiabd6eaonaaBaaabaGaem4AaSgabeaaaeaacqWGobGtaaaaaa@343F@</mml:annotation></mml:semantics></mml:math></inline-formula>, where <italic>N</italic><sub><italic>k </italic></sub>is the number of probes in category <italic>k </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-439-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaemOta4Kaeyypa0ZaaabmaeaacqWGobGtdaWgaaWcbaGaem4AaSgabeaaaeaacqWGRbWAcqGH9aqpcqaIXaqmaeaacqWGlbWsa0GaeyyeIuoaaaa@3719@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>Adaptive MCMC</title>
        <p>The full conditional distributions of <italic>S</italic>, <italic>H</italic>, <italic>μ</italic>, <italic>σ</italic>, <italic>λ </italic>and <italic>η </italic>are updated by drawing new values from a proposal distribution, typically a Random Walk (RW) Gaussian proposal centred on the current value with a chosen variance. A typical experiment consists of several hundred thousand probes, resulting in potentially millions of <italic>S </italic>and <italic>H </italic>components and tens of thousands of <italic>μ </italic>and <italic>σ </italic>components. Each component of a given parameter has a different support and consequently a different optimal RW proposal variance. Using a fixed variance for all components results in excessively low or high acceptance ratios for a large proportion of components, leading to highly autocorrelated chains.</p>
        <p>In order to tackle this problem, we implemented the novel Adaptive Metropolis-Within-Gibbs algorithm recently proposed by Roberts and Rosenthal [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. We used a unique proposal variance for each object, which adapts to its optimal value after successive batches of 50 iterations. The aim is to achieve an acceptance ratio of around 0.44, which has been shown to be optimal for one-dimensional proposals in certain settings [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>], and is commonly accepted as being a sensible benchmark. An acceptance rate that is close to zero implies inefficient mixing, while an acceptance rate that is close to one implies the probability space is not efficiently explored. The algorithm proceeds as follows:</p>
        <p>• For each component <italic>c </italic>of parameter <italic>p</italic>, assign a parameter-specific starting value to the corresponding proposal variance, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-439-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacciGae83Wdm3aa0baaSqaaiabdogaJjabdchaWbqaaiabikdaYaaaaaa@3174@</mml:annotation></mml:semantics></mml:math></inline-formula></p>
        <p>• Choose a sequence <italic>δ </italic>(<italic>n</italic>) → 0. We chose <italic>δ </italic>(<italic>n</italic>) = min(0.01, <italic>n</italic><sup>-1/2</sup>)</p>
        <p>• Start the MCMC simulation</p>
        <p>• After the <italic>n</italic><sup>th </sup>batch of 50 iterations, calculate the acceptance ratio over the last batch</p>
        <p>• If the acceptance ratio is less than the optimal value of 0.44, increase log(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-8-439-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacciGae83Wdm3aa0baaSqaaiabdogaJjabdchaWbqaaiabikdaYaaaaaa@3174@</mml:annotation></mml:semantics></mml:math></inline-formula>) by <italic>δ </italic>(<italic>n</italic>), else decrease it by <italic>δ </italic>(<italic>n</italic>)</p>
        <p>The algorithm preserves ergodicity as long as each kernel has the right stationary distribution; the total variation distance between successive kernels tends to zero in probability; and the convergence time of each kernel is bounded in probability [<xref ref-type="bibr" rid="B6">6</xref>].</p>
      </sec>
      <sec>
        <title>R package</title>
        <p>The C++ component of BGX is compiled as a shared object which is loaded and executed automatically from within the R package [<xref ref-type="bibr" rid="B10">10</xref>]. BGX integrates standard Bioconductor classes such as <monospace>AffyBatch</monospace> to store raw microarray data and <monospace>ExpressionSet</monospace> to store processed gene expression measures. Users interested in running BGX programmatically from a shell script, for instance, or in a more memory-efficient manner, also have the choice to run a standalone binary version of the program.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Usage</title>
      <p>The <italic>bgx </italic>package and its dependencies, <italic>affy </italic>and <italic>gcrma</italic>, may be installed automatically from the Bioconductor repository from an R shell. The package contains documentation and executable examples in a "vignette" file available using <monospace>openVignette()</monospace>. Users who wish to compile <italic>bgx </italic>from source will require the Boost C++ libraries [<xref ref-type="bibr" rid="B11">11</xref>] and the <monospace>hgu95av2cdf</monospace> Bioconductor package. The core functionality of the package is contained in the bgx function, which takes an <monospace>AffyBatch</monospace> object instantiated from one or more GeneChip CEL files as its first argument and returns an <monospace>ExpressionSet</monospace> object containing expression values for each gene and condition:</p>
      <p>aData &lt;- ReadAffy("chip1.CEL","chip2.CEL")</p>
      <p>eset &lt;- bgx(aData)</p>
      <p>assayData(eset)$exprs # Returns expression values</p>
      <p>assayData(eset)$se.exprs # Returns standard errors for expression values</p>
      <p>Optional arguments include <monospace>samplesets</monospace>, which specifies the experimental design; genes, which specifies a subset of genes to analyse; <monospace>burnin</monospace> and <monospace>iter</monospace>, which specify the number of iterations for the burn-in and post burn-in phases of the algorithm respectively; <monospace>probeAff</monospace>, which specifies whether or not to use the probe affinity extension to the original BGX model, and <monospace>adaptive</monospace>, which specifies whether or not to use Metropolis-Within-Gibbs step adaptation. Full documentation for the <monospace>bgx</monospace> function is available by running <monospace>help(bgx)</monospace>.</p>
      <p>Although the point measures returned in the <monospace>ExpressionSet</monospace> object are useful, the distinctive power of the BGX method is that it provides samples from the full posterior distributions of the expression parameter, <italic>μ</italic><sub><italic>gc</italic></sub>. These samples are, by default, saved in directories named <monospace>run.1, run.2</monospace>, <italic>etc</italic>. in R's current working directory, although this may be overridden with the <monospace>rundir</monospace> argument. They may be read into R in order to analyse the results of a simulation as follows:</p>
      <p>bgxOutput &lt;- readOutput.bgx("run.1")</p>
      <p>The <monospace>bgxOutput</monospace> object is assigned to a list containing values from the full posterior distributions of <italic>μ</italic><sub><italic>gc </italic></sub><monospace>(bgxOutput$mu)</monospace>, their expected values <monospace>(bgxOutput$muave)</monospace> and the gene names <monospace>(bgxOutput$geneNames)</monospace>. This object can be passed to a number of functions to analyse the results. In particular, this object provides a direct measure of the variance of gene expression, a quantity which is only sometimes available when fitting robust linear models (e.g. using the AffyPLM Bioconductor package). The difference in expression between two conditions, <italic>μ</italic><sub><italic>g</italic>2 </sub>- <italic>μ</italic><sub><italic>g</italic>1</sub>, may be visualised with the <monospace>plotExpressionDensity</monospace> and <monospace>plotDEDensity</monospace> functions (Figure <xref ref-type="fig" rid="F1">1</xref>). <monospace>plotDEHistogram</monospace> fits a spline to the histogram of <italic>P</italic>(<italic>μ</italic><sub><italic>g</italic>2 </sub>- <italic>μ</italic><sub><italic>g</italic>1 </sub>&lt; 0) using Poisson regression, estimates the null distribution by spline fitting of the central part of the histogram, and uses the difference between the histogram fit and the null distribution to give a preliminary estimate of the number of differentially expressed genes (Figure <xref ref-type="fig" rid="F2">2</xref>) [<xref ref-type="bibr" rid="B2">2</xref>]. A more thorough approach to the problem of classifying genes by differential expression may be found in the BGmix Bioconductor package — an implementation of a fully Bayesian mixture model for differential expression – which can analyse BGX output directly (Lewin, Bochkina and Richardson: Fully Bayesian mixture model for differential gene expression: simulations and model checks, submitted). <monospace>rankByDE</monospace> returns a matrix that ranks genes by their standardised BGX differences between two conditions (see Equation (7)) and specifies each gene's name, index and differential expression measure. More information on each function is available via <monospace>help(analysis.bgx)</monospace>.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Expression and differential expression densities</bold>. <monospace>plotExpressionDensity</monospace> plots the density of    the posterior distribution of a given gene under each condition    (left). <monospace>plotDEDensity</monospace> plots the density of the difference in    the posterior distributions of a given gene between two conditions    (right).  </p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-1"/>
      </fig>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Estimating the number of differentially expressed genes</bold>. <monospace>plotDEHistogram</monospace> plots a histogram of <italic>P</italic>(<italic>μ</italic><sub><italic>g</italic>2 </sub>- <italic>μ</italic><sub><italic>g</italic>1 </sub>&lt; 0), which is used to estimate the number of up and down-regulated genes between two conditions using a routine incorporated in the package.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-2"/>
      </fig>
      <p>For the purposes of this paper, BGX was run with the "gold standard" of 16 k burn-in iterations and 64 k sampling iterations. However, the recommended 8 k burn-in iterations and 16 k sampling iterations are sufficient to provide good estimates of <italic>μ</italic><sub><italic>g </italic></sub>(Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>). Under these settings, BGX takes approximately one hour per array on a standard 64-bit 3 GHz computer. Analyses of up to 100 arrays ought to "fit" in a computer equipped with 4 GB of memory. However, BGX may be run separately for each condition, and the output subsequently combined in R by passing multiple output directories to the <monospace>readOutput.bgx</monospace> function. Since <italic>φ</italic>, the only parameter that is shared between conditions, is very stable for a given type of array, the impact on the output of running BGX separately on each condition is negligible.</p>
    </sec>
    <sec>
      <title>Estimation of non-specific hybridisation</title>
      <p>The GCBGX model groups MM probes into categories that have similar probe affinities based on their oligonucleotide content. Instead of using a single array-specific parameter, <italic>λ</italic><sub><italic>cr </italic></sub>(Equation (4)), we associate an appropriate <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-8-439-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacciGae83UdW2aa0baaSqaaiabdogaJjabdkhaYbqaaiab=f7aHjabcIcaOiabdEgaNjabcYcaSiabdQgaQjabcMcaPaaaaaa@3757@</mml:annotation></mml:semantics></mml:math></inline-formula> component with each probe (Equation (5)), which should correlate positively with probe affinity categories. Figure <xref ref-type="fig" rid="F3">3</xref> shows a colour-coded density plot of the <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-8-439-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacciGae83UdW2aa0baaSqaaiabdogaJjabdkhaYbqaaiab=f7aHjabcIcaOiabdEgaNjabcYcaSiabdQgaQjabcMcaPaaaaaa@3757@</mml:annotation></mml:semantics></mml:math></inline-formula> parameter obtained in an analysis of the Golden Spike data [<xref ref-type="bibr" rid="B12">12</xref>]. As probe affinity categories increase, the distributions shift from left to right. The black density line corresponds to the <italic>λ</italic><sub><italic>cr </italic></sub>distribution in the original BGX model and highlights the discriminatory power of the probe affinity extension.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Distributions of <italic>λ </italic>for each probe affinity category</bold>. Colour-coded density plot of the <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-8-439-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacciGae83UdW2aa0baaSqaaiabdogaJjabdkhaYbqaaiab=f7aHjabcIcaOiabdEgaNjabcYcaSiabdQgaQjabcMcaPaaaaaa@3757@</mml:annotation></mml:semantics></mml:math></inline-formula> parameter of an analysis of the Golden Spike data set. As probe affinity categories increase, the distributions shift from left to right. The black density line is the <italic>λ</italic><sub><italic>cr </italic></sub>distribution from the original BGX model and illustrates the discriminatory power of the probe affinity extension.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-3"/>
      </fig>
      <p>Probes with unknown sequences have their affinity categories estimated from the data. In order to check the effectiveness of this approach, we performed cross-validation on one out of every 100 genes from the Golden Spike data set, and compared the median estimated category to its true value. Figure <xref ref-type="fig" rid="F4">4</xref> shows a positive correlation between estimated and true categories, particularly for high-affinity probes.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Estimating the affinity of probes with unknown sequence</bold>. Sequence information was artificially removed from one out ever 100 genes from the Golden Spike data set and the corresponding probes' affinity categories were estimated from the data. There is a positive correlation between estimated and true categories, particularly for high-affinity probes.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-4"/>
      </fig>
    </sec>
    <sec>
      <title>Performance of adaptive MCMC</title>
      <p>BGX is a computationally intensive program and it is therefore desirable to use an MCMC algorithm that mixes efficiently. One quantity of interest in this respect is the integrated autocorrelation time (IACT), which inflates the variance of the sample mean, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-8-439-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGafmiwaGLbaebaaaa@2D24@</mml:annotation></mml:semantics></mml:math></inline-formula>[<xref ref-type="bibr" rid="B13">13</xref>]. To be precise, the variance of the sample mean may be expressed as follows [<xref ref-type="bibr" rid="B14">14</xref>]:</p>
      <p>
        <disp-formula id="bmcM6">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-8-439-i11" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>v</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>X</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>S</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>X</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mi>a</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>X</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaacbiGae8NDayNae8xyaeMae8NCaiNaeiikaGIafmiwaGLbaebacqGGPaqkcqGH9aqpcqWGfbqrdaWadaqcfayaamaalaaabaGaem4uam1aaWbaaeqabaGaeGOmaidaaiabcIcaOiabdIfayjabcMcaPaqaaiabd6gaUbaaaOGaay5waiaaw2faaiabgwSixNqbaoaalaaabaGaemOBa4MaeyOeI0IaeGymaedabaGaeiikaGIaemOBa4Maei4la8IaemyyaeMaeiikaGIaemiwaGLaeiykaKIaeiykaKIaeyOeI0IaeGymaedaaaaa@4ED0@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>X </italic>is an autocorrelated sample of size <italic>n </italic>with empirical mean <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-8-439-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGafmiwaGLbaebaaaa@2D24@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-8-439-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaem4uam1aaWbaaSqabeaacqaIYaGmaaGccqGGOaakcqWGybawcqGGPaqkcqGH9aqpjuaGdaWcaaqaaiabigdaXaqaaiabd6gaUjabgkHiTiabigdaXaaakmaaqababaGaeiikaGIaemiwaG1aaSbaaSqaaiabdMgaPbqabaGccqGHsislcuWGybawgaqeaiabcMcaPmaaCaaaleqabaGaeGOmaidaaaqaaiabdMgaPbqab0GaeyyeIuoaaaa@4202@</mml:annotation></mml:semantics></mml:math></inline-formula>, and <italic>a</italic>(<italic>X</italic>) is the integrated autocorrelation time (IACT), defined as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-8-439-i13" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>X</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>+</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mfrac>
                              <mml:mi>j</mml:mi>
                              <mml:mi>n</mml:mi>
                            </mml:mfrac>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:msub>
                          <mml:mi>P</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaemyyaeMaeiikaGIaemiwaGLaeiykaKIaeyypa0ZaamWaaeaacqaIXaqmcqGHRaWkcqaIYaGmdaaeWbqaamaabmaabaGaeGymaeJaeyOeI0scfa4aaSaaaeaacqWGQbGAaeaacqWGUbGBaaaakiaawIcacaGLPaaacqWGqbaudaWgaaWcbaGaemOAaOgabeaaaeaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGUbGBcqGHsislcqaIXaqma0GaeyyeIuoaaOGaay5waiaaw2faaaaa@486B@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-8-439-i14" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>P</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:mi>v</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>X</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mi>v</mml:mi>
                        <mml:mi>a</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>X</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mi>v</mml:mi>
                        <mml:mi>a</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaemiuaa1aaSbaaSqaaiabdQgaQbqabaGccqGH9aqpjuaGdaWcaaqaaiabdogaJjabd+gaVjabdAha2jabcIcaOiabdIfaynaaBaaabaGaemyAaKgabeaacqGGSaalcqWGybawdaWgaaqaaiabdMgaPjabgUcaRiabdQgaQbqabaGaeiykaKcabaWaaOaaaeaacqWG2bGDcqWGHbqycqWGYbGCcqGGOaakcqWGybawdaWgaaqaaiabdMgaPbqabaGaeiykaKIaemODayNaemyyaeMaemOCaiNaeiikaGIaemiwaG1aaSbaaeaacqWGPbqAcqGHRaWkcqWGQbGAaeqaaiabcMcaPaqabaaaaOGaeiOla4caaa@534C@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Evidently, if the sample is not autocorrelated, then <italic>P</italic><sub><italic>j </italic></sub>= 0 for all <italic>j</italic>, <italic>a</italic>(<italic>X</italic>) collapses to 1 and <italic>var</italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-8-439-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGafmiwaGLbaebaaaa@2D24@</mml:annotation></mml:semantics></mml:math></inline-formula>) becomes equal to the familiar expression for an IID sample, E [<italic>S</italic><sup>2</sup>(<italic>X</italic>)/<italic>n</italic>]. From (6), the IACT of a chain relates positively with the variability of its mean, and thus highly autocorrelated chains lead to poor estimates of our gene expression measure.</p>
      <p>One way of improving our estimates is to increase the number of iterations while maintaining a fixed subsample size. This translates to subsamples being further apart on the original chain and therefore less correlated. It is faster and more attractive, however, to use an adaptive algorithm that explores the probability space more efficiently. Using the Golden Spike data set [<xref ref-type="bibr" rid="B12">12</xref>] for our investigation, we found that the adaptive method led to a range of optimal proposal magnitudes for the Metropolis-Hastings parameters. Figure <xref ref-type="fig" rid="F5">5</xref> illustrates this with a histogram of the optimal log variance for <italic>S </italic>proposals on one array and the original fixed step size overlaid in black. Figure <xref ref-type="fig" rid="F6">6</xref> (left &amp; centre) shows a dramatic reduction in the IACT of the <italic>S </italic>parameters and a milder improvement on the <italic>μ</italic><sub><italic>g </italic></sub>parameters of expressed genes. A similar improvement was observed for the IACT of the <italic>H </italic>parameters, this time for all genes (Figure <xref ref-type="fig" rid="F6">6</xref> right).</p>
      <p>Differential expression can be quantified by the standardised BGX differences between two conditions:</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Adapting the size of MCMC proposal steps</bold>. When the adaptive MCMC algorithm is used, the variance of the Metropolis-Hastings proposal step is adapted independently for each <italic>S </italic>component. The plot shows a histogram of the optimal log variance for <italic>S </italic>proposals and the fixed step size used in the non-adaptive version overlaid in black, highlighting that a wide range of proposal variances are needed.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-5"/>
      </fig>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Decreasing the IACT of expressed genes</bold>. The plots show a dramatic reduction in the IACT of the <italic>S </italic>parameter and a milder improvement on the <italic>μ </italic>parameter of expressed genes (left &amp; centre). A similar improvement was observed for the IACT of the <italic>H </italic>parameter, for all genes (right).</p>
        </caption>
        <graphic xlink:href="1471-2105-8-439-6"/>
      </fig>
      <p>
        <disp-formula id="bmcM7">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-8-439-i15" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>z</mml:mi>
                  <mml:mi>g</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>d</mml:mi>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mi>v</mml:mi>
                        <mml:mi>a</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>d</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>g</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGaemOEaO3aaSbaaSqaaiabdEgaNbqabaGccqGH9aqpdaWcaaqaaiqbdsgaKzaaraWaaSbaaSqaaiabdEgaNbqabaaakeaadaGcaaqaaiabdAha2jabdggaHjabdkhaYjabcIcaOiqbdsgaKzaaraWaaSbaaSqaaiabdEgaNbqabaGccqGGPaqkaSqabaaaaaaa@3C27@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where, from (6), <italic>var</italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-8-439-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaGafmizaqMbaebadaWgaaWcbaGaem4zaCgabeaaaaa@2EBF@</mml:annotation></mml:semantics></mml:math></inline-formula>) is estimated by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-8-439-i17" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>d</mml:mi>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="true">_</mml:mo>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>S</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>d</mml:mi>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mfrac>
                <mml:mo>⋅</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mover accent="true">
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mi>g</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mo stretchy="true">_</mml:mo>
                    </mml:mover>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xI8qiVKYPFjYdHaVhbbf9v8qqaqFr0xc9vqFj0dXdbba91qpepeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaWaaecaaeaacqWG2bGDcqWGHbqycqWGYbGCcqGGOaakcuWGKbazgaqeamaaBaaaleaacqWGNbWzaeqaaOGaeiykaKcacaGLcmaacqGH9aqpjuaGdaWcaaqaaiabdofatnaaCaaabeqaaiabikdaYaaacqGGOaakcqWGKbazdaWgaaqaaiabdEgaNbqabaGaeiykaKcabaGaemOBa4gaaOGaeyyXICDcfa4aaSaaaeaacqWGUbGBcqGHsislcqaIXaqmaeaacqGGOaakcqWGUbGBcqGGVaWldaqiaaqaaiabdggaHjabcIcaOiabdsgaKnaaBaaabaGaem4zaCgabeaacqGGPaqkaiaawkWaaiabgkHiTiabigdaXaaakiabcYcaSaaa@5225@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>dg </italic>= <italic>μ</italic><sub><italic>g</italic>2 </sub>- <italic>μ</italic><sub><italic>g</italic>1</sub>, <italic>g </italic>= 1 ..., <italic>G</italic>, that is, samples from the posterior distribution of the difference in the BGX expression measure for each gene, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-8-439-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaqcfa4aaecaaeaacqWGHbqycqGGOaakcqWGKbazdaWgaaqaaiabdEgaNbqabaGaeiykaKcacaGLcmaaaaa@32E9@</mml:annotation></mml:semantics></mml:math></inline-formula>, the estimate of the Monte Carlo standard error, is calculated using Sokal's adaptive truncated periodogram estimator [?]. Our z-score differs from the measure used in [<xref ref-type="bibr" rid="B2">2</xref>] by a factor of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-8-439-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacPC6xNi=xH8viVGI8Gi=hEeeu0xXdbba9frFj0xb9qqpG0dXdb9aspeI8k8fiI+fsY=rqGqVepae9pg0db9vqaiVgFr0xfr=xfr=xc9adbaqaaeGacaGaaiaabeqaaeqabiWaaaGcbaqcfa4aaOaaaeaacqGGOaakcqGGOaakcqWGUbGBcqGGVaWldaqiaaqaaiabdggaHjabcIcaOiabdsgaKnaaBaaabaGaem4zaCgabeaacqGGPaqkaiaawkWaaiabgkHiTiabigdaXiabcMcaPiabc+caViabcIcaOiabd6gaUjabgkHiTiabigdaXiabcMcaPaqabaaaaa@3F85@</mml:annotation></mml:semantics></mml:math></inline-formula>, which takes into account the autocorrelation structure of the sequence of values generated by the algorithm. Since the adaptive MCMC algorithm has the effect of decreasing <italic>a</italic>(<italic>d</italic><sub><italic>g</italic></sub>) for expressed genes while keeping it approximately constant for non-expressed genes, it leads to an increase in the ranking of expressed genes and consequently in BGX's capacity to detect differential expression.</p>
    </sec>
    <sec>
      <title>Performance on spike-in datasets</title>
      <p>We illustrate the performance of <italic>bgx </italic>by presenting detailed results from analyses of arrays from the Affymetrix Latin Square data [<xref ref-type="bibr" rid="B15">15</xref>] and the Golden Spike data set [<xref ref-type="bibr" rid="B12">12</xref>].</p>
      <sec>
        <title>Latin Square data</title>
        <p>Affymetrix published two data sets for assessing the performance of expression algorithms on their microarrays. The HGU95A data set consists of 16 genes spiked in at known concentrations ranging from 0 to 1024 pM and arrayed in a Latin Square format. We considered 16 instead of the original 14 genes described by Affymetrix because we included two extra spike-ins, 546_at and 33818_at, as reported in [<xref ref-type="bibr" rid="B16">16</xref>]. We used two replicates and 14 unique concentration configurations labelled A to M and Q. 2716 of the probes in this data set had no sequence information and therefore their probe affinity categories were estimated from the data as part of the model. The HGU133A data set consists of 64 genes spiked in at known concentrations ranging from 0 to 512 pM. We considered 64 instead of the original 42 genes described by Affymetrix because we included 22 extra spike-ins, as reported in [<xref ref-type="bibr" rid="B17">17</xref>]. We used all 3 replicates for each of the 14 concentration groups.</p>
        <p>The data from these experiments were analysed using BGX, GCBGX, RMA [<xref ref-type="bibr" rid="B18">18</xref>], GCRMA [<xref ref-type="bibr" rid="B4">4</xref>] and MAS5 [?], and the average expression for each concentration level was recorded. Figure <xref ref-type="fig" rid="F7">7</xref> (left) shows a steeper gradient at levels lower than 4 pM in the HGU95A data set using GCBGX instead of BGX, pointing to an increased ability to detect concentration changes. For both data sets, BGX and GCBGX are more sensitive to changes within the low range than RMA, GCRMA or MAS5 (Figure <xref ref-type="fig" rid="F7">7</xref> left &amp; right).</p>
        <fig position="float" id="F7">
          <label>Figure 7</label>
          <caption>
            <p><bold>Performance on the Latin Square data</bold>. Log concentration vs. mean log estimated expression    of spike-in genes in the HGU95A (left) and HGU133A (right) Latin    Square data sets. There is an increased ability to detect    concentration changes at levels lower than 4 pM in the HGU95A data set    using GCBGX instead of BGX. Both BGX and GCBGX are more sensitive to    changes within the low range than RMA or GCRMA and more sensitive to    changes between 0.5 pM and 16 pM than MAS5. The MAS5 concentration    line was shifted down by 2.5 units to facilitate the comparison of its    gradient with those of the other lines.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-439-7"/>
        </fig>
      </sec>
      <sec>
        <title>Golden Spike data set</title>
        <p>The Golden Spike data set consists of six DrosGenome1 GeneChips, with three technical replicates from two conditions: C and S. There are 14010 probe sets in each array representing 14010 genes. 2535 of these are expressed equally under both conditions while 1331 genes are up-regulated in S relative to C. The data is highly valuable for comparing chip analysis methods because it is fully controlled and contains very realistic noise. Due to the asymmetry of the spike-ins, a normalisation of the posterior distributions similar to that advocated in [<xref ref-type="bibr" rid="B12">12</xref>] was carried out by fitting a loess curve to the MA plot [<xref ref-type="bibr" rid="B19">19</xref>] of the posterior mean values of <italic>μ</italic><sub><italic>gc </italic></sub>for the non-differentially expressed genes, predicting a curve from the fit for all genes, and subtracting the curve from the posterior distributions of the differences in expression. The RMA, GCRMA and MAS5 expression measures were similarly adjusted using loess normalisation at the probeset level instead of the default quantile normalisation at the probe level.</p>
        <p>Receiver operating characteristic (ROC) curves depict the observed false discovery rate vs. the true positive rate as the cut-off of a ranked gene list is varied. Figure <xref ref-type="fig" rid="F8">8</xref> (left) shows average ROC curves for the nine single-array comparisons between condition C and condition S while Figure <xref ref-type="fig" rid="F8">8</xref> (right) shows ROC curves for three-replicate comparisons. GCBGX has a small advantage over BGX and both models perform well. In the single-array comparisons, BGX and GCBGX outperform RMA, GCRMA and MAS5 for false discovery rates below 30%. The number of differentially expressed genes (DEGs) were estimated by running <monospace>plotDEHistogram</monospace> on the output of the nine comparisons involving one array from condition C versus one array from condition S. The number of genes detected as up-regulated with GCBGX ranged from 681 to 883 (mean 783) and for BGX from 560 to 867 (mean 742). Both methods produced an average true positive rate across the nine comparisons of over 97% for up-regulated genes. In the three-replicate comparisons, BGX and GCBGX outperform RMA, GCRMA and MAS5 for false discovery rates below 20%. An analysis of a three-replicate comparison yielded 1002 and 958 DEGs with 96.6% and 95.7% true positive rates using GCBGX and BGX respectively.</p>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p><bold>Performance on the Golden Spike data</bold>. Nine single-array comparisons (left) and three-   replicate comparisons (right) between condition C and S were performed    using BGX, GCBGX, RMA, GCRMA and MAS5. The ROC curves show that GCBGX    has a small advantage over BGX and that both models perform well. For    false discovery rates below 20%, BGX and GCBGX outperform RMA, GCRMA    and MAS5.  </p>
          </caption>
          <graphic xlink:href="1471-2105-8-439-8"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>BGX is a new Bioconductor R package for analysing 3' Affymetrix GeneChips. BGX implements a fully integrated Bayesian hierarchical model with the option to take into account sequence-dependent probe affinities. BGX uses a novel adaptive MCMC algorithm that improves the efficiency with which the posterior distributions of parameters are sampled from. BGX compares favourably to RMA and GCRMA at detecting differential expression, particularly at low concentration levels.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name: </bold>BGX</p>
    <p>
      <bold>Project homepage: </bold>
      <ext-link ext-link-type="uri" xlink:href="http://bgx.org.uk"/>
    </p>
    <p><bold>Operating systems: </bold>Platform independent</p>
    <p><bold>Programming language: </bold>C++, R</p>
    <p><bold>Other requirements: </bold>R, Bioconductor</p>
    <p><bold>License: </bold>GNU GPL</p>
    <p><bold>Any restrictions to use by non-academics: </bold>No</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>ET implemented and tested the code and developed the adaptive MCMC. AKH and SR extended the BGX model to take into account probe affinity effects. NB and ET modelled and implemented probe affinity estimation of probes with missing sequences. ET, AKH, NB and SR provided comments and discussion and wrote the paper. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Varying the number of sampling iterations</bold>. Plot of mean posterior values of <italic>μ</italic><sub><italic>g </italic></sub>obtained using a sampling length of 64 k iterations versus those obtained using sampling lengths of 16 k, 32 k and 64 k using an alternative seed for the pseudo random number generator. The values for the 32 k and 64 k comparisons are shifted upwards for clarity. Runs of more than 16 k confer a small increase in stability of estimation for non-expressed genes. At 32 k, estimates are as stable as between two 64 k runs using different seeds.</p>
      </caption>
      <media xlink:href="1471-2105-8-439-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>R script to reproduce plots</bold>. R script to reproduce the plots in this paper.</p>
      </caption>
      <media xlink:href="1471-2105-8-439-S2.r" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Jeffrey S. Rosenthal, Gareth O. Roberts for advice on adaptive Metropolis-Hastings algorithms, and Alex Lewin and Marta Blangiardo for valuable discussion. This work was supported by BBSRC 'Exploiting Genomics' grant 28EGM16093 and the John and Birthe Meyer Foundation.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>AMK</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Causton</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Ambler</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>BGX: a fully Bayesian integrated approach to the analysis of Affymetrix GeneChip data</article-title>
        <source>Biostatistics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>349</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="pmid">15831583</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxi016</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>AMK</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A powerful method for detecting differentially expressed genes from GeneChip arrays that does not require replicates</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>353</fpage>
        <pub-id pub-id-type="pmid">16857053</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-353</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naef</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Magnasco</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Solving the riddle of the bright mismatches: labeling and effective binding in oligonucleotide arrays</article-title>
        <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>
        <year>2003</year>
        <volume>68</volume>
        <fpage>011906</fpage>
        <pub-id pub-id-type="pmid">12935175</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martinez-Murillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A Model-Based Background Adjustment for Oligonucleotide Expression Arrays</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917(9)</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000683</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="other">
        <article-title>Bioconductor</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Coupling and Ergodicity of Adaptive MCMC</article-title>
        <source>Journal of Applied Probability</source>
        <year>2005</year>
        <ext-link ext-link-type="uri" xlink:href="http://www.probability.ca/jeff/ftpdir/adapt.pdf"/>
        <comment>[To appear]</comment>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Examples of Adaptive MCMC</article-title>
        <year>2006</year>
        <ext-link ext-link-type="uri" xlink:href="http://probability.ca/jeff/ftpdir/adaptex.pdf"/>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gilks</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Weak Convergence and Optimal Scaling of Random Walk Metropolis Algorithms</article-title>
        <source>The Annals of Applied Probability</source>
        <year>1997</year>
        <volume>7</volume>
        <fpage>110</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1214/aoap/1034625254</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Optimal Scaling for Various Metropolis-Hastings Algorithms</article-title>
        <source>Statistical Science</source>
        <year>2001</year>
        <volume>16</volume>
        <fpage>351</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1214/ss/1015346320</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="other">
        <article-title>The R Project for Statistical Computing</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org"/>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="other">
        <article-title>Boost C++ Libraries</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://boost.org"/>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choe</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michelson</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Halfon</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Preferred analysis methods for Affymetrix GeneChips revealed by a wholly defined control dataset</article-title>
        <source>Genome Biol</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>R16</fpage>
        <pub-id pub-id-type="pmid">15693945</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r16</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>The Statistical Analysis of Time Series</source>
        <year>1971</year>
        <publisher-name>New York: John Wiley and Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Confidence intervals in discrete event simulation: a comparison of replication and batch means</article-title>
        <source>Naval Res Logistics Quart</source>
        <year>1977</year>
        <volume>23</volume>
        <fpage>667</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1002/nav.3800240414</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="other">
        <article-title>Affymetrix – Latin Square Data</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/sample_data/datasets.affx"/>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cope</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A benchmark for Affymetrix GeneChip expression measures</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>323</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="pmid">14960458</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg410</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>McGee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>New Spiked-In Probe Sets for the Affymetrix HGU-133A Latin Square Experiment</article-title>
        <source>COBRA Preprint Series</source>
        <year>2006</year>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Luu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Normalization for cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation</article-title>
        <source>Nucl Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>e15</fpage>
        <pub-id pub-id-type="pmid">11842121</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/30.4.e15</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
