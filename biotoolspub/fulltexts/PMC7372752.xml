<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7372752</article-id>
    <article-id pub-id-type="publisher-id">3652</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03652-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SpectralTAD: an R package for defining a hierarchy of topologically associated domains using spectral clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cresswell</surname>
          <given-names>Kellen G.</given-names>
        </name>
        <address>
          <email>cresswellkg@vcu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stansfield</surname>
          <given-names>John C.</given-names>
        </name>
        <address>
          <email>stansfieldjc@vcu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0086-8358</contrib-id>
        <name>
          <surname>Dozmorov</surname>
          <given-names>Mikhail G.</given-names>
        </name>
        <address>
          <email>mikhail.dozmorov@vcuhealth.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.224260.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 0458 8737</institution-id><institution>Department of Biostatistics, </institution><institution>Virginia Commonwealth University, </institution></institution-wrap>Richmond, VA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>319</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The three-dimensional (3D) structure of the genome plays a crucial role in gene expression regulation. Chromatin conformation capture technologies (Hi-C) have revealed that the genome is organized in a hierarchy of topologically associated domains (TADs), sub-TADs, and chromatin loops. Identifying such hierarchical structures is a critical step in understanding genome regulation. Existing tools for TAD calling are frequently sensitive to biases in Hi-C data, depend on tunable parameters, and are computationally inefficient.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">To address these challenges, we developed a novel sliding window-based spectral clustering framework that uses gaps between consecutive eigenvectors for TAD boundary identification.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">Our method, implemented in an R package, SpectralTAD, detects hierarchical, biologically relevant TADs, has automatic parameter selection, is robust to sequencing depth, resolution, and sparsity of Hi-C data. SpectralTAD outperforms four state-of-the-art TAD callers in simulated and experimental settings. We demonstrate that TAD boundaries shared among multiple levels of the TAD hierarchy were more enriched in classical boundary marks and more conserved across cell lines and tissues. In contrast, boundaries of TADs that cannot be split into sub-TADs showed less enrichment and conservation, suggesting their more dynamic role in genome regulation.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par4">SpectralTAD is available on Bioconductor, <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/SpectralTAD/">http://bioconductor.org/packages/SpectralTAD/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Hi-C</kwd>
      <kwd>Chromosome conformation capture</kwd>
      <kwd>Topologically associated domains</kwd>
      <kwd>TADs</kwd>
      <kwd>Hierarchy</kwd>
      <kwd>SpectralTAD</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001797</institution-id>
            <institution>Pharmaceutical Research and Manufacturers of America Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NA</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dozmorov</surname>
            <given-names>Mikhail G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">The introduction of chromatin conformation capture technology and its high-throughput derivative Hi-C enabled researchers to accurately model chromatin interactions across the genome and uncover the non-random 3D structures formed by folded genomic DNA [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. The structure and interactions of the DNA in 3D space inside the nucleus has been shown to shape cell type-specific gene expression [<xref ref-type="bibr" rid="CR3">3</xref>], replication [<xref ref-type="bibr" rid="CR4">4</xref>], guide X chromosome inactivation [<xref ref-type="bibr" rid="CR5">5</xref>], and regulate the expression of tumor suppressors and oncogenes [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par12">Topologically Associated Domains (TADs) refer to a common structure uncovered by Hi-C technology, characterized by groups of genomic loci that have high levels of interaction within the group and minimal levels of interaction outside of the group [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. TAD boundaries were found to be enriched in CTCF (considering the directionality of its binding) and other architectural proteins of cohesin and mediator complex (e.g., STAG2, SMC3, SMC1A, RAD21, MED12) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], marks of transcriptionally active chromatin (e.g., DNAse hypersensitive sites, H3K4me3, H3K27ac, H3K36me3 histone modifications) [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. From a regulatory perspective, TADs can be thought of as isolated structures that serve to confine genomic activity within their walls, and restrict activity across their walls. This confinement has been described as creating “autonomous gene-domains,” essentially partitioning the genome into discrete functional regions [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par13">TADs organize themselves into hierarchical sets of domains [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. These hierarchies are characterized by large “meta-TADs” that contain smaller sub-TADs and chromatin loops. To date, most methods were developed to find these single meta-TADs instead of focusing on the hierarchy of the TAD structures [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. While interesting insights can be gleaned from the meta-TADs [<xref ref-type="bibr" rid="CR16">16</xref>], work has shown that smaller sub-TADs are specifically associated with gene regulation [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. For example, it has been found that genes associated with limb malformation in rats are specifically controlled through interactions within sub-TADs [<xref ref-type="bibr" rid="CR18">18</xref>]. These results highlight the importance of identifying the full hierarchy of TADs.</p>
    <p id="Par14">Several methods have been designed to call hierarchical TADs (Supplementary Material, Additional file <xref rid="MOESM1" ref-type="media">1</xref>). However, most algorithms require tunable parameters [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] that, if set incorrectly, can lead to a wide variety of results. Many tools have been shown to highly depend on sequencing depth and chromosome length (reviewed in [<xref ref-type="bibr" rid="CR20">20</xref>]). Furthermore, the time complexity of many algorithms is often prohibitive for detecting TADs on a genome-wide scale. Also, many tools are not user-friendly and lack clear documentation [<xref ref-type="bibr" rid="CR21">21</xref>], with some methods even lacking publicly available code [<xref ref-type="bibr" rid="CR11">11</xref>]. Furthermore, the choice of TAD callers in the R/Bioconductor ecosystem remains limited (Supplementary Material, Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    <p id="Par15">Our goal was to develop a simple data-driven method to detect TADs and uncover hierarchical sub-structures within these TADs. We propose a novel method that exploits the graph-like structure of the chromatin contact matrix and extend it to find the full hierarchy of sub-TADs, limited only by the resolution of Hi-C data. Our approach employs a modified version of the multiclass spectral clustering algorithm [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] and uses a sliding window based on the commonly used 2 Mb biologically maximum TAD size [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. We introduce a novel method for automatically choosing the number of clusters (TADs) based on maximizing the average silhouette score [<xref ref-type="bibr" rid="CR25">25</xref>]. We show that this approach finds TAD boundaries with more significant enrichment of known boundary marks than those called by other TAD callers. We then extend the method to find hierarchies of TADs and demonstrate their biological relevance. Our method provides a parameterless approach, efficiently operating on matrices in text format with consistent results regardless of the level of noise, sparsity, and resolution of Hi-C data. The method is fast and scales linearly with the increasing amount of data. Our method is implemented in the SpectralTAD R package, freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/dozmorovlab/SpectralTAD">https://github.com/dozmorovlab/SpectralTAD</ext-link>) and Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/SpectralTAD/">http://bioconductor.org/packages/SpectralTAD/</ext-link>).</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>An overview of the SpectralTAD algorithm</title>
      <p id="Par16">SpectralTAD takes advantage of the natural graph-like structure of Hi-C data, allowing us to treat the Hi-C contact matrix as an adjacency matrix of a weighted graph. This interpretation allows us to use a spectral clustering-based approach, modified to use gaps between consecutive eigenvectors as a metric for defining TAD boundaries (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Methods). We implement a sliding window approach that increases the stability of spectral clustering and reduces computation time. This approach detects the best number and quality of TADs in a data-driven manner by maximizing the number of internal contacts within TADs and minimizing those between TADs. To achieve this, we maximize a clustering metric called silhouette score that measures within TAD similarity and penalizes for the high similarity between TADs.
<fig id="Fig1"><label>Fig. 1</label><caption><p>SpectralTAD overview and hierarchy of TADs and boundaries. <bold>a</bold>) First two eigenvectors from decomposition of submatrices defined by sliding window across the diagonal of Hi-C matrix are projected on unit circle, and clustered based on largest gaps (defined by Euclidean distance) between eigenvectors. Silhouette score is used for automatic number of clusters (TADs) selection. <bold>b</bold>) TADs not enclosed within other TADs are defined as primary, while TADs contained within other TADs are defined as secondary, tertiary, etc. <bold>c</bold>) Boundaries are defined as the rightmost point of a given TAD. Boundaries belonging to a single TADs are defined as level 1, while boundaries shared by two, three, TADs are defined as level 2, 3, etc.</p></caption><graphic xlink:href="12859_2020_3652_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Defining hierarchical TADs and boundaries</title>
      <p id="Par17">We distinguish hierarchical types of TADs by their position with respect to other TADs. Primary TADs, or “meta-TADs,” are defined as the top-level TADs that are not enclosed within other TADs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Conversely, we define “sub-TADs” as TADs detected within other TADs. We further refine the definition of sub-TADs to describe the level of hierarchy in which a sub-TAD is contained. Secondary TADs refer to sub-TADs which are contained within a primary TAD; tertiary TADs correspond to sub-TADs that are contained within two TADs and so on (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Unless specified otherwise, we report results concerning primary TADs.</p>
      <p id="Par18">TAD boundaries represent another important element to be considered within the hierarchy. Using the terminology introduced in An et al. [<xref ref-type="bibr" rid="CR26">26</xref>], we define a level 1 boundary as a TAD boundary belonging to a single TAD, irrespective of the TAD type. Level 2 and level 3 boundaries correspond to boundaries that are shared by two or three TADs, respectively (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c).</p>
      <p id="Par19">An additional type of region is a gap, which refers to an area where there are no TADs present either due to a lack of sequencing depth, a centromere, or simply a lack of organization (Supplementary Methods, Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The percentage of non-centromeric gaps varies across chromosomes and resolutions (Supplementary Table S1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>), being 19.9% on average for the GM12878 data. In general, we observe that data at higher resolution (e.g., 10 kb) have the highest percentages of gaps due to sparsity. In our analysis, TADs are allowed to span the non-centromeric gaps.</p>
    </sec>
    <sec id="Sec5">
      <title>Systematic approach for comparing TAD quality</title>
      <p id="Par20">A TAD boundary detection method (“TAD detection” hereafter) must be robust to sparsity and noise in Hi-C data, detect consistent TADs across sequencing depths and resolutions, and the TADs must be biologically and statistically meaningful. To compare the concordance of TAD boundaries identified by different TAD callers under different conditions, we used the Jaccard similarity metric. To compare TAD boundaries identified at different resolutions, we used a modified Jaccard similarity metric (Supplementary Material, Supplementary Figure S1, Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM3" ref-type="media">3</xref>). Using simulated and experimental Hi-C data, we compared SpectralTAD with two single-level R-based TAD callers (TopDom [<xref ref-type="bibr" rid="CR13">13</xref>] and HiCSeg [<xref ref-type="bibr" rid="CR14">14</xref>]), and two hierarchical TAD callers (R-based rGMAP [<xref ref-type="bibr" rid="CR27">27</xref>] and Python-based OnTAD [<xref ref-type="bibr" rid="CR26">26</xref>]).</p>
      <p id="Par21">An important property of TAD detection methods is the ability to detect a hierarchy of TAD structures [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Among R packages, rGMAP allows for the detection of two levels of the TAD hierarchy. Our method, SpectralTAD, and OnTAD can detect deeper levels of hierarchy, though we limit it to three in the current paper (Supplementary Figure S2, Additional file <xref rid="MOESM4" ref-type="media">4</xref>). Using simulated and experimental data, we compared the robustness of hierarchical TAD detection and defined properties of hierarchical TAD boundaries.</p>
      <p id="Par22">Multiple studies have demonstrated an enrichment of various genomic annotations at TAD boundaries [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. We quantified the biological relevance of TAD boundaries by using a permutation test to determine their enrichment in transcription factor binding sites, histone modification marks, and chromatin segmentation states (Supplementary Methods, Supplementary Table S2, Additional file <xref rid="MOESM5" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>ICE-normalized and raw Hi-C data are better suited for TAD detection</title>
      <p id="Par23">Sequence- and technology-driven biases may be present in Hi-C matrices [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR32">32</xref>]. Consequently, numerous normalization methods have been developed [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. However, their effect on the quality of TAD detection has not been explored.</p>
      <p id="Par24">We investigated the effect of three normalization methods, Knight-Ruiz (KR), iterative correction and eigenvector decomposition (ICE), and square root vanilla coverage (sqrtVC) on TAD detection using SpectralTAD. Using simulated matrices with the ground-truth TADs, we found that all normalization methods marginally degraded the performance of SpectralTAD under different levels of noise, sparsity, and downsampling (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-c). Based on these results, and the fact that previous studies showed graph-based TAD identification methods work well un-normalized Hi-C data [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], consequent results are presented with the use of raw Hi-C data.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The effect of normalization on TAD consistency and enrichment. To test for robustness to noise, sparsity, and sequencing depth, simulated Hi-C matrices were used as-is, KR-, ICE- and square root VC-normalized. TADs detected by SpectralTAD were compared with the ground-truth TADs using the Jaccard similarity metric. The effect of normalization was assessed at different levels of noise (<bold>a</bold>, the percentage of the original contact matrix modified by adding a constant), sparsity (<bold>b</bold>, the percentage of the original contact matrix replaced with zero), and downsampling (<bold>c</bold>, the fraction of contacts kept, see Methods). Using the raw and normalized data from the GM12878 cell line at 25 kb resolution, enrichment of genomic annotations within 50 kb regions flanking a TAD boundary on both sides was assessed using a permutation test. The average number of annotations for enriched (<bold>d</bold>) and depleted (<bold>e</bold>) genomic features and the permutation <italic>p</italic>-values corresponding to enrichment (<bold>f</bold>), and depletion (<bold>g</bold>) for the top five most enriched/depleted genomic annotations are shown. Results averaged across chromosome 1–22 are shown</p></caption><graphic xlink:href="12859_2020_3652_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par25">Using the experimental Hi-C data from the GM12878 cell line, we found that ICE normalization only marginally affected the average number and width of TADs, and these results were consistent across resolutions (Supplementary Figure S3A, Additional file <xref rid="MOESM6" ref-type="media">6</xref>). In contrast, KR, and sqrtVC normalization resulted in a larger variability in TAD widths across chromosomes and between resolutions (Supplementary Figure S3B, Additional file <xref rid="MOESM6" ref-type="media">6</xref>). We also assessed the average number and the enrichment (permutation test) of genomic annotations at TAD boundaries detected from unnormalized, KR-, ICE-, and sqrtVC-normalized data. The average number of genomic annotations was not significantly different in TAD boundaries detected from raw and ICE-normalized data as compared with those from KR- and sqrtVC-normalized, where the number of annotations was significantly less (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). We found CTCF, RAD21, “Insulator,” and “Heterochromatin” states to be significantly enriched in TAD boundaries, and this enrichment was frequently more significant in TAD boundaries detected from the ICE-normalized data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). Similarly, “enhancer”-like chromatin states were significantly depleted at TAD boundaries, and this depletion was more pronounced in boundaries detected from raw data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). The enrichment results were consistent across resolutions (Supplementary Figure S3C-F, Additional file <xref rid="MOESM6" ref-type="media">6</xref>). Furthermore, visual inspection of TAD boundaries detected from raw and ICE-normalized data demonstrated relatively good agreement, in contrast to those detected from KR-normalized data (Supplementary Figure S2, Additional file <xref rid="MOESM4" ref-type="media">4B</xref>). These results suggest that both ICE-normalized and raw Hi-C data are suitable for the robust detection of biologically relevant TADs.</p>
    </sec>
    <sec id="Sec7">
      <title>SpectralTAD frequently identifies more consistent TADs than other methods</title>
      <p id="Par26">Using simulated matrices, we compared the performance of SpectralTAD with rGMAP, TopDom, OnTAD, and HiCSeg at different noise levels. We found that both SpectralTAD and TopDom had a significantly higher agreement with the ground truth TADs than rGMAP across the range of noise levels (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). To better understand the poor performance of rGMAP, we hypothesized that inconsistencies might arise due to the “off-by-one” errors that occur when, by chance, a TAD boundary may be detected adjacent to the true boundary location. We analyzed the same data using TAD boundaries flanked by 50 kb regions. Expectedly, the performance of all TAD callers, including rGMAP, increased; yet, the performance of rGMAP remained significantly low (Supplementary Figure S4A, Additional file <xref rid="MOESM7" ref-type="media">7</xref>). At low level of noise, HiCSeg detected highly consistent TAD boundaries; however, these TAD boundaries were the least biologically relevant, detailed below. In summary, these results suggest that, with the presence of high noise levels, a situation frequent in experimental Hi-C data, SpectralTAD performs better than other TAD callers in detecting true TAD boundaries.
<fig id="Fig3"><label>Fig. 3</label><caption><p>The comparison of SpectralTAD and other TAD callers regarding TAD consistency and biological significance. To test for robustness to noise, sparsity, and sequencing depth, TADs were called from simulated Hi-C matrices using SpectralTAD and four other TAD callers. They were compared with the ground-truth TADs using the Jaccard similarity metric. The performance was assessed at different levels of noise (<bold>a</bold>), sparsity (<bold>b</bold>), and downsampling (<bold>c</bold>, see Methods). Using the raw data from GM12878 at 25 kb resolution, enrichment of genomic annotations within 50 kb regions flanking a TAD boundary on both sides was assessed using a permutation test. The average number of annotations for enriched (<bold>d</bold>) and depleted (<bold>e</bold>) genomic features and the permutation <italic>p</italic>-values corresponding to enrichment (<bold>f</bold>), and depletion (<bold>g</bold>) for the top five most enriched/depleted genomic annotations are shown. Results averaged across chromosome 1–22 are shown</p></caption><graphic xlink:href="12859_2020_3652_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par27">We similarly investigated the effect of sparsity on the performance of the TAD callers. Expectedly, the average Jaccard similarity decreased for all TAD callers with an increased level of sparsity (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). SpectralTAD outperformed all TAD callers except HiCSeg at all sparsity levels. We further tested whether accounting for the “off-by-one” error improves the performance; the performance of SpectralTAD remained superior (Supplementary Figure S4B, Additional file <xref rid="MOESM7" ref-type="media">7</xref>). These results demonstrate the robustness of SpectralTAD to sparsity.</p>
      <p id="Par28">TAD callers should be robust to changes in sequencing depth. We introduced four levels of downsampling into simulated matrices and compared the detected TADs with the ground truth TADs. Downsampling involves removing contacts at random, simulating reduced sequencing depth. Expectedly, the average Jaccard similarity degraded for all TAD callers with an increased level of downsampling (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Notably, the performance of SpectralTAD was consistently higher than that of other TAD callers except HiCSeg. Similar observations were true when accounting for the “off-by-one” error (Supplementary Figure S4C, Additional file <xref rid="MOESM7" ref-type="media">7</xref>). Despite the seemingly good performance of HiCSeg, further inspection showed it detects wide TADs that corresponds poorly to visually identifiable TADs while missing small-scale TADs detected by SpectralTAD (Supplementary Figure S2, Additional file <xref rid="MOESM4" ref-type="media">4A</xref>). Consequently, the biological relevance of TAD boundaries it detects is low, as discussed below (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d-f). These observations, along with the results concerning sparsity and noise, suggest that with realistic levels of variation and noise in Hi-C data the performance of SpectralTAD in most cases is better than other TAD callers.</p>
    </sec>
    <sec id="Sec8">
      <title>SpectralTAD outperforms other TAD callers in finding biologically relevant TAD boundaries</title>
      <p id="Par29">To evaluate the biological relevance of TAD boundaries detected by SpectralTAD and the other TAD callers, we evaluated their enrichment in genomic annotations known to be associated with TAD boundaries. We found that the TAD boundaries called by SpectralTAD, TopDom, and OnTAD had a significantly higher number of CTCF and RAD21, “Insulator,” and “Heterochromatin” annotations than those called by HiCSeg and rGMAP (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Consequently, these marks were more enriched at TAD boundaries detected by SpectralTAD and TopDom as compared with the other TAD callers (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). In terms of depleted genomic annotations, “enhancer”-like chromatin states were underrepresented at TAD boundaries, and this depletion was highly significant for boundaries detected by SpectralTAD (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, g). Notably, the TAD boundaries detected by HiCSeg had the lowest number of these genomic annotations. They also exhibited the lowest level of enrichment and depletion (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, g). These results suggest that, despite robustness to noise, sparsity, and sequencing depth, HiCseg detects boundaries that are less biologically relevant in terms of known TAD biology. The performance of SpectralTAD and other callers was consistent at different resolutions (Supplementary Figure S4D-G, Supplementary Table S3, Additional files <xref rid="MOESM7" ref-type="media">7</xref> and <xref rid="MOESM8" ref-type="media">8</xref>). In summary, these results suggest that SpectralTAD outperforms other TAD callers in detecting biologically relevant TAD boundaries.</p>
    </sec>
    <sec id="Sec9">
      <title>SpectralTAD consistently identifies TADs across resolutions of Hi-C data</title>
      <p id="Par30">If TAD boundaries called at different resolutions of Hi-C data are inconsistent, one risks receiving vastly different results despite the data being the same. Using the GM12878 Hi-C data at 10 kb, 25 kb, and 50 kb resolutions, we estimated the average number and width of TADs called by SpectralTAD, TopDom, HiCSeg, OnTAD, and rGMAP. As the resolution of Hi-C data increased, the average number of TADs decreased for all but SpectralTAD (Supplementary Figure S5A, Additional file <xref rid="MOESM9" ref-type="media">9</xref>). Similarly, the average width of TADs increased for all but SpectralTAD TAD callers (Supplementary Figure S5B, Additional File <xref rid="MOESM9" ref-type="media">9</xref>). We further compared the consistency of TADs detected in 50 kb vs. 25 kb, 50 kb vs. 10 kb, 25 kb vs. 10 kb resolution comparisons. We found that, for nearly all comparisons, SpectralTAD and HiCSeg had significantly higher consistency quantified by modified Jaccard statistics than the other TAD callers (Supplementary Figure S5C, Additional File <xref rid="MOESM9" ref-type="media">9</xref>). When comparing the exact location of TADs detected by different TAD callers across four replicates of Hi-C data, SpectralTAD identified a higher proportion of TADs detected four times than OnTAD and rGMAP (Supplementary Figure S5D, Additional file <xref rid="MOESM9" ref-type="media">9</xref>). Consistent with previous observations (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), TopDom and HiCSeg performed well; however, this analysis does not reflect the lower biological relevance of the detected TAD boundaries, as discussed above. These results show that SpectralTAD identifies consistent TADs at different resolutions of Hi-C data in most cases.</p>
    </sec>
    <sec id="Sec10">
      <title>TAD hierarchy is associated with biological relevance</title>
      <p id="Par31">Having established the strong performance of SpectralTAD, we investigated the biological importance of the hierarchy of TAD boundaries detected by it. We tested the relationship between the number of times a TAD boundary occurs in a hierarchy (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) and the enrichment of genomic annotations. We hypothesized that TAD boundaries shared by two or more TADs (Level 2 and 3 boundaries) would be more biologically important, hence, harbor a larger number of key markers such as CTCF and RAD21. We found that this is indeed the case, as illustrated by a significant increase in the average number of CTCF and RAD21 annotations, and “Insulator”/“Heterochromatin” states around Level 2 and 3 boundaries as compared with Level 1 boundaries (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). A similar trend was observed in the stronger enrichment of Level 2 and 3 TAD boundaries in those annotations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). TAD boundaries at all levels of the hierarchy were similarly depleted in the “enhancer”-like annotations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, d), although these depletions were more significant for the Level 3 TAD boundaries. These observations were consistent across resolutions (Supplementary Figure S6, Additional file <xref rid="MOESM10" ref-type="media">10</xref>). Our results agree with previous research that has shown a positive correlation between the number of sub-TADs sharing a boundary and the number of biologically relevant genomic annotations at that boundary [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] and confirm that SpectralTAD identifies a biologically relevant hierarchy of TADs.
<fig id="Fig4"><label>Fig. 4</label><caption><p>The effect of the hierarchy of TAD boundaries detected by SpectralTAD on the average number of annotations in enriched (<bold>a</bold>) &amp; depleted (<bold>b</bold>) genomic markers and on enrichment (<bold>c</bold>) and depletion (<bold>d</bold>) for different genomic annotations. Results for Level 1, 2, and 3 boundaries are shown. Genomic annotations were considered within 50 kb regions flanking a boundary on both sides. Wilcoxon test <italic>p</italic>-values are shown in panel <bold>a &amp; b</bold>, and aggregated <italic>p</italic>-values, using the Fisher’s method, are shown for panels <bold>c &amp; d</bold>. Raw data from the GM12878 cell line, chromosome 1–22, 25 kb resolution</p></caption><graphic xlink:href="12859_2020_3652_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>TADs identified by SpectralTAD are conserved across cell lines and tissues</title>
      <p id="Par32">Previous studies reported relatively high conservation of TAD boundaries identified in different tissues and cell types, with the reported Jaccard statistics ranging from 0.21 to 0.30 [<xref ref-type="bibr" rid="CR3">3</xref>]. We compared TAD boundaries called by SpectralTAD across various tissues and cell types (Supplementary Table S4, [<xref ref-type="bibr" rid="CR39">39</xref>], Additional file <xref rid="MOESM11" ref-type="media">11</xref>). The Jaccard for all TADs, ignoring hierarchy, between cell-line samples ranged from 0.33 to 0.73 with a mean of 0.45 (SD = 0.08). The Jaccard between tissues ranged from 0.21 to 0.38, with a mean of 0.27 (SD = 0.03), significantly lower than that of cell lines (Wilcoxon <italic>p</italic>-value &lt; 0.0001). The lower conservation of TADs called from tissue samples is expected as cell lines come from a “pure” single source while tissues are a mixture of different cells. These results were summarized in heatmaps, comparing different cell lines (Supplementary Figure S7A, Additional file <xref rid="MOESM12" ref-type="media">12</xref>) and tissues (Supplementary Figure S7B, Additional file <xref rid="MOESM12" ref-type="media">12</xref>) according to Jaccard similarity. Hierarchical clustering of cell type-specific samples by the Jaccard similarity of their TADs, ignoring hierarchy, identified the expected associations between cell-type-specific data, with replicates clustering together and cell types being distinct (Supplementary Figure S7A, Additional file <xref rid="MOESM12" ref-type="media">12</xref>). To a lesser extent, these results were similar in tissue-specific samples (Supplementary Figure S7B, Additional file <xref rid="MOESM12" ref-type="media">12</xref>). In summary, these results show the conservation of TAD boundaries called using SpectralTAD across tissues and cell lines is similar to previously reported results [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
    </sec>
    <sec id="Sec12">
      <title>Hierarchy of boundaries affect conservation of TADs</title>
      <p id="Par33">Following our definition of TADs (Primary, Secondary, and Tertiary, Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), we hypothesized that primary TADs would be better conserved than Secondary or Tertiary TADs. The primary TADs are detected during the first pass of the algorithm; hence, they are robustly supported by the underlying data and expected to reproduce across different datasets. Indeed, the average Jaccard for Primary, Secondary, and Tertiary TADs across cell types was 0.42, 0.40, and 0.35, respectively (Supplementary Table S5, Additional file <xref rid="MOESM13" ref-type="media">13</xref>), and this decrease was significant (Wilcoxon <italic>p</italic>-value &lt; 0.0001). These observations were consistent when analyzing TADs called from tissue samples, although the average Jaccard coefficients for Primary, Secondary, and Tertiary TADs were significantly lower (Supplementary Table S5, Additional file <xref rid="MOESM13" ref-type="media">13</xref>). These results demonstrate that Primary TADs are the most conserved across cell types and tissues.</p>
      <p id="Par34">We hypothesized that Level 3 TAD boundaries (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, boundaries that are shared by three TADs), besides showing higher biological significance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), will be better conserved. Indeed, the Jaccard coefficient of Level 3 TAD boundaries called in cell types was significantly higher (0.30) than that of Level 2 (0.23) and Level 1 (0.23) boundaries (Wilcoxon <italic>p</italic>-value ranging from 0.034 to &lt; 0.0001, Supplementary Table S5, Additional file <xref rid="MOESM13" ref-type="media">13</xref>). These results were also observed in TAD boundaries called in tissue types. One possibility of the lower Jaccard coefficient for Level 1 and 2 boundaries is that they may change their assignment due to higher probability of detection of sub-TADs in different datasets. In summary, these results demonstrate that boundaries shared by several TADs have high biological significance and are better conserved across cell types and tissues.</p>
    </sec>
    <sec id="Sec13">
      <title>SpectralTAD is the fastest TAD caller for high-resolution data</title>
      <p id="Par35">We evaluated the runtime performance of SpectralTAD, TopDom, OnTAD, rGMAP, and HiCSeg. SpectralTAD showed comparable performance with TopDom and was faster than rGMAP at all resolutions (Supplementary Figure S8A, Additional file <xref rid="MOESM14" ref-type="media">14</xref>). Specifically, SpectralTAD takes ~ 45 s to run with 25 kb data and ~ 4 min to run on 10 kb data for the entire GM12878 genome. By comparison, TopDom takes ~ 1 min to run on 25 kb data but ~ 13 min on 10 kb data. OnTAD takes ~ 4 min to run on 25 kb data and ~ 30 min on 10 kb data. rGMAP takes ~ 12 min on 25 kb data and ~ 47 min on 10 kb data. We find that HiCSeg is prohibitively slow, taking ~ 609 min on 25 kb data and multiple days to run on 10 kb data with chromosome 1 taking over 24 h alone. Importantly, our method scales nearly linearly with the size of the data (see Methods), making it amenable for fast processing of data at higher resolutions. Furthermore, when parallelized, SpectralTAD is several orders of magnitude faster than other TAD callers (Supplementary Figure S8A, Additional file <xref rid="MOESM14" ref-type="media">14</xref>), e.g., with the entire genome taking 1 s to run for 25 kb data when using four cores. We demonstrate that our method has a linear complexity <italic>O</italic>(<italic>n</italic>) (Supplementary Methods, Additional file <xref rid="MOESM1" ref-type="media">1</xref>), making it scalable for large Hi-C datasets. In summary, these results demonstrate that SpectralTAD is significantly faster than TopDom, rGMAP, and HiCSeg, providing near-instant results when running on multiple cores.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par36">We introduce the SpectralTAD R package implementing a spectral clustering-based approach that allows for fast TAD calling and scales well to high-dimensional data. The method was benchmarked against four TAD callers - TopDom and HiCSeg that detect single-level TADs, and OnTAD and rGMAP that detect hierarchical TADs. We show better performance of SpectralTAD vs. the other TAD callers in nearly all conditions. We also demonstrate that SpectralTAD is more robust to sparsity, sequencing depth, and resolution. We show that SpectralTAD can robustly detect hierarchical TAD boundaries. Furthermore, we demonstrate different levels of TAD hierarchy to be differentially associated with known marks of TAD boundaries, highlighting their distinct biological roles and the importance of the TAD hierarchy in general. The clear superiority of SpectralTAD regarding running speed and robustness to data irregularities suggests its use as the new gold-standard of hierarchical TAD callers in the R ecosystem.</p>
    <p id="Par37">The performance of SpectralTAD was frequently better, but not always superior to that of HiCSeg. The better performance of HiCSeg under different levels of noise, sparsity, and sequencing depth in some cases may be explained by the fact that HiCSeg identifies non-hierarchical TAD boundaries at once. Furthermore, HiCSeg uses complete Hi-C matrices to detect robust data-driven features [<xref ref-type="bibr" rid="CR14">14</xref>]. However, due to the inherent noise and sparsity of Hi-C data at larger distances between interacting regions, those features may be detected due to consistent aberrations in the data. This may explain poor enrichment of HiCSeg-detected boundaries in CTCF, RAD21, and other functional signatures of TAD boundaries. SpectralTAD, on the other hand, defines a hierarchy of primary, secondary, etc., TADs, restricted to the first three levels in the current analysis. Furthermore, the sliding window approach implemented in SpectralTAD focuses on local, likely biology-driven chromatin interactions that define TAD boundaries. This may explain stronger enrichment of SpectralTAD-detected boundaries in genomic annotations previously associated with TAD boundaries. We suggest that the tradeoff between robustness and biological relevance of TAD boundaries should be made for the latter, with SpectralTAD providing the optimal balance.</p>
    <p id="Par38">One overarching limitation with non-hierarchical TAD callers like TopDom and HiCSeg is their inability to capture all TADs in a dataset. While methods like TopDom may find biologically relevant TADs, they cannot account for the common situation where sub-TADs occur within a TAD. In the case of TADs enclosing sub-TADs, non-hierarchical callers are forced to make a choice that is often far from optimal (Supplementary Figure S2, Additional file <xref rid="MOESM4" ref-type="media">4</xref>). We suggest that even when the hierarchy of TADs is not essential, hierarchical TAD callers like SpectralTAD should be used for maximally accurate reconstruction of TADs at the first level of the hierarchy.</p>
    <p id="Par39">Our work focuses on R-based software for TAD boundary detection, motivating the selection of TAD callers implemented in R. However, many TAD callers, including those detecting hierarchical TADs, have been implemented in Python and/or as command-line tools (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, reviewed in [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]). One of our future goals includes a comparison of SpectralTAD with hierarchical TAD callers irrespectively of implementation, focusing on the quality of hierarchical TAD detection.</p>
    <p id="Par40">The goal of the SpectralTAD package is to provide the R-based implementation of our spectral clustering framework for TAD boundary detection. It outputs genomic coordinates of the detected TAD boundaries along with their level of hierarchy. These genomic coordinates provide flexibility for a range of downstream analyses and visualization. Examples include functional enrichment analysis of genes and genomic annotations in proximity of (different hierarchical) TAD boundaries using tools like rGREAT, GenomeRunner, LOLA [<xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR45">45</xref>]. Although SpectralTAD provides basic visualization functionality, external tools like HiCExplorer [<xref ref-type="bibr" rid="CR46">46</xref>], Juicer [<xref ref-type="bibr" rid="CR15">15</xref>], HiGlass [<xref ref-type="bibr" rid="CR47">47</xref>], reviewed in [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>], provide greater flexibility in visualizing Hi-C contact maps and annotations. We continue exploring visualization options for SpectralTAD-detected boundaries.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par41">In summary, we show that SpectralTAD is a robust method for defining the hierarchy of TAD boundaries. This method improves upon previous work showing the potential of spectral clustering for finding structures in Hi-C data while introducing modifications to make these methods practical for users. Specifically, we introduce two novel modifications to spectral clustering, the eigenvector gap and windowing, which can be used to quickly and accurately find changes in the pattern for ordered data. By releasing SpectralTAD as an open source R package, we aim to provide a user-friendly and accurate tool for hierarchical TAD detection.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <sec id="Sec17">
      <title>Data sources</title>
      <p id="Par42">Experimental Hi-C matrices from the GM12878 cell line ([<xref ref-type="bibr" rid="CR3">3</xref>] at 50 kb, 25 kb, and 10 kb, “primary+replicate”, replicates (HIC001-HIC004)) and 35 different cell line and tissue samples ([<xref ref-type="bibr" rid="CR39">39</xref>], 40 kb resolution) were downloaded from Gene Expression Omnibus (GEO, Supplementary Table S4, Additional file <xref rid="MOESM11" ref-type="media">11</xref>). 25 simulated matrices with manually annotated TADs ([<xref ref-type="bibr" rid="CR42">42</xref>], 40 kb resolution) were downloaded from the HiCToolsCompare repository (Supplementary Table S4, Additional file <xref rid="MOESM11" ref-type="media">11</xref>). Data for chromatin states, histone modification and transcription factor binding sites (TFBS) were downloaded from the UCSC genome browser database [<xref ref-type="bibr" rid="CR50">50</xref>]. Given the fact that some transcription factors have been profiled by different institutions (e.g., CTCF-Broad, CTCF-Uw, and CTCF-Uta), we selected annotations most frequently enriched at TAD boundaries (typically, CTCF-Broad, RAD21-Haib). All genomic annotation data were downloaded in Browser Extensible Data (BED) format using the hg19/GRCh37 genome coordinate system (Supplementary Table S2, Additional file <xref rid="MOESM5" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec18">
      <title>Windowed spectral clustering</title>
      <sec id="Sec19">
        <title>Hi-C data representation</title>
        <p id="Par43">Chromosome-specific Hi-C data is typically represented by a chromatin interaction matrix <italic>C</italic> (referred hereafter as “contact matrix”) binned into regions of size <italic>r</italic> (the resolution of the data). Entry <italic>C</italic><sub><italic>ij</italic></sub> of a contact matrix corresponds to the number of times region <italic>i</italic> interacts with region <italic>j</italic>. The matrix <italic>C</italic> is square and symmetric around the diagonal representing self-interacting regions. Our method relies on the fact that the 3D chromosome can be thought of as a naturally occurring graph [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. Traditionally, a graph <italic>G</italic>(<italic>V</italic>, <italic>E</italic>) is represented by a series of nodes <italic>V</italic> connected by edges <italic>E</italic>. These graphs are summarized in an adjacency matrix <italic>A</italic><sub><italic>ij</italic></sub>, where entry <italic>ij</italic> indicates the number of edges between node <italic>i</italic> and node <italic>j</italic>. We can think of the contact matrix as a naturally occurring adjacency matrix (i.e., <italic>C</italic><sub><italic>ij</italic></sub> = <italic>A</italic><sub><italic>ij</italic></sub>) where each genomic locus is a node, and the edges are the number of contacts between these nodes [<xref ref-type="bibr" rid="CR51">51</xref>]. This interpretation of the contact matrix allows us to proceed with spectral clustering.</p>
      </sec>
      <sec id="Sec20">
        <title>Sliding window</title>
        <p id="Par44">To avoid performing spectral clustering on the entire matrix, which is highly computationally intensive, we apply the spectral clustering algorithm to submatrices defined by a sliding window across the diagonal of the entire matrix. The size of the window (the number of bins defining a submatrix) is based on the maximum possible TAD size of 2mb [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR52">52</xref>]. In practice, the size of the window <italic>w</italic> is equal to <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{2 mb}{r} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="italic">mb</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>r</italic> is the resolution of the data. For example, at the 10 kb resolution, we would have a window size of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{2 mb}{10 kb} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="italic">mb</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mi mathvariant="italic">kb</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq2.gif"/></alternatives></inline-formula> or simply 200 bins. Following the guidelines of previous works on the minimum TAD size, we set a minimum window size of 5 bins [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR55">55</xref>].</p>
        <p id="Par45">The restriction in window size means that the maximum resolution at which the algorithm can be run is 200 kb. At this resolution, the window can be partitioned into two separate TADs of 5 bin width. However, this is inappropriate as previous research indicated that TADs do not begin truly appearing until the resolution becomes less than 100 kb [<xref ref-type="bibr" rid="CR7">7</xref>]. Therefore, our method is viable for all potential resolutions from which meaningful TADs can be called.</p>
        <p id="Par46">The algorithm starts at the beginning of the matrix and identifies the TADs in the first window. The window is then moved forward to the beginning of the last TAD detected, to account for the fact that the final TAD may overlap between windows. This is repeated until the end of the matrix. The result is a unique set of TADs.</p>
      </sec>
      <sec id="Sec21">
        <title>Finding the graph spectrum</title>
        <p id="Par47">The first step of the algorithm is to find the graph spectrum. First, we calculate a Laplacian matrix - a matrix containing the spatial information of a graph. Multiple Laplacians exist [<xref ref-type="bibr" rid="CR56">56</xref>]; but since our method builds upon the multiclass spectral clustering algorithm [<xref ref-type="bibr" rid="CR22">22</xref>], which uses the symmetric Laplacian, we use the normalized symmetric Laplacian as follows:
<list list-type="order"><list-item><p id="Par48">Calculating the normalized symmetric Laplacian
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{L}={D}^{-\frac{1}{2}}C{D}^{-\frac{1}{2}} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:math><graphic xlink:href="12859_2020_3652_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par49">(where) <italic>D</italic> =  <italic>diag</italic> (1<sup><italic>T</italic></sup><italic>C</italic>)</p></list-item><list-item><p id="Par50">Solve the generalized eigenvalue problem
<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{L}\overline{V}=\lambda \overline{V} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover></mml:math><graphic xlink:href="12859_2020_3652_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par51">The result is a matrix of eigenvectors <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{V}}_{w\times k} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mrow><mml:mi>w</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>w</italic> is the window size, and <italic>k</italic> is the number of eigenvectors used, and a vector of eigenvalues where each entry <italic>λ</italic><sub><italic>i</italic></sub> corresponds to the <italic>i</italic><sub><italic>th</italic></sub> eigenvalue of the normalized Laplacian <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{L} $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq4.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par52">Normalize rows and columns to sum to 1:
<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{V_{i.}}=\frac{\overline{V_{i.}}}{\left\Vert {\overline{V}}_{i.}\right\Vert } $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true">‖</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">‖</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3652_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par53">where the subscript <italic>i</italic>. Corresponds to column <italic>i</italic></p></list-item></list></p>
      </sec>
      <sec id="Sec22">
        <title>Projection onto the unit circle</title>
        <p id="Par54">Our method builds on the approach to spectral clustering first introduced in [<xref ref-type="bibr" rid="CR22">22</xref>], which works by projecting the eigenvectors on a unit circle. Once we project these values on the circle, we can cluster regions of the genome by simply finding gaps in the circle (Supplementary Figure S9, Additional file <xref rid="MOESM15" ref-type="media">15</xref>). In the unit circle representation, a TAD boundary can be thought of as a region of discontinuity in the eigenvectors of adjacent values. Regions within the same TAD should have similar eigenvectors and have small distances between them. This approach takes advantage of the fact that eigenvectors are mapped to genomic coordinates which have a natural ordering. The steps for this portion of the algorithm are below:
<list list-type="order"><list-item><p id="Par55">Normalize the eigenvectors and project onto a unit circle
<disp-formula id="Equd"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overset{\sim }{Z}=\mathit{\operatorname{diag}}\left( dia{g}^{-\frac{1}{2}}\left(\hat{{\mathrm{V}}_{i.}}{\hat{V_{i.}}}^T\right)\right)\hat{V_{i.}} $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo mathvariant="italic">diag</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">dia</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><graphic xlink:href="12859_2020_3652_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par56">For <italic>i</italic> = 2, …, <italic>n</italic> where <italic>n</italic> is the number of rows in <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overset{\sim }{Z} $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq5.gif"/></alternatives></inline-formula> and <italic>k</italic> is the number of eigenvectors calculated (we suggest using two) to produce <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overset{\sim }{Z} $$\end{document}</tex-math><mml:math id="M20" display="inline"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq6.gif"/></alternatives></inline-formula>, calculate the Euclidean distance vector <italic>D</italic><disp-formula id="Eque"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {D}_i=\sqrt{{\left({\overset{\sim }{Z}}_{i1}-{\overset{\sim }{Z}}_{\left(i-1\right)1}\right)}^2+{\left({\overset{\sim }{Z}}_{i2}-{\overset{\sim }{Z}}_{\left(i-1\right)2}\right)}^2.\dots +{\left({\overset{\sim }{Z}}_k-{\overset{\sim }{\mathrm{Z}}}_{\left(i-1\right)k}\right)}^2} $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Z</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="12859_2020_3652_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
        <p id="Par57">This step calculates the distance between the entries of the first two normalized eigenvectors that are associated with bin <italic>i</italic> and the bin to its left.</p>
      </sec>
      <sec id="Sec23">
        <title>Choosing the number of TADs in each window</title>
        <p id="Par58">
          <list list-type="order">
            <list-item>
              <p id="Par59">Find the location of the first <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ l=\frac{w}{5} $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>5</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq7.gif"/></alternatives></inline-formula> largest values in <italic>D</italic><sub><italic>i</italic></sub>, where <italic>w</italic> is the window size, and <italic>l</italic> + 1 is the maximum number of TADs in a given window and partition the matrix into <italic>l</italic> + 1 sub-matrices with boundaries defined by the location of the <italic>l</italic> largest values.</p>
            </list-item>
            <list-item>
              <p id="Par60">For each sub-matrix calculate the silhouette statistic [<xref ref-type="bibr" rid="CR25">25</xref>]:
<disp-formula id="Equf"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_i=\frac{b_i-{a}_i}{\mathit{\max}\left[{a}_i,{b}_i\right]} $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo mathvariant="italic">max</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3652_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
            </list-item>
          </list>
        </p>
        <p id="Par61">Here, <italic>a</italic> is the mean distance between each cluster entry and the nearest cluster, and <italic>b</italic> is the mean distance between points in the cluster. The distance between two given loci <italic>i</italic> and <italic>j</italic> is defined as <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{1}{C_{ij}+1} $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq8.gif"/></alternatives></inline-formula>, with “+1” added to avoid division by zero. <italic>C</italic><sub><italic>ij</italic></sub> corresponds to the number of contacts between loci <italic>i</italic> and loci <italic>j</italic>.
<list list-type="simple"><list-item><label>3.</label><p id="Par62">Find the mean silhouette score over all possible numbers of clusters <italic>m</italic> and organize into a vector of means
<disp-formula id="Equg"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{s}}_m=\frac{\sum \limits_{i=1}^m{s}_i}{m} $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3652_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><label>4.</label><p id="Par63">Find the value of <italic>m</italic> which maximizes <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{s}}_m $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">‾</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3652_Article_IEq9.gif"/></alternatives></inline-formula></p></list-item></list></p>
        <p id="Par64">By taking the mean silhouette score, we can determine the number of eigenvectors, which allows us to maximize the similarity within clusters while minimizing the similarity between clusters. This translates into the number of clusters (i.e., TADs) that produces the most well-separated clusters. This procedure is performed within each window, allowing us to identify poorly organized regions (gaps, Supplementary Methods, Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Cluster (TAD) boundaries are mapped to genomic coordinates based on their location in the contact matrix. If a TAD is detected and found to be less than 5 bins wide it is ignored due to previous evidence suggesting these are not biologically relevant [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR55">55</xref>]. This step implies that, for a given window, the maximum number of TADs in a window is equal to the size of the window divided by 5.</p>
      </sec>
      <sec id="Sec24">
        <title>Creating a hierarchy of TADs</title>
        <p id="Par65">We can find a hierarchy of TADs by iteratively partitioning the initial TADs. This is done by running a modified version of the main algorithm that includes an extra filtering step that tests for the presence of sub-TADs in each TAD. Briefly, each TAD is treated as an individual contact matrix, and a window is not used. To test for the existence of sub-TADs, we convert the distance vector <italic>D</italic><sub><italic>i</italic></sub> into a set of Z-scores by first taking the natural log of the distance vector before centering and scaling. This is done following our empirical observation of the log-normality of eigenvector gaps (Supplementary Figure S10, Additional file <xref rid="MOESM16" ref-type="media">16</xref>). We then label any distance with a Z-score greater than 2 as a sub-boundary. If significant sub-boundaries are detected, we partition the TAD with each sub-boundary indicating the end of a given sub-TAD. This procedure is then repeated for each sub-TAD until either the TAD is too small to be partitioned into two sub-TADs or no significant boundaries are found. The TADs detected during the initial run of the algorithm are considered primary TADs, and the TADs detected after partitioning are considered secondary, tertiary, etc., sub-TADs. In practice, this approach can also be used for the first iteration of the algorithm (non sub-TADs) and is an option in the SpectralTAD R package.</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Benchmarking TAD callers</title>
      <p id="Par66">To evaluate the robustness of TAD callers, simulates Hi-C matrices were systematically modified to contain pre-defined levels of noise, sparsity, and sequencing depth. The overlap of TAD boundaries with the manually annotated TADs was tested using Jaccard statistics; the cross-resolution TAD comparison was assessed using a modified version of the Jaccard coefficient (Supplementary Figure S1, Additional file <xref rid="MOESM3" ref-type="media">3</xref>). The effect of Hi-C data normalization was tested using the iterative correction and eigenvector decomposition (ICE) [<xref ref-type="bibr" rid="CR32">32</xref>], Knight-Ruiz (KR) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR33">33</xref>], and the Square Root Vanilla Coverage (sqrtVC) [<xref ref-type="bibr" rid="CR3">3</xref>] methods. The association of TAD boundaries with genomic annotations, such as CTCF, was assessed using a permutation test. See Supplementary Methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>) for details.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2020_3652_MOESM1_ESM.pdf">
          <caption>
            <p><bold>Additional file 1: Supplementary Material.</bold> An overview of previous methods, parameter selection, methods, and results not included in the main manuscript.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="12859_2020_3652_MOESM2_ESM.xlsx">
          <caption>
            <p><bold>Additional file 2: Table S1.</bold> Summary of gaps. The percentage of gaps is summarized for all chromosomes at 10 kb, 25 kb, and 50 kb resolution using raw GM12878 data [<xref ref-type="bibr" rid="CR3">3</xref>]. Gaps are separated based on whether they are centromeric or other (unsequenced, or poorly organized chromatin).</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="12859_2020_3652_MOESM3_ESM.tif">
          <caption>
            <p><bold>Additional file 3: Figure S1.</bold> Example of modified Jaccard statistics to measure agreement between TAD boundaries detected at different resolutions. The top triangles indicate TADs detected at 50 kb resolution, while the bottom triangles indicate those detected at 25 kb resolution. There are four shared boundaries (blue lines) and two non-shared boundaries (red lines). The traditional Jaccard statistic underestimates the fact that the four TAD boundaries agree at a different resolution, while the modified Jaccard statistics correctly identifies the perfect overlap between TAD boundaries by ignoring resolution differences.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="12859_2020_3652_MOESM4_ESM.png">
          <caption>
            <p><bold>Additional file 4: Figure S2.</bold> Examples of TADs detected under different conditions. A) TADs detected by SpectralTAD, TopDom, OnTAD, HiCSeg and rGMAP. B) TADs detected from raw, ICE-, and KR-normalized data. SqrtVC-normalized data could not be plotted due to format conversion issues. Red-yellow-blue color gradient indicate a high-medium low chromatin interaction strength; triangles indicate TADs. GM12878 data from [<xref ref-type="bibr" rid="CR3">3</xref>], resolution 50 kb, chr1:60000000–80,000,000 (hg19). All parameters were set according to the instructions of each TAD caller. HiCExplorer v.3.0 [<xref ref-type="bibr" rid="CR46">46</xref>] was used for visualization.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="12859_2020_3652_MOESM5_ESM.xlsx">
          <caption>
            <p><bold>Additional file 5: Table S2.</bold> Experimental Data sources. Genome annotation (hg19/GRCh37) [<xref ref-type="bibr" rid="CR50">50</xref>] data for GM12878 cell line used in the analysis, sorted by category, then by data type.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="12859_2020_3652_MOESM6_ESM.tif">
          <caption>
            <p><bold>Additional file 6: Figure S3.</bold> The effect of data normalization on the average number (A) and width in kilobases (B) of TADs and the average number of peaks in enriched markers (C) and depleted markers (D), enrichment (F) and depletion (G) for different genomic annotations. Counts (A) and widths (B) for raw, KR-, ICE- and sqrtVC-normalized GM12878 data at 25 kb and 50 kb resolutions, averaged across chromosome 1–22, are shown for primary, secondary, and tertiary TADs detected by SpectralTAD. The average number of annotations for enriched (D) and depleted (E) genomic features and the permutation <italic>p</italic>-values corresponding to enrichment (F), and depletion (G) for the top most enriched/depleted genomic annotations (permutation test) at TAD boundaries for GM12878 data at 50 kb resolution are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7">
        <media xlink:href="12859_2020_3652_MOESM7_ESM.tif">
          <caption>
            <p><bold>Additional file 7: Figure S4.</bold> The comparison of SpectralTAD and other TAD callers regarding TAD consistency and biological significance. To test for robustness to noise, sparsity, and downsampling, TADs were called from simulated Hi-C matrices using SpectralTAD and other TAD callers. The TAD boundaries were extended by 50 kb regions flanking a boundary on both sides. They were compared with the ground-truth TADs using the Jaccard similarity metric. The performance of the TAD callers was assessed at a different level of noise (A, the percentage of the original contact matrix modified by adding a constant of two), sparsity (B, the percentage of the original contact matrix replaced with zero), and downsampling (C, the fraction of contacts kept, see Methods). Using the raw data from GM12878 at 50 kb resolution, enrichment of genomic annotations within 50 kb regions flanking a TAD boundary on both sides was assessed using a permutation test. The average number of annotations for enriched (D) and depleted (E) genomic features and the permutation <italic>p</italic>-values corresponding to enrichment (F), and depletion (G) for the top five most enriched/depleted genomic annotations are shown. Results averaged across chromosome 1–22 are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8">
        <media xlink:href="12859_2020_3652_MOESM8_ESM.xlsx">
          <caption>
            <p><bold>Additional file 8: Table S3</bold> Enrichment by Method. Enrichment/Depletion results are provided for all genomic annotations tested. Permutation <italic>p</italic>-values summarized using Fisher’s method are shown. Data is sorted alphabetically by category and then by genomic annotation.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM9">
        <media xlink:href="12859_2020_3652_MOESM9_ESM.tif">
          <caption>
            <p><bold>Additional file 9: Figure S5.</bold> The number, width, and consistency of TADs called across resolutions and primary vs. replicate for different methods. The average number (A) and width (B) of TADs across resolutions, Jaccard similarity between TAD boundaries detected from primary and replicate data and modified Jaccard similarity between TAD boundaries detected from data at 10 kb, 25 kb and 50 kb resolutions (C) and the proportion of shared boundaries across four replicates (D) are shown. HiCseg failed to run on some data due to sparsity, as indicated by gray bars on panel D. Wilcoxon test <italic>p</italic>-values are shown. Data from the GM12878 cell line, chromosomes 1–22.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM10">
        <media xlink:href="12859_2020_3652_MOESM10_ESM.tif">
          <caption>
            <p><bold>Additional file 10: Figure S6.</bold> The effect of the hierarchy of TAD boundaries detected by SpectralTAD on the average number of annotations in enriched (A) and depleted (B) genomic markers and on enrichment (C) and depletion (D) for different genomic annotations. Results for TAD boundaries detected as Level 1, 2, and 3 boundaries are shown. Genomic annotations were considered within 50 kb regions flanking a boundary on both sides. Wilcoxon test <italic>p</italic>-values are shown in panel A &amp; B, and aggregated <italic>p</italic>-values, using the Fisher’s method, are shown for panels C &amp; D. Raw data from GM12878 cell line, chromosome 1–22, 50 kb resolution.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM11">
        <media xlink:href="12859_2020_3652_MOESM11_ESM.xlsx">
          <caption>
            <p><bold>Additional file 11: Table S4.</bold> Hi-C Data sources. Information about experimental [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] and simulated [<xref ref-type="bibr" rid="CR42">42</xref>] Hi-C data.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM12">
        <media xlink:href="12859_2020_3652_MOESM12_ESM.tif">
          <caption>
            <p><bold>Additional file 12: Figure S7.</bold> Jaccard similarity of TAD boundaries across cell types (A) and tissues (B). TADs were called using SpectralTAD. Clustering was performed using Ward clustering applied to a Jaccard distance matrix. All TADs were called on raw 40 kb data from [<xref ref-type="bibr" rid="CR39">39</xref>]. Various cell-lines and tissues are used.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM13">
        <media xlink:href="12859_2020_3652_MOESM13_ESM.pdf">
          <caption>
            <p><bold>Additional file 13: Table S5.</bold> Jaccard similarity across TAD hierarchy. Results for the corresponding comparison of Primary, Secondary, Tertiary TADs, and Level 1, 2, 3 TAD boundaries are shown. Jaccard similarity coefficients were compared using a Wilcoxon signed-rank test. Column <italic>p</italic>-values correspond to the comparison of Jaccard within levels between tissue samples and cell lines. Row <italic>p</italic>-values correspond to the comparisons within each type of data across the hierarchy.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM14">
        <media xlink:href="12859_2020_3652_MOESM14_ESM.tif">
          <caption>
            <p><bold>Additional file 14: Figure S8.</bold> Runtime performance of various TAD callers. TADs were called using data from the GM12878 cell line at 10 kb and 25 kb resolution, and runtimes recorded. (A) Runtimes were summarized across different chromosomes. Each dot represents chromosome-specific run time averaged across three runs, with the regression line approximating the trend. X-axis – chromosome size in the number of bins, Y-axis – time in seconds. (B) The total time to analyze chromosomes 1–22 was calculated and summarized across methods and levels of parallelization for GM12878 25 kb resolution data. X-axis – Method, Y-axis – time in seconds. Results for HiCSeg are excluded due to exceptionally slow runtimes (24h hours for one 10 kb chromosome).</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM15">
        <media xlink:href="12859_2020_3652_MOESM15_ESM.tif">
          <caption>
            <p><bold>Additional file 15: Figure S9.</bold> Projection of eigenvectors on the unit circle. This projection allows us to identify TADs based on the distance between eigenvectors. The two largest gaps are used to separate TAD 1, TAD 2, and TAD 3. We can also see the difference between a strongly organized group with close together points (TAD 1 and TAD 2) and a weaker group with more spread out points (TAD 3). Simulated data from [<xref ref-type="bibr" rid="CR42">42</xref>].</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM16">
        <media xlink:href="12859_2020_3652_MOESM16_ESM.tif">
          <caption>
            <p><bold>Additional file 16: Figure S10.</bold> Distribution of eigenvector gaps. The distributions of eigenvector gaps are plotted separately for each 10 kb, 25 kb, and 50 kb contact matrix from [<xref ref-type="bibr" rid="CR3">3</xref>], 131 chromosome-specific datasets total. Results are colored by resolution. Higher-resolution data shows smaller overall gaps due to a larger number of regions of high sparsity. The untransformed eigenvector gaps (A) and the natural log eigenvector gaps (B) are shown. MASS::fitdistr() function was used to establish the best fit by a lognormal (67 datasets) or a Weibull (64 datasets) distributions with similar log-likelihoods. The lognormal fit was chosen to model the distribution of log eigenvector gaps.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>3D</term>
        <def>
          <p id="Par5">Three-dimensional</p>
        </def>
      </def-item>
      <def-item>
        <term>Hi-C</term>
        <def>
          <p id="Par6">Genome-wide chromatin conformation capture technology</p>
        </def>
      </def-item>
      <def-item>
        <term>ICE</term>
        <def>
          <p id="Par7">Iterative correction and eigenvector decomposition normalization</p>
        </def>
      </def-item>
      <def-item>
        <term>KR</term>
        <def>
          <p id="Par8">Knight-Ruiz normalization</p>
        </def>
      </def-item>
      <def-item>
        <term>sqrtVC</term>
        <def>
          <p id="Par9">Square root vanilla coverage normalization</p>
        </def>
      </def-item>
      <def-item>
        <term>TADs</term>
        <def>
          <p id="Par10">Topologically associated domains</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Kellen G. Cresswell and Mikhail G. Dozmorov contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03652-w.</p>
  </sec>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MGD and KGC conceived the project, KGC implemented SpectralTAD. JCS helped with the data analysis. MGD and KGC wrote the manuscript with JCS contributions. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is supported in part by the PhRMA Foundation Research Informatics Award to MD.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are publicly available. For a comprehensive list of data sources and download links, see Supplementary Table S2 (Additional file <xref rid="MOESM5" ref-type="media">5</xref>) and Supplementary Table S4 (Additional file <xref rid="MOESM11" ref-type="media">11</xref>).</p>
    <p>The SpectralTAD R package can be downloaded from its Bioconductor page <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/SpectralTAD/">https://bioconductor.org/packages/SpectralTAD/</ext-link>. The source code is available under the MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/dozmorovlab/SpectralTAD">https://github.com/dozmorovlab/SpectralTAD</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par67">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par68">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par69">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science.</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <?supplied-pmid 11847345?>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science.</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell.</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pope</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Ryba</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dileep</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Denas</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topologically associating domains are stable units of replication-timing regulation</article-title>
        <source>Nature.</source>
        <year>2014</year>
        <volume>515</volume>
        <fpage>402</fpage>
        <lpage>405</lpage>
        <?supplied-pmid 25409831?>
        <pub-id pub-id-type="pmid">25409831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nora</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial partitioning of the regulatory landscape of the x-inactivation Centre</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>381</fpage>
        <lpage>385</lpage>
        <?supplied-pmid 22495304?>
        <pub-id pub-id-type="pmid">22495304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taberlay</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Achinger-Kawecka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Sabir</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional disorganization of the cancer genome occurs coincident with long-range genetic and epigenetic alterations</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>719</fpage>
        <lpage>731</lpage>
        <?supplied-pmid 27053337?>
        <pub-id pub-id-type="pmid">27053337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <?supplied-pmid 22495300?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sexton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bantignies</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Leblanc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hoichman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional folding and functional organization principles of the drosophila genome</article-title>
        <source>Cell.</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>458</fpage>
        <lpage>472</lpage>
        <?supplied-pmid 22265598?>
        <pub-id pub-id-type="pmid">22265598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciabrelli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Chromatin-driven behavior of topologically associating domains</article-title>
        <source>J Mol Biol</source>
        <year>2015</year>
        <volume>427</volume>
        <fpage>608</fpage>
        <lpage>625</lpage>
        <?supplied-pmid 25280896?>
        <pub-id pub-id-type="pmid">25280896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Gorkin</surname>
            <given-names>DU</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Chromatin domains: the unit of chromosome organization</article-title>
        <source>Mol Cell</source>
        <year>2016</year>
        <volume>62</volume>
        <fpage>668</fpage>
        <lpage>680</lpage>
        <?supplied-pmid 27259200?>
        <pub-id pub-id-type="pmid">27259200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ferrai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chiariello</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Schueler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Laudanno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hierarchical folding and reorganization of chromosomes are linked to transcriptional changes in cellular differentiation</article-title>
        <source>Mol Syst Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>852</fpage>
        <?supplied-pmid 26700852?>
        <pub-id pub-id-type="pmid">26700852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibcus</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The hierarchy of the 3D genome</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <?supplied-pmid 23473598?>
        <pub-id pub-id-type="pmid">23473598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tjong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alber</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopDom: An efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e70</fpage>
        <?supplied-pmid 26704975?>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lévy-Leduc</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mary-Huard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional segmentation for analyzing hi-c data</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>i386</fpage>
        <lpage>i392</lpage>
        <?supplied-pmid 25161224?>
        <pub-id pub-id-type="pmid">25161224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution hi-c experiments</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <?supplied-pmid 27467249?>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boulos</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Tremblay</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Arneodo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Borgnat</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Audit</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Multi-scale structural community organisation of the human genome</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>209</fpage>
        <?supplied-pmid 28399820?>
        <pub-id pub-id-type="pmid">28399820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Sauria</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Sanyal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gerasimova</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>
        <source>Cell.</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>1281</fpage>
        <lpage>1295</lpage>
        <?supplied-pmid 23706625?>
        <pub-id pub-id-type="pmid">23706625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berlivet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paquette</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dumouchel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langlais</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kmita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Clustering of tissue-specific sub-TADs accompanies the regulation of HoxA genes in developing limbs</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1004018</fpage>
        <?supplied-pmid 24385922?>
        <pub-id pub-id-type="pmid">24385922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Filippova</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Identification of alternative topological domains in chromatin</article-title>
        <source>Algorithms for Molecular Biology</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>14</fpage>
        <?supplied-pmid 24868242?>
        <pub-id pub-id-type="pmid">24868242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dali</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of topologically associating domain prediction tools</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>2994</fpage>
        <lpage>3005</lpage>
        <?supplied-pmid 28334773?>
        <pub-id pub-id-type="pmid">28334773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hero</surname>
            <given-names>AO</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Rajapakse</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Spectral identification of topological domains</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2151</fpage>
        <lpage>2158</lpage>
        <?supplied-pmid 27153657?>
        <pub-id pub-id-type="pmid">27153657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>SX</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiclass spectral clustering</article-title>
        <source>Proceedings of the ninth ieee international conference on computer vision - volume 2</source>
        <year>2003</year>
        <publisher-loc>Washington, DC</publisher-loc>
        <publisher-name>IEEE Computer Society</publisher-name>
        <fpage>313</fpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Muir</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meixner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ljungman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional organization of the human 4D nucleome</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>8002</fpage>
        <lpage>8007</lpage>
        <?supplied-pmid 26080430?>
        <pub-id pub-id-type="pmid">26080430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Structural and functional diversity of topologically associating domains</article-title>
        <source>FEBS Lett</source>
        <year>2015</year>
        <volume>589</volume>
        <issue>20 Pt A</issue>
        <fpage>2877</fpage>
        <lpage>2884</lpage>
        <?supplied-pmid 26348399?>
        <pub-id pub-id-type="pmid">26348399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">An L, Yang T, Yang J, Nuebler J, Xiang G, Hardison RC, et al. Hierarchical domain structure reveals the divergence of activity among tads and boundaries. bioRxiv:361147. 10.1101/361147.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Yu W, He B, Tan K. Identifying topologically associating domains and subdomains by gaussian mixture model and proportion test. Nat Commun. 2017;8.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Luzhin AV, Flyamer IM, Khrameeva EE, Ulianov SV, Razin SV, Gavrilov AA. Quantitative differences in tad border strength underly the tad hierarchy in drosophila chromosomes. J Cell Biochem. 2018;120(3):4494–503.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modeling of hi-c contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>1059</fpage>
        <lpage>1065</lpage>
        <?supplied-pmid 22001755?>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">O’Sullivan JM, Hendy MD, Pichugina T, Wake GC, Langowski J. The statistical-mechanics of chromosome conformation capture. Nucleus. 4:390–8.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cournac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marie-Nelly</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mozziconacci</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Normalization of a chromosomal contact map</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>436</fpage>
        <?supplied-pmid 22935139?>
        <pub-id pub-id-type="pmid">22935139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative correction of hi-c data reveals hallmarks of chromosome organization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <?supplied-pmid 22941365?>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Ruiz</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A fast algorithm for matrix balancing</article-title>
        <source>IMA J Numer Anal</source>
        <year>2012</year>
        <volume>33</volume>
        <fpage>1029</fpage>
        <lpage>1047</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>HiCNorm: removing biases in hi-c data via poisson regression</article-title>
        <source>Bioinformatics.</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3131</fpage>
        <lpage>3133</lpage>
        <?supplied-pmid 23023982?>
        <pub-id pub-id-type="pmid">23023982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Alber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>XJ</given-names>
          </name>
        </person-group>
        <article-title>Hi-corrector: a fast, scalable and memory-efficient package for normalizing large-scale hi-c data</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>960</fpage>
        <lpage>962</lpage>
        <?supplied-pmid 25391400?>
        <pub-id pub-id-type="pmid">25391400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Statistical confidence estimation for hi-c data reveals regulatory chromatin contacts</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <?supplied-pmid 24501021?>
        <pub-id pub-id-type="pmid">24501021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fotuhi Siahpirani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A multi-task graph-clustering approach for chromosome conformation capture data sets identifies conserved modules of chromosomal interactions</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>114</fpage>
        <?supplied-pmid 27233632?>
        <pub-id pub-id-type="pmid">27233632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>OCEAN-c: mapping hubs of open chromatin interactions across the genome reveals gene regulatory networks</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>54</fpage>
        <?supplied-pmid 29690904?>
        <pub-id pub-id-type="pmid">29690904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A compendium of chromatin contact maps reveals spatially active regions in the human genome</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>2042</fpage>
        <lpage>2059</lpage>
        <?supplied-pmid 27851967?>
        <pub-id pub-id-type="pmid">27851967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sauerwald</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Quantifying the similarity of topological domains across normal and cancer human cell types</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>i475</fpage>
        <lpage>i483</lpage>
        <?supplied-pmid 29949963?>
        <pub-id pub-id-type="pmid">29949963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Zufferey M, Tavernari D, Oricchio E, Ciriello G. Comparison of computational methods for the identification of topologically associating domains. Genome Biol. 2018;19.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nicoletti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Livi</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bicciato</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparison of computational methods for hi-c data analysis</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <lpage>685</lpage>
        <?supplied-pmid 28604721?>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Bristor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Schaar</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <?supplied-pmid 20436461?>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheffield</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>LOLA: enrichment analysis for genomic region sets and regulatory elements in r and bioconductor</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 26508757?>
        <pub-id pub-id-type="pmid">26508757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dozmorov</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Cara</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Giles</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Wren</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>GenomeRunner web server: regulatory similarity and differences define the functional impact of snp sets</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2256</fpage>
        <lpage>2263</lpage>
        <?supplied-pmid 27153607?>
        <pub-id pub-id-type="pmid">27153607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Ramirez F, Bhardwaj V, Arrigoni L, Lam KC, Gruning BA, Villaveces J, et al. High-resolution TADs reveal DNA sequences underlying genome organization in flies. Nat Commun. 2018;9.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Kerpedjiev P, Abdennur N, Lekschas F, McCallum C, Dinkla K, Strobelt H, et al. HiGlass: Web-based visual exploration and analysis of genome interaction maps. bioRxiv. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2017/10/30/121889.abstract">http://biorxiv.org/content/early/2017/10/30/121889.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yardımcı</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Software tools for visualizing hi-c data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>26</fpage>
        <?supplied-pmid 28159004?>
        <pub-id pub-id-type="pmid">28159004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Ing-Simmons E, Vaquerizas JM. Visualising three-dimensional genome organisation in two dimensions. Development. 2019;146.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Malladi</surname>
            <given-names>VS</given-names>
          </name>
          <name>
            <surname>Dreszer</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Learned</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kirkup</surname>
            <given-names>VM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ENCODE data in the UCSC genome browser: year 5 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <fpage>D56</fpage>
        <lpage>D63</lpage>
        <?supplied-pmid 23193274?>
        <pub-id pub-id-type="pmid">23193274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boulos</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Arneodo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Audit</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Revealing long-range interconnected hubs in human chromatin interaction data using graph theory</article-title>
        <source>Phys Rev Lett</source>
        <year>2013</year>
        <volume>111</volume>
        <fpage>118102</fpage>
        <?supplied-pmid 24074120?>
        <pub-id pub-id-type="pmid">24074120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sofueva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>W-C</given-names>
          </name>
          <name>
            <surname>Georgopoulou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vietri Rudan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mira-Bontenbal</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohesin-mediated interactions organize chromosomal domain architecture</article-title>
        <source>EMBO J</source>
        <year>2013</year>
        <volume>32</volume>
        <fpage>3119</fpage>
        <lpage>3129</lpage>
        <?supplied-pmid 24185899?>
        <pub-id pub-id-type="pmid">24185899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Won</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>de la Torre-Ubieta</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Parikshak</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Opland</surname>
            <given-names>CK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome conformation elucidates regulatory relationships in developing human brain</article-title>
        <source>Nature.</source>
        <year>2016</year>
        <volume>538</volume>
        <fpage>523</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 27760116?>
        <pub-id pub-id-type="pmid">27760116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>Y-HE</given-names>
          </name>
          <name>
            <surname>Rajarajan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hirayama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kassim</surname>
            <given-names>BS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The methyltransferase SETDB1 regulates a large neuron-specific topological chromatin domain</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1239</fpage>
        <lpage>1250</lpage>
        <?supplied-pmid 28671686?>
        <pub-id pub-id-type="pmid">28671686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting hierarchical genome folding with network modularity</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>119</fpage>
        <lpage>122</lpage>
        <?supplied-pmid 29334377?>
        <pub-id pub-id-type="pmid">29334377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Luxburg</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on spectral clustering</article-title>
        <source>Stat Comput</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>2007</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
