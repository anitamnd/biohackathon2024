<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ1903 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 xlsx ?>
<?FILEmmc3 xlsx ?>
<?FILEmmc4 xlsx ?>
<?FILEmmc5 xlsx ?>
<?FILEmmc6 xlsx ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9747355</article-id>
    <article-id pub-id-type="pii">S2001-0370(22)00550-5</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2022.11.055</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Special Issue articles from "Computational single cell omics and drug discovery" edited by Pingzhao Hu</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scDrug: From single-cell RNA-seq to drug response prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Hsieh</surname>
          <given-names>Chiao-Yu</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Wen</surname>
          <given-names>Jian-Hung</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Lin</surname>
          <given-names>Shih-Ming</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="af020" ref-type="aff">d</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Tseng</surname>
          <given-names>Tzu-Yang</given-names>
        </name>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="af025" ref-type="aff">e</xref>
      </contrib>
      <contrib contrib-type="author" id="au025">
        <name>
          <surname>Huang</surname>
          <given-names>Jia-Hsin</given-names>
        </name>
        <email>jiahsin.huang@ailabs.tw</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au030">
        <name>
          <surname>Huang</surname>
          <given-names>Hsuan-Cheng</given-names>
        </name>
        <email>hsuancheng@nycu.edu.tw</email>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au035">
        <name>
          <surname>Juan</surname>
          <given-names>Hsueh-Fen</given-names>
        </name>
        <email>yukijuan@ntu.edu.tw</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="af025" ref-type="aff">e</xref>
        <xref rid="af030" ref-type="aff">f</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>a</label>Taiwan AI Labs, Taipei 10351, Taiwan</aff>
      <aff id="af010"><label>b</label>Institute of Biomedical Informatics, National Yang Ming Chiao Tung University, Taipei 11221, Taiwan</aff>
      <aff id="af015"><label>c</label>Department of Life Science, National Taiwan University, Taipei 10617, Taiwan</aff>
      <aff id="af020"><label>d</label>Department of Computer Science and Information Engineering, National Taiwan University, Taipei 10617, Taiwan</aff>
      <aff id="af025"><label>e</label>Graduate Institute of Biomedical Electronics and Bioinformatics, National Taiwan University, Taipei 10617, Taiwan</aff>
      <aff id="af030"><label>f</label>Center for Computational and Systems Biology, National Taiwan University, Taipei 10617, Taiwan</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors at: Taiwan AI Labs, Taipei 10351, Taiwan (J.-H. Huang); Institute of Biomedical Informatics, National Yang Ming Chiao Tung University, Taipei 11221, Taiwan (H.-C. Huang); Department of Life Science, National Taiwan University, Taipei 10617, Taiwan (H.-F. Juan). <email>jiahsin.huang@ailabs.tw</email><email>hsuancheng@nycu.edu.tw</email><email>yukijuan@ntu.edu.tw</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>21</volume>
    <fpage>150</fpage>
    <lpage>157</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="graphical" id="ab005">
      <title>Graphical abstract</title>
      <fig id="f0025" position="anchor">
        <graphic xlink:href="ga1"/>
      </fig>
    </abstract>
    <abstract id="ab010">
      <p>Single-cell RNA sequencing (scRNA-seq) technology allows massively parallel characterization of thousands of cells at the transcriptome level. scRNA-seq is emerging as an important tool to investigate the cellular components and their interactions in the tumor microenvironment. scRNA-seq is also used to reveal the association between tumor microenvironmental patterns and clinical outcomes and to dissect cell-specific effects of drug treatment in complex tissues. Recent advances in scRNA-seq have driven the discovery of biomarkers in diseases and therapeutic targets. Although methods for prediction of drug response using gene expression of scRNA-seq data have been proposed, an integrated tool from scRNA-seq analysis to drug discovery is required. We present scDrug as a bioinformatics workflow that includes a one-step pipeline to generate cell clustering for scRNA-seq data and two methods to predict drug treatments. The scDrug pipeline consists of three main modules: scRNA-seq analysis for identification of tumor cell subpopulations, functional annotation of cellular subclusters, and prediction of drug responses. scDrug enables the exploration of scRNA-seq data readily and facilitates the drug repurposing process. scDrug is freely available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/ailabstw/scDrug" id="ir005">https://github.com/ailabstw/scDrug</ext-link>.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Drug repositioning</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Tumor cell subpopulations</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0005">Analyses of single-cell RNA sequencing (scRNA-seq) datasets have become more commonly used to profile high-resolution cellular composition, leading to the discovery of tumor heterogeneity <xref rid="b0005" ref-type="bibr">[1]</xref> and offering an unprecedented opportunity to study specific biological questions <xref rid="b0010" ref-type="bibr">[2]</xref>, <xref rid="b0015" ref-type="bibr">[3]</xref>. Recently, several scRNA-seq studies have identified individual cell types, even in tumor tissues containing complex cell populations <xref rid="b0020" ref-type="bibr">[4]</xref>. Thus, the details of the expression signature of the malignant tumor cells provide excellent targets for identifying suitable drug treatments. Additionally, targeting malignant tumor sub-cell types may prolong patients’ survival.</p>
    <p id="p0010">Recent years have seen the explosion of research into scRNA-seq and its applications in clinical practice. For example, cancer patients can benefit from the most effective medical treatment by analyzing the scRNA-seq data from the tumors <xref rid="b0025" ref-type="bibr">[5]</xref>. For example, the integration of scRNA-seq data and the drug response profiles of the cancer cell lines from the Library of Integrated Network-based Cellular Signatures (LINCS) <xref rid="b0030" ref-type="bibr">[6]</xref> can successfully select effective drugs to target specific cell subpopulations <xref rid="b0035" ref-type="bibr">[7]</xref>. In addition, large-scale projects such as the Cancer Genome Atlas Program (TCGA) <xref rid="b0040" ref-type="bibr">[8]</xref>, Cancer Cell Line Encyclopedia (CCLE) <xref rid="b0045" ref-type="bibr">[9]</xref>, the Genomics of Drugs Sensitivity in Cancer (GDSC) <xref rid="b0050" ref-type="bibr">[10]</xref>, and the LINCS <xref rid="b0030" ref-type="bibr">[6]</xref>, have provided valuable datasets to link the gene expression and drug treatments.</p>
    <p id="p0015">Drug repositioning is an effective strategy for approved or investigational drugs to develop new treatments for a different disease <xref rid="b0055" ref-type="bibr">[11]</xref>. Several studies have developed different prediction models based on multi-omic data for the selection of potential drugs in cancer <xref rid="b0060" ref-type="bibr">[12]</xref>, <xref rid="b0065" ref-type="bibr">[13]</xref>, <xref rid="b0070" ref-type="bibr">[14]</xref>. Further, recent studies have leveraged scRNA-seq and bulk transcriptomic profiles to predict drug response for heterogeneous tumor cells, such as Beyondcell and CaDRReS-Sc <xref rid="b0075" ref-type="bibr">[15]</xref>, <xref rid="b0080" ref-type="bibr">[16]</xref>. However, incredible numbers of scRNA-seq analysis tools make a difficult learning curve for any biomedical researcher or clinician to readily explore scRNA-seq datasets for translation.</p>
    <p id="p0020">With the maturation of scRNA-seq and bioinformatics analysis, vast numbers of analytical tools have been developed in the past years. Therefore, we develop a new tool, scDrug, from scRNA-seq analysis to drug response prediction. In scDrug, we first constructed the workflow, the scRNA-seq analysis pipeline, for a comprehensive analysis of the scRNA-seq data. scDrug provides an easy-to-use pipeline with scRNA-seq data analysis to sub-clustering tumor cells under a Python environment. Next, we integrated two different approaches to predict drug treatments to target cancer cell subpopulations using public datasets for comprehensive molecular and pharmacological characterization of cancer cell lines, including LINCS <xref rid="b0085" ref-type="bibr">[17]</xref>, GDSC <xref rid="b0050" ref-type="bibr">[10]</xref> and PRISM <xref rid="b0090" ref-type="bibr">[18]</xref>. Specifically, one approach predicts drug sensitivity to a specific tumor cluster, and the other predicts the combined effect of drugs on tumor clusters. Herein, scDrug faithfully provides the prediction results for the domain experts to evaluate the selected drugs. Unlike BeyondCell <xref rid="b0075" ref-type="bibr">[15]</xref> that assesses cell clusters based on drug sensitivity scores, scDrug applies the conventional method using gene expression profiles to annotate tumor clusters. Our validation results demonstrated that scDrug could successfully capture cell responses to drug treatments. scDrug allows researchers to explore the heterogeneity of tumor cells and suggests candidate drugs for effective treatments.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Materials and methods</title>
    <sec id="s0015">
      <label>2.1</label>
      <title>scDrug scRNA-seq data preprocessing</title>
      <p id="p0025">The first step in the pipeline is scRNA-seq data analysis, including data preprocessing by Scanpy <xref rid="b0095" ref-type="bibr">[19]</xref>, imputation by MAGIC <xref rid="b0185" ref-type="bibr">[37]</xref>, batch correction by Harmony <xref rid="b0100" ref-type="bibr">[20]</xref>, clustering by Louvain algorithm <xref rid="b0105" ref-type="bibr">[21]</xref>, identification of differentially expressed genes (DEGs) by Scanpy <xref rid="b0095" ref-type="bibr">[19]</xref>, functional enrichment by GSEAPY <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref> and cell-type annotation by scMatch <xref rid="b0120" ref-type="bibr">[24]</xref>.</p>
      <p id="p0030">In data preprocessing, we filtered out cells with less than 200 genes expressed and genes expressed in less than three cells and kept the cells with a proportion of mitochondrial genes below 30 %. The remaining data undertook normalization to 10,000 total counts per cell, natural logarithmic transformation, highly variable gene annotation, and scaling to unit variance and zero means. Once the data imputation is needed, scDrug also integrates MAGIC <xref rid="b0185" ref-type="bibr">[37]</xref> to impute missing values. Next, we applied principal component analysis (PCA) and adjusted the principal components (PCs) with the Harmony algorithm to eliminate batch effects if needed. We then computed a neighborhood graph on the top 20 PCs and used the Louvain algorithm to cluster cells into groups.</p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>scDrug auto-resolution for clustering</title>
      <p id="p0035">To determine the resolution for clustering, users can choose from manual or automatic assignment. In the automatic mode, we calculated the subsampling-based robustness score described in chooseR <xref rid="b0125" ref-type="bibr">[25]</xref> for resolution values in the interval [0.4, 1.4] with 0.2 spacing. For a given resolution, the average silhouette scores <xref rid="b0130" ref-type="bibr">[26]</xref> were calculated using the distance matrix defined as 1.0 subtracting the co-clustering frequency of 5 repetitions of the clustering, each performed on a random 80 % subset of the dataset, drawn without replacement. We regarded the resolution with the highest score as the optimal clustering resolution.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>Differential gene expression analysis, cell annotation, and functional enrichment</title>
      <p id="p0040">After clustering, scDrug ranked the genes for each cluster to identify differentially expressed genes (DEGs) by using scanpy function <italic>rank_genes_groups</italic> with default parameters. Then, scDrug performed functional enrichment with GSEAPY <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref>. In addition, we used the human GO_Biological_Process_2021 library to execute Enrichr <xref rid="b0110" ref-type="bibr">[22]</xref> on DEGs with log2 fold change above 2 and <italic>p</italic>-value and adjusted <italic>p</italic>-value both below 0.01. For cell-type annotation, we used the expression of all genes and calculated the mean expression of its cells as its gene expression profile (GEP) for each cluster. Next, we applied scMatch <xref rid="b0120" ref-type="bibr">[24]</xref> to annotate cluster-wise cell types based on their GEPs from the truncated FANTOM5 reference dataset <xref rid="b0135" ref-type="bibr">[27]</xref>.</p>
      <p id="p0045">Based on the output of scRNA-seq data analysis, including a scanpy AnnData object <xref rid="b0095" ref-type="bibr">[19]</xref>, a gene expression profile (GEP), UMAPs of the results of batch correction, clustering, and cell-type annotation, and files of DEGs and GSEA <xref rid="b0115" ref-type="bibr">[23]</xref>, users can apply sub-clustering for further inspection by repeating this single-cell data analysis procedure on specified clusters of previously produced AnnData.</p>
    </sec>
    <sec id="s0030">
      <label>2.4</label>
      <title>Survival analysis</title>
      <p id="p0050">To predict how each cluster will affect patients’ survival, we applied the method proposed by Lin et al. <xref rid="b0140" ref-type="bibr">[28]</xref>. First, we selected each cluster’s top 20 differentially expressed genes as a set of cluster-specific gene signatures. Then, the bulk RNA profiles and the corresponding clinical information for patients with different cancer were downloaded from the TCGA database <xref rid="b0145" ref-type="bibr">[29]</xref>. To evaluate the tumor cluster activity in each patient, we constructed an expression table for each patient, with each column representing the gene signature of a cluster. For each cluster and each of its 20 selected genes, the value is assigned to 1 if the gene expression in the patient is higher than its median expression in all the patients; otherwise, the value is set to 0. The column-wise sum (hereafter referred to as the “activity score”) indicates the activation level of each cluster in the patient. For each cluster, patients were divided into “high-expressing” and “low-expressing” groups if their activity score for that cluster was in the top or bottom quartile. Finally, we compared the survival of these two groups with the Kaplan–Meier curves and <italic>p</italic>-value of the log-rank analysis (<xref rid="s0115" ref-type="sec">Supplementary Fig. S1</xref>).</p>
    </sec>
    <sec id="s0035">
      <label>2.5</label>
      <title>Drug response prediction</title>
      <p id="p0055">In the scDrug pipeline, we used the AnnData object generated in the first step (scRNA-seq data analysis) and applied CaDRReS-Sc <xref rid="b0080" ref-type="bibr">[16]</xref> for drug response prediction. CaDRReS-Sc is a machine-learning framework for robust cancer drug response prediction based on scRNA-seq data, which estimated cell clusters' half-maximal inhibitory concentration (IC<sub>50</sub>). Based on the CaDRReS-Sc framework, we provide two pre-trained prediction models, GDSC and PRISM, for the drug response of cell clusters.</p>
      <p id="p0060">The two models were trained using the gene expression and drug response data from the GDSC and PRISM datasets via the objective function without sample bias. We evaluated the prediction performance by calculating drug-wise Spearman correlation coefficients with actual and predicted drug response values. In ascending order, we dropped the drugs whose drug-wise coefficient was lower than the first quartile coefficient.</p>
      <sec id="s0040">
        <label>2.5.1</label>
        <title>Drug-response training data</title>
        <p id="p0065">For the GDSC model, we used the response data (measured IC<sub>50</sub>) of 226 drugs in 1074 cancer cell lines, provided by CaDRReS-Sc from the GDSC database, as our training data. For the PRISM model, we used the PRISM Repurposing dataset (version 19Q4) as the training data, which contained the responses of 1448 drugs against 480 cell lines. Instead of IC<sub>50</sub>, the PRISM dataset provides the drug response in terms of the area under the dose–response curve (AUC). The drug response values were on different scales in two datasets showing an overall Pearson correlation coefficient of 0.615 between the PRISM values (1 − AUC) and the GDSC values (−log(IC<sub>50</sub>)) (<xref rid="s0115" ref-type="sec">Supplementary Fig. S2</xref>). To accommodate the CaDRReS-Sc model framework and increase its prediction power, we adopted scaled 1 <inline-formula><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> AUC as drug response values. The scaling formula was defined as<disp-formula id="e0005"><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>240</mml:mn><mml:mi>D</mml:mi><mml:mo linebreak="badbreak">-</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> represent scaled and unscaled 1 <inline-formula><mml:math id="M5" altimg="si1.svg"><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> AUC, respectively. Evaluation of different scaling coefficients is shown in <xref rid="s0115" ref-type="sec">Supplementary Fig. S3</xref>.</p>
      </sec>
      <sec id="s0045">
        <label>2.5.2</label>
        <title>Gene-expression profiles as features</title>
        <p id="p0070">For the GDSC model, we used the gene expression data of 1,018 cancer cell lines provided by CaDRReS-Sc from the GDSC database, and selected the 17,419 common genes among all cell lines as feature genes for model training. For the PRISM model, the CCLE (Cancer Cell Line Encyclopedia) expression data (version 21Q3) was downloaded from DepMap Portal (<ext-link ext-link-type="uri" xlink:href="https://depmap.org/portal/" id="ir010">https://depmap.org/portal/</ext-link>) and contained 1,379 cell lines and 19,177 genes. We used 8,087 genes whose expressions were correlated with PRISM AUC with at least 0.2 absolute Pearson correlation coefficient as features genes. We calculated log<sub>2</sub> expression fold-change for average expression across cell lines for each feature gene. The kernel feature is cell–cell similarity using the Pearson correlation coefficient based on this fold-change profile.</p>
      </sec>
      <sec id="s0050">
        <label>2.5.3</label>
        <title>Prediction model framework</title>
        <p id="p0075">To predict the IC<sub>50</sub> of cell clusters, we computed the log<sub>2</sub> fold change with respect to the average gene expression values of AnnData and predicted the IC<sub>50</sub> value for each cell. The mean IC<sub>50</sub> prediction then determines the IC<sub>50</sub> of cell clusters among the cells within each cluster. Alternatively, we utilized the log2 fold change between a cluster and others and predicted the cluster-wise IC<sub>50</sub> directly. We modified the CaDRReS-Sc method for the PRISM model by replacing the learning variable IC<sub>50</sub> with scaled 1 <inline-formula><mml:math id="M6" altimg="si1.svg"><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> AUC. The model learned latent pharmacogenomic relations from the transcriptomic and drug response profiles. The cancer cluster-specific model proposed in CaDRReS-Sc <xref rid="b0080" ref-type="bibr">[16]</xref> was defined as<disp-formula id="e0010"><mml:math id="M7" altimg="si5.svg"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">iu</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>μ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>Q</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∙</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>μ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>Q</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M8" altimg="si6.svg"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">iu</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the observed drug response (IC<sub>50</sub> or scaled 1 <inline-formula><mml:math id="M9" altimg="si1.svg"><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula> AUC) of cell line <inline-formula><mml:math id="M10" altimg="si7.svg"><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula> to drug <inline-formula><mml:math id="M11" altimg="si8.svg"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M12" altimg="si9.svg"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">iu</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the predicted drug response, <inline-formula><mml:math id="M13" altimg="si10.svg"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> is the overall mean drug response, <inline-formula><mml:math id="M14" altimg="si11.svg"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>Q</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M15" altimg="si12.svg"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are the bias terms for drug <inline-formula><mml:math id="M16" altimg="si8.svg"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and cell line <inline-formula><mml:math id="M17" altimg="si7.svg"><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula>, respectively, <inline-formula><mml:math id="M18" altimg="si13.svg"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> represent drug <inline-formula><mml:math id="M19" altimg="si8.svg"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and cell line <inline-formula><mml:math id="M20" altimg="si7.svg"><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula> in the <inline-formula><mml:math id="M21" altimg="si14.svg"><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>-dimensional latent space, <inline-formula><mml:math id="M22" altimg="si15.svg"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>is a transformation matrix that projects cell line features (gene expression levels) <inline-formula><mml:math id="M23" altimg="si16.svg"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> onto the latent space, and <inline-formula><mml:math id="M24" altimg="si17.svg"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> is the number of genes.</p>
        <p id="p0080">The bias terms, <inline-formula><mml:math id="M25" altimg="si12.svg"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M26" altimg="si10.svg"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>, don’t capture the true bias from unseen cluster, so they were removed, and the objective function was defined as<disp-formula id="e0015"><mml:math id="M27" altimg="si18.svg"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mfenced open="[" close="]"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mi>u</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">iu</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">iu</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>d</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">‖</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">‖</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="e0020"><mml:math id="M28" altimg="si19.svg"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ui</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>Q</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∙</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M29" altimg="si20.svg"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> is the total number of drug-cell pairs, <inline-formula><mml:math id="M30" altimg="si21.svg"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> is the L2-regularization parameter, and <inline-formula><mml:math id="M31" altimg="si22.svg"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a vector in <inline-formula><mml:math id="M32" altimg="si23.svg"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. A diagram of the detailed prediction procedure is shown in <xref rid="s0115" ref-type="sec">Supplementary Fig. S4</xref>.</p>
      </sec>
      <sec id="s0055">
        <label>2.5.4</label>
        <title>Model training and evaluation</title>
        <p id="p0085">The PRISM and GDSC models were trained with 140-dimensional and 10-dimensional latent space, respectively, with a learning rate of 0.01 and maximum epochs set to 100,000. To evaluate the performance of unseen cell lines, we split 24 cell lines as the validation set and calculated their median absolute error and Pearson correlation coefficient between actual and predicted drug response.</p>
      </sec>
    </sec>
    <sec id="s0060">
      <label>2.6</label>
      <title>Combined treatment prediction</title>
      <p id="p0090">We adopted a recently published computational framework, Premnas <xref rid="b0150" ref-type="bibr">[30]</xref>, to predict potential combined treatment strategies using the LINCS L1000 data <xref rid="b0085" ref-type="bibr">[17]</xref>. Firstly, we generated bulk GEPs from the LINCS L1000 database of a user-specified or automatically determined reference cell line. Eight cell lines with a substantial number of drug perturbation experiments, including A375 (malignant melanoma), A549 (non-small cell lung carcinoma), HCC515 (non-small cell lung adenocarcinoma), HEPG2 (hepatocellular carcinoma), HT29 (colorectal adenocarcinoma), MCF7 (breast adenocarcinoma), PC3 (prostate adenocarcinoma), and YAPC (Pancreatic carcinoma), were used in the scDrug. As for the cell type assignment, we calculated the Pearson correlation coefficient between the single-cell GEP and the bulk GEP of each reference cell type and selected the one with the highest correlation. The anti-logarithmic gene expression profiles of all experiments tested on this cell line were the bulk GEPs used for cell distribution inference afterward.</p>
      <p id="p0095">After extracting the corresponding GEPs from the LINCS L1000 database, we estimated the proportion of each cell subset in bulk samples by CIBERSORTx <xref rid="b0155" ref-type="bibr">[31]</xref>. Subsequently, we assessed the differences in the cell-subset distribution of treated and control samples for each perturbation. The cell subsets whose percentage is reduced more than 90 % after perturbation were considered “killed” by that perturbation. Also, we set a consistency threshold to strengthen the authenticity of the drug efficacy; that is, the reduction (default: 75 %) of the “killed” subset should also be observed in the perturbations using the same compounds at higher concentrations. Finally, we employed a greedy search strategy to provide a combined treatment that inhibits the growth of the greatest number of tumor subpopulations. Briefly, we selected the perturbations that can kill the highest number of subpopulations and have the greatest efficacy by the sum of the reductions across all subpopulations. Of note, the perturbations which result in an identical number of killed subpopulations and the effects were used separately to suggest more combinations. For each iteration, the killed subpopulations were removed, and we recursively added perturbations one at a time until no more subpopulations could be killed.</p>
    </sec>
  </sec>
  <sec id="s0065">
    <label>3</label>
    <title>Results</title>
    <sec id="s0070">
      <label>3.1</label>
      <title>Workflow of scDrug pipeline</title>
      <p id="p0100">The workflow of the scDrug pipeline consists of three main modules: 1) scRNA-seq analysis for identification of tumor cell subpopulations, 2) functional annotation of cellular subclusters, and 3) drug repositioning prediction (<xref rid="f0005" ref-type="fig">Fig. 1</xref>).<fig id="f0005"><label>Fig. 1</label><caption><p>Workflow of scDrug. The first part of scDrug analyzes the scRNA-seq to generate the cell clusters (blue). The second part of scDrug performs the cell type and functional annotations (yellow). The third part of scDrug runs the survival analysis to help identify malignant tumor cell clusters (green) and finally predict candidate drugs with two different methods (red). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr1"/></fig></p>
    </sec>
    <sec id="s0075">
      <label>3.2</label>
      <title>Validation of scDrug pipeline</title>
      <p id="p0105">To validate our scDrug pipeline for predicting cell sensitivity, we used the scRNA-seq data for cells originating from 24 distinct cell lines treated with idasanutlin for 24 h <xref rid="b0160" ref-type="bibr">[32]</xref>. The results showed that scDrug could (1) distinguish all 24 cell lines and (2) accurately predict their corresponding sensitivity to idasanutlin (<xref rid="f0010" ref-type="fig">Fig. 2</xref>).<fig id="f0010"><label>Fig. 2</label><caption><p>Validation of scDrug pipeline. (a) Schema of validating drug-sensitivity predictions. First, scDrug successfully identified all 24 cell lines in both treated and untreated datasets after preprocessing and clustering. Next, the cell proportion change of a cell line was calculated as the ratio of its percentage in the treated data to its ratio in the untreated data. The proportion changes for all cell lines were then compared to the corresponding predicted sensitivity scores using Spearman's correlation coefficient analysis. (b) UMAP visualization for Idasanutlin-treated cells. The clustering result colored the left, and the right was colored by the DepMap IDs provided by McFarland et al. <xref rid="b0160" ref-type="bibr">[32]</xref>.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0110">For both the treated and the control (the one treated with DMSO) datasets, scDrug processed the raw 10X data as described before, and it discovered all the 24 cell lines that each were identified as a single cluster and one extra cluster mixed with a variety of cells in both datasets. We removed the mixed cluster for the downstream analysis. Next, we calculated the fold change in the number of cells per cell line after treatment. Afterward, scDrug estimated each cell line's sensitivity to idasanutlin. The model pre-trained by the control and PRISM data was used to predict the sensitivity score for each cluster (cell line). As expected, the proportion changes were negatively correlated with the predicted sensitivity scores significantly (Spearman's correlation coefficient = −0.42 with <italic>p</italic>-value = 0.04), indicating that scDrug can reflect the drug sensitivity for different cell types.</p>
    </sec>
  </sec>
  <sec id="s0080">
    <label>4</label>
    <title>Case studies</title>
    <sec id="s0085">
      <label>4.1</label>
      <title>Application example I. Hepatocellular carcinoma</title>
      <p id="p0115">We demonstrate the application of the scDrug pipeline on the hepatocellular carcinoma scRNA-seq data (GSE156625), which comprises tens of thousands of cells from patient tissues <xref rid="b0165" ref-type="bibr">[33]</xref>. We performed the scDrug pipeline to recognize the tumor sub-clusters and then predict the candidate drugs for targeting tumor cells (<xref rid="f0015" ref-type="fig">Fig. 3</xref>).<fig id="f0015"><label>Fig. 3</label><caption><p>Case study on hepatocellular carcinoma. (A) The scRNA-seq of Hepatocellular carcinoma was obtained from Sharma et al. (2020); (B) UMAP for patientID distribution after Harmony batch correction; (C) UMAP for the cellular clustering; (D) Auto-resolution is performed by scDrug; (E) Sub-clustering for potential tumor cells from (C); (F) Gene set enrichment analysis for gene ontology annotation of a cell cluster; (G) An example of KM curve for survival analysis; (H) Heatmaps showing the potential drugs in the PRISM database predicted to inhibit cell growth by CaDRReS-Sc. Each cell represents values of predicted sensitivity score of the tumor cell clusters to the drugs; (I) Heatmap showing the optimal combined treatment of six drugs in the LINCS L1000 database to kill the greatest number of cell clusters according to the Premnas prediction.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0120">From the hepatocellular carcinoma scRNA-seq raw data (<xref rid="f0015" ref-type="fig">Fig. 3</xref>A), we first conducted data analysis and biological annotation to identify the tumor sub-population. First, we filtered out the genes and cells with low expression and poor-quality cells showing a high percentage of mitochondrial genes. On the remaining 106 thousand cells, we selected 2307 out of 25,314 highly variable genes for further analysis. Then, we applied PCA to reduce the high dimensionality of single-cell data. Since the cells were collected from several patients, we eliminated the batch effects caused by different patients using the Harmony algorithm (<xref rid="f0015" ref-type="fig">Fig. 3</xref>B). Next, Louvain clustering analysis resulted in 15 cell groups and we annotated each cluster a cell type by using the FANTOM5 database (<xref rid="f0015" ref-type="fig">Fig. 3</xref>C). Among the 15 cell clusters, we considered the 3 clusters with tumor cell percentages over twice the normal cell percentages as the tumor clusters. Then, we performed sub-clustering on the tumor subpopulation at an automatically determined resolution of 0.6 (<xref rid="f0015" ref-type="fig">Fig. 3</xref>D), generating 14 sub-clusters (<xref rid="f0015" ref-type="fig">Fig. 3</xref>E). After clustering, we identified the cluster DEGs and performed the GSEA (<xref rid="f0015" ref-type="fig">Fig. 3</xref>F).</p>
      <p id="p0125">Survival analysis was then applied to identify the most malicious cells among the 14 potential tumor subpopulations. Bulk RNA-seq data samples with hepatocellular liver carcinoma (LIHC) were downloaded from the TCGA. For each tumor subpopulation identified by the single-cell RNA-seq data, we divided the TCGA-LIHC samples into two groups by assessing the expression of its cell signature genes to perform the Kaplan–Meier curves and the log-rank test analysis. We found that the Cluster 4-specific gene signature was significantly associated with shorter survival (hazard ratio = 2.52; −log<sub>2</sub>(<italic>p</italic>-value) = 14) (<xref rid="f0015" ref-type="fig">Fig. 3</xref>G, see the <xref rid="s0115" ref-type="sec">supplementary Table S1</xref> for the top 20 genes in 14 clusters). Scientists have reported that PTMA and STMN1, the top 2 DEGs of Cluster 4, are related to poor prognosis in hepatocellular carcinoma <xref rid="b0170" ref-type="bibr">[34]</xref>, <xref rid="b0175" ref-type="bibr">[35]</xref>.</p>
      <p id="p0130">Moreover, based on the sub-clustering outcome, we predicted the drug response and the combined treatments for the tumor subpopulation using the LINCS and PRISM databases. The top-ranked candidate drugs from the PRISM database are shown in <xref rid="f0015" ref-type="fig">Fig. 3</xref>H and the sensitivity values of all drugs for different sub-clusters are listed in <xref rid="s0115" ref-type="sec">Supplementary Table S2</xref>. For the treatment suggestions from the LINCS L1000 database, scDrug suggests a combined treatment with a minimal therapeutics combination capable of killing 11 out of 14 sub-clusters effectively (<xref rid="f0015" ref-type="fig">Fig. 3</xref>I, <xref rid="s0115" ref-type="sec">Supplementary Table S3</xref>).</p>
    </sec>
    <sec id="s0090">
      <label>4.2</label>
      <title>Application example II. Prostate cancer</title>
      <p id="p0135">We also analyzed the scRNA-seq data for prostate cancer <xref rid="b0180" ref-type="bibr">[36]</xref> with scDrug. Same as in the processing steps described in application example I, scDrug has removed low-quality cells, reduced the batch effects, and performed clustering that the number of clusters was determined by the highest silhouette score instead of a predefined number (the best number of clusters is 15), and annotated each cluster a known cell type by comparing the average gene expression between that cluster and each of 916 cell types in the FANTOM5 database. Finally, among 17,092 cells in the prostate cancer dataset, we identified 15 cell types, including normal immune cells and potential tumor cells.</p>
      <p id="p0140">Six clusters (3458 cells in total) with twice as many cells from tumor tissue as from normal tissue were defined as tumor cells and were pooled together to re-analyze. The scDrug classified these tumor cells into seven clusters with the auto-resolution function (<xref rid="f0020" ref-type="fig">Fig. 4</xref>A). In the survival analysis, cluster 0 was identified as one of the most harmful clusters that could lead to an unfavorable prognosis by the survival analysis (Hazard Ratio = 4.02; log-rank <italic>p</italic>-value = 0.18) (<xref rid="f0020" ref-type="fig">Fig. 4</xref>B). Notably, none of tumor clusters in this dataset yielded a statistical significance at <italic>p</italic>-value &lt;0.05 for the survival analysis. Some possible reasons of this result were due to poor alignment of expression profiles between the heterogenous scRNA-seq dataset and the TCGA data, which has limited sample numbers and cancer types. For the drug repurposing prediction, most of the tumor clusters are sensitive to several drugs, such as dasatinib and mocetinostat (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C, full list is shown in <xref rid="s0115" ref-type="sec">Supplementary Table S4</xref>) Moreover, the combinations of tobramycin, volasertib, and capsaicin enable to a reduction of more than 90 % of cells in cluster 0 and the combination of three drugs are effective to kill 5 out of 7 tumor clusters (<xref rid="f0020" ref-type="fig">Fig. 4</xref>D, detail information in <xref rid="s0115" ref-type="sec">Supplementary Table S5</xref>).<fig id="f0020"><label>Fig. 4</label><caption><p>Case study on prostate cancer. (A) The scRNA-seq of prostate cancer was obtained from Tuong et al. (2021). Sub-clustering for potential tumor cells according to the auto-resolution at 0.6; (B) An example of KM curve for survival analysis; (C) Heatmap showing the optimal combined treatment of six drugs in the LINCS L1000 database to kill the greatest number of cell clusters according to the Premnas prediction; (D) Heatmaps showing the potential drugs in the PRISM database predicted to inhibit cell growth by CaDRReS-Sc. Each cell represents values of the predicted sensitivity score.</p></caption><graphic xlink:href="gr4"/></fig></p>
    </sec>
  </sec>
  <sec id="s0095">
    <label>5</label>
    <title>Conclusion</title>
    <p id="p0145">scDrug is a user-friendly pipeline capable of analyzing scRNA-seq data for drug discovery by integrating various bioinformatics tools. We demonstrated that our package could be used to study tumor scRNA-seq data and aid researchers in combating cancers with the sophisticated suggestion in drug selection. The prediction of drug response in scDrug is limited by experimentally screened compounds, and the available scRNA-seq data with drug treatments are short for evaluation. Future studies on <italic>de novo</italic> prediction of drug sensitivity and extensive experimental validations of the pipeline are necessary. scDrug is in continuous development and open to community contributions.</p>
  </sec>
  <sec id="s0100">
    <title>Funding</title>
    <p id="p0150">This work was supported by the <funding-source id="gp005"><institution-wrap><institution-id institution-id-type="doi">10.13039/100007225</institution-id><institution>Ministry of Science and Technology</institution></institution-wrap></funding-source> (MOST 109-2221-E-002-161-MY3, MOST 109-2221-E-010-012-MY3, MOST 109-2327-B-002-009, and MOST 111-2321-B-002-017), the Higher Education Sprout Project of Ministry of Education (NTU-111L8808, NTU-CC-109L104702-2, NTU-CC-111L893302) in Taiwan.</p>
  </sec>
  <sec id="s0105">
    <title>CRediT authorship contribution statement</title>
    <p id="p0155"><bold>Chiao-Yu Hsieh:</bold> Methodology, Software, Data curation, Investigation, Visualization, Writing – original draft. <bold>Jian-Hung Wen:</bold> Methodology, Software, Data curation, Investigation, Visualization, Writing – original draft. <bold>Shih-Ming Lin:</bold> Data curation, Software. <bold>Tzu-Yang Tseng:</bold> Investigation, Data curation. <bold>Jia-Hsin Huang:</bold> Visualization, Funding acquisition, Investigation, Project administration, Writing – review &amp; editing. <bold>Hsuan-Cheng Huang:</bold> Methodology, Visualization, Conceptualization, Supervision, Writing – review &amp; editing, Funding acquisition. <bold>Hsueh-Fen Juan:</bold> Conceptualization, Supervision, Writing – review &amp; editing, Funding acquisition.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0160">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Kessenbrock</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>R.T.</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Werb</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title>
        <source>Nat Cell Biol</source>
        <volume>20</volume>
        <year>2018</year>
        <fpage>1349</fpage>
        <lpage>1360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-018-0236-7</pub-id>
        <pub-id pub-id-type="pmid">30482943</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Integrative single-cell analysis</article-title>
        <source>Nat Rev Genet</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>257</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0093-7</pub-id>
        <pub-id pub-id-type="pmid">30696980</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Ramani</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Cusanovich</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Huynh</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>
        <source>Science</source>
        <volume>357</volume>
        <year>2017</year>
        <fpage>661</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aam8940</pub-id>
        <pub-id pub-id-type="pmid">28818938</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>González-Silva</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Quevedo</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Varela</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Tumor functional heterogeneity unraveled by scRNA-seq technologies</article-title>
        <source>Trends in Cancer</source>
        <volume>6</volume>
        <year>2020</year>
        <fpage>13</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trecan.2019.11.010</pub-id>
        <pub-id pub-id-type="pmid">31952776</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>K.-T.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H.W.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H.-O.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>Y.J.</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA sequencing identifies subclonal heterogeneity in anti-cancer drug responses of lung adenocarcinoma cells</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>127</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0692-3</pub-id>
        <pub-id pub-id-type="pmid">26084335</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Narayan</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Corsello</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>D.D.</given-names>
          </name>
          <name>
            <surname>Natoli</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A next generation connectivity map: L1000 platform and the first 1,000,000 profiles</article-title>
        <source>Cell</source>
        <volume>171</volume>
        <year>2017</year>
        <fpage>1437</fpage>
        <lpage>1452.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.049</pub-id>
        <pub-id pub-id-type="pmid">29195078</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Aissa</surname>
            <given-names>A.F.</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>A.B.M.M.K.</given-names>
          </name>
          <name>
            <surname>Ariss</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Go</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Rader</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Conrardy</surname>
            <given-names>R.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptional changes associated with drug tolerance and response to combination therapies in cancer</article-title>
        <source>Nat Commun</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1628</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21884-z</pub-id>
        <pub-id pub-id-type="pmid">33712615</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>J.O.</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Jennings</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pan-cancer analysis of whole genomes</article-title>
        <source>Nature</source>
        <volume>578</volume>
        <year>2020</year>
        <fpage>82</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1969-6</pub-id>
        <pub-id pub-id-type="pmid">32025007</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Barretina</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Caponigro</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Venkatesan</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Margolin</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Cancer Cell Line Encyclopedia enables predictive modeling of anticancer drug sensitivity</article-title>
        <source>Nature</source>
        <volume>483</volume>
        <year>2012</year>
        <fpage>603</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11003</pub-id>
        <pub-id pub-id-type="pmid">22460905</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Greninger</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of Drug Sensitivity in Cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>
        <source>Nucleic Acids Res</source>
        <volume>41</volume>
        <year>2013</year>
        <fpage>D955</fpage>
        <lpage>D961</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id>
        <pub-id pub-id-type="pmid">23180760</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Pushpakom</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Iorio</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Eyers</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Escott</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Hopper</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drug repurposing: progress, challenges and recommendations</article-title>
        <source>Nat Rev Drug Discov</source>
        <volume>18</volume>
        <year>2019</year>
        <fpage>41</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2018.168</pub-id>
        <pub-id pub-id-type="pmid">30310233</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y.-Y.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Deep generative neural network for accurate drug response imputation</article-title>
        <source>Nat Commun</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1740</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21997-5</pub-id>
        <pub-id pub-id-type="pmid">33741950</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Ammad-Ud-Din</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Malani</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Murumägi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kallioniemi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drug response prediction by inferring pathway-response associations with kernelized Bayesian matrix factorization</article-title>
        <source>Bioinformatics</source>
        <volume>32</volume>
        <year>2016</year>
        <fpage>i455</fpage>
        <lpage>i463</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw433</pub-id>
        <pub-id pub-id-type="pmid">27587662</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H.-J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>K.-Y.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>T.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cancer Drug Response Profile scan (CDRscan): A deep learning model that predicts drug effectiveness from cancer genomic signature</article-title>
        <source>Sci Rep</source>
        <volume>8</volume>
        <year>2018</year>
        <fpage>8857</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-27214-6</pub-id>
        <pub-id pub-id-type="pmid">29891981</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Fustero-Torre</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Jiménez-Santos</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>García-Martín</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Carretero-Puche</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>García-Jimeno</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ivanchuk</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Beyondcell: targeting cancer therapeutic heterogeneity in single-cell RNA-seq data</article-title>
        <source>Genome Med</source>
        <volume>13</volume>
        <year>2021</year>
        <fpage>187</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-021-01001-x</pub-id>
        <pub-id pub-id-type="pmid">34911571</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Suphavilai</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Chia</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>R.P.</given-names>
          </name>
          <name>
            <surname>Mongia</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting heterogeneity in clone-specific therapeutic vulnerabilities using single-cell transcriptomic signatures</article-title>
        <source>Genome Med</source>
        <volume>13</volume>
        <year>2021</year>
        <fpage>189</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-021-01000-y</pub-id>
        <pub-id pub-id-type="pmid">34915921</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Musa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tripathi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dehmer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Emmert-Streib</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>L1000 viewer: A search engine and web interface for the LINCS Data Repository</article-title>
        <source>Front Genet</source>
        <volume>10</volume>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00557</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Corsello</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Nagari</surname>
            <given-names>R.T.</given-names>
          </name>
          <name>
            <surname>Spangler</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Rossen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kocak</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovering the anticancer potential of non-oncology drugs by systematic viability profiling</article-title>
        <source>Nat Cancer</source>
        <volume>1</volume>
        <year>2020</year>
        <fpage>235</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-019-0018-6</pub-id>
        <pub-id pub-id-type="pmid">32613204</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F.A.</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>V.D.</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J.-L.</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mech</source>
        <volume>2008</volume>
        <year>2008</year>
        <fpage>P10008</fpage>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Kuleshov</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Rouillard</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>N.F.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</article-title>
        <source>Nucleic Acids Res</source>
        <volume>44</volume>
        <year>2016</year>
        <fpage>W90</fpage>
        <lpage>W97</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw377</pub-id>
        <pub-id pub-id-type="pmid">27141961</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>V.K.</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>B.L.</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>M.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>102</volume>
        <year>2005</year>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Denisenko</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>A.R.R.</given-names>
          </name>
        </person-group>
        <article-title>scMatch: a single-cell gene expression profile annotation tool using reference datasets</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>4688</fpage>
        <lpage>4695</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz292</pub-id>
        <pub-id pub-id-type="pmid">31028376</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson-Cross</surname>
            <given-names>R.B.</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Selecting single cell clustering parameter values using subsampling-based robustness metrics</article-title>
        <source>BMC Bioinf</source>
        <volume>22</volume>
        <year>2021</year>
        <fpage>39</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-03957-4</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <volume>20</volume>
        <year>1987</year>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Abugessaisa</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Noguchi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Harshbarger</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kondo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lizio</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FANTOM5 CAGE profiles of human and mouse reprocessed for GRCh38 and GRCm38 genome assemblies</article-title>
        <source>Sci Data</source>
        <volume>4</volume>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">170107</object-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2017.107</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Noel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Borazanci</surname>
            <given-names>E.H.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Amini</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>I.W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis of tumor and stromal compartments of pancreatic ductal adenocarcinoma primary tumors and metastatic lesions</article-title>
        <source>Genome Med</source>
        <volume>12</volume>
        <year>2020</year>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-020-00776-9</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Weinstein</surname>
            <given-names>J.N.</given-names>
          </name>
          <name>
            <surname>Collisson</surname>
            <given-names>E.A.</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>K.R.M.</given-names>
          </name>
          <name>
            <surname>Ozenberger</surname>
            <given-names>B.A.</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Cancer Genome Atlas Pan-Cancer analysis project</article-title>
        <source>Nat Genet</source>
        <volume>45</volume>
        <year>2013</year>
        <fpage>1113</fpage>
        <lpage>1120</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2764</pub-id>
        <pub-id pub-id-type="pmid">24071849</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <mixed-citation publication-type="other" id="h0150">Hsieh C-Y, Tu C-C, Hung J-H. Estimating intraclonal heterogeneity and subpopulation changes from bulk expression profiles in CMap. Life Sci Alliance 2022;5:e202101299. 10.26508/lsa.202101299.</mixed-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol</source>
        <volume>37</volume>
        <year>2019</year>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>McFarland</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Paolella</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Geiger-Schuller</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Shibue</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Rothberg</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed single-cell transcriptional response profiling to define cancer vulnerabilities and therapeutic mechanism of action</article-title>
        <source>Nat Commun</source>
        <volume>11</volume>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17440-w</pub-id>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Seow</surname>
            <given-names>J.J.W.</given-names>
          </name>
          <name>
            <surname>Dutertre</surname>
            <given-names>C.-A.</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Blériot</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Onco-fetal reprogramming of endothelial cells drives immunosuppressive macrophages in hepatocellular carcinoma</article-title>
        <source>Cell</source>
        <volume>183</volume>
        <year>2020</year>
        <fpage>377</fpage>
        <lpage>394.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.08.040</pub-id>
        <pub-id pub-id-type="pmid">32976798</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Ha</surname>
            <given-names>S.Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>S.Y.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>C.-K.</given-names>
          </name>
        </person-group>
        <article-title>Expression of prothymosin α predicts early recurrence and poor prognosis of hepatocellular carcinoma</article-title>
        <source>Hepatobiliary Pancreat Dis Int</source>
        <volume>14</volume>
        <year>2015</year>
        <fpage>171</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1016/S1499-3872(14)60326-X</pub-id>
        <pub-id pub-id-type="pmid">25865690</pub-id>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aberrantly high activation of a FoxM1–STMN1 axis contributes to progression and tumorigenesis in FoxM1-driven cancers</article-title>
        <source>Signal Transd Targeted Therapy</source>
        <volume>6</volume>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1038/s41392-020-00396-0</pub-id>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Tuong</surname>
            <given-names>Z.K.</given-names>
          </name>
          <name>
            <surname>Loudon</surname>
            <given-names>K.W.</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Richoz</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving the immune landscape of human prostate at a single-cell level in health and cancer</article-title>
        <source>Cell Rep</source>
        <volume>37</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">110132</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2021.110132</pub-id>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Nainys</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>
        <source>Cell</source>
        <volume>174</volume>
        <issue>3</issue>
        <year>2018</year>
        <fpage>716</fpage>
        <lpage>729.e27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id>
        <pub-id pub-id-type="pmid">29961576</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0115" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0170">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0030"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.docx"/></supplementary-material></p>
    <p id="p0175">
      <supplementary-material content-type="local-data" id="m0025">
        <caption>
          <title>Supplementary data 2</title>
        </caption>
        <media xlink:href="mmc2.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0180">
      <supplementary-material content-type="local-data" id="m0020">
        <caption>
          <title>Supplementary data 3</title>
        </caption>
        <media xlink:href="mmc3.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0185">
      <supplementary-material content-type="local-data" id="m0015">
        <caption>
          <title>Supplementary data 4</title>
        </caption>
        <media xlink:href="mmc4.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0190">
      <supplementary-material content-type="local-data" id="m0010">
        <caption>
          <title>Supplementary data 5</title>
        </caption>
        <media xlink:href="mmc5.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0195">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary data 6</title>
        </caption>
        <media xlink:href="mmc6.xlsx"/>
      </supplementary-material>
    </p>
  </sec>
  <fn-group>
    <fn id="s0110" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0165">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2022.11.055" id="ir015">https://doi.org/10.1016/j.csbj.2022.11.055</ext-link>.</p>
    </fn>
  </fn-group>
</back>
