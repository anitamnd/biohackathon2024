<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10182850</article-id>
    <article-id pub-id-type="pmid">37140547</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad300</article-id>
    <article-id pub-id-type="publisher-id">btad300</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ppBAM: ProteinPaint BAM track for read alignment visualization and variant genotyping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3727-8025</contrib-id>
        <name>
          <surname>Paul</surname>
          <given-names>Robin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jian</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3119-9940</contrib-id>
        <name>
          <surname>Reilly</surname>
          <given-names>Colleen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sioson</surname>
          <given-names>Edgar</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patel</surname>
          <given-names>Jaimin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Matt</surname>
          <given-names>Gavriel</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Acić</surname>
          <given-names>Aleksandar</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="supporting">Resources</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3979-8200</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Xin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
        <xref rid="btad300-cor1" ref-type="corresp"/>
        <!--xin.zhou@stjude.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad300-cor1">Corresponding author. Department of Computational Biology, St. Jude Children’s Research Hospital, 262 Danny Thomas Place, Memphis, TN 38105, United States. E-mail: <email>xin.zhou@stjude.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-04">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad300</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad300.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>ProteinPaint BAM track (ppBAM) is designed to assist variant review for cancer research and clinical genomics. With performant server-side computing and rendering, ppBAM supports on-the-fly variant genotyping of thousands of reads using Smith–Waterman alignment. To better visualize support for complex variants, reads are realigned against the mutated reference sequence using ClustalO. ppBAM also supports the BAM slicing API of the NCI Genomic Data Commons (GDC) portal, letting researchers conveniently examine genomic details of vast amounts of cancer sequencing data and reinterpret variant calls.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>BAM track examples, tutorial, and GDC file access links are available at <ext-link xlink:href="https://proteinpaint.stjude.org/bam/" ext-link-type="uri">https://proteinpaint.stjude.org/bam/</ext-link>. Source code is available at <ext-link xlink:href="https://github.com/stjude/proteinpaint" ext-link-type="uri">https://github.com/stjude/proteinpaint</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>American Lebanese Syrian Associated Charities</institution>
            <institution-id institution-id-type="DOI">10.13039/100012524</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Mutation detection by next-generation sequencing is becoming mainstream in both cancer research and clinical diagnosis. Common practice includes running variant callers such as GATK (<xref rid="btad300-B6" ref-type="bibr">McKenna et al. 2010</xref>) for detecting variants. Manual review is essential to ensure variant calling accuracy by visually examining read alignment over mutations, especially for indels and complex mutations with alignment inconsistencies. Current BAM visualization tools such as IGV (<xref rid="btad300-B7" ref-type="bibr">Robinson et al. 2017</xref>), pileup.js (<xref rid="btad300-B9" ref-type="bibr">Vanderkam et al. 2016</xref>), BamView (<xref rid="btad300-B1" ref-type="bibr">Carver et al. 2013</xref>), UCSC Genome Browser BAM track (<xref rid="btad300-B2" ref-type="bibr">Fujita et al. 2011</xref>), and BamSnap (<xref rid="btad300-B5" ref-type="bibr">Kwon et al. 2021</xref>) provide limited support for manual review of variant calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), primarily due to the visualization using only reference genome and lacking support for complex mutations. Here, we present ProteinPaint BAM track (ppBAM), a web-based BAM visualization tool based on the ProteinPaint platform (<xref rid="btad300-B10" ref-type="bibr">Zhou et al. 2021</xref>), designed for accurate and efficient variant review. ppBAM leverages ProteinPaint’s server-side computing and rendering to be performant for analyzing variant calls from deep sequencing data. It is well-suited to support clinical genomics efforts such as early detection of pathogenic complex mutations and is easily integrated into local or cloud-based clinical genomics workflows to assist manual review. The cancer research community can also benefit from ppBAM through its support of the NCI Genomic Data Commons (GDC) BAM slicing API (<xref rid="btad300-B3" ref-type="bibr">Heath et al. 2021</xref>).</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Improved variant genotyping by ppBAM</title>
      <p>Typical variant calling results provide only the number of reads supporting the reference and alternative allele, and do not report reads not matching either alleles or uninformative reads with equal similarity to both alleles. As an improvement, ppBAM divides reads to up to four groups against a variant by aligning each read to both reference and alternative alleles using a Rust implementation of Smith–Waterman algorithm (<xref rid="btad300-B4" ref-type="bibr">Köster 2016</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) that can process thousands of reads on-the-fly (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tutorial</xref>). The first two groups are reads supporting the alternative and reference alleles in case of single-allele variants. In case of multiallele variants, multiple groups could be created for each of the alternative alleles (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The next group contains reads not supporting either allele which may be due to a wrong base call at the variant region or possibility of presence of a different alternative allele. The last group contains ambiguous reads with equal similarity to both alleles. Reads from each group are displayed separately for visual comparison (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Realignment of reads supporting alternative allele</title>
      <p>Reads supporting the complex indels can be challenging to comprehend when viewing their alignments on the reference genome, hindered by alignment inconsistencies between reads which otherwise have the same read sequences in the variant region. To solve this problem, the ppBAM allows the user to realign a group of reads against a mutated reference genome which can clearly display read support for a complex mutation. The realignment is done using multiple-sequence alignment tool Clustal Omega (<xref rid="btad300-B8" ref-type="bibr">Sievers and Higgins 2018</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Visualization of cancer genome sequencing results from NCI Genomic Data Commons</title>
      <p>ppBAM supports access to human cancer genome sequencing data hosted in NCI GDC. Given a sample or file ID, ppBAM will list BAM files from the sample, as well as somatic mutations of the same sample by querying the GDC API. Users can either select a mutation, or enter a genomic region or custom mutation to view the read alignments from the GDC BAM file. On-the-fly genotyping is performed on a mutation for users to review the read support (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Use cases</title>
    <sec>
      <title>3.1 ppBAM genotyping resolves alignment inconsistencies in a <italic toggle="yes">TP53</italic> intragenic deletion case</title>
      <p>At an 18-bp deletion in <italic toggle="yes">TP53</italic>, ppBAM classifies out of a total of 1853 reads, 654 reads as supporting reference allele, 959 as supporting alternative allele, 62 as not supporting either allele, and 178 as ambiguous (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Reads classified as supporting alternative allele displays alignment inconsistencies including mismatches, softclips, insertions, or combinations of these (<xref rid="btad300-F1" ref-type="fig">Fig. 1a and b</xref>). ppBAM verifies these reads are indeed supporting the deletion event by realigning to the deletion allele (<xref rid="btad300-F1" ref-type="fig">Fig. 1c</xref>). ppBAM also reveals a large number of ambiguous reads which are attributed to a sequence duplication (GCAGCGC) flanking the deletion, making these reads uninformative for genotyping (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>).</p>
      <fig position="float" id="btad300-F1">
        <label>Figure 1.</label>
        <caption>
          <p>TP53 18-bp deletion example. (a) A complete view of reads supporting the TP53 deletion. (b) Detailed view of selected set of reads from (a) with various alignment inconsistencies. (c) The same set of reads as (b) but realigned to the alternative allele using ClustalO.</p>
        </caption>
        <graphic xlink:href="btad300f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 ppBAM genotyping pinpoints a wrong variant call</title>
      <p>A wrong variant call is easily flagged by the variant genotyping feature of ppBAM. When visualizing reads alignment for a previously published complex mutation in cancer genome, ppBAM displays only 3 reads supporting the mutation and 106 reads supporting neither reference nor alternative allele, indicating wrong variant call (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6a</xref>). Manual correction to the variant increases the number of reads to 102 supporting the alternative allele (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6b</xref>) and is further confirmed by realignment (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6c</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Summary</title>
    <p>ppBAM track is an efficient web tool to support read alignment visualization and variant review, using on-the-fly genotyping. Users can use it standalone to access rich BAM resources in NCI GDC or private BAM files using local ppBAM instance, or integrate it into any web-based clinical genomics workflow to assist variant review.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad300_Supplementary_Data</label>
      <media xlink:href="btad300_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by a contract from Leidos and NCI (20X068F3), and by American Lebanese Syrian Associated Charities (ALSAC).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All code and data used in this paper are available in the GitHub repository at <ext-link xlink:href="https://github.com/stjude/proteinpaint" ext-link-type="uri">https://github.com/stjude/proteinpaint</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad300-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carver</surname><given-names>T</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Otto</surname><given-names>TD</given-names></string-name></person-group><etal>et al</etal><article-title>BamView: visualizing and interpretation of next-generation sequencing read alignments</article-title>. <source>Brief Bioinform</source><year>2013</year>;<volume>14</volume>:<fpage>203</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">22253280</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fujita</surname><given-names>PA</given-names></string-name>, <string-name><surname>Rhead</surname><given-names>B</given-names></string-name>, <string-name><surname>Zweig</surname><given-names>AS</given-names></string-name></person-group><etal>et al</etal><article-title>The UCSC genome browser database: update 2011</article-title>. <source>Nucleic Acids Res</source><year>2011</year>;<volume>39</volume>:<fpage>D876</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">20959295</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heath</surname><given-names>AP</given-names></string-name>, <string-name><surname>Ferretti</surname><given-names>V</given-names></string-name>, <string-name><surname>Agrawal</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The NCI genomic data commons</article-title>. <source>Nat Genet</source><year>2021</year>;<volume>53</volume>:<fpage>257</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">33619384</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Köster</surname><given-names>J.</given-names></string-name></person-group><article-title>Rust-Bio: a fast and safe bioinformatics library</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>444</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">26446134</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwon</surname><given-names>M</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name>, <string-name><surname>Berselli</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>BamSnap: a lightweight viewer for sequencing reads in BAM files</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>263</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">33416869</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>JT</given-names></string-name>, <string-name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></string-name>, <string-name><surname>Wenger</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>Variant review with the integrative genomics viewer</article-title>. <source>Cancer Res</source><year>2017</year>;<volume>77</volume>:<fpage>e31</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">29092934</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG.</given-names></string-name></person-group><article-title>Clustal omega for making accurate alignments of many protein sequences</article-title>. <source>Protein Sci</source><year>2018</year>;<volume>27</volume>:<fpage>135</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">28884485</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vanderkam</surname><given-names>D</given-names></string-name>, <string-name><surname>Aksoy</surname><given-names>BA</given-names></string-name>, <string-name><surname>Hodes</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Pileup.js: a JavaScript library for interactive and in-browser visualization of genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2378</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27153605</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Patel</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Exploration of coding and non-coding variants in cancer using GenomePaint</article-title>. <source>Cancer Cell</source><year>2021</year>;<volume>39</volume>:<fpage>83</fpage>–<lpage>95.e4</lpage>.<pub-id pub-id-type="pmid">33434514</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10182850</article-id>
    <article-id pub-id-type="pmid">37140547</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad300</article-id>
    <article-id pub-id-type="publisher-id">btad300</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ppBAM: ProteinPaint BAM track for read alignment visualization and variant genotyping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3727-8025</contrib-id>
        <name>
          <surname>Paul</surname>
          <given-names>Robin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jian</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3119-9940</contrib-id>
        <name>
          <surname>Reilly</surname>
          <given-names>Colleen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sioson</surname>
          <given-names>Edgar</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patel</surname>
          <given-names>Jaimin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Matt</surname>
          <given-names>Gavriel</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Acić</surname>
          <given-names>Aleksandar</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="supporting">Resources</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3979-8200</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Xin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Computational Biology, St. Jude Children’s Research Hospital</institution>, Memphis, TN 38105, <country country="US">United States</country></aff>
        <xref rid="btad300-cor1" ref-type="corresp"/>
        <!--xin.zhou@stjude.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad300-cor1">Corresponding author. Department of Computational Biology, St. Jude Children’s Research Hospital, 262 Danny Thomas Place, Memphis, TN 38105, United States. E-mail: <email>xin.zhou@stjude.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-04">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad300</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad300.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>ProteinPaint BAM track (ppBAM) is designed to assist variant review for cancer research and clinical genomics. With performant server-side computing and rendering, ppBAM supports on-the-fly variant genotyping of thousands of reads using Smith–Waterman alignment. To better visualize support for complex variants, reads are realigned against the mutated reference sequence using ClustalO. ppBAM also supports the BAM slicing API of the NCI Genomic Data Commons (GDC) portal, letting researchers conveniently examine genomic details of vast amounts of cancer sequencing data and reinterpret variant calls.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>BAM track examples, tutorial, and GDC file access links are available at <ext-link xlink:href="https://proteinpaint.stjude.org/bam/" ext-link-type="uri">https://proteinpaint.stjude.org/bam/</ext-link>. Source code is available at <ext-link xlink:href="https://github.com/stjude/proteinpaint" ext-link-type="uri">https://github.com/stjude/proteinpaint</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>American Lebanese Syrian Associated Charities</institution>
            <institution-id institution-id-type="DOI">10.13039/100012524</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Mutation detection by next-generation sequencing is becoming mainstream in both cancer research and clinical diagnosis. Common practice includes running variant callers such as GATK (<xref rid="btad300-B6" ref-type="bibr">McKenna et al. 2010</xref>) for detecting variants. Manual review is essential to ensure variant calling accuracy by visually examining read alignment over mutations, especially for indels and complex mutations with alignment inconsistencies. Current BAM visualization tools such as IGV (<xref rid="btad300-B7" ref-type="bibr">Robinson et al. 2017</xref>), pileup.js (<xref rid="btad300-B9" ref-type="bibr">Vanderkam et al. 2016</xref>), BamView (<xref rid="btad300-B1" ref-type="bibr">Carver et al. 2013</xref>), UCSC Genome Browser BAM track (<xref rid="btad300-B2" ref-type="bibr">Fujita et al. 2011</xref>), and BamSnap (<xref rid="btad300-B5" ref-type="bibr">Kwon et al. 2021</xref>) provide limited support for manual review of variant calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), primarily due to the visualization using only reference genome and lacking support for complex mutations. Here, we present ProteinPaint BAM track (ppBAM), a web-based BAM visualization tool based on the ProteinPaint platform (<xref rid="btad300-B10" ref-type="bibr">Zhou et al. 2021</xref>), designed for accurate and efficient variant review. ppBAM leverages ProteinPaint’s server-side computing and rendering to be performant for analyzing variant calls from deep sequencing data. It is well-suited to support clinical genomics efforts such as early detection of pathogenic complex mutations and is easily integrated into local or cloud-based clinical genomics workflows to assist manual review. The cancer research community can also benefit from ppBAM through its support of the NCI Genomic Data Commons (GDC) BAM slicing API (<xref rid="btad300-B3" ref-type="bibr">Heath et al. 2021</xref>).</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Improved variant genotyping by ppBAM</title>
      <p>Typical variant calling results provide only the number of reads supporting the reference and alternative allele, and do not report reads not matching either alleles or uninformative reads with equal similarity to both alleles. As an improvement, ppBAM divides reads to up to four groups against a variant by aligning each read to both reference and alternative alleles using a Rust implementation of Smith–Waterman algorithm (<xref rid="btad300-B4" ref-type="bibr">Köster 2016</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) that can process thousands of reads on-the-fly (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tutorial</xref>). The first two groups are reads supporting the alternative and reference alleles in case of single-allele variants. In case of multiallele variants, multiple groups could be created for each of the alternative alleles (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The next group contains reads not supporting either allele which may be due to a wrong base call at the variant region or possibility of presence of a different alternative allele. The last group contains ambiguous reads with equal similarity to both alleles. Reads from each group are displayed separately for visual comparison (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Realignment of reads supporting alternative allele</title>
      <p>Reads supporting the complex indels can be challenging to comprehend when viewing their alignments on the reference genome, hindered by alignment inconsistencies between reads which otherwise have the same read sequences in the variant region. To solve this problem, the ppBAM allows the user to realign a group of reads against a mutated reference genome which can clearly display read support for a complex mutation. The realignment is done using multiple-sequence alignment tool Clustal Omega (<xref rid="btad300-B8" ref-type="bibr">Sievers and Higgins 2018</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Visualization of cancer genome sequencing results from NCI Genomic Data Commons</title>
      <p>ppBAM supports access to human cancer genome sequencing data hosted in NCI GDC. Given a sample or file ID, ppBAM will list BAM files from the sample, as well as somatic mutations of the same sample by querying the GDC API. Users can either select a mutation, or enter a genomic region or custom mutation to view the read alignments from the GDC BAM file. On-the-fly genotyping is performed on a mutation for users to review the read support (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Use cases</title>
    <sec>
      <title>3.1 ppBAM genotyping resolves alignment inconsistencies in a <italic toggle="yes">TP53</italic> intragenic deletion case</title>
      <p>At an 18-bp deletion in <italic toggle="yes">TP53</italic>, ppBAM classifies out of a total of 1853 reads, 654 reads as supporting reference allele, 959 as supporting alternative allele, 62 as not supporting either allele, and 178 as ambiguous (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Reads classified as supporting alternative allele displays alignment inconsistencies including mismatches, softclips, insertions, or combinations of these (<xref rid="btad300-F1" ref-type="fig">Fig. 1a and b</xref>). ppBAM verifies these reads are indeed supporting the deletion event by realigning to the deletion allele (<xref rid="btad300-F1" ref-type="fig">Fig. 1c</xref>). ppBAM also reveals a large number of ambiguous reads which are attributed to a sequence duplication (GCAGCGC) flanking the deletion, making these reads uninformative for genotyping (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>).</p>
      <fig position="float" id="btad300-F1">
        <label>Figure 1.</label>
        <caption>
          <p>TP53 18-bp deletion example. (a) A complete view of reads supporting the TP53 deletion. (b) Detailed view of selected set of reads from (a) with various alignment inconsistencies. (c) The same set of reads as (b) but realigned to the alternative allele using ClustalO.</p>
        </caption>
        <graphic xlink:href="btad300f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 ppBAM genotyping pinpoints a wrong variant call</title>
      <p>A wrong variant call is easily flagged by the variant genotyping feature of ppBAM. When visualizing reads alignment for a previously published complex mutation in cancer genome, ppBAM displays only 3 reads supporting the mutation and 106 reads supporting neither reference nor alternative allele, indicating wrong variant call (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6a</xref>). Manual correction to the variant increases the number of reads to 102 supporting the alternative allele (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6b</xref>) and is further confirmed by realignment (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6c</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Summary</title>
    <p>ppBAM track is an efficient web tool to support read alignment visualization and variant review, using on-the-fly genotyping. Users can use it standalone to access rich BAM resources in NCI GDC or private BAM files using local ppBAM instance, or integrate it into any web-based clinical genomics workflow to assist variant review.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad300_Supplementary_Data</label>
      <media xlink:href="btad300_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by a contract from Leidos and NCI (20X068F3), and by American Lebanese Syrian Associated Charities (ALSAC).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All code and data used in this paper are available in the GitHub repository at <ext-link xlink:href="https://github.com/stjude/proteinpaint" ext-link-type="uri">https://github.com/stjude/proteinpaint</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad300-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carver</surname><given-names>T</given-names></string-name>, <string-name><surname>Harris</surname><given-names>SR</given-names></string-name>, <string-name><surname>Otto</surname><given-names>TD</given-names></string-name></person-group><etal>et al</etal><article-title>BamView: visualizing and interpretation of next-generation sequencing read alignments</article-title>. <source>Brief Bioinform</source><year>2013</year>;<volume>14</volume>:<fpage>203</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">22253280</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fujita</surname><given-names>PA</given-names></string-name>, <string-name><surname>Rhead</surname><given-names>B</given-names></string-name>, <string-name><surname>Zweig</surname><given-names>AS</given-names></string-name></person-group><etal>et al</etal><article-title>The UCSC genome browser database: update 2011</article-title>. <source>Nucleic Acids Res</source><year>2011</year>;<volume>39</volume>:<fpage>D876</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">20959295</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heath</surname><given-names>AP</given-names></string-name>, <string-name><surname>Ferretti</surname><given-names>V</given-names></string-name>, <string-name><surname>Agrawal</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The NCI genomic data commons</article-title>. <source>Nat Genet</source><year>2021</year>;<volume>53</volume>:<fpage>257</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">33619384</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Köster</surname><given-names>J.</given-names></string-name></person-group><article-title>Rust-Bio: a fast and safe bioinformatics library</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>444</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">26446134</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwon</surname><given-names>M</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name>, <string-name><surname>Berselli</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>BamSnap: a lightweight viewer for sequencing reads in BAM files</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>263</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">33416869</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>JT</given-names></string-name>, <string-name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></string-name>, <string-name><surname>Wenger</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>Variant review with the integrative genomics viewer</article-title>. <source>Cancer Res</source><year>2017</year>;<volume>77</volume>:<fpage>e31</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">29092934</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sievers</surname><given-names>F</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>DG.</given-names></string-name></person-group><article-title>Clustal omega for making accurate alignments of many protein sequences</article-title>. <source>Protein Sci</source><year>2018</year>;<volume>27</volume>:<fpage>135</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">28884485</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vanderkam</surname><given-names>D</given-names></string-name>, <string-name><surname>Aksoy</surname><given-names>BA</given-names></string-name>, <string-name><surname>Hodes</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Pileup.js: a JavaScript library for interactive and in-browser visualization of genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2378</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27153605</pub-id></mixed-citation>
    </ref>
    <ref id="btad300-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Patel</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Exploration of coding and non-coding variants in cancer using GenomePaint</article-title>. <source>Cancer Cell</source><year>2021</year>;<volume>39</volume>:<fpage>83</fpage>–<lpage>95.e4</lpage>.<pub-id pub-id-type="pmid">33434514</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
