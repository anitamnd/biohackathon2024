<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6966853</article-id>
    <article-id pub-id-type="pmid">31948388</article-id>
    <article-id pub-id-type="publisher-id">3324</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3324-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Lag penalized weighted correlation for time series clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4078-9176</contrib-id>
        <name>
          <surname>Chandereng</surname>
          <given-names>Thevaa</given-names>
        </name>
        <address>
          <email>chandereng@wisc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5324-9833</contrib-id>
        <name>
          <surname>Gitter</surname>
          <given-names>Anthony</given-names>
        </name>
        <address>
          <email>gitter@biostat.wisc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Morgridge Institute of Research, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Statistics, University of Wisconsin-Madison, </institution></institution-wrap>Madison, WI USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>21</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The similarity or distance measure used for clustering can generate intuitive and interpretable clusters when it is tailored to the unique characteristics of the data. In time series datasets generated with high-throughput biological assays, measurements such as gene expression levels or protein phosphorylation intensities are collected sequentially over time, and the similarity score should capture this special temporal structure.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a clustering similarity measure called Lag Penalized Weighted Correlation (LPWC) to group pairs of time series that exhibit closely-related behaviors over time, even if the timing is not perfectly synchronized. LPWC aligns time series profiles to identify common temporal patterns. It down-weights aligned profiles based on the length of the temporal lags that are introduced. We demonstrate the advantages of LPWC versus existing time series and general clustering algorithms. In a simulated dataset based on the biologically-motivated impulse model, LPWC is the only method to recover the true clusters for almost all simulated genes. LPWC also identifies clusters with distinct temporal patterns in our yeast osmotic stress response and axolotl limb regeneration case studies.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">LPWC achieves both of its time series clustering goals. It groups time series with correlated changes over time, even if those patterns occur earlier or later in some of the time series. In addition, it refrains from introducing large shifts in time when searching for temporal patterns by applying a lag penalty. The LPWC R package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gitter-lab/LPWC">https://github.com/gitter-lab/LPWC</ext-link>and CRAN under a MIT license.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Unsupervised learning</kwd>
      <kwd>Temporal alignment</kwd>
      <kwd>Hierarchical clustering</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Time series data are collected extensively to study complex and dynamic biological systems [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Tracking the levels of biological molecules such as genes and proteins over time can reveal interactions among them [<xref ref-type="bibr" rid="CR1">1</xref>] and inform treatment decisions in various diseases [<xref ref-type="bibr" rid="CR3">3</xref>]. Temporal or longitudinal data are important across multiple disciplines (for example, finance, engineering, and medicine), but biological time series datasets are often shorter than those in other domains. Typically, separate experiments are required for each timepoint, which limits the number of timepoints collected.</p>
    <p>Similarity in gene expression patterns can correspond to similarity in biological function, which helps direct future research [<xref ref-type="bibr" rid="CR4">4</xref>]. Countless clustering algorithms group data points with similar characteristics, but the meaning of “similar” is inherently subjective and application-specific [<xref ref-type="bibr" rid="CR5">5</xref>]. In time series datasets, similarity must account for the temporal structure. Unlike other data types, observations in time series datasets are dependent on the past. General purpose clustering methods may be able to detect synchronized temporal changes over time but cannot recognize that two entities have the same temporal profile if one is delayed or lagged after the other. In addition, in many cases the timepoints in a biological study are not uniformly distributed over time, and the selection of timepoints is an important aspect of the experimental design [<xref ref-type="bibr" rid="CR6">6</xref>]. The spacing between timepoints in irregular time series affects the similarity of temporal profiles, especially when allowing lags among the clustered entities.</p>
    <p>Many time series clustering algorithms have been introduced to understand the dynamics of biological processes. Some of these clustering approaches are hierarchical, iteratively merging small clusters or dividing large clusters. Others partition entities into clusters, which often requires specifying the number of clusters in advance.</p>
    <p>Hierarchical clustering methods, such as clustering with correlation or transformed Euclidean distance for similarity, were a common choice before the proliferation of time series-specific algorithms [<xref ref-type="bibr" rid="CR4">4</xref>] and continue to be widely used for temporal data [<xref ref-type="bibr" rid="CR7">7</xref>]. Generic approaches ignore the sequential nature of time series data and give the same clusters even if the timepoints are shuffled, but many temporal hierarchical clustering methods exist as well. Dynamic Time Warping (DTW) aligns timepoints so that the distance between the aligned samples is minimized [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Aach et al. introduced a DTW variant that allows aligning the timepoints of one time series to linear interpolations in the other [<xref ref-type="bibr" rid="CR9">9</xref>]. LEAP allows time delays when constructing co-expression networks [<xref ref-type="bibr" rid="CR10">10</xref>]. Likewise, Alonso and Peña compute similarity using cross correlation [<xref ref-type="bibr" rid="CR11">11</xref>]. Short time series (STS) distance computes the rate of change in intensity between adjacent timepoints, but it does not consider lags [<xref ref-type="bibr" rid="CR12">12</xref>]. Trendy performs segmented regression to summarize temporal expression patterns [<xref ref-type="bibr" rid="CR13">13</xref>]. TSclust implements multiple clustering approaches including a modified auto-regressive model, numerous distance functions, and a modified wavelet function that accounts for lags [<xref ref-type="bibr" rid="CR14">14</xref>]. Vilar et al. use forecasting density adopted from auto-regressive models to compute the dissimilarity between time series [<xref ref-type="bibr" rid="CR15">15</xref>]. TimeClust implements two clustering algorithms, Temporal Abstraction Clustering and Random Walk Models for Bayesian Clustering, developed specifically for short time series [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Neither of them accounts for lags.</p>
    <p>Many partition-based clustering algorithms are available for biological time series data as well. The Short Time-series Expression Miner (STEM) enumerates temporal template profiles and matches genes to them, which works best for short time series (3-8 timepoints) [<xref ref-type="bibr" rid="CR19">19</xref>]. DynaMiteC [<xref ref-type="bibr" rid="CR20">20</xref>] clusters genes by fitting them to prototype impulse models [<xref ref-type="bibr" rid="CR21">21</xref>], but impulses are only one type of common temporal pattern [<xref ref-type="bibr" rid="CR1">1</xref>]. DynOmics uses the fast Fourier transform to model expression values using mixtures of cyclic patterns [<xref ref-type="bibr" rid="CR22">22</xref>]. This method also realigns expression values to account for delays but does not treat lagged and unlagged genes differently. Graphical Query Language clusters based on a hidden Markov model [<xref ref-type="bibr" rid="CR23">23</xref>]. Bar-Joseph et al. turn discrete time series expression data into continuous data using splines [<xref ref-type="bibr" rid="CR24">24</xref>]. Their clustering algorithm uses the continuous data and expectation maximization to optimize alignment of the temporal data. GEsture is an online graphical tool that takes a hand-drawn curve as input and searches for similar, dissimilar, or delayed gene expression patterns [<xref ref-type="bibr" rid="CR25">25</xref>]. Other partitioning-based algorithms include a wavelet-based density method using multi-level thresholding [<xref ref-type="bibr" rid="CR26">26</xref>] and Cluster Analysis of Gene Expression Dynamics, which uses auto-regressive equations [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p>Another category of time series clustering methods is Bayesian models [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Several of these are built on Dirichlet processes with mixture models that use the temporal information [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Dahl proposes a clustering algorithm where genes with similar Dirichlet process mixture components are grouped together and the model is fit using Markov Chain Monte Carlo [<xref ref-type="bibr" rid="CR31">31</xref>]. McDowell et al. use a Dirichlet process Gaussian process mixture model that determines the number of clusters and models temporal dependencies [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p>Despite the abundance of clustering algorithms, many popular clustering methods do not have special support for important temporal properties such as lags and irregular timepoints, which we demonstrate with a simple example. Even the methods that do allow lags typically do not treat irregular timepoints differently from regular timepoints. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows how four artificial gene expression profiles are grouped by different clustering methods. This contrived example illustrates desirable properties of a time series clustering algorithm and is not intended to be a formal evaluation. Hierarchical clustering with Euclidean distance (heuc) ignores the timing of the spikes entirely. Two existing time series clustering algorithms, STS and DTW, also fail to group the early and late genes. We introduce a time series clustering algorithm, Lag Penalized Weighted Correlation (LPWC), which captures the delayed responses and the similarity of the early and late genes. LPWC has two modes with a high lag penalty (hLPWC) and low lag penalty (lLPWC).
<fig id="Fig1"><label>Fig. 1</label><caption><p>A simple artificial clustering task with four genes and timepoints at 0, 5, 15, 30, 45, 60, 75, and 90 min. Each of the genes has a sharp rise and fall in expression, which occurs at a different timepoint. Genes 1 and 2 both have late spikes and intuitively should be clustered together. Genes 3 and 4 are both early. Several widely used clustering methods group the genes into two clusters, but only LPWC groups the early and late genes correctly. The colored dots in the table represent the different genes</p></caption><graphic xlink:href="12859_2019_3324_Fig1_HTML" id="MO1"/></fig></p>
    <p>One of the main contributions of LPWC is a similarity function that accounts for pairs of temporal profiles that occur at slightly different times. This generates a gene-gene similarity matrix that can be used as input for standard similarity- or distance-based clustering methods such as hierarchical clustering. The LPWC similarity score is derived from weighted correlation, but the correlations of lagged temporal profiles are penalized using a Gaussian kernel. The kernel is also used to account for irregular time sampling. We demonstrate the advantages of LPWC over existing general and time series clustering algorithms on a simulated impulse model dataset and case studies on the yeast osmotic stress response and axolotl limb regeneration.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Lag Penalized Weighted Correlation overview</title>
      <p>The goal of LPWC is to group genes that have similar shapes in their expression levels over time. These shapes or temporal profiles refer to the patterns of increases and decreases in expression. Two genes have similar temporal shapes if the timing of these increases and decreases coincides even if the expression levels are not the same. In order to identify similar temporal shapes that are not perfectly synchronized, LPWC applies a lag operator to re-align the timepoints when comparing two expression profiles. The lag operator compares the timepoints of one expression profile with later timepoints in the other profile. Because the aligned time series can pair measurements that are temporally far apart, LPWC weights the pairs of timepoints to give stronger consideration to those that are close in time.</p>
      <p>To assess LPWC, we compared it to other popular clustering algorithms on simulated time series datasets where the true clusters are known and conducted two biological case studies. The yeast osmotic stress response data consist of NaCl-induced osmotic stress phosphorylation samples obtained from mass spectrometry [<xref ref-type="bibr" rid="CR32">32</xref>]. The axolotl blastema RNA-seq data are collected upon amputating the right forelimb [<xref ref-type="bibr" rid="CR33">33</xref>]. For the biological case studies, the true clusters are not known, and it is harder to quantitatively evaluate clustering methods. Therefore, we assess whether each clustering algorithm produces clusters with discernible common temporal patterns and makes use of the temporal structure in the data. To assess how the temporal structure is used during clustering, we permute the timepoints.</p>
    </sec>
    <sec id="Sec4">
      <title>Clustering simulated time series data</title>
      <p>In our primary simulation, each simulated time series dataset contains 200 genes with 10 timepoints at 0, 2, 4, 6, 8, 18, 24, 32, 48, and 72 min. A simulated instance is composed of four distinct temporal patterns with 50 genes per pattern. We repeat the sampling, clustering, and evaluation procedure 100 times in both a low and high variance setting, where the variance controls how similar the simulated genes are to the four reference patterns. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows an example dataset simulated in the low variance setting, and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 shows a high variance example. Because the true pattern used to generate each temporal profile is known, the adjusted Rand index (ARI) can be obtained by comparing the true clusters to the cluster assignments produced by different clustering algorithms. ARI of 1 indicates perfect agreement between the true and computed clusters (“<xref rid="Sec14" ref-type="sec">Cluster evaluation</xref>” section).
<fig id="Fig2"><label>Fig. 2</label><caption><p>An example of the four patterns simulated using ImpulseDE [<xref ref-type="bibr" rid="CR21">21</xref>] with low variance. Each model has different characteristics (expression increases and decreases over time) and contains 50 simulated genes</p></caption><graphic xlink:href="12859_2019_3324_Fig2_HTML" id="MO2"/></fig></p>
      <p>We compare LPWC with Euclidean distance with hierarchical clustering (heuc) and kmeans clustering (keuc), Pearson correlation with hierarchical clustering (hcorr) and kmeans clustering (kcorr), DTW with hierarchical clustering, and STS distance with hierarchical clustering (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3). These algorithms include some of the most widely used general clustering approaches as well as two tailored for time series. Instead of using the silhouette method (“<xref rid="Sec14" ref-type="sec">Cluster evaluation</xref>” section) to pick the number of clusters, all methods return exactly four clusters, the correct number of clusters from the simulation.</p>
      <p>In the low variance simulation, the two versions of LPWC, hLPWC and lLPWC, outperform all other methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The clusters from hLPWC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) and lLPWC (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) show that the simulated genes are accurately clustered according to the known assignments. The LPWC ARI scores are close to 1 in almost all of the 100 simulations. The time series clustering methods DTW and STS perform poorly on this task, and hcorr and kcorr are the only other methods that perform reasonably well. This simulation acts as a positive control, demonstrating that LPWC correctly recovers the four temporal expression patterns when we insert moderate offsets in the timing and expression levels.
<fig id="Fig3"><label>Fig. 3</label><caption><p>ARI scores with different clustering methods for the low variance simulated impulse data over 100 different simulations</p></caption><graphic xlink:href="12859_2019_3324_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Example lLPWC clusters for the low variance simulated impulse model. The red lines represent the mean intensity values</p></caption><graphic xlink:href="12859_2019_3324_Fig4_HTML" id="MO4"/></fig></p>
      <p>The high variance simulation is a more challenging clustering task. All methods have median ARI scores less than 0.75 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). LPWC has the best median ARI, but it performs only slightly better than hcorr and kcorr. The correlation-based algorithms (LPWC, hcorr, and kcorr) are more successful than the others because they are robust to the shifts in expression along the y-axis.</p>
      <p>LPWC can perform well with both regular and irregular time series data as long as there are sufficient timepoints to characterize the important temporal features. To demonstrate LPWC’s ability to accommodate irregular spacing between timepoints, we extend the simple example from Fig. <xref rid="Fig1" ref-type="fig">1</xref> using the ImpulseDE model. We simulate artificial time series that contain 50 genes with an early spike in expression and 50 with a late spike. In the early group and the late group, half of the simulated genes spike slightly later than the others. We first create a regular time series, sampling the expression from 0 to 72 min every 6 min (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). We also construct an irregular time series, sampling at 0, 3, 7, 12, 22, 34, 46, 59, and 75 min (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). In both cases, we select the timepoints so that there is a sample before the spike, in the middle of the spike, and after the spike. This enables LPWC to recognize the spike pattern, introduce appropriate lags, and recover perfect clusters regardless of the timepoint spacing (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S6 and S7).</p>
    </sec>
    <sec id="Sec5">
      <title>Yeast osmotic stress response</title>
      <p>We used lLPWC to cluster the yeast phosphopeptides in the osmotic stress response dataset into three clusters (Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Although cluster 3 contains fewer phosphopeptides than the others, this number of clusters was optimal based on our silhouette analysis (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). Clusters 1 and 2 were comparable for both lLPWC and hLPWC, with only the smaller cluster 3 showing a notable difference in the mean temporal trend (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S9 and S10 and Additional file <xref rid="MOESM3" ref-type="media">3</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Clusters for the yeast data using the lLPWC algorithm. The y-axis shows the log2 salt/control ratio after subtracting the 0s log2 ratio from all values so all temporal profiles start at 0. The red lines represent the mean adjusted log2 ratios</p></caption><graphic xlink:href="12859_2019_3324_Fig5_HTML" id="MO5"/></fig></p>
      <p>Among the 344 phosphopeptides, there are 33 nonzero lags in lLPWC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) and 26 nonzero lags in hLPWC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Although few lags are introduced, they are important in aligning the temporal structure of some phosphopeptides with other phosphopeptides. All clusters exhibit distinct temporal patterns. For visualization purposes, we emphasize these patterns by subtracting the value at 0s from all timepoints before applying the lags and plotting the cluster members and the mean temporal trend (Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). In both lLPWC and hLPWC, most of the phosphopeptides are assigned to clusters 1 and 2 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S3 and S4). Phosphopeptides in lLPWC cluster 1 demonstrate an overall increasing trend over time. The cluster members are enriched for many broad Gene Ontology (GO) terms related to signal transduction, cellular response to osmotic stress, and actin cytoskeleton organization, which was previously reported to be an important component of this stress response [<xref ref-type="bibr" rid="CR32">32</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Cluster 1 includes the mitogen-activated protein kinase Hog1 and other important proteins in the osmotic stress response pathway such as kinases Pbs2 and Rck2 and transcription factors Msn4 and Sko1. Cluster 2 phosphopeptides show a decrease in phosphorylation over time. The steady increase and decrease trends in clusters 1 and 2 also reflect the major patterns reported by Kanshin et al. [<xref ref-type="bibr" rid="CR32">32</xref>]. Similar to cluster 1, cluster 2 is also enriched for actin-related terms and general signaling as well as salt and osmotic stress response proteins. These include additional transcription factors Cin5 and Msn2 as well as different phosphorylation sites on Msn4 and Pbs2. Cluster 3, though small, contains a group of phosphopeptides with mostly small changes in phosphorylation over time except for a distinct decrease and increase at 45s. This cluster contains cytokinesis-related proteins.</p>
      <p>After permuting the timepoints, the clusters identified should change if the clustering algorithm has detected patterns that depend on the timing. We use ARI to quantify this change (“<xref rid="Sec14" ref-type="sec">Cluster evaluation</xref>” section). Algorithms that are insensitive to timing will have ARI scores of 1. When comparing the real and permuted data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11 and Table S5), nearly all of the hlPWC and lLPWC ARI scores are greater than 0.75. In this dataset, LPWC does not assign many non-zero lags. Therefore, the clustering does not have a strong dependence on the temporal order and is fairly similar with the real and permuted timepoints.</p>
      <p>As expected, the four general clustering algorithms (heuc, hcorr, kcorr, and keuc) have ARI scores of 1 because they do not use the temporal information. STS has a low ARI but performs poorly on this dataset. It places all genes into a single cluster, except for two genes that are each assigned to their own singleton cluster (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12 and S13 and Table S6). DTW does quite well on the yeast data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S14 and S15). Although three of its clusters are small (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7), the other five contain distinct temporal patterns. The ARI score is also low, showing that DTW does account for the temporal structure in the yeast osmotic stress response data.</p>
    </sec>
    <sec id="Sec6">
      <title>Axolotl blastema</title>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref> plots the axolotl blastema gene expression clusters from hLPWC. Three clusters were selected based on the average silhouette width in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16, and the number of lagged genes and cluster sizes are reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S8 and S9, respectively. We added 1 to each expression value before taking the log2 ratios with respect to time 0 days for visualization purposes only. This dampens the extreme fold changes that occur when the initial gene expression level is close to 0, which obscure the temporal trends in each cluster.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Clusters for the axolotl data using the hLPWC algorithm. The log2 ratio is with respect to the 0 day timepoint. The red lines represent the mean log2 ratios</p></caption><graphic xlink:href="12859_2019_3324_Fig6_HTML" id="MO6"/></fig></p>
      <p>The major temporal trends in each cluster are similar for hLPWC (Fig. <xref rid="Fig6" ref-type="fig">6</xref> and Additional file <xref rid="MOESM4" ref-type="media">4</xref>) and lLPWC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S17 and S18, Tables S10 and S11, and Additional file <xref rid="MOESM5" ref-type="media">5</xref>). In hLPWC cluster 1, gene expression rapidly then gradually increases from 0 to 14 days, decreases until the 21 day timepoint, and stabilizes afterward. This cluster is enriched for GO terms related to the cell cycle, proliferation, blood vessel development, and wound healing (Additional file <xref rid="MOESM4" ref-type="media">4</xref>). The mean cluster 2 trend exhibits down-regulation from 0.25 days until 14 days. The cluster is associated with GO and Kyoto Encyclopedia of Genes and Genomes (KEGG) terms involving ribosomes, RNA-related metabolism, muscle development, and response to oxidative stress. In cluster 3, the mean expression decreases immediately and then rises until day 1, at which point it decreases again until day 10 and then increases for the remainder of the duration. These genes are enriched for type I interferon signaling and other immune processes.</p>
      <p>Because hundreds of genes are assigned non-zero lags in the axolotl case study, both hLPWC and lLPWC have low ARI scores when comparing their clusters with the permuted data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19 and Table S12). The results are highly dependent on the timing of the expression changes, as desired. As with the yeast case study, the four general clustering methods have ARI scores of 1 or close to 1. STS performs poorly once again. One cluster contains 99% of the genes despite their different temporal characteristics (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S20 and S21 and Table S13). Although DTW is excellent on the yeast dataset, it struggles with the axolotl data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S22 and S23 and Table S14). The ARI scores are much higher than on yeast, and it places 98% of genes in a single cluster.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p>LPWC is a generalization of traditional hierarchical clustering with correlation-based similarity. The impulse model simulations illustrate scenarios in which the generalization is most advantageous. When genes are lagged and have different amplitudes than the canonical expression patterns, LPWC still perfectly recovers the correct clusters in almost all of the low variance runs. However, when the simulated genes deviate too much from the canonical patterns, the gene-gene correlations are weaker and LPWC mislabels some genes. When no lags are detected, LPWC is identical to standard hierarchical clustering.</p>
    <p>In both the yeast and axolotl case studies, LPWC successfully identifies clusters with unique temporal patterns. LPWC introduces more lags in the axolotl dataset, which may be due to the close timing of the initial timepoints, and the temporal permutation analysis reflects the stronger temporal dependency when there are more lags. The general kmeans and hierarchical clustering algorithms disregard the timepoints by design. STS has performed well in other applications but places nearly all phosphopeptides or genes into a single cluster in both case studies here. DTW, on the other hand, does very well on the yeast application but creates a single dominant cluster on the axolotl dataset. Only LPWC produces useful clusters that depend on the timing for both datasets.</p>
    <p>LPWC only considers the expression levels at the observed timepoints and does not interpolate between timepoints or rescale time as in DyNB [<xref ref-type="bibr" rid="CR34">34</xref>]. Interpolation with line segments [<xref ref-type="bibr" rid="CR9">9</xref>] or splines [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] makes assumptions about the unobserved behavior between timepoints. Gaussian processes make much weaker assumptions [<xref ref-type="bibr" rid="CR7">7</xref>], but the kernel function still constrains which types of temporal behaviors and smooth profiles are most likely in between the observed times [<xref ref-type="bibr" rid="CR37">37</xref>]. In contrast, LPWC assumes that comparing observed values collected at different times is meaningful. This assumption is less likely to hold when the times are far apart, which is why aligned distant timepoints are given a lower weight. If some of the timepoints are very far apart, the time series data could be interpolated with line segments, splines, Gaussian processes, or other approaches before clustering with LPWC.</p>
    <p>The LPWC software provides two options to automatically set the parameter <italic>C</italic> that controls the lag penalty. On a new dataset, we recommend running both and inspecting the clustering results to assess whether either of the automatically-selected penalties was effective. If there are no or few lags reported, it may be that the dataset is highly correlated in a synchronous manner or that a lower penalty is needed. The low penalty mode is slower because it runs LPWC repeatedly for multiple values of <italic>C</italic>. Users can also directly manipulate <italic>C</italic> by using the values selected by the high and low penalty modes as a guide. Higher values of <italic>C</italic> impose less of a penalty on far apart timepoints.</p>
    <p>Because the main advantage of LPWC is its ability to introduce lags to detect common but unsynchronized temporal patterns, it works best when there are sufficient timepoints to support multiple lags. At least four timepoints are required by LPWC in order to allow one lag. However, if gene <italic>i</italic> and gene <italic>j</italic> are assigned lags of -1 and 1, only two timepoints remain to estimate the correlation. Thus, it is advisable to use LPWC with five or more timepoints. With very short time series we recommend using the high penalty to help avoid spurious correlations. STEM [<xref ref-type="bibr" rid="CR19">19</xref>], which enumerates temporal patterns, may be preferable for very short time series datasets without delayed responses. DTW [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>] has been used extensively in the financial industry for long time series datasets. LPWC can also be applied to long time series, which have sufficient timepoints available to compute reliable correlations even when larger lags are applied. However, the default lag penalties often prevent large lags from being introduced, so <italic>C</italic> may need to be increased beyond the low penalty default. LPWC does not search for common short temporal patterns in a pair of long time series. Rather, it identifies shared trends between the entire prefix of one time series and the entire suffix of another.</p>
    <p>Euclidean distance-based or correlation-based similarity measures can be used for clustering. These approaches emphasize different types of temporal shapes. Correlation reveals the trends in the data, whereas Euclidean distance captures the difference in magnitude of expression levels or fold changes. The preference for one over the other is subjective. We prefer correlation for LPWC because it can be applied directly to the original expression levels without computing fold changes with respect to the initial timepoint. Distance-based time series clustering often requires computing these fold changes so that genes are grouped based on their temporal patterns instead of their average expression level, but this effectively drops one of the timepoints because the variation at the initial timepoint is ignored.</p>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>LPWC is designed to capture temporal structure when clustering biological datasets, capable of modeling irregularly-sampled timepoints and detecting delayed responses. It uses lags to align temporal gene expression profiles and weighted correlation to account for irregular sampling. The similarity scores of lagged genes are penalized in order to prefer synchronized temporal patterns and correlations that are computed using a greater fraction of the timepoints. The choice of lags is important because the observations at the beginning and end of the time series are dropped when comparing aligned lagged genes. Therefore, the default parameters are conservative in terms of how many lags are allowed, which is why only a small fraction of phosphopeptides or genes are lagged in our case studies.</p>
    <p>Currently, LPWC only accepts a single dataset with one common set of timepoints. In high-throughput biological assays like mass spectrometry and RNA-seq, the timepoints sampled are homogeneous because all proteins or genes are measured with a single experiment at each timepoint. One future direction would be to support clustering multiple related biological datasets with different timepoints. There are also opportunities to better approximate the NP-complete Lag Optimization problem (“<xref rid="Sec12" ref-type="sec">Optimal lag optimization</xref>” section) and estimate the default value of <italic>C</italic>, which controls how many lags are introduced.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Lag Penalized Weighted Correlation</title>
      <p>The LPWC algorithm is composed of three steps: choosing lags for each gene, computing the similarity matrix for all gene pairs, and running standard hierarchical clustering. The best lags are selected by maximizing the sum of the similarities for each gene with respect to all other genes. The maximum possible gene-gene similarity decreases as the lag in the aligned timepoints increases because we prefer to recover temporal behaviors that are synchronized or close in time. In addition, we have less confidence in the similarity of the temporal shapes when they are computed with shorter temporal subsequences. The final correlation-based similarity is computed once the lags for all genes are fixed.</p>
      <p>LPWC considers a specific type of local alignment between two time series when assessing the best lag for each gene. The prefix of the time series with the larger lag is aligned with the suffix of the time series with the smaller lag (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The timepoints that belong to the aligned prefix and suffix follow a one-to-one mapping such that the <italic>k</italic>th timepoint of the prefix of one time series is paired with the <italic>k</italic>th timepoint of the suffix of the other time series. The other timepoints are truncated and are not included in the alignment. This alignment strategy differs from the global alignment identified by approaches like DTW. DTW computes a many-to-many mapping between two time series that aligns each timepoint with a timepoint or a linear interpolation in the other time series [<xref ref-type="bibr" rid="CR9">9</xref>]. Therefore, DTW supports not only time shifts but also time stretches.
<fig id="Fig7"><label>Fig. 7</label><caption><p>An example of the effects of applying different lags to genes 1 and 2. The three panels show aligned expression vectors <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub> and aligned timepoint vectors <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>. The lagged timepoint vector indices involving <italic>NA</italic> values are dropped from the tables. Top: with no lags, <italic>X</italic><sub>1</sub>=0 and <italic>X</italic><sub>2</sub>=0, the temporal profiles of genes 1 and 2 are not aligned so the gene pair will have a low LPWC similarity score. Middle: with lags <italic>X</italic><sub>1</sub>=−1 and <italic>X</italic><sub>2</sub>=0, the patterns are aligned, and the LPWC similarity score will be high. Bottom: with <italic>X</italic><sub>1</sub>=−1 and <italic>X</italic><sub>2</sub>=1, the temporal shapes are once again not aligned, and the LPWC similarity score will be even lower than in the top row because the penalty for introducing lags is applied</p></caption><graphic xlink:href="12859_2019_3324_Fig7_HTML" id="MO7"/></fig></p>
      <p>LPWC’s correlation-based similarity function for each gene pair <italic>i</italic>,<italic>j</italic> is</p>
      <p>
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} {} corr_{LPWC}\left(i, j, X_{i}, X_{j}\right) = \exp\left(\frac{- \bar{w}}{C}\right) * corr_{w}\left(L^{X_{i}}Y_{i}, L^{X_{j}}Y_{j}, \exp\left(\frac{- w}{C}\right)\right) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M2">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext mathvariant="italic">cor</mml:mtext>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">LPWC</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>X</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>X</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>=</mml:mo>
                    <mml:mo>exp</mml:mo>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>w</mml:mi>
                              </mml:mrow>
                              <mml:mo>¯</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>∗</mml:mo>
                    <mml:mtext mathvariant="italic">cor</mml:mtext>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>L</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>X</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>Y</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>L</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>X</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>Y</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:mo>exp</mml:mo>
                        <mml:mfenced close=")" open="(">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mi>w</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3324_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>L</italic> is a lag operator, <italic>X</italic><sub><italic>i</italic></sub> is the lag for gene <italic>i</italic>, <italic>Y</italic><sub><italic>i</italic></sub> is the temporal expression levels of gene <italic>i</italic>, <italic>C</italic> is a parameter that controls the lag penalty, <italic>w</italic> is a weight vector, and <italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic><sub><italic>w</italic></sub> is a weighted correlation function. The lag <italic>X</italic><sub><italic>i</italic></sub> is an integer-valued variable that represents the number of indices a temporal profile is shifted forward or backward in time, where positive values represent forward shifts (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The lag operator <italic>L</italic> can be applied to a vector of temporal gene expression levels (<italic>Y</italic><sub><italic>i</italic></sub>) or a vector of timepoints, which we denote as <italic>T</italic><sub><italic>i</italic></sub> for gene <italic>i</italic>. <italic>L</italic> reduces the effective length of the lagged vector, introducing <italic>NA</italic> placeholder values. For example, if <italic>T</italic><sub><italic>i</italic></sub>=[0,5,15] and <italic>Y</italic><sub><italic>i</italic></sub>=[0.2,1.4,4.5], then for <italic>X</italic><sub><italic>i</italic></sub>=1 we have <italic>L</italic><sup>1</sup><italic>T</italic><sub><italic>i</italic></sub>=[<italic>N</italic><italic>A</italic>,0,5] and <italic>L</italic><sup>1</sup><italic>Y</italic><sub><italic>i</italic></sub>=[<italic>N</italic><italic>A</italic>,0.2,1.4]. For <italic>X</italic><sub><italic>i</italic></sub>=−1 we obtain <italic>L</italic><sup>−1</sup><italic>T</italic><sub><italic>i</italic></sub>=[5,15,<italic>N</italic><italic>A</italic>] and <italic>L</italic><sup>−1</sup><italic>Y</italic><sub><italic>i</italic></sub>=[1.4,4.5,<italic>N</italic><italic>A</italic>].</p>
      <p>Given this lag operator, we can define the weight vector <italic>w</italic> for weighted correlation.
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$w = \left(L^{X_{i}}T_{i} - L^{X_{j}}T_{j}\right)^{2}$$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> The vector subtraction is performed after dropping indices where either vector is <italic>NA</italic>. Similarly, in the weighted correlation, defined here generically for input vectors <italic>x</italic> and <italic>y</italic> and weight vector <italic>z</italic>,
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$corr_{w}\left(x, y, z\right) = \frac{\sum_{i} z_{i}(x_{i}-\bar{x})(y_{i}-\bar{y})}{\sqrt{\sum_{i} z_{i}(x_{i}-\bar{x})^{2}\sum_{i} z_{i}(y_{i}-\bar{y})^{2}}}$$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> we drop indices that are <italic>NA</italic> in either <italic>x</italic> or <italic>y</italic> (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).</p>
      <p>The overall penalty for aligning timepoints is derived from the mean weight <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {w}$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq1.gif"/></alternatives></inline-formula>:
<disp-formula id="Equd"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\bar{w} = \frac{\sum_{r =1}^{|w|} w_{r}}{|w|}$$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where <italic>r</italic> is an index for the elements of the weight vector and |<italic>w</italic>| is the vector length. When <italic>X</italic><sub><italic>i</italic></sub>=0 and <italic>X</italic><sub><italic>j</italic></sub>=0, <italic>w</italic> is the zeros vector and <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {w} = 0$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq2.gif"/></alternatives></inline-formula>. This makes the weights for <italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic><sub><italic>w</italic></sub> the ones vector. Thus, the special case <italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic><sub><italic>LPWC</italic></sub>(<italic>i</italic>,<italic>j</italic>,0,0) is the standard (unweighted) Pearson correlation of <italic>Y</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>j</italic></sub>.</p>
      <p>Because choosing the optimal lags <italic>X</italic><sub><italic>i</italic></sub> for all genes is NP-complete (see “<xref rid="Sec12" ref-type="sec">Optimal lag optimization</xref>” section for a sketch of the proof), we use a heuristic approach. For each gene <italic>i</italic>, we store the score and respective lag with respect to all other genes <italic>j</italic>. The parameter <italic>m</italic> is the maximum lag allowed. It is important to control the maximum lag because lags reduce the number of data points used to calculate the weighted correlation. We compute
<disp-formula id="Eque"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$score_{j} = \underset{X_{i} \in \{-m,..., m\}}{\text{max}} \;\, corr_{LPWC}(i, j, X_{i}, 0) \quad \forall j \neq i$$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mtext mathvariant="italic">scor</mml:mtext><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">LPWC</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$lag_{j} = \underset{X_{i} \in \{-m,..., m\}}{\mathrm{arg \,max}} \;\, corr_{LPWC}(i, j, X_{i}, 0) \quad \forall j \neq i$$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mtext mathvariant="italic">la</mml:mtext><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">LPWC</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> Then, a best lag <inline-formula id="IEq3"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {X}_{i}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq3.gif"/></alternatives></inline-formula> for gene <italic>i</italic> assigned by
<disp-formula id="Equg"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat{X}_{i} = \underset{k \in \{-m,..., m\}}{\mathrm{arg \,max}} \sum_{j \neq i} I(lag_{j} = k) * score_{j}$$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">arg</mml:mi><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">max</mml:mtext></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">la</mml:mtext><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">scor</mml:mtext><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> where <italic>I</italic> is an indicator function. This is repeated to select a best lag for all genes.</p>
      <p>Upon obtaining the best lags <inline-formula id="IEq4"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {X}_{i}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq4.gif"/></alternatives></inline-formula> for all genes, we compute the similarity
<disp-formula id="Equh"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} {}corr\left(i, j\right) &amp;= corr_{LPWC}\left(i, j, \hat{X}_{i}, \hat{X}_{j}\right)\\ &amp;= \exp\left(\frac{- \bar{w}}{C}\right) * corr_{w}\left(\!L^{\hat{X}_{i}}Y_{i}, L^{\hat{X}_{j}}Y_{j}, \exp\left(\frac{- w}{C}\right)\!\right) \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext mathvariant="italic">corr</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">LPWC</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3324_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The similarity measure <italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic>(<italic>i</italic>,<italic>j</italic>) can be used directly by a clustering algorithm that requires gene-gene similarities as input. However, LPWC uses hierarchical clustering, which requires a distance measure instead. We know that −1≤<italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic>(<italic>i</italic>,<italic>j</italic>)≤1. Thus, we transform the similarities with <italic>d</italic><italic>i</italic><italic>s</italic><italic>t</italic>(<italic>i</italic>,<italic>j</italic>)=1−<italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic>(<italic>i</italic>,<italic>j</italic>) to obtain distances for hierarchical clustering such that 0≤<italic>d</italic><italic>i</italic><italic>s</italic><italic>t</italic>(<italic>i</italic>,<italic>j</italic>)≤2. We run hierarchical clustering with complete linkage.</p>
    </sec>
    <sec id="Sec11">
      <title>Controlling the lag penalty</title>
      <p>Because lags reduce the number of timepoints used for the correlation calculation and biological time series data are typically short already, there is a risk that two lagged expression vectors will have a high correlation score by chance. Lagged correlation clustering without modification does not perform well [<xref ref-type="bibr" rid="CR22">22</xref>]. Thus, a Gaussian kernel <inline-formula id="IEq5"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\exp \left (\frac {-\bar {w}}{C}\right)$\end{document}</tex-math><mml:math id="M26"><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq5.gif"/></alternatives></inline-formula> is used to scale and penalize the weighted correlation based on the lags. The parameter <italic>C</italic> controls the width of the Gaussian kernel function and the severity of the penalty. The appropriate <italic>C</italic> is subjective and application-specific. Therefore, instead of choosing one universal default penalty parameter <italic>C</italic>, LPWC implements two data-dependent ways to set <italic>C</italic>: the high and low penalty modes. The high penalty (hLPWC) penalizes lags more, increasing the possibility of setting <italic>X</italic><sub><italic>i</italic></sub>=0 compared to the low penalty (lLPWC), which will set more <italic>X</italic><sub><italic>i</italic></sub>≠0. In addition to these two default options, the user can also specify <italic>C</italic> directly to introduce more or fewer lags.</p>
      <p>The overall penalty that LPWC applies to the weighted correlation <italic>c</italic><italic>o</italic><italic>r</italic><italic>r</italic><sub><italic>w</italic></sub> is <inline-formula id="IEq6"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\exp \left (\frac {-\bar {w}}{C}\right)$\end{document}</tex-math><mml:math id="M28"><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq6.gif"/></alternatives></inline-formula>, which scales the correlation by a factor between 0 and 1. For the high penalty, we set the mean penalty over all valid positive lags to 0.5 and solve for <italic>C</italic><disp-formula id="Equi"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$penalty(C) = \frac{\sum\limits_{l = 1}^{m} \exp\left(\frac{-\bar{w}^{l}}{C}\right)}{m} = 0.5$$ \end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mtext mathvariant="italic">penalty</mml:mtext><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> where <italic>m</italic> is the maximum lag and <inline-formula id="IEq7"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {w}^{l}$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq7.gif"/></alternatives></inline-formula> is the mean of the elements in the weight vector <italic>w</italic><sup><italic>l</italic></sup>=(<italic>L</italic><sup><italic>l</italic></sup><italic>T</italic><sub><italic>i</italic></sub>−<italic>L</italic><sup>0</sup><italic>T</italic><sub><italic>i</italic></sub>)<sup>2</sup> obtained from comparing the timepoint vector <italic>T</italic><sub><italic>i</italic></sub> with a lagged version of <italic>T</italic><sub><italic>i</italic></sub>.</p>
      <p>For the low penalty, we compute the values of <italic>C</italic> for which <italic>p</italic><italic>e</italic><italic>n</italic><italic>a</italic><italic>l</italic><italic>t</italic><italic>y</italic>(<italic>C</italic>) produces penalties between 0.5 and 0.95 with a step size of 0.05. For each of those <italic>C</italic>, we run LPWC and obtain the gene-gene similarity matrix. We choose the <italic>C</italic> for which the gene-gene similarity matrix is the most stable with respect to the similarity matrix from the previous <italic>C</italic>. Stability is computed by subtracting the two gene-gene similarity matrices, squaring the elements, and summing them. The lowest sum squared difference is preferred. Because it sweeps over multiple values of <italic>C</italic>, lLPWC is slower than hLPWC.</p>
    </sec>
    <sec id="Sec12">
      <title>Optimal lag optimization</title>
      <p>“<xref rid="Sec10" ref-type="sec">Lag Penalized Weighted Correlation</xref>” section describes a heuristic approach for selecting the best lag <inline-formula id="IEq8"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {X}_{i}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq8.gif"/></alternatives></inline-formula> for each gene. We now formally define the Lag Optimization problem that the heuristic approximates and sketch a proof that the decision version of Lag Optimization is NP-complete. We define Lag Optimization as:</p>
      <p><disp-formula id="Equj"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\begin{aligned} \underset{X_{i}^{k}, X_{i,j}^{k,l}}{\text{arg\,max}}&amp;{\sum_{i=2}^{N} \sum_{j=1}^{i-1} \sum_{k \in M} \sum_{l \in M} X_{i,j}^{k,l}*s_{i,j}^{k,l}}\\ \text{subject\ to} &amp;{\sum_{k \in M} X_{i}^{k}}{=1\quad}{\forall \enskip i \in \{1,...,N\}}\\ &amp;{\sum_{k \in M} \sum_{l \in M} X_{i,j}^{k,l}}{=1\quad}{\forall \enskip i \in \{2,...,N\}, j \in \{1,...,i-1\}}\\ &amp;{X_{i,j}^{k,l}}{\leq X_{i}^{k}\quad}{\forall \enskip i \in \{2,...,N\}, j \in \{1,...,i-1\}, k \in M, l \in M}\\ &amp;{X_{i,j}^{k,l}}{\leq X_{j}^{l}\quad}{\forall \enskip i \in \{2,...,N\}, j \in \{1,...,i-1\}, k \in M, l \in M}\\ &amp;{X_{i}^{k}}{\in \left\{ 0,1 \right\}\quad}{\forall \enskip i \in \{1,...,N\}, k \in M}\\ &amp;{X_{i,j}^{k,l}}{\in \left\{ 0,1 \right\}\quad}{\forall \enskip i \in \{2,...,N\}, j \in \{1,...,i-1\}, k \in M, l \in M} \end{aligned}} $$ \end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder></mml:mtd><mml:mtd><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>∗</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>subject to</mml:mtext></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2019_3324_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where <italic>N</italic> is the number of genes and <italic>M</italic> is the set of valid lags. We set <italic>M</italic>={−<italic>m</italic>,...,<italic>m</italic>}, where <italic>m</italic> is the maximum lag allowed. The <inline-formula id="IEq9"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq9.gif"/></alternatives></inline-formula> are binary variables that form a one hot encoding of the integer-valued lag variables <italic>X</italic><sub><italic>i</italic></sub> from “<xref rid="Sec10" ref-type="sec">Lag Penalized Weighted Correlation</xref>” section. <inline-formula id="IEq10"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} = 1$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq10.gif"/></alternatives></inline-formula> if <italic>X</italic><sub><italic>i</italic></sub>=<italic>k</italic>, and <inline-formula id="IEq11"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} = 0$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq11.gif"/></alternatives></inline-formula> if <italic>X</italic><sub><italic>i</italic></sub>≠<italic>k</italic>. The <inline-formula id="IEq12"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq12.gif"/></alternatives></inline-formula> are binary variables that are equal to 1 if and only if the lag of gene <italic>i</italic> is <italic>k</italic> and the lag of gene <italic>j</italic> is <italic>l</italic>. That is, <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l} = 1$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq13.gif"/></alternatives></inline-formula> if <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} = 1$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{j}^{l} = 1$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq15.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l} = 0$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq16.gif"/></alternatives></inline-formula> otherwise. The <inline-formula id="IEq17"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq17.gif"/></alternatives></inline-formula> variables are defined only for gene pairs <italic>i</italic> and <italic>j</italic> where <italic>i</italic>&gt;<italic>j</italic>. <inline-formula id="IEq18"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{k,l}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq18.gif"/></alternatives></inline-formula> is a precomputed similarity score for genes <italic>i</italic> and <italic>j</italic> with lags <italic>k</italic> and <italic>l</italic>, respectively. Here, <inline-formula id="IEq19"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{k,l} = corr_{LPWC}(i, j, k, l)$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">cor</mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">LPWC</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq19.gif"/></alternatives></inline-formula>, the LPWC similarity score.</p>
      <p>To outline the proof that the decision version of Lag Optimization is NP-complete, we show that a solution can be verified in polynomial time and that the NP-complete Weighted Maximum Cut problem [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] can be reduced to Lag Optimization in polynomial time. A solution to Lag Optimization consists of an assignment to all binary <inline-formula id="IEq20"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq21.gif"/></alternatives></inline-formula> variables. The decision version of this problem considers whether this solution satisfies the constraints above and whether the objective function is greater than or equal to some value <italic>c</italic>. Given an assignment to the <inline-formula id="IEq22"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq23.gif"/></alternatives></inline-formula> variables, we can ensure that only one <inline-formula id="IEq24"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} = 1$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq24.gif"/></alternatives></inline-formula> for each <italic>i</italic> in <italic>O</italic>(|<italic>M</italic>|∗<italic>N</italic>) time and that <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{k,l} = 1$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq25.gif"/></alternatives></inline-formula> if and only if the corresponding <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} = 1$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{j}^{l} = 1$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq27.gif"/></alternatives></inline-formula> in <italic>O</italic>(|<italic>M</italic>|<sup>2</sup>∗<italic>N</italic><sup>2</sup>) time. Finally, we can compute the objective function value and assess whether it is ≥<italic>c</italic> in <italic>O</italic>(|<italic>M</italic>|<sup>2</sup>∗<italic>N</italic><sup>2</sup>) time.</p>
      <p>Next, we show that Weighted Maximum Cut reduces to Lag Optimization in polynomial time. In Weighted Maximum Cut [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], we are given a weighted graph <italic>G</italic>=(<italic>V</italic>,<italic>E</italic>) with nonnegative weights <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> for all <italic>e</italic><sub><italic>i</italic>,<italic>j</italic></sub>∈<italic>E</italic>. The objective is to assign the vertices into sets <italic>V</italic><sub>1</sub> and <italic>V</italic><sub>2</sub>. Edges with one vertex in <italic>V</italic><sub>1</sub> and the other in <italic>V</italic><sub>2</sub> are cut edges. The decision version of Weighted Maximum Cut assesses whether the sum of the weights <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> for the cut edges is at least <italic>c</italic>.</p>
      <p>To reduce Weighted Maximum Cut to Lag Optimization, first define the set of possible lags <italic>M</italic>={1,2}. Then create variables <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{1}$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{2}$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq29.gif"/></alternatives></inline-formula> for each vertex <italic>v</italic><sub><italic>i</italic></sub>∈<italic>V</italic>. <inline-formula id="IEq30"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{1} = 1$\end{document}</tex-math><mml:math id="M80"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq30.gif"/></alternatives></inline-formula> corresponds to placing <italic>v</italic><sub><italic>i</italic></sub> in vertex set <italic>V</italic><sub>1</sub>, likewise for <inline-formula id="IEq31"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{2}$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq31.gif"/></alternatives></inline-formula> and <italic>V</italic><sub>2</sub>. Create <inline-formula id="IEq32"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{1,1}$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq32.gif"/></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{1,2}$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq33.gif"/></alternatives></inline-formula>, <inline-formula id="IEq34"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{2,1}$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq34.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq35"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i,j}^{2,2}$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq35.gif"/></alternatives></inline-formula> variables for all <italic>i</italic>&gt;<italic>j</italic>. Set <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{1,2}$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{2,1}$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq37.gif"/></alternatives></inline-formula> to the edge weight <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> for all <italic>i</italic>&gt;<italic>j</italic>. Set <inline-formula id="IEq38"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{1,1}$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq38.gif"/></alternatives></inline-formula> and <inline-formula id="IEq39"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{i,j}^{2,2}$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq39.gif"/></alternatives></inline-formula> to 0 for all <italic>i</italic>&gt;<italic>j</italic>. When <inline-formula id="IEq40"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} \neq X_{j}^{k}$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq40.gif"/></alternatives></inline-formula> in a Lag Optimization solution, the pair contributes a weight of <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> to the objective function. Otherwise, the pair contributes a weight of 0. Because <inline-formula id="IEq41"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{i}^{k} \neq X_{j}^{k}$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3324_Article_IEq41.gif"/></alternatives></inline-formula> if and only if the corresponding edge is cut, these pairs are the only pairs that contribute a weight of <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> to the Weighted Maximum Cut objective function. Thus, the objective function value of the constructed Lag Optimization instance equals that of the original Weighted Maximum Cut instance, and the Lag Optimization and Weighted Maximum Cut decisions are identical. In addition, the transformation from the Weighted Maximum Cut instance to the Lag Optimization instance requires <italic>O</italic>(|<italic>M</italic>|<sup>2</sup>∗<italic>N</italic><sup>2</sup>) time.</p>
    </sec>
    <sec id="Sec13">
      <title>Simulated time series</title>
      <p>To test LPWC, we simulated time series gene expression data using an impulse model called ImpulseDE [<xref ref-type="bibr" rid="CR21">21</xref>]. Impulses are one common type of temporal pattern in gene expression data [<xref ref-type="bibr" rid="CR1">1</xref>]. An impulse can be represented as a parameterized curve in which each gene has an initial expression level, increases or decreases in response to a stimulus, and then rises or falls to a new steady state level. The impulse model parameters control each expression level, the timing of the expression increases and decreases, and the curvature of the expression changes (Table <xref rid="Tab1" ref-type="table">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S15).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>ImpulseDE parameters for the four models in the low variance setting</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Parameters</th><th align="left">Model 1</th><th align="left">Model 2</th><th align="left">Model 3</th><th align="left">Model 4</th><th align="left">Parameter variation</th></tr></thead><tbody><tr><td align="left"><italic>β</italic><sub>1</sub></td><td align="left">0.8</td><td align="left">1.2</td><td align="left">1.5</td><td align="left">1.2</td><td align="left">Uniform(0, 0.5)</td></tr><tr><td align="left"><italic>h</italic><sub>0</sub></td><td align="left">7</td><td align="left">13</td><td align="left">17</td><td align="left">4</td><td align="left">Uniform(-3, 3)</td></tr><tr><td align="left"><italic>h</italic><sub>1</sub></td><td align="left">20</td><td align="left">6</td><td align="left">10</td><td align="left">12</td><td align="left">Uniform(-3, 3)</td></tr><tr><td align="left"><italic>h</italic><sub>2</sub></td><td align="left">14</td><td align="left">20</td><td align="left">4</td><td align="left">20</td><td align="left">Uniform(-3, 3)</td></tr><tr><td align="left"><italic>t</italic><sub>1</sub></td><td align="left">5</td><td align="left">8</td><td align="left">20</td><td align="left">6</td><td align="left">Uniform(0, 3)</td></tr><tr><td align="left"><italic>t</italic><sub>2</sub></td><td align="left">40</td><td align="left">23</td><td align="left">40</td><td align="left">44</td><td align="left">Uniform(0, 3)</td></tr></tbody></table><table-wrap-foot><p><italic>β</italic><sub>1</sub> controls the curvature in the model, <italic>h</italic><sub>0</sub>,<italic>h</italic><sub>1</sub>,<italic>h</italic><sub>2</sub> control the three different expression state levels, and <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> control the time of expression increase and decrease</p></table-wrap-foot></table-wrap></p>
      <p>We used the ImpulseDE parameters to define four canonical gene expression patterns (models) and simulated 50 genes from each pattern by adding random variation to the model parameters. We ran the simulation in a low variance (Table <xref rid="Tab1" ref-type="table">1</xref>) and high variance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S15) setting to assess how the clustering methods perform as the simulated genes deviate more from the canonical patterns. In the low variance setting, the simulated genes resemble the reference patterns more closely so the clustering problem is easier (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). However, in the high variance scenario, the simulated genes are more distorted (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), making it harder to recover the correct cluster assignments.</p>
      <p>To simulate a gene from a canonical pattern, we randomly sampled an additive offset for each of the six ImpulseDE model parameters using the parameter-specific Uniform distributions in Table <xref rid="Tab1" ref-type="table">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S15. These randomly adjust the expression levels, timing, and curvature. Then, we sampled an additional expression level offset from Uniform(0, 20) and added this to the previously sampled values of <italic>h</italic><sub>0</sub>, <italic>h</italic><sub>1</sub>, and <italic>h</italic><sub>2</sub>. This randomly shifts the entire simulated time course along the y-axis. Given the sampled parameters, we generated expression levels using the impulse model at 10 timepoints: 0, 2, 4, 6, 8, 18, 24, 32, 48, and 72 min. Finally, we added Gaussian-distributed noise to the simulated expression level at each timepoint, sampling from N(0, 0.5) in the low variance setting and N(0, 1) in the high variance setting. We repeated the overall simulation procedure 100 times for both the low and high variance settings to assess the clustering performance over many simulated datasets.</p>
      <p>In addition, we used ImpulseDE to study clustering with regular or irregular timepoints and two simple canonical patterns: an early spike and a late spike. The early spike and late spike patterns each had 50 genes, which we divided so that 25 genes spiked slightly later than the other 25 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S16). We selected timepoints to include one timepoint in the middle of the spike and the rest before or after the spike. The regular time series sampled 13 timepoints from 0 to 72 min every 6 min (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). The irregular time series sampled 9 timepoints at 0, 3, 7, 12, 22, 34, 46, 59, and 75 min (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5).</p>
      <p>We simulated genes from these two canonical patterns using the ImpulseDE parameters in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S16 as described above. We included an additional offset from Uniform(0, 10) to the previously sampled values of <italic>h</italic><sub>0</sub>, <italic>h</italic><sub>1</sub>, and <italic>h</italic><sub>2</sub> and added Gaussian noise sampled from N(0, 0.5). However, unlike the previous simulations, we added the same offset sampled from Uniform(0, 1) to <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> instead of having two independent offsets. This ensures that the duration of the spike is the same for all simulated genes. We again ran the simulation and clustering process 100 times for both the regular and irregular timepoints.</p>
    </sec>
    <sec id="Sec14">
      <title>Cluster evaluation</title>
      <p>Cluster evaluation is difficult because the true clusters are not known for real data. The Rand index compares two clustering results [<xref ref-type="bibr" rid="CR40">40</xref>]. However, to control for randomness and compare clustering scores from clusters of different sizes, the ARI is a more suitable metric [<xref ref-type="bibr" rid="CR40">40</xref>]. The ARI is 1 for a perfect clustering that matches the true cluster labels. On the other hand, a score close to 0 indicates a poor clustering. We use the ARI to evaluate clusters of the simulated data where the true cluster labels are known.</p>
      <p>One way to evaluate time series clustering algorithms without ground truth labels is by assessing how important the temporal information is to the clustering results. We obtain clusters using the original data and then permute the data by randomly reordering the timepoints (the gene expression observations do not change). The permutations destroy the true temporal dependencies in the data. If a clustering algorithm does not use the temporal information, the ARI score when comparing its clusters on the original and permuted data will be close to 1, which is undesirable. In the yeast and axolotl case studies, we repeat the timepoint permutation 100 times for each clustering algorithm and assess the distribution of ARI scores.</p>
      <p>Another challenge is choosing the number of clusters, which can be addressed with the silhouette method [<xref ref-type="bibr" rid="CR41">41</xref>]. This method assesses whether the clusters are cohesive and distinct from one another. We select the number of clusters that maximizes the average silhouette width.</p>
    </sec>
    <sec id="Sec15">
      <title>Case studies</title>
      <p>We applied LPWC in two case studies to demonstrate how it can be used to obtain coherent temporal clusters and derive biological insights into dynamic transcriptional and signaling processes. The first captures the rapid phosphorylation response to osmotic stress in yeast [<xref ref-type="bibr" rid="CR32">32</xref>]. Kanshin et al. obtained mass spectrometry-based phosphorylation samples in NaCl-induced osmotic stress and control conditions, uniformly sampling 0 to 60 seconds post-stimulation every 5 seconds for a total of 13 timepoints. They transformed these into log2 stress versus control fold changes at each timepoint. We clustered the 344 singly phosphorylated phosphopeptides that were reported to have significant dynamic changes and were not missing values at any timepoints.</p>
      <p>The second dataset contains time course RNA-seq data from the axolotl blastema after amputating the right forelimb [<xref ref-type="bibr" rid="CR33">33</xref>]. Stewart et al. studied the transcriptional changes that take place during the transitions from wound healing to dedifferentiation to limb regeneration. They sampled gene expression at 12 timepoints: 0, 3, 6, and 12 hr and 1, 3, 5, 7, 10, 14, 21, and 28 days post-amputation. Unlike the osmotic stress application, there is drastic irregularity between consecutive sampling times. We converted all times to days. Because the axolotl genome had not been sequenced at the time, Stewart et al. mapped axolotl contigs to human transcripts. They processed the data using edgeR [<xref ref-type="bibr" rid="CR42">42</xref>], comparing each timepoint to the 0 day measurement to obtain the up- and down-regulated genes. A total of 1656 genes were up- or down-regulated at least at one timepoint compared to 0 day. We ran LPWC on their mapped human gene expression data.</p>
    </sec>
    <sec id="Sec16">
      <title>Gene enrichment analysis</title>
      <p>We performed gene enrichment analysis of the LPWC cluster members in DAVID 6.8 [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3.2). For the yeast and axolotl case studies, we report GOTERM_BP_FAT [<xref ref-type="bibr" rid="CR45">45</xref>] and KEGG_PATHWAY [<xref ref-type="bibr" rid="CR46">46</xref>] terms that are enriched using DAVID parameters Counts = 2 and Ease = 0.05. The terms were further filtered for false discovery rate ≤5%.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> Lag Penalized Weighted Correlation</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://gitter-lab.github.io/LPWC/">https://gitter-lab.github.io/LPWC/</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> R (≥ version 3.0.2)</p>
    <p><bold>Other requirements:</bold> None</p>
    <p><bold>License:</bold> MIT</p>
    <p><bold>Any restrictions to use by non-academics:</bold> None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2019_3324_MOESM1_ESM.pdf">
          <caption>
            <p><bold>Additional file 1</bold> Supplementary figures, tables, and methods.</p>
          </caption>
        </media>
      </supplementary-material>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3324_MOESM2_ESM.zip">
            <caption>
              <p><bold>Additional file 2</bold> Cluster assignments and DAVID enrichment for yeast lLPWC as tab-delimited text files. The cluster assignment files contain a header row. The id is the phosphopeptide id from Kanshin et al. [<xref ref-type="bibr" rid="CR32">32</xref>] and Uniprot is the accession number.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_3324_MOESM3_ESM.zip">
            <caption>
              <p><bold>Additional file 3</bold> Cluster assignments and DAVID enrichment for yeast hLPWC as tab-delimited text files. The cluster assignment files contain a header row. The id is the phosphopeptide id from Kanshin et al. [<xref ref-type="bibr" rid="CR32">32</xref>] and Uniprot is the accession number. There are no enriched terms for cluster 3.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_3324_MOESM4_ESM.zip">
            <caption>
              <p><bold>Additional file 4</bold> Cluster assignments and DAVID enrichment for axolotl hLPWC as tab-delimited text files. The cluster assignment files contain the mapped human official gene symbols and do not have a header row.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_3324_MOESM5_ESM.zip">
            <caption>
              <p><bold>Additional file 5</bold> Cluster assignments and DAVID enrichment for axolotl lLPWC as tab-delimited text files. The cluster assignment files contain the mapped human official gene symbols and do not have a header row.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ARI</term>
        <def>
          <p>Adjusted rand index</p>
        </def>
      </def-item>
      <def-item>
        <term>DTW</term>
        <def>
          <p>Dynamic time warping</p>
        </def>
      </def-item>
      <def-item>
        <term>GO</term>
        <def>
          <p>Gene ontology</p>
        </def>
      </def-item>
      <def-item>
        <term>KEGG</term>
        <def>
          <p>Kyoto encyclopedia of genes and genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>LPWC</term>
        <def>
          <p>Lag penalized weighted correlation</p>
        </def>
      </def-item>
      <def-item>
        <term>STEM</term>
        <def>
          <p>Short time-series expression miner</p>
        </def>
      </def-item>
      <def-item>
        <term>STS</term>
        <def>
          <p>Short time series</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3324-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to Ron Stewart, James Dowell, Karl Broman, Wenzhi Cao, Jen Birstler, John Steill, Ivan Leung, and all members of the Gitter lab for their helpful feedback and discussions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TC and AG developed the methods, performed the analyses, tested the software, and wrote the manuscript. TC implemented the LPWC R package. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was supported by NSF CAREER award DBI 1553206, the NIH University of Wisconsin Carbone Cancer Center Support Grant P30 CA014520, and the UW-Madison Center for High Throughput Computing in the Department of Computer Sciences. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gitter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Studying and modelling dynamic biological processes using time-series gene expression data</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>552</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 22805708?>
        <pub-id pub-id-type="pmid">22805708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spies</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ciaudo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dynamics in Transcriptomics: Advancements in RNA-seq Time Course and Downstream Analysis</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>469</fpage>
        <lpage>77</lpage>
        <?supplied-pmid 26430493?>
        <pub-id pub-id-type="pmid">26430493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <mixed-citation publication-type="other">Liang Y, Kelemen A. Dynamic modeling and network approaches for omics time course data: overview of computational approaches and applications. Brief Bioinform. 2017. 10.1093/bib/bbx036.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbons</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
        </person-group>
        <article-title>Judging the quality of gene expression-based clustering methods using gene annotation</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>10</issue>
        <fpage>1574</fpage>
        <lpage>81</lpage>
        <?supplied-pmid 12368250?>
        <pub-id pub-id-type="pmid">12368250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaskowiak</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Campello</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>IG</given-names>
          </name>
        </person-group>
        <article-title>On the selection of appropriate distances for gene expression data clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>Suppl 2</issue>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">24386976</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleyman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sefer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nicola</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chhabra</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hagood</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Kaminski</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ambalavanan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Selecting the most appropriate time points to profile in high-throughput studies</article-title>
        <source>eLife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>18541</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDowell</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Manandhar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vockley</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Clustering gene expression time series data using an infinite Gaussian process mixture model</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>1005896</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giorgino</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Computing and visualizing dynamic time warping alignments in R: the dtw package</article-title>
        <source>J Stat Softw</source>
        <year>2009</year>
        <volume>31</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>24</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Aligning gene expression time series with time warping algorithms</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>495</fpage>
        <lpage>508</lpage>
        <?supplied-pmid 11395426?>
        <pub-id pub-id-type="pmid">11395426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Specht</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>LEAP: constructing gene co-expression networks for single-cell rna-sequencing data using pseudotime ordering</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>764</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 27993778?>
        <pub-id pub-id-type="pmid">27993778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alonso</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Peña</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Clustering time series by linear dependency</article-title>
        <source>Stat Comput</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>4</issue>
        <fpage>655</fpage>
        <lpage>76</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Möller-Levet CS, Klawonn F, Cho K-H, Wolkenhauer O. Fuzzy Clustering of Short Time-Series and Unevenly Distributed Sampling Points. In: Advances in Intelligent Data Analysis V, Lecture Notes in Computer Science. Springer: 2003. p. 330–40. 10.1007/978-3-540-45231-7_31.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Trendy: segmented regression analysis of expression dynamics in high-throughput ordered profiling experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>380</fpage>
        <?supplied-pmid 30326833?>
        <pub-id pub-id-type="pmid">30326833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montero</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vilar</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TSclust: An R package for time series clustering</article-title>
        <source>J Stat Softw</source>
        <year>2014</year>
        <volume>62</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>43</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vilar</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Alonso</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Vilar</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Non-linear time series clustering based on non-parametric forecast densities</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2010</year>
        <volume>54</volume>
        <issue>11</issue>
        <fpage>2850</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ferrazzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sacchi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bellazzi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>TimeClust: a clustering tool for gene expression time series</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>430</fpage>
        <lpage>2</lpage>
        <?supplied-pmid 18065427?>
        <pub-id pub-id-type="pmid">18065427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrazzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Magni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bellazzi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Random walk models for Bayesian clustering of gene expression profiles</article-title>
        <source>Appl Bioinforma</source>
        <year>2005</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>263</fpage>
        <lpage>76</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sacchi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bellazzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Larizza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Magni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Curk</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Petrovic</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zupan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>TA-clustering: Cluster analysis of gene expression profiles through temporal abstractions</article-title>
        <source>Int J Med Inform</source>
        <year>2005</year>
        <volume>74</volume>
        <issue>7-8</issue>
        <fpage>505</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 15941669?>
        <pub-id pub-id-type="pmid">15941669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>STEM: a tool for the analysis of short time series gene expression data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>191</fpage>
        <?supplied-pmid 16597342?>
        <pub-id pub-id-type="pmid">16597342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sivriver</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Habib</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>An integrative clustering and modeling algorithm for dynamical gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>392</fpage>
        <lpage>400</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schultze</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>ImpulseDE: detection of differentially expressed genes in time series data using impulse models</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>757</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Straube</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Lê Cao</surname>
            <given-names>K-A</given-names>
          </name>
        </person-group>
        <article-title>DynOmics to identify delays and co-expression patterns across time course experiments</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>40131</fpage>
        <?supplied-pmid 28065937?>
        <pub-id pub-id-type="pmid">28065937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costa</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schliep</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The Graphical Query Language: a tool for analysis of gene expression time-courses</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>2544</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Continuous representations of time-series gene expression data</article-title>
        <source>J Comput Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>3-4</issue>
        <fpage>341</fpage>
        <lpage>56</lpage>
        <?supplied-pmid 12935332?>
        <pub-id pub-id-type="pmid">12935332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nainwal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanon-Reyes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>GEsture: an online hand-drawing tool for gene expression pattern search</article-title>
        <source>PeerJ</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>4927</fpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Kordestani M, Alkhateeb A, Rezaeian I, Rueda L, Saif M. A new clustering method using wavelet based probability density functions for identifying patterns in time-series data. In: 2016 IEEE EMBS International Student Conference (ISC): 2016. p. 1–4. 10.1109/EMBSISC.2016.7508616.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramoni</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Sebastiani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis of gene expression dynamics</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>14</issue>
        <fpage>9121</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 12082179?>
        <pub-id pub-id-type="pmid">12082179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cooke</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Darkins</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wild</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Bayesian hierarchical clustering for microarray time series data with replicates and outlier measurements</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>399</fpage>
        <?supplied-pmid 21995452?>
        <pub-id pub-id-type="pmid">21995452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sivaganesan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Bayesian infinite mixture model based clustering of gene expression profiles</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>9</issue>
        <fpage>1194</fpage>
        <lpage>206</lpage>
        <?supplied-pmid 12217911?>
        <pub-id pub-id-type="pmid">12217911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hennig</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meila</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Murtagh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rocci</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Handbook of Cluster Analysis</source>
        <year>2015</year>
        <publisher-loc>Florida</publisher-loc>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">Dahl DB. In: Do K-A, Vannucci M, Müller P, (eds).Model-Based Clustering for Expression Data via a Dirichlet Process Mixture Model. Bayesian Inference for Gene Expression and Proteomics: Cambridge University Press; 2006, pp. 201–18. <pub-id pub-id-type="doi">10.1017/CBO9780511584589.011</pub-id>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanshin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bergeron-Sandoval</surname>
            <given-names>L-P</given-names>
          </name>
          <name>
            <surname>Isik</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Thibault</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Michnick</surname>
            <given-names>SW</given-names>
          </name>
        </person-group>
        <article-title>A Cell-Signaling Network Temporally Resolves Specific versus Promiscuous Phosphorylation</article-title>
        <source>Cell Rep</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>1202</fpage>
        <lpage>14</lpage>
        <?supplied-pmid 25704821?>
        <pub-id pub-id-type="pmid">25704821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rascón</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Ardalani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Probasco</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Bolin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Volkmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Habermann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>Comparative RNA-seq Analysis in the Unsequenced Axolotl: The Oncogene Burst Highlights Early Gene Expression in the Blastema</article-title>
        <source>PLOS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>1002936</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butty</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tripathi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Lahesmaa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Methods for time series analysis of RNA-seq data with application to human Th17 cell differentiation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>12</issue>
        <fpage>113</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>D’haeseleer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Somogyi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Linear modeling of mRNA expression levels during CNS development and injury</article-title>
        <source>Biocomputing’99</source>
        <year>1999</year>
        <publisher-loc>New Jersey</publisher-loc>
        <publisher-name>World Scientific</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>A new approach to analyzing gene expression time series data</article-title>
        <source>Proceedings of the Sixth Annual International Conference on Computational Biology</source>
        <year>2002</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>ACM</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hensman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical Bayesian modelling of gene expression time series across irregularly sampled replicates and clusters</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">23323762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Crescenzi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Silvestri</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Trevisan</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>To weight or not to weight: where is the question?</article-title>
        <source>Proceedings of the 4th IEEE Israel Symposium on Theory of Computing And Systems, volume 96</source>
        <year>1996</year>
        <publisher-loc>California</publisher-loc>
        <publisher-name>IEEE Computer Society</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Kann V. Maximum Cut. 2000. <ext-link ext-link-type="uri" xlink:href="http://www.nada.kth.se/~viggo/wwwcompendium/node85.html">http://www.nada.kth.se/~viggo/wwwcompendium/node85.html</ext-link>. Accessed 26 Mar 2018.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rand</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Objective Criteria for the Evaluation of Clustering Methods</article-title>
        <source>J Am Stat Assoc</source>
        <year>1971</year>
        <volume>66</volume>
        <issue>336</issue>
        <fpage>846</fpage>
        <lpage>50</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <issue>Supplement C</issue>
        <fpage>53</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>321</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lempicki</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">19033363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lempicki</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>
        <source>Nat Protoc</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>44</fpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Issel-Tarver</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kasarskis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matese</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ringwald</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Gene Ontology: tool for the unification of biology</article-title>
        <source>Nat Genet</source>
        <year>2000</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 3037419?>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Kegg: Kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <?supplied-pmid 102409?>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <mixed-citation publication-type="other">Project Jupyter, Bussonnier M, Forde J, Freeman J, Granger B, Head T, Holdgraf C, Kelley K, Nalvarte G, Osheroff A, Pacer M, Panda Y, Perez F, Ragan-Kelley B, Willing C. Binder 2.0 - Reproducible, interactive, sharable environments for science at scale; 2018. pp. 113–20. 10.25080/Majora-4af1f417-011.</mixed-citation>
    </ref>
  </ref-list>
</back>
