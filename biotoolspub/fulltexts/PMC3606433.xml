<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3606433</article-id>
    <article-id pub-id-type="pmid">23533605</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-37119</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0059190</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Algorithms</subject>
        </subj-group>
        <subj-group>
          <subject>Computer Applications</subject>
        </subj-group>
        <subj-group>
          <subject>Computer Modeling</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Engineering</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Compression of FASTQ and SAM Format Sequencing Data</article-title>
      <alt-title alt-title-type="running-head">Compression of FASTQ and SAM Files</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bonfield</surname>
          <given-names>James K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mahoney</surname>
          <given-names>Matthew V.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Wellcome Trust Sanger Institute, Cambridge, United Kingdom</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Dell Inc., Round Rock, Texas, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gormley</surname>
          <given-names>Michael</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Thomas Jefferson University, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>jkb@sanger.ac.uk</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The statement of the work being supported by Wellcome Trust and Dell Inc. is there solely as they covered the salaries of the authors during the time of the program development. Neither the Wellcome Trust nor Dell Inc. hold any patents on this work, nor do they intend to. Please also note that the programs are available under a BSD-2 open source licence, meaning they are free with no restrictions. MM is employed by Dell Inc. There are no patents, products in development or marketed products to declare. This does not alter the authors’ adherence to all the PLOS ONE policies on sharing data and materials, as detailed online in the guide for authors.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: JKB MM. Performed the experiments: JKB MM. Analyzed the data: JKB. Contributed reagents/materials/analysis tools: JKB MM. Wrote the paper: JKB MM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>3</issue>
    <elocation-id>e59190</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>11</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>2</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Bonfield, Mahoney</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Bonfield, Mahoney</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Storage and transmission of the data produced by modern DNA sequencing instruments has become a major concern, which prompted the Pistoia Alliance to pose the SequenceSqueeze contest for compression of FASTQ files. We present several compression entries from the competition, Fastqz and Samcomp/Fqzcomp, including the winning entry. These are compared against existing algorithms for both reference based compression (CRAM, Goby) and non-reference based compression (DSRC, BAM) and other recently published competition entries (Quip, SCALCE). The tools are shown to be the new Pareto frontier for FASTQ compression, offering state of the art ratios at affordable CPU costs. All programs are freely available on SourceForge. Fastqz: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/fastqz/">https://sourceforge.net/projects/fastqz/</ext-link>, fqzcomp: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/fqzcomp/">https://sourceforge.net/projects/fqzcomp/</ext-link>, and samcomp: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/samcomp/">https://sourceforge.net/projects/samcomp/</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the Wellcome Trust [098051] and Dell Inc. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Data volumes from next-generation sequencing instruments are a major issue for storage and data transfer costs. Between 2008 and 2012 sequencing costs dropped 1000 fold (K. A. Wetterstrand, <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/sequencingcosts/">http://www.genome.gov/sequencingcosts/</ext-link> accessed on June 26, 2012) giving an approximate cost halving every 5 months. A long term trend for storage shows a cost halving every 14 months (M. Komorowski, <ext-link ext-link-type="uri" xlink:href="http://www.mkomo.com/cost-per-gigabyte">http://www.mkomo.com/cost-per-gigabyte</ext-link> accessed on August 20, 2012). It is tempting to believe that data compression will resolve these problems, but with exponential growth rates it can do no more than delay the inevitable time when organizations will need to consider whether they truly need to retain everything. However, a good case can be made <xref rid="pone.0059190-Cochrane1" ref-type="bibr">[1]</xref> that some samples will always be worth storing in their raw DNA sequence form. Improving sequence compression is an essential part in reducing the dependency on storage and network bandwidth.</p>
    <p>In October 2011 the Pistoia Alliance formally announced a competition to compress next-generation sequencing data. Entries to the competition were run on a virtual machine in the Amazon Cloud (<ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/">http://aws.amazon.com/</ext-link>) against a private test set, with results publicly displayed on a leader-board (at <ext-link ext-link-type="uri" xlink:href="http://www.sequencesqueeze.org">http://www.sequencesqueeze.org</ext-link>) throughout the competition. The data to be compressed was in FASTQ format <xref rid="pone.0059190-Cock1" ref-type="bibr">[2]</xref>, an industry standard format supported by a wide variety of next generation sequencing manufacturers including the data tested here, produced by Roche 454 <xref rid="pone.0059190-Margulies1" ref-type="bibr">[3]</xref>, Life Technologies SOLiD <xref rid="pone.0059190-Pandey1" ref-type="bibr">[4]</xref> and Illumina GA/HiSeq <xref rid="pone.0059190-Bentley1" ref-type="bibr">[5]</xref>.</p>
    <p>There has been considerable work on compression of sequencing data, with some researchers specializing only on sequence compression <xref rid="pone.0059190-Cox1" ref-type="bibr">[6]</xref>, <xref rid="pone.0059190-Pinho1" ref-type="bibr">[7]</xref> or quality value compression <xref rid="pone.0059190-Asnani1" ref-type="bibr">[8]</xref>, <xref rid="pone.0059190-Wan1" ref-type="bibr">[9]</xref> with others supporting full FASTQ file compression; G-SQZ <xref rid="pone.0059190-Tembe1" ref-type="bibr">[10]</xref>, SlimGene <xref rid="pone.0059190-Kozanitis1" ref-type="bibr">[11]</xref>, SOLiDzipper <xref rid="pone.0059190-Jeon1" ref-type="bibr">[12]</xref>, DSRC <xref rid="pone.0059190-Deorowicz1" ref-type="bibr">[13]</xref>, Quip <xref rid="pone.0059190-Jones1" ref-type="bibr">[14]</xref>, SCALCE <xref rid="pone.0059190-Hach1" ref-type="bibr">[15]</xref> and KungFQ <xref rid="pone.0059190-Grassi1" ref-type="bibr">[16]</xref>. Related to this is work on SAM/BAM <xref rid="pone.0059190-Li1" ref-type="bibr">[17]</xref> compression including Goby (F. Campagne, <ext-link ext-link-type="uri" xlink:href="http://campagnelab.org/software/goby/">http://campagnelab.org/software/goby/</ext-link> accessed on July 19, 2012), CRAM <xref rid="pone.0059190-Fritz1" ref-type="bibr">[18]</xref>, SAMZIP <xref rid="pone.0059190-Sakib1" ref-type="bibr">[19]</xref> and NGC <xref rid="pone.0059190-Popitsch1" ref-type="bibr">[20]</xref>. Overviews of compression within bioinformatics can be found in <xref rid="pone.0059190-Giancarlo1" ref-type="bibr">[21]</xref> and <xref rid="pone.0059190-Daily1" ref-type="bibr">[22]</xref>.</p>
    <p>We compare our work only against other full FASTQ and SAM file compressors and against more general purpose compression algorithms like gzip <xref rid="pone.0059190-Deutsch1" ref-type="bibr">[23]</xref> and bzip2 (J. Seward, <ext-link ext-link-type="uri" xlink:href="http://www.bzip.org">http://www.bzip.org</ext-link> accessed on August 16, 2012). Both authors submitted multiple entries to the SequenceSqueeze competition. J. Bonfield submitted the Fqzcomp and Samcomp variants while M. Mahoney submitted Fastqz variants. Fqzcomp and Fastqz both accept FASTQ files as input, with the latter also taking an optional genome sequence to perform reference based compression. Samcomp also performs reference based compression but requires previously aligned data in the SAM format instead.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Overview</title>
      <p>A brief summary of all successful entries to the SequenceSqueeze competition can be seen in <xref ref-type="fig" rid="pone-0059190-g001">figure 1</xref>. We observe a wall where entries were unable to improve on compression ratio without an exponential increase in both CPU time and memory. We believe this wall represents close proximity to the Kolmogorov complexity <xref rid="pone.0059190-Kolmogorov1" ref-type="bibr">[24]</xref>, beyond which further compression is only achievable via lossy methods or use of additional knowledge such as the target genome. More information on the contest results is available in the supplementary material.</p>
      <fig id="pone-0059190-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>SequenceSqueeze results: real time vs compression ratio.</title>
          <p>Each mark represents a different entry, coloured by author. Ibrahim Numanagic’s entry had a minor decoding problem causing a minority of read-names to mismatch. All other entries plotted here were lossless. The entries have been broken down into reference based (A) and non-reference based (B) solutions. A clear wall can be seen in the non-reference methods requiring exponential growth in CPU time for minor linear improvements in compression ratio.</p>
        </caption>
        <graphic xlink:href="pone.0059190.g001"/>
      </fig>
      <p>We further compare and analyze the programs presented here – Fastqz, Fqzcomp and Samcomp – to the other top entrants of the SequenceSqueeze contest (Daniel Jones’ Quip and the IEETA’s SeqSqueeze1 programs), the previously published DSRC tool and the general purpose gzip and bzip2 compression programs.</p>
      <p>With most entrants to the competition submitting multiple entries, and seeing the results live, there may have been accidental over-fitting of the (unseen) test set. Hence we tested the programs against a number of other public data sets. We chose a representative subset of the same data used in the DSRC paper along with SRR065390_1.</p>
      <p>The data sets used for testing are presented in <xref ref-type="table" rid="pone-0059190-t001">Table 1</xref>. Not all programs tested supported all types of data. SRR003177 consisted of variable length 454 data with some (erroneously) up to 4 Kb long. Fastqz cannot deal with variable length data while SeqSqueeze1 has a sequence length limit of 1 Kb which we increased to allow this data to compress. SRR007215_1 contains SOLiD colour-space data. This is not supported by Quip or Fastqz, while Fqzcomp needed fixes to support a fastq format variant used in this data set. SRR027520_1 is a low coverage 1000 Genomes project Illumina run <xref rid="pone.0059190-The1" ref-type="bibr">[25]</xref>. SRR065390_1 is a 33 fold coverage Caenorhabditis Elegans genome, chosen to demonstrate compression ratios on smaller and deeper genomes. All programs supported the Illumina data sets.</p>
      <table-wrap id="pone-0059190-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Data sets used for program evaluation.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0059190-t001-1" xlink:href="pone.0059190.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Run ID</td>
                <td align="left" rowspan="1" colspan="1">Platform</td>
                <td align="left" rowspan="1" colspan="1">Species</td>
                <td align="left" rowspan="1" colspan="1">No. Seqs</td>
                <td align="left" rowspan="1" colspan="1">Length</td>
                <td align="left" rowspan="1" colspan="1">File size</td>
                <td align="left" rowspan="1" colspan="1">Depth</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRR003177</td>
                <td align="left" rowspan="1" colspan="1">454 GS FLX Titanium</td>
                <td align="left" rowspan="1" colspan="1">Human</td>
                <td align="left" rowspan="1" colspan="1">1,504,571</td>
                <td align="left" rowspan="1" colspan="1">564</td>
                <td align="left" rowspan="1" colspan="1">1,754,042,560</td>
                <td align="left" rowspan="1" colspan="1">0.28x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRR007215_1</td>
                <td align="left" rowspan="1" colspan="1">ABI SOLiD System 2.0</td>
                <td align="left" rowspan="1" colspan="1">Human</td>
                <td align="left" rowspan="1" colspan="1">4,711,141</td>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">689,319,444</td>
                <td align="left" rowspan="1" colspan="1">0.04x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRR027520_1</td>
                <td align="left" rowspan="1" colspan="1">Illumina GA II</td>
                <td align="left" rowspan="1" colspan="1">Human</td>
                <td align="left" rowspan="1" colspan="1">24,246,685</td>
                <td align="left" rowspan="1" colspan="1">76</td>
                <td align="left" rowspan="1" colspan="1">5,055,253,238</td>
                <td align="left" rowspan="1" colspan="1">0.61x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRR065390_1</td>
                <td align="left" rowspan="1" colspan="1">Illumina GA II</td>
                <td align="left" rowspan="1" colspan="1">C.Elegans</td>
                <td align="left" rowspan="1" colspan="1">33,808,546</td>
                <td align="left" rowspan="1" colspan="1">100</td>
                <td align="left" rowspan="1" colspan="1">8,819,496,191</td>
                <td align="left" rowspan="1" colspan="1">33.8x</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>The data sets used to test the compression tools along with the sequencing platforms that produced them. <italic>Length</italic> is the average sequence length. <italic>Depth</italic> is the average genome depth assuming 100% of sequences in the data set can be aligned.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><xref ref-type="table" rid="pone-0059190-t002">Table 2</xref> shows the program names, versions and command line arguments used for testing. These were the latest versions at the time of manuscript preparation.</p>
      <table-wrap id="pone-0059190-t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Program names, versions and options.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0059190-t002-2" xlink:href="pone.0059190.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Name</td>
                <td align="left" rowspan="1" colspan="1">Version</td>
                <td align="left" rowspan="1" colspan="1">Compression mode</td>
                <td align="left" rowspan="1" colspan="1">Options</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCALCE</td>
                <td align="left" rowspan="1" colspan="1">2.3</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">-B 1G -T 2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">-c bz -T 2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">dsrc</td>
                <td align="left" rowspan="1" colspan="1">1.01</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">-l -lm2048</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SeqSqueeze1</td>
                <td align="left" rowspan="1" colspan="1">1.0(svn)</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">-h 4 1/5 -hs 5 -b 1∶3 -b 1∶7 -b 1∶11 -b 1∶15 1/20 -bg 0.9 -N -s 1∶1 -s 1∶2 1/5 -s 1∶3 1/10 -s 1∶4 1/20 -ss 10 -sg 0.95</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fastqz</td>
                <td align="left" rowspan="1" colspan="1">1.5</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">e</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">c</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fqzcomp</td>
                <td align="left" rowspan="1" colspan="1">4.4</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">-n1 -q1 -s1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">medium</td>
                <td align="left" rowspan="1" colspan="1">-n2 -q2 -s6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">-n2 -q3 -s8+ -b</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">quip</td>
                <td align="left" rowspan="1" colspan="1">1.1.1</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">-a</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sam_comp1</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sam_comp2</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">cramtools</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">–preserve-read-names -L m999</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">goby</td>
                <td align="left" rowspan="1" colspan="1">2.01</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">-x MessageChunkWriter:codec = hybrid-1–preserve-soft-clips –preserve-read-names –preserve-all-mapped-qualities</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">samtools</td>
                <td align="left" rowspan="1" colspan="1">0.1.18</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">gzip</td>
                <td align="left" rowspan="1" colspan="1">1.3.12</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">bzip2</td>
                <td align="left" rowspan="1" colspan="1">1.05</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>Program version names, numbers and common command line options. Additional options were sometimes required to specify the name of the reference used, but this differed per data set.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s2b">
      <title>Non-reference Based</title>
      <p><xref ref-type="fig" rid="pone-0059190-g002">Figure 2</xref> shows the non-reference based compression of the four data sets. Some programs are presented more than once showing the effect of adjusting the command line options. All tests were performed on a machine with Intel Dual-Core E5300 CPU (2.6 GHz) with 6 GB of memory, running the Ubuntu 10.04 Linux operating system.</p>
      <fig id="pone-0059190-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>File size ratios vs real time to compress.</title>
          <p>SRR007215 is SOLiD data, SRR003177 is 454 data, while SRR02750 and SRR065390 are Illumina data at shallow and deep depths respectively. Not all programs support all types of data.</p>
        </caption>
        <graphic xlink:href="pone.0059190.g002"/>
      </fig>
      <p><xref ref-type="table" rid="pone-0059190-t003">Table 3</xref> shows the same data in more detail including memory consumption and decompression times. We see a clear trade-off between time, memory and compression ratio. The fastest and lowest memory programs tend to produce larger files. Largest of all is Fastqz in fast mode. This only performs the preprocessing steps to quickly pack multiple bases and confidence values together without any subsequent encoding and compression. In isolation it is not particularly small. It may be improved by applying a fast general purpose compression program to the output files, but this option was not explored. Next largest are the general purpose gzip and bzip2 programs. With the exception of the very quick decompression in gzip these tools look like a poor trade-off between size and speed with several tools outperforming them in all metrics, demonstrating that file format specific knowledge is important for efficient compression.</p>
      <table-wrap id="pone-0059190-t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Compression rates and ratios.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0059190-t003-3" xlink:href="pone.0059190.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="4" align="left" rowspan="1">SRR003177 (LS454)</td>
                <td colspan="4" align="left" rowspan="1">SRR007215_1 (SOLiD)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Program</td>
                <td align="left" rowspan="1" colspan="1">Mode</td>
                <td align="left" rowspan="1" colspan="1">Ratio</td>
                <td align="left" rowspan="1" colspan="1">C.R.</td>
                <td align="left" rowspan="1" colspan="1">D.R.</td>
                <td align="left" rowspan="1" colspan="1">Mem</td>
                <td align="left" rowspan="1" colspan="1">Ratio</td>
                <td align="left" rowspan="1" colspan="1">C.R.</td>
                <td align="left" rowspan="1" colspan="1">D.R.</td>
                <td align="left" rowspan="1" colspan="1">Mem</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">gzip</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.3295</td>
                <td align="left" rowspan="1" colspan="1">8.2</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>91.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.2524</td>
                <td align="left" rowspan="1" colspan="1">16.6</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>111.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">bzip2</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.2681</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">12.0</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">0.1987</td>
                <td align="left" rowspan="1" colspan="1">4.9</td>
                <td align="left" rowspan="1" colspan="1">23.1</td>
                <td align="left" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCALCE</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">(a)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">(a)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DSRC</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2422</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>33.7</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">51.1</td>
                <td align="left" rowspan="1" colspan="1">61</td>
                <td align="left" rowspan="1" colspan="1">0.1605</td>
                <td align="left" rowspan="1" colspan="1">19.1</td>
                <td align="left" rowspan="1" colspan="1">55.3</td>
                <td align="left" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2372</td>
                <td align="left" rowspan="1" colspan="1">18.2</td>
                <td align="left" rowspan="1" colspan="1">47.1</td>
                <td align="left" rowspan="1" colspan="1">1979</td>
                <td align="left" rowspan="1" colspan="1">0.1605</td>
                <td align="left" rowspan="1" colspan="1">19.5</td>
                <td align="left" rowspan="1" colspan="1">51.7</td>
                <td align="left" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">quip</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2275</td>
                <td align="left" rowspan="1" colspan="1">16.9</td>
                <td align="left" rowspan="1" colspan="1">15.0</td>
                <td align="left" rowspan="1" colspan="1">398</td>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2275</td>
                <td align="left" rowspan="1" colspan="1">2.9</td>
                <td align="left" rowspan="1" colspan="1">2.8</td>
                <td align="left" rowspan="1" colspan="1">766</td>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fastqz</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">(a)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">(a)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">(b)</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fqzcomp</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2236</td>
                <td align="left" rowspan="1" colspan="1">28.3</td>
                <td align="left" rowspan="1" colspan="1">34.1</td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">0.1455</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>33.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">54.9</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>39</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">medium</td>
                <td align="left" rowspan="1" colspan="1">0.2170</td>
                <td align="left" rowspan="1" colspan="1">18.1</td>
                <td align="left" rowspan="1" colspan="1">19.4</td>
                <td align="left" rowspan="1" colspan="1">312</td>
                <td align="left" rowspan="1" colspan="1">0.1422</td>
                <td align="left" rowspan="1" colspan="1">27.2</td>
                <td align="left" rowspan="1" colspan="1">38.2</td>
                <td align="left" rowspan="1" colspan="1">310</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2132</td>
                <td align="left" rowspan="1" colspan="1">6.5</td>
                <td align="left" rowspan="1" colspan="1">6.5</td>
                <td align="left" rowspan="1" colspan="1">4407</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1419</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">13.8</td>
                <td align="left" rowspan="1" colspan="1">16.8</td>
                <td align="left" rowspan="1" colspan="1">4405</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SeqSqueeze1</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.2021</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">4587</td>
                <td align="left" rowspan="1" colspan="1">0.1465</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
                <td align="left" rowspan="1" colspan="1">4888</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="4" align="left" rowspan="1">
                  <bold>SRR027520_1 (Illumina)</bold>
                </td>
                <td colspan="4" align="left" rowspan="1">
                  <bold>SRR065390_1 (Illumina)</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Program</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Mode</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Ratio</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>C.R.</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>D.R.</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Mem</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Ratio</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>C.R.</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>D.R.</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Mem</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">gzip</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.3535</td>
                <td align="left" rowspan="1" colspan="1">12.2</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>45.4</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.2805</td>
                <td align="left" rowspan="1" colspan="1">8.9</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>44.3</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">bzip2</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.2905</td>
                <td align="left" rowspan="1" colspan="1">7.0</td>
                <td align="left" rowspan="1" colspan="1">13.0</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">0.2250</td>
                <td align="left" rowspan="1" colspan="1">8.2</td>
                <td align="left" rowspan="1" colspan="1">14.1</td>
                <td align="left" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCALCE</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2709</td>
                <td align="left" rowspan="1" colspan="1">9.4</td>
                <td align="left" rowspan="1" colspan="1">25.4</td>
                <td align="left" rowspan="1" colspan="1">2212</td>
                <td align="left" rowspan="1" colspan="1">0.1675</td>
                <td align="left" rowspan="1" colspan="1">9.1</td>
                <td align="left" rowspan="1" colspan="1">26.1</td>
                <td align="left" rowspan="1" colspan="1">2181</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2572</td>
                <td align="left" rowspan="1" colspan="1">7.8</td>
                <td align="left" rowspan="1" colspan="1">13.1</td>
                <td align="left" rowspan="1" colspan="1">5162</td>
                <td align="left" rowspan="1" colspan="1">0.1635</td>
                <td align="left" rowspan="1" colspan="1">7.3</td>
                <td align="left" rowspan="1" colspan="1">15.8</td>
                <td align="left" rowspan="1" colspan="1">5257</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DSRC</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2507</td>
                <td align="left" rowspan="1" colspan="1">24.7</td>
                <td align="left" rowspan="1" colspan="1">32.9</td>
                <td align="left" rowspan="1" colspan="1">18</td>
                <td align="left" rowspan="1" colspan="1">0.1912</td>
                <td align="left" rowspan="1" colspan="1">26.4</td>
                <td align="left" rowspan="1" colspan="1">33.2</td>
                <td align="left" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2477</td>
                <td align="left" rowspan="1" colspan="1">13.5</td>
                <td align="left" rowspan="1" colspan="1">32.2</td>
                <td align="left" rowspan="1" colspan="1">1058</td>
                <td align="left" rowspan="1" colspan="1">0.1524</td>
                <td align="left" rowspan="1" colspan="1">15.0</td>
                <td align="left" rowspan="1" colspan="1">33.9</td>
                <td align="left" rowspan="1" colspan="1">1965</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">quip</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2240</td>
                <td align="left" rowspan="1" colspan="1">16.8</td>
                <td align="left" rowspan="1" colspan="1">13.7</td>
                <td align="left" rowspan="1" colspan="1">396</td>
                <td align="left" rowspan="1" colspan="1">0.1622</td>
                <td align="left" rowspan="1" colspan="1">17.7</td>
                <td align="left" rowspan="1" colspan="1">14.5</td>
                <td align="left" rowspan="1" colspan="1">391</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2219</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">10.9</td>
                <td align="left" rowspan="1" colspan="1">777</td>
                <td align="left" rowspan="1" colspan="1">0.1584</td>
                <td align="left" rowspan="1" colspan="1">8.9</td>
                <td align="left" rowspan="1" colspan="1">11.7</td>
                <td align="left" rowspan="1" colspan="1">775</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fastqz</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.3887</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>36.1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">32.8</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.3456</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>37.1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">30.6</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2195</td>
                <td align="left" rowspan="1" colspan="1">4.6</td>
                <td align="left" rowspan="1" colspan="1">3.8</td>
                <td align="left" rowspan="1" colspan="1">1459</td>
                <td align="left" rowspan="1" colspan="1">0.1340</td>
                <td align="left" rowspan="1" colspan="1">4.7</td>
                <td align="left" rowspan="1" colspan="1">3.8</td>
                <td align="left" rowspan="1" colspan="1">1527</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">fqzcomp</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">0.2243</td>
                <td align="left" rowspan="1" colspan="1">31.4</td>
                <td align="left" rowspan="1" colspan="1">32.5</td>
                <td align="left" rowspan="1" colspan="1">44</td>
                <td align="left" rowspan="1" colspan="1">0.1733</td>
                <td align="left" rowspan="1" colspan="1">32.7</td>
                <td align="left" rowspan="1" colspan="1">29.4</td>
                <td align="left" rowspan="1" colspan="1">40</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">medium</td>
                <td align="left" rowspan="1" colspan="1">0.2196</td>
                <td align="left" rowspan="1" colspan="1">22.0</td>
                <td align="left" rowspan="1" colspan="1">21.7</td>
                <td align="left" rowspan="1" colspan="1">312</td>
                <td align="left" rowspan="1" colspan="1">0.1524</td>
                <td align="left" rowspan="1" colspan="1">22.4</td>
                <td align="left" rowspan="1" colspan="1">20.8</td>
                <td align="left" rowspan="1" colspan="1">311</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.2172</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">8.2</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">4407</td>
                <td align="left" rowspan="1" colspan="1">0.1341</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">8.5</td>
                <td align="left" rowspan="1" colspan="1">4406</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SeqSqueeze1</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">0.2187</td>
                <td align="left" rowspan="1" colspan="1">0.6</td>
                <td align="left" rowspan="1" colspan="1">0.6</td>
                <td align="left" rowspan="1" colspan="1">4919</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1239</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">4930</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>SRR003177 is 1.5 M human sequences of variable length (avg 564 bp); SRR07215_1 is 4.7 M human seqs of length 25 bp plus 1 primer base; SRR027520_1 is 24.2 M human seqs of length 76 bp; SRR065390_1 is 33.8 M C.Elegans seqs of length 100 bp. Ratio is the compressed size divided by the uncompressed size. C.R. and D.R. are compression and decompression rates in MB/s. (a) Program does not support variable length sequences. (b) Program does not support SOLiD data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The fast and medium compression speeds of Fqzcomp demonstrate comparable or better speed than DSRC and SCALCE while achieving significantly higher compression ratios. However note that DSRC provides random access to the compressed files. DSRC was tested with and without the LZ encoding step. On shallow data (where most genome bases are covered 1–2 times only) it can be seen to have minimal impact on compression ratios, while harming compression speed. However LZ encoding demonstrably gives a substantial improvement on small and/or deeply sequenced genomes.</p>
      <p>For highest compression ratio there is no clear winner with Fqzcomp, Fastqz and SeqSqueeze1 varying in rank by data set. The context mixing used in the IEETA SeqSqueeze1 entry comes at a large cost in CPU usage making it less useful. Fastqz also utilizes context mixing but the use of multi-threaded code and initial preprocessing to reduce the input data volumes offset the CPU costs considerably. Fqzcomp is the fastest of the three and comparable to the best compression ratios on all data sets except the deep C. Elegans set, but requires high memory to achieve high compression ratios.</p>
      <p>To get a better understanding of the relative strengths and weaknesses we chose SRR027520_1 and SRR065390_1 to study the compression of individual identifier, sequence and quality components. These data sets were chosen due to being supported by all programs. We also tested these data sets using reference based compression tools. <xref ref-type="table" rid="pone-0059190-t004">Table 4</xref> provides a break down by data type in a variety of conditions, showing the average number of bits per complete identifier, per individual base-call and confidence value.</p>
      <table-wrap id="pone-0059190-t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Compression by data type.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0059190-t004-4" xlink:href="pone.0059190.t004"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td colspan="6" align="left" rowspan="1">SRR027520_1</td>
                <td colspan="6" align="left" rowspan="1">SRR065390_1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Prog</td>
                <td align="left" rowspan="1" colspan="1">Ref</td>
                <td align="left" rowspan="1" colspan="1">Sort</td>
                <td align="left" rowspan="1" colspan="1">Ratio</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">Base</td>
                <td align="left" rowspan="1" colspan="1">Qual</td>
                <td align="left" rowspan="1" colspan="1">C.R.</td>
                <td align="left" rowspan="1" colspan="1">Mem</td>
                <td align="left" rowspan="1" colspan="1">Ratio</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">Base</td>
                <td align="left" rowspan="1" colspan="1">Qual</td>
                <td align="left" rowspan="1" colspan="1">C.R.</td>
                <td align="left" rowspan="1" colspan="1">Mem</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Raw FASTQ</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">1.0000</td>
                <td align="left" rowspan="1" colspan="1">419.9</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1.0000</td>
                <td align="left" rowspan="1" colspan="1">454.9</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fastqz</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">0.2195</td>
                <td align="left" rowspan="1" colspan="1">11.7</td>
                <td align="left" rowspan="1" colspan="1">1.71</td>
                <td align="left" rowspan="1" colspan="1">2.96</td>
                <td align="left" rowspan="1" colspan="1">3.8</td>
                <td align="left" rowspan="1" colspan="1">1459</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1340</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">15.6</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.11</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.53</td>
                <td align="left" rowspan="1" colspan="1">3.8</td>
                <td align="left" rowspan="1" colspan="1">1527</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fqzcomp(medium)</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">0.2196</td>
                <td align="left" rowspan="1" colspan="1">11.3</td>
                <td align="left" rowspan="1" colspan="1">1.72</td>
                <td align="left" rowspan="1" colspan="1">2.95</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>22.0</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>312</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.1524</td>
                <td align="left" rowspan="1" colspan="1">14.8</td>
                <td align="left" rowspan="1" colspan="1">1.52</td>
                <td align="left" rowspan="1" colspan="1">1.52</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>22.4</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>311</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fqzcomp(slow)</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.2172</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">11.3</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.68</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">8.2</td>
                <td align="left" rowspan="1" colspan="1">4407</td>
                <td align="left" rowspan="1" colspan="1">0.1341</td>
                <td align="left" rowspan="1" colspan="1">14.8</td>
                <td align="left" rowspan="1" colspan="1">1.16</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.49</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">4406</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quip</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">0.2219</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>11.2</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.78</td>
                <td align="left" rowspan="1" colspan="1">2.95</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">777</td>
                <td align="left" rowspan="1" colspan="1">0.1584</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>14.7</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.64</td>
                <td align="left" rowspan="1" colspan="1">1.51</td>
                <td align="left" rowspan="1" colspan="1">9.0</td>
                <td align="left" rowspan="1" colspan="1">776</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fastqz</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">0.1816</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>11.7</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">2.96</td>
                <td align="left" rowspan="1" colspan="1">3.2</td>
                <td align="left" rowspan="1" colspan="1">1365</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1000</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>15.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.40</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.53</td>
                <td align="left" rowspan="1" colspan="1">4.7</td>
                <td align="left" rowspan="1" colspan="1">1352</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Samcomp2</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1810</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>19.4</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.75</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>13.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1079</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.1022</td>
                <td align="left" rowspan="1" colspan="1">19.9</td>
                <td align="left" rowspan="1" colspan="1">0.43</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.49</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">17.1</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>365</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quip</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">ID</td>
                <td align="left" rowspan="1" colspan="1">0.1885</td>
                <td align="left" rowspan="1" colspan="1">22.2</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">2.95</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>16.4</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1515</td>
                <td align="left" rowspan="1" colspan="1">0.1088</td>
                <td align="left" rowspan="1" colspan="1">21.3</td>
                <td align="left" rowspan="1" colspan="1">0.54</td>
                <td align="left" rowspan="1" colspan="1">1.52</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>19.1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">807</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fastqz</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2414</td>
                <td align="left" rowspan="1" colspan="1">52.1</td>
                <td align="left" rowspan="1" colspan="1">1.66</td>
                <td align="left" rowspan="1" colspan="1">2.95</td>
                <td align="left" rowspan="1" colspan="1">3.2</td>
                <td align="left" rowspan="1" colspan="1">1527</td>
                <td align="left" rowspan="1" colspan="1">0.1397</td>
                <td align="left" rowspan="1" colspan="1">64.1</td>
                <td align="left" rowspan="1" colspan="1">0.74</td>
                <td align="left" rowspan="1" colspan="1">1.54</td>
                <td align="left" rowspan="1" colspan="1">4.0</td>
                <td align="left" rowspan="1" colspan="1">1527</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Samcomp1</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.2360</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>49.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.59</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>15.1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">315</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1147</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">58.7</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.29</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.50</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>21.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">288</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Samcomp2</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2628</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>49.8</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">2.18</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">13.5</td>
                <td align="left" rowspan="1" colspan="1">341</td>
                <td align="left" rowspan="1" colspan="1">0.1982</td>
                <td align="left" rowspan="1" colspan="1">58.7</td>
                <td align="left" rowspan="1" colspan="1">2.04</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.49</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">15.2</td>
                <td align="left" rowspan="1" colspan="1">341</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quip</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2453</td>
                <td align="left" rowspan="1" colspan="1">50.5</td>
                <td align="left" rowspan="1" colspan="1">1.78</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">9.3</td>
                <td align="left" rowspan="1" colspan="1">776</td>
                <td align="left" rowspan="1" colspan="1">0.1890</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>58.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.83</td>
                <td align="left" rowspan="1" colspan="1">1.53</td>
                <td align="left" rowspan="1" colspan="1">11.2</td>
                <td align="left" rowspan="1" colspan="1">775</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SAMtools (BAM)</td>
                <td align="left" rowspan="1" colspan="1">N</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.4013</td>
                <td align="left" rowspan="1" colspan="1">137.8</td>
                <td align="left" rowspan="1" colspan="1">2.79</td>
                <td align="left" rowspan="1" colspan="1">4.21</td>
                <td align="left" rowspan="1" colspan="1">13.7</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.2344</td>
                <td align="left" rowspan="1" colspan="1">150.9</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">2.47</td>
                <td align="left" rowspan="1" colspan="1">16.7</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Fastqz</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2009</td>
                <td align="left" rowspan="1" colspan="1">52.1</td>
                <td align="left" rowspan="1" colspan="1">0.77</td>
                <td align="left" rowspan="1" colspan="1">2.95</td>
                <td align="left" rowspan="1" colspan="1">2.9</td>
                <td align="left" rowspan="1" colspan="1">1406</td>
                <td align="left" rowspan="1" colspan="1">0.1184</td>
                <td align="left" rowspan="1" colspan="1">64.1</td>
                <td align="left" rowspan="1" colspan="1">0.29</td>
                <td align="left" rowspan="1" colspan="1">1.54</td>
                <td align="left" rowspan="1" colspan="1">4.4</td>
                <td align="left" rowspan="1" colspan="1">1352</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Samcomp1</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1852</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">49.8</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.47</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">15.7</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>378</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.1116</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">58.7</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.23</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1.50</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>21.9</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>296</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Samcomp2</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.1920</td>
                <td align="left" rowspan="1" colspan="1">49.8</td>
                <td align="left" rowspan="1" colspan="1">0.62</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">14.2</td>
                <td align="left" rowspan="1" colspan="1">1079</td>
                <td align="left" rowspan="1" colspan="1">0.1163</td>
                <td align="left" rowspan="1" colspan="1">58.7</td>
                <td align="left" rowspan="1" colspan="1">0.33</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>1.49</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">20.1</td>
                <td align="left" rowspan="1" colspan="1">365</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quip</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.1926</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>49.2</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.64</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>16.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1516</td>
                <td align="left" rowspan="1" colspan="1">0.1165</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>58.6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.32</td>
                <td align="left" rowspan="1" colspan="1">1.53</td>
                <td align="left" rowspan="1" colspan="1">19.6</td>
                <td align="left" rowspan="1" colspan="1">808</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Goby<xref ref-type="table-fn" rid="nt105">a</xref>
</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2706</td>
                <td align="left" rowspan="1" colspan="1">99.5</td>
                <td align="left" rowspan="1" colspan="1">0.62</td>
                <td align="left" rowspan="1" colspan="1">4.01</td>
                <td align="left" rowspan="1" colspan="1">4.8</td>
                <td align="left" rowspan="1" colspan="1">1797</td>
                <td align="left" rowspan="1" colspan="1">0.1587</td>
                <td align="left" rowspan="1" colspan="1">110.6</td>
                <td align="left" rowspan="1" colspan="1">0.28</td>
                <td align="left" rowspan="1" colspan="1">1.93</td>
                <td align="left" rowspan="1" colspan="1">6.8</td>
                <td align="left" rowspan="1" colspan="1">1250</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CRAM</td>
                <td align="left" rowspan="1" colspan="1">Y</td>
                <td align="left" rowspan="1" colspan="1">pos</td>
                <td align="left" rowspan="1" colspan="1">0.2504</td>
                <td align="left" rowspan="1" colspan="1">92.1</td>
                <td align="left" rowspan="1" colspan="1">0.58</td>
                <td align="left" rowspan="1" colspan="1">3.71</td>
                <td align="left" rowspan="1" colspan="1">5.0</td>
                <td align="left" rowspan="1" colspan="1">1514</td>
                <td align="left" rowspan="1" colspan="1">0.1676</td>
                <td align="left" rowspan="1" colspan="1">105.9</td>
                <td align="left" rowspan="1" colspan="1">0.27</td>
                <td align="left" rowspan="1" colspan="1">2.17</td>
                <td align="left" rowspan="1" colspan="1">7.9</td>
                <td align="left" rowspan="1" colspan="1">898</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt104">
            <label/>
            <p>Showing the compressed file size break down by bits per sequence identifier, per base-call and per quality value. In some cases these sizes refer to cases where a reference was previously used to map, but it has not been used during compression (e.g. BAM). The ID, Base and Qual columns are the number of bits required to store the complete sequence identifier, a single base nucleotide and a single quality value respectively. The C.R. column is the compression rate in MB per second. Mem is the amount of memory required during compression. References used were human hg19 and C.Elegans WS233. Non-reference based Quip used the “-a” assembly option for high compression mode.</p>
          </fn>
          <fn id="nt105">
            <label>a</label>
            <p>Goby does not store unmapped data. The Goby figures have been estimated by adding 2 bits per absent base-call and scaling up the name and quality figures by the percentage of unmapped reads.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Fastqz outputs separate files per data type while Fqzcomp and Quip report separate figures upon completion. For other tools we either modified them to omit specific data types (Samcomp ) or produced multiple data files with identifiers, sequences and/or quality values absent and measured the difference to derive the approximate size of each component.</p>
      <p>With the fastq in the original order as downloaded from the NCBI and without using a reference to align against, we see that Fqzcomp and Fastqz are largely comparable in size. Quip is also comparable on shallow data, but is unable to exploit the high sequence redundancy in the deep data set.</p>
      <p>Keeping in the original name-sorted order but aligning against a reference shows some disparity. As Fqzcomp has no support for reference base compression and Samcomp1 requires genome position sorted data we only compare Fastqz, Samcomp2 and Quip. Note that Quip in the original form as submitted to the competition did not support SAM format or reference based compression. Samcomp2 and Fastqz, in this configuration of using a reference against unsorted data, came top in the SequenceSqueeze contest by compression ratio. The sequence name encoding in Samcomp2 is weaker then Fastqz, but on shallow data the sequence encoding is better, leading them to trade places between the two data sets with no overall leader. Quip is in third place on both data sets but is slightly faster. As expected in all three cases it is clear that the improvement to base-call storage is considerable, becoming the smallest component of total file size (while being the most significant and useful component).</p>
      <p>More interesting are the results of sorting the aligned data by the position within the genome, but without utilization of the genome sequence as a reference to encode differences against. It may seem strange to not exploit this knowledge, but this use case represents storage of de-novo sequence assemblies for which no reference is known and is also the the usual form of encoding within BAM files. BAM is considerably larger for all components, particularly so with sequence identifiers. It should be noted again that these sequence identifiers are long as they contain the NCBI “SRR[<italic>num</italic>]” identifier (now in a random order) as well as the original machine produced identifier. Except for SAMtools all programs in this test have roughly comparable identifier and quality encoding metrics, with the significant differences coming in sequence encoding. Samcomp1 significantly outperforms the other tools, most notably so in the deep C.Elegans data set giving just 0.29 bits per base - close to the 0.23 best case when a reference is specified. This is due to the use of per-position models.</p>
    </sec>
    <sec id="s2c">
      <title>Reference Based</title>
      <p>Finally moving to reference based compression of position sorted files allows a direct comparison to existing reference based compression programs; CRAM, Goby and Quip. Fastqz operates on a FASTQ file and includes its own fast alignment algorithm. Some metrics on the performance of this can be seen in <xref ref-type="table" rid="pone-0059190-t005">Table 5</xref>. All the other tools listed operate on SAM or BAM files containing previously generated alignments. The time taken to generate these alignments has not been taken into consideration in the compression rate figure.</p>
      <table-wrap id="pone-0059190-t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0059190.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Fastqz alignment benchmarks.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0059190-t005-5" xlink:href="pone.0059190.t005"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Data type</td>
                <td align="left" rowspan="1" colspan="1">Mode</td>
                <td align="left" rowspan="1" colspan="1">Unaligned size</td>
                <td align="left" rowspan="1" colspan="1">Aligned size</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Identifier</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">251,697,610</td>
                <td align="left" rowspan="1" colspan="1">251,697,610</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Alignment</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">n/a</td>
                <td align="left" rowspan="1" colspan="1">183,313,663</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequence</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">639,049,273</td>
                <td align="left" rowspan="1" colspan="1">49,174,693</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quality</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">867,178,255</td>
                <td align="left" rowspan="1" colspan="1">867,178,255</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Total</td>
                <td align="left" rowspan="1" colspan="1">fast</td>
                <td align="left" rowspan="1" colspan="1">1,757,925,138</td>
                <td align="left" rowspan="1" colspan="1">1,351,364,221</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Identifier</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">47,861,283</td>
                <td align="left" rowspan="1" colspan="1">47,861,283</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Alignment</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">n/a</td>
                <td align="left" rowspan="1" colspan="1">105,063,319</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequence</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">503,239,070</td>
                <td align="left" rowspan="1" colspan="1">30,852,888</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Quality</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">574,112,937</td>
                <td align="left" rowspan="1" colspan="1">574,112,937</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Total</td>
                <td align="left" rowspan="1" colspan="1">slow</td>
                <td align="left" rowspan="1" colspan="1">1,125,213,290</td>
                <td align="left" rowspan="1" colspan="1">757,890,427</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt106">
            <label/>
            <p>Size of data components in the public SequenceSqueeze test set SRR062634 (6,345,444,769 bytes uncompressed).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>All programs perform well for base compression, although the clear winner in this category is the per-position model used in Samcomp1. As before, identifiers and quality strings are comparable between Fastqz, Samcomp and Quip, but we can see CRAM and Goby are considerably larger on quality values and, where applicable, sequence identifiers. Note however that both CRAM and Goby are random-access file formats unlike Fastqz, Samcomp and Quip. This will account for some, but not all of the size difference. Speed-wise recall that Fastqz is performing its own alignment while the other tools are operating on already aligned SAM/BAM files, making it hard to compare the overall performance.</p>
      <p>In the context of the SequenceSqueeze competition it is clear that the long identifiers hampered file sorting. The inclusion of the NCBI identifiers added an additional 25 bits of data per identifier which could only be negated if the data was kept in the original order. This ultimately lead to Samcomp2 being the competition winner in terms of compression ratio, but it is arguably a weaker tool than the original Samcomp implementation. Generally sequencing data is either in an unsorted FASTQ file or an aligned and hence sort-able alignment file (e.g. BAM). Therefore we would not advise general use of Samcomp2. It is commendable that Quip was capable of running in all four categories listed in <xref ref-type="table" rid="pone-0059190-t004">Table 4</xref> and while never reaching top compression it was usually close (with deep data being the notable exception) and with acceptable speed.</p>
      <p>It is important to note the limitations of Samcomp. While it uses SAM/BAM as input and output formats, it is not a full SAM/BAM compressor. It was designed with the SequenceSqueeze competition in mind and so primarily focuses on identifiers, sequence and quality values. SAM flags and mapping scores are also stored, but the SAM header, auxiliary fields and the template fields (columns 7–9) and not preserved. For a fair comparison with other SAM compressors we removed auxiliary fields and set columns 7–9 as “*”, “0” and “0” respectively in all compression tests.</p>
      <p>The results in <xref ref-type="table" rid="pone-0059190-t004">Table 4</xref> clearly indicate that the DNA sequence portion accounts for a minority of the disk space, yet is the primary purpose for the file. An obvious corollary to this is to consider whether we can lose or reduce the information content of the identifiers and quality values. Sequence identifiers have some initial use for detection of optical duplicates - the identifier typically encodes an X,Y location too - but beyond this it is used solely as a device for pairing sequences. The CRAM format solves this by removing names and keeping only the pairing information. Likewise the quality values may not need 40 separate levels for each base. CRAM provides multiple lossy methods. Some work has been done to evaluate the impact of using fewer quality levels <xref rid="pone.0059190-Asnani1" ref-type="bibr">[8]</xref>.</p>
      <p>Both Fqzcomp and Fastqz contain basic methods to lossily compress the quality strings, although Samcomp does not. The programs behave in slightly different manners. Fastqz rounds all quality above 1 to a multiple of Q where Q is the quantisation factor. This reduces the number of quality values and correspondingly increases the compression ratio. Fqzcomp has a similar approach, but instead every value above Q is encoded within Q of the original value, picking the value which happens to encode to the fewest bits given the current context. For example a quality value 37 with Q = 2 could be encoded as 35, 36, 37, 38 or 39. In practise this amounts to the same binning system as Fastqz unless the output is initially tuned on a few losslessly encoded quality strings.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <p>A FASTQ file consists of one or more sequences (typically millions) with each sequence being represented by an identifier, the DNA base calls, and the quality or confidence of each individual base call. A truncated example from the competition training set is shown below.</p>
    <p>@SRR062634.2724179 HWI-EAS110_103327062∶6:13∶11133:13696/1 TGGAATCAGATGGAATCATCGAATGGACTGGAATGGAATCATTGAATGGACTCGAAAGG+GGGFGGFDGGGGGGFGFGGGGGGGGGGGGGGEFGGGGFGEDGGGFGGGFEDFGCDFDG? @SRR062634.2724180 HWI-EAS110_103327062∶6:13∶11133:11572/1 ATATAGTCCATTGTACTCCCTTGCTTAAATCTGGATCCCTGCAAATAAAAACATCTTCC+GGGGGGGGFGGGGEGGFGGGEGGFDGEAEGGEEEEBEEEEEEEEEEEEEEEEEEECCCC.</p>
    <p>Each read is described in four lines of text. The first line, beginning with ‘@’, is an arbitrary text identifier. The format is machine specific, but it is typically a unique identifier constructed by joining run/flow-cell name and location (lane, X and Y coordinates) together. In this example, the NCBI “SRR” identifiers have also been prepended to the original sequence identifier. The second line holds the base call sequence consisting of A, C, G and T nucleotides with the occasional N. The third line consists of the ‘+’ character optionally followed by a copy of the sequence identifier (usually omitted). The fourth and final line holds the quality scores in Phred +33 format <xref rid="pone.0059190-Ewing1" ref-type="bibr">[26]</xref>, i.e. a character with ASCII value <inline-formula><inline-graphic xlink:href="pone.0059190.e001.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0059190.e002.jpg"/></inline-formula> is the probability of error in the corresponding base and in the range 33 through 126 (‘!’through ‘∼’). Other phred encodings exist, such as Phred score +64, but are deprecated and not considered in this work. Practically speaking it is rare for Phred scores greater than 40 (ASCII ‘I’) to be utilized. In the competition data (from an Illumina instrument) all sequences are of the same length throughout the file, but this is not a requirement of the FASTQ format and some sequencing machines generate variable length records.</p>
    <p>In common with previous work, the Fqzcomp and Fastqz programs both split FASTQ data into sequence identifiers, base-calls and quality scores, compressing the streams independently and in most cases in parallel. Each stream is passed through context models and into an arithmetic coder <xref rid="pone.0059190-Witten1" ref-type="bibr">[27]</xref>.</p>
    <p>We define an <inline-formula><inline-graphic xlink:href="pone.0059190.e003.jpg"/></inline-formula> model to be one where probabilities are derived from the frequency of symbols with no context. An <inline-formula><inline-graphic xlink:href="pone.0059190.e004.jpg"/></inline-formula> model counts the frequency of symbols given <inline-formula><inline-graphic xlink:href="pone.0059190.e005.jpg"/></inline-formula> previous symbols. For example an order-0 model may assign <inline-formula><inline-graphic xlink:href="pone.0059190.e006.jpg"/></inline-formula> for the letter ‘u’ in English text, while an order-1 model may assign <inline-formula><inline-graphic xlink:href="pone.0059190.e007.jpg"/></inline-formula>, where ‘q’ is the context indicating that the letter ‘u’ is very frequent following the letter ‘q’.</p>
    <p>The context models predict (assign probabilities to) consecutive symbols given the previous context and statistics collected within that context. If a symbol is assigned a probability <inline-formula><inline-graphic xlink:href="pone.0059190.e008.jpg"/></inline-formula>, then the arithmetic coder chooses a code of amortized length <inline-formula><inline-graphic xlink:href="pone.0059190.e009.jpg"/></inline-formula> bits to represent it. This coding is provably optimal <xref rid="pone.0059190-Shannon1" ref-type="bibr">[28]</xref>. Thus, compression ratio depends on the quality of the predictions, <inline-formula><inline-graphic xlink:href="pone.0059190.e010.jpg"/></inline-formula>, in turn depending on the accuracy of the context model.</p>
    <sec id="s3a">
      <title>Fqzcomp</title>
      <p>Fqzcomp uses a public domain byte-wise arithmetic coder from E. Shelwien (<ext-link ext-link-type="uri" xlink:href="http://ctxmodel.net">http://ctxmodel.net</ext-link> accessed on February 22, 2012). The context models are also derived from the same source, but have been heavily tuned to the type of data.</p>
      <sec id="s3a1">
        <title>Identifiers</title>
        <p>Fqzcomp compresses identifiers by using the previous identifier as a context to predict the current identifier. The identifier is tokenised into { <italic>type</italic>, <italic>value</italic>} pairs with <italic>type</italic> being one of alpha, numeric, leading zeros or punctuation (including spaces). For example: @ SRR 0 62634. 3364 HWI - EAS11 0 _ 103327062∶ 6 : 1∶ 1944 : 962/2.</p>
        <p>The tokens are numbered 1 to N, producing N distinct models for the purposes of accumulating token specific statistics. When a token <italic>type</italic> is the same in the previous identifier the <italic>value</italic> is compared. Identical tokens are stored as type <italic>match</italic> while numerical values may be encoded as <italic>delta</italic> tokens when the current value is between 0 and 255 higher than the previous numeric value. Numeric values up to <inline-formula><inline-graphic xlink:href="pone.0059190.e011.jpg"/></inline-formula> are encoded using four 8-bit models with larger numerical values being broken into 32-bit quantities to avoid overflow. <italic>Alpha</italic> and <italic>punctuation</italic> tokens are encoded a character at a time using a simple order-0 model; one which assumes each character is chosen independently and so requires no context.</p>
        <p>In practise this does not work well for 454 data which mix a combination of letters and numbers together in order to achieve a base-64 encoding. This tends to produce a highly variable number of tokens. With hindsight an alphanumeric token type (matching [A-Za-z][A-Za-z0-9]* regular expression) would have worked better. An earlier identifier encoding method using simple string deltas is also available, performing better on 454 data.</p>
      </sec>
      <sec id="s3a2">
        <title>Quality values</title>
        <p>To encode quality values, let <inline-formula><inline-graphic xlink:href="pone.0059190.e012.jpg"/></inline-formula> be the coded quality scores for a sequence of length <inline-formula><inline-graphic xlink:href="pone.0059190.e013.jpg"/></inline-formula>.</p>
        <p>For any specific score <inline-formula><inline-graphic xlink:href="pone.0059190.e014.jpg"/></inline-formula> there is a strong correlation to the immediate previous few quality values <inline-formula><inline-graphic xlink:href="pone.0059190.e015.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0059190.e016.jpg"/></inline-formula> lessening the further back we go. We observed that many sequences ended in a run of score 2 (“#”), corresponding to a known issue with the Illumina base-caller <xref rid="pone.0059190-Minoche1" ref-type="bibr">[29]</xref>.</p>
        <p>All qualities are forced into the range 0 to 62, with 0 being exclusively required for bases called with “N”. Score 63 is used to represent a run of score 2 to the end of the sequence.</p>
        <p>Most technologies have correlation between position and quality values, with quality typically reducing along the length of the sequence. It was also noted that sequences as a whole tend to be good or bad, so a sequence containing a number of low quality values is more likely to contain further low qualities even if the immediately previous values are high.</p>
        <p>These correlations are combined to form successive levels of quality compression in Fqzcomp, selected by the user. Given <inline-formula><inline-graphic xlink:href="pone.0059190.e017.jpg"/></inline-formula> being the quality for the <inline-formula><inline-graphic xlink:href="pone.0059190.e018.jpg"/></inline-formula>th base, the contexts used to predict <inline-formula><inline-graphic xlink:href="pone.0059190.e019.jpg"/></inline-formula> in Fqzcomp are:<disp-formula id="pone.0059190.e020"><graphic xlink:href="pone.0059190.e020.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      </sec>
      <sec id="s3a3">
        <title>Sequence encoding</title>
        <p>Fqzcomp encodes with an order-<inline-formula><inline-graphic xlink:href="pone.0059190.e021.jpg"/></inline-formula> model, using the previous <inline-formula><inline-graphic xlink:href="pone.0059190.e022.jpg"/></inline-formula> base calls to predict the next call. <inline-formula><inline-graphic xlink:href="pone.0059190.e023.jpg"/></inline-formula> is a configurable parameter at run-time. Optionally the model can be updated with the reverse complement of the previous <inline-formula><inline-graphic xlink:href="pone.0059190.e024.jpg"/></inline-formula> bases too. This gives a small improvement in compression ratio, but at a significant speed penalty. With high <inline-formula><inline-graphic xlink:href="pone.0059190.e025.jpg"/></inline-formula> the program may learn the full genome, if sufficiently small. For example it is to be expected that on a 100 Mbp genome an order-14 model will be sparsely populated. Given sufficient depth the 14-mers in the model will represent the genomic sequence, allowing for accurate prediction of the next base so yielding high compression ratios. The same order-14 model on 3 Gbp genome however will have many random hits for each k-mer, only giving high accuracy within repeat regions and leading to poor compression. It is expected that most compression on large genomes is coming through common repeat sequences.</p>
        <p>Fqzcomp also has the option to use an additional fixed size order-7 model, which is better for spotting short motifs and sequencing biases. There is no mixing step used here. Instead Fqzcomp encodes using the model containing the strongest probability bias (to any base type, not just the one being encoded). This is not very robust and is weak compared to context mixing, but achieves a small compression gain with a small CPU overhead.</p>
        <p>The models used in Fqzcomp permit encoding of symbols 0, 1, 2 and 3 representing A, C, G and T). Each model uses 8-bit counters, meaning the combined model takes <inline-formula><inline-graphic xlink:href="pone.0059190.e026.jpg"/></inline-formula> bytes. Base call N is simply encoded as 0 and fixed during decoding by observing that the associated quality value is 0 (this is enforced).</p>
      </sec>
    </sec>
    <sec id="s3b">
      <title>Fastqz</title>
      <p>Like Fqzcomp, Fastqz breaks the fastq file into three separate streams. However it contains an additional preprocessing step before the context modelling to reduce the data volume. This step is mainly a speed optimization and usually has a small cost in compression ratio.</p>
      <p>The public domain libzpaq compression library was used for specifying the context models for the four streams in ZPAQ format (M. Mahoney, <ext-link ext-link-type="uri" xlink:href="http://mattmahoney.net/dc/zpaq.html">http://mattmahoney.net/dc/zpaq.html</ext-link> accessed on May 3, 2012). ZPAQ uses a context mixing algorithm based on PAQ <xref rid="pone.0059190-Mahoney1" ref-type="bibr">[30]</xref> in which the bit-wise predictions of multiple independent context models are adaptively combined.</p>
      <sec id="s3b1">
        <title>Identifiers</title>
        <p>Differences between consecutive lines are encoded as a numeric field increment in the range 0-255, a match length, and trailing differences. For example, given the lines: @SRR062634.2724180 HWI-EAS110_103327062∶6:13∶11133:11572/1 @SRR062634.2724181 HWI-EAS110_103327062∶6:13∶11133:5630/1.</p>
        <p>The second line is encoded as (18)(1)(51) ” 5630/1” (0), which means go to column 18, add 1 to the decimal string found there, then after this adjustment, copy the first 51 bytes, append the literal string, and terminate with a 0 byte (replacing the newline). In rare cases where an increment of more than 255 is required, then it is coded as a mismatch.</p>
        <p>In fast mode, no further encoding is performed. In slow mode, the encoded names are modelled using a mix of four context models, each consisting of a hash of the column number, the current byte in the previous line, the previous bits in the current byte, and the last 1, 2, 3, or 4 bytes in the current line. The two low order models (1 and 2) map the context to a bit prediction and are updated by adjusting the prediction to reduce the error in inverse proportion to the context count. The two high order models are indirect context models. The context hash is mapped to an 8 bit state representing the bit history. The history is then mapped to an adaptively adjusted prediction. The outputs of the four models are combined by weighted averaging in the logistic domain, <inline-formula><inline-graphic xlink:href="pone.0059190.e027.jpg"/></inline-formula>. The weights are selected by an order 0 context that includes the column number, and adjusted on update to favour the better models.</p>
      </sec>
      <sec id="s3b2">
        <title>Quality values</title>
        <p>It was observed that the initial Q values tended to start with a common maximum value (38, ASCII “G”) and decline along the length of the sequence.</p>
        <p>Scores are compressed by using byte codes to indicate runs of score 38 up to length 55, or groups of three scores in the range 35–38, or pairs of scores in the range 31–38, or single bytes for other scores, and finally a marker to indicate that the rest of the scores are 2 and are omitted. In fast mode, no further encoding is performed. In slow mode, the resulting codes are modelled using a mix of three direct context models as follows:</p>
        <list list-type="order">
          <list-item>
            <p>hash of <inline-formula><inline-graphic xlink:href="pone.0059190.e028.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0059190.e029.jpg"/></inline-formula>
</p>
          </list-item>
          <list-item>
            <p>hash of <inline-formula><inline-graphic xlink:href="pone.0059190.e030.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0059190.e031.jpg"/></inline-formula>
</p>
          </list-item>
          <list-item>
            <p>hash of <inline-formula><inline-graphic xlink:href="pone.0059190.e032.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0059190.e033.jpg"/></inline-formula>
</p>
          </list-item>
          <list-item>
            <p>mixing weights: hash of <inline-formula><inline-graphic xlink:href="pone.0059190.e034.jpg"/></inline-formula>
</p>
          </list-item>
        </list>
      </sec>
      <sec id="s3b3">
        <title>Sequence encoding</title>
        <p>Fastqz starts by packing multiple base calls together, assigning A = 1, T = 2, C = 3 and G = 4. The only other code is N, which need not be coded because it always has a quality score of 0 and can be inserted during decoding. We pack either 3 or 4 bases together, whichever numerical packed value does not exceed 255. The coding is such that any sequence starting with G, CG, or CCG is coded in 3 bytes, but any other sequence is 4 bytes. The benefit of using 1234 over 0123 comes through self synchronization, so that overlapping reads that start at different locations will eventually be parsed into the same token sequence to allow compression. For example:</p>
        <p>
          <named-content content-type="gene">TGGA ATCA GAT GGA ATCA TCGA ATGG ACTG GAA TGGA ATCA</named-content>
        </p>
        <p>
          <named-content content-type="gene">GGA ATCA GAT GGA ATCA TCGA ATGG ACTG GAA TGGA ATCA</named-content>
        </p>
        <p>
          <named-content content-type="gene">GAAT CAGA TGGA ATCA TCGA ATGG ACTG GAA TGGA ATCA</named-content>
        </p>
        <p>
          <named-content content-type="gene">AATC AGAT GGA ATCA TCGA ATGG ACTG GAA TGGA ATCA</named-content>
        </p>
        <p>In fast mode, no further encoding is performed. In slow mode, the encoded sequence is compressed using a mix of 6 models ranging from order 0 through order 5 bytes, or effectively order 4 through about 23 in bases. The order 0, 1, and 2 models are direct context models, using up to <inline-formula><inline-graphic xlink:href="pone.0059190.e035.jpg"/></inline-formula> contexts, requiring 4 bytes of memory each. The order 3 model is an indirect context model, requiring <inline-formula><inline-graphic xlink:href="pone.0059190.e036.jpg"/></inline-formula> histories at one byte each. The order 4 model uses an indirect secondary symbol estimator. It adjusts the output of the previous model by mixing with the constant 1 in the logistic domain, where the pair of mixing weights is selected by the bit history in one of <inline-formula><inline-graphic xlink:href="pone.0059190.e037.jpg"/></inline-formula> hashed contexts. The order 5 model uses a match model. A bit prediction is made by searching for the previous occurrence of the context in a 256 MB buffer and predicting the next bit with probability 1–1/(match length in bits). Contexts are looked up in a 256 MB hash table to find matches. Total memory usage is about 1.4 GB.</p>
        <p>In both Fqzcomp and Fastqz the compression ratio of deep sequence data is strongly correlated with genome size, which can be compensated for by using additional memory. This is a problem which has partially been solved by <xref rid="pone.0059190-Cox1" ref-type="bibr">[6]</xref>.</p>
      </sec>
      <sec id="s3b4">
        <title>Reference based encoding</title>
        <p>The optimal compression of a set of sequence fragments involves a full identification of the relationships between all fragments; what their similarities are and whether they fit together to form some higher level structure (the source genome). This is largely the same problem solved by sequence assembly tools. One competitor, Daniel Jones, implemented his own sequence assembly algorithm (Quip) to permit data compression, but was largely hampered in the test data by low coverage and a relatively limited memory requirement.</p>
        <p>If we have a known reference of the organism being sequenced we can instead implement a Lempel Ziv style compression algorithm <xref rid="pone.0059190-Ziv1" ref-type="bibr">[31]</xref>. This replaces portions of text with a coordinate and length into previously observed data, in this case the reference genome. In bioinformatics the equivalent are the sequence aligners or mappers, such as Smalt (<ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/resources/software/smalt/">http://www.sanger.ac.uk/resources/software/smalt/</ext-link> accessed on August 29, 2012), BWA <xref rid="pone.0059190-Li2" ref-type="bibr">[32]</xref> or Bowtie <xref rid="pone.0059190-Langmead1" ref-type="bibr">[33]</xref>.</p>
        <p>Fastqz will optionally accept a reference genome of up to 4 GB with which it performs its own reference based mapping. If specified it must be present for both compression and decompression steps.</p>
        <p>During compression, Fastqz will attempt to match sequences to the reference and encode them as a 32 bit pointer, a direction bit, and a list of up to four mismatched base positions. Matched bases are deleted from the sequences before compression and inserted after decompression.</p>
        <p>To find matches, the reference is first packed 4 bases per byte using the code A = 0, C = 1, G = 2, T = 3 (deleting any N’s) and stored in up to 1 GB memory. The reference is divided into groups of 32 bases and a 1 GB hash table index is constructed, consisting of 256 M 27-bit pointers and 5 bit hash checksums as an optimization to detect 97% of collisions early. It searches 8 consecutive locations for an empty slot, resulting in about 6% of pointers being discarded when indexing a 2.9 Gb human genome in a 724 MB array.</p>
        <p>To align, a rolling hash of the 100 byte reads is computed in both directions, swapping A with T and C with G in reverse. Starting at position 32, the hash is looked up and matches are ranked by the position of the fourth mismatch, breaking ties with the third, second, and first. The best ranked match is coded and the corresponding bases deleted from the read. If the fourth mismatch is less than the read length, then any remaining bases are coded as if not matching. If the fourth mismatch is less than half the read length, then the entire read is coded as if no match were found.</p>
        <p>The list of alignments are coded in the format <inline-formula><inline-graphic xlink:href="pone.0059190.e038.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0059190.e039.jpg"/></inline-formula> is the position of the <inline-formula><inline-graphic xlink:href="pone.0059190.e040.jpg"/></inline-formula>th mismatch in ascending order, or the read length +1 with less than <inline-formula><inline-graphic xlink:href="pone.0059190.e041.jpg"/></inline-formula> mismatches, <inline-formula><inline-graphic xlink:href="pone.0059190.e042.jpg"/></inline-formula> is 0 for a forward match and 1 for a reverse match, and <inline-formula><inline-graphic xlink:href="pone.0059190.e043.jpg"/></inline-formula> is the 4 byte pointer. An unmatched read is coded as a single 0 byte.</p>
        <p>In fast mode, the encoded list of alignments is not compressed further. In slow mode, the list is compressed using a direct context model where the context is the parse state, the previous bits of the current byte, and the high 6 bits of the previous byte except when encoding the 2 low bytes of the pointer.</p>
      </sec>
    </sec>
    <sec id="s3c">
      <title>Samcomp1</title>
      <p>The Samcomp program takes a slightly different approach to Fastqz by offloading the issue of how to assemble or how to align to a third-party program; we used Bowtie2 for the competition but alternatives would work too.</p>
      <p>The initial implementation (Samcomp v0.7) of this program requires a SAM or BAM file sorted by chromosome and position within the chromosome. Identifier and quality information is encoded as per Fqzcomp. For sequences it uses the SAM flags, position and CIGAR string to anchor each called base to a reference coordinate and encodes the base according to a per-coordinate model. As more and more data aligns to a specific reference coordinate the model improves in accuracy and the data compresses better. If a reference is known it is used to seed the initial model probabilities, otherwise they are seeded based on a low-order consensus context (for example simple GC content observations). Insertions and soft-clipped data use their own additional models.</p>
      <p>This has some distinct advantages over simply encoding differences to a reference. Not requiring a reference avoids the necessity of storing the consensus sequence produced by a de-novo assembler. Given assemblies are typically deep, the model tunes well and the data compresses almost as well as supplying a reference, typically only taking up an extra 2 bits per consensus base. This is equivalent to shipping a compressed copy of the reference with the file. Additionally mapping to a closely related organism instead of the actual reference would generate many more differences. The per-position model will rapidly switch away from the claimed reference to the observed consensus instead, improving compression ratios. A similar gain can be seen when compressing data with systematic base-calling errors.</p>
    </sec>
    <sec id="s3d">
      <title>Samcomp2</title>
      <p>For the competition data set it was found that requiring position sorted data harmed compression of the sequence identifiers, so much so that the benefits of using a model per position were non-existent. Ideally the sequence identifiers would be omitted or replaced with lower complexity strings, but the SequenceSqueeze competition required a strictly lossless approach.</p>
      <p>A second implementation of Samcomp (Samcomp2 v0.2) reads SAM files in any order, permitting the original name-ordered file to be used thus giving highly compressible sequence identifiers. To achieve this in limited memory the per-position model was removed and replaced by a simple reference difference model. The difference model uses a bit history of whether previous bases have been matching as context. Upon a mismatch the base-call itself is encoded, using the reference base as the context. This entry ultimately came top for lossless compression ratio on the SequenceSqueeze test data. However we feel it is not generally as useful as the original Samcomp program as Samcomp2 performs less well on positional sorted data and extremely badly when not supplied a reference.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>We have demonstrated that there is a compression ratio vs speed and memory trade-off. For practical purposes saving the extra remaining few percent of compression is generally not worth it if you can get close to optimal compression in a fraction of the time. This is very apparent in the original SequenceSqueeze results when graphed on compression ratio against time (see Figure S1 in File S1).</p>
    <p>The trade-off will depend on the use case. For long-distance data transfer such as uploading to the cloud, bandwidth is the limiting factor. Here we can compress, transfer and decompress in parallel with the total throughput being governed by the slowest of the three. The software presented here is ideally suitable for this task as the program usage is transitory so long term support is not an issue and additionally the requirement to immediately uncompress means it is easy to perform checksums to validate the transfer. The tools presented here have best-in-class tradeoffs between time and compression ratio such that Fqzcomp performs the best at low bandwidths and the fast mode of Fastqz performs best at high bandwidths.</p>
    <p>The opposite use case is long time archival. The programs used need to be finalized and unchanging so the data can still be accessed years from now. One solution is to archive the programs along with the data, but more weight needs to be given to proven robust technology.</p>
    <p>A final use case is for work-in-progress scenarios, requiring regular random access within a sequencing pipeline. Fqzcomp and Fastqz are only suitable for streaming, although adding random access is one obvious future improvement. However the bioinformatics community does not need yet more file formats. Ideally the existing and emerging formats (BAM, CRAM, cSRA) will incorporate ideas and methods presented here, while keeping their random access strength.</p>
    <p>The rate of exponential growth in sequencing compared to disk technology and network bandwidth shows that any attempt to compress data is simply an interim measure. Compression buys us some time and it will always provide a cost saving, but ultimately the sequencing community will need to start prioritising data sets into those that are costly to produce and/or precious, and those that are cheap to reproduce. We envisage that in time many data sets will be viewed purely as a temporary transition between the raw DNA sample and final analysis, with file formats like VCF becoming a more mainstream end product and likely the topic of future compression research.</p>
    <sec id="s4a">
      <title>Conclusion</title>
      <p>We have shown methods for efficient compression of the three major components of FASTQ files and explained how these can be applied to reference based formats. While not the complete picture of SAM file compression, it is hoped that the techniques presented here may be used to improve existing SAM compressors.</p>
      <p>We strongly believe that the creation of a public leader-board in the SequenceSqueeze competition had a direct and beneficial impact on the quality of all submissions. It was not uncommon for authors to leap-frog existing competitor’s entries, spurring them on to future improvements.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0059190.s001">
      <label>File S1</label>
      <caption>
        <p>
          <bold>Supplementary material.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0059190.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank the Pistoia Alliance for the chance to take part in the competition and Eagle Genomics for hosting the competition web site. We would also like to thank Eugene Shelwien for providing the arithmetic coder used in the Fqzcomp and Samcomp programs along with helpful advice.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0059190-Cochrane1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cochrane</surname><given-names>G</given-names></name>, <name><surname>Cook</surname><given-names>CE</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>The future of dna sequence archiving</article-title>. <source>GigaScience</source>
<volume>1</volume>: <fpage>2</fpage>.<pub-id pub-id-type="pmid">23587147</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Cock1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Cock</surname><given-names>PJA</given-names></name>, <name><surname>Fields</surname><given-names>CJ</given-names></name>, <name><surname>Goto</surname><given-names>N</given-names></name>, <name><surname>Heuer</surname><given-names>ML</given-names></name>, <name><surname>Rice</surname><given-names>PM</given-names></name> (<year>2010</year>) <article-title>The sanger FASTQ format for sequences with quality scores, and the Solexa/fillumina FASTQ variants</article-title>. <source>Nucleic Acids Research</source>
<volume>38</volume>: <fpage>1767</fpage>–<lpage>1771</lpage>.<pub-id pub-id-type="pmid">20015970</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Margulies1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Margulies</surname><given-names>M</given-names></name>, <name><surname>Egholm</surname><given-names>M</given-names></name>, <name><surname>Altman</surname><given-names>WE</given-names></name>, <name><surname>Attiya</surname><given-names>S</given-names></name>, <name><surname>Bader</surname><given-names>JS</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>. <source>Nature</source>
<volume>437</volume>: <fpage>376</fpage>–<lpage>380</lpage>.<pub-id pub-id-type="pmid">16056220</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Pandey1">
      <label>4</label>
      <mixed-citation publication-type="other">Pandey V, Nutter RC, Prediger E (2008) Next-Generation Genome Sequencing, Berlin, Germany: Wiley- VCH, chapter Applied Biosystems SOLiD System: Ligation-Based Sequencing. 29–41.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Bentley1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Bentley</surname><given-names>DR</given-names></name>, <name><surname>Balasubramanian</surname><given-names>S</given-names></name>, <name><surname>Swerdlow</surname><given-names>HP</given-names></name>, <name><surname>Smith</surname><given-names>GP</given-names></name>, <name><surname>Milton</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>. <source>Nature</source>
<volume>456</volume>: <fpage>53</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">18987734</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Cox1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Cox</surname><given-names>AJ</given-names></name>, <name><surname>Bauer</surname><given-names>MJ</given-names></name>, <name><surname>Jakobi</surname><given-names>T</given-names></name>, <name><surname>Rosone</surname><given-names>G</given-names></name> (<year>2012</year>) <article-title>Large-scale compression of genomic sequence databases with the Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>1415</fpage>–<lpage>1419</lpage>.<pub-id pub-id-type="pmid">22556365</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Pinho1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pinho</surname><given-names>AJ</given-names></name>, <name><surname>Pratas</surname><given-names>D</given-names></name>, <name><surname>Garcia</surname><given-names>SP</given-names></name> (<year>2012</year>) <article-title>GReEn: a tool for efficient compression of genome resequencing data</article-title>. <source>Nucleic Acids Research</source>
<volume>40</volume>: <fpage>27</fpage>.<pub-id pub-id-type="pmid">21880591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Asnani1">
      <label>8</label>
      <mixed-citation publication-type="other">Asnani H, Bharadia D, Chowdhury M, Ochoa I, Sharon I, <etal>et al</etal>.. (2012) Lossy compression of quality values via rate distortion theory. arXiv preprint arXiv:12075184.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Wan1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wan</surname><given-names>R</given-names></name>, <name><surname>Anh</surname><given-names>VN</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Transformations for the compression of FASTQ quality scores of next-generation sequencing data</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>628</fpage>–<lpage>635</lpage>.<pub-id pub-id-type="pmid">22171329</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Tembe1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Tembe</surname><given-names>W</given-names></name>, <name><surname>Lowey</surname><given-names>J</given-names></name>, <name><surname>Suh</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>G-SQZ: compact encoding of genomic sequence and quality data</article-title>. <source>Bioin- formatics</source>
<volume>26</volume>: <fpage>2192</fpage>–<lpage>2194</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Kozanitis1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Kozanitis</surname><given-names>C</given-names></name>, <name><surname>Saunders</surname><given-names>C</given-names></name>, <name><surname>Kruglyak</surname><given-names>S</given-names></name>, <name><surname>Bafna</surname><given-names>V</given-names></name>, <name><surname>Varghese</surname><given-names>G</given-names></name> (<year>2010</year>) <article-title>Compressing genomic sequence fragments using SlimGene</article-title>. <source>Journal of Computational Biology</source>
<volume>18</volume>: <fpage>401</fpage>–<lpage>413</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Jeon1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Jeon</surname><given-names>YJ</given-names></name>, <name><surname>Park</surname><given-names>SH</given-names></name>, <name><surname>Ahn</surname><given-names>SM</given-names></name>, <name><surname>Hwang</surname><given-names>HJ</given-names></name> (<year>2011</year>) <article-title>SOLiDzipper: A high speed encoding method for the next-generation sequencing data</article-title>. <source>Evol Bioinform Online</source>
<volume>7</volume>: <fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21487532</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Deorowicz1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Deorowicz</surname><given-names>S</given-names></name>, <name><surname>Grabowski</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>Compression of DNA sequence reads in FASTQ format</article-title>. <source>Bioinformatics</source>
<volume>27</volume>: <fpage>860</fpage>–<lpage>862</lpage>.<pub-id pub-id-type="pmid">21252073</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Jones1">
      <label>14</label>
      <mixed-citation publication-type="other">Jones DC, Ruzzo WL, Peng X, Katze MG (2012) Compression of next-generation sequencing reads aided by highly efficient de novo assembly. Nucleic Acids Research in press.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Hach1">
      <label>15</label>
      <mixed-citation publication-type="other">Hach F, Numanagic I, Alkan C, Sahinalp SC (2012) SCALCE: boosting sequence compression algorithms using locally consistent encoding. Bioinformatics.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Grassi1">
      <label>16</label>
      <mixed-citation publication-type="other">Grassi E (2012) KungFQ: A simple and powerful approach to compress fastq files. IEEE/ACM Transactions on Computational Biology and Bioinformatics in press.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Li1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>
<volume>16</volume>: <fpage>2078</fpage>–<lpage>2079</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Fritz1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Fritz</surname><given-names>MHY</given-names></name>, <name><surname>Leinonen</surname><given-names>R</given-names></name>, <name><surname>Cochrane</surname><given-names>G</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name> (<year>2011</year>) <article-title>Efficient storage of high throughput dna sequencing data using reference-based compression</article-title>. <source>Genome Research</source>
<volume>21</volume>: <fpage>734</fpage>–<lpage>740</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Sakib1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Sakib</surname><given-names>MN</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Zheng</surname><given-names>WJ</given-names></name>, <name><surname>Huang</surname><given-names>CT</given-names></name> (<year>2011</year>) <article-title>Improving transmission efficiency of large Sequence Alignment/Map (SAM) files</article-title>. <source>PLoS ONE</source>
<volume>6</volume>: <fpage>e28251</fpage>.<pub-id pub-id-type="pmid">22164252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Popitsch1">
      <label>20</label>
      <mixed-citation publication-type="other">Popitsch N, von Haeseler A (2012) NGC: lossless and lossy compression of aligned high-throughput sequencing data. Nucl Acids Res.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Giancarlo1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Giancarlo</surname><given-names>R</given-names></name>, <name><surname>Scaturro</surname><given-names>D</given-names></name>, <name><surname>Utro</surname><given-names>F</given-names></name> (<year>2009</year>) <article-title>Textual data compression in computational biology: a synopsis</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1575</fpage>–<lpage>1586</lpage>.<pub-id pub-id-type="pmid">19251772</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Daily1">
      <label>22</label>
      <mixed-citation publication-type="other">Daily K, Rigor P, Christley S, Xie X, Baldi P (2010) Data structures and compression algorithms for high-throughput sequencing technologies. BMC Bioinformatics 11.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Deutsch1">
      <label>23</label>
      <mixed-citation publication-type="other">Deutsch P, Gailly JL (1996) Zlib compressed data format specification version 3.3. RFC 1950. Available: <ext-link ext-link-type="uri" xlink:href="http://www.ietf.org/rfc/rfc1950.txt">http://www.ietf.org/rfc/rfc1950.txt</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Kolmogorov1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Kolmogorov</surname><given-names>A</given-names></name> (<year>1968</year>) <article-title>Logical basis for information theory and probability theory</article-title>. <source>IEEE Transactions on Information Theory</source>
<volume>14</volume>: <fpage>662</fpage>–<lpage>664</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-The1">
      <label>25</label>
      <mixed-citation publication-type="journal"><collab>The 1000 Genomes Consortium</collab> (<year>2010</year>) <article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>
<volume>467</volume>: <fpage>1061</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Ewing1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Ewing</surname><given-names>B</given-names></name>, <name><surname>Green</surname><given-names>P</given-names></name> (<year>1998</year>) <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>. <source>Genome Res</source>
<volume>8</volume>: <fpage>186</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">9521922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Witten1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Witten</surname><given-names>IH</given-names></name>, <name><surname>Neal</surname><given-names>RM</given-names></name>, <name><surname>Cleary</surname><given-names>JG</given-names></name> (<year>1987</year>) <article-title>Arithmetic coding for data compression</article-title>. <source>Commun ACM</source>
<volume>30</volume>: <fpage>520</fpage>–<lpage>540</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Shannon1">
      <label>28</label>
      <mixed-citation publication-type="other">Shannon C, Weaver W (1949) The mathematical theory of communication. Urbana: University of Illinois Press.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Minoche1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Minoche</surname><given-names>AE</given-names></name>, <name><surname>Dohm</surname><given-names>JC</given-names></name>, <name><surname>Himmelbauer</surname><given-names>H</given-names></name> (<year>2011</year>) <article-title>Evaluation of genomic high-throughput sequencing data generated on illumina hiseq and genome analyzer systems</article-title>. <source>Genome Biology</source>
<volume>12</volume>: <fpage>R112</fpage>.<pub-id pub-id-type="pmid">22067484</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Mahoney1">
      <label>30</label>
      <mixed-citation publication-type="other">Mahoney M (2005) Adaptive weighing of context models for lossless data compression. Technical Report CS-2005–16. Available: <ext-link ext-link-type="uri" xlink:href="http://cs.fit.edu/~mmahoney/compression/cs200516.pdf">http://cs.fit.edu/~mmahoney/compression/cs200516.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Ziv1">
      <label>31</label>
      <mixed-citation publication-type="other">Ziv J, Lempel A (1978) Compression of individual sequences via variable-rate coding. IEEE Transactions on information theory IT-24.</mixed-citation>
    </ref>
    <ref id="pone.0059190-Li2">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0059190-Langmead1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name> (<year>2010</year>) <article-title>Aligning short sequencing reads with bowtie</article-title>. <source>Current Protocols in Bioinformatics</source>
<volume>32</volume>: <fpage>11.7.1</fpage>–<lpage>11.7.14</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
