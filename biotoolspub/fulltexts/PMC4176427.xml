<?properties open_access?>
<?subarticle report8632?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4176427</article-id>
    <article-id pub-id-type="pmid">25285208</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.4680.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>shinyMethyl: interactive quality control of Illumina 450k DNA methylation arrays in R</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>v2; ref status: indexed</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fortin</surname>
          <given-names>Jean-Philippe</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fertig</surname>
          <given-names>Elana</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hansen</surname>
          <given-names>Kasper</given-names>
        </name>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health, Baltimore, MD, 21205, USA</aff>
      <aff id="a2"><label>2</label>Department of Oncology, Sidney Kimmel Cancer Center, Johns Hopkins School of Medicine, Baltimore, MD, 21205, USA</aff>
      <aff id="a3"><label>3</label>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins School of Medicine, Baltimore, MD, 21205, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:jfortin@jhsph.edu">jfortin@jhsph.edu</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email xlink:href="mailto:khansen@jhsph.edu">khansen@jhsph.edu</email>
      </corresp>
      <fn fn-type="con">
        <p>JFP conceived and developed the shinyMethyl package, supervised by EJF and KDH. All authors wrote and approved the final manuscript.</p>
      </fn>
      <fn fn-type="conflict">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>3</volume>
    <elocation-id>175</elocation-id>
    <history>
      <date date-type="accepted">
        <day>17</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2014 Fortin JP et al.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
      <license license-type="open-access" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
        <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-3-5691.pdf"/>
    <abstract>
      <p>We present shinyMethyl, a Bioconductor package for interactive quality control of DNA methylation data from Illumina 450k arrays. The package summarizes 450k experiments into small exportable R objects from which an interactive interface is launched. Reactive plots allow fast and intuitive quality control assessment of the samples. In addition, exploration of the phenotypic associations is possible through coloring and principal component analysis. Altogether, the package makes it easy to perform quality assessment of large-scale methylation datasets, such as epigenome-wide association studies or the datasets available through The Cancer Genome Atlas portal. The shinyMethyl package is implemented in R and available via Bioconductor. Its development repository is at https://github.com/jfortin1/shinyMethyl.</p>
    </abstract>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Natural Sciences and Engineering Research Council of Canada</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>les Fonds de recherche Nature et technologies du Québec</funding-source>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Johns Hopkins Head and Neck Cancer SPORE</funding-source>
      </award-group>
      <funding-statement>JFP was partially supported by the Natural Sciences and Engineering Research Council of Canada and by les Fonds de recherche Nature et technologies du Québec as well as under the Johns Hopkins Head and Neck Cancer SPORE awarded to EJF.</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec>
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>A sentence was added to "software access" to mention the free demo deployment of the package hosted at spark.rstudio.com, as per referee request.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The recent release of the R package
<italic>shiny</italic>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> has substantially lowered the barriers to interactive visualization in R, opening the door to interactive exploration of high-dimensional genomic data.</p>
    <p>DNA methylation is an epigenetic mark, and changes in DNA methylation have been associated with various diseases, such as cancer
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. For DNA methylation data, thousands of samples from the state-of-the-art Illumina 450k methylation array
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup> have been generated and are accessible online from The Cancer Genome Atlas (TCGA) and through the Gene Expression Omnibus (GEO). This array has a series of probes used to measure a methylation and an unmethylation signal for a series of loci. Probes are designed using two main chemistries resulting in a challenging array design, essentially a mix of a two color and a one color array discussed in Bibikova
<italic>et al.</italic>
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>. Analysis of data from this array requires careful quality control and pre-processing that account for these distinct chemistries. The assessment of these steps could benefit from an interactive visualization tool.</p>
    <p>Our solution is
<italic>shinyMethyl</italic>, an interactive visualization package for 450k arrays, based on the packages
<italic>minfi</italic>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> and
<italic>shiny</italic>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. The goal of shinyMethyl is two-fold; (1) to help with quality assessment and (2) to help with assessing the effect of pre-processing. We use pre-computation to enable interactive visualization of thousands of samples to circumvent computational bottlenecks during data exploration. The pre-computation can happen on a large computing server and the resulting data object can be used for interactive visualization on a laptop. Quality control and pre-processing large 450k datasets become easy and intuitive with
<italic>shinyMethyl</italic>.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>shinyMethyl workflow</title>
      <p>The first step of
<italic>shinyMethyl</italic> is pre-computation of various summaries of the 450k array data, using the function
<monospace>shinySummarize</monospace>. This pre-computation is run on raw (not pre-processed) data and – optionally – pre-processed data, resulting in either one or two summary objects, as described below. These summary objects, called
<monospace>shinyMethylSet</monospace>, are saved in a platform-independent format. The interactive interface is then launched via the function
<monospace>runShinyMethyl</monospace>. The function requires a
<monospace>shinyMethylSet</monospace> containing the summary data from the raw data. In addition, the function accepts as a second argument a
<monospace>shinyMethylSet</monospace> that contains summaries from pre-processed data, in which case both raw and pre-processed data will be displayed in the interactive interface.
<xref ref-type="fig" rid="f1">Figure 1</xref> illustrates the
<italic>shinyMethyl</italic> workflow.</p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="float">
        <label>Figure 1. </label>
        <caption>
          <title>The workflow of
<italic>shinyMethyl</italic>.</title>
          <p>IDAT files are parsed using
<italic>minfi</italic> and
<italic>illuminaio</italic> into a
<monospace>RGChannelSet</monospace>. This object is summarized using
<monospace>shinySummarize</monospace>. Optionally, the data are pre-processed and the pre-processed data are summarized. For visualization,
<monospace>runShinyMethyl</monospace> is used on either one or two sets of summarized data.</p>
        </caption>
        <graphic xlink:href="f1000research-3-5691-g0000"/>
      </fig>
    </sec>
    <sec>
      <title>Raw data summarization</title>
      <p>Summarizing the raw data uses the
<italic>minfi</italic>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> and
<italic>illuminaio</italic>
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> R packages to parse Illumina IDAT files into a
<italic>minfi</italic> object called
<monospace>RGChannelSet</monospace>.
<monospace>shinySummarize</monospace> operates on this
<monospace>RGChannelSet</monospace> and the summarization object created by this function is 35x smaller than the full data representation in
<italic>minfi</italic>; 1,000 samples use 205 MB. Specifically, the summarized data contain the quantile distributions of the raw intensities for the unmethylated (U) and methylated (M) channels, copy numbers (CN = M + U), Beta values (Beta) and M values (M-Val). The object contains also the raw control probes intensities and the results of the principal component analysis performed on the autosomal Beta values. The function also extracts the phenotype variables stored in the
<monospace>RGChannelSet</monospace>. The summarization is done separately by probe types (I and II, see Bibikova
<italic>et al.</italic>
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>) and for sex chromosomes. An S4 class, called
<monospace>shinyMethylSet</monospace>, is used to represent the data in R, and this object is independent of the operating system. The
<italic>shinyMethyl</italic> interface is launched by passing the
<monospace>shinyMethylSet</monospace> to the function
<monospace>runShinyMethyl</monospace>. An example of the interface is shown in
<xref ref-type="fig" rid="f2">Figure 2</xref>.</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="float">
        <label>Figure 2. </label>
        <caption>
          <title>The shinyMethyl user interface for quality control.</title>
          <p>The interface shows an example interactive visualization of batch effects and quality control (TCGA head and neck squamous cell carcinoma, HNSCC dataset). The interface is divided into a user menu and a plotting area. (
<bold>a</bold>) A menu containing a number of user-settable visualization parameters. The “phenotype” is set to “plate” which makes the color scheme reflect batch. The four plots (
<bold>b</bold>–
<bold>e</bold>) are interactive and react simultaneously to the user mouse clicks, so that samples selected on one plot are immediately highlighted on the additional plots. The solid lines in black represents the sample(s) currently selected by the user and match the dot circled in black on (
<bold>b</bold>,
<bold>c</bold>). The dashed lines in black represents another sample, previously selected by the user and match the black dot without the circle. (
<bold>b</bold>) Average negative control probes intensities; (
<bold>c</bold>) the median intensity of the M channel against the median intensity of the U channel; (
<bold>d</bold>–
<bold>e</bold>) M-value densities for Infinium I probes before and after functional normalization.</p>
        </caption>
        <graphic xlink:href="f1000research-3-5691-g0001"/>
      </fig>
    </sec>
    <sec>
      <title>Pre-processed data summarization (optional)</title>
      <p>Summarizing pre-processed data in
<italic>shinyMethyl</italic> operates on an S4 object in
<italic>minfi</italic> termed
<monospace>GenomicRatioSet</monospace>. The summaries of the pre-process data are stored in an additional
<monospace>shinyMethylSet</monospace>. Again, the summarized data object is substantially smaller than the full data representation in
<italic>minfi</italic>. If this
<monospace>shinyMethylSet</monospace> is also included in the
<monospace>runShinyMethyl</monospace> command, the summaries of the pre-processed data are automatically added to the
<italic>shinyMethyl</italic> interface. This option represents a powerful diagnostic tool to assess the global performance of a normalization method, such as plate effect correction (
<xref ref-type="fig" rid="f2">Figure 2</xref>), or preservation of the expected biological differences between different tissues or conditions (
<xref ref-type="fig" rid="f3">Figure 3</xref>).</p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="float">
        <label>Figure 3. </label>
        <caption>
          <title>Visualization of cancer/normal differences in the TCGA dataset, before and after normalization.</title>
          <p>In the first two plots are shown the densities of the M-values for Type I green probes before (
<bold>a</bold>) and after (
<bold>b</bold>) functional normalization as presented in the shinyMethyl interactive interface. Green and blue densities represent tumor and normal samples respectively, and red densities represent 9 technical replicates of a control cell line. The last two plots show the average density for each sample group before and after normalization. Functional normalization preserves the expected marginal differences between normal and cancer, while reducing the variation between the technical controls (red lines).</p>
        </caption>
        <graphic xlink:href="f1000research-3-5691-g0002"/>
      </fig>
    </sec>
    <sec>
      <title>Quality control assessment </title>
      <p>Once the DNA methylation data have been summarized,
<italic>shinyMethyl</italic> offers three interactive plots for quality control. These plots react conjointly to the user mouse: (1) a density plot of the M/Beta values, (2) a QC plot proposed in
<italic>minfi</italic> and (3) a plot of control probes intensities. The samples are colored by a phenotype variable selected by the user. The three plots together allow the user to select aberrant samples, whose array identifiers are saved into a csv file for exclusion in subsequent analyses (outside of
<italic>shinyMethyl</italic>). An example of quality control panel is presented in
<xref ref-type="fig" rid="f2">Figure 2</xref> in which summaries from the TCGA head and neck squamous cell carcinoma (HNSCC) samples are colored by batch;
<italic>shinyMethyl</italic> allows to observe significant batch effects, a source of obscure variation that has critical consequences in downstream analysis
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>.</p>
    </sec>
    <sec>
      <title>Sex prediction</title>
      <p>The sex of the samples can be accurately predicted by using the intensities of the probes mapping to the sex chromosomes in the M and U channels
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>.
<italic>shinyMethyl</italic> implements this prediction algorithm and allows the user to interactively specify a cutoff to cluster samples by sex.</p>
      <p>The array identifiers of the samples for which the predicted sex does not agree with the user-provided sex phenotype are displayed within the interface and can be saved into a csv file for further analysis. From the HNSCC TCGA dataset (described in Example data), one sample shows discrepancy, indicating possible mislabeling (
<xref ref-type="fig" rid="f4">Figure 4</xref>).</p>
      <fig fig-type="figure" id="f4" orientation="portrait" position="float">
        <label>Figure 4. </label>
        <caption>
          <title>Sex prediction interface.</title>
          <p>The difference of the median copy number intensity for the Y chromosome and the median copy number intensity for the X chromosome can be used to separate males and females. In
<bold>a</bold>), the user can select the vertical cutoff (dashed line) manually with the mouse to separate the two clusters (orange for females, blue for males). Corresponding Beta-value densities appear in
<bold>b</bold>) for further validation. The predicted sex can be downloaded in a csv file in
<bold>c</bold>), and samples for which the predicted sex differs from the sex provided in the phenotype will appear in
<bold>d</bold>).</p>
        </caption>
        <graphic xlink:href="f1000research-3-5691-g0003"/>
      </fig>
    </sec>
    <sec>
      <title>PCA analysis and design confounding</title>
      <p><italic>shinyMethyl</italic> also performs a principal component analysis (PCA) on the 20,000 most variable autosomal probes. This analysis enables the observation of associations between phenotype and methylation levels. An additional panel displays the physical arrays colored by phenotype. This coloring allows the user to discern potential confounding between phenotype and study design.</p>
    </sec>
    <sec>
      <title>Example data</title>
      <p>The data package
<italic>shinyMethylData</italic> contains the summarized data for 369 HNSCC cancer samples from TCGA. It is available from the Bioconductor project (
<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link>). All analyses were performed on raw IDAT intensity files available from Level I data in the TCGA Data Portal (
<ext-link ext-link-type="uri" xlink:href="https://tcga-data.nci.nih.gov/tcga">https://tcga-data.nci.nih.gov/tcga</ext-link>). Both raw intensities and normalized methylation values obtained by functional normalization using control probes and a slide covariate
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> are included. The
<monospace>shinyMethylSet</monospace> objects containing respectively the raw and normalized data can be accessed by
<monospace>summary.tcga.raw</monospace> and
<monospace>summmary.tcga.norm</monospace>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p><italic>shinyMethyl</italic> makes the quality control and pre-processing of 450k methylation array data fast and intuitive through an interactive application in R. We also show, by example, how to use
<italic>shiny</italic> to develop interactive visualization interfaces. Our example will facilitate future developments of interactive visualization tools for the processing of high-dimensional genomic data in subsequent Bioconductor
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> packages.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <sec>
      <title>Software access</title>
      <p><italic>shinyMethyl</italic> is an R package available from the Bioconductor project (
<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link>). A demo deployment of the software is available at
<ext-link ext-link-type="uri" xlink:href="http://spark.rstudio.com/jfortin/shinyMethyl">http://spark.rstudio.com/jfortin/shinyMethyl</ext-link>; we caution that this free hosting of the package at times appear much slower than a local installation.</p>
    </sec>
    <sec>
      <title>Latest source code</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/jfortin1/shinyMethyl">https://github.com/jfortin1/shinyMethyl</ext-link>
      </p>
    </sec>
    <sec>
      <title>Source code as at the time of publication</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/F1000Research/shinyMethyl/releases/tag/v1.0">https://github.com/F1000Research/shinyMethyl/releases/tag/v1.0</ext-link>
      </p>
    </sec>
    <sec>
      <title>Archived source code as at the time of publication</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.10748">http://dx.doi.org/10.5281/zenodo.10748</ext-link>
        <sup>
          <xref rid="ref-10" ref-type="bibr">10</xref>
        </sup>
      </p>
    </sec>
    <sec>
      <title>Software license</title>
      <p>Artistic-2.0</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="book"><collab>R Studio and Inc</collab>.
<article-title>shiny: Web Application Framework for R</article-title>. R package version 0.10.0.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/shiny/shiny.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feinberg</surname><given-names>AP</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name></person-group>:
<article-title>Hypomethylation distinguishes genes of some human cancers from their normal counterparts.</article-title><source><italic>Nature.</italic></source><year>1983</year>;<volume>301</volume>(<issue>5895</issue>):<fpage>89</fpage>–<lpage>92</lpage>.
<pub-id pub-id-type="doi">10.1038/301089a0</pub-id><?supplied-pmid 6185846?><pub-id pub-id-type="pmid">6185846</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bibikova</surname><given-names>M</given-names></name><name><surname>Barnes</surname><given-names>B</given-names></name><name><surname>Tsan</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>High density DNA methylation array with single CpG site resolution.</article-title><source><italic>Genomics.</italic></source><year>2011</year>;<volume>98</volume>(<issue>4</issue>):<fpage>288</fpage>–<lpage>95</lpage>.
<pub-id pub-id-type="doi">10.1016/j.ygeno.2011.07.007</pub-id><?supplied-pmid 21839163?><pub-id pub-id-type="pmid">21839163</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aryee</surname><given-names>MJ</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Corrada-Bravo</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>Minfi: A flexible and comprehensive Bioconductor package for the analysis of Infinium DNA Methylation microarrays.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>10</issue>):<fpage>1363</fpage>–<lpage>1369</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu049</pub-id><!--<pub-id pub-id-type="pmcid">4016708</pub-id>--><?supplied-pmid 24478339?><pub-id pub-id-type="pmid">24478339</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>ML</given-names></name><name><surname> Baggerly</surname><given-names>KA</given-names></name><name><surname>Bengtsson</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>illuminaio: An open source IDAT parsing tool for Illumina microarrays.</article-title><source><italic>F1000Res.</italic></source><year>2013</year>;<volume>2</volume>:<fpage>264</fpage>.
<pub-id pub-id-type="doi">10.12688/f1000research.2-264.v1</pub-id><!--<pub-id pub-id-type="pmcid">3968891</pub-id>--><?supplied-pmid 24701342?><pub-id pub-id-type="pmid">24701342</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Scharpf</surname><given-names>RB</given-names></name><name><surname>Bravo</surname><given-names>HC</given-names></name><etal/></person-group>:
<article-title>Tackling the widespread and critical impact of batch effects in high-throughput data.</article-title><source><italic>Nat Rev Genet</italic></source><year>2010</year>;<volume>11</volume>(<issue>10</issue>):<fpage>733</fpage>–<lpage>739</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2825</pub-id><!--<pub-id pub-id-type="pmcid">3880143</pub-id>--><?supplied-pmid 20838408?><pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fortin</surname><given-names>JP</given-names></name><name><surname>Labbe</surname><given-names>A</given-names></name><name><surname>Lemire</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Functional normalization of 450k methylation array data improves replication in large cancer studies.</article-title><source><italic>bioRxiv.</italic></source><year>2014</year><pub-id pub-id-type="doi">10.1101/002956</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Bates</surname><given-names>DM</given-names></name><etal/></person-group>:
<article-title>Bioconductor: open software development for computational biology and bioinformatics.</article-title><source><italic>Genome Biol.</italic></source><year>2004</year>;<volume>5</volume>(<issue>10</issue>):<fpage>R80</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id><!--<pub-id pub-id-type="pmcid">545600</pub-id>--><?supplied-pmid 15461798?><pub-id pub-id-type="pmid">15461798</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feinberg</surname><given-names>AP</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name></person-group>:
<article-title>Hypomethylation distinguishes genes of some human cancers from their normal counterparts.</article-title><source><italic>Nature.</italic></source><year>1983</year>;<volume>301</volume>(<issue>5895</issue>):<fpage>89</fpage>–<lpage>92</lpage>.
<pub-id pub-id-type="doi">10.1038/301089a0</pub-id><?supplied-pmid 6185846?><pub-id pub-id-type="pmid">6185846</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Fortin</surname><given-names>JP</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name></person-group>:
<article-title>F1000Research/shinyMhethyl.</article-title><source><italic>ZENODO.</italic></source><year>2014</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.10748">Data Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report8632" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.5691.r8632</article-id>
    <title-group>
      <article-title>Referee response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Triche</surname>
          <given-names>Timothy</given-names>
        </name>
        <xref ref-type="aff" rid="r8632a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r8632a1"><label>1</label>Center for Personalized Medicine, University of Southern California, Los Angeles, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="conflict">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <related-article id="d35e1016" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4680.2">Version </related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors proved to be correct in that Rstudio has "transitioned" their spark server to a subscription model for shiny hosting. Perhaps my request was unwarranted. The software itself behaves as advertised and is an efficient tool for quality control of these arrays.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report5620" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.5001.r5620</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Morris</surname>
          <given-names>Tiffany</given-names>
        </name>
        <xref ref-type="aff" rid="r5620a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r5620a1"><label>1</label>UCL Cancer Institute, University College London, London, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="conflict">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <related-article id="d35e1064" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4680.1">Version </related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This manuscript written by Fortin
<italic>et al.</italic> presents an R package to assess the quality control of 450k methylation array data through an interactive interface. A unique aspect of
<italic>shinyMethyl</italic> is the use of the shiny package to allow the interactive visualisation.
<italic>shinyMethyl</italic> is easy to use and therefore suitable for a novice data analyst with limited programming experience and also experienced bioinformaticians that would like to quickly assess large datasets. Additionally the package utilises the established and widely used R package
<italic>minfi</italic> for the data analysis.</p>
    <p><italic>shinyMethyl</italic> is available for download from Bioconductor or github. In this manuscript, the authors clearly describe the use of the package through a workflow and various screenshots and plots. They discuss the example dataset that is available through TCGA. Data interpretation is only explained briefly as the purpose of this manuscript is to present the interface.  In depth background information on analysis methods (terminology, normalisations etc) and details of data interpretation can be found in the
<italic>minfi</italic> publication or the Bioconductor vignette.</p>
    <p>The package does require the raw IDAT files. Some publicly available datasets may not provide this information and therefore
<italic>shinyMethyl </italic>would not be applicable. However, it is becoming mainstream to provide this data and with more packages utilising this raw data it is expected that investigators make it available. </p>
    <p>The authors have clearly presented their package that is well designed, easy to use and a useful addition to the options for 450k data analysis especially as it is the platform of choice for large epigenome-wide association studies.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment981" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>Kasper</given-names>
          </name>
          <aff>khansen@jhsph.edu, USA</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="conflict">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>15</day>
        <month>9</month>
        <year>2014</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you very much for taking the time to review our work and for the kind referee report.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report5619" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.5001.r5619</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Triche</surname>
          <given-names>Timothy</given-names>
        </name>
        <xref ref-type="aff" rid="r5619a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r5619a1"><label>1</label>Center for Personalized Medicine, University of Southern California, Los Angeles, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="conflict">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <related-article id="d35e1167" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4680.1">Version </related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The title of the report is entirely appropriate. </p>
    <p>The abstract would benefit from mention of the interactive demo on spark.rstudio.com, as the interface is trivially easy to grasp while performing the various quality control checks.  </p>
    <p>The methods not directly treated in this report (functional normalization, Shiny internals, 450k chip design) have been discussed elsewhere at length.The discussion of design and implementation decisions for shinyMethyl is sufficient (again an interactive/exploratory session will provide the interested user with most if not all of the same information). </p>
    <p>The conclusion (shinyMethyl eases 450k quality control for large datasets with potential technical artifacts) is justified in the report, the included example for the package, and the interactive demo hosted by Rstudio.</p>
    <p>The data for the example are available as raw binary IDAT files from the TCGA data portal; reproducibility via minfi is trivial, provided the user has sufficient compute resources to process and normalize a large dataset. (In my experience, datasets of 1000+ samples can be read with illuminaio and normalized via funnorm() on a typical Linux server with 48-64GB of RAM) </p>
    <p>This report serves a useful purpose (beyond the announcement of the software) by providing a usable baseline for 450k quality control. Epigenome-wide association studies are prone to a staggering number of potential confounding factors, not least of which are technical and experimental design artifacts. Investigators who have an interest in reproducible conduct of such studies now have further incentive to use and deposit raw binary IDAT files for their experiments. Investigators who choose not to do so may be viewed with skepticism, especially when the data has been processed for analysis via minfi (or, for that matter, methylumi), and verification of straightforward quality controls is made simpler by the interactive shinyMethyl package.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment982" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>Kasper</given-names>
          </name>
          <aff>khansen@jhsph.edu, USA</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="conflict">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>15</day>
        <month>9</month>
        <year>2014</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank the referee for taking the time to review our work, and thank for the kind review.</p>
      <p>We have submitted a revision with an added sentence about the demo at spark.rstudio.com under "Software access", but caution that this website at times is slow to respond to input. This is a hosting service freely available to the community.</p>
    </body>
  </sub-article>
</sub-article>
