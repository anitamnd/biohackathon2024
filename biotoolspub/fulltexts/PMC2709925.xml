<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2709925</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-175</article-id>
    <article-id pub-id-type="pmid">19508732</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-175</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Local alignment of two-base encoded DNA sequence</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>nhomer@cs.ucla.edu</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Merriman</surname>
          <given-names>Barry</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>barrym@ucla.edu</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Nelson</surname>
          <given-names>Stanley F</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>snelson@ucla.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Computer Science, University of California Los Angeles, Los Angeles, California 90095, USA</aff>
    <aff id="I2"><label>2</label>Department of Human Genetics, David Geffen School of Medicine, University of California Los Angeles, Los Angeles, California 90095, USA</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>175</fpage>
    <lpage>175</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/175"/>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>2</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Homer et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Homer et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Homer
               Nils
               
               
               nhomer@cs.ucla.edu
            </dc:author><dc:title>
            Local alignment of two-base encoded DNA sequence
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 175-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;175&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>DNA sequence comparison is based on optimal local alignment of two sequences using a similarity score. However, some new DNA sequencing technologies do not directly measure the base sequence, but rather an encoded form, such as the two-base encoding considered here. In order to compare such data to a reference sequence, the data must be decoded into sequence. The decoding is deterministic, but the possibility of measurement errors requires searching among all possible error modes and resulting alignments to achieve an optimal balance of fewer errors versus greater sequence similarity.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present an extension of the standard dynamic programming method for local alignment, which simultaneously decodes the data and performs the alignment, maximizing a similarity score based on a weighted combination of errors and edits, and allowing an affine gap penalty. We also present simulations that demonstrate the performance characteristics of our two base encoded alignment method and contrast those with standard DNA sequence alignment under the same conditions.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The new local alignment algorithm for two-base encoded data has substantial power to properly detect and correct measurement errors while identifying underlying sequence variants, and facilitating genome re-sequencing efforts based on this form of sequence data.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>DNA sequence comparison is a common problem in biology. In this problem, we wish to measure the similarity of two sequences of DNA. Hamming distance [<xref ref-type="bibr" rid="B1">1</xref>] can be used to quantify similarity but forces the two sequences to be of the same length. More generally, the idea of a weighted edit distance can be applied, which allows for base changes, insertions and deletions [<xref ref-type="bibr" rid="B2">2</xref>], with weights chosen to reflect their likelihood of occurrence. Given some set of operators that can modify a sequence, we wish to find the set of edit operators that transforms one sequence into a (sub)sequence of the other by maximizing a similarity score. This problem can be solved by a dynamic programming algorithm, which was first described in 1970 [<xref ref-type="bibr" rid="B3">3</xref>]. This led to the Smith-Waterman algorithm [<xref ref-type="bibr" rid="B4">4</xref>] that has been a critical component of local sequence alignment. Affine gap penalties were subsequently introduced, whereby in practice the per-base average penalty decreases, but the overall penalty increases with longer length[<xref ref-type="bibr" rid="B5">5</xref>]. This algorithm has a known O(<italic>nm</italic>) running time and O(min(<italic>n</italic>, <italic>m</italic>)) space requirements, for both finding a maximum similarity score and finding a transformation that achieves the maximum similarity score, where <italic>n </italic>and <italic>m </italic>are the lengths of the two sequences to be compared [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. The resulting algorithm has become the standard for DNA sequence comparison [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>].</p>
    <p>Sequence comparison has an important application to re-sequencing, whereby a DNA sequence that is observed may differ from a reference due to biological events or measurement errors. We wish to find the maximum similarity score between the observed sequence and a substring of the reference sequence. This is referred to as local sequence alignment and is typically a final finishing step in a two-stage search process found in many current sequence alignment tools [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B15">15</xref>] (Homer N, Merriman B, Nelson SF: BFAST: the BLAT-like Fast Accurate Search Tool for Large-Scale Genome Resequencing, submitted) that support alignment of a short sequence to an entire genome. Among the 'next-generation' DNA sequencing technologies that produce millions to billions of short sequence reads, there is one (the SOLiD™ platform [<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B18">18</xref>]) that does not observe each DNA base (A, C, G, or T) individually, but measures successive sequential pairs, with the 16 possibilities encoded degenerately in groups of four, using four "color" codes (see Figure <xref ref-type="fig" rid="F1">1</xref> for details). The resulting two-base encoded form of data is referred to as color space sequence data, to distinguish this from the decoded base space sequence data[<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. For example, a 50-base DNA sequence would be encoded as 49 sequential two-base measurements, each of which is one of four states (colors). Given the first base of the sequence as a boundary condition (which in practice is the known last base of the sequencing primer), the chosen encoding allows for the bases to be sequentially decoded, moving from first to last, in a fully deterministic manner. While the actual two-base encoding used has a number of interesting and useful algebraic properties [<xref ref-type="bibr" rid="B17">17</xref>], the most important properties are that a single base change to the DNA base sequence results in two adjacent color changes in the color space sequence, and that an isolated error in color space will cause all subsequent bases to be altered in the decoding. The result is that isolated measurement errors and real variants have distinguishable signatures that in principle provide some ability to perform error detection and correction. In particular, two specific adjacent measurement errors are required to produce a single base change error in the decoded sequence, so that the base calling error rate could be reduced to the square of the intrinsic measurement error rate (which is ~1%–10%), if the encoding properties can be fully exploited when comparing the color space reads to a reference DNA sequence.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>The function Φ</bold>. Φ is a function that encodes two bases as a color. Each color is represented by a number ∈ {0, 1, 2, 3}.</p>
      </caption>
      <graphic xlink:href="1471-2105-10-175-5"/>
    </fig>
    <p>In a typical re-sequencing experiment using next-generation sequencing technology, millions of short sequence "reads", 20–100 bases in length, must be aligned to a large reference genome, such as the human genome. This demands an initial search space reduction step [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B20">20</xref>] (Homer N, Merriman B, Nelson SF: BFAST: the BLAT-like Fast Accurate Search Tool for Large-Scale Genome Resequencing, submitted) prior to performing the more expensive optimal local alignment. This first step typically involves some form of indexed look-up or hashing of the full genome or reads, so that a small number of candidate alignment locations are quickly obtained for each read, in a way that is tolerant of the read containing errors or real variants relative to the reference. The optimal local alignments are then used to select which of these candidates is the true location, as well as to identify the differences from the reference sequence at that location. In the case of color space data, the look-up phase can be performed entirely in color space, using the color-space encoded form of the reference genome to find candidate locations for each color space read. The optimal alignment algorithm described here would then be used as the finishing step, which simultaneously decodes, identifies color (measurement) errors, and optimally aligns resulting DNA sequence to a short candidate segment of the reference sequence, typically 100–1000 bases in length (to allow for insertions and deletions in the read).</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Power of two-base encoding</title>
      <p>We performed simulations to evaluate the power of our proposed algorithm to align sequences with two-base encoding compared to the local alignment without two-base encoding (see Methods for details). We model errors as base substitutions when the sequence is not encoded and model errors as color substitutions (encoding errors) when the sequence is encoded in color space. In Figure <xref ref-type="fig" rid="F2">2</xref>, we demonstrate that for sequences with increasing error rates, aligning with two-base encoding is nearly equal to (for longer reads) or more powerful than (for shorter reads) aligning without two-base encoding. Nevertheless, if we examine base substitutions in the presence of error (Figure <xref ref-type="fig" rid="F3">3</xref>), the current algorithm is unable to properly align sequences with an increasing number of base substitutions in the presence of a small number of random errors. The scenario where there are many base substitutions that are not errors (in this case Single Nucleotide Polymorphisms or SNPs) is rare, especially in the human genome[<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>], and therefore this behavior is tolerable. In Figures <xref ref-type="fig" rid="F4">4</xref> and <xref ref-type="fig" rid="F5">5</xref> we see the power to detect deletions and insertions with an increasing number of errors. For a contiguous deletion the power to align such sequences is equal or greater with two-base encoding, except in the case of a one base deletion with no errors where the power is slightly reduced. For a contiguous insertion, the case is more ambiguous. As expected with greater error (≥ 5 errors), the two-base encoding becomes more powerful. Nevertheless, for a small amount of error, the two-base encoding has lower power to align longer contiguous insertions. In this case, over-correction can occur, whereby we align with too many color substitutions rather than the contiguous insertion. This may be mediated by decreasing the penalty for extending an insertion or deletion, although this may reduce the accuracy for high-error sequences without insertions or deletions.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Power evaluation for sequences with errors</bold>. We assess the power to align sequences with and without two-base encoding in the presence of a per-base or per-color error rate respectively.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-175-1"/>
      </fig>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Power evaluation for sequences with errors and base substitutions</bold>. We assess the power to align sequences with and without two-base encoding in the presence of errors and base substitutions.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-175-2"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Power evaluation for sequences with errors and a contiguous deletion</bold>. We assess the power to align sequences with and without two-base encoding in the presence of errors and a contiguous deletion.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-175-3"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Power evaluation for sequences with errors and a contiguous insertion</bold>. We assess the power to align sequences with and without two-base encoding in the presence of errors and a contiguous insertion.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-175-4"/>
      </fig>
    </sec>
    <sec>
      <title>Performance of two-base encoding</title>
      <p>We performed simulations to evaluate the performance of the current algorithm compared to the local alignment without two-base encoding (see Methods for details). We found that for length 25 and 50 color space sequences our algorithm was 36 and 28 times slower, respectively, than the standard Dynamic Programming algorithm applied to base space sequence. Although the algorithmic complexity as a function of read length and reference length is not increased, the absolute number of operations does increase (see Methods), and thus we observe a decrease in the speed performance compared to sequences without the two-base encoding. This performance decrease is particularly relevant given that an experimentalist may be required to choose between competing sequencing technologies that do not utilize the two-base encoding scheme and sequencing technologies that do use the two-base encoding scheme. Two base encoding has potentially powerful error correction modes and at the time of this publication is able to generate substantially more data than direct sequencing approaches. Thus, the two base encoding strategy while preferable in some scenarios for base error correction and better performance of alignment does impose a need for increased computational capacity largely due to the local sequence alignment complexity.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Although the power of this algorithm enables accurate alignment of color space sequences with greater error, it is also computationally an order of magnitude more expensive than the standard dynamic programming algorithm applied in sequence space. To partially mitigate this, the performance can be optimized without changing the results by employing some simple search space reduction and greedy search techniques, as follows: first, decode the encoded sequence by the standard deterministic rules and perform an exact string matching search. If an exact match is found, then the algorithm stops. Upon unsuccessful return, we find a lower bound for the optimal similarity for the proposed algorithm by first performing our two-base encoded alignment but without allowing insertion or deletion edits, which substantially reduces the computational cost. Using this lower bound, we then reduce the search space of our full algorithm by omitting the paths where the search parameters that permit detection of insertions or deletions would result in a score below the established lower bound. In this manner, the empirical running time of the algorithm can be improved by approximately 20% (data not shown) while still obtaining the true optimal alignment.</p>
    <p>We note that the general strategy of two-base encoding in color space is possible to apply in more complex formats for error correction. For instance, three or more bases may be encoded by four or more colors. This would further increase the power of discriminating between encoding errors and base substitutions, albeit at a substantial added cost in local alignment performance. In practice these alternate encodings could further reduce false-positives detections when the goal is to find biological variants with next-generation sequencing technology with relatively high measurement error rates. This may be an advantageous strategy, for example, to increase read lengths by accepting noisier color space reads that are correctable after alignment. The current algorithm can be extended to accommodate these generalizations, and in future work we will investigate the detailed performance properties of such hypothetical encodings.</p>
    <p>The present algorithm can be readily extended to include support for the case where sequence data is missing or unavailable, in either the given color-encoded sequence or in the target base space sequence. We introduce a fifth color code to represent an unknown color in encoded sequence, and a fifth base code (traditionally "N") to represent an unknown base in the decoded or target sequence. To incorporate an unknown encoding color we modify the color substitution function Π to include a score for this fifth unknown color and any other color. To incorporate an unknown base in the target, we modify the base substitution function Δ to include a score for the unknown base and any other base. Also a simple modification to the initialization step in the algorithm is required if the start base <italic>p </italic>is not known. While we do not rely on quality values for each color read, however it is possible to incorporate into the current alignment algorithm quality values that represent the certainty of color calling similar to sequence calling with Phred scores [<xref ref-type="bibr" rid="B23">23</xref>-<xref ref-type="bibr" rid="B26">26</xref>] by weighting the color substitution function Π.</p>
    <p>Finally, Figures <xref ref-type="fig" rid="F2">2</xref>, <xref ref-type="fig" rid="F3">3</xref>, <xref ref-type="fig" rid="F4">4</xref>, and <xref ref-type="fig" rid="F5">5</xref> demonstrate the power to correctly align two-base encoded sequences in the presence of a large number of color errors. Depending on the distribution of sequences with a given number of errors, two-base encoding and this algorithm may make it feasible to accept higher error sequences generated by next-generation sequencing technology, improving both throughput and cost-effectiveness. Additionally, we place a constraint on our scoring functions, making a conscious choice to prefer a base substitution to two adjacent color substitutions that would cause that base to match the reference. This is by no means the only constraint available, but serves to help define the trade-off in power to detect errors over biological variants. In these practically important but ambiguous cases, a decision must be made over which scenario to prefer, and in practice this ambiguity can be overcome by using coverage where multiple sequences observe the same event.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>DNA sequence alignment algorithms have been thoroughly studied in molecular biology, resulting in well-developed Dynamic Programming algorithms that optimize an edit distance to find optimal alignments between two sequences. However, there is a resurgence of interest in sequence alignment due to large scale re-sequencing efforts made possible by massively parallel sequencing technology. The classical algorithm remains an ideal approach for local alignment of such short-read sequence data, but some sequencing technologies produce reads in encoded form, which must be decoded to obtain standard DNA sequence. We extend the previous class of Dynamic Programming algorithms to allow for errors in the encoding, as well as the usual base substitutions, insertions and deletions. Our algorithm remains O(<italic>nm</italic>) time, where <italic>n </italic>and <italic>m </italic>are the length of the encoded and target sequence respectively. We show in practice that performance is decreased due to the added complexity of considering encoding errors, although this can be somewhat mitigated by standard search optimization. This performance decrease must be kept in mind when comparing the overall computational cost of analyzing various next-generation sequencing technologies. Using this new algorithm, local sequence alignment as well as error detection and correction are performed in a reliable and systematic manner, enabling the direct comparison of encoded DNA sequence reads to a candidate reference DNA sequence. This new algorithm should facilitate the use of two-base encoded data for large-scale re-sequencing projects.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>The Problem</title>
      <p>To solve the DNA sequence comparison problem for encoded sequences, we follow a constructive approach. Given an encoded DNA sequence <italic>c </italic>= <italic>c</italic><sub>1</sub>,..., <italic>c</italic><sub><italic>n</italic></sub>, we wish to maximize the similarity between <italic>c </italic>and some regular DNA sequence <italic>y </italic>= <italic>y</italic><sub>1</sub>,..., <italic>y</italic><sub><italic>m</italic></sub>, with the valid edit operators Σ. In this case the alphabet is {<italic>A, C, G, T</italic>} corresponding to the bases in DNA, and the encoded alphabet is {<italic>0, 1, 2, 3</italic>}. We assume the encoded sequence is composed of a two base encoding, referred to as colors, as well as assume a known start base <italic>p</italic>, which is known in practice [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. The valid edit operators are:</p>
      <p>1. A base substitution, which substitutes one base for another in the encoded sequence after decoding.</p>
      <p>2. An insertion, which inserts a base into the encoded sequence after decoding.</p>
      <p>3. A deletion, which deletes a base from the encoded sequence after decoding.</p>
      <p>4. A color substitution, which substitutes one encoded color for another.</p>
      <p>Operators 1–3 can be applied to base sequence and therefore we assume that all color substitutions are applied to the encoded sequence, then the sequence is decoded to allow the application of operators 1–3. We assign scores to each operator. The function Δ (<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>) that returns the base substitution score for substituting base <italic>B</italic><sub>2 </sub>for base <italic>B</italic><sub>1</sub>. The score ρ is applied for the first insertion or deletion operator used. Any insertion or deletion operator that is applied so that the insertion or deletion is extended has a score <italic>ε</italic>. Therefore, for a length <italic>g</italic>&gt;0 base insertion or deletion, the cost of the entire insertion or deletion is <italic>ρ </italic>+ <italic>ε </italic>(<italic>g</italic>-1) and has an average per-gap cost of (<italic>ρ </italic>+ <italic>ε </italic>(<italic>g</italic>-1))/<italic>g</italic>. In practice, this affine gap penalty is useful to penalize a start of an insertion or deletion more heavily than extending the insertion or deletion. The function Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>) returns the color substitution score for substituting color <italic>C</italic><sub>2 </sub>for color <italic>C</italic><sub>1</sub>. The base and color substitutions functions are both symmetric, and are defined even if <italic>B</italic><sub>1 </sub>= <italic>B</italic><sub>2 </sub>for Δ, or <italic>C</italic><sub>1 </sub>= <italic>C</italic><sub>2 </sub>for Π. To decode an encoded sequence, we define the function Γ(<italic>B</italic>, <italic>C</italic>) that returns the decoded base using the encoded color <italic>C </italic>and the previous base <italic>B </italic>(see Figure <xref ref-type="fig" rid="F6">6</xref>). For example, to decode the encoded sequence <italic>c </italic>= <italic>c</italic><sub>1</sub>,..., <italic>c</italic><sub><italic>n </italic></sub>with a known start base <italic>p</italic>, we iteratively use Γ. The decoded sequence will be <italic>x</italic><sub>1 </sub>= Γ(<italic>p</italic>, <italic>c</italic><sub>1</sub>), <italic>x</italic><sub>2 </sub>= Γ(<italic>x</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>),..., <italic>x</italic><sub><italic>n </italic></sub>= Γ(<italic>x</italic><sub><italic>n</italic>-1</sub>, <italic>c</italic><sub><italic>n</italic></sub>). To encode a sequence, we define the function Φ(<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>) that returns a color using the bases <italic>B</italic><sub>1 </sub>and <italic>B</italic><sub>2</sub>, where <italic>B</italic><sub>1 </sub>occurs before <italic>B</italic><sub>2 </sub>in the sequence (see Figure <xref ref-type="fig" rid="F1">1</xref>). For example, to encode DNA sequence <italic>x </italic>= <italic>x</italic><sub>1</sub>,..., <italic>x</italic><sub><italic>n</italic></sub>, we assume a known start base <italic>p </italic>and iteratively use Φ to encode x. Here we have <italic>c</italic><sub>1 </sub>= Φ(<italic>p</italic>, <italic>x</italic><sub>1</sub>), <italic>c</italic><sub>2 </sub>= Φ(<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>),..., <italic>c</italic><sub><italic>n </italic></sub>= Φ(<italic>x</italic><sub><italic>n</italic>-1</sub>, <italic>x</italic><sub><italic>n</italic></sub>). This encoding function is analogous to the Klein Four Group under addition or the X-OR function when the colors and DNA are represented as binary numbers [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. The function Φ is used to encode the base sequence whereas the function Γ is used to decode the color sequence. To represent the transformation of <italic>x </italic>into <italic>y</italic>, we pair bases in <italic>x </italic>with bases in <italic>y </italic>as well as including dashes to indicate that an insertion or deletion occurred. If <italic>x</italic><sub><italic>i </italic></sub>and <italic>y</italic><sub><italic>j </italic></sub>are matched, then we pair <italic>x</italic><sub><italic>i </italic></sub>and <italic>y</italic><sub><italic>j </italic></sub>and draw: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i1.gif"/></inline-formula>. A deletion of a base in <italic>x </italic>relative to <italic>y </italic>is represented using a dash (-) and the base <italic>y</italic><sub><italic>j</italic></sub>, and is drawn as: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i2.gif"/></inline-formula>. An insertion into <italic>x </italic>relative to <italic>y </italic>is represented using a dash and the base <italic>x</italic><sub><italic>i</italic></sub>, and is drawn as: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i3.gif"/></inline-formula>. For example, for <italic>x </italic>= <italic>GATTACA </italic>and <italic>y </italic>= <italic>GATACA</italic>, a valid alignment may be: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i4.gif"/></inline-formula>. In this example, we apply three base substitution operators, one insertion operator, and then three base substitution operators. The base substitution operators do not change the bases in this example, but are defined for completeness when <italic>x</italic><sub><italic>i </italic></sub>= <italic>y</italic><sub><italic>j</italic></sub>. In this manner, we describe an alignment using the base substitution, insertion and deletion operators. To model encoding errors, we assume a two-base encoding scheme; therefore, the encoding can be visualized by placing the colors in between the bases assuming the starting base is an <italic>A</italic>. For the reference sequence <italic>y</italic>, we place colors of the encoded version of <italic>y </italic>in between the bases of <italic>y</italic>. Let <italic>c' </italic>be the encoded DNA sequence resulting from applying all color substitution operators to <italic>c</italic>. Below we place the colors of the encoded sequence <italic>c' </italic>between the bases of the decoded version of c'. Finally we place the original encoded sequence <italic>c </italic>below <italic>c'</italic>. Given an encoded sequence <italic>c </italic>= <italic>2030311 </italic>and target DNA sequence <italic>y </italic>= <italic>GATACA </italic>a valid alignment may be: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i5.gif"/></inline-formula>. The placement of the color (in <italic>y</italic>) within the insertion (relative to <italic>c</italic>) is arbitrary since it is compared to the composition of the colors within insertion in <italic>c </italic>as will be seen later. In the above alignment, the second color is changed using a color substitution, where the second color encodes for the first and second base. Without the color substitution, the alignment would be: <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i6.gif"/></inline-formula> illustrating the necessity to model encoding errors.</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>The function Γ</bold>. Γ is a function that encodes one base and one color as a base.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-175-6"/>
      </fig>
      <p>Our goal is to transform <italic>x </italic>into <italic>y </italic>by maximizing the similarity score, thus maximizing sequence similarity. In practice, <italic>x </italic>is an observed encoded sequence, and <italic>y </italic>is a decoded target or reference sequence. We prefer to penalize applications of the edit operators where base substitutions or color substitutions occur. Therefore, for all <italic>B</italic><sub>1 </sub>≠ <italic>B</italic><sub>2 </sub>and <italic>C</italic><sub>1 </sub>≠ <italic>C</italic><sub>2</sub>, we assume that Δ(<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>) ≤ 0, 0 ≤ Δ(<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>1</sub>), <italic>ε </italic>≤ 0, <italic>ρ </italic>≤ 0, Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>) ≤ 0 and 0 ≤ Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>1</sub>). Furthermore, to avoid always placing an insertion, we must have that for any <italic>C</italic><sub>1 </sub>that <italic>ε </italic>+ Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>1</sub>) ≤ 0 and <italic>ρ </italic>+ Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>1</sub>) ≤ 0. A subtle but important point is that two adjacent color substitutions in the encoded sequence in some cases are equivalent to a base substitution in-between the two colors. An example of this equivalence can be seen in the following two sub-alignments <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i7.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i8.gif"/></inline-formula>. In practice we make the assumption that for any bases <italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i9.gif"/></inline-formula>, <italic>B</italic><sub>3 </sub>with <italic>B</italic><sub>2 </sub>≠ <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i9.gif"/></inline-formula>, and for any colors <italic>C</italic><sub>2</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i10.gif"/></inline-formula>, <italic>C</italic><sub>3</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i11.gif"/></inline-formula> with <italic>C</italic><sub>2 </sub>≠ <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i10.gif"/></inline-formula> and <italic>C</italic><sub>3 </sub>≠ <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i11.gif"/></inline-formula> such that Γ (<italic>B</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>) = <italic>B</italic><sub>2</sub>, Γ (<italic>B</italic><sub>2</sub>, <italic>C</italic><sub>3</sub>) = <italic>B</italic><sub>3</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i12.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i13.gif"/></inline-formula>:</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <graphic xlink:href="1471-2105-10-175-i14.gif"/>
        </disp-formula>
      </p>
      <p>This will ensure that two adjacent color substitutions (<inline-formula><inline-graphic xlink:href="1471-2105-10-175-i10.gif"/></inline-formula> for <italic>C</italic><sub>2 </sub>and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i11.gif"/></inline-formula> for <italic>C</italic><sub>3 </sub>above) that are compatible with a base substitution (<inline-formula><inline-graphic xlink:href="1471-2105-10-175-i9.gif"/></inline-formula> for <italic>B</italic><sub>2</sub>) will not be preferred over the compatible base substitution. Considering more complex alignments, for example whether to prefer two adjacent color substitutions or an adjacent color substitution and a base substitution, can help fine-tune the power to detect color errors as well as base substitutions by adding additional constraints on the scoring functions.</p>
    </sec>
    <sec>
      <title>The Algorithm</title>
      <p>In this algorithm, we search over all possible base substitutions, base insertions, base deletions, and color substitutions. Similar to Ewans and Grant [<xref ref-type="bibr" rid="B10">10</xref>] and Jones and Pevzner [<xref ref-type="bibr" rid="B11">11</xref>], we give a recursive formula that describes the basic calculation that is repeated in our algorithm.</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <graphic xlink:href="1471-2105-10-175-i15.gif"/>
        </disp-formula>
      </p>
      <p>Intuitively, we are filling in an <italic>n </italic>by <italic>m </italic>matrix, with each cell containing 12 sub-cells. The <italic>h </italic>sub-cells correspond to bases that are present in <italic>y </italic>but deleted in <italic>x</italic>, the <italic>v </italic>sub-cells correspond to bases inserted into <italic>x </italic>but absent in <italic>y</italic>, and each <italic>s </italic>sub-cell represents a base <italic>x</italic><sub><italic>i </italic></sub>(where <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i16.gif"/></inline-formula>) aligning to a base <italic>y</italic><sub><italic>j </italic></sub>to the reference sequence <italic>y</italic>. All possible color substitutions are considered by transitioning from a sub-cell <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i17.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i18.gif"/></inline-formula>, or <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i19.gif"/></inline-formula> to the sub-cell <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i20.gif"/></inline-formula>.</p>
      <p>We first observe that base substitutions and color substitutions occur in tandem. This is because given the previous base <italic>x</italic><sub><italic>i</italic>-1</sub>, the subsequent base <italic>x</italic><sub><italic>i </italic></sub>uniquely determines the joining color <italic>c</italic><sub><italic>i </italic></sub>(or equivalently the joining color <italic>c</italic><sub><italic>i </italic></sub>uniquely determines the subsequent base <italic>x</italic><sub><italic>i</italic></sub>). Additionally, we assume that color substitutions do not occur directly before a base that has been deleted. In the deletion case, we have one color that spans the entire deletion. Due to base substitutions and color substitutions occurring in tandem, we must consider a color substitution while considering a base substitution, which occurs at the end of the deletion. For insertions, if the color substitution score are equal, meaning the same score is given for all color matches and color mismatches respectively, we need only consider <italic>σ </italic>= Γ(<italic>φ</italic>, <italic>c</italic><sub><italic>i</italic></sub>) in the v-term. This reduces the number of terms over which we compute the maxima from eight terms to two terms. The simplification results from the absence of bases for which to compare the inserted base(s) as well as the observation that placing the color substitution at the end of the insertion will result in the same score as placing the color substitution anywhere else in the insertion, including the beginning of the insertion. Since base substitutions are to be penalized, as was previously assumed, we assume that the inserted bases, and therefore the colors encoding the inserted bases, are correct. Thus, when beginning or extending an insertion, we ignore the color substitution score, and consider the insertion of the base <italic>x</italic><sub><italic>i </italic></sub>= Γ(<italic>x</italic><sub><italic>i</italic>-1</sub>, <italic>c</italic><sub><italic>i</italic></sub>). Finally, we ignore the case where an insertion (or deletion) is directly followed by a deletion (or insertion), since for current technologies, the length of the sequences being compared are very short making this scenario (switching) very biologically unlikely. Nevertheless, to include this case requires minimal modification to Equation 2.</p>
      <p>What is left is to describe is how to initialize <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i21.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i22.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i23.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i24.gif"/></inline-formula>,<inline-formula><inline-graphic xlink:href="1471-2105-10-175-i25.gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i26.gif"/></inline-formula> for <italic>i </italic>&gt; 0, j ≥ 0, and <italic>σ </italic>∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>}. In our specific application, we wish to align the entire encoded sequence <italic>c </italic>to the target sequence <italic>y</italic>. Therefore, we initialize for <italic>i</italic>&gt;0 <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i21.gif"/></inline-formula> = <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i24.gif"/></inline-formula> = -∞, <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i25.gif"/></inline-formula> if <italic>σ </italic>= Γ (<italic>p</italic>, <italic>c</italic><sub>1</sub>) and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i25.gif"/></inline-formula> otherwise, and for <italic>i&gt;1 </italic><inline-formula><inline-graphic xlink:href="1471-2105-10-175-i27.gif"/></inline-formula> if <italic>σ </italic>= Γ (<italic>φ</italic>, <italic>c</italic><sub><italic>i</italic></sub>) and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i25.gif"/></inline-formula> = -∞ otherwise, so that the local alignment spans the entire encoded sequence as well as allowing for an insertion at the beginning of the alignment. We initialize <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i23.gif"/></inline-formula> = -∞ for j ≥ 0 so that the alignment does not begin with a deletion. We observe that deletions are detected on the basis that a reads spans the deletion breakpoint. This is reflected in our scoring system where we assume that a deletion has negative score, and therefore the alignment resulting from removal of a deletion at the beginning or end of the alignment has a score greater than or equal to the original alignment. We thus remove from consideration any instances of a sequence starting or ending with a deletion. We initialize <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i26.gif"/></inline-formula> = -∞ for j ≥ 0 and <italic>σ </italic>∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>}. If <italic>σ </italic>= <italic>p </italic>then we t <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i22.gif"/></inline-formula> = 0, and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i22.gif"/></inline-formula> = -∞ otherwise, for j ≥ 0 and <italic>σ </italic>∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>}. This initialization enforces that the starting base is <italic>p</italic>. Other initializations can find the optimal subsequence of <italic>x </italic>that aligns to <italic>y</italic>, among other applications [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. To find the optimal local alignment we search over cells <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i27.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-175-i28.gif"/></inline-formula> for a cell with maximum score, again ignoring the case where the alignment ends with a deletion, and backtrack to recover a maximum scoring alignment.</p>
      <p>From Equation 2, and for each <italic>i </italic>and <italic>j</italic>, we must calculate maxima over 88 different values, which can be reduced to 64 values if the color match and color mismatch scores respectively are the same. In contrast, the Dynamic Programming solution with affine gap penalties to compare sequences with no encoding requires the calculation of a maxima over 7 different values [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. Although the running time of this algorithm is O(<italic>nm</italic>), where <italic>n </italic>is the length of the encoded sequence and <italic>m </italic>is the length of the target sequence, the running time is nonetheless greater than the algorithm without encoding as seen in practice (see Results).</p>
    </sec>
    <sec>
      <title>Simulations</title>
      <p>To evaluate the power of the algorithm, we created sets of 100,000 test sequences randomly sampled from the Human genome (build 36), and gave each a known number of errors, base substitutions, insertions and deletions. For encoded sequences, we model errors as color substitutions (encoding errors) and for decoded sequences we model errors as base substitutions. It is possible for a class of alignments to have equal likelihood, and therefore we define an alignment to be correct if the alignment returned has equal score to the true alignment. To evaluate the performance of the algorithm, we created 1,000,000 artificial sequences from the Human genome (build 36) with no edits applied. In both cases, we evaluated sequences of length 25 and 50, reflecting a range of possible and currently available sequences generated with color space encoding. The target DNA reference sequence had length three times the length of the encoded sequence to allow for potential insertions and deletions to be placed correctly. For the simulations, in accordance with Equation 1, we set <italic>ρ </italic>= -175, <italic>ε </italic>= -50, Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>) = -125 (<italic>C</italic><sub>1 </sub>≠ <italic>C</italic><sub>2</sub>), Π(<italic>C</italic><sub>1</sub>, <italic>C</italic><sub>1</sub>) = 0, Δ(<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>) = -150 (<italic>B</italic><sub>1 </sub>≠ <italic>B</italic><sub>2</sub>), and Δ(<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>1</sub>) = 50. Since the color match and color mismatch scores respectively are the same, we are able to make the simplification to the v-term in Equation 2 as described above. For these evaluations, we used a dual quad-core Intel Xeon E5420 machine at 2.5 GHz, with 32 GB of RAM and 2TB of RAID 0 disk space, although the actual hardware requirements of the algorithm itself are negligible relative to any modern computer. The implementation for all the simulations performed can be found in BFAST at <ext-link ext-link-type="uri" xlink:href="http://genome.ucla.edu/bfast"/>, which was configured using the –enable-unoptimized-sw argument (Homer N, Merriman B, Nelson SF: BFAST: the BLAT-like Fast Accurate Search Tool for Large-Scale Genome Resequencing, submitted).</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>NH conceived of and implemented the algorithm, and performed the analyses. BM, and SFN advised on the development and analysis of the method, and producing the manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This research was partially supported by University of California Systemwide Biotechnology Research and Education Program GREAT Training Grant 2007–10 (to NH), the NIH Neuroscience Microarray Consortium (U24NS052108), and a grant from the NIMH (R01 MH071852).</p>
      <p>We would also like to thank members of the Nelson Lab: Zugen Chen, Hane Lee, Bret Harry, Jordan Mendler, Brian O'Connor for input and computational infrastructure support.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamming</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Error Detecting and Error Correcting Codes</article-title>
        <source>Bell System Technical Journal</source>
        <year>1950</year>
        <volume>29</volume>
        <fpage>147</fpage>
        <lpage>160</lpage>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levenshtein</surname>
            <given-names>VI</given-names>
          </name>
        </person-group>
        <article-title>Binary Codes Capable of Correcting Deletions, Insertions, and Reversals</article-title>
        <source>Soviet Physics Doklady</source>
        <year>1966</year>
        <volume>10</volume>
        <fpage>706</fpage>
        <lpage>710</lpage>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Identification of common molecular subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>An improved algorithm for matching biological sequences</article-title>
        <source>J Mol Biol</source>
        <year>1982</year>
        <volume>162</volume>
        <fpage>705</fpage>
        <lpage>708</lpage>
        <pub-id pub-id-type="pmid">7166760</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(82)90398-9</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirschberg</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>A linear space algorithm for computing maximal common subsequences</article-title>
        <source>Commun ACM</source>
        <year>1975</year>
        <volume>18</volume>
        <fpage>341</fpage>
        <lpage>343</lpage>
        <pub-id pub-id-type="doi">10.1145/360825.360861</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A time-efficient linear-space local similarity algorithm</article-title>
        <source>Adv Appl Math</source>
        <year>1991</year>
        <volume>12</volume>
        <fpage>337</fpage>
        <lpage>357</lpage>
        <pub-id pub-id-type="doi">10.1016/0196-8858(91)90017-D</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Optimal alignments in linear space</article-title>
        <source>Comput Appl Biosci</source>
        <year>1988</year>
        <volume>4</volume>
        <fpage>11</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">3382986</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Powell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dix</surname>
            <given-names>TI</given-names>
          </name>
        </person-group>
        <article-title>A versatile divide and conquer technique for optimal string alignment</article-title>
        <source>Inf Process Lett</source>
        <year>1999</year>
        <volume>70</volume>
        <fpage>127</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1016/S0020-0190(99)00053-8</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ewans</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Statistical Methods in Bioinformatics</source>
        <year>2002</year>
        <publisher-name>New York: Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>An Introduction to Bioinformatics Algorithms (Computational Molecular Biology)</source>
        <year>2004</year>
        <publisher-name>Cambridge MA: The MIT Press</publisher-name>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT–the BLAST-like alignment tool</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rumble</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lacroute</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dalca</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Fiume</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SHRiMP: Accurate Mapping of Short Color-space Reads</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000386</fpage>
        <pub-id pub-id-type="pmid">19461883</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000386</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tromp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PatternHunter: faster and more sensitive homology search</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>440</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="pmid">11934743</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.440</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>Applied Biosystems Incorporated</collab>
        </person-group>
        <article-title>Principles of Di-Base Sequencing and the Advantages of Color Space Analysis in the SOLiD System</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://marketing.appliedbiosystems.com/images/Product_Microsites/Solid_Knowledge_MS/pdf/SOLiD_Dibase_Sequencing_and_Color_Space_Analysis.pdf"/>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>Applied Biosystems Incorporated</collab>
        </person-group>
        <article-title>A Theoretical Understanding of 2 Base Color Codes and Its Application to Annotation, Error Detection, and Error Correction</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www3.appliedbiosystems.com/cms/groups/mcb_marketing/documents/generaldocuments/cms_058265.pdf"/>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schaffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kristiansen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>713</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="pmid">18227114</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn025</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>SSAHA: a fast search method for large DNA databases</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1725</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="pmid">11591649</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.194201</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Feuk</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Axelrod</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kirkness</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Denisov</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The diploid genome sequence of an individual human</article-title>
        <source>PLoS Biol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e254</fpage>
        <pub-id pub-id-type="pmid">17803354</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050254</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Kholodov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Smigielski</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Sirotkin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>dbSNP: the NCBI database of genetic variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>308</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="pmid">11125122</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/29.1.308</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>186</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="pmid">9521922</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hillier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wendl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using phred. I. Accuracy assessment</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>175</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="pmid">9521921</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Izmailov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goloubentzev</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sunay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wisco</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yager</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>A general approach to the analysis of errors and failure modes in the base-calling function in automated fluorescent DNA sequencing</article-title>
        <source>Electrophoresis</source>
        <year>2002</year>
        <volume>23</volume>
        <fpage>2720</fpage>
        <lpage>2728</lpage>
        <pub-id pub-id-type="pmid">12210177</pub-id>
        <pub-id pub-id-type="doi">10.1002/1522-2683(200208)23:16&lt;2720::AID-ELPS2720&gt;3.0.CO;2-Z</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Izmailov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yager</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Darash</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Improvement of base-calling in multilane automated DNA sequencing by use of electrophoretic calibration standards, data linearization, and trace alignment</article-title>
        <source>Electrophoresis</source>
        <year>2001</year>
        <volume>22</volume>
        <fpage>1906</fpage>
        <lpage>1914</lpage>
        <pub-id pub-id-type="pmid">11465487</pub-id>
        <pub-id pub-id-type="doi">10.1002/1522-2683(200106)22:10&lt;1906::AID-ELPS1906&gt;3.0.CO;2-5</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Peckham</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Makowsky</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Woolf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Donahue</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Tusneem</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stromberg</surname>
            <given-names>MP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid whole-genome mutational profiling using next-generation sequencing technologies</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1638</fpage>
        <lpage>1642</lpage>
        <pub-id pub-id-type="pmid">18775913</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.077776.108</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
