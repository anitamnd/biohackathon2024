<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860312</article-id>
    <article-id pub-id-type="pmid">29095980</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx705</article-id>
    <article-id pub-id-type="publisher-id">btx705</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pedigreejs: a web-based graphical pedigree editor</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Carver</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
        <xref ref-type="corresp" rid="btx705-cor1"/>
        <!--<email>tjc29@cam.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cunningham</surname>
          <given-names>Alex P</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Babb de Villiers</surname>
          <given-names>Chantal</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hartley</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tischkowitz</surname>
          <given-names>Marc</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walter</surname>
          <given-names>Fiona M</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Easton</surname>
          <given-names>Douglas F</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
        <xref ref-type="aff" rid="btx705-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antoniou</surname>
          <given-names>Antonis C</given-names>
        </name>
        <xref ref-type="aff" rid="btx705-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx705-aff1"><label>1</label>Centre for Cancer Genetic Epidemiology, Department of Public Health and Primary Care, Strangeways Research Laboratory, University of Cambridge, Cambridge, UK</aff>
    <aff id="btx705-aff2"><label>2</label>The Primary Care Unit, Department of Public Health and Primary Care, University of Cambridge, Cambridge, UK</aff>
    <aff id="btx705-aff3"><label>3</label>Department of Medical Genetics and National Institute for Health Research Cambridge Biomedical Research Centre, University of Cambridge, Cambridge, UK</aff>
    <aff id="btx705-aff4"><label>4</label>Centre for Cancer Genetic Epidemiology, Department of Oncology, University of Cambridge, Cambridge, UK</aff>
    <author-notes>
      <corresp id="btx705-cor1">To whom correspondence should be addressed. Email: <email>tjc29@cam.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-31">
      <day>31</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>6</issue>
    <fpage>1069</fpage>
    <lpage>1071</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx705.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The collection, management and visualization of clinical pedigree (family history) data is a core activity in clinical genetics centres. However, clinical pedigree datasets can be difficult to manage, as they are time consuming to capture, and can be difficult to build, manipulate and visualize graphically. Several standalone graphical pedigree editors and drawing applications exist but there are no freely available lightweight graphical pedigree editors that can be easily configured and incorporated into web applications.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed ‘pedigreejs’, an interactive graphical pedigree editor written in JavaScript, which uses standard pedigree nomenclature. Pedigreejs provides an easily configurable, extensible and lightweight pedigree editor. It makes use of an open-source Javascript library to define a hierarchical layout and to produce images in scalable vector graphics (SVG) format that can be viewed and edited in web browsers.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The software is freely available under GPL licence (<ext-link ext-link-type="uri" xlink:href="https://ccge-boadicea.github.io/pedigreejs/">https://ccge-boadicea.github.io/pedigreejs/</ext-link>).</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Research UK</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000289</named-content>
        </funding-source>
        <award-id>C12292/A20861 &amp; C1287/A16563</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Wellcome Trust</named-content>
          <named-content content-type="funder-identifier">10.13039/100004440</named-content>
        </funding-source>
        <award-id>203477/B/16/Z</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The collection, management and visualization of pedigree (family history) data is a core activity in clinical settings, such as genetic centres and primary care, where healthcare professionals manage patients at risk of disease. Pedigree data are used to identify individuals at risk of familial disease and to inform their clinical management, including referral of individuals at elevated risk for mutation screening and/or recommending enhanced screening. For example, generating a pedigree is a requirement for calculating <italic>BRCA1</italic> and <italic>BRCA2</italic> mutation carrier probabilities and breast cancer risks in the BOADICEA <xref rid="btx705-B6" ref-type="bibr">(Lee <italic>et al.</italic>, 2014</xref>) and IBIS (<xref rid="btx705-B9" ref-type="bibr">Tyrer <italic>et al.</italic>, 2004</xref>) programs recommended in the National Institute for Health and Care Excellence guidelines (<xref rid="btx705-B7" ref-type="bibr">NICE, 2013</xref>, <ext-link ext-link-type="uri" xlink:href="https://www.nice.org.uk/guidance/cg164">https://www.nice.org.uk/guidance/cg164</ext-link>).</p>
    <p>Clinical pedigree datasets can be difficult to manage for several reasons: (i) they are supplied by humans not machines, and are therefore time consuming to capture in digital form; (ii) they include both family structure (which can be difficult to visualize in the presence of complex structure and still remain clear and comprehensible) and separate information for each family member (which must be linked); (iii) they often require updating over time; (iv) they can include data errors (e.g. broken family structures) and internal inconsistencies; and (v) they must be stored securely in order to fulfill data privacy requirements.</p>
    <p>Many existing software applications capture and display pedigree data. Some open-source tools (e.g. Kinship2: <xref rid="btx705-B8" ref-type="bibr">Sinnwell <italic>et al.</italic>, 2014</xref>) generate a vector image file from an input data file, whereas others (e.g. Pelican: <xref rid="btx705-B4" ref-type="bibr">Dudbridge <italic>et al.</italic>, 2004</xref> and PhenoTips: <xref rid="btx705-B5" ref-type="bibr">Girdea <italic>et al.</italic>, 2013</xref>) provide a graphical pedigree editor. There are also commercial subscription pedigree drawing services (<ext-link ext-link-type="uri" xlink:href="http://www.progenygenetics.com">http://www.progenygenetics.com</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://pedigreedraw.com/">http://pedigreedraw.com/</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://www.pedigreexp.com">http://www.pedigreexp.com</ext-link>). However, after evaluating available tools (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Data</xref>) we found no freely available lightweight pedigree drawing tools (components implemented solely in JavaScript) that could be easily incorporated into other web applications, and configured to provide a means of capturing and visualising pedigree data. Pedigreejs has been developed to fulfil these requirements as part of the ongoing BOADICEA project (<ext-link ext-link-type="uri" xlink:href="http://ccge.medschl.cam.ac.uk/boadicea/">http://ccge.medschl.cam.ac.uk/boadicea/</ext-link>, <xref rid="btx705-B6" ref-type="bibr">Lee <italic>et al.</italic>, 2014</xref>) (<xref ref-type="fig" rid="btx705-F1">Fig. 1</xref>).
</p>
    <fig id="btx705-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Screenshot showing a pedigree extending to second degree built using pedigreejs. The pedigree is annotated in the conventional manner: the proband is identified with an arrow; family members who have developed cancer are shaded; and unaffected family members are unshaded. Users can add or delete family members, and change their properties using widgets, which appear when the individual is selected. Buttons directly above the pedigree are used to ‘undo’ and ‘redo’ actions, ‘reset’ the initial structure, and switch to ‘fullscreen’ mode. The buttons at the top are used to ‘Load’ and ‘Save’ pedigree data files, to print the pedigree, and to export it as a SVG/PNG image</p>
      </caption>
      <graphic xlink:href="btx705f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Pedigreejs has been implemented as a configurable JavaScript library to provide a graphical pedigree editor in a web-based environment. The pedigreejs algorithm uses the d3-hierarchy JavaScript module (<ext-link ext-link-type="uri" xlink:href="https://d3js.org">https://d3js.org</ext-link>) to assist the layout of individuals’ nodes in the pedigree representation. Pedigrees are rendered as SVG images in the browser window which results in a fast and responsive user experience to facilitate clinical data entry. The standard nomenclature for representing pedigrees <xref rid="btx705-B1" ref-type="bibr">(Bennett <italic>et al.</italic>, 1995</xref>, <xref rid="btx705-B2" ref-type="bibr">2008</xref>) is used. Pedigrees are built by adding parents, partners and siblings (including twins) using widgets that appear on mouseover of an individual.</p>
    <p>Local browser storage is used to store the pedigree data (including family structure and linked data for each family member, e.g. sex, age). This means that confidential patient data can be stored on the client computer and not transmitted over the Internet. For reasons of data privacy the default is to hold these data for the session so that they do not persist after the browser or tab is closed. Previous versions of the pedigree dataset are also stored so that when a change is made it can be undone. Basic validation of the dataset is provided by default (e.g. check all mothers are female) and this can be overridden to define specific validations.</p>
    <p>The pedigree data are stored in the lightweight JSON format (<ext-link ext-link-type="uri" xlink:href="https://www.w3schools.com/js/js_json_intro.asp">https://www.w3schools.com/js/js_json_intro.asp</ext-link>) to facilitate data interchange with other applications. JSON is easily extendable, so that the individual level data that are gathered are not limited. Once constructed, the pedigree dataset can be saved to a JSON format data file and loaded back into pedigreejs at a later date, so that pedigrees can be easily updated. In addition, pedigree data files in BOADICEA Web Application (v4) pedigree format and PED format (used by PLINK <ext-link ext-link-type="uri" xlink:href="http://www.cog-genomics.org/plink/1.9">http://www.cog-genomics.org/plink/1.9</ext-link>, <xref rid="btx705-B3" ref-type="bibr">Chang <italic>et al.</italic>, 2015</xref>) can be loaded into pedigreejs.</p>
    <p>Pedigreejs has a variety of configuration options to assist integration with other web applications. For example, it can be configured to define the size of the SVG image that is rendered on the web-page, and define whether the image can zoom in and out. To allow for different property editors, an edit function can be provided in the configuration. In addition diseases can be configured and colours defined to identify affected individuals.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Pedigreejs is a freely available, configurable, interactive, fast and responsive JavaScript pedigree editor. It is lightweight (implemented solely in JavaScript) and uses D3.js to assist in the rendering and does not send requests to a backend server. Creating and deleting individuals is made easy by clicking on widgets that appear on mouseover of a family member. ‘Undo’, ‘redo’ and ‘reset’ options and the ‘fullscreen’ option add to this being a user friendly editing tool.</p>
    <p>Future developments will include further support for other commonly used pedigree data file formats (e.g. Madeline, Progeny). Pedigreejs will also be updated to support more complex family structures including consanguineous partners beyond those at the same level in the tree such as cousins. Pedigreejs will be used in future releases of the BOADICEA Web Application.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx705_supplementary_resubmit.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Beverley Speight and Aoife O'Shaughnessy-Kirwan from the East Anglian Medical Genetics Service for providing feedback and suggestions on the usability of the software.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Cancer Research UK grants: C12292/A20861 &amp; C1287/A16563, the European Union’s Horizon 2020 research and innovation programme under grant agreements No 633784 (B-CAST) and 634935 (BRIDGES), and a Wellcome Trust Collaborative Award (203477/B/16/Z).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx705-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bennett</surname><given-names>R.L.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) 
<article-title>Recommendations for standardized human pedigree nomenclature. Pedigree Standardization Task Force of the National Society of Genetic Counselors</article-title>. <source>Am. J. Hum. Genet</source>., <volume>56</volume>, <fpage>745</fpage>–<lpage>752</lpage>.<pub-id pub-id-type="pmid">7887430</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bennett</surname><given-names>R.L.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Standardized human pedigree nomenclature: update and assessment of the recommendations of the National Society of Genetic Counselors</article-title>. <source>J. Genet. Couns</source>., <volume>17</volume>, <fpage>424</fpage>–<lpage>433</lpage>.<pub-id pub-id-type="pmid">18792771</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chang</surname><given-names>C.C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source>, <volume>4</volume>, <fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">25838885</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dudbridge</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Pelican: pedigree editor for linkage computer analysis</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>2327</fpage>–<lpage>2328</lpage>.<pub-id pub-id-type="pmid">15059819</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Girdea</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>PhenoTips: patient phenotyping software for clinical and research use</article-title>. <source>Hum. Mutat</source>., <volume>34</volume>, <fpage>1057</fpage>–<lpage>1065</lpage>.<pub-id pub-id-type="pmid">23636887</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>BOADICEA breast cancer risk prediction model: updates to cancer incidences, tumour pathology and web interface</article-title>. <source>Br. J. Cancer</source>, <volume>110</volume>, <fpage>535</fpage>–<lpage>545</lpage>.<pub-id pub-id-type="pmid">24346285</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B7">
      <mixed-citation publication-type="other"><collab>NICE</collab> (<year>2013</year>) Familial breast cancer: classification, care and managing breast cancer and related risks in people with a family history of breast cancer. Guidance and guidelines.</mixed-citation>
    </ref>
    <ref id="btx705-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sinnwell</surname><given-names>J.P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The kinship2 R package for pedigree data</article-title>. <source>Hum. Hered</source>., <volume>78</volume>, <fpage>91</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">25074474</pub-id></mixed-citation>
    </ref>
    <ref id="btx705-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tyrer</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>A breast cancer prediction model incorporating familial and personal risk factors</article-title>. <source>Stat. Med</source>., <volume>23</volume>, <fpage>1111</fpage>–<lpage>1130</lpage>.<pub-id pub-id-type="pmid">15057881</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
