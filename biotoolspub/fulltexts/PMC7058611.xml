<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Commun Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id>
    <journal-title-group>
      <journal-title>Communications Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2399-3642</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7058611</article-id>
    <article-id pub-id-type="publisher-id">794</article-id>
    <article-id pub-id-type="doi">10.1038/s42003-020-0794-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BrainSpace: a toolbox for the analysis of macroscale gradients in neuroimaging and connectomics datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Vos de Wael</surname>
          <given-names>Reinder</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3922-7643</contrib-id>
        <name>
          <surname>Benkarim</surname>
          <given-names>Oualid</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paquola</surname>
          <given-names>Casey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lariviere</surname>
          <given-names>Sara</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4448-8998</contrib-id>
        <name>
          <surname>Royer</surname>
          <given-names>Jessica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tavakol</surname>
          <given-names>Shahin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Ting</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1847-578X</contrib-id>
        <name>
          <surname>Hong</surname>
          <given-names>Seok-Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Langs</surname>
          <given-names>Georg</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valk</surname>
          <given-names>Sofie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0307-2862</contrib-id>
        <name>
          <surname>Misic</surname>
          <given-names>Bratislav</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milham</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Margulies</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Smallwood</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Bernhardt</surname>
          <given-names>Boris C.</given-names>
        </name>
        <address>
          <email>boris.bernhardt@mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution>McConnell Brain Imaging Centre, Montreal Neurological Institute and Hospital, </institution><institution>McGill University, </institution></institution-wrap>Montreal, Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.428122.f</institution-id><institution>Center for the Developing Brain, </institution><institution>Child Mind Institute, </institution></institution-wrap>New York, USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9259 8492</institution-id><institution-id institution-id-type="GRID">grid.22937.3d</institution-id><institution>Medical University of Vienna, </institution></institution-wrap>Vienna, Austria </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2297 375X</institution-id><institution-id institution-id-type="GRID">grid.8385.6</institution-id><institution>Institute for Neuroscience and Medicine; 7/Institute of Systems Neuroscience, </institution><institution>Forschungszentrum Juelich - Heinrich Heine Universitaet Duesseldorf, </institution></institution-wrap>Juelich, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0620 5939</institution-id><institution-id institution-id-type="GRID">grid.425274.2</institution-id><institution>Frontlab, </institution><institution>Institut du Cerveau et de la Moelle épinière, </institution></institution-wrap>UPMC UMRS 1127, Inserm U 1127, CNRS UMR 7225, Paris, France </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9668</institution-id><institution-id institution-id-type="GRID">grid.5685.e</institution-id><institution>Department of Psychology, </institution><institution>University of York, </institution></institution-wrap>Heslington, England UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>3</volume>
    <elocation-id>103</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Understanding how cognitive functions emerge from brain structure depends on quantifying how discrete regions are integrated within the broader cortical landscape. Recent work established that macroscale brain organization and function can be described in a compact manner with multivariate machine learning approaches that identify manifolds often described as cortical gradients. By quantifying topographic principles of macroscale organization, cortical gradients lend an analytical framework to study structural and functional brain organization across species, throughout development and aging, and its perturbations in disease. Here, we present BrainSpace, a Python/Matlab toolbox for (i) the identification of gradients, (ii) their alignment, and (iii) their visualization. Our toolbox furthermore allows for controlled association studies between gradients with other brain-level features, adjusted with respect to null models that account for spatial autocorrelation. Validation experiments demonstrate the usage and consistency of our tools for the analysis of functional and microstructural gradients across different spatial scales.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par02">Vos de Wael et al. developed an open source tool called BrainSpace to quantify cortical gradients using 3 structural or functional imaging data. Their toolbox enables gradient identification, comparison, 4 visualization, and association with other brain features.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Cognitive neuroscience</kwd>
      <kwd>Scientific community</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Over the last century, neuroanatomical studies in humans and non-human animals have highlighted two complementary features of neural organization. On the one hand, studies have demarcated structurally homogeneous areas with specific connectivity profiles, and ultimately distinct functional roles<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. In parallel, neuroanatomists have established spatial trends that span across cortical areas both in terms of their histological properties, and connectivity patterns<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. Such characterizations of cortical areas by their placement in the broader cortical hierarchy has provided a foundation for understanding functions that emerge through cortical interactions.</p>
    <p id="Par3">Although much of the more recent work linking measures of neural processing (for example from functional magnetic resonance imaging, MRI) to cognition has focused on identifying discrete regions and modules and their specific functional roles<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, recent conceptual and methodological developments have provided the data and methods that allow macroscale brain features mapped to low dimensional manifold representations, also described as gradients<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Gradient analyses operating on connectivity data were applied to diffusion MRI tractography data in specific brain regions<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> as well as neocortical, hippocampal, and cerebellar resting-state functional MRI connectivity maps<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>. Similar techniques have also been used to describe myelin-sensitive tissue measures and other morphological characteristics<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup>, as well as approaches based on combined network information aggregated from multiple features<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Other studies have used a similar framework to describe task based neural patterns either using meta-analytical co-activation mapping<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> or large-scale functional MRI task data sets<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Gradients have also been successfully derived from non-imaging data that were registered to stereotaxic space, including hippocampal post mortem gene expression information<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> and 3D histology data<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, to explore cellular and molecular signatures of neuroimaging and connectome measures. Core to these techniques is the computation of an affinity matrix that captures inter-area similarity of a given feature followed by the application of dimensionality reduction techniques to identify a gradual ordering of the input matrix in a lower dimensional manifold space (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>A typical gradient identification workflow.</title><p>Starting from an input matrix (here, functional connectivity), we use a kernel function to build the affinity matrix (here capturing the connectivity of each seed region). This matrix is decomposed, often via linear rotations or non-linear manifold learning techniques into a set of principal eigenvectors describing axes of largest variance. The scores of each seed onto the first two axes are shown in the scatter plot, with colors denoting position in this 2D space. These colors may be projected back to the cortical surface and the scores can be used to sort the input connectome.</p></caption><graphic xlink:href="42003_2020_794_Fig1_HTML" id="d29e434"/></fig></p>
    <p id="Par4">The ability to describe brain wide organizational principles in a single manifold offers the possibility to understand how the integrated nature of neural processing gives rise to function and dysfunction. Adopting a macroscale perspective on cortical organization has already provided insights into how cortex-wide patterns relate to cortical dynamics<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> and high level cognition<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. Furthermore, several studies have leveraged gradients as an analytical framework to describe atypical macroscale brain organization across clinical conditions, for example, by showing perturbations in functional connectome gradients in autism<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and schizophrenia<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Finally, comparisons of gradients across different imaging modalities have highlighted the extent to which structure directly constrains functional measures<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, while consideration of gradients across species has highlighted how evolution has shaped more integrative features of the cortical landscape<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    <p id="Par5">The growth in our capacity to map whole brain cortical gradients, coupled with the promise of a better understanding of how structure gives rise to function, highlights the need for a set of tools that support the analysis of neural manifolds in a compact and reproducible manner. The goal of this paper is to present an open-access set of easy-to-use tools that allow the identification, visualization, and analysis of macroscale gradients of brain organization. We hope this will provide a method for calculating cortical manifolds that facilitates their use in future empirical work, allows comparison between studies, and allows for result replicability. To offer flexibility in implementation, we provide our toolbox in both Python and Matlab, two languages widely used in the neuroimaging and network neuroscience communities. Associated functions are freely available for download (<ext-link ext-link-type="uri" xlink:href="http://github.com/MICA-MNI/BrainSpace">http://github.com/MICA-MNI/BrainSpace</ext-link>) and complemented with an expandable online documentation (<ext-link ext-link-type="uri" xlink:href="http://brainspace.readthedocs.io">http://brainspace.readthedocs.io</ext-link>). We anticipate that our toolbox will assist researchers interested in studying gradients of cortical organization, and propel further work that establishes the overarching principles through which structural and functional organization of human and non-human brains gives rise to key aspects of cognition.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par6">This section illustrates the usage of BrainSpace for gradient mapping and null model generation. Examples and evaluations are based on 217 subjects from the Human Connectome Project (HCP) dataset<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, as in prior work<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Matlab code is presented in the main version of the paper. Corresponding Python codes are available in the <xref rid="MOESM1" ref-type="media">Supplementary Information</xref>.</p>
    <sec id="Sec3">
      <title>Generating gradients</title>
      <p id="Par7">To illustrate the basic functionality of the toolbox, we computed gradients derived from resting-state functional MRI functional connectivity (FC). In short, the input matrix was made sparse (to 10% sparsity) and a cosine similarity matrix was computed. Next, three different manifold algorithms (i.e., principal component analysis (PCA), Laplacian eigenmaps (LE), diffusion mapping (DM)) were applied, followed by plotting their first and second gradients on the cortical surface (Figure <xref rid="Fig2" ref-type="fig">2</xref>). Resulting gradients (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) derived from all dimensionality reduction techniques resemble those published previously<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, although for PCA the somatomotor to visual gradient explains more variance than the default mode to sensory gradient.<fig id="Fig2"><label>Fig. 2</label><caption><title>Sample code 1.</title><p>A minimal Matlab example for plotting the first gradient of an input data matrix on the cortical surface. Equivalent Python code is provided in Supplementary Sample Code <xref rid="MOESM1" ref-type="media">1</xref>.</p></caption><graphic xlink:href="42003_2020_794_Fig2_HTML" id="d29e530"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><title>Gradient construction with different dimensionality reduction techniques.</title><p>Gradient 1 (G1) and 2 (G2) of FC were computed using a cosine similarity affinity computation, followed by either PCA, LE, or DM. Gradients were z-scored before plotting.</p></caption><graphic xlink:href="42003_2020_794_Fig3_HTML" id="d29e541"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Aligning gradients</title>
      <p id="Par10">Gradient alignment across modalities. Based on subjects present in both the FC dataset as well as those used in the validation group of ref. <sup><xref ref-type="bibr" rid="CR22">22</xref></sup> (n = 70), we examined the correspondence between gradients computed from different modalities and evaluated increases in correspondence through gradient alignment. The modalities evaluated are FC and microstructural profile covariance (MPC). Here we compared gradients of these in unaligned form, and after Procrustes alignment and joint embedding (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>). As expected, gradient correspondence increased slightly following Procrustes alignment compared to unaligned gradients, and even more markedly following joint embedding. Beyond maximizing correspondence, the choice of Procrustes versus joint embedding can depend on the specific applications. Procrustes alignment preserves the overall shape of the different gradients and can thus be preferable to compare different gradients. Joint embedding, on the other hand, identifies a joint solution that maximizes their similarity, resulting in a gradient that may be more of a ‘hybrid’ of the input manifolds. Joint embedding is, thus, a technique to identify correspondence and to map from one space to another, and conceptually related to widely used multivariate associative techniques such as canonical correlation analysis or partial least squares which seek to maximize the linear associations between two multidimensional datasets<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Note that the computational cost of joint embedding is substantially higher, so Procrustes analysis may be the preferred option when computational resources are a limiting factor.<fig id="Fig4"><label>Fig. 4</label><caption><title>Comparison of alignment methods across modalities.</title><p>Unaligned gradients 1 (top) of MPC and FC were derived using cosine similarity and diffusion mapping. Alignments using Procrustes analyses (middle) and joint embedding (bottom) are also shown. Smoothed scatter plots show correspondence between principal gradient values for FC and MPC across cortical nodes, indicating a moderate increase in Spearman correlation after joint embedding. Gradient values were z-scored before plotting.</p></caption><graphic xlink:href="42003_2020_794_Fig4_HTML" id="d29e571"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><title>Sample code 2.</title><p>A minimal Matlab example for creating and plotting gradients from different modalities, with different alignments. Equivalent Python code is provided in Supplementary Sample Code <xref rid="MOESM1" ref-type="media">2</xref>.</p></caption><graphic xlink:href="42003_2020_794_Fig5_HTML" id="d29e585"/></fig></p>
      <p id="Par13">Gradient alignment across individuals. Researchers may also be interested in comparing gradient values between individuals<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, for example to assess perturbations in FC gradients as a measure of brain network hierarchy. One possible approach could be to first build a group-level gradient template, to which both diagnostic groups are aligned using Procrustes rotation. After that, the two groups can be compared statistically and at each vertex, for example using tools suitable for surface-based linear modeling<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>.</p>
      <p id="Par14">In the example below, we computed a template gradient from an out-of-sample dataset of 134 subjects from the HCP dataset (the validation cohort used by<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>). Next, we used the Procrustes analysis to align individual’s gradients of each subject to the group level template (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, Fig. <xref rid="Fig7" ref-type="fig">7</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><title>Alignment of subjects to a template.</title><p>Gradients 1 of single subjects computed with the cosine similarity kernel and diffusion mapping manifold (left) were aligned to an out-of-sample template (middle) using Procrustes analysis, creating aligned gradients (right). Box-plot shows the Spearman correlations of each subjects’ gradient 1 values across cortical nodes to the template gradient 1 both before, and after Procrustes alignment. The central line of the box plot denotes the median, the edges denote the 25th and 75th percentiles, and the whiskers extend to the most extreme datapoints.</p></caption><graphic xlink:href="42003_2020_794_Fig6_HTML" id="d29e618"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><title>Sample code 3.</title><p>A minimal Matlab example for aligning the gradients of two individuals to a template gradient. Equivalent Python code is provided in Supplementary Sample Code <xref rid="MOESM1" ref-type="media">3</xref>.</p></caption><graphic xlink:href="42003_2020_794_Fig7_HTML" id="d29e632"/></fig></p>
      <p id="Par17">Gradients across different spatial scales. The gradients presented so far were all derived at a vertex-wise level, which requires considerable computational resources. To minimize time and space requirements and to make results comparable to parcellation-based studies, some users may be interested in deriving gradients from parcellated data. To illustrate the effect of using different parcellations, we repeated the gradient identification and analysis across different spatial scales for both a structural and a functional parcellation. Specifically, we subdivided the conte69 surface into 400, 300, 200, and 100 parcels based on both a clustering of a well-established anatomical atlas<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, as well as a recently published local-global functional clustering<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> and built FC gradients from these representations (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). These parcellations and subsampling schemes are provided in the shared folder of the BrainSpace toolbox.<fig id="Fig8"><label>Fig. 8</label><caption><title>Functional gradients across spatial scales.</title><p>The cortex was subdivided into 100 (first row), 200 (second row), 300 (third row), and 400 (fourth row) regions of interest based on an anatomical (left) and functional (right) parcellation. Displayed are gradients 1 (G1), and 2 (G2), each for one hemisphere only. Line plots show the average gradient score within each Mesulam class for the functional (dark gray) and structural (light gray).</p></caption><graphic xlink:href="42003_2020_794_Fig8_HTML" id="d29e656"/></fig></p>
      <p id="Par18">Overall, with increasing spatial resolution the FC gradients became more pronounced and gradients derived from functional and structural parcellations were more similar. At a scale of 200 nodes or lower, putative functional boundaries may not be as reliably captured when using anatomically-informed parcellations, resulting in more marked alterations in the overall shape of the gradients.</p>
      <p id="Par19">For further evaluation, we related the above gradients across multiple scales relative to Mesulam’s classic scheme of cortical laminar differentiation and hierarchy<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>. It shows a clear correspondence between the first gradient and the Mesulam hierarchy for high resolution data of 300 nodes and more, regardless of the parcellation scheme. While high correspondence was still seen for functional parcellations at lower granularity, it was markedly reduced when using structural parcellations. For researchers interested in using Mesulam’s parcellation, it has been provided on Conte69 surfaces in the shared folder of the BrainSpace toolbox. We also provide the data required to reproduce the evaluated FC and MPC gradients across these different spatial scales. Such gradients can be used to stratify other imaging measures, including functional activation and connectivity patters<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>, meta-analytical syntheses<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, cortical thickness measures or Amyloid-beta PET uptake data<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>.</p>
    </sec>
    <sec id="Sec5">
      <title>Null models</title>
      <p id="Par20">Here, we present an example to assess the significance of correlations between FC gradients and data from other modalities (cortical thickness and T1w/T2w image intensity in this example). We present code (see Fig. <xref rid="Fig9" ref-type="fig">9</xref>) to generate previously proposed spin tests<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, which preserve the autocorrelation of the permuted features by rotating the feature data on the sphere. In our example (Fig. <xref rid="Fig10" ref-type="fig">10</xref>), the correlations between FC gradients and T1w/T2w stay significant (two-tailed, <italic>p</italic> &lt; 0.001) even when comparing the correlation to 1000 null models whereas correlations between FC gradients and cortical thickness was non-significant (two-tailed, <italic>p</italic> = 0.12).<fig id="Fig9"><label>Fig. 9</label><caption><title>Sample code 4.</title><p>A minimal Matlab example for building null models based on spin tests. Equivalent Python code is provided in Supplemental Sample Code <xref rid="MOESM1" ref-type="media">4</xref>.</p></caption><graphic xlink:href="42003_2020_794_Fig9_HTML" id="d29e724"/></fig><fig id="Fig10"><label>Fig. 10</label><caption><title>Spin tests of cortical thickness and t1w/t2w intensity.</title><p>Data were rotated on the sphere 1000 times and Spearman correlations between FC gradient 1 and the rotated data were computed. Distribution of correlation coefficients are shown in the histograms with the dashed lines denoting the true correlation.</p></caption><graphic xlink:href="42003_2020_794_Fig10_HTML" id="d29e735"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Test-retest stability</title>
      <p id="Par23">The HCP dataset has four rs-fMRI scans, split over two days. As such, we can leverage this data to assess test-retest stability of gradients. Here, we assessed the test-retest stability of gradients at the group level. Specifically, we redid the analysis of Fig. <xref rid="Fig2" ref-type="fig">2</xref>, but split the dataset by day of scanning. Stability was very high for LE and DM (<italic>r</italic> &gt; 0.99) and moderate-to-high for PCA (<italic>r</italic> ≈ 0.72) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par24">While tools for unsupervised manifold identification and their alignment are extensively used in data science across multiple research domains<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and while few prior connectome level studies made their workflow openly accessible (see refs. <sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>), we currently lack a unified software package that incorporates the major steps of gradient construction and evaluation for neuroimaging and connectome datasets. We filled this gap with BrainSpace, a compact open-access Matlab/Python toolbox for the identification and analysis of low-dimensional gradients for any given regional or connectome-level feature. As such, BrainSpace provides an entry point for researchers interested in studying gradients as windows into brain organization and function. BrainSpace is a simple and modular package accessible to beginners, yet expandable for advanced programmers. At its core is a simple object-oriented model, allowing for flexible computation of different (i) affinity matrices, (ii) dimensionality reduction techniques, (iii) alignment functions, and (iv) null models. We also supplied precomputed gradients, a novel subparcellation of the Desikan-Killiany atlas, and a literature-based atlas of cortical laminar differentiation that we used in a recent study<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>.</p>
    <p id="Par25">As our main purpose was to provide an accessible introduction of the toolbox’s basic functionality, we focused on tutorial examples and several selected assessments that demonstrate more general aspects of gradient analyses. First, relatively consistent FC gradients were produced by different dimensionality reduction techniques (i.e., PCA, LE, DM), at least when cosine similarity was chosen for affinity matrix computations. Interactions between input data, affinity matrix kernels, and dimensionality reduction techniques may nevertheless occur, a topic worthwhile to explore in future work. Second, we could show a relative consistency of FC gradients across spatial scales in the case of vertex-wise analyses and when parcellations with 300 nodes or more were used. However, we also observed an interaction between the type of input data and parcellation at lower spatial scales. In fact, lower resolution structural parcellations might not capture fine-grained functional boundaries, specifically in heteromodal and paralimbic association cortices which may be less constrained by underlying structural-morphological features<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. It will be informative for future work to clarify how input modality (e.g., FC, MPC, or diffusion MRI), the choice of parcellation, and the spatial scale impact gradient analyses.</p>
    <p id="Par26">There are two broad ways through which the gradient method and the BrainSpace toolbox may improve our understanding of neural organization and its associated functions. One avenue is the identification of similarities and differences in gradients derived from different brain measures. To address associations between cortical microstructure and macroscale function, a previous study<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> demonstrated that gradients derived from 3D histology and myelin-sensitive MRI measures show both similarities and differences from those derived from resting state-state functional connectivity analysis<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. This raises the possibility that the gradient method may help quantify common and distinct influences on functional and structural brain organization and shed light on the neural basis of more flexible (i.e., less structurally constrained) aspects of human cognition<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Another way that gradients can inform our understanding of how functions emerge from the cortex is through the analysis of how macroscale patterns of organization change in disease. One recent study<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, for example, demonstrated differences in the principal functional gradient, identified by<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, between individuals with autism spectrum disorder and typically developing controls. In this way, manifold-derived gradient analyses hold the possibility to characterize how macroscale functional organization may become dysfunctional in atypical neurodevelopment. To achieve both goals, alignment of different gradients should be considered, and this can be achieved by a number of methods we supplied, such as Procrustes alignment. This allows researchers to both compare gradients from different modalities and to homogenize measures across subjects, while minimizing the changes to individual manifolds. Our evaluations highlighted an increase in correspondence between individual subjects and the template manifold when Procrustes alignment was used compared to unaligned approaches, mainly driven by trivial changes in the sign of specific gradients in a subgroup of subjects. As an alternative to Procrustes alignment, it is also possible to align gradients via joint manifold alignments, often referred to as joint embedding<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. The gradients provided by this approach can augment both cross-subject<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> as well as cross-species analyses<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Of note, joint embeddings generate a new manifold, which may result in new solutions that might slightly differ from the initial gradients computed individually.</p>
    <p id="Par27">When assessing the significance of correlations between gradients and other features of brain organization, there is an increasing awareness to ideally also evaluate correlations against null models with a similar spatial autocorrelation as the original features. BrainSpace provides two different approaches to build null models, including an adaptation of a previously released spin permutation test<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> and Moran’s spectral randomization<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Gradients can also serve as a coordinate system, and stratify cortical features that are not gradient-based per se. Examples include surface-based geodesic distance measures from sensory-motor regions to other regions of cortex<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, task-based functional activation patterns and meta-analytical data<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, as well as MRI-based cortical thickness and PET-derived amyloid beta uptake measures<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. As such, using manifolds as a new coordinate system<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> may complement widely used parcellation approaches<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup> and be can be useful for the compact representation of findings and aid in the interpretation and communication of results.</p>
    <p id="Par28">Although, we have only illustrated the use of our toolbox with neocortical surface data, the gradient-based functionality of BrainSpace is not restricted to these regions and can also be used with other datasets (e.g., hippocampal measures, subcortical measures, and volumetric data). However, as of version 0.1, visualization is only available for surface meshes. Extending the visualization functionality of BrainSpace to support other cerebral structures and volumetric data is a promising line of future work.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Input data description</title>
      <p id="Par29">Our toolbox requires a real input matrix. Let <italic>X</italic> <italic>∈</italic> ℝ<sup><italic>n</italic>×<italic>p</italic></sup> be a matrix aggregating features of several seed regions. In other words, each seed is represented by a <italic>p</italic>-dimensional vector, <italic>x</italic><sub><italic>i</italic></sub>, built based on the features of the <italic>i</italic>-th seed region, where <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\left( {i,j} \right) = x_i^j$$\end{document}</tex-math><mml:math id="M2"><mml:mi>X</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq1.gif"/></alternatives></inline-formula> denotes the <italic>j</italic>-th feature of the <italic>i</italic>-th seed. In many neuroimaging applications, <italic>X</italic> may represent a connectivity metric (e.g., resting-state functional MRI connectivity or diffusion MRI tractography derived structural connectivity) between different seed and target brain regions. When seed and target regions are identical, the input matrix <italic>X</italic> is square. Furthermore, if the connectivity measure used to build the matrix is non-directional, <italic>X</italic> is also symmetric. If seeds and targets are different, for example when assessing connectivity patterns of a given region with the rest of the brain<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, we may have that n ≠ <italic>p</italic>, resulting in a non-square matrix. The dimensions and symmetry properties of the input matrix <italic>X</italic> may interact with the dimensionality reduction procedures presented in section 4.5. A simple strategy to make matrices symmetric and square is to use kernel functions, which will be covered in the following section.</p>
    </sec>
    <sec id="Sec10">
      <title>Affinities and kernel functions</title>
      <p id="Par30">Since we are interested in studying the relationships between the seed regions in terms of their features (e.g., connectivity with target regions), our toolbox provides several kernel functions to compute the relationship between every pair of seed regions and derive a non-negative square symmetric affinity matrix A <italic>∈</italic> <sup><italic>n</italic>×<italic>n</italic></sup>, where A(<italic>i</italic>, <italic>j</italic>) = A(<italic>j</italic>, <italic>i</italic>) denotes the similarity or ‘affinity’ between seeds <italic>I</italic> and <italic>j</italic>. Moreover, a square symmetric matrix is a requirement for the next step in our framework (i.e., dimensionality reduction). Note that when the input matrix <italic>X</italic> is already square and symmetric (e.g., seed and target regions are the same), there may be no need to derive the affinity matrix and <italic>X</italic> can be used directly to perform dimensionality reduction. Accordingly, BrainSpace provides the option of skipping this step and using the input matrix as the affinity.</p>
      <p id="Par31">There are numerous kernels to compute affinity matrices. As of version 0.1, our toolbox implements the following: Gaussian, cosine similarity, normalized angle similarity, Pearson’s correlation coefficient, and Spearman rank order correlations. For simplicity, let <bold><italic>x</italic></bold> = <bold><italic>x</italic></bold><sub><italic>i</italic></sub> and <bold><italic>y</italic></bold> = <bold><italic>x</italic></bold><sub><italic>j</italic></sub>, these kernels can be expressed as follows:</p>
      <p id="Par32">1. Gaussian kernel:<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left( {i,j} \right) = e^{ - (\gamma \left\| {\boldsymbol{x}} - {\boldsymbol{y}} \right\|^2)},$$\end{document}</tex-math><mml:math id="M4"><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>γ</italic> is the inverse kernel width and ||■|| denotes the <italic>l</italic><sub>2</sub>-norm.</p>
      <p id="Par33">2. Cosine similarity:<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left( {i,j} \right) = cossim\left( {{\boldsymbol{x}},{\boldsymbol{y}}} \right) = \frac{{{\boldsymbol{xy}}^T}}{{\left\| \boldsymbol{x} \right\|{\left\| \boldsymbol{y} \right\|}}},$$\end{document}</tex-math><mml:math id="M6"><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">xy</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <italic>cossim</italic> (■,■) is the cosine similarity function and <italic>T</italic> stands for transpose.</p>
      <p id="Par34">3. Normalized angle similarity:<disp-formula id="Equc"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left( {i,j} \right) = 1 - \frac{{{\mathrm{cos}}^{ - 1}\left( {cossim\left( {{\boldsymbol{x}},{\boldsymbol{y}}} \right)} \right)}}{\pi }.$$\end{document}</tex-math><mml:math id="M8"><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par35">4. Pearson correlation:<disp-formula id="Equd"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left( {i,j} \right) = \rho \left( {{\boldsymbol{x}},{\boldsymbol{y}}} \right) = cossim\left( {{\boldsymbol{x}} - {\bar{\boldsymbol{x}}},{\boldsymbol{y}} - {\bar{\boldsymbol{y}}}} \right),$$\end{document}</tex-math><mml:math id="M10"><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <bold><italic>ρ</italic></bold> is the Pearson correlation coefficient, and <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{\boldsymbol{x}}}$$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{\boldsymbol{y}}}$$\end{document}</tex-math><mml:math id="M14"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq3.gif"/></alternatives></inline-formula> denote the means of <bold><italic>x</italic></bold> and <bold><italic>y</italic></bold>, respectively.</p>
      <p id="Par36">5. Spearman rank order correlation:<disp-formula id="Eque"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left( {i,j} \right) = \rho \left( {{\boldsymbol{r}}_{\boldsymbol{x}},{\boldsymbol{r}}_{\boldsymbol{y}}} \right),$$\end{document}</tex-math><mml:math id="M16"><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <bold><italic>r</italic></bold><sub><italic>x</italic></sub> and <bold><italic>r</italic></bold><sub><italic>y</italic></sub> denote the ranks of <bold><italic>x</italic></bold> and <bold><italic>y</italic></bold>, respectively.</p>
      <p id="Par37">Version 0.1 of BrainSpace thus includes commonly used kernels in the gradient literature and additional ones for experimentation. To our knowledge, no gradient paper has used Pearson or Spearman correlation. Note that if <italic>X</italic> is already row-wise demeaned, Pearson correlation amounts to cosine similarity. The Gaussian kernel is widely used in the machine learning community (for example in the context of Laplacian eigenmaps and support vector machines), which provides a simple approach to convert Euclidean distances between our seeds into similarities. Cosine similarity, (example application<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>:), computes the angle between our feature vectors to describe their similarity. Notably, cosine similarity ranges from -1 to 1, with negative correlations to be transformed to non-negative values. This motivated inclusion of the normalized angle kernel (example application:<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>), which circumvents negative similarities by transforming similarities to [0,1], with 1 denoting identical angles, and 0 opposing angles. Cosine similarity and Pearson and Spearman correlation coefficients may produce negative values (i.e., [–1,1]) if feature vectors are negatively correlated. A simple mitigation is to set negative values to zero<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Additionally, BrainSpace provides an option for row-wise thresholding of the input matrix<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. Each vector of the input matrix is thresholded at a given sparsity (e.g., by keeping the weights of the top 10\% entries for each region). This procedure ensures that only strong, potentially less noisy, connections contribute to the manifold solution.</p>
      <p id="Par38">In addition to the aforementioned kernels, BrainSpace provides the option to provide a custom kernel or of skipping this step and using the input matrix as an affinity matrix.</p>
    </sec>
    <sec id="Sec11">
      <title>Dimensionality reduction</title>
      <p id="Par39">In the input matrix, each seed <bold><italic>x</italic></bold><sub><italic>i</italic></sub> is defined by a <italic>p</italic>-dimensional feature vector, where <italic>p</italic> may denote hundreds of parcels or thousands of vertices/voxels. The aim of dimensionality reduction techniques is to find a meaningful underlying low-dimensional representation, <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}} \in {\Bbb R}^{n \times m}$$\end{document}</tex-math><mml:math id="M18"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq4.gif"/></alternatives></inline-formula> with <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \ll p$$\end{document}</tex-math><mml:math id="M20"><mml:mi>m</mml:mi><mml:mo>≪</mml:mo><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq5.gif"/></alternatives></inline-formula>, hidden in the high-dimensional ambient space. These methods can be grouped into linear and non-linear techniques. The former use a linear transformation to unravel the latent representation, while techniques in the second category use non-linear transformations. As of version 0.1, BrainSpace provides three of the most widely used dimensionality reduction techniques for macroscale gradient mapping: PCA for linear embedding, and LE and DM for non-linear dimensionality reduction.<list list-type="order"><list-item><p id="Par40">PCA is a linear approach that transforms the data to a low-dimensional space represented by a set of orthogonal components that explain maximal variance. Given a column-wise demeaned version of the input matrix <italic>X</italic><sub><italic>d</italic></sub>, the low-dimensional representation is computed as follows:<disp-formula id="Equf"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_{PCA} = US^T,$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>where <italic>U</italic> are the left singular vectors and <italic>S</italic> a diagonal matrix of singular values obtained after factorizing the input matrix using singular value decomposition, <italic>X</italic><sub><italic>d</italic></sub> = <italic>USV</italic><sup><italic>T</italic></sup>. Although here we present the singular value decomposition version below, PCA can also be performed via eigendecomposition of the covariance matrix of <italic>X</italic>.</p></list-item><list-item><p id="Par41">LE is a non-linear dimensionality reduction technique that uses the graph Laplacian of the affinity matrix <italic>A</italic> to perform the embedding:<disp-formula id="Equg"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = D - A,$$\end{document}</tex-math><mml:math id="M24"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where the degree matrix <italic>D</italic> is a diagonal matrix defined as <inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left( {i,i} \right) = \mathop {\sum }\nolimits_j A\left( {i,j} \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>D</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq6.gif"/></alternatives></inline-formula> and <italic>L</italic> is the graph Laplacian matrix. Note that we can also work with its normalized version instead <inline-formula id="IEq7"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_S = D^{1/2}LD^{1/2}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq7.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. LE then proceeds to solve the generalized eigenvalue problem:<disp-formula id="Equh"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L{\boldsymbol{g}} = \lambda D{\boldsymbol{g}},$$\end{document}</tex-math><mml:math id="M30"><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mi>D</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where the eigenvectors <bold>g</bold><sub><italic>k</italic></sub> corresponding to the <italic>m</italic> smallest eigenvalues λ<sub><italic>k</italic></sub> (excluding the first eigenvalue) are used to build the new low-dimensional representation:<disp-formula id="Equi"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_{LE} = \left[ {{\boldsymbol{g}}_1,{\boldsymbol{g}}_2, \ldots ,{\boldsymbol{g}}_m} \right].$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par42">DM also seeks a non-linear mapping of the data based on the diffusion operator <italic>P</italic><sub>α</sub>, which is defined as follows:<disp-formula id="Equj"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_\alpha = D_\alpha ^{ - 1}W_\alpha ,$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par037">where <italic>α</italic> ∈ [0,1] is the anisotropic diffusion parameter used by the diffusion operator, <inline-formula id="IEq8"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_\alpha = D^{ - 1/\alpha }AD^{ - 1/\alpha }$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq8.gif"/></alternatives></inline-formula> is built by normalizing the affinity matrix according to the diffusion parameter and <italic>D</italic><sub>α</sub> is the degree matrix derived from <italic>W</italic><sub>α</sub>. When <italic>α</italic> = 0, the diffusion amounts to normalized graph Laplacian on isotropic weights, for <italic>α</italic> = 1, it approximates the Laplace-Beltrami operator and for the case where <italic>α</italic> = 0.5 it approximates the Fokker-Planck diffusion<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. This parameter controls the influence of the density of sampling points on the manifold (<italic>α</italic> = 0, maximal influence; <italic>α</italic> = 1, no influence). In the gradient literature, the anisotropic diffusion hyper-parameter is commonly set to <italic>α</italic> = 0,5<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, a choice that retains global relations between data points in the embedded space. Similar to LE, DM computes the eigenvalues and eigenvectors of the diffusion operator. However, in this case, the new representation is constructed with the scaled eigenvectors corresponding to the largest eigenvalues, after omitting the eigenvector with the largest eigenvalue:<disp-formula id="Equk"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_{DM} = \left[ {\lambda _1^t{\boldsymbol{g}}_1,\lambda _2^t{\boldsymbol{g}}_2, \ldots ,\lambda _m^t{\boldsymbol{g}}_m} \right],$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic> is the time parameter that represent the scale.</p>
      <p id="Par43">All aforementioned dimensionality reduction approaches assume that our high-dimensional data lies on some low-dimensional manifold embedded in ambient space, which is typically the case with neuroimaging datasets. These techniques, therefore, provide a convenient approach to handle the curse of dimensionality inherent to neuroimaging data. Moreover, they facilitate comparison by recovering representations with the same number of dimensions even when source data is non-comparable in ambient space (for example when subjects have different fMRI time series of different lengths). PCA, in particular, is able to discover the low-dimensional structure when the data lies in an approximately linear manifold, but performs poorly when there are non-linear relationships within the data. In such scenarios, LE and DM are more appropriate to discover the intrinsic geometric structure. From a technical point of view, the advantage of PCA over the non-linear approaches included in BrainSpace is that it provides a mapping from the high- to the low-dimensional space rather than simply producing the new low-dimensional representations. Hence, the choice between linear and non-linear dimensionality reduction is problem-dependent and may also be influenced by the nature of the data under study.</p>
    </sec>
    <sec id="Sec12">
      <title>Alignment of gradients</title>
      <p id="Par44">Gradients computed separately for two or more datasets (e.g., patients vs controls, left vs right hippocampi) may not be directly comparable due to different eigenvector orderings in case of eigenvalue multiplicity (i.e., eigenvalues with the same value) and sign ambiguity of the eigenvectors<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. Aligning gradients improves comparability and correspondence. However, we recommend visually inspecting the alignment results; if the manifold spaces are substantially different, then alignments may not provide sensible output. In version 0.1 of the BrainSpace toolbox, gradients can be aligned using Procrustes analysis<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> or implicitly by joint embedding.</p>
    </sec>
    <sec id="Sec13">
      <title>Procrustes analysis</title>
      <p id="Par45">Given a source <inline-formula id="IEq9"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_s$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq9.gif"/></alternatives></inline-formula> and a target <inline-formula id="IEq10"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_t$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq10.gif"/></alternatives></inline-formula> representation, Procrustes analysis seeks an orthogonal linear transformation <italic>ψ</italic> to align the source to the target, such that <inline-formula id="IEq11"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi ({\cal{G}}_s)$$\end{document}</tex-math><mml:math id="M44"><mml:mi>ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_t$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq12.gif"/></alternatives></inline-formula> are superimposed. Translation and scaling can also be performed by initially centering and normalizing the data prior to estimation of the transformation. For multiple datasets, a generalized Procrustes analysis can be employed. Let <inline-formula id="IEq13"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_k,k = 1,2, \ldots ,N$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq13.gif"/></alternatives></inline-formula> be the low-dimensional representations of <italic>N</italic> different datasets (i.e., input matrices <italic>X</italic><sub>K</sub>). The procedure proceeds iteratively by aligning all representations <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_k$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq14.gif"/></alternatives></inline-formula> to a reference and updating the reference <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_R = \frac{1}{N}\mathop {\sum }\nolimits_k \psi ({\cal{G}}_k)$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq15.gif"/></alternatives></inline-formula> by averaging the aligned representations. In the first iteration, the reference can be chosen from the available representations, or an out-of-sample template can be provided (e.g., from a hold-out group).</p>
    </sec>
    <sec id="Sec14">
      <title>Joint embedding</title>
      <p id="Par46">Joint embedding is a dimensionality reduction technique that finds a common underlying representation of multiple datasets via simultaneous embedding<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. The main challenge of this technique is to find a meaningful approach to establish correspondences between original datasets (i.e., <italic>X</italic>). In version 0.1 of BrainSpace, joint alignment is implemented based on spectral embedding and available for LE and DM. The only difference with these methods is that the embedding, rather than using the affinity matrices individually, is based on the joint affinity matrix <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{J}}$$\end{document}</tex-math><mml:math id="M54"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">J</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq16.gif"/></alternatives></inline-formula>, built as:<disp-formula id="Equl"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{J}} = \left( {\begin{array}{*{20}{c}} {A_1} &amp; {A_{12}} &amp; \cdots &amp; {A_{1N}} \\ {A_{12}^T} &amp; {A_2} &amp; \cdots &amp; {A_{2N}} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {A_{1N}^T} &amp; {A_{2N}^T} &amp; \cdots &amp; {A_N} \end{array}} \right)$$\end{document}</tex-math><mml:math id="M56"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">J</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋯</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋯</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:mo>⋯</mml:mo><mml:mspace width="0.25em"/></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2020_794_Article_Equl.gif" position="anchor"/></alternatives></disp-formula>where <italic>A</italic><sub><italic>k</italic></sub> is the intra-dataset affinity of the input matrix <italic>X</italic><sub><italic>k</italic></sub> and <italic>A</italic><sub><italic>ij</italic></sub> is the inter-dataset affinity between <italic>X</italic><sub><italic>i</italic></sub> and <italic>X</italic><sub><italic>j</italic></sub>. As of version 0.1, both sets of affinities are built using the same kernel. It is important to note, therefore, that joint embedding can only be used if the input matrices have the same features (e.g., identical target regions). After the embedding, the resulting shared representation <inline-formula id="IEq17"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_J = [ {{\cal{G}}_{1,}{\cal{G}}_2, \ldots ,{\cal{G}}_N} ]^T$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq17.gif"/></alternatives></inline-formula> will be composed of <italic>N</italic> individual low-dimensional representations, such that for the k-th input matrix <italic>X</italic><sub><italic>k</italic></sub>
<italic>∈</italic> ℝ<inline-formula id="IEq01"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{n_k}$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq01.gif"/></alternatives></inline-formula><sup>×<italic>m</italic></sup>, the corresponding representation is <inline-formula id="IEq18"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{G}}_k \in {\Bbb R}^{n_k \times m}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq18.gif"/></alternatives></inline-formula>, where <italic>n</italic><sub><italic>k</italic></sub> is the number of seeds (i.e., rows) of <italic>X</italic><sub><italic>k</italic></sub>.</p>
    </sec>
    <sec id="Sec15">
      <title>Null models</title>
      <p id="Par47">Many researchers have compared gradients to other continuous brain markers such as cortical thickness measures or estimates of cortical myelination. Given the spatial autocorrelation present in many modalities, applying linear regression or similar methods may provide biased test statistics. To circumvent this issue, we recommend comparing the observed test statistic to those of a set of distributions with similar spatial autocorrelation. To this end, we provide two methods: spin permutations<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> and Moran spectral randomization (MSR)<sup><xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup>. In cases where the input data lies on a surface and most of the sphere is used or if data can be mapped to a sphere, we recommend spin permutation. Otherwise, we recommend MSR. When performing a statistical test with multiple gradients as either predictor or response variable, we recommend randomizing the non-gradient variable as these randomizations need not maintain statistical independence across different eigenvectors.</p>
    </sec>
    <sec id="Sec16">
      <title>Spin permutations</title>
      <p id="Par48">Spin permutation analysis leverages spherical representations of the cerebral cortex, such as those derived from FreeSurfer<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> or CIVET<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>, to address the problem of spatial autocorrelation in statistical inference. Spin permutations estimate the null distribution by randomly rotating the spherical projections of the cortical surface while preserving the spatial relationships within the data<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Let <italic>V</italic><sub><italic>r</italic></sub>
<italic>∈</italic> ℝ<sup><italic>1</italic>×<italic>3</italic></sup> be the matrix of vertex coordinates in the sphere, where <italic>l</italic> is the number of vertices, and <italic>R ∈</italic> ℝ<sup>3×3</sup> a matrix representing a rotation along the three axes uniformly sampled from all possible rotations<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. The rotated sphere <italic>V</italic><sub><italic>r</italic></sub> is computed as follows:<disp-formula id="Equm"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_r = VR.$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mi>R</mml:mi><mml:mo>.</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">Samples of the null distribution are then created by assigning each vertex on <italic>V</italic><sub><italic>r</italic></sub> the data of its nearest neighbor on <italic>V</italic>.</p>
    </sec>
    <sec id="Sec17">
      <title>Moran spectral randomization</title>
      <p id="Par50">Borrowed from the ecology literature, MSR can also be used to generate random variables with identical or similar spatial autocorrelation (in terms of Moran’s <italic>I</italic> correlation coefficient<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>). This approach requires building a spatial weight matrix defining the relationships between the different locations. For our particular case, given a surface mesh with <italic>I</italic> vertices (i.e., locations), its topological information is used to build the spatial weight matrix <italic>L ∈</italic>
<inline-formula id="IEq002"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}$$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq002.gif"/></alternatives></inline-formula><sup><italic>l</italic>×<italic>l</italic></sup>, such that <italic>L</italic>(<italic>i</italic>, <italic>j</italic>) &gt; 0 if vertices <italic>i</italic> and <italic>j</italic> are neighbors, and <italic>L</italic>(<italic>i</italic>, <italic>j</italic>) = 0 otherwise. In BrainSpace, <italic>L</italic> is built using the inverse distance between each vertex and the vertices in its immediate neighborhood, although other neighborhoods and weighting schemes (e.g., binary or Gaussian weights) can also be incorporated. The computed <italic>L</italic> is doubly centered and eigendecomposed into its whole spectrum, with the resulting eigenvectors <italic>M</italic> <italic>∈</italic> <inline-formula id="IEq02"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}$$\end{document}</tex-math><mml:math id="M68"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq02.gif"/></alternatives></inline-formula><sup><italic>l</italic>×<italic>l</italic>–1</sup> being the so-called Moran eigenvector maps. Note that eigenvectors with 0 eigenvalue are dropped. One advantage of MSR is that we can work with the original cortical surfaces, and thus skip potential distortions introduced by spherical mesh parameterization.</p>
      <p id="Par51">To generate null distributions, let <bold><italic>u</italic></bold> <italic>∈</italic> <inline-formula id="IEq03"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}$$\end{document}</tex-math><mml:math id="M70"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq03.gif"/></alternatives></inline-formula><sup><italic>l</italic></sup> be an input feature vector defined on each vertex of our surface (e.g., cortical thickness), and <bold><italic>r</italic></bold> <italic>∈</italic> <inline-formula id="IEq04"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}$$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq04.gif"/></alternatives></inline-formula><sup><italic>l</italic>–<italic>1</italic></sup> the correlation coefficients of <bold><italic>u</italic></bold> with each spatial eigenvector in <italic>M</italic>. MSR aims to find a randomized feature vector <bold><italic>z</italic></bold> that respects the autocorrelation observed in <bold><italic>u</italic></bold> as follows:<disp-formula id="Equn"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{z}} = {\bar{\boldsymbol{u}}} + \sigma _x\sqrt {l - 1} {\cal{M}}a^T,$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:msqrt><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_794_Article_Equn.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{\boldsymbol{u}}}$$\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq19.gif"/></alternatives></inline-formula> and σ<sub><italic>u</italic></sub> stand for mean and standard deviation of <bold><italic>u</italic></bold> respectively, and <bold><italic>a</italic></bold> <italic>∈</italic> ℝ<sup><italic>l</italic>–<italic>1</italic></sup> is a vector of random coefficients. Three different methods exist for generating vector <bold><italic>a</italic></bold>: singleton, pair, and triplet. As of version 0.1, only the singleton and pair procedures are supported in BrainSpace. Let <bold><italic>v</italic></bold> = M<bold><italic>r</italic></bold><sup><italic>T</italic></sup>, in the singleton procedure, <bold><italic>a</italic></bold> is computed by randomizing the sign of each element in <bold><italic>v</italic></bold> (i.e., <inline-formula id="IEq20"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_i = \pm {\boldsymbol{v}}_i$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq20.gif"/></alternatives></inline-formula>). In the pair procedure, the elements of <bold><italic>v</italic></bold> are randomly changed in pairs. Let (<bold><italic>v</italic></bold><sub>i,</sub>
<bold><italic>v</italic></bold><sub>j</sub>) be a pair of elements randomly chosen, then <bold><italic>a</italic></bold> is updated such that <inline-formula id="IEq21"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{a}}_i = q_{ij}\cos (\phi )$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{a}}_j = q_{ij}\sin (\phi )$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq22.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq23"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{ij} = \sqrt {{\boldsymbol{v}}_i^2 + {\boldsymbol{v}}_j^2}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi \sim {\cal{U}}(0,2\pi )$$\end{document}</tex-math><mml:math id="M86"><mml:mi>ϕ</mml:mi><mml:mo>~</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="42003_2020_794_Article_IEq24.gif"/></alternatives></inline-formula> randomly drawn from a uniform distribution. If the number of elements of <bold><italic>v</italic></bold> is odd, the singleton procedure is used for the remaining element.</p>
      <p id="Par52">As opposed to the singleton procedure, the null data generated by the pair procedure does not fully preserve the observed spatial autocorrelation. We therefore recommend the singleton procedure, unless the number of required randomizations exceeds 2<sup><italic>l</italic>–<italic>1</italic></sup>, which is the maximum number of unique randomizations that can be produced using the singleton procedure.</p>
    </sec>
    <sec id="Sec18">
      <title>Participants</title>
      <p id="Par53">All data were derived from the Human Connectome Project dataset<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. For all figures showing results based only on FC, we included subjects processed for a prior study (<italic>n</italic> = 217 (122 women), mean ± SD age = 28.5 ± 3.7 y]<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. In short, these were subjects for whom all resting-state fMRI and anatomical scans were fully completed, and no familial relationships existed between subjects in this group. Data shown for comparisons between FC and MPC were derived from the subjects available both in the prior dataset as well as the data used by ref. <sup><xref ref-type="bibr" rid="CR22">22</xref></sup> [<italic>n</italic> = 70 (41 women), mean ± SD age = 28.7 ± 3.9 y]. As part of the Human Connectome Project acquisitions, informed consent was obtained from all subjects and all procedures were approved by the Washington University institutional review board.</p>
    </sec>
    <sec id="Sec19">
      <title>Reporting summary</title>
      <p id="Par54">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="42003_2020_794_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="42003_2020_794_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="42003_2020_794_MOESM3_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Reinder Vos de Wael, Oualid Benkarim, Jonathan Smallwood, Boris C. Bernhardt.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s42003-020-0794-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Mr. Vos de Wael was funded by the Savoy Foundation for Epilepsy Research. Dr. Oualid Benkarim was funded by a Healthy Brains for Healthy Lives (HBHL) postdoctoral fellowship. Dr. Jessica Royer was supported by a Canadian Open Neuroscience Platform (CONP) fellowship. Dr Smallwood was supported by the European Research Council (WANDERINGMINDS—ERC646927). Dr. Paquola was funded through a postdoctoral fellowship of the Transforming Autism Care Consortium (TACC) and the Fonds de la recherche du Québec—Santé (FRQ-S). Dr. Boris Bernhardt acknowledges research support from the National Science and Engineering Research Council of Canada (NSERC, Discovery-1304413), the Canadian Institutes of Health Research (CIHR, FDN-154298), the Azrieli Center for Autism Research of the Montreal Neurological Institute (ACAR), SickKids Foundation (NI17-039), and the Canada Research Chairs (CRC) Program. Data were provided, in part, by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>R.V., O.B., J.S. and B.B. developed the toolbox, designed the validations, and wrote the paper. S.L., D.M., J.R., S.T., S.V, C.P. and S.H., tested the toolbox and revised the paper. M.M., G.L., T.X. and B.M. revised and approved the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All data are freely provided by the Human Connectome Project<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> and available from connectomeDB<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://db.humanconnectome.org/">https://db.humanconnectome.org/</ext-link>).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Our toolbox is freely available at: <ext-link ext-link-type="uri" xlink:href="http://github.com/MICA-MNI/BrainSpace">http://github.com/MICA-MNI/BrainSpace</ext-link>. The toolbox contains a parallel Python and Matlab implementation with closely-matched functionality (The Python implementation of BrainSpace incorporates a wrapper for VTK, which helps simplify object creation and pipelining). Along with the code, the toolbox contains several surface models, parcellations across multiple scales, and example data to reproduce the evaluations presented in this tutorial. Additional documentation of the proposed toolbox is available for both Python and Matlab implementations via <ext-link ext-link-type="uri" xlink:href="http://brainspace.readthedocs.io">http://brainspace.readthedocs.io</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par55">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Flechsig, P. E. <italic>Anatomie des menschlichen Gehirns und Rückenmarks auf myelogenetischer Grundlage</italic> vol. 1 (G. Thieme, 1920).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glasser</surname>
            <given-names>MF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multi-modal parcellation of human cerebral cortex</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>536</volume>
        <fpage>171</fpage>
        <pub-id pub-id-type="doi">10.1038/nature18933</pub-id>
        <?supplied-pmid 4990127?>
        <pub-id pub-id-type="pmid">27437579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Brodmann, K. <italic>Vergleichende Lokalisationslehre der Grosshirnrinde in ihren Prinzipien dargestellt auf Grund des Zellenbaues</italic>. (Barth, 1909).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Palomero-Gallagher, N., &amp; Zilles, K. Cortical layers: Cyto-, myelo-, receptor-and synaptic architecture in human cortical areas. <italic>Neuroimage</italic><bold>197</bold>, 716-741 (2019).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">von Economo, C. F. &amp; Koskinas, G. N. <italic>Die Cytoarchitektonik der Hirnrinde des erwachsenen Menschen</italic>. (J. Springer, 1925).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dart</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>The dual structure of the neopallium: Its history and significance</article-title>
        <source>J. Anat.</source>
        <year>1934</year>
        <volume>69</volume>
        <fpage>3</fpage>
        <?supplied-pmid 17104513?>
        <pub-id pub-id-type="pmid">17104513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goulas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Majka</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Higetag</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A blueprint of mammalian cortical connectomes</article-title>
        <source>PLoS Biol.</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>e2005346</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2005346</pub-id>
        <?supplied-pmid 30901324?>
        <pub-id pub-id-type="pmid">30901324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Pandya, D., Petrides, M., &amp; Cipolloni, P. B. <italic>Cerebral Cortex—Architecture, connections and the dual origin concept</italic>. (Oxford University Press, 2015).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanides</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Comparative architectonics of the neocortex of mammals and their evolutionary interpretation</article-title>
        <source>Ann. N. Y. Acad. Sci.</source>
        <year>1969</year>
        <volume>167</volume>
        <fpage>404</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1749-6632.1969.tb20459.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eickhoff</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Genon</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Imaging-based parcellations of the human brain</article-title>
        <source>Nat. Rev. Neurosci.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>672</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1038/s41583-018-0071-7</pub-id>
        <?supplied-pmid 30305712?>
        <pub-id pub-id-type="pmid">30305712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margulies</surname>
            <given-names>DS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Situating the default-mode network along a principal gradient of macroscale cortical organization</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>12574</fpage>
        <lpage>12579</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1608282113</pub-id>
        <?supplied-pmid 27791099?>
        <pub-id pub-id-type="pmid">27791099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajada</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A graded tractographic parcellation of the temporal lobe</article-title>
        <source>NeuroImage</source>
        <year>2017</year>
        <volume>155</volume>
        <fpage>503</fpage>
        <lpage>512</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.04.016</pub-id>
        <?supplied-pmid 28411156?>
        <pub-id pub-id-type="pmid">28411156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cerliani</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic tractography recovers a rostrocaudal trajectory of connectivity variability in the human insular cortex</article-title>
        <source>Hum. Brain Mapp.</source>
        <year>2012</year>
        <volume>33</volume>
        <fpage>2005</fpage>
        <lpage>2034</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.21338</pub-id>
        <?supplied-pmid 21761507?>
        <pub-id pub-id-type="pmid">21761507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Guell, Xavier, Schmahmann, J. D., Gabrieli, J. D. D. E., &amp; Ghosh, S. S. Functional gradients of the cerebellum. <italic>ELife</italic>10.7554/eLife.36652 (2018).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haak</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Marquand</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Connectopic mapping with resting-state fMRI</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>170</volume>
        <fpage>83</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.06.075</pub-id>
        <?supplied-pmid 28666880?>
        <pub-id pub-id-type="pmid">28666880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larivière</surname>
            <given-names>Sara</given-names>
          </name>
          <name>
            <surname>Vos de Wael</surname>
            <given-names>Reinder</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>Seok-Jun</given-names>
          </name>
          <name>
            <surname>Paquola</surname>
            <given-names>Casey</given-names>
          </name>
          <name>
            <surname>Tavakol</surname>
            <given-names>Shahin</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>Alexander J</given-names>
          </name>
          <name>
            <surname>Schrader</surname>
            <given-names>Dewi V</given-names>
          </name>
          <name>
            <surname>Bernhardt</surname>
            <given-names>Boris C</given-names>
          </name>
        </person-group>
        <article-title>Multiscale Structure–Function Gradients in the Neonatal Connectome</article-title>
        <source>Cerebral Cortex</source>
        <year>2019</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1093/cercor/bhz069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marquand</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Haak</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Functional corticostriatal connection topographies predict goal directed behaviour in humans</article-title>
        <source>Nat. Hum. Behav.</source>
        <year>2017</year>
        <volume>1</volume>
        <fpage>0146</fpage>
        <pub-id pub-id-type="doi">10.1038/s41562-017-0146</pub-id>
        <?supplied-pmid 28804783?>
        <pub-id pub-id-type="pmid">28804783</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Przeździk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Faber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Haak</surname>
            <given-names>KV</given-names>
          </name>
        </person-group>
        <article-title>The functional organisation of the hippocampus along its long axis is gradual and predicts recollection</article-title>
        <source>Cortex</source>
        <year>2019</year>
        <volume>119</volume>
        <fpage>324</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cortex.2019.04.015</pub-id>
        <?supplied-pmid 31181420?>
        <pub-id pub-id-type="pmid">31181420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zalesky</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Characterizing the functional connectivity diversity of the insula cortex: Subregions, diversity curves and behavior</article-title>
        <source>Neuroimage</source>
        <year>2018</year>
        <volume>183</volume>
        <fpage>716</fpage>
        <lpage>733</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.08.055</pub-id>
        <?supplied-pmid 30172005?>
        <pub-id pub-id-type="pmid">30172005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Vos de Wael, R. et al. Anatomical and microstructural determinants of hippocampal subfield functional connectome embedding. <italic>Proc. Natl Acad. Sci.</italic><italic>USA</italic><bold>115</bold>, 10154–10159 (2018).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huntenburg</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A systematic relationship between functional connectivity and intracortical myelin in the human cerebral cortex</article-title>
        <source>Cereb. Cortex</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>981</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="doi">10.1093/cercor/bhx030</pub-id>
        <?supplied-pmid 28184415?>
        <pub-id pub-id-type="pmid">28184415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paquola</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microstructural and functional gradients are increasingly dissociated in transmodal cortices</article-title>
        <source>PLoS Biol.</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>e3000284</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.3000284</pub-id>
        <?supplied-pmid 31107870?>
        <pub-id pub-id-type="pmid">31107870</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagstyl</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ronan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodyer</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Cortical thickness gradients in structural hierarchies</article-title>
        <source>Neuroimage</source>
        <year>2015</year>
        <volume>111</volume>
        <fpage>241</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.02.036</pub-id>
        <?supplied-pmid 25725468?>
        <pub-id pub-id-type="pmid">25725468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Paquola, C. et al. The cortical wiring scheme of hierarchical information processing. <italic>BioRxiv</italic>, Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.01.08.899583v1">https://www.biorxiv.org/content/10.1101/2020.01.08.899583v1</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shine</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human cognition involves the dynamic integration of neural activity and neuromodulatory systems</article-title>
        <source>Nat. Neurosci.</source>
        <year>2019</year>
        <volume>22</volume>
        <fpage>289</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-018-0312-0</pub-id>
        <?supplied-pmid 30664771?>
        <pub-id pub-id-type="pmid">30664771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Vogel, J. W. et al. A molecular gradient along the longitudinal axis of the human hippocampus informs large-scale behavioral systems. <italic>Nat. Commun</italic>. (In Press).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Peng</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>Ru</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>Xiaolu</given-names>
          </name>
          <name>
            <surname>Liégeois</surname>
            <given-names>Raphaël</given-names>
          </name>
          <name>
            <surname>Orban</surname>
            <given-names>Csaba</given-names>
          </name>
          <name>
            <surname>Deco</surname>
            <given-names>Gustavo</given-names>
          </name>
          <name>
            <surname>van den Heuvel</surname>
            <given-names>Martijn P.</given-names>
          </name>
          <name>
            <surname>Thomas Yeo</surname>
            <given-names>B.T.</given-names>
          </name>
        </person-group>
        <article-title>Inversion of a large-scale circuit model reveals a cortical hierarchy in the dynamic resting human brain</article-title>
        <source>Science Advances</source>
        <year>2019</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>eaat7854</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aat7854</pub-id>
        <?supplied-pmid 30662942?>
        <pub-id pub-id-type="pmid">30662942</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distant from input: Evidence of regions within the default mode network supporting perceptually-decoupled and conceptually-guided cognition</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>171</volume>
        <fpage>393</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.01.017</pub-id>
        <?supplied-pmid 29339310?>
        <pub-id pub-id-type="pmid">29339310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modes of operation: a topographic neural gradient supporting stimulus dependent and independent cognition</article-title>
        <source>NeuroImage</source>
        <year>2019</year>
        <volume>186</volume>
        <fpage>487</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.11.009</pub-id>
        <?supplied-pmid 30447291?>
        <pub-id pub-id-type="pmid">30447291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sormaz</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Default mode network can support the level of detail in experience during active task states</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>9318</fpage>
        <lpage>9323</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1721259115</pub-id>
        <?supplied-pmid 30150393?>
        <pub-id pub-id-type="pmid">30150393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Atypical functional connectome hierarchy in autism</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1022</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-08944-1</pub-id>
        <?supplied-pmid 30833582?>
        <pub-id pub-id-type="pmid">30833582</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zalesky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bousman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Everall</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pantelis</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Insula functional connectivity in schizophrenia: subregions, gradients, and symptoms</article-title>
        <source>Biol. Psychiatry.: Cogn. Neurosci. Neuroimaging</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>399</fpage>
        <lpage>408</lpage>
        <pub-id pub-id-type="pmid">30691966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fulcher</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Zerbi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X-J</given-names>
          </name>
        </person-group>
        <article-title>Multimodal gradients across mouse cortex</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>4689</fpage>
        <lpage>4695</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814144116</pub-id>
        <?supplied-pmid 30782826?>
        <pub-id pub-id-type="pmid">30782826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huntenburg</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Bazin</surname>
            <given-names>P-L</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Large-scale gradients in human cortical organization</article-title>
        <source>Trends Cogn. Sci.</source>
        <year>2018</year>
        <volume>22</volume>
        <fpage>21</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tics.2017.11.002</pub-id>
        <?supplied-pmid 29203085?>
        <pub-id pub-id-type="pmid">29203085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckner</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Krienen</surname>
            <given-names>FM</given-names>
          </name>
        </person-group>
        <article-title>The evolution of distributed association networks in the human brain</article-title>
        <source>Trends Cogn. Sci.</source>
        <year>2013</year>
        <volume>17</volume>
        <fpage>648</fpage>
        <lpage>665</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tics.2013.09.017</pub-id>
        <?supplied-pmid 24210963?>
        <pub-id pub-id-type="pmid">24210963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckner</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Macroscale cortical organization and a default-like apex transmodal network in the marmoset monkey</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1976</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09812-8</pub-id>
        <?supplied-pmid 31036823?>
        <pub-id pub-id-type="pmid">31036823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Xu, T. et al. Cross-species functional alignment reveals evolutionary hierarchy within the connectome. <italic>BioRxiv</italic>, Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/692616v1">https://www.biorxiv.org/content/10.1101/692616v1</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Essen</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The WU-Minn Human Connectome Project: an overview</article-title>
        <source>Neuroimage</source>
        <year>2013</year>
        <volume>80</volume>
        <fpage>62</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.041</pub-id>
        <?supplied-pmid 23684880?>
        <pub-id pub-id-type="pmid">23684880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mcintosh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Misic</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Multivariate statistical analyses for neuroimaging data</article-title>
        <source>Annu. Rev. Psychol.</source>
        <year>2013</year>
        <volume>64</volume>
        <fpage>499</fpage>
        <lpage>525</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-psych-113011-143804</pub-id>
        <?supplied-pmid 22804773?>
        <pub-id pub-id-type="pmid">22804773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Worsley</surname>
            <given-names>KJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SurfStat: A Matlab toolbox for the statistical analysis of univariate and multivariate surface and volumetric data using linear mixed effects models and random field theory</article-title>
        <source>Neuroimage</source>
        <year>2009</year>
        <volume>47</volume>
        <fpage>S102</fpage>
        <pub-id pub-id-type="doi">10.1016/S1053-8119(09)70882-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Desikan</surname>
            <given-names>RS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest</article-title>
        <source>Neuroimage</source>
        <year>2006</year>
        <volume>31</volume>
        <fpage>968</fpage>
        <lpage>980</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.01.021</pub-id>
        <?supplied-pmid 16530430?>
        <pub-id pub-id-type="pmid">16530430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaefer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Local-global parcellation of the human cerebral cortex from intrinsic functional connectivity MRI</article-title>
        <source>Cereb. Cortex</source>
        <year>2017</year>
        <volume>28</volume>
        <fpage>3095</fpage>
        <lpage>3114</lpage>
        <pub-id pub-id-type="doi">10.1093/cercor/bhx179</pub-id>
        <?supplied-pmid 6095216?>
        <pub-id pub-id-type="pmid">6095216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mesulam</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>From sensation to cognition</article-title>
        <source>Brain</source>
        <year>1998</year>
        <volume>121</volume>
        <fpage>1013</fpage>
        <lpage>1052</lpage>
        <pub-id pub-id-type="doi">10.1093/brain/121.6.1013</pub-id>
        <?supplied-pmid 9648540?>
        <pub-id pub-id-type="pmid">9648540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Larivière, S. et al. Functional connectome contractions in temporal lobe epilepsy. <italic>BioRxiv</italic>, Preprint at <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/756494v1">https://www.biorxiv.org/content/10.1101/756494v1</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lowe</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Targeting age-related differences in brain and cognition with multimodal imaging and connectome topography profiling</article-title>
        <source>Hum. Brain Mapp.</source>
        <year>2019</year>
        <volume>40</volume>
        <fpage>5213</fpage>
        <lpage>5230</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.24767</pub-id>
        <?supplied-pmid 31444896?>
        <pub-id pub-id-type="pmid">31444896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexander-Bloch</surname>
            <given-names>Aaron F.</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>Haochang</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Siyuan</given-names>
          </name>
          <name>
            <surname>Satterthwaite</surname>
            <given-names>Theodore D.</given-names>
          </name>
          <name>
            <surname>Glahn</surname>
            <given-names>David C.</given-names>
          </name>
          <name>
            <surname>Shinohara</surname>
            <given-names>Russell T.</given-names>
          </name>
          <name>
            <surname>Vandekar</surname>
            <given-names>Simon N.</given-names>
          </name>
          <name>
            <surname>Raznahan</surname>
            <given-names>Armin</given-names>
          </name>
        </person-group>
        <article-title>On testing for spatial correspondence between maps of human brain structure and function</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>178</volume>
        <fpage>540</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.05.070</pub-id>
        <?supplied-pmid 29860082?>
        <pub-id pub-id-type="pmid">29860082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guell</surname>
            <given-names>Xavier</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LittleBrain: a gradient-based tool for the topographical interpretation of cerebellar neuroimaging findings</article-title>
        <source>PLoS One</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>e2005346</fpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nenning</surname>
            <given-names>K-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diffeomorphic functional brain surface alignment: functional demons</article-title>
        <source>NeuroImage</source>
        <year>2017</year>
        <volume>156</volume>
        <fpage>456</fpage>
        <lpage>465</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.04.028</pub-id>
        <?supplied-pmid 28416451?>
        <pub-id pub-id-type="pmid">28416451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cliff</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Ord</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <source>Spatial autocorrelation</source>
        <year>1973</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Pion</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeo</surname>
            <given-names>BTT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The organization of the human cerebral cortex estimated by intrinsic functional connectivity</article-title>
        <source>J. Neurophysiol.</source>
        <year>2011</year>
        <volume>106</volume>
        <fpage>1125</fpage>
        <lpage>1165</lpage>
        <pub-id pub-id-type="doi">10.1152/jn.00338.2011</pub-id>
        <?supplied-pmid 21653723?>
        <pub-id pub-id-type="pmid">21653723</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Ng, A. Y., Jordan, M. I., &amp; Weiss, Y. On spectral clustering: analysis and an algorithm. <italic>Adv. Neural. Inf. Process Syst.</italic> 849–856 (2001).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coifman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Lafon</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Diffusion maps</article-title>
        <source>Appl. Computational Harmonic Anal.</source>
        <year>2006</year>
        <volume>21</volume>
        <fpage>5</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1016/j.acha.2006.04.006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lombaert</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Grady</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Polimeni</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Cheriet</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>FOCUSR: feature oriented correspondence using spectral regularization—a method for precise surface matching</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2013</year>
        <volume>35</volume>
        <fpage>2143</fpage>
        <lpage>2160</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2012.276</pub-id>
        <?supplied-pmid 23868776?>
        <pub-id pub-id-type="pmid">23868776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Langs, G., Golland, P., &amp; Ghosh, S. S. Predicting activation across individuals with resting-state functional connectivity based multi-atlas label fusion. <italic>International Conference on Medical Image Computing and Computer-Assisted Intervention</italic>, 313–320 (2015).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dray</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A new perspective about Moran’s coefficient: spatial autocorrelation as a linear regression problem</article-title>
        <source>Geographical Anal.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>127</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1538-4632.2011.00811.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Dray</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Generating spatially constrained null models for irregularly spaced data using Moran spectral randomization methods</article-title>
        <source>Methods Ecol. Evolution</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>1169</fpage>
        <lpage>1178</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>FreeSurfer</article-title>
        <source>Neuroimage</source>
        <year>2012</year>
        <volume>62</volume>
        <fpage>774</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.01.021</pub-id>
        <?supplied-pmid 22248573?>
        <pub-id pub-id-type="pmid">22248573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated 3-D extraction and evaluation of the inner and outer cortical surfaces using a Laplacian map and partial volume effect classification</article-title>
        <source>Neuroimage</source>
        <year>2005</year>
        <volume>27</volume>
        <fpage>210</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2005.03.036</pub-id>
        <?supplied-pmid 15896981?>
        <pub-id pub-id-type="pmid">15896981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fryzlewicz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Random rotation ensembles</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>126</fpage>
        <lpage>151</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hodge</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ConnectomeDB—sharing human brain connectivity data</article-title>
        <source>Neuroimage</source>
        <year>2016</year>
        <volume>124</volume>
        <fpage>1102</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.04.046</pub-id>
        <?supplied-pmid 25934470?>
        <pub-id pub-id-type="pmid">25934470</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
