<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7353747</article-id>
    <article-id pub-id-type="publisher-id">2083</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-020-02083-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DISC: a highly scalable and accurate inference of gene expression and structure for single-cell transcriptomes using semi-supervised deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>He</surname>
          <given-names>Yao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Yuan</surname>
          <given-names>Hao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Cheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5589-4836</contrib-id>
        <name>
          <surname>Xie</surname>
          <given-names>Zhi</given-names>
        </name>
        <address>
          <email>xiezhi@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.12981.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2360 039X</institution-id><institution>State Key Laboratory of Ophthalmology, Zhongshan Ophthalmic Center, </institution><institution>Sun Yat-sen University, </institution></institution-wrap>Guangzhou, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>170</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Dropouts distort gene expression and misclassify cell types in single-cell transcriptome. Although imputation may improve gene expression and downstream analysis to some degree, it also inevitably introduces false signals. We develop DISC, a novel deep learning network with semi-supervised learning to infer gene structure and expression obscured by dropouts. Compared with seven state-of-the-art imputation approaches on ten real-world datasets, we show that DISC consistently outperforms the other approaches. Its applicability, scalability, and reliability make DISC a promising approach to recover gene expression, enhance gene and cell structures, and improve cell type identification for sparse scRNA-seq data.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell</kwd>
      <kwd>Transcriptome</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Semi-supervised learning</kwd>
      <kwd>Imputation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key R&amp;D Program of China </institution>
        </funding-source>
        <award-id>2019YFA0904401</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xie</surname>
            <given-names>Zhi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2016YFC0901604</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xie</surname>
            <given-names>Zhi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31829002</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xie</surname>
            <given-names>Zhi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010031</institution-id>
            <institution>Postdoctoral Research Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019M663220</award-id>
        <principal-award-recipient>
          <name>
            <surname>He</surname>
            <given-names>Yao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Single-cell RNA sequencing (scRNA-seq) measures transcriptomes at single-cell resolution and is widely used to reveal cell heterogeneity and diversity. One of the major challenges in analyzing scRNA-seq data is excess false zero expressions, named dropouts, which distort gene expression distribution and cause misclassification of cell types [<xref ref-type="bibr" rid="CR1">1</xref>]. The recent advances in droplet- or combinatorial indexing-based sequencing technologies have dramatically increased the throughput from thousands to over a million of cells in a single experiment, causing more severe dropout problems due to shallow sequencing depth per cell [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par3">Imputation is a common approach to recover dropout events. Most imputation approaches are model-based that borrow information across cells to predict missing expression values [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Another related approach is “smoothing” that removes the high-frequency signals, including technical noise and dropouts [<xref ref-type="bibr" rid="CR8">8</xref>]. More recently, deep learning-based approaches have been developed to overcome the scalability issue by conventional approaches. For example, scVI, scScope, and DCA use deep autoencoder (AE) to learn feature representation to recover dropouts and DeepImpute uses a deep neural network to learn gene patterns [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par4">Although many imputation approaches have been shown to improve the gene expression structure and downstream analysis to some degree, many challenges exist. (1) Reliability: a recent benchmark study showed that most approaches increased sensitivity of recovery of dropouts by scarifying specificity. Therefore, unexpected false signals or other biases have been introduced by imputation [<xref ref-type="bibr" rid="CR13">13</xref>]. (2) Applicability: factors such as expression level and distribution, level of noises, and heterogeneity of cells affect the performance of imputation. Approaches based on some specific expression or dropout distribution may only work well on some specific datasets [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. (3) Scalability: conventional model-based approaches cannot handle large datasets, which however have been common in the field due to increasing throughput of scRNA-seq [<xref ref-type="bibr" rid="CR16">16</xref>]. Thus, a reliable, applicable, and scalable imputation approach is urgently needed.</p>
    <p id="Par5">While more than 90% of genes in scRNA-seq data are zero-counts and the true and dropout zeros are difficult to distinguish, genes in each cell with detected expression (positive-count genes) are more reliable measurements compared to zeros (zero-count genes). Semi-supervised learning (SSL) approach offers promise when a few labels are available by allowing models to supplement their training with unlabeled data [<xref ref-type="bibr" rid="CR17">17</xref>]. We hypothesize that SSL can build a reliable imputation algorithm by learning information from both positive- and zero-count genes, which can be treated as labeled and unlabeled data, respectively.</p>
    <p id="Par6">Here, we developed DISC, a novel Deep learning Imputation model with semi-supervised learning (SSL) for Single Cell transcriptomes. DISC integrates an AE and a recurrent neural network (RNN) and uses SSL to train model parameters. SSL enables DISC to learn the structure of genes and cells from sparse data efficiently. We compared DISC to seven state-of-the-art imputation approaches, including four deep learning-based approaches. DISC consistently outperformed the other approaches using comprehensive performance metrics evaluating on ten real-world datasets from four different single-cell platforms. DISC enhanced expression distribution and gene-gene/cell-cell relationship validated by two independent FISH experiments. It accurately recovered dropout events and facilitated downstream analysis such as identification of differentially expressed genes (DEGs) and cell types on all the datasets regardless of different platforms and dropout levels. Furthermore, DISC dealt with ultra-large datasets containing millions of cells and required just a portion of computational cost and RAM that other deep learning-based approaches need. Its reliability, efficiency, and scalability make DISC a promising imputation approach for sparse scRNA-seq data. DISC was implemented in Python and publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xie-lab/DISC">https://github.com/xie-lab/DISC</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Description of DISC</title>
      <p id="Par7">DISC has an integrative structure of an AE and an RNN (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). AE is a part of RNN that performs dimension reduction while preserving the manifold of the original data. For each step <italic>t</italic>, the encoder of AE projects the high dimensional cell expression profile (<italic>x</italic><sup><italic>t</italic></sup>) into a low dimensional latent representation (<italic>z</italic><sup><italic>t</italic></sup>). The latent representation is used to predict the cell expression profile through a predictor matrix and to explore the data manifold through the reconstruction of the expression profile by the decoder of AE, obtaining expression profiles from multiple steps either predicted by the predictor (<italic>y</italic><sup><italic>t</italic></sup>) or reconstructed by the decoder of AE (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y^t} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq1.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Expression profile by the predictor is feed to the next step as the input. At the end, a soft attention framework computes a weighted average of <italic>y</italic><sup><italic>t</italic></sup> as the imputation result and weighted average of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y^t} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq2.gif"/></alternatives></inline-formula> as the reconstruction result to support SSL.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of DISC. <bold>a</bold> DISC contains an autoencoder, a recursive predictor, an imputer to compute an imputation expression profile, and a reconstructor to compute a reconstructed expression profile. <bold>b</bold> DISC is trained in a semi-supervised manner: (1) the imputer learns the expression of positive-count genes, (2) the reconstructor learns both the expression of positive-count genes and the pseudo expression of zero-count genes assigned by the imputer, and (3) the predictors learn both the expression of positive-count genes and the pseudo expression of zero-count genes assigned by the decoder of the same step. <bold>c</bold> Compression module reduces the large latent representations of multiple steps into a much smaller dimension for visualization and clustering. <bold>d</bold> T-distributed Stochastic Neighbor Embedding (T-SNE) visualization and clustering using top 30 PCs generated by PCA transformation from the selected top 2000 highly variable genes (HVGs) of the RETINA dataset (ACC = 0.950). <bold>e</bold> T-SNE visualization and clustering using 50 latent features generated by the compressor of DISC from all 14,871 genes (without HVGs selection) of the RETINA dataset (ACC = 0.944)</p></caption><graphic xlink:href="13059_2020_2083_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Users do not need to specify parameters in the model. Parameters in the layers are automatically learned from data through back-propagation using SSL (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section). Imputer learns from the positive-count genes using “noise-to-noise” method [<xref ref-type="bibr" rid="CR18">18</xref>]. Reconstructor learns using SSL from a combination of positive-count genes and zero-count genes assigned a pseudo-count (pseudo-count genes) by imputer to search the best latent representation to reconstruct the expression profile after imputation. Predictor learns using SSL from a combination of positive-count genes and pseudo-count genes assigned by a decoder to search for the best gene expression structure to preserve the manifold learned by AE. This AE-RNN structure enables DISC to learn biological information not only from the small portion of positive-count genes, but also the large portion of zero-count genes.</p>
      <p id="Par9">DISC also provides a solution to compress the latent representation into a lower dimension (50 by default), which retains the most informative information of the expression matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Ultra-large dataset is beyond the capability of many existing analytical tools. Using the low dimensional representation of the large dataset, clustering and visualization can be performed using existing tools with little comprise in performance. We compared the accuracy of cell-type classification based on the RETINA scRNA-seq data using two dimension reduction methods (<xref rid="Sec12" ref-type="sec">Methods</xref>), one is the top 2000 highly variable genes transformed to 30 principle components (PCs) by principle component analysis (PCA) and the other is the compressed 50 latent features. The overall classification rates were almost identical (ACCs of 0.950 and 0.944 for the 30 PCs and 50 latent features, respectively), demonstrating the usefulness of the latent representation provided by DISC (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d, e).</p>
    </sec>
    <sec id="Sec4">
      <title>DISC is scalable to ultra-large datasets</title>
      <p id="Par10">For large datasets, loading a complete matrix takes a large memory. For example, memory usage is about 100 GB for a matrix with 1,000,000 cells and 10,000 genes. To cope with the large datasets, we designed a novel data reading approach that leverages the ultra-fast chunk reading speed in continuous storage (<xref rid="Sec12" ref-type="sec">Methods</xref>). As a result, DISC needs a constant initial memory before training, but the memory consumption is stable in datasets with increasing data size.</p>
      <p id="Par11">We compared scalability of DISC with the other imputation approaches on speed and memory usage. We used the 1.3 million (m) mouse brain dataset (BRIAN_1.3 M) as well as datasets with 50 thousand (k), 100 k and 500 k down-sampling cells. We also duplicated 1.3 m cells to 2.6 m cells. All the datasets contained the top 1000 highly variable genes (<xref rid="Sec12" ref-type="sec">Methods</xref>). As expected, the deep learning-based approaches were much faster and used much less memory (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b). For the datasets with 10 k, 50 k, and 100 k cells, all the approaches had similar performance except scImpute had much higher memory usage on 10 k dataset and failed on 50 k dataset due to out of memory. MAGIC and VIPER were able to complete the 500 k dataset but took 58 GB memory while five deep learning approaches took less than 25 GB memory. On the 2.6 m dataset, only deep learning approaches could finish the job, where DISC (1.02 h) took less than 1/3 of time took by DeepImpute, DCA, and scScope (3.49, 3.65, and 3.71 h), and 1/13 of scVI (13.44 h). The memory usage of DISC was also considerably less than other approaches. DISC (8.89 GB) took less than 1/7 of memory that scVI needed (65.74 GB) and less than 1/12 that scScope, DeepImpute, and DCA needed (108.47, 118.38, and 120.25 GB).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of computation usage. <bold>a</bold> Running time and <bold>b</bold> peak RAM usage for datasets with different cell numbers</p></caption><graphic xlink:href="13059_2020_2083_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par12">A previous study showed that the use of less genes inevitably lost information and increased in gene depth to 10,000 genes improved cell-type identification [<xref ref-type="bibr" rid="CR10">10</xref>]. We tested the imputation performance based on the top 10,000 highly variable genes. DISC was the only approach that can process 1.3 m cells, with 3.2 h and less than 10 GB RAM, and all the approaches encountered “out-of-memory error.” Overall, DISC offers a highly scalable solution for imputation.</p>
    </sec>
    <sec id="Sec5">
      <title>DISC improves gene expression structures validated by FISH</title>
      <p id="Par13">Dropouts severely obscure expression distribution and gene-gene relationship which hinder the downstream analysis [<xref ref-type="bibr" rid="CR8">8</xref>]. Compared to scRNA-seq, single-cell RNA fluorescence in situ hybridization (FISH) detects a small number of RNA transcripts in single cells and suffers less from dropouts, which is considered a reliable way to validate expression distribution and gene-gene relationship in single-cell levels [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. To systematically assess DISC’s performance to recover lost gene expression structures by dropouts, we compared imputed expression matrix from scRNA-seq to FISH by three measurements, gene expression distribution measured by root mean square error (RMSE) of Gini coefficient, correlation of gene-gene distributions measured by Fasano and Franceschini’s statistics (FF score), and distance of correlation matrix of gene co-expression measured by correlation matrix distance (CMD). Two independent datasets containing both FISH and scRNA-seq measurements were tested, where the MELANOMA and SSCORTEX datasets have 19 and 33 overlapped genes with FISH, respectively (see the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section for the description of the datasets).</p>
      <p id="Par14">DISC recovered distributions of gene expression across cells on the MELANOMA dataset that resembled the FISH distribution much closer than the raw scRNA-seq data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2, two genes are shown with different dropout levels). For all the 19 genes that had both FISH and scRNA-seq measurements, DISC efficiently improved Gini coefficient (RMSE = 0.14) than the raw scRNA-seq (RMSE = 0.34) and all the other approaches (RMSEs range from 0.24 to 0.33) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In addition, DISC recovered the correlation of gene-gene distributions (FF score = 0.134 to FISH) which was lost in the raw data (FF = 0.848) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, two genes are shown). Indeed, DISC significantly reduced the FF scores for 75 out of the 81 gene pairs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3, <italic>p</italic> &lt; 2.2e−16, one-tailed paired <italic>t</italic> test).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Evaluation of imputation performance by FISH. <bold>a</bold> and <bold>b</bold> were based on the MELANOMA dataset. <bold>a</bold> Scatter plots of Gini coefficients of 19 overlapped genes between FISH and RAW/the imputation, RMSE scores are shown. Two genes with different dropout levels are also shown, WNT5A and SOX10, with dropout levels of 99.85 and 85.18%, respectively. <bold>b</bold> Scatter plot of WNT5A and SOX10 expression levels between FISH and the imputation/RAW. FF scores were calculated across 13,564 cells in FISH and 8498 cells in the other plots. <bold>c</bold> RMSE of Gini coefficients of the RAW/the imputation against FISH in MELANOMA (19 genes) and SSCORTEX (33 genes). <bold>d</bold> FF scores of gene-gene distributions of the RAW/the imputation against FISH in MELANOMA (81 gene pairs) and SSCORTEX (528 gene pairs). <bold>e</bold> CMD of gene co-expression of the RAW/the imputation against FISH in MELANOMA (81 gene pairs) and SSCORTEX (528 gene pairs)</p></caption><graphic xlink:href="13059_2020_2083_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">We next compared all the imputation approaches on both the MELANOMA and SSCORTEX datasets. Expression distributions recovered by DISC more closely matched to the FISH compared to the other approaches on MELANOMA and ranked the second on SSCORTEX (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). scVI worked well on one dataset but not well on another. VIPER, scImpute, and DeepImpute did not improve expression distribution compared to the raw data and occasionally even worse (DeepImpute on SSCORTEX). We further evaluated correlations of gene-gene distributions of imputed data to FISH and found that DISC and scVI had the best overall performance on the two datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). VIPER, scImpute, and DeepImpute did not yield improvement compared to the raw data. We also tested how the correlation of gene co-expression in FISH data to the imputed and raw data (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). DISC, scImpute, and VIPER performed well on both datasets while MAGIC and DCA induced substantial false gene co-expression relationship. Altogether, DISC consistently achieved top performance on all measurements of gene expression structure validated by two independent FISH experiments, showing its robust capability to recover gene expression structure obscured by dropouts.</p>
    </sec>
    <sec id="Sec6">
      <title>DISC accurately recovers dropout events</title>
      <p id="Par16">As the true expression of dropouts in scRNA-seq is not possible to obtain, we conducted down-sampling experiments on four datasets (<xref rid="Sec12" ref-type="sec">Methods</xref>). To test the robustness of imputation performance, we used datasets generated from three different scRNA-seq platforms (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Expression matrix before down-sampling (“reference”), after down-sampling (“observed”), and imputation based on the observed were compared.</p>
      <p id="Par17">We first measured the accuracy of true gene expression recovery using mean absolute error (MAE) of the imputation to the reference data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Notably, DISC achieved the top performance compared to the other approaches on all the datasets. Compared to the observed datasets, DISC significantly recovered gene expression (all the <italic>p</italic> values &lt; 2.2e−16, one-tailed paired <italic>t</italic> test). On the other hand, MAGIC and scScope always performed the worst on all the datasets. We next measured recovery of expression structure using Pearson’s correlation of gene-gene relationship and cell-cell relationship of the imputation to the reference (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, c). For the gene correlation and cell correlation, DISC had the highest correlation coefficients compared to the other seven approaches on all the datasets. It is notable that, for the gene correlation, DISC was the only approach that had improved correlations compared to the observed dataset on all the four datasets while no other approaches had improvement on any dataset, illustrating DISC’s ability to enhance gene-gene relationship. Interestingly, VIPER had almost identical coefficients of cell correlation and gene correlation as the observed data on all the datasets, indicating its strategy to keep the gene structure of the observed data unchanged. DCA and scVI worked well on cell correlation but considerably reduced gene correlation while scImpute performed well on gene correlation but not on cell correlation. MAGIC and scScope significantly reduced both gene correlation and cell correlation compared to the other approaches. In addition, MAGIC and scScope also generated large variations of cell correlation, indicating unstable performance.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluation of recovery of dropouts in the down-sampling experiments. <bold>a</bold> MAE between the reference and the observed/the imputation. <bold>b</bold> Gene correlation between the reference and the observed/the imputation. <bold>c</bold> Cell correlation between the reference and the observed/the imputation. Box plots show the median (center line), interquartile range (hinges), and 1.5 times the interquartile range (whiskers)</p></caption><graphic xlink:href="13059_2020_2083_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">We also measured recovery of gene co-expression using CMD of correlation coefficients to assess gene co-expression (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). DISC, scImpute, and VIPER most matched that of the reference, while MAGIC, DCA, DeepImpute, scScope, and scVI generated large false co-expressed relationship for almost all the datasets. This result was consistent with our previous findings using FISH as a validation (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). Collectively, our data showed that DISC consistently and accurately recovered gene expression of dropouts and improved gene structure distorted by dropouts.</p>
    </sec>
    <sec id="Sec7">
      <title>DISC consistently improves cell-type identification</title>
      <p id="Par19">Having demonstrated DISC’s ability to reliably recover dropout events, we next evaluated whether imputation improved cell-type identification. We used three datasets generated from different single-cell platforms, 10X Genomics, Drop-seq, and SPLiT-seq (<xref rid="Sec12" ref-type="sec">Methods</xref>). We down-sampled the datasets to 30% of the original reads. The average cell library size, reflecting the sequence depth, before and after down-sampling are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Percentage of cells correctly assigned (ACC) was used to assess the accuracy of cell-type classification using the marker genes shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 - S4.</p>
      <p id="Par20">For the PMBC dataset, DISC (ACC = 0.91) and scImpute (ACC = 0.91) were the only approaches that have improved accuracy compared to the observed (ACC = 0.83). DISC had significantly better improvements compared to the other approaches except for scImpute (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). MAGIC and all the other four deep learning approaches, DeepImpute, DCA, scScope, and scVI, significantly dropped the classification accuracy compared to the observed (<italic>p</italic> value &lt; 2.2e−16, one-tailed paired <italic>t</italic> test). Zooming into eight cell types, DISC achieved the top accuracy for all the cell types among all the approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5A). MAGIC failed identifying cell types using known marker genes due to the loss of marker genes for almost all the cell types.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Evaluation of cell type identification. <italic>Y</italic>-axis showed the difference of ACC between the imputed and the observed datasets. ACCs of each observed dataset are shown. <italic>p</italic> values were calculated using one-tailed paired <italic>t</italic> test. NS indicates “not significant.” <bold>a</bold> PCMB dataset, <bold>b</bold> RETINA dataset, <bold>c</bold> neurons of BRAIN_SPLiT, and <bold>d</bold> non-neurons of BRAIN_SPLiT. The following approaches failed due to “out-of-memory” error: scImpute on RETINA, VIPER, and scImpute on BRAIN_SPLiT. Box plots show the median (center line), interquartile range (hinges), and 1.5 times the interquartile range (whiskers)</p></caption><graphic xlink:href="13059_2020_2083_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par21">For the RETINA dataset, DISC had the top performance and improved ACC from 0.83 (the observed) to 0.95 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Some rare cell populations, such as RGC, Muller glia, and VE, completely missed in the observed data due to dropouts, were recovered by DISC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5B). DISC performed significantly better than all the other approaches (<italic>p</italic> values shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Although DCA improved the overall accuracy (ACC = 0.87), it mostly improved the identification of the major population, Rods, that counts for 66% of the total cell populations and completely missed identification of six other cell types. scScope only identified Rods and almost failed to identify all the other cell types while DeepImpute and VIPER completely missed identifying Rods. DISC had the top accuracy for 10 out of 11 cell types among all the approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5B).</p>
      <p id="Par22">The BRAIN_SPLiT dataset has 156,049 cells and we analyzed the cell types in neurons and non-neurons separately [<xref ref-type="bibr" rid="CR3">3</xref>]. Because this dataset was sparse, with just 1329 mRNA counts per cell on average, and contained complex cell types, ACC score of neurons dropped from 0.48 to 0.2, and that of non-neurons dropped from 0.64 to 0.17 after down-sampling to 30%. Impressively, DISC improved ACCs to 0.46 and 0.58 for neurons and non-neurons after imputation (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, d). Four cell types in neurons and six cell types in non-neurons, including major cell types such as astrocyte and rare cell types such as Epend, missed due to dropouts after down-sampling, were recovered by DISC. DeepImpute and scScope almost completely failed to identify any cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5C and S5D).</p>
      <p id="Par23">We also compared all the approaches after down-sampling to 50% of the original datasets. The performance of DISC was consistent with the above analysis, indicating that DISC was robust to different dropout levels (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). In addition to ACC, adjusted rand index (ARI) was also used to evaluate the accuracy of cell-type classification. DISC also had the best accuracy for all the datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). To sum up, DISC was the only approach consistently and significantly improved the accuracy of cell-type identification for all the datasets. DISC not only improved identification for both major and rare cell types, but also had robust performance on datasets generated from different single-cell platforms.</p>
    </sec>
    <sec id="Sec8">
      <title>DISC improves downstream analysis</title>
      <p id="Par24">We evaluated whether better gene expression structures translate to better results of downstream analysis. We evaluated similarities (1) between imputed scRNA-seq data and bulk RNA-seq data and (2) between DEGs identified by scRNA-seq data and bulk RNA-seq data, and (3) between pseudo-temporal order inferred by trajectory analysis and known cell differentiation order. Here, we used three datasets from 10X Genomics platform for this comparison (<xref rid="Sec12" ref-type="sec">Methods</xref>).</p>
      <p id="Par25">Firstly, we calculated Spearman’s correlation coefficient (SCC) between the imputed scRNA-seq profiles and the bulk RNA-seq profiles for the same cell line and for the expression difference between two cell lines. All the imputation methods preserved the correlation between scRNA-seq profiles and bulk RNA-seq profiles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A). But, only four methods preserved the correlation between the expression difference across the two cell lines of scRNA-seq profile and that of bulk RNA-seq profile, while DISC had the greatest improvement, improving 0.584 of RAW to 0.611 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8B) indicating the ability of DISC to capture the expression difference between cell types.</p>
      <p id="Par26">We next evaluated DEG identification after imputation using DEGs identified by bulk RNA-seq data [<xref ref-type="bibr" rid="CR19">19</xref>]. We used two methods, namely MAST [<xref ref-type="bibr" rid="CR20">20</xref>] and Wilcoxon rank-sum test [<xref ref-type="bibr" rid="CR21">21</xref>] (abbreviated as Wilcoxon), to identify DEGs for single-cell data. To evaluate the overall performance of DEG identification, we used two metrics, (1) the overlap of DEGs identified from the two cell types between the bulk data and scRNA-seq data and (2) the number of false detected DEGs using cells from a homogeneous population. DEGs identified by DISC using MAST had the first and second highest overlap to bulk for the two datasets, demonstrating the ability of DISC to improve DEG identification over RAW (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b). Using Wilcoxon, DISC performed best for both datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). At the same time, DISC was able to considerably decrease the number of false DEGs compared to the RAW dataset (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). Overall, DISC achieved a balance between sensitivity and specificity for DEG identification.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Evaluation of DEG identification. DEG was identified using MAST for <bold>a</bold> the JURKAT_293T dataset and <bold>b</bold> the 10X_5CL dataset, where <italic>x</italic>-axis shows the false number of DEGs identified from a homogeneous population (293T and A549 cell lines were used, respectively) and <italic>y</italic>-axis shows the averaged overlaps of DEGs identified by scRNA-seq data to that of bulk RNA-seq for all the combination of cell lines in the dataset. <bold>c</bold> For a pair of cell lines in the 10X_5CL dataset, genes were grouped into 10 intervals ranked by their FC values. For example, interval 1 is top 10% genes ranked by FC. The overlap between bulk and single-cell DEGs identified using MAST were calculated for 10 combinations of cell lines for each interval. Box plots show the median (center line), interquartile range (hinges), and 1.5 times the interquartile range (whiskers) for the 10 overlap values</p></caption><graphic xlink:href="13059_2020_2083_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par27">We then evaluated the impact of the magnitude of expression difference by fold-change (FC) [<xref ref-type="bibr" rid="CR15">15</xref>]. For a pair of cell types in the 10X_5CL dataset, genes were ordered by their FC and then grouped into ten equal length intervals (each has 1815 genes). DISC showed improvement of the DEG overlaps between scRNA-seq data and bulk RNA-seq data for 7 out of 10 intervals while the overlaps retained or slightly decreased for the other 3 intervals, indicating a consistent improvement of DEG identification by DISC over RAW for different FCs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). Comparing all methods, DISC performed well for the middle to the high FC intervals and performed moderately in low FC intervals, using both MAST (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10A) and Wilcoxon (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10B).</p>
      <p id="Par28">Finally, we evaluated the trajectory analysis. Different from the evaluation of DEG identification, cells in BONE_MARROW dataset were unsorted. Hence, we firstly identified cell types by mapping each cell in BONE_MARROW to a bulk cell type with the highest Spearman correlation [<xref ref-type="bibr" rid="CR15">15</xref>]. Then, Monocle 2 were used to construct pseudo-temporal order for cells in BONE_MARROW dataset. Using the known differentiation order as the reference, the percentage of correctly ordered cell-pairs was used as the metrics for comparison. Consistent with the previous study [<xref ref-type="bibr" rid="CR15">15</xref>], DCA, scVI, and MAGIC showed significant improvement of the inferred trajectory compared to RAW and DISC ranked third which is very close to the second scVI (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11). In addition, the average distance between the mis-ordered cell-pairs was reduced by DISC to 1.65 from 2.31 of RAW (DISC was ranked the second and close to the best score of DCA (1.61). To sum up, DISC consistently improved the downstream analysis compared to the unimputed dataset and provided more biological meaningful information.</p>
    </sec>
    <sec id="Sec9">
      <title>DISC reliably identifies cell populations in the 1.3 million mouse brain dataset</title>
      <p id="Par29">We finally analyzed the BRAIN_1.3 M dataset which was generated from multiple brain regions, including the cortex, hippocampus, and subventricular zone. In total, DISC identified 61 cell clusters (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12). We assigned each cluster to one of three major cell groups, Glutamatergic neurons, GABAergic neurons and non-neuronal cells, using the known marker genes from the Allen Brain Atlas (<xref rid="Sec12" ref-type="sec">Methods</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5), which was also used by scScope and PARC [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Approximately 1.1 million cells from 49 clusters were assigned to known cell types. The proportions of three main cell types are 64% for the Glutamatergic, 18% for the GABAergic, and 18% for the non-neuronal, which more closely agree with the composition reported by PARC (65, 18, and 17%) than scScope (63, 17, and 20%) (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b). We assigned cells into 10 major neuronal (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c) and 6 major non-neuronal cell populations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>d); the marker gene used for cell types is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6. The smallest cell population is Microglia (5774 cells), which had unique cell markers of C1qb and Tgfbr1, counting for 0.44% cells of the dataset (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c). These cell populations can be further categorized into sub-cell populations. For example, migrating interneurons (MI) can be further sub-grouped into three sub-populations based on distinguishing sub-cell markers (Fig. <xref rid="Fig7" ref-type="fig">7</xref>e).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Analysis of BRAIN_1.3 M. <bold>a</bold> uMAP visualization using 50 compressed dimensions for 61 clusters identified by DISC. Clusters are split into three main cell types: glutamatergic neurons (Gluta), GABAergic neurons (Gaba), and non-neuronal cells. <bold>b</bold> The proportions of three main cell types identified by DISC, PARC, and scScope. <bold>c</bold>, <bold>d</bold> Cell types and marker genes for the non-neuronal cells (<bold>c</bold>) and the neuronal cells (<bold>d</bold>), the number of cells in each cell type is shown on the right. <bold>e</bold> Three sub-cell types and marker genes for MI. <bold>f</bold>, <bold>g</bold> Visualization of Gaba and MI marker genes, Dlx1 and Dlx6ox1, identified by DISC (<bold>f</bold>) and identified by Seurat (<bold>g</bold>) on 100,000 down-sampling cells</p></caption><graphic xlink:href="13059_2020_2083_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par30">Compared to the cell types identified by DISC and scScope, we found a large discrepancy from MI. DISC identified 184,203 MI cells (14.36%) belonging to GABAergic neurons (Fig. <xref rid="Fig7" ref-type="fig">7</xref>d), while scScope identified 543,779 MI cells (42.40%) belonging to glutamatergic neurons. By visualizing two MI markers, Dlx1 and Dlx6os1, our analysis clearly showed that MI belonged to GABAergic groups (Fig. <xref rid="Fig7" ref-type="fig">7</xref>f). To confirm our result, we used a commonly used cell-type identification tool, Seurat. Because Seurat was not able to handle such a large dataset, we down-sampled 100,000 out of 1.3 million cells. Consistent with our analysis, the analysis by Seurat also showed a clear signal that MI belonged to GABAergic neurons, accounting for 14% in 100,000 cells (Fig. <xref rid="Fig7" ref-type="fig">7</xref>g). These results demonstrate DISC’s ability to efficiently and accurately explore the major and rare cell populations in ultra-large heterogeneous single-cell datasets.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <p id="Par31">Many factors such as expression level and distribution, level of noises, and heterogeneity of cells affect the performance of imputation. DISC assumes no specific distribution of expression and dropouts. Semi-supervised deep learning framework allows DISC to learn a complex structure of genes and cells from sparse data. Unlike the other imputation approaches, DISC does not down-sample genes for the model input therefore preserves the more information from the data. As a result, DISC showed robust performance to datasets with different sizes, different dropout levels, and from different platforms. We expect that DISC will continue working well as the noise distribution changes with the emerging novel platforms of scRNA-seq.</p>
    <p id="Par32">Although DISC and scScope have similar network structures, they are trained by different strategies. DISC employs semi-supervised learning and its loss function is computed on both positive-count genes (real labels) and zero-count genes (pseudo labels), while scScope is trained in a supervised-manner and its loss function is computed only on positive-count genes [<xref ref-type="bibr" rid="CR10">10</xref>]. When positive-count genes are limited, training based only on positive-count genes is likely to miss the distinguishing features between technical and biological dropouts where both belong to zero-count genes, thus leading to a latent representation that best interprets positive-count genes without properly encodes distinguishing features for dropouts. Semi-supervised learning supplements the training with zero-count genes to build a more reasonable latent representation which also best interprets zero-count genes structurally similarly to positive-count genes as a technical dropout. As a consequence, DISC distinguishes the technical zero generated by down-sampling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13A and S14A) and scScope was only able to distinguish technical zero generated by down-sampling in RETINA and BRAIN_SPLiT datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13B and S14B), which contain a large number of cells and positive-count genes. Hence, DISC works well when the information provided by positive-count genes is limited.</p>
    <p id="Par33">Some recent studies concerned biases introduced by imputation [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. In our study, we also found that several imputation approaches not only considerably changed genetic and cellular structures of scRNA-seq data, but also significantly decreased the accuracy of downstream analysis, such as identification of DEGs and cell types, after imputation. In contrast, we demonstrated that DISC not only recovered gene expression and enhanced gene structures, but also significantly improved the accuracy of downstream analysis. Compared to the other seven approaches, DISC consistently achieved top performance on ten real-world datasets using various evaluation metrics, illustrating its robust and stable performance.</p>
    <p id="Par34">In the last few years, advances in scRNA-seq technology have enabled us to obtain a few thousands to over a million of cells in just one study. Moreover, the integration of datasets from different studies could provide much more biological insights than the single study does [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. It is therefore an urgent task to establish an analytic method capable of handling ultra-large datasets. We showed that DISC could readily handle over several million of cells using just a small portion of computational cost that other deep learning-based approaches used. Unlike other imputation approaches, DISC processed large datasets with tens of thousands of genes, which minimizes information lost due to gene or cell down-sampling.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par35">In conclusion, our results demonstrated that DISC should be used for imputation, particularly for datasets with sparse expressed genes. Making no assumption to data distribution, DISC provides a general solution for analyzing single-cell omics data. It outputs both expression matrix and low dimensional representations, which can be used for clustering and visualization by other analytical tools that have no capability to deal with ultra-large datasets. We expect that DISC will be of immediate interest to the fast-growing single-cell research community.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Description of DISC</title>
      <sec id="Sec14">
        <title>Normalization</title>
        <p id="Par36">The cell expression profile of cell <italic>c</italic> with <italic>M</italic> genes in mRNA counts <italic>C</italic><sub><italic>c</italic></sub> ∈ ℤ<sup><italic>M</italic></sup> is firstly normalized by cell library size with log transformation
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{C_c}=\ln \left( sf\frac{C_c}{ls_c}+1\right), $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mover accent="true"><mml:msub><mml:mi>C</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">sf</mml:mi><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">ls</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>ls</italic><sub><italic>c</italic></sub> is the library size of cell <italic>c</italic>, and <italic>sf</italic> (scale factor) is a constant, defined below.</p>
      </sec>
      <sec id="Sec15">
        <title>Outlier detection</title>
        <p id="Par37">We use a scale factor of 1 million for normalization and calculate <italic>Z</italic> scores for the normalized counts over all cells. Genes with <italic>Z</italic> scores greater than three are treated as outliers. DISC does not impute outliers so that outliers stay unchanged in the imputed expression matrix. During training, DISC masks outliers and uses semi-supervised learning framework to assign pseudo-counts for the outliers for training.</p>
      </sec>
      <sec id="Sec16">
        <title>Input preparation</title>
        <p id="Par38">We use a scale factor of median cell library size for normalization and scale each gene <italic>m</italic> (1 ≤ <italic>m</italic> ≤ <italic>M</italic>) by its normalized max (excluding outliers) over all cells to 0–1.
<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{c,m}^0=\frac{\overset{\sim }{C_{c,m}}}{\overset{\sim }{C_{\max, m}}}, $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mover><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mover><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>max</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{{x}_c^0\in {\mathrm{\mathbb{R}}}^M|0\le {x}_{c,m}^0\le 1\right\} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi>M</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq3.gif"/></alternatives></inline-formula> is the first step input and RNN will repeats for <italic>T</italic> steps.</p>
      </sec>
      <sec id="Sec17">
        <title>Encoder</title>
        <p id="Par39">The encoder layer <italic>f</italic><sub><italic>E</italic></sub>(⋅) projects input of step <italic>t</italic><inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_c^t $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq4.gif"/></alternatives></inline-formula> into a low-dimensional, latent representation <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {z}_c^t\in {\mathrm{\mathbb{R}}}^S,S&lt;M $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi>S</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq5.gif"/></alternatives></inline-formula>. The encoder layer is given by
<disp-formula id="Equc"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {z}_c^t={f}_E\left({x}_c^t\right)=\tanh \left({w}_E{x}_c^t\right), $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>E</italic></sub> is a learnable parameter.</p>
      </sec>
      <sec id="Sec18">
        <title>Decode</title>
        <p id="Par40">In contrast to the encoder layer, decoder layers <italic>f</italic><sub><italic>D</italic></sub>(⋅) reverses the latent representation back into a reconstructed normalized expression profile <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{y_c^t}\in {\mathrm{\mathbb{R}}}^{\mathrm{M}}|0\le \hat{y_{c,m}^t}\le 1\right\} $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq6.gif"/></alternatives></inline-formula>, given by
<disp-formula id="Equd"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y_c^t}={f}_D\left({z}_c^t\right)=\mathrm{sigmoid}\left(2\left(\varphi +1\right)\circ \left({w_E}^{\mathrm{T}}{z}_c^t+{b}_D\right)\right), $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mtext>sigmoid</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:mi>φ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∘</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:msub><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>E</italic></sub><sup>T</sup> is the transpose of <italic>w</italic><sub><italic>E</italic></sub> and <italic>φ</italic> ∈ ℝ<sup><italic>M</italic></sup>, <italic>b</italic><sub><italic>D</italic></sub> are learnable parameters.</p>
      </sec>
      <sec id="Sec19">
        <title>Prediction matrix</title>
        <p id="Par41">The prediction matrix contains <italic>M</italic> channels, each channel <italic>f</italic><sub><italic>P</italic>, <italic>m</italic></sub>(⋅) predicts the expression of a single gene <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 0\le {y}_{c,m}^t\le 1 $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq7.gif"/></alternatives></inline-formula> from the latent representation <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {z}_c^t $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq8.gif"/></alternatives></inline-formula> as
<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_{c,m}^t={f}_{P,m}\left({z}_c^t\right). $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par42">A channel has three layers, given by
<list list-type="bullet"><list-item><p id="Par43">1st hidden layer: <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ h{1}_{c,m}^t=\left({\varphi}_m+1\right)\left({w}_{h1,m}{z}_c^t+{b}_{h1,m}\right) $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:mi>h</mml:mi><mml:msubsup><mml:mn>1</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq9.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par44">2nd hidden layer: <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ h{2}_{c,m}^t=\left({\varphi}_m+1\right)\left({w}_{h2,m}\cdot \tanh \left(h{1}_{c,m}^t\right)+{b}_{h2,m}\right) $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:mi>h</mml:mi><mml:msubsup><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>h</mml:mi><mml:msubsup><mml:mn>1</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq10.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p id="Par45">Output layer: <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_{c,m}^t=\mathrm{sigmod}\left(2\left({\varphi}_m+1\right)\left(\begin{array}{l}{\psi}_{c,m}^t\left({w}_{p1,m}\tanh \left(h{2}_{c,m}^t\right)+{b}_{p1,m}\right)\\ {}+\left(1\hbox{-} {\psi}_{c,m}^t\right)\left({w}_{p2,m}\tanh \left({h}_{2,m}^t\right)+{b}_{p2,m}\right)\end{array}\right)\right) $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>sigmod</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>h</mml:mi><mml:msubsup><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>‐</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq11.gif"/></alternatives></inline-formula>, <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\psi}_{c,m}^t=\mathrm{sigmoid}\left(\mathrm{SELU}\left({w}_{\psi, m}h{2}_{c,m}^t\right)\right) $$\end{document}</tex-math><mml:math id="M34" display="inline"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>sigmoid</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>SELU</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>h</mml:mi><mml:msubsup><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq12.gif"/></alternatives></inline-formula>,</p></list-item></list>where <italic>w</italic><sub><italic>h</italic>1, <italic>m</italic></sub>, <italic>w</italic><sub><italic>h</italic>2, <italic>m</italic></sub>, <italic>w</italic><sub><italic>p</italic>1, <italic>m</italic></sub>, <italic>w</italic><sub><italic>p</italic>2, <italic>m</italic></sub>, <italic>w</italic><sub><italic>ψ</italic>, <italic>m</italic></sub>, <italic>b</italic><sub><italic>h</italic>1, <italic>m</italic></sub>, <italic>b</italic><sub><italic>h</italic>2, <italic>m</italic></sub>, <italic>b</italic><sub><italic>p</italic>1, <italic>m</italic></sub>, and <italic>b</italic><sub><italic>p</italic>2, <italic>m</italic></sub> are learnable parameters for gene <italic>m</italic>. The output layer is a weighted average over two channels using <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\psi}_c^t $$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq13.gif"/></alternatives></inline-formula> as weight factor. We assumed that a given gene followed the same expression distribution across most of cells and defined this as “major expression distribution”. Before sigmoid activation, scaled exponential linear unit [<xref ref-type="bibr" rid="CR25">25</xref>] (SELU) activation is used to make the channel selection biased the first channel, where the first channel represents the major expression distribution.</p>
      </sec>
      <sec id="Sec20">
        <title>Filter</title>
        <p id="Par46">Input for the next step, <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_c^{t+1} $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq14.gif"/></alternatives></inline-formula>, is prepared by filtering of <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_c^t $$\end{document}</tex-math><mml:math id="M40" display="inline"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq15.gif"/></alternatives></inline-formula> to keep the positive-counts as
<disp-formula id="Equf"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{c,m}^{t+1}=\left\{\begin{array}{c}{x}_{c,m}^0,\kern0.5em {x}_{c,m}^0&gt;0\\ {}{y}_{c,m}^t,{x}_{c,m}^0=0\end{array}\right.. $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec21">
        <title>Imputer and reconstructor</title>
        <p id="Par47">A soft attention assigns a weight vector <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {a}_c^t $$\end{document}</tex-math><mml:math id="M44" display="inline"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq16.gif"/></alternatives></inline-formula> to the decoding <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y_c^t} $$\end{document}</tex-math><mml:math id="M46" display="inline"><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq17.gif"/></alternatives></inline-formula> and prediction <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_c^t $$\end{document}</tex-math><mml:math id="M48" display="inline"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq18.gif"/></alternatives></inline-formula> output from each recurrence. <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {a}_c^t $$\end{document}</tex-math><mml:math id="M50" display="inline"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq19.gif"/></alternatives></inline-formula> is given by
<disp-formula id="Equg"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {a}_{c,m}^t=\mathrm{softmax}\left({w}_{a,m}\mathrm{SELU}\left(h{1}_{c,m}^t\right)\right), $$\end{document}</tex-math><mml:math id="M52" display="block"><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>softmax</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mtext>SELU</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi>h</mml:mi><mml:msubsup><mml:mn>1</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>a</italic>, <italic>m</italic></sub> is a learnable parameter. After weighted average, <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{y_c}\in {\mathrm{\mathbb{R}}}^{\mathrm{M}}|0\le \hat{y_{c,m}}\le 1\right\} $$\end{document}</tex-math><mml:math id="M54" display="inline"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mi mathvariant="normal">M</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq20.gif"/></alternatives></inline-formula> and {<italic>y</italic><sub><italic>c</italic></sub> ∈ ℝ<sup>M</sup>| 0 ≤ <italic>y</italic><sub><italic>c</italic>, <italic>m</italic></sub> ≤ 1} are given by</p>
        <p id="Par48"><inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y_c}=\sum \limits_t{a}_c^t\circ \hat{y_c^t} $$\end{document}</tex-math><mml:math id="M56" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msubsup><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>∘</mml:mo><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_c=\sum \limits_t{a}_c^t\circ {y}_c^t $$\end{document}</tex-math><mml:math id="M58" display="inline"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msubsup><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>∘</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq22.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec22">
        <title>Compressor</title>
        <p id="Par49">The latent representations over all steps, <italic>z</italic><sub><italic>c</italic></sub> ∈ ℝ<sup><italic>S</italic> × <italic>T</italic></sup>, are compressed further to a lower dimension <italic>W</italic> ≪ <italic>S</italic> ⋅ <italic>T</italic>. Compressor is an autoencoder whose encoder is given by
<disp-formula id="Equh"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {cp}_c=\tanh \left({w}_z{z}_c+{b}_{z1}\right), $$\end{document}</tex-math><mml:math id="M60" display="block"><mml:msub><mml:mi mathvariant="italic">cp</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par50">And the reverse decoder is given by
<disp-formula id="Equi"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{z_c}=\tanh \left({w_z}^{\mathrm{T}}{cp}_c+{b}_{z2}\right), $$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mover accent="true"><mml:msub><mml:mi>z</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>tanh</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:msub><mml:mi>w</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:msub><mml:mi mathvariant="italic">cp</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>z</italic></sub>, <italic>b</italic><sub><italic>z</italic>1</sub>, and <italic>b</italic><sub><italic>z</italic>2</sub> are learnable parameters, <italic>cp</italic><sub><italic>c</italic></sub> is the compressed cell feature where <italic>cp</italic><sub><italic>c</italic></sub> ∈ ℝ<sup><italic>W</italic></sup>. Autoencoder and compressor modules together form a stacked autoencoder. To evaluate the performance of the compressor, the cell expression profile <inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{y_c} $$\end{document}</tex-math><mml:math id="M64" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq23.gif"/></alternatives></inline-formula> is reversed from <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{z_c}\in {\mathrm{\mathbb{R}}}^{S\times T} $$\end{document}</tex-math><mml:math id="M66" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>z</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq24.gif"/></alternatives></inline-formula>, given by
<disp-formula id="Equj"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{y_c}=\sum \limits_t{a}_c^t\circ \tilde{y_c^t}, $$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msubsup><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>∘</mml:mo><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <italic>a</italic><sup><italic>t</italic></sup> is the shared soft attention weight for the imputer and reconstructor modules and <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{y_c^t} $$\end{document}</tex-math><mml:math id="M70" display="inline"><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq25.gif"/></alternatives></inline-formula> is reversed from <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tilde{z_c^t} $$\end{document}</tex-math><mml:math id="M72" display="inline"><mml:mover accent="true"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq26.gif"/></alternatives></inline-formula> using the decoder module.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>Training of DISC</title>
      <p id="Par51">The parameters of DISC are optimized from the data in an end-to-end manner according to a combination of five loss functions, including imputation loss (<italic>L</italic><sub><italic>I</italic></sub>), reconstruction loss (<italic>L</italic><sub><italic>R</italic></sub>), prediction loss (<italic>L</italic><sub><italic>P</italic></sub>), latent representation loss (<italic>L</italic><sub><italic>LR</italic></sub>), and constraint (<italic>L</italic><sub><italic>C</italic></sub>).</p>
      <sec id="Sec24">
        <title>Imputation loss</title>
        <p id="Par52"><italic>L</italic><sub><italic>I</italic></sub> is formulated based on the idea of “noise to noise” for image imputation [<xref ref-type="bibr" rid="CR18">18</xref>]. A noise input <inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {nx}_c^0 $$\end{document}</tex-math><mml:math id="M74" display="inline"><mml:msubsup><mml:mi mathvariant="italic">nx</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq27.gif"/></alternatives></inline-formula> for the first step is prepared by assigning an uniform multiplicative noise: <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {U}_c^M\left(0.9,1.1\right)\circ {x}_c^0 $$\end{document}</tex-math><mml:math id="M76" display="inline"><mml:msubsup><mml:mi>U</mml:mi><mml:mi>c</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mfenced close=")" open="(" separators=","><mml:mn>0.9</mml:mn><mml:mn>1.1</mml:mn></mml:mfenced><mml:mo>∘</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {nx}_c^0 $$\end{document}</tex-math><mml:math id="M78" display="inline"><mml:msubsup><mml:mi mathvariant="italic">nx</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq29.gif"/></alternatives></inline-formula> replaces <inline-formula id="IEq30"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_c^0 $$\end{document}</tex-math><mml:math id="M80" display="inline"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq30.gif"/></alternatives></inline-formula> for filtering of predicted expression profile to produce inputs for the later steps, <inline-formula id="IEq31"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {nx}_c^t $$\end{document}</tex-math><mml:math id="M82" display="inline"><mml:msubsup><mml:mi mathvariant="italic">nx</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq31.gif"/></alternatives></inline-formula>. In addition, a dropout operation is applied to <inline-formula id="IEq32"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {nx}_c^t $$\end{document}</tex-math><mml:math id="M84" display="inline"><mml:msubsup><mml:mi mathvariant="italic">nx</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq32.gif"/></alternatives></inline-formula> on zero-count genes in raw data [<xref ref-type="bibr" rid="CR26">26</xref>]. At the end, a noise imputation output <italic>ny</italic><sub><italic>c</italic></sub> is produced and <italic>L</italic><sub><italic>I</italic></sub> is formulated as
<disp-formula id="Equk"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_I=\frac{1}{N}\sum \limits_c{\left\Vert \alpha {1}_c\circ \left({ny}_c-{ny_c}^{\hbox{'}}\right)\right\Vert}_1, $$\end{document}</tex-math><mml:math id="M86" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:msub><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:msub><mml:mo>∘</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="italic">ny</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:msub><mml:mi mathvariant="italic">ny</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>where <italic>ny</italic><sub><italic>c</italic></sub><sup>'</sup> is a noise target given by <inline-formula id="IEq33"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {U}_c^M\left(0.9,1.1\right)\circ {x}_c^0 $$\end{document}</tex-math><mml:math id="M88" display="inline"><mml:msubsup><mml:mi>U</mml:mi><mml:mi>c</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mfenced close=")" open="(" separators=","><mml:mn>0.9</mml:mn><mml:mn>1.1</mml:mn></mml:mfenced><mml:mo>∘</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq33.gif"/></alternatives></inline-formula> and <italic>N</italic> is the number of cells for training. <italic>L</italic><sub><italic>I</italic></sub> is computed on the positive-counts restricted by <italic>α</italic>1, given by
<disp-formula id="Equl"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha {1}_{c,m}=\left\{\begin{array}{cc}1,&amp; {x}_{c,m}^0&gt;0\\ {}0,&amp; {x}_{c,m}^0=0\end{array}\right.. $$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mi>α</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec25">
        <title>Reconstruction loss</title>
        <p id="Par53"><italic>L</italic><sub><italic>R</italic></sub> is formulated using semi-supervised learning (SSL) to learn a concordant latent representation which encodes both positive-counts and pseudo-counts assigned by the imputer as
<disp-formula id="Equm"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_R=\frac{1}{N}\sum \limits_c{\left\Vert \alpha {2}_c\circ \left(\hat{y_c}-\hat{{y_c}^{\hbox{'}}}\right)\right\Vert}^2, $$\end{document}</tex-math><mml:math id="M92" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:msup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:msub><mml:mo>∘</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>'</mml:mo></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equm.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq34"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha {2}_{c,m}=\left\{\begin{array}{cc}{\alpha}_R,&amp; {x}_{c,m}^0&gt;0\\ {}1,&amp; {x}_{c,m}^0=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M94" display="inline"><mml:mi>α</mml:mi><mml:msub><mml:mn>2</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq34.gif"/></alternatives></inline-formula>, <italic>α</italic><sub><italic>R</italic></sub> balances the biased portions towards zero-counts, the reconstruction target is <inline-formula id="IEq35"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{{y_{c,m}}^{\hbox{'}}}=\left\{\begin{array}{cc}{x}_{c,m}^0,&amp; {x}_{c,m}^0&gt;0\\ {}{y}_{c,m},&amp; {x}_{c,m}^0=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M96" display="inline"><mml:mover accent="true"><mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>'</mml:mo></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq35.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec26">
        <title>Prediction loss</title>
        <p id="Par54"><italic>L</italic><sub><italic>P</italic></sub> uses SSL to search an expression profile structure which underlying both positive-counts and pseudo-counts assigned by the decoder, given by
<disp-formula id="Equn"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_P=\frac{1}{N}\sum \limits_t\sum \limits_c{\left\Vert \alpha {3}_c\circ \left({y}_c^t-{y_c^t}^{\hbox{'}}\right)\right\Vert}^2, $$\end{document}</tex-math><mml:math id="M98" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:msup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mn>3</mml:mn><mml:mi>c</mml:mi></mml:msub><mml:mo>∘</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equn.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq36"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha {3}_{c,m}=\left\{\begin{array}{cc}{\alpha}_{P1},&amp; {x}_{c,m}^0&gt;0\\ {}{\alpha}_{P2},&amp; {x}_{c,m}^0=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M100" display="inline"><mml:mi>α</mml:mi><mml:msub><mml:mn>3</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq36.gif"/></alternatives></inline-formula> and the prediction target is <inline-formula id="IEq37"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y_{c,m}^t}^{\hbox{'}}=\left\{\begin{array}{ll}{x}_{c,m}^0,&amp; {x}_{c,m}^0&gt;0\\ {}\hat{y_{c,m}^t},&amp; {x}_{c,m}^0=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M102" display="inline"><mml:msup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq37.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec27">
        <title>Latent representation loss</title>
        <p id="Par55">Prediction of expression profile made by each step is a function of the corresponding latent representation. <italic>L</italic><sub><italic>LR</italic></sub> minimizes the difference between successive latent representations, given by
<disp-formula id="Equo"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_{LR}=\frac{1}{N\cdot T}\sum \limits_{t=1}^{\mathrm{T}+1}\sum \limits_c{\left\Vert {x}_c^t{w}_E-{x}_c^{t-1}{w}_E\right\Vert}^2. $$\end{document}</tex-math><mml:math id="M104" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="italic">LR</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo>⋅</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:msup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equo.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec28">
        <title>Constraint</title>
        <p id="Par56"><italic>L</italic><sub><italic>C</italic></sub> limits the total capacity of imputation counts assuming most zero-counts are either low expressed or unexpressed. <italic>L</italic><sub><italic>C</italic></sub> is given by
<disp-formula id="Equp"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_C=\sum \limits_t\sum \limits_c{\left\Vert \alpha {4}_c\circ {f}_{de}\left({y}_c^t\right)\right\Vert}^2, $$\end{document}</tex-math><mml:math id="M106" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:msup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mn>4</mml:mn><mml:mi>c</mml:mi></mml:msub><mml:mo>∘</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="italic">de</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equp.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \alpha {4}_{c,m}=\left\{\begin{array}{cc}0,&amp; {x}_{c,m}^0&gt;0\\ {}1,&amp; {x}_{c,m}^0=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M108" display="inline"><mml:mi>α</mml:mi><mml:msub><mml:mn>4</mml:mn><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq38.gif"/></alternatives></inline-formula> and <italic>f</italic><sub><italic>de</italic></sub>(⋅) is a function reverses the normalized counts back to counts.</p>
      </sec>
      <sec id="Sec29">
        <title>Regularization</title>
        <p id="Par57">We assumed that some genes contribute more (strong connection) to each neuron of the latent representation. However, conventional sparse regularizers, i.e., L1 regularizer and Log regularizer, are unable to restrict the number of genes having strong connections to the neurons. We developed a new regularizer, <italic>f</italic><sub><italic>re</italic></sub>, to restrict the genes as
<disp-formula id="Equq"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_{re}(w)=\sum \limits_i^{NN_w}{\left(\sum \limits_{j\in {w}_i}{j}^2\right)}^2, $$\end{document}</tex-math><mml:math id="M110" display="block"><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="italic">re</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>w</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mi>i</mml:mi><mml:msub><mml:mi mathvariant="italic">NN</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equq.gif" position="anchor"/></alternatives></disp-formula>where <italic>NN</italic><sub><italic>w</italic></sub> is the number of output-nodes, <italic>w</italic><sub><italic>i</italic></sub> is the collection of weights connecting with <italic>i</italic>th output-node. <italic>j</italic><sup>2</sup> removes weights that are very small.</p>
        <p id="Par58">The overall loss function is
<disp-formula id="Equr"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{l}\mathrm{L}={\beta}_1{L}_I+{\beta}_2{L}_R+{\beta}_3{L}_P+{\beta}_4{L}_{LR}+{\beta}_5{L}_C\\ {}\kern1.25em +{\beta}_6\left({f}_{re}\left({w}_E\right)+{f}_{re}\left({w}_{h1}\right)\right)\\ {}\kern1.5em +{\beta}_7\sum \limits_{w\in {w}_{h2},{w}_{p_1},{w}_{p_2}}{w}^2+{\beta}_8\sum \limits_{w\in {w}_a}{w}^2+{\beta}_9\sum \limits_{w\in \varphi }{w}^2.\end{array}} $$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">L</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="italic">LR</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.25em"/><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="italic">re</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>w</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="italic">re</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.5em"/><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mi>φ</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2020_2083_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par59">DISC was trained using Adam [<xref ref-type="bibr" rid="CR27">27</xref>] with learning rate 0.001. Gradient clipping of 5 was used to avoid exploding gradient.</p>
      </sec>
      <sec id="Sec30">
        <title>Stop of training</title>
        <p id="Par60">Predictor of DISC is a function of the latent representation, <italic>z</italic><sup><italic>t</italic></sup>. When the difference of <italic>z</italic><sup><italic>t</italic></sup> across multiple steps becomes smaller, DISC is convergent to a stable point. Therefore, DISC uses latent representation loss to evaluate the similarity of <italic>z</italic><sup><italic>t</italic></sup> across multiple steps and to determine the best stop point based on the variance of this loss over multiple batches (10,000 batches by default). We chose 5 million cells as an initial point because DISC generally reached optimal points after learning information from approximately 5 million cells in many datasets with a variety of gene and cell numbers. This property makes DISC a stable running time for datasets of various sizes. The procedure is as follows.
<list list-type="order"><list-item><p id="Par61">DISC is first trained for 5 million cells (128 cells per training batch on default) and calculates the standard deviation (STD) of <italic>L</italic><sub><italic>LR</italic></sub> for the last 10,000 batches. This STD is set as the minimum STD, and this STD remains as the minimum STD for 1 round (minimum round where a training round is 50,000 cells).</p></list-item><list-item><p id="Par62">DISC is trained for another 50,000 cells and calculates a new STD of <italic>L</italic><sub><italic>LR</italic></sub> for the last 10,000 batches.</p></list-item><list-item><p id="Par63">If the new STD is greater than the minimum STD, minimum round is increased by 1. Otherwise, minimum STD is set as the new STD, and minimum round is reset to 1.</p></list-item><list-item><p id="Par64">If minimum round is less than 5, repeat step 2. Otherwise, training is stopped.</p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec31">
      <title>Hyperparameter optimization</title>
      <p id="Par65">Hyperparameters for the model architecture, including layer neuron numbers, number of steps and learning rate, are pre-defined (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1), and the other ones were sampled using Latin hypercube sampling [<xref ref-type="bibr" rid="CR28">28</xref>]. We provided a set of hyperparameters as the default so that users can easily use DISC without to undergo the time-consuming optimization process. We tested the default hyperparameter set for many high-throughput single cell datasets with different cell numbers (thousands to millions), different platforms, and different cell compositions, and the performance was robust. The following hyperparameters are set as the default value:</p>
      <p id="Par66"><italic>α</italic><sub><italic>R</italic></sub> = 5, <italic>α</italic><sub><italic>P</italic>1</sub> = 1.5, <italic>α</italic><sub><italic>P</italic>2</sub> = 0.35, <italic>β</italic><sub>1</sub> = 1, <italic>β</italic><sub>2</sub> = 1, <italic>β</italic><sub>3</sub> = 1, <italic>β</italic><sub>4</sub> = 1.65 × <italic>M</italic> × 1<italic>e</italic><sup>−5</sup>, <italic>β</italic><sub>5</sub> = 6.3 × 1<italic>e</italic><sup>−5</sup>, <italic>β</italic><sub>6</sub> = 1<italic>e</italic><sup>−6</sup>, <italic>β</italic><sub>7</sub> = 1<italic>e</italic><sup>−6</sup>, <italic>β</italic><sub>8</sub> = 1<italic>e</italic><sup>−5</sup>, and <italic>β</italic><sub>9</sub> = 1<italic>e</italic><sup>−4</sup>. Users are also able to change them via command line interface.</p>
    </sec>
    <sec id="Sec32">
      <title>Generating training batches</title>
      <p id="Par67">To randomize cell orders in an expression matrix, a common practice is to load a complete expression matrix into memory and random sample cell batches. However, loading large expression matrix usually causes out-of-memory errors (OOM). A previous method split the expression matrix into several parts and saved onto hard disk [<xref ref-type="bibr" rid="CR10">10</xref>]. During training, parts were loaded separately to generate random cell batches. However, by this approach, random sampling was performed locally within the parts and pre-processing required extra work. Here, we developed a novel method to generate globally random cell batches.
<list list-type="order"><list-item><p id="Par68">Cells are indexed by chunks of arbitrary size (32 cells by default).</p></list-item><list-item><p id="Par69">Multiple chunks are loaded randomly (64 chunks by default) into a sub-queue in the memory and cells in the sub-queue are shuffled. Once shuffled, cells are transferred into a main queue in the main thread.</p></list-item><list-item><p id="Par70">Cells are loaded parallelly via parallel sub-queues to reduce the loading delay and cells from different sub-queues are transferred randomly into the main queue.</p></list-item><list-item><p id="Par71">At the end, cell batches are withdrawn from the main queue based on first-in-first-out rule.</p></list-item></list></p>
    </sec>
    <sec id="Sec33">
      <title>Cell-type identification</title>
      <sec id="Sec34">
        <title>Small and large datasets</title>
        <p id="Par72">For smaller datasets, including PBMC, RETINA, neuronal cells (129 K cells), and non-neuronal cells (27 K cells) of BRAIN_SPLiT datasets, Seurat V3.0 [<xref ref-type="bibr" rid="CR29">29</xref>] was used to perform normalization, feature selection, scaling, PCA, clustering, and t-SNE/u-MAP visualization. Resolution and PCA-dimension parameters for clustering were selected to produce the best accuracy against cell-type labels. Specifically, resolution of 0.5–1.4 (0.5 for PBMC, 1.4 for RETINA, 1.4 for BRAIN_SPLiT) and top 10–50 principal components of PCA (10 for PBMC, 30 for RETINA, 50 for BRAIN_SPLiT) were used and clustering was based on the graph-based shared nearest neighbor method (SNN). Differential expression analysis was used to identify cluster-specific marker genes where all the clusters are pairwise compared using the Wilcoxon method. Each identified marker gene was expressed in a minimum of 25% of cells and at a minimum log fold change threshold of 0.25. When the cluster-specific marker genes contain the reference cell type, we defined the cluster as the reference cell type. However, if multiple reference marker genes for different cell types or no reference marker genes appeared in the cluster-specific marker genes, we defined these clusters as unknown cell types.</p>
      </sec>
      <sec id="Sec35">
        <title>Ultra-large dataset</title>
        <p id="Par73">For the BRAIN_1.3 M dataset with 1.3 million cells, traditional methods are unable to cluster cells using the whole expression matrix. Compressed features of 50 dimensions from DISC were used for clustering by Seurat, where the resolution was set to 1.4. Differential expression analysis was described above.</p>
      </sec>
    </sec>
    <sec id="Sec36">
      <title>Evaluation of imputation performance</title>
      <sec id="Sec37">
        <title>Gene selection</title>
        <p id="Par74">Genes match the following conditions were removed:
<list list-type="order"><list-item><p id="Par75">Expressed in less than 1/1000 of total cells or less than 10 cells, whichever is greater.</p></list-item><list-item><p id="Par76">Maximum mRNA count is 1.</p></list-item></list></p>
      </sec>
      <sec id="Sec38">
        <title>Comparison of scRNA-seq and FISH</title>
        <p id="Par77">Genes overlapped between scRNA-seq (≥ 10 positive-count cells) and FISH were selected. To compare the expression distributions of scRNA-seq and FISH, each selected gene was normalized by an efficient factor [<xref ref-type="bibr" rid="CR6">6</xref>], where efficient factor was defined as the ratio of its FISH mean to its scRNA-seq (raw or imputation) mean.</p>
      </sec>
      <sec id="Sec39">
        <title>Down-sampling</title>
        <p id="Par78">We randomly sampled transcript reads from scRNA-seq dataset followed a previous research [<xref ref-type="bibr" rid="CR5">5</xref>]. Transcripts were sampled either 30 or 50% of the original cell library size.</p>
      </sec>
      <sec id="Sec40">
        <title>Gini coefficient</title>
        <p id="Par79">We used “reldist” package in R to calculate Gini coefficient to quantify gene expression distribution [<xref ref-type="bibr" rid="CR30">30</xref>]. The difference of Gini coefficients between scRNA-seq (raw and imputation) and FISH was calculated by rooted mean square error (RMSE), given as
<disp-formula id="Equs"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Gini}\ \mathrm{RMS}{\mathrm{E}}_{\mathrm{method}}=\sqrt{\frac{\sum \limits_{i=1}^n{\left({\mathrm{Gini}}_{\mathrm{FISH},i}-{\mathrm{Gini}}_{\mathrm{method},i}\right)}^2}{n}}, $$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mtext>Gini</mml:mtext><mml:mspace width="0.25em"/><mml:mi>RMS</mml:mi><mml:msub><mml:mi mathvariant="normal">E</mml:mi><mml:mtext>method</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mtext>Gini</mml:mtext><mml:mrow><mml:mtext>FISH</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>Gini</mml:mtext><mml:mrow><mml:mtext>method</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equs.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the number of overlapped genes, <italic>i</italic> is the index of the genes.</p>
      </sec>
      <sec id="Sec41">
        <title>Fasano and Franceschini’s test</title>
        <p id="Par80">Kolmogorov-Smirnov (K-S) distance [<xref ref-type="bibr" rid="CR31">31</xref>] is a nonparametric estimation of the distance between two one-dimensional probability distributions, based on their cumulative distributions. Fasano and Franceschini’s (FF) distance [<xref ref-type="bibr" rid="CR32">32</xref>] is a multi-dimensional version of K-S distance. Using FISH data as the reference, we used a script (<ext-link ext-link-type="uri" xlink:href="https://github.com/syrte/ndtest/blob/master/ndtest.py">https://github.com/syrte/ndtest/blob/master/ndtest.py</ext-link>) to calculate FF distance as a measurement for the similarity of the gene-gene co-expression distribution between scRNA-seq (raw and imputation) and FISH.</p>
      </sec>
      <sec id="Sec42">
        <title>Correlation matrix distance (CMD)</title>
        <p id="Par81">CMD is a measure of the distance between two correlation matrices [<xref ref-type="bibr" rid="CR33">33</xref>]. The CMD for two correlation matrices <italic>R</italic><sub>1</sub>, <italic>R</italic><sub>2</sub> is defined as
<disp-formula id="Equt"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d\left({R}_1,{R}_2\right)=1-\frac{tr\left({R}_1,{R}_2\right)}{{\left\Vert {R}_1\right\Vert}_f{\left\Vert {R}_2\right\Vert}_f}. $$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">tr</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mfenced close="‖" open="‖"><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mi>f</mml:mi></mml:msub><mml:msub><mml:mfenced close="‖" open="‖"><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equt.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par82">For comparison with FISH, Pearson’s correlation was calculated for gene pairs in <italic>R</italic><sub>1</sub> (FISH) and <italic>R</italic><sub>2</sub> (raw or imputation) using all the overlapped genes. For comparison in down-sampling dataset, Pearson’s correlation was calculated for gene pairs in <italic>R</italic><sub>1</sub> (reference) and <italic>R</italic><sub>2</sub> (observed or imputation) using the top 300 variable feature genes selected by Seurat’s “vst” function [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR29">29</xref>].</p>
      </sec>
      <sec id="Sec43">
        <title>Mean absolute error (MAE)</title>
        <p id="Par83">MAE measures the difference of gene expressions of the observed or imputation data to the reference data, given by
<disp-formula id="Equu"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{MAE}}_c=\frac{\sum \limits_{i={D}_c}^n\left|{C}_{c,i}^{ds}\times {sf}_c-{C}_{c,i}^{\mathrm{reference}}\right|}{\operatorname{card}\left({D}_c\right)}, $$\end{document}</tex-math><mml:math id="M118" display="block"><mml:msub><mml:mi>MAE</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="italic">ds</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="italic">sf</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mtext>reference</mml:mtext></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>card</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equu.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic><sub><italic>c</italic></sub> is the set of positive-count genes in cell c from the reference data, card(<italic>D</italic><sub><italic>c</italic></sub>) is the size of set <italic>D</italic><sub><italic>c</italic></sub>, <italic>C</italic><sup><italic>ds</italic></sup> is the observed/imputed mRNA counts, <italic>C</italic><sup>reference</sup> is the mRNA counts before down-sampling, and <inline-formula id="IEq39"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {sf}_c={ls}_c^{\mathrm{reference}}/{ls}_c^{ds} $$\end{document}</tex-math><mml:math id="M120" display="inline"><mml:msub><mml:mi mathvariant="italic">sf</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="italic">ls</mml:mi><mml:mi>c</mml:mi><mml:mtext>reference</mml:mtext></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi mathvariant="italic">ls</mml:mi><mml:mi>c</mml:mi><mml:mi mathvariant="italic">ds</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq39.gif"/></alternatives></inline-formula>, where <italic>ls</italic><sup>reference</sup> and <italic>ls</italic><sup><italic>ds</italic></sup> are the cell library size vectors for the corresponding datasets.</p>
      </sec>
      <sec id="Sec44">
        <title>Gene-gene and cell-cell correlation</title>
        <p id="Par84">Pearson’s correlation was calculated at the gene or cell levels before and after down-sampling. At the gene level, genes were included if they express in at least 10% of cells. At the cell level, cells were included if they have at least 10% of gene expressed.</p>
      </sec>
      <sec id="Sec45">
        <title>Evaluation of cell-type annotation accuracy</title>
        <p id="Par85">To evaluate cell-type accuracy, three evaluation metrics are used. Accuracy (ACC) and adjusted rand index (ARI) are used to assess the properties of the overall clustering results and Jaccard index is used to calculate the accuracy of each cell type.</p>
        <p id="Par86">ACC is calculated as
<disp-formula id="Equv"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ACC}=\frac{\sum \limits_{i=1}^n\delta \left({r}_i,{s}_i\right)}{n} $$\end{document}</tex-math><mml:math id="M122" display="block"><mml:mi>ACC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>δ</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:math><graphic xlink:href="13059_2020_2083_Article_Equv.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the cell number, <italic>r</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>i</italic></sub> are the cell type label and classified cell type, respectively, for <italic>i</italic>th cell, and
<disp-formula id="Equw"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \delta \left(x,y\right)=\left\{\begin{array}{cc}1&amp; \mathrm{if}\kern0.5em x=y\\ {}0&amp; \mathrm{otherwise}\end{array}\right.. $$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mi>δ</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="0.5em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equw.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par87">The overlap between the cell type labels and classified cell type can be summarized in a contingency table, in which each entry denotes the number of objects in common between the two sets.</p>
        <p id="Par88">ARI is calculated as
<disp-formula id="Equx"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ARI}=\frac{\sum \limits_{i=1}^{\left|\mathrm{K}\right|}\sum \limits_{j=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{n}_{i,j}\\ {}2\end{array}\right)-\left[\sum \limits_{i=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{a}_i\\ {}2\end{array}\right)\sum \limits_{j=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{b}_j\\ {}2\end{array}\right)\right]/\left(\begin{array}{c}n\\ {}2\end{array}\right)}{\frac{1}{2}\left[\sum \limits_{i=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{a}_i\\ {}2\end{array}\right)\sum \limits_{j=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{b}_j\\ {}2\end{array}\right)\right]-\left[\sum \limits_{i=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{a}_i\\ {}2\end{array}\right)\sum \limits_{j=1}^{\left|\mathrm{K}\right|}\left(\begin{array}{c}{b}_j\\ {}2\end{array}\right)\right]/\left(\begin{array}{c}n\\ {}2\end{array}\right)}, $$\end{document}</tex-math><mml:math id="M126" display="block"><mml:mi>ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mo>−</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:mi mathvariant="normal">Κ</mml:mi></mml:mfenced></mml:munderover><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equx.gif" position="anchor"/></alternatives></disp-formula>where K is the set of unique cell type labels, <italic>n</italic><sub><italic>i</italic>, <italic>j</italic></sub> are values from the contingency table, <italic>a</italic><sub><italic>i</italic></sub> is the sum of the <italic>i</italic>th row of the contingency table, <italic>b</italic><sub><italic>j</italic></sub> is the sum of the <italic>j</italic>th column of the contingency table, and ( ) denotes a binomial coefficient and <inline-formula id="IEq40"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\begin{array}{c}n\\ {}2\end{array}\right) $$\end{document}</tex-math><mml:math id="M128" display="inline"><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq40.gif"/></alternatives></inline-formula> means <inline-formula id="IEq41"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{n\left(n-1\right)}{2} $$\end{document}</tex-math><mml:math id="M130" display="inline"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2020_2083_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
        <p id="Par89">Jaccard index is calculated as
<disp-formula id="Equy"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ J\left(c,d,k\right)=\frac{\left|c\cap d\right|}{\left|c\right|+\left|d\right|-\left|c\cap d\right|}, $$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mi>J</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:mi>c</mml:mi><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∩</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>c</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mi>d</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∩</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2083_Article_Equy.gif" position="anchor"/></alternatives></disp-formula>respectively, where <italic>c</italic> is the set of cells with type labels <italic>k</italic>, <italic>d</italic> is the set of cells with classified cell type, and <italic>k</italic> ∈ Κ.</p>
      </sec>
      <sec id="Sec46">
        <title>Ranking differentially expressed genes (DEGs)</title>
        <p id="Par90">For the bulk RNA-seq samples, DEGs were identified using the limma R/Bioconductor package. We corrected <italic>p</italic> values for multiple testing using the Benjamini-Hochberg (BH) method (p.adjust function in the stats R package) to derive false discovery rate (FDR). Genes with FDR smaller than <italic>α</italic> = 0.05 and log fold change greater than 1.5 were identified as DEG and used as the “gold standard” in the following comparison. The number of DEGs identified is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7. For the scRNA-seq data, DEGs were identified using MAST and (2) Wilcoxon rank-sum test, where we used Seurat FindMarkers function to perform the two methods, and set min.pct = 0.1, logfc.threshold = 0 to get the difference of all genes. The single-cell DEGs were ranked by p_val_adj or the log-scaled expression fold change if there was a tie for p_val_adj. For <italic>i</italic> from 1 to <italic>k</italic>, we calculated the proportion of top 10 * <italic>i</italic> single-cell DEGs that overlap with bulk DEGs while the average of these <italic>k</italic> proportions served as the performance metric. For comparing DEG identification from all genes, <italic>k</italic> was set at 100, and for comparing DEG identification in 10 intervals sorted by FC, <italic>k</italic> was set at 10.</p>
      </sec>
      <sec id="Sec47">
        <title>Null differential analysis</title>
        <p id="Par91">There are no DEGs in a homogeneous population of cells, such as 293T cells from the JURKAT_293T dataset (<italic>N</italic> = 2885 cells) and A549 cells from the 10X_5CL dataset (<italic>N</italic> = 1256 cells). Therefore, for each dataset, we randomly sampled cells into two groups with group sizes ranging from <italic>N</italic> = 10 to 500 [<xref ref-type="bibr" rid="CR15">15</xref>]. We conducted DEG analysis for 10 conditions with different cell numbers (10 vs. 10, 10 vs. 50, 10 vs. 100, 10 vs.500, 50 vs. 50, 50 vs.100, 50 vs. 500, 100 vs. 100, 100 vs. 500, 500 vs. 500). We identified DEGs using MAST and Wilcoxon rank-sum test. Genes with <italic>p</italic> value &lt; 0.01 and logfc &gt; 0.25 were identified as DEG.</p>
      </sec>
      <sec id="Sec48">
        <title>Trajectory analysis</title>
        <p id="Par92">Following a previous study [<xref ref-type="bibr" rid="CR15">15</xref>], the bulk-sequencing data from 13 hematopoietic cell types of 3 cell lineages, lymphoid, erythroid, and myeloid (GSE74246) were used to identify hematopoietic cells profiled by 10X Genomics single-cell platform (BONE_MARROW). Briefly, each cell in BONE_MARROW was marked as one of the 13 hematopoietic cell types whose bulk RNA-seq profile has the highest Spearman’s correlation with the cell’s scRNA-seq profile. Then, the scRNA-seq expression matrices were input into Monocle2 to construct pseudo-temporal trajectories using DDRTree algorithm. The known differentiation levels (HSC: level 1; MPP: level 2; LMPP and CMP: level 3; CLP, GMP, and MEP: level 4; B cell, CD4 T cell, CD8 T cell, NK cell, Monocyte, and Erythroid: level 5) served as the reference to compare the correctness of the order inferred between cell-pair from two different differentiation level cell types which are both appeared in at least one of the lymphoid, erythroid, and myeloid lineages. If a cell has a higher differentiation level in the pair, then the cell must have a higher pseudo-time to define the pair in a correct order. For example, for a pair of cells, a HSC and a Monocyte, the order of the pair is inferred correctly if the Monocyte is marked a higher pseudo-time than the HSC since the Monocyte has a higher differentiation level than the HSC. Since the root state can be any of the leaves of the constructed trajectories tree and the root state determines the pseudo-time for all the cells (root state is the pseudo-time 0). Hence, the overall percentage of correctly inferred cell pairs for all the possible cell pairs was calculated for all possible root state and the highest percentage was used for comparison.</p>
      </sec>
    </sec>
    <sec id="Sec49">
      <title>Comparison of imputation approaches</title>
      <p id="Par93">The imputation approaches were run on a Linux CentOS 7 server with 2 Intel® Xeon® E5–2650 v4 CPUs, 128GB RAM and 1 NVIDIA® Tesla® V100 GPU. Unless otherwise noted, software packages were used with their default settings after gene selection. For all deep learning methods (DISC, DCA, scVI and scScope), GPU were used for training and imputation. The running scripts can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/xie-lab/DISC/tree/master/reproducibility/source/Running%20Scripts%20for%20Other%20Methods">https://github.com/xie-lab/DISC/tree/master/reproducibility/source/Running%20Scripts%20for%20Other%20Methods</ext-link>.</p>
      <sec id="Sec50">
        <title>Speed and memory comparison</title>
        <p id="Par94">Speed and memory usage were compared using BRAIN_1.3 M dataset. Cells express less than 500 or greater than 5000 genes were removed (approximately 1.3 million cells left). The top 1000 or 10,000 highly variable genes were selected using “vst” (variance stabilizing transformation) of Seurat. We then randomly sampled 3 subsets in different cell numbers (50 k, 100 k and 500 k cells). We duplicated 1.3 M datasets into a 2.6 M cell dataset. For each imputation method compared, we ran each dataset 3 times and calculated the average computation time and memory usage.</p>
      </sec>
      <sec id="Sec51">
        <title>Methods comparisons</title>
        <sec id="FPar1">
          <title>Magic</title>
          <p id="Par95">We used the Python package of magic-impute v1.5.5. Following its tutorial (<ext-link ext-link-type="uri" xlink:href="https://nbviewer.jupyter.org/github/KrishnaswamyLab/MAGIC/blob/master/python/tutorial_notebooks/emt_tutorial.ipynb">https://nbviewer.jupyter.org/github/KrishnaswamyLab/MAGIC/blob/master/python/tutorial_notebooks/emt_tutorial.ipynb</ext-link>), we performed library size normalization and square root transformation before imputation. We then squared and denormalized its output gene expressions after imputation.</p>
        </sec>
        <sec id="FPar2">
          <title>scImpute</title>
          <p id="Par96">We used the R package of scImpute v0.0.9.</p>
        </sec>
        <sec id="FPar3">
          <title>VIPER</title>
          <p id="Par97">We used the R package of VIPER (GitHub commit 0170c27). Following its README (<ext-link ext-link-type="uri" xlink:href="https://github.com/ChenMengjie/VIPER/blob/master/README.md">https://github.com/ChenMengjie/VIPER/blob/master/README.md</ext-link>), we used its gene-based imputation.</p>
        </sec>
        <sec id="FPar4">
          <title>DCA</title>
          <p id="Par98">We used the Python package of DCA v0.2.2.</p>
        </sec>
        <sec id="FPar5">
          <title>scScope</title>
          <p id="Par99">We used the Python package of scScope v0.1.5. Following its demo script (<ext-link ext-link-type="uri" xlink:href="https://github.com/AltschulerWu-Lab/scScope/blob/master/demo.py">https://github.com/AltschulerWu-Lab/scScope/blob/master/demo.py</ext-link>), we normalized each cell to have the same library size, set the feature dimension as 50 and then imputed dropout values after training with the default setting.</p>
        </sec>
        <sec id="FPar6">
          <title>scVI</title>
          <p id="Par100">We used the Python package of scVI v0.3.0, followed the reproducibility script (<ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/scVI/blob/aa614bdaf2ff57fbb661394e53a9a2454b950882/tests/notebooks/scVI_reproducibility.ipynb">https://github.com/YosefLab/scVI/blob/aa614bdaf2ff57fbb661394e53a9a2454b950882/tests/notebooks/scVI_reproducibility.ipynb</ext-link>).</p>
        </sec>
        <sec id="FPar7">
          <title>DeepImpute</title>
          <p id="Par101">We used the Python package of deepImpute v1.0.0.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec52" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <sec id="Sec53">
        <title>MELANOMA (GSE99330, 8498 melanoma cells by Drop-seq) with FISH</title>
        <p id="Par102">Eight thousand six hundred forty cells from the melanoma WM989 cell line were sequenced using Drop-seq [<xref ref-type="bibr" rid="CR34">34</xref>], where 32,287 genes were detected. Eight thousand four hundred ninety-eight cells were extracted according to the previous pipeline [<xref ref-type="bibr" rid="CR6">6</xref>] and 15,204 genes were left after gene selection. In addition, RNA FISH experiment of across 7000–88,000 melanoma cells from the same cell line was conducted and 26 were detected [<xref ref-type="bibr" rid="CR35">35</xref>], in which 19 genes were overlapped with the 15,204 genes, including 9 housekeeping genes (<italic>BABAM1</italic>, <italic>GAPDH</italic>, <italic>LMNA</italic>, <italic>CCNA2</italic>, <italic>KDM5A</italic>, <italic>KDM5B</italic>, <italic>MITF</italic>, <italic>SOX10</italic>, and <italic>VGF</italic>) and 10 drug-resistance markers (<italic>C1S</italic>, <italic>FGFR1</italic>, <italic>FOSL1</italic>, <italic>JUN</italic>, <italic>RUNX2</italic>, <italic>TXNRD1</italic>, <italic>WNT5A</italic>, <italic>EGFR</italic>, <italic>PDGFC</italic>, and <italic>VCL</italic>). RNA-seq data can be found at GSE99330. RNA FISH data can be found at <ext-link ext-link-type="uri" xlink:href="https://www.dropbox.com/s/ia9x0iom6dwueix/fishSubset.txt?dl=0">https://www.dropbox.com/s/ia9x0iom6dwueix/fishSubset.txt?dl=0</ext-link>.</p>
      </sec>
      <sec id="Sec54">
        <title>SSCORTEX (SRP135960, 3447 and 3969 mouse somatosensory cortex cells in 2 replications by 10X Genomics) with FISH</title>
        <p id="Par103">Mouse somatosensory cortex of CD-1 mice at age of p28 and p29 were profiled by 10X where 7477 cells were detected in total [<xref ref-type="bibr" rid="CR36">36</xref>]. Cells expressed less than 500 or greater than 5000 genes were removed (7416 cells left) and 13,997 genes were left after gene selection. osmFISH experiment of 4839 cells from the somatosensory cortex, hippocampus, and ventricle from a CD-1 mouse at age of p22 was conducted [<xref ref-type="bibr" rid="CR37">37</xref>]. Four thousand three hundred eighty-eight cells from somatosensory cortex were extracted with 33 genes detected where all of the FISH genes were overlapped with the 13,997 genes, including <italic>GAD2</italic>, <italic>SLC32A1</italic>, <italic>CRHBP</italic>, <italic>CNR1</italic>, <italic>VIP</italic>, <italic>CPNE5</italic>, <italic>PTHLH</italic>, <italic>CRH</italic>, <italic>TBR1</italic>, <italic>LAMP5</italic>, <italic>RORB</italic>, <italic>SYT6</italic>, <italic>KCNIP2</italic>, <italic>ALDOC</italic>, <italic>GFAP</italic>, <italic>SERPINF1</italic>, <italic>MFGE8</italic>, <italic>SOX10</italic>, <italic>PLP1</italic>, <italic>PDGFRA</italic>, <italic>BMP4</italic>, <italic>ITPR2</italic>, <italic>TMEM2</italic>, <italic>CTPS</italic>, <italic>ANLN</italic>, <italic>MRC1</italic>, <italic>HEXB</italic>, <italic>TTR</italic>, <italic>FOXJ1</italic>, <italic>VTN</italic>, <italic>FLT1</italic>, <italic>APLN</italic>, and <italic>ACTA2</italic>. RNA-seq data can be extracted from <ext-link ext-link-type="uri" xlink:href="http://loom.linnarssonlab.org/clone/Mousebrain.org.level1/L1_Cortex2.loom">http://loom.linnarssonlab.org/clone/Mousebrain.org.level1/L1_Cortex2.loom</ext-link>. The FISH data can be found at <ext-link ext-link-type="uri" xlink:href="http://linnarssonlab.org/osmFISH/availability/">http://linnarssonlab.org/osmFISH/availability/</ext-link>.</p>
      </sec>
      <sec id="Sec55">
        <title>PBMC (2638 freeze-thaw human PBMC cells by 10X Genomics)</title>
        <p id="Par104">Two thousand seven hundred freeze-thaw peripheral blood mononuclear cells (PBMC) from a healthy donor were profiled by 10X, where 32,738 genes were detect [<xref ref-type="bibr" rid="CR38">38</xref>]. Cells expressed less than 200 or greater than 2500 genes or have &gt; 5% mitochondrial counts were removed (2638 cells left) and 8654 genes were left after gene selection. RNA-seq data can be found at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_a">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_a</ext-link>.</p>
      </sec>
      <sec id="Sec56">
        <title>CBMC (GSE100866, 8005 human CBMC cells by CITE-seq)</title>
        <p id="Par105">Cord blood mononuclear cells were profiled by CITE-seq, where 8005 human cells were detected in total. We used all detected human (20,400) genes (11,556 genes were left after gene selection) for down-sampling [<xref ref-type="bibr" rid="CR39">39</xref>]. RNA-seq data can be found at GSE100866.</p>
      </sec>
      <sec id="Sec57">
        <title>JURKAT_293T (3258 and 2885 human cells by 10X Genomics)</title>
        <p id="Par106">Jurkat and 293T were profiled by 10X separately. Cells expressed less than 500 genes were removed and 3258 Jurkat and 2885 293 T cells were left [<xref ref-type="bibr" rid="CR15">15</xref>]. After gene selection, Jurkat, 293T, and their merged data left 11,293, 11,974, and 13,328 genes, respectively. Single-cell RNA-seq data can be found at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/jurkat">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/jurkat</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/293t">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/293t</ext-link> while the corresponding bulk RNA-seq data can be found at GSE129240.</p>
      </sec>
      <sec id="Sec58">
        <title>10X_5CL (GSE126906, 3918 cells from 5 cell lines by 10X Genomics)</title>
        <p id="Par107">Five thousand one cells from 5 human lung adenocarcinoma cell lines H2228, H1975, A549, H838, and HCC827 were profiled by 10X, where 32,895 genes were detected. Cells expressed less than 500 genes were removed (3918 cells left) and 18,296 genes were left after gene selection [<xref ref-type="bibr" rid="CR15">15</xref>]. Single-cell RNA-seq data can be found at GSE126906 and the corresponding bulk RNA-seq data can be found at GSE86337.</p>
      </sec>
      <sec id="Sec59">
        <title>BONE_MARROW (HCA, 6939 human bone marrow cells by 10X Genomics)</title>
        <p id="Par108">Six thousand nine hundred forty-one human bone marrow cells from sample MantonBM6 were profiled by 10X [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR40">40</xref>], where 32,738 genes were detected. Cells expressed less than 500 genes were removed (6939 cells left) and 13,813 genes were left after gene selection. The original single-cell RNA sequencing data provided by HCA was aligned to hg19 and the expression matrix after cell filtering can be found at <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/file/d/1euh8YB8ThSLHJNQMTCuuKp_nRiME1KzN/view?usp=drive_web">https://drive.google.com/file/d/1euh8YB8ThSLHJNQMTCuuKp_nRiME1KzN/view?usp=drive_web</ext-link>. The corresponding bulk RNA-seq used for cell identification can be found at GSE74246.</p>
      </sec>
      <sec id="Sec60">
        <title>RERINA (GSE63473, 49,300 retina STAMPs by Drop-seq)</title>
        <p id="Par109">Retinas of mice at age of p14 were profiled in 7 different replicates by Drop-seq, where 6600, 9000, 6120, 7650, 7650, 8280, and 4000 STAMPs (single-cell transcriptomes attached to micro-particles) were collected with 24,658 genes detected [<xref ref-type="bibr" rid="CR2">2</xref>]. Cells were merged and 14,871 genes were left after gene selection. 44,808 cells labeled STAMPs were used for evaluation. RNA-seq data can be found at GSE63473.</p>
      </sec>
      <sec id="Sec61">
        <title>BRAIN_SPLiT (GSE110823, 156,049 mouse brain and spinal cord nuclei by SPLiT-seq)</title>
        <p id="Par110">156,049 mice nuclei from developing brain and spinal cord at age of p2 or p11 mice were profiled by SPLiT-seq, where 26,894 genes were detected [<xref ref-type="bibr" rid="CR3">3</xref>], in which 15,025 genes were left after gene selection. RNA-seq data can be found at GSE110823.</p>
      </sec>
      <sec id="Sec62">
        <title>BRAIN_1.3 M (1,282,594 mouse brain cells by 10X Genomics)</title>
        <p id="Par111">1,306,127 cells from combined cortex, hippocampus, and subventricular zone of 2 E18 C57BL/6 mice were profiled by 10X, where 27,998 genes were detected [<xref ref-type="bibr" rid="CR38">38</xref>]. Cells expressed less than 500 or greater than 5000 genes were removed and 15,080 genes were left after gene selection, and 1,282,594 cells were kept for further analysis. RNA-seq data can be found at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons</ext-link>.</p>
      </sec>
      <sec id="Sec63">
        <title>DISC</title>
        <p id="Par112">DISC is implemented in Python and builds on Google TensorFlow. It runs on both CPUs and GPUs. The source code and the datasets are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xie-lab/DISC">https://github.com/xie-lab/DISC</ext-link> [<xref ref-type="bibr" rid="CR41">41</xref>] and Zenodo [<xref ref-type="bibr" rid="CR42">42</xref>] under Apache License 2.0.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec64">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="13059_2020_2083_MOESM1_ESM.docx">
          <caption>
            <p><bold>Additional file 1.</bold> Supplementary figures and tables for DISC architecture and computational experiments.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="13059_2020_2083_MOESM2_ESM.docx">
          <caption>
            <p><bold>Additional file 2.</bold> Review history.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yao He, Hao Yuan and Cheng Wu contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-020-02083-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the support of the Center for Precision Medicine at Sun Yat-sen University. We also thank NovelBioinformatics Ltd., Co. for providing the NovelBrain Cloud Analysis Platform (<ext-link ext-link-type="uri" xlink:href="http://www.novelbrain.com">www.novelbrain.com</ext-link>).</p>
    <sec id="FPar8">
      <title>Review history</title>
      <p id="Par113">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar9">
      <title>Peer review information</title>
      <p id="Par114">Barbara Cheifet was the primary editor on this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Z.X. and Y. H conceived and designed the study. Y.H. designed the model. Y.H. and H. Y developed the software. C.W., Y.H., and H.Y. analyzed the data. All the authors wrote the manuscript. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was supported by National Key R&amp;D Program of China (2019YFA0904401 and 2016YFC0901604, Z.X.), National Natural Science Foundation of China (31829002, Z.X.), China Postdoctoral Science Foundation (2019 M663220, Y.H.).</p>
  </notes>
  <notes id="FPar10">
    <title>Ethics approval and consent to participate</title>
    <p id="Par115">No ethical approval was required for this study.</p>
  </notes>
  <notes id="FPar11" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par116">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko Evan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas Allison</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck Emily</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Roco</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Muscat</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kuchina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sample</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Graybuck</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Peeler</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Single-cell profiling of the developing mouse brain and spinal cord with split-pool barcoding</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>360</volume>
        <fpage>176</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aam8999</pub-id>
        <pub-id pub-id-type="pmid">29545511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ramani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Huynh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Furlan</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>357</volume>
        <fpage>661</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aam8940</pub-id>
        <pub-id pub-id-type="pmid">28818938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>VIPER: variability-preserving imputation for accurate gene expression recovery in single-cell RNA sequencing studies</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>196</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1575-1</pub-id>
        <pub-id pub-id-type="pmid">30419955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Torre</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bonasio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>539</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0033-z</pub-id>
        <pub-id pub-id-type="pmid">29941873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>WV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>997</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03405-7</pub-id>
        <pub-id pub-id-type="pmid">29520097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Dijk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nainys</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yim</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kathail</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burdziak</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Chaffer</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Pattabiraman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>716</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id>
        <pub-id pub-id-type="pmid">29961576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Altschuler</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Scalable analysis of cell-type composition from single-cell transcriptomics using deep recurrent learning</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>311</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0353-7</pub-id>
        <pub-id pub-id-type="pmid">30886411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eraslan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Mircea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq denoising using a deep count autoencoder</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>390</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07931-2</pub-id>
        <pub-id pub-id-type="pmid">30674886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arisdakessian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Poirion</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Yunits</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Garmire</surname>
            <given-names>LX</given-names>
          </name>
        </person-group>
        <article-title>DeepImpute: an accurate, fast, and scalable deep neural network method to impute single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>211</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1837-6</pub-id>
        <pub-id pub-id-type="pmid">31627739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>False signals induced by single-cell imputation</article-title>
        <source>F1000Research</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>1740</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.16613.1</pub-id>
        <pub-id pub-id-type="pmid">30906525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Freytag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Le Cao</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>JalalAbadi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amann-Zalcenstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Seidi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jabbari</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>479</fpage>
        <lpage>487</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0425-8</pub-id>
        <pub-id pub-id-type="pmid">31133762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Hou W, Ji Z, Ji H, Hicks SC. A systematic evaluation of single-cell RNA-sequencing imputation methods. bioRxiv. 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.01.29.925974v1.abstract">https://www.biorxiv.org/content/10.1101/2020.01.29.925974v1.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>
        <source>Mol Syst Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e8746</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20188746</pub-id>
        <pub-id pub-id-type="pmid">31217225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kostopoulos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Karlos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kotsiantis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ragos</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised regression: a recent review</article-title>
        <source>J Intell Fuzzy Syst</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>1483</fpage>
        <lpage>1500</lpage>
        <pub-id pub-id-type="doi">10.3233/JIFS-169689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Lehtinen J, Munkberg J, Hasselgren J, Laine S, Karras T, Aittala M, Aila T. Noise2noise: learning image restoration without clean data. arXiv. 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1803.04189">https://arxiv.org/abs/1803.04189</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Salim</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DECENT: differential expression with capture efficiency adjustmeNT for single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>5155</fpage>
        <lpage>5162</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz453</pub-id>
        <pub-id pub-id-type="pmid">31197307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yajima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Slichter</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>McElrath</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Prlic</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mann</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>On a test of whether one of two random variables is stochastically larger than the other</article-title>
        <source>Ann Math Stat</source>
        <year>1947</year>
        <volume>18</volume>
        <fpage>50</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177730491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Stassen SV, Siu DM, Lee KC, Ho JW, So HK, Tsia KK. PARC: ultrafast and accurate clustering of phenotypic data of millions of single cells. Bioinformatics. 2020;36:2778–86.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>685</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0113-3</pub-id>
        <pub-id pub-id-type="pmid">31061482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Unterthiner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Self-normalizing neural networks</article-title>
        <source>Advances in neural information processing systems</source>
        <year>2017</year>
        <fpage>971</fpage>
        <lpage>980</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Krizhevsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sutskever</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Salakhutdinov</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title>
        <source>J Mach Learn Res</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1929</fpage>
        <lpage>1958</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Kingma DP, Ba J. Adam: a method for stochastic optimization. arXiv. 2014.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKay</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Beckman</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Conover</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Comparison of three methods for selecting values of input variables in the analysis of output from a computer code</article-title>
        <source>Technometrics</source>
        <year>1979</year>
        <volume>21</volume>
        <fpage>239</fpage>
        <lpage>245</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
            <suffix>III</suffix>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Handcock MS: Relative Distribution Methods. 1.6-6. Project home page at <ext-link ext-link-type="uri" xlink:href="http://www.stat.ucla.edu/~handcock/RelDist">http://www.stat.ucla.edu/~handcock/RelDist</ext-link> edition; 2016.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Massey</surname>
            <given-names>FJ</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>The Kolmogorov-Smirnov test for goodness of fit</article-title>
        <source>J Am Stat Assoc</source>
        <year>1951</year>
        <volume>46</volume>
        <fpage>68</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1951.10500769</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fasano</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Franceschini</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A multidimensional version of the Kolmogorov–Smirnov test</article-title>
        <source>Mon Not R Astron Soc</source>
        <year>1987</year>
        <volume>225</volume>
        <fpage>155</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="doi">10.1093/mnras/225.1.155</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Herdin M, Czink N, Ozcelik H, Bonek E: Correlation matrix distance, a meaningful measure for evaluation of non-stationary MIMO channels. In 2005 IEEE 61st vehicular technology conference. Stockholm: IEEE; 2005: 136–140.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torre</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gospocic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gupte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bonasio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Rare cell detection by single-cell RNA sequencing as guided by single-molecule RNA FISH</article-title>
        <source>Cell Syst</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>171</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.01.014</pub-id>
        <pub-id pub-id-type="pmid">29454938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaffer</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dunagin</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Torborg</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Torre</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Emert</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Krepler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beqiri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sproesser</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brafford</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Rare cell variability and drug-induced reprogramming as a mode of cancer drug resistance</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>546</volume>
        <fpage>431</fpage>
        <lpage>435</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22794</pub-id>
        <pub-id pub-id-type="pmid">28607484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hochgerner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Memic</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Van Der Zwan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Häring</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Borm</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Molecular architecture of the mouse nervous system</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>999</fpage>
        <lpage>1014</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.021</pub-id>
        <pub-id pub-id-type="pmid">30096314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Borm</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Lunteren</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Svensson</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Spatial organization of the somatosensory cortex revealed by osmFISH</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>932</fpage>
        <lpage>935</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0175-z</pub-id>
        <pub-id pub-id-type="pmid">30377364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Houck-Loomis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chattopadhyay</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Swerdlow</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>865</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Benoist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clatworthy</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Science forum: the human cell atlas</article-title>
        <source>Elife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>e27041</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.27041</pub-id>
        <pub-id pub-id-type="pmid">29206104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">He Y, Yuan H, Wu C, Xie Z. DISC: a highly scalable and accurate inference of gene expression and structure for single-cell transcriptomes using semi-supervised deep learning. Github. 2020. <ext-link ext-link-type="uri" xlink:href="https://github.com/xie-lab/DISC">https://github.com/xie-lab/DISC</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">He Y, Yuan H, Wu C, Xie Z. DISC: a highly scalable and accurate inference of gene expression and structure for single-cell transcriptomes using semi-supervised deep learning. Zenodo. 2020. 10.5281/zenodo.3902030.</mixed-citation>
    </ref>
  </ref-list>
</back>
