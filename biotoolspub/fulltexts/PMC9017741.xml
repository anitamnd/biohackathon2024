<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9017741</article-id>
    <article-id pub-id-type="pmid">35439933</article-id>
    <article-id pub-id-type="publisher-id">4668</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04668-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MALVIRUS: an integrated application for viral variant analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ciccolella</surname>
          <given-names>Simone</given-names>
        </name>
        <address>
          <email>simone.ciccolella@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Denti</surname>
          <given-names>Luca</given-names>
        </name>
        <address>
          <email>luca.denti@pasteur.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonizzoni</surname>
          <given-names>Paola</given-names>
        </name>
        <address>
          <email>paola.bonizzoni@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Della Vedova</surname>
          <given-names>Gianluca</given-names>
        </name>
        <address>
          <email>gianluca.dellavedova@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8479-7592</contrib-id>
        <name>
          <surname>Pirola</surname>
          <given-names>Yuri</given-names>
        </name>
        <address>
          <email>yuri.pirola@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Previtali</surname>
          <given-names>Marco</given-names>
        </name>
        <address>
          <email>marco.previtali@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7563.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2174 1754</institution-id><institution>Department of Informatics, Systems and Communication, </institution><institution>University of Milano-Bicocca, </institution></institution-wrap>Viale Sarca 336, 20136 Milan, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0495fxg12</institution-id><institution-id institution-id-type="GRID">grid.428999.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2353 6535</institution-id><institution>Department of Computational Biology, </institution><institution>Institut Pasteur, </institution></institution-wrap>25-28 Rue du Dr Roux, 75015 Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <issue>Suppl 15</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>625</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Being able to efficiently call variants from the increasing amount of sequencing data daily produced from multiple viral strains is of the utmost importance, as demonstrated during the COVID-19 pandemic, in order to track the spread of the viral strains across the globe.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present MALVIRUS, an easy-to-install and easy-to-use application that assists users in multiple tasks required for the analysis of a viral population, such as the SARS-CoV-2. MALVIRUS allows to: (1) construct a variant catalog consisting in a set of variations (SNPs/indels) from the population sequences, (2) efficiently genotype and annotate variants of the catalog supported by a read sample, and (3) when the considered viral species is the SARS-CoV-2, assign the input sample to the most likely Pango lineages using the genotyped variations.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Tests on Illumina and Nanopore samples proved the efficiency and the effectiveness of MALVIRUS in analyzing SARS-CoV-2 strain samples with respect to publicly available data provided by NCBI and the more complete dataset provided by GISAID. A comparison with state-of-the-art tools showed that MALVIRUS is always more precise and often have a better recall.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04668-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sequence analysis</kwd>
      <kwd>Genotyping</kwd>
      <kwd>Lineage classification</kwd>
      <kwd>Virus</kwd>
      <kwd>SARS-CoV-2</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002954</institution-id>
            <institution>Università degli Studi di Milano-Bicocca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019-ATE-0533</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010665</institution-id>
            <institution>H2020 Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>872539</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par11">The SARS-CoV-2 pandemic has put the global health care services to the test and many researchers are racing to face its swift and rapid spread. Since the outbreak of the virus in China and in other European countries, several studies are using sequencing technologies to track the geographical origin of SARS-Cov-2 and to analyze the evolution of sequence variants [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>] or to understand the role played by human genes on viral replication [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. In this context, the availability of efficient approaches to analyze variations from the growing amount of sequencing data daily produced is of the utmost importance.</p>
    <p id="Par12">The typical pipelines for the analysis of variations in viral samples consists of aligning reads against a reference genome [<xref ref-type="bibr" rid="CR8">8</xref>], then analyzing the alignments to discover the variants [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. However, the increasing number of viral assemblies available in public databases such as GISAID [<xref ref-type="bibr" rid="CR11">11</xref>], GenBank [<xref ref-type="bibr" rid="CR12">12</xref>], and the COVID-19 Data Portal allows to build a complete catalog of variants of a viral population. Such a catalog can be used to reduce the complexity of comparative analysis of genetic variants of sequencing samples. For this goal, it is crucial that users are assisted by an efficient and easy-to-use method for building and updating the catalog and for calling and annotating variants that are in this catalog. In this paper, we introduce MALVIRUS, a web application to quickly analyze newly sequenced viral read samples, including—but not only limited to—SARS-CoV-2 samples. Particularly for this novel virus, more and more interest is given to the different Pango lineages of the virus [<xref ref-type="bibr" rid="CR3">3</xref>] (from now on we implicitly assume that lineages are referred to the Pango nomenclature) since different viral lineages exhibit different levels of infection rate and virulence [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. For this reason, MALVIRUS allows for determining the lineage from which a read sample originates—the so called lineage assignment problem—using the well-known tool pangolin [<xref ref-type="bibr" rid="CR15">15</xref>] directly from the read sample without assembling the full-length genome. This step is especially relevant since some lineages are classified by major health organizations as Variants Of Concern (VOC) or Variants of Interest (VOI) [<xref ref-type="bibr" rid="CR16">16</xref>] due to their peculiar characteristics (for example, because they may exhibit resistance to vaccines [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]) that suggest an emerging risk to global public health and, hence, their spread should be attentively monitored and tracked.</p>
    <p id="Par13">We evaluated MALVIRUS accuracy in genotyping, annotating, and classifying newly sequenced SARS-CoV-2 strains on both short and long read data. Since MALVIRUS heavily depends on the current knowledge available (i.e., the set of variations characterizing the population under investigation), we also propose and test different methodologies for building the variant catalog. The proposed pipelines are freely available and can be used with any set of assemblies. In our experimental evaluation, we considered catalogs built on the set of SARS-CoV-2 assemblies freely available on NCBI as well as on the ones available from GISAID. However, we believe that thanks to our pipelines, implemented as Snakemake workflows [<xref ref-type="bibr" rid="CR19">19</xref>], any user can easily build a variant catalog starting from his own private set of assemblies.</p>
    <p id="Par14">MALVIRUS is distributed as a multi-platform Docker container [<xref ref-type="bibr" rid="CR20">20</xref>] and it can be easily accessed using any modern Internet browser.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">MALVIRUS is a user-friendly application for efficiently genotyping a viral sample. MALVIRUS is based on MALVA [<xref ref-type="bibr" rid="CR21">21</xref>] and builds around it a complete and user-friendly infrastructure of scripts and pipelines to facilitate the genotyping of viral samples. MALVA is an efficient tool for genotyping a sample with respect to a catalog of variants without mapping the reads to the reference genome. To assist the user, MALVIRUS provides both a set of precomputed variant catalogs periodically generated from the publicly available SARS-CoV-2 genome assemblies and the ability to compute a variant catalog from a set of user-provided genome assemblies (not necessarily SARS-CoV-2). Furthermore, MALVIRUS assists the user in performing the genotyping task and in visualising the result. For SARS-CoV-2 samples, MALVIRUS also performs the functional annotation of the reconstructed genotype and the Pango lineage assignment of the sample. A Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>] is a cluster of SARS-CoV-2 sequences associated with an epidemiological event.</p>
    <p id="Par16">The rest of this section describes the methods related to catalog creation and presents the pipeline for genotyping the read sample.</p>
    <sec id="Sec3">
      <title>Precomputed catalogs</title>
      <p id="Par17">As already stated, MALVIRUS genotypes a set of variations contained in a catalog, representing the current state of the art on all known variants observed in the population of interest. For user convenience, MALVIRUS is distributed with a set of precomputed catalogs for the SARS-CoV-2 viral genome, thus users can immediately run MALVIRUS on a locally available (e.g., private) viral sample. Moreover, the precomputed catalogs can be easily updated from the application itself with a single click.</p>
      <p id="Par18">The primary aim of the precomputed catalogs is to ensure that the variations they contain represent as completely as possible the set of sequence variations that are present in SARS-CoV-2 genomes sequenced to date, all while maintaining high quality (in order to avoid including variations deriving from technical artifacts) and small size (in order to keep the tool efficient). To achieve this twofold aim, we specifically designed a pipeline that extracts variants from the set of all the assemblies available on GenBank [<xref ref-type="bibr" rid="CR12">12</xref>]. Figure <xref rid="Fig1" ref-type="fig">1</xref> depicts the main steps of the pipeline.<fig id="Fig1"><label>Fig. 1</label><caption><p>Precomputed catalog creation. Schematic representation of the pipelines used to create the precomputed SARS-CoV-2 catalogs from the set of public assemblies available on GenBank</p></caption><graphic xlink:href="12859_2022_4668_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par19">The set of assemblies is initially preprocessed by filtering out sequences with more than <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _{N} = 1\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq1.gif"/></alternatives></inline-formula> ambiguous nucleotides, then the resulting set is subsampled based on their Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>]. Subsampling is performed by assigning the lineage to each assembly using pangolin [<xref ref-type="bibr" rid="CR15">15</xref>], then by keeping 1% of the sequences assigned to each lineage with a minimum of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq2.gif"/></alternatives></inline-formula> and a maximum of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq3.gif"/></alternatives></inline-formula> sequences for each lineage. If a lineage has less than <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq4.gif"/></alternatives></inline-formula> sequences, then all its sequences are kept. Parameters <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq6.gif"/></alternatives></inline-formula> are chosen in order to provide the best trade-off between completeness of the catalogs and computational efficiency of the tool. Currently they are set to 50 and 100, respectively, but their values are subject to change in future updates depending on the number (and the quality) of genome assemblies deposited to GenBank.</p>
      <p id="Par20">Due to the importance of lineages classified as Variants Of Concern/Interest (VOC/VOI) for epidemiology [<xref ref-type="bibr" rid="CR16">16</xref>] and to ensure that they are sufficiently represented in the precomputed catalogs, the parameters <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq8.gif"/></alternatives></inline-formula> for those lineages are increased to <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times min_{lin}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times max_{lin}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq10.gif"/></alternatives></inline-formula>, respectively. Currently, we increased the two parameters for lineages <italic>B.1.1.7</italic>, <italic>B.1.351</italic>, <italic>P.1</italic>, <italic>A.23.1</italic>, and <italic>B.1.525</italic>, that are the subjects of the cov-lineages.org global reports [<xref ref-type="bibr" rid="CR22">22</xref>]. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the frequency distribution of lineages in GenBank as of April 7, 2021 and provides the indication of the most represented lineages (left) and of VOC/VOIs (right) in our precomputed catalogs. As an example of how sequences were sampled, on April 7, 2021, there were 9390 sequences assigned to lineage <italic>B.1</italic> (over a total of 78,098 sequences that passed max ambiguous nucleotides filtering), hence only 93 of them were randomly selected to create the catalog. As another example, there were 16,844 sequences assigned to lineage <italic>B.1.2</italic> and, since the 1% of 16,844 is greater than <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq11.gif"/></alternatives></inline-formula>, only 100 of them were selected to create the catalog. On the other hand, there were 1835 sequences assigned to lineage <italic>A.1</italic> and, since the 1% of 1835 is less than <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq12.gif"/></alternatives></inline-formula>, 50 of them were selected to create the catalog.<table-wrap id="Tab1"><label>Table 1</label><caption><p>GenBank assemblies information</p></caption><graphic position="anchor" xlink:href="12859_2022_4668_Figa_HTML" id="MO4"/><table-wrap-foot><p>Number of assemblies deposited on GenBank for the most represented lineages (left) and for 5 Variants of Concern (right). Lineages were assigned using pangolin. A total of 626 lineages are present, but 125 of them (about 20%) have only a single sequence and 56 (about 9%) have only two sequences. Sequences were retrieved on April 7, 2021</p></table-wrap-foot></table-wrap></p>
      <p id="Par21">Two catalogs are generated from the preprocessed and sampled sequences. The first one only considers SNPs, while the second one also considers indels of length up to 10nt. The first catalog is created using a pipeline (called Pipeline A, from now on) that first builds the multiple sequence alignment of the sampled full-length sequences to the viral reference genome (NCBI Reference Sequence: NC_045512.2) using MAFFT [<xref ref-type="bibr" rid="CR23">23</xref>], and then extracts the set of population SNP loci from the multiple alignment using snp-sites [<xref ref-type="bibr" rid="CR24">24</xref>]. Since snp-sites is not able to output variations in positions with gaps, gaps of the alignment are filled with the corresponding portions of the reference. As a consequence, indels are not present in the resulting catalog, and this should lessen the impact of technical (or computational) artifacts that are present in the deposited sequences. For example, sequences LR897977.1-LR898047.1 have one-base deletions approximately at every 60 bases and these deletions would introduce likely false variations in the catalog.</p>
      <p id="Par22">The second catalog is created using a pipeline (called Pipeline B, from now on) that, as Pipeline A, uses MAFFT to build the multiple alignment of the sampled sequences, but then uses an in-house script to translate the alignment to a set of sequence variations stored in a VCF file.</p>
      <p id="Par23">Differently from snp-sites, our custom script is also able to extract indels, that, besides SNPs, apparently have a role in determining the characteristics of the virus. For example, the spike deletion 69-70del has been described in the context of evasion to the human immune response [<xref ref-type="bibr" rid="CR25">25</xref>]. On the other hand, the inclusion of indels might introduce some false variations due to technical artifacts in the input assemblies.</p>
      <p id="Par24"><italic>Custom catalogs.</italic> If the user wants a finer control over the variant catalog or if she/he wants to use a private set of assemblies (that cannot be freely shared), MALVIRUS interface allows to create a custom catalog from a set of assemblies or to directly upload a catalog in VCF format.</p>
      <p id="Par25">For the automatic creation of the catalog starting from a set of assemblies, MALVIRUS requires as input the reference genome of the viral species under investigation (for example, to study species different from SARS-CoV-2), the set of assemblies, and, if available, the annotation of the genes. Then, the catalog is created using Pipeline A (as previously described) without subsampling the sequences based on their assigned lineages. The rationale is that, in this case, we do not want to interfere with selection process performed by the user.</p>
      <p id="Par26">In any case, although MALVIRUS interface does not directly allow it, a user can create a catalog using Pipeline A or B (that we freely distribute) and upload the VCF file through MALVIRUS interface.</p>
    </sec>
    <sec id="Sec4">
      <title>Variant genotyping and lineage assignment</title>
      <p id="Par27">MALVIRUS allows to genotype a newly-sequenced sample and assign it to its most likely Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>]. For this task, MALVIRUS requires as input a sample of reads in FASTA/Q format and a catalog of known variations (either created from a set of assemblies, uploaded, or chosen from the set of precomputed catalogs). The output of MALVIRUS consists of a VCF file containing the genotyped and annotated variations of the considered catalog and the most likely lineage assigned to the input sample. To fulfill these tasks, MALVIRUS integrates a pipeline (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>) based on 5 state-of-the-art tools: KMC, MALVA, SnpEff, BCFtools, and pangolin.<fig id="Fig2"><label>Fig. 2</label><caption><p>Variant genotyping and lineage assignment. Schematic representation of the variant genotyping and lineage assignment module of MALVIRUS</p></caption><graphic xlink:href="12859_2022_4668_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">First of all, MALVIRUS genotypes the input variants using MALVA [<xref ref-type="bibr" rid="CR21">21</xref>], an efficient and accurate mapping-free approach for genotyping a set of known SNPs and indels, initially developed for genotyping human individuals. MALVIRUS first counts <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M26"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq13.gif"/></alternatives></inline-formula>-mers in the sample using KMC [<xref ref-type="bibr" rid="CR26">26</xref>], then genotypes with MALVA each input variant (i.e., each variant in the input catalog) exploiting <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M28"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq14.gif"/></alternatives></inline-formula>-mers frequencies and using a multinomial probability model to take into account multi-allelic variation, that are those variations with more than one alternate allele (a common situation with population VCFs). Since MALVA was initially developed for human individuals, before integrating it in MALVIRUS, we extended it to support haploid organisms, such as viruses. Moreover, MALVA was originally developed for Illumina short reads whereas most RNA viruses are sequenced using third-generation sequencing technologies (like Oxford Nanopore). Such samples exhibit a very high coverage since the viruses’ genomes are quite short. Thus, we modified MALVA to work with very-high-coverage samples.</p>
      <p id="Par29">Next, if gene annotation is available, MALVIRUS also annotates the functional effects of each genotyped variation using SnpEff [<xref ref-type="bibr" rid="CR27">27</xref>]. This tool annotates a set of variations based on their reference position and predicts their functional effects on known genes. Variant annotation is relevant since it may help in shedding more light on the evolution of the considered genome [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p id="Par30">Finally, MALVIRUS computes the most likely Pango lineage using pangolin [<xref ref-type="bibr" rid="CR15">15</xref>]. Since pangolin only accepts full-length assemblies as input, we use BCFtools (more precisely, its <italic>consensus</italic> command) to reconstruct the genome sequence of the computed genotype. Please notice that the genome built in this step should not be considered as the complete genomic sequence of the sample as it is built with respect to only the variations that are present in the chosen catalog. pangolin uses a decision tree trained using SARS-CoV-2 GISAID sequences to assign a new sequence to a lineage, i.e., a cluster of sequences associated with an epidemiological event. Such assignment is of the utmost importance to better understand the expanding phylogenetic diversity of SARS-CoV-2 and to track its global spread [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
      <p id="Par31">Finally, the results of each analysis can be visualized as a table (see Fig. <xref rid="Fig3" ref-type="fig">3</xref> for an example) or downloaded in VCF format or as a spreadsheet for further analysis.<fig id="Fig3"><label>Fig. 3</label><caption><p>Report. Example of the final report of MALVIRUS</p></caption><graphic xlink:href="12859_2022_4668_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Additional implementation details</title>
      <p id="Par32">MALVIRUS is available as a self-hosted web application distributed as a Docker container image that can be installed and run on multiple platforms, from personal laptops to large cloud infrastructures. All pipelines described in this section have been implemented as Snakemake workflows [<xref ref-type="bibr" rid="CR19">19</xref>], thus easy to use and fully reproducible. Extensive documentation and a detailed tutorial are available at <ext-link ext-link-type="uri" xlink:href="https://algolab.github.io/MALVIRUS">https://algolab.github.io/MALVIRUS</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <p id="Par33">To test the effectiveness of MALVIRUS, we performed two experimental evaluations. In the first one, we evaluated MALVIRUS accuracy in genotyping viral samples exploiting the current knowledge publicly available on the variants of SARS-CoV-2. Indeed, in this first analysis, we ran MALVIRUS using the precomputed catalogs distributed along with the application—which are also readily available to any user. The results of this first experiment should reflect the most common scenario a user may come across: genotyping and analyzing a new sample in the fastest and most straightforward way, without worrying about building an ad-hoc variation catalog.</p>
    <p id="Par34">In the second experimental evaluation, instead, we evaluated the accuracy of MALVIRUS pipeline in assigning the correct lineage to a viral sample. To better evaluate its accuracy, we created a variation catalog starting from the SARS-CoV-2 sequences available on GISAID (accessed on April 7, 2021). This experiment should reflect the more complex scenario in which a user wants to analyze a sample with respect to a given population of sequences of interest; for example a set of genomes that cannot be freely shared—such as GISAID itself—or a set of already available private samples for which a custom catalog needs to be generated.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Samples considered in the experimental evaluation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">SRA ID</th><th align="left">Technology</th><th align="left">Coverage</th><th align="left">GISAID ID</th><th align="left">Lineage</th></tr></thead><tbody><tr><td align="left">ERR5026409</td><td align="left">ILL</td><td align="left">62</td><td align="left">730750</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5040238</td><td align="left">ILL</td><td align="left">725</td><td align="left">756390</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5053597</td><td align="left">ILL</td><td align="left">366</td><td align="left">768932</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5174710</td><td align="left">ILL</td><td align="left">753</td><td align="left">858801</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5189961</td><td align="left">ILL</td><td align="left">707</td><td align="left">862989</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5074718</td><td align="left">ILL</td><td align="left">123</td><td align="left">706608</td><td align="left">AP.1</td></tr><tr><td align="left">ERR4082432</td><td align="left">ONT</td><td align="left">115</td><td align="left">425449</td><td align="left">B.1</td></tr><tr><td align="left">ERR4246852</td><td align="left">ONT</td><td align="left">285</td><td align="left">457212</td><td align="left">B.1.1</td></tr><tr><td align="left">ERR4437884</td><td align="left">ILL</td><td align="left">2200</td><td align="left">489377</td><td align="left">B.1.1.134</td></tr><tr><td align="left">ERR4584869</td><td align="left">ILL</td><td align="left">1600</td><td align="left">532794</td><td align="left">B.1.1.253</td></tr><tr><td align="left">ERR4668432</td><td align="left">ILL</td><td align="left">483</td><td align="left">575675</td><td align="left">B.1.1.255</td></tr><tr><td align="left">ERR4615778</td><td align="left">ILL</td><td align="left">847</td><td align="left">539900</td><td align="left">B.1.1.269</td></tr><tr><td align="left">ERR4439830</td><td align="left">ILL</td><td align="left">17</td><td align="left">499533</td><td align="left">B.1.1.323</td></tr><tr><td align="left">ERR4438180</td><td align="left">ILL</td><td align="left">367</td><td align="left">488906</td><td align="left">B.1.157</td></tr><tr><td align="left">ERR4848290</td><td align="left">ILL</td><td align="left">509</td><td align="left">643640</td><td align="left">B.1.160</td></tr><tr><td align="left">ERR5011401</td><td align="left">ILL</td><td align="left">838</td><td align="left">710801</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5042696</td><td align="left">ILL</td><td align="left">1000</td><td align="left">760798</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5052852</td><td align="left">ILL</td><td align="left">457</td><td align="left">769604</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5183522</td><td align="left">ILL</td><td align="left">726</td><td align="left">846539</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5184915</td><td align="left">ILL</td><td align="left">854</td><td align="left">833702</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR4759202</td><td align="left">ILL</td><td align="left">105</td><td align="left">595464</td><td align="left">B.1.177</td></tr><tr><td align="left">ERR4860691</td><td align="left">ILL</td><td align="left">401</td><td align="left">646554</td><td align="left">B.1.177.19</td></tr><tr><td align="left">ERR5049949</td><td align="left">ILL</td><td align="left">804</td><td align="left">767261</td><td align="left">B.1.177.8</td></tr><tr><td align="left">ERR5082229</td><td align="left">ONT</td><td align="left">136</td><td align="left">680109</td><td align="left">B.1.258.5</td></tr><tr><td align="left">ERR5041219</td><td align="left">ILL</td><td align="left">815</td><td align="left">762499</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5074602</td><td align="left">ONT</td><td align="left">27</td><td align="left">764231</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5093255</td><td align="left">ILL</td><td align="left">226</td><td align="left">819798</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5178844</td><td align="left">ILL</td><td align="left">141</td><td align="left">812064</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5179824</td><td align="left">ILL</td><td align="left">631</td><td align="left">821134</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR4651735</td><td align="left">ILL</td><td align="left">430</td><td align="left">567575</td><td align="left">B.1.36.17</td></tr><tr><td align="left">SRR13261896</td><td align="left">ILL</td><td align="left">10</td><td align="left">708631</td><td align="left">B.1.366</td></tr><tr><td align="left">ERR4973704</td><td align="left">ILL</td><td align="left">467</td><td align="left">655669</td><td align="left">B.1.36.9</td></tr><tr><td align="left">SRR13606385</td><td align="left">ILL</td><td align="left">55</td><td align="left">903433</td><td align="left">B.1.427</td></tr><tr><td align="left">ERR5042239</td><td align="left">ILL</td><td align="left">983</td><td align="left">760883</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5176822</td><td align="left">ILL</td><td align="left">459</td><td align="left">797195</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5181246</td><td align="left">ILL</td><td align="left">564</td><td align="left">836880</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5181360</td><td align="left">ILL</td><td align="left">633</td><td align="left">836839</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5190001</td><td align="left">ILL</td><td align="left">89</td><td align="left">863189</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR4366428</td><td align="left">ONT</td><td align="left">13</td><td align="left">493559</td><td align="left">B.23</td></tr><tr><td align="left">SRR11494747</td><td align="left">ILL</td><td align="left">186</td><td align="left">419918</td><td align="left">B.31</td></tr><tr><td align="left">SRR13530301</td><td align="left">ILL</td><td align="left">58</td><td align="left">873257</td><td align="left">P.1</td></tr></tbody></table><table-wrap-foot><p>For each sample, we report the SRA Accession ID, the technology used (ILLumina or Oxford Nanopore Techonology), the coverage in terms of number of bases (in millions), the corresponding GISAID Accession ID (for ease of presentation we removed the <italic>EPI_ISL_</italic> prefix), and the Pango lineage computed using pangolin on the corresponding assembly downloaded from GISAID</p></table-wrap-foot></table-wrap></p>
    <p id="Par35">For both experimental evaluations we randomly selected a total of 41 samples with raw reads available on the Sequence Read Archive (SRA) and that were also cross-referenced on the GISAID database (see Table <xref rid="Tab2" ref-type="table">2</xref> for the list of samples). In particular, we specifically included 5 randomly-selected samples of the lineages <italic>B.1.1.7</italic>, <italic>B.1.351</italic>, <italic>P.1</italic>, <italic>A.23.1</italic>, and <italic>B.1.525</italic> since these lineages are considered as Variants of Concern due to their peculiar epidemiological characteristics. For lineage <italic>P.1</italic> we were able to include only a single sample since we were not able to find other read samples on SRA cross-referenced on GISAID and assigned to that lineage. To balance the chosen set of samples, we included 20 samples assigned to other lineages (without stratification). Furthermore, the selected set includes samples sequenced using either Illumina or Oxford Nanopore Technologies in order to assess the accuracy of MALVIRUS on both technologies.</p>
    <p id="Par36">All the experiments can be reproduced (for the second experimental evaluation, after non-freely redistributable data are downloaded from GISAID) using the Snakemake workflows available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/MALVIRUS-repro/">https://github.com/AlgoLab/MALVIRUS-repro/</ext-link>.</p>
    <sec id="Sec7">
      <title>Genotyping accuracy</title>
      <p id="Par37">In this part we assess the accuracy of MALVIRUS in genotyping a read sample on the precomputed catalogs that are readily available to the users and that have been computed as described in the Implementation section. We recall that the precomputed catalogs are built starting from all the SARS-CoV-2 genomic sequences deposited on GenBank, that are then filtered and subsampled according to their lineage and finally aligned to the reference. From the alignment, two catalogs of variants are computed using the pipelines A (on SNPs only) and B (on both SNPs and indels) as described before. To better evaluate how the choice of the subsampling parameters <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq16.gif"/></alternatives></inline-formula> affects the accuracy, we ran the two pipelines with three different combinations of the parameters value: the default setting <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq18.gif"/></alternatives></inline-formula>, a more stringent setting <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 20$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 50$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq20.gif"/></alternatives></inline-formula>, and a more relaxed setting <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = max_{lin} = 100$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq21.gif"/></alternatives></inline-formula>. As such, a total of 6 different catalogs were generated and considered in this part.</p>
      <p id="Par38">We compared the accuracy of MALVIRUS with that of two state-of-the-art callers: BCFtools and lofreq (as indicated in most of the workflows published on Galaxy). Differently from MALVIRUS, these tools rely on the alignments of the input read sample to the reference genome to call variations. We aligned Illumina samples using BWA [<xref ref-type="bibr" rid="CR28">28</xref>] whereas we mapped ONT samples with minimap2 [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par39">Accuracy has been evaluated in terms of precision and recall and we considered as ground truth the variations induced by the alignment to the SARS-CoV-2 reference of the full-length genomic assembly associated to each sample as deposited to GISAID. The “true” genotype of each sample has been extracted from the alignment with the script that we use in the pipeline B for the construction of the precomputed catalogs. We classified each variant of the considered catalog as a <italic>reference variant</italic> if its true genotype is 0, i.e., the reference allele, and as an <italic>alternate variant</italic> if its genotype is not 0. Finally, we computed precision and recall of the tools in genotyping alternate variants: any alternate variant called alternate is considered a true positive; any alternate variant called reference is a false negative; and finally any reference variant called alternate is a false positive.</p>
      <p id="Par40">We report the results of the analysis in Table <xref rid="Tab3" ref-type="table">3</xref>. MALVIRUS scored the best in terms of <italic>precision</italic> in all settings with an average of 96% against 91% and 76% of BCFtools and lofreq respectively; in terms of <italic>recall</italic> the tools score much closer with another clear advantage of MALVIRUS (94%) over the others (92% and 84%).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Results on NCBI catalogs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pipeline</th><th align="left"><inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq22.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq23.gif"/></alternatives></inline-formula></th><th align="left" colspan="2">MALVIRUS</th><th align="left" colspan="2">bcftools</th><th align="left" colspan="2">lofreq</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">20</td><td align="left">50</td><td align="left"><bold>.951</bold></td><td align="left">.919</td><td align="left">.909</td><td align="left"><bold>.932</bold></td><td align="left">.778</td><td align="left">.856</td></tr><tr><td align="left">B</td><td align="left">20</td><td align="left">50</td><td align="left"><bold>.972</bold></td><td align="left"><bold>.955</bold></td><td align="left">.921</td><td align="left">.909</td><td align="left">.788</td><td align="left">.823</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">100</td><td align="left"><bold>.951</bold></td><td align="left">.924</td><td align="left">.907</td><td align="left"><bold>.931</bold></td><td align="left">.757</td><td align="left">.856</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">100</td><td align="left"><bold>.967</bold></td><td align="left"><bold>.959</bold></td><td align="left">.916</td><td align="left">.909</td><td align="left">.763</td><td align="left">.821</td></tr><tr><td align="left">A</td><td align="left">100</td><td align="left">100</td><td align="left"><bold>.952</bold></td><td align="left">.924</td><td align="left">.908</td><td align="left"><bold>.932</bold></td><td align="left">.738</td><td align="left">.857</td></tr><tr><td align="left">B</td><td align="left">100</td><td align="left">100</td><td align="left"><bold>.968</bold></td><td align="left"><bold>.962</bold></td><td align="left">.916</td><td align="left">.909</td><td align="left">.744</td><td align="left">.822</td></tr></tbody></table><table-wrap-foot><p>For each catalog, we report the precision and recall achieved by MALVIRUS, BCFtools, and lofreq in calling the variations available in the catalog. The results are shown in terms of average over all the 41 considered samples. We highlighted in bold the best results. We considered 6 different catalogs built using pipeline A or B on the set of assemblies retrieved from NCBI, prefiltered using <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N = 1\%$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq24.gif"/></alternatives></inline-formula> and then subsampled using different combinations of parameters <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq26.gif"/></alternatives></inline-formula></p></table-wrap-foot></table-wrap></p>
      <p id="Par41">We also analyzed the role of sequencing technology on the accuracy of predictions (Table <xref rid="Tab4" ref-type="table">4</xref>). Using the default catalog (including indels), MALVIRUS achieved average precision of 99% and recall of 96% on the considered Illumina samples; whereas it scored 79% precision and 95% recall on the ONT ones. The change in sequencing technology does not affect MALVIRUS recall while it impacts its precision: this is mainly due to the higher error-rate of the latter type of data. Indeed, the same trend is also present in BCFtools (precision drops from 94 to 73%) and lofreq (77–68%). Notice that MALVIRUS is the tool with best precision on both types of sequencing technology. However, the gain in terms of precision with respect to alignment-based approaches was expected. Indeed, especially with exhaustive and complete input knowledge, genotyping a set of known variations is more precise than discovering variants from alignments [<xref ref-type="bibr" rid="CR21">21</xref>].<table-wrap id="Tab4"><label>Table 4</label><caption><p>Results on NCBI catalogs depending on sequencing technology</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Technology</th><th align="left" colspan="2">MALVIRUS</th><th align="left" colspan="2">bcftools</th><th align="left" colspan="2">lofreq</th></tr><tr><th align="left"/><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th></tr></thead><tbody><tr><td align="left">ILL</td><td align="left"><bold>.991</bold></td><td align="left"><bold>.961</bold></td><td align="left">.942</td><td align="left">.899</td><td align="left">.775</td><td align="left">.817</td></tr><tr><td align="left">ONT</td><td align="left"><bold>.792</bold></td><td align="left">.946</td><td align="left">.731</td><td align="left"><bold>.980</bold></td><td align="left">.680</td><td align="left">.845</td></tr></tbody></table><table-wrap-foot><p>We report the precision and recall achieved by MALVIRUS, BCFtools, and lofreq in calling the variations available in the default catalog (NCBI catalog, Pipeline B, <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq28.gif"/></alternatives></inline-formula>). The results are shown in terms of average over all the considered samples aggregated by sequencing technology. We highlighted in bold the best results</p></table-wrap-foot></table-wrap></p>
      <p id="Par42">We note that lofreq is way less precise than the other tools. Indeed, analyzing its calls, we observed that lofreq calls a lot of variation with low quality: a post-filtering of its calls may improve its precision while affecting its recall (that is already lower than that of other tested approaches). Moreover, although alignment-based approaches do not rely on an input catalog of known variations, their accuracy varies with respect to the considered catalog since the set of variations of interest (i.e., the truth used to compute precision and recall) changes.</p>
      <p id="Par43">Finally, it is interesting to notice that increasing the quantity of sequences in the catalog creation has very little effect, while changing from pipeline A to B—thus including indels—produce a noticeable improvement on both precision and recall. It is important to remark that catalogs that include indels may also contain variants that are called only due to the presence of technical artifacts in the deposited assemblies, hence false variants. On the other hand, some deletions apparently have a role in determining the characteristics of the virus (for example, the spike deletion 69-70del has been described in the context of evasion to the human immune response [<xref ref-type="bibr" rid="CR25">25</xref>]) hence, for some analyses, it is important to characterize and identify them. The improvement on both precision and recall using the catalogs containing indels provides an indirect evidence that MALVA’s predictions are robust against possible technical artifacts, but we believe that the ultimate choice of the catalog is upon the user based on the intended usage of MALVIRUS’s results.</p>
      <p id="Par44">On the default catalogs (those with <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq30.gif"/></alternatives></inline-formula>), MALVIRUS, ran with a single thread, completed the analysis of each sample in 168 s on average. On the more stringent catalog (<inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 20$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 50$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq32.gif"/></alternatives></inline-formula>) it took 64 s while on the more relaxed one (<inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 100$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq34.gif"/></alternatives></inline-formula>), 410 s. This was expected since MALVIRUS execution heavily depends on the size of the input catalog: the more exhaustive and complete it is, the more computational time is required to analyze it.</p>
      <p id="Par45">In terms of memory requirements, MALVIRUS required less than 4GB of RAM in any tested settings. Such amount of resources is nowadays available on any computer, allowing MALVIRUS to run even on laptops and desktop machines. The computational requirements of catalog creation is dominated by the multiple alignment step. However, since these catalogs are precomputed and bundled with the application, this step is not executed on the user’s computer.</p>
      <p id="Par46">To complete the analysis of MALVIRUS results, we also analyzed how many samples have been assigned to the correct Pango lineage. MALVIRUS classified correctly 36–38 (over 41) of them (depending on the considered catalog, 36 for the smallest catalogs and 37–38 for the largest ones). MALVIRUS could not correctly classify all the samples since the set of assemblies currently freely available on NCBI does not contain a sufficient amount of information (i.e., enough assemblies) for correct lineage inference. In the following section, we thus further explore MALVIRUS effectiveness in inferring a lineage from a sample by considering a more complete and exhaustive (but not redistributable) database, i.e., GISAID.</p>
    </sec>
    <sec id="Sec8">
      <title>Lineage assignment accuracy</title>
      <p id="Par47">The second experiment has the goal to assess the quality of MALVIRUS in the assignment of SARS-CoV-2 lineages. In order to build a catalog as representative as possible of the different lineages, in this part we relied on not redistributable sequences from GISAID data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We constructed a total of 8 catalogs from these sequences using the two previously described pipelines (A and B)—all reproducible with our published procedures after obtaining the data from the database, since those data cannot be shared. We used this platform because it currently (as of April 7, 2021) contains around 1 million of assembled sequences—in contrast to the approximately 70 thousands in NCBI/ENA—thus including a much high number of lineages.</p>
      <p id="Par48">In more detail, we downloaded all complete sequences available on GISAID (accessed on April 7, 2021) and we filtered out all those sequences having more than 5% (<inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq35.gif"/></alternatives></inline-formula> parameter) ambiguous nucleotides. From the remaining set of assemblies, we randomly selected either 5 to 20 or exactly 50 samples from each lineage and computed VCF catalogs according to the pipelines A and B. Then we pruned variants that had less than either 2 or 5 sequences supporting them to reduce the noise and errors contained in the large GISAID dataset. The different choice of the parameters <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq37.gif"/></alternatives></inline-formula>, <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq38.gif"/></alternatives></inline-formula> and the addition of a final pruning step, compared to the procedure used to build the precomputed catalogs from publicly available data, is motivated by the significant difference in the number of sequences involved. Indeed, we increased <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq39.gif"/></alternatives></inline-formula> from 1 to 5% in order to avoid discarding upfront lineages represented by a small number of sequences. At the same time, we have been more restrictive on subsampling (i.e., we reduced the minimum and the maximum number of sequences selected for each lineage) since, if all lineages are represented in the set of sequences, then a small number of sequences per lineage should suffice to include variants that characterize the lineage into the catalog. Furthermore, please notice that the additional pruning step we introduced should not filter out variants that are common in a lineage since the minimum support we require (2 or 5) is not greater than the minimum number of sequences we select for each lineage.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Results on GISAID catalogs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pipeline</th><th align="left"><inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq40.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq41.gif"/></alternatives></inline-formula></th><th align="left">Min support</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Time (s)</th><th align="left">No. of correct lineages</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">5</td><td align="left">20</td><td align="left">2</td><td align="left">.953</td><td align="left">.947</td><td align="left">38</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">5</td><td align="left">20</td><td align="left">5</td><td align="left">.951</td><td align="left">.945</td><td align="left">19</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">5</td><td align="left">20</td><td align="left">2</td><td align="left">.992</td><td align="left">.967</td><td align="left">48</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">5</td><td align="left">20</td><td align="left">5</td><td align="left">.993</td><td align="left">.960</td><td align="left">21</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">50</td><td align="left">2</td><td align="left">.933</td><td align="left">.918</td><td align="left">897</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">50</td><td align="left">5</td><td align="left">.942</td><td align="left">.948</td><td align="left">355</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">50</td><td align="left">2</td><td align="left">.960</td><td align="left">.962</td><td align="left">2465</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">50</td><td align="left">5</td><td align="left">.972</td><td align="left">.960</td><td align="left">677</td><td align="left">40</td></tr></tbody></table><table-wrap-foot><p>For each catalog, we report the precision and recall achieved by MALVIRUS in genotyping its variations, the average running times, and the number of input samples (out of 41) assigned to the correct lineage. We considered 8 different catalogs, built using pipeline A or B on the set of assemblies retrieved from GISAID, prefiltered using <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N = 5\%$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq42.gif"/></alternatives></inline-formula> and then subsampled using different combinations of parameters <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq44.gif"/></alternatives></inline-formula>. In addition, we also filtered out from the catalogs all variations present in less than either 2 or 5 assemblies (<italic>Min support</italic> columns)</p></table-wrap-foot></table-wrap></p>
      <p id="Par49">As reported in Table <xref rid="Tab5" ref-type="table">5</xref>, MALVIRUS consistently and accurately detects 40 out of 41 samples (see Table <xref rid="Tab2" ref-type="table">2</xref>) achieving an accuracy of 97.5% on each of the 8 catalogs considered.</p>
      <p id="Par50">MALVIRUS pipeline always failed to correctly classify Illumina sample SRR13261896 (real lineage: B.1.366, USA lineage). We believe that MALVIRUS pipeline is unable to classify it correctly due to the low coverage of the Illumina sample. Indeed, as we can see from Table <xref rid="Tab2" ref-type="table">2</xref>, SRR13261896 is the sample with the lowest coverage: this low coverage may make harder the genotyping process and the subsequent lineage assignment based on genotyped variations. Moreover, MALVIRUS assign this sample to lineage B.1.612, another USA lineage: since both these lineages are quite rare and come from the same region, we believe that it may be easier to mistake one for the other one.</p>
      <p id="Par51">This analysis allowed us to better evaluate the effect of the amount of samples needed for the catalog creation and the minimum allele support. Interestingly they both have very little effect on the precision and recall of variants detection (<inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 2\%$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq45.gif"/></alternatives></inline-formula>), while increasing the number of support from 2 to 5 significantly reduces running times (66% on average) at none or negligible changes of the other scores.</p>
      <p id="Par52">Such results would suggest that increasing the number of samples used to build the catalogs will not yield measurable advantages in terms of precision and will on contrary worsen running times, due to the higher number of variations; thus we suggest using pipeline B with parameters <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} =5$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq46.gif"/></alternatives></inline-formula>, <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} =20$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq47.gif"/></alternatives></inline-formula> and with a minimum allele support of 5 when running MALVIRUS on GISAID assemblies—which we expect to be an usual case.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par53">In this work, we presented MALVIRUS, an application for analyzing newly-sequenced viral strains. Starting from a read sample and a set of known variations that can be easily produced using MALVIRUS utilities, it allows to genotype the input sample, annotate the genotyped variants, and—in the case of a SARS-CoV-2 virus sample—assign it to the most likely Pango lineages.</p>
    <p id="Par54">As shown by our results, MALVIRUS is able to efficiently and accurately genotype a newly sequenced SARS-CoV-2 virus both from short (Illumina) and long (Oxford Nanopore) reads. Moreover, it also assign the sample to the correct Pango lineage with very high accuracy (40 samples out of 41 in our experimental setting). Finally, MALVIRUS efficiency and accuracy heavily depend on the considered variant catalog. Therefore, we tested different catalogs built with multiple pipelines from different sets of assemblies: from the publicly available assemblies on NCBI/ENA to the more complete but non redistributable assemblies available on GISAID. As expected, the more assemblies are considered for building the catalog, the more information MALVIRUS can use, increasing the quality of the analysis of a new sample, albeit at the expense of its running times.</p>
    <p id="Par55">Since MALVIRUS benefits from comprehensive variant catalogs, the constantly increasing number of available strains will broaden the completeness of the current variant knowledge, thus boosting the overall accuracy of our pipeline.</p>
  </sec>
  <sec id="Sec10">
    <title>Availability and requirements</title>
    <p id="Par56">Project name: MALVIRUS</p>
    <p id="Par57">Project home page: <ext-link ext-link-type="uri" xlink:href="https://algolab.github.io/MALVIRUS">https://algolab.github.io/MALVIRUS</ext-link></p>
    <p id="Par58">Operating system(s): Platform independent (Docker container)</p>
    <p id="Par59">Programming language: C++ / Python / JavaScript</p>
    <p id="Par60">Other requirements: Docker 20 or higher</p>
    <p id="Par61">License: GNU GPL-3.0</p>
    <p id="Par62">Any restrictions to use by non-academics: none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec11">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4668_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1:</bold> The full list of samples, laboratories, and authors of the data retrieved from GISAID and used in this manuscript.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par4">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>VOC</term>
        <def>
          <p id="Par5">Variant of concern</p>
        </def>
      </def-item>
      <def-item>
        <term>VOI</term>
        <def>
          <p id="Par6">Variant of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par7">Variant call format</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par8">Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>ILL</term>
        <def>
          <p id="Par9">Illumina</p>
        </def>
      </def-item>
      <def-item>
        <term>ONT</term>
        <def>
          <p id="Par10">Oxford Nanopore Technologies</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Simone Ciccolella and Luca Denti are joint first authors</p>
    </fn>
    <fn>
      <p>Yuri Pirola and Marco Previtali are joint last authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We gratefully acknowledge the Authors and the Originating laboratories where the clinical specimen or virus isolate was first obtained and the Submitting laboratories, where sequence data have been generated and submitted to GISAID.</p>
    <sec id="d32e3357">
      <title>About this supplement</title>
      <p id="Par63">This article has been published as part of BMC Bioinformatics Volume 22 Supplement 15 2021: Proceedings from the 15th Bioinformatics and Computational Biology International Conference - BBCC2020. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-22-supplement-15">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-22-supplement-15</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>PB and GDV suggested the problem and contributed to the design of the work. SC, LD, YP, MP developed the approach and implemented the application. LD and YP designed and performed the empirical analyses. YP and MP supervised the work. All authors wrote, read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No. 872539. The funding body had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript. Publication costs are funded by University of Milano-Bicocca under the project 2019-ATE-0533.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All the programs, scripts, and workflows needed to reproduce the analyses are available in the GitHub MALVIRUS-repro repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/MALVIRUS-repro/">https://github.com/AlgoLab/MALVIRUS-repro/</ext-link>. The datasets analysed in first experimental part (Genotyping accuracy) are available from GenBank and SRA and the aforementioned repository provides detailed instraction to retrieve them. The datasets analysed in the second experimental part also include some data available from GISAID but restrictions apply to redistribution of these data, which were used under license for the current study, and are publicly available from the GISAID website subject to GISAID’s Terms and Conditions (<ext-link ext-link-type="uri" xlink:href="https://www.gisaid.org/registration/terms-of-use/">https://www.gisaid.org/registration/terms-of-use/</ext-link>). The aforementioned repository provides detailed instructions to retrieve them. The full list of samples, laboratories and authors of the data retrieved from GISAID and used in this manuscript is available as Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </notes>
  <notes>
    <title>Declaration</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par64">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par65">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par66">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Helgason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>OT</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Norddahl</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Saemundsdottir</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sigurdsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sulem</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Agustsdottir</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Eiriksdottir</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fridriksdottir</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gardarsdottir</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Georgsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gretarsdottir</surname>
            <given-names>OS</given-names>
          </name>
          <name>
            <surname>Gudmundsson</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gunnarsdottir</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Gylfason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jensson</surname>
            <given-names>BO</given-names>
          </name>
          <name>
            <surname>Jonasdottir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Josefsdottir</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Kristjansson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Magnusdottir</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>le Roux</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sigmundsdottir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sveinbjornsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sveinsdottir</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Sveinsdottir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thorarensen</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Thorbjornsson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Löve</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jonsdottir</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Möller</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Gudnason</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kristinsson</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Thorsteinsdottir</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Stefansson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Spread of SARS-CoV-2 in the Icelandic population</article-title>
        <source>N Engl J Med</source>
        <year>2020</year>
        <volume>382</volume>
        <issue>24</issue>
        <fpage>2302</fpage>
        <lpage>2315</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa2006100</pub-id>
        <?supplied-pmid 32289214?>
        <pub-id pub-id-type="pmid">32289214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Böhmer</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buchholz</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Corman</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Hoch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marosevic</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Böhm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Woudenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Konrad</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eberle</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Treis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dangel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bengs</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fingerle</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hörmansdorfer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ippisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wicklein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pörtner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zeitlmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boender</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>an der Heiden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rexroth</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hamouda</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mühlemann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wölfel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Antwerpen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Protzer</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Liebl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sing</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Drosten</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zapf</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Investigation of a COVID-19 outbreak in Germany resulting from a single</article-title>
        <source>Lancet Infect Dis</source>
        <year>2020</year>
        <volume>20</volume>
        <issue>8</issue>
        <fpage>920</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(20)30314-5</pub-id>
        <?supplied-pmid 32422201?>
        <pub-id pub-id-type="pmid">32422201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>du Plessis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title>
        <source>Nat Microbiol</source>
        <year>2020</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>1403</fpage>
        <lpage>1407</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-0770-5</pub-id>
        <?supplied-pmid 32669681?>
        <pub-id pub-id-type="pmid">32669681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monticelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hay Mele</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cubellis</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Riccio</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Why does SARS-CoV-2 hit in different ways? Host genetic factors can influence the acquisition or the course of COVID-19</article-title>
        <source>Eur J Med Genet</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1016/j.ejmg.2021.104227</pub-id>
        <?supplied-pmid 33872774?>
        <pub-id pub-id-type="pmid">33872774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Potential role of ACE2 in coronavirus disease 2019 (COVID-19) prevention and management</article-title>
        <source>J Transl Intern Med</source>
        <year>2020</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.2478/jtim-2020-0003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monticelli</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protective role of a TMPRSS2 variant on severe COVID-19 outcome in young males and elderly women</article-title>
        <source>Genes</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>596</fpage>
        <pub-id pub-id-type="doi">10.3390/genes12040596</pub-id>
        <?supplied-pmid 33921689?>
        <pub-id pub-id-type="pmid">33921689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casner</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kwong</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DD</given-names>
          </name>
        </person-group>
        <article-title>Increased resistance of SARS-CoV-2 variant P.1 to antibody neutralization</article-title>
        <source>Cell Host Microbe</source>
        <year>2021</year>
        <volume>29</volume>
        <issue>5</issue>
        <fpage>747</fpage>
        <lpage>7514</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2021.04.007</pub-id>
        <?supplied-pmid 33887205?>
        <pub-id pub-id-type="pmid">33887205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <?supplied-pmid 20644199?>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aw</surname>
            <given-names>PPK</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>GHT</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Khor</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Petric</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hibberd</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>LoFreq: a sequence-quality aware, ultra-sensitive variant caller for uncovering cell-population heterogeneity from high-throughput sequencing datasets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>22</issue>
        <fpage>11189</fpage>
        <lpage>11201</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks918</pub-id>
        <?supplied-pmid 23066108?>
        <pub-id pub-id-type="pmid">23066108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCauley</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>GISAID: global initiative on sharing all influenza data—from vision to reality</article-title>
        <source>Eurosurveillance</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id>
        <?supplied-pmid 28537546?>
        <pub-id pub-id-type="pmid">28537546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>48</volume>
        <issue>D1</issue>
        <fpage>84</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eaaswarkhanth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Al Madhoun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Al-Mulla</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Could the D614G substitution in the SARS-CoV-2 spike (S) protein be associated with higher COVID-19 mortality?</article-title>
        <source>Int J Infect Dis</source>
        <year>2020</year>
        <volume>96</volume>
        <fpage>459</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijid.2020.05.071</pub-id>
        <?supplied-pmid 32464271?>
        <pub-id pub-id-type="pmid">32464271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>SWX</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Lye</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Lack of detail in population-level data impedes analysis of SARS-CoV-2 variants of concern and clinical outcomes</article-title>
        <source>Lancet Infect Dis</source>
        <year>2021</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1195</fpage>
        <lpage>1197</lpage>
        <pub-id pub-id-type="doi">10.1016/s1473-3099(21)00201-2</pub-id>
        <?supplied-pmid 33857407?>
        <pub-id pub-id-type="pmid">33857407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Scher</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Underwood</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Colquhoun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abu-Dahab</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yeats</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Plessis</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Maloney</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Medd</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Attwood</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title>
        <source>Virus Evol</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/ve/veab064</pub-id>
        <?supplied-pmid 34527285?>
        <pub-id pub-id-type="pmid">34527285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">World Health Organization (WHO): Tracking SARS-CoV-2 variants (2021) <ext-link ext-link-type="uri" xlink:href="https://www.who.int/en/activities/tracking-SARS-CoV-2-variants/">https://www.who.int/en/activities/tracking-SARS-CoV-2-variants/</ext-link>. Accessed 5 Oct 2021</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altmann</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Boyton</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Beale</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Immunity to SARS-CoV-2 variants of concern</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>371</volume>
        <issue>6534</issue>
        <fpage>1103</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abg7404</pub-id>
        <?supplied-pmid 33707254?>
        <pub-id pub-id-type="pmid">33707254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Will SARS-CoV-2 variants of concern affect the promise of vaccines?</article-title>
        <source>Nat Rev Immunol</source>
        <year>2021</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>340</fpage>
        <lpage>341</lpage>
        <pub-id pub-id-type="doi">10.1038/s41577-021-00556-5</pub-id>
        <?supplied-pmid 33927376?>
        <pub-id pub-id-type="pmid">33927376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mölder</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Letcher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Twardziok</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holtgrewe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Sustainable data analysis with Snakemake</article-title>
        <source>F1000Research</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.12688/f1000research.29032.2</pub-id>
        <?supplied-pmid 34035898?>
        <pub-id pub-id-type="pmid">34035898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merkel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Docker: lightweight linux containers for consistent development and deployment</article-title>
        <source>Linux J</source>
        <year>2014</year>
        <volume>2014</volume>
        <issue>239</issue>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bernardini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALVA: genotyping by Mapping-free ALlele detection of known VAriants</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>20</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.07.011</pub-id>
        <?supplied-pmid 31352182?>
        <pub-id pub-id-type="pmid">31352182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">OToole Á, Hill V, et al (2021) Tracking the international spread of SARS-CoV-2 lineages B.1.1.7 and B.1.351/501Y-V2 with grinch. Wellcome Open Res. 10.12688/wellcomeopenres.16661.2</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <?supplied-pmid 23329690?>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Seemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Keane</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>SNP-sites: rapid efficient extraction of SNPs from multi-FASTA alignments</article-title>
        <source>Microb Genom</source>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000056</pub-id>
        <?supplied-pmid 28348874?>
        <pub-id pub-id-type="pmid">28348874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Andrew Rambaut et al (2020) Preliminary genomic characterisation of an emergent SARS-CoV-2 lineage in the UK defined by a novel set of spike mutations. <ext-link ext-link-type="uri" xlink:href="https://virological.org/t/preliminary-genomic-characterisation-of-an-emergent-sars-cov-2-lineage-in-the-uk-defined-by-a-novel-set-of-spike-mutations/563/1">https://virological.org/t/preliminary-genomic-characterisation-of-an-emergent-sars-cov-2-lineage-in-the-uk-defined-by-a-novel-set-of-spike-mutations/563/1</ext-link>. Accessed 19 Dec 2020.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Długosz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KMC 3: counting and manipulating k-mer statistics</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>17</issue>
        <fpage>2759</fpage>
        <lpage>2761</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx304</pub-id>
        <?supplied-pmid 28472236?>
        <pub-id pub-id-type="pmid">28472236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cingolani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Platts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ruden</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A program for annotating and predicting the effects of single nucleotide polymorphisms. SnpEff</article-title>
        <source>Fly</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>80</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.4161/fly.19695</pub-id>
        <?supplied-pmid 22728672?>
        <pub-id pub-id-type="pmid">22728672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Li H (2013) Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. 10.48550/arXiv.1303.3997</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9017741</article-id>
    <article-id pub-id-type="pmid">35439933</article-id>
    <article-id pub-id-type="publisher-id">4668</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04668-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MALVIRUS: an integrated application for viral variant analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ciccolella</surname>
          <given-names>Simone</given-names>
        </name>
        <address>
          <email>simone.ciccolella@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Denti</surname>
          <given-names>Luca</given-names>
        </name>
        <address>
          <email>luca.denti@pasteur.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonizzoni</surname>
          <given-names>Paola</given-names>
        </name>
        <address>
          <email>paola.bonizzoni@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Della Vedova</surname>
          <given-names>Gianluca</given-names>
        </name>
        <address>
          <email>gianluca.dellavedova@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8479-7592</contrib-id>
        <name>
          <surname>Pirola</surname>
          <given-names>Yuri</given-names>
        </name>
        <address>
          <email>yuri.pirola@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Previtali</surname>
          <given-names>Marco</given-names>
        </name>
        <address>
          <email>marco.previtali@unimib.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7563.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2174 1754</institution-id><institution>Department of Informatics, Systems and Communication, </institution><institution>University of Milano-Bicocca, </institution></institution-wrap>Viale Sarca 336, 20136 Milan, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0495fxg12</institution-id><institution-id institution-id-type="GRID">grid.428999.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2353 6535</institution-id><institution>Department of Computational Biology, </institution><institution>Institut Pasteur, </institution></institution-wrap>25-28 Rue du Dr Roux, 75015 Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <issue>Suppl 15</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>625</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Being able to efficiently call variants from the increasing amount of sequencing data daily produced from multiple viral strains is of the utmost importance, as demonstrated during the COVID-19 pandemic, in order to track the spread of the viral strains across the globe.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present MALVIRUS, an easy-to-install and easy-to-use application that assists users in multiple tasks required for the analysis of a viral population, such as the SARS-CoV-2. MALVIRUS allows to: (1) construct a variant catalog consisting in a set of variations (SNPs/indels) from the population sequences, (2) efficiently genotype and annotate variants of the catalog supported by a read sample, and (3) when the considered viral species is the SARS-CoV-2, assign the input sample to the most likely Pango lineages using the genotyped variations.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Tests on Illumina and Nanopore samples proved the efficiency and the effectiveness of MALVIRUS in analyzing SARS-CoV-2 strain samples with respect to publicly available data provided by NCBI and the more complete dataset provided by GISAID. A comparison with state-of-the-art tools showed that MALVIRUS is always more precise and often have a better recall.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04668-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sequence analysis</kwd>
      <kwd>Genotyping</kwd>
      <kwd>Lineage classification</kwd>
      <kwd>Virus</kwd>
      <kwd>SARS-CoV-2</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002954</institution-id>
            <institution>Università degli Studi di Milano-Bicocca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019-ATE-0533</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010665</institution-id>
            <institution>H2020 Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>872539</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par11">The SARS-CoV-2 pandemic has put the global health care services to the test and many researchers are racing to face its swift and rapid spread. Since the outbreak of the virus in China and in other European countries, several studies are using sequencing technologies to track the geographical origin of SARS-Cov-2 and to analyze the evolution of sequence variants [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>] or to understand the role played by human genes on viral replication [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. In this context, the availability of efficient approaches to analyze variations from the growing amount of sequencing data daily produced is of the utmost importance.</p>
    <p id="Par12">The typical pipelines for the analysis of variations in viral samples consists of aligning reads against a reference genome [<xref ref-type="bibr" rid="CR8">8</xref>], then analyzing the alignments to discover the variants [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. However, the increasing number of viral assemblies available in public databases such as GISAID [<xref ref-type="bibr" rid="CR11">11</xref>], GenBank [<xref ref-type="bibr" rid="CR12">12</xref>], and the COVID-19 Data Portal allows to build a complete catalog of variants of a viral population. Such a catalog can be used to reduce the complexity of comparative analysis of genetic variants of sequencing samples. For this goal, it is crucial that users are assisted by an efficient and easy-to-use method for building and updating the catalog and for calling and annotating variants that are in this catalog. In this paper, we introduce MALVIRUS, a web application to quickly analyze newly sequenced viral read samples, including—but not only limited to—SARS-CoV-2 samples. Particularly for this novel virus, more and more interest is given to the different Pango lineages of the virus [<xref ref-type="bibr" rid="CR3">3</xref>] (from now on we implicitly assume that lineages are referred to the Pango nomenclature) since different viral lineages exhibit different levels of infection rate and virulence [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. For this reason, MALVIRUS allows for determining the lineage from which a read sample originates—the so called lineage assignment problem—using the well-known tool pangolin [<xref ref-type="bibr" rid="CR15">15</xref>] directly from the read sample without assembling the full-length genome. This step is especially relevant since some lineages are classified by major health organizations as Variants Of Concern (VOC) or Variants of Interest (VOI) [<xref ref-type="bibr" rid="CR16">16</xref>] due to their peculiar characteristics (for example, because they may exhibit resistance to vaccines [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]) that suggest an emerging risk to global public health and, hence, their spread should be attentively monitored and tracked.</p>
    <p id="Par13">We evaluated MALVIRUS accuracy in genotyping, annotating, and classifying newly sequenced SARS-CoV-2 strains on both short and long read data. Since MALVIRUS heavily depends on the current knowledge available (i.e., the set of variations characterizing the population under investigation), we also propose and test different methodologies for building the variant catalog. The proposed pipelines are freely available and can be used with any set of assemblies. In our experimental evaluation, we considered catalogs built on the set of SARS-CoV-2 assemblies freely available on NCBI as well as on the ones available from GISAID. However, we believe that thanks to our pipelines, implemented as Snakemake workflows [<xref ref-type="bibr" rid="CR19">19</xref>], any user can easily build a variant catalog starting from his own private set of assemblies.</p>
    <p id="Par14">MALVIRUS is distributed as a multi-platform Docker container [<xref ref-type="bibr" rid="CR20">20</xref>] and it can be easily accessed using any modern Internet browser.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">MALVIRUS is a user-friendly application for efficiently genotyping a viral sample. MALVIRUS is based on MALVA [<xref ref-type="bibr" rid="CR21">21</xref>] and builds around it a complete and user-friendly infrastructure of scripts and pipelines to facilitate the genotyping of viral samples. MALVA is an efficient tool for genotyping a sample with respect to a catalog of variants without mapping the reads to the reference genome. To assist the user, MALVIRUS provides both a set of precomputed variant catalogs periodically generated from the publicly available SARS-CoV-2 genome assemblies and the ability to compute a variant catalog from a set of user-provided genome assemblies (not necessarily SARS-CoV-2). Furthermore, MALVIRUS assists the user in performing the genotyping task and in visualising the result. For SARS-CoV-2 samples, MALVIRUS also performs the functional annotation of the reconstructed genotype and the Pango lineage assignment of the sample. A Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>] is a cluster of SARS-CoV-2 sequences associated with an epidemiological event.</p>
    <p id="Par16">The rest of this section describes the methods related to catalog creation and presents the pipeline for genotyping the read sample.</p>
    <sec id="Sec3">
      <title>Precomputed catalogs</title>
      <p id="Par17">As already stated, MALVIRUS genotypes a set of variations contained in a catalog, representing the current state of the art on all known variants observed in the population of interest. For user convenience, MALVIRUS is distributed with a set of precomputed catalogs for the SARS-CoV-2 viral genome, thus users can immediately run MALVIRUS on a locally available (e.g., private) viral sample. Moreover, the precomputed catalogs can be easily updated from the application itself with a single click.</p>
      <p id="Par18">The primary aim of the precomputed catalogs is to ensure that the variations they contain represent as completely as possible the set of sequence variations that are present in SARS-CoV-2 genomes sequenced to date, all while maintaining high quality (in order to avoid including variations deriving from technical artifacts) and small size (in order to keep the tool efficient). To achieve this twofold aim, we specifically designed a pipeline that extracts variants from the set of all the assemblies available on GenBank [<xref ref-type="bibr" rid="CR12">12</xref>]. Figure <xref rid="Fig1" ref-type="fig">1</xref> depicts the main steps of the pipeline.<fig id="Fig1"><label>Fig. 1</label><caption><p>Precomputed catalog creation. Schematic representation of the pipelines used to create the precomputed SARS-CoV-2 catalogs from the set of public assemblies available on GenBank</p></caption><graphic xlink:href="12859_2022_4668_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par19">The set of assemblies is initially preprocessed by filtering out sequences with more than <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _{N} = 1\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq1.gif"/></alternatives></inline-formula> ambiguous nucleotides, then the resulting set is subsampled based on their Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>]. Subsampling is performed by assigning the lineage to each assembly using pangolin [<xref ref-type="bibr" rid="CR15">15</xref>], then by keeping 1% of the sequences assigned to each lineage with a minimum of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq2.gif"/></alternatives></inline-formula> and a maximum of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq3.gif"/></alternatives></inline-formula> sequences for each lineage. If a lineage has less than <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq4.gif"/></alternatives></inline-formula> sequences, then all its sequences are kept. Parameters <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq6.gif"/></alternatives></inline-formula> are chosen in order to provide the best trade-off between completeness of the catalogs and computational efficiency of the tool. Currently they are set to 50 and 100, respectively, but their values are subject to change in future updates depending on the number (and the quality) of genome assemblies deposited to GenBank.</p>
      <p id="Par20">Due to the importance of lineages classified as Variants Of Concern/Interest (VOC/VOI) for epidemiology [<xref ref-type="bibr" rid="CR16">16</xref>] and to ensure that they are sufficiently represented in the precomputed catalogs, the parameters <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq8.gif"/></alternatives></inline-formula> for those lineages are increased to <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times min_{lin}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times max_{lin}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq10.gif"/></alternatives></inline-formula>, respectively. Currently, we increased the two parameters for lineages <italic>B.1.1.7</italic>, <italic>B.1.351</italic>, <italic>P.1</italic>, <italic>A.23.1</italic>, and <italic>B.1.525</italic>, that are the subjects of the cov-lineages.org global reports [<xref ref-type="bibr" rid="CR22">22</xref>]. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the frequency distribution of lineages in GenBank as of April 7, 2021 and provides the indication of the most represented lineages (left) and of VOC/VOIs (right) in our precomputed catalogs. As an example of how sequences were sampled, on April 7, 2021, there were 9390 sequences assigned to lineage <italic>B.1</italic> (over a total of 78,098 sequences that passed max ambiguous nucleotides filtering), hence only 93 of them were randomly selected to create the catalog. As another example, there were 16,844 sequences assigned to lineage <italic>B.1.2</italic> and, since the 1% of 16,844 is greater than <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq11.gif"/></alternatives></inline-formula>, only 100 of them were selected to create the catalog. On the other hand, there were 1835 sequences assigned to lineage <italic>A.1</italic> and, since the 1% of 1835 is less than <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq12.gif"/></alternatives></inline-formula>, 50 of them were selected to create the catalog.<table-wrap id="Tab1"><label>Table 1</label><caption><p>GenBank assemblies information</p></caption><graphic position="anchor" xlink:href="12859_2022_4668_Figa_HTML" id="MO4"/><table-wrap-foot><p>Number of assemblies deposited on GenBank for the most represented lineages (left) and for 5 Variants of Concern (right). Lineages were assigned using pangolin. A total of 626 lineages are present, but 125 of them (about 20%) have only a single sequence and 56 (about 9%) have only two sequences. Sequences were retrieved on April 7, 2021</p></table-wrap-foot></table-wrap></p>
      <p id="Par21">Two catalogs are generated from the preprocessed and sampled sequences. The first one only considers SNPs, while the second one also considers indels of length up to 10nt. The first catalog is created using a pipeline (called Pipeline A, from now on) that first builds the multiple sequence alignment of the sampled full-length sequences to the viral reference genome (NCBI Reference Sequence: NC_045512.2) using MAFFT [<xref ref-type="bibr" rid="CR23">23</xref>], and then extracts the set of population SNP loci from the multiple alignment using snp-sites [<xref ref-type="bibr" rid="CR24">24</xref>]. Since snp-sites is not able to output variations in positions with gaps, gaps of the alignment are filled with the corresponding portions of the reference. As a consequence, indels are not present in the resulting catalog, and this should lessen the impact of technical (or computational) artifacts that are present in the deposited sequences. For example, sequences LR897977.1-LR898047.1 have one-base deletions approximately at every 60 bases and these deletions would introduce likely false variations in the catalog.</p>
      <p id="Par22">The second catalog is created using a pipeline (called Pipeline B, from now on) that, as Pipeline A, uses MAFFT to build the multiple alignment of the sampled sequences, but then uses an in-house script to translate the alignment to a set of sequence variations stored in a VCF file.</p>
      <p id="Par23">Differently from snp-sites, our custom script is also able to extract indels, that, besides SNPs, apparently have a role in determining the characteristics of the virus. For example, the spike deletion 69-70del has been described in the context of evasion to the human immune response [<xref ref-type="bibr" rid="CR25">25</xref>]. On the other hand, the inclusion of indels might introduce some false variations due to technical artifacts in the input assemblies.</p>
      <p id="Par24"><italic>Custom catalogs.</italic> If the user wants a finer control over the variant catalog or if she/he wants to use a private set of assemblies (that cannot be freely shared), MALVIRUS interface allows to create a custom catalog from a set of assemblies or to directly upload a catalog in VCF format.</p>
      <p id="Par25">For the automatic creation of the catalog starting from a set of assemblies, MALVIRUS requires as input the reference genome of the viral species under investigation (for example, to study species different from SARS-CoV-2), the set of assemblies, and, if available, the annotation of the genes. Then, the catalog is created using Pipeline A (as previously described) without subsampling the sequences based on their assigned lineages. The rationale is that, in this case, we do not want to interfere with selection process performed by the user.</p>
      <p id="Par26">In any case, although MALVIRUS interface does not directly allow it, a user can create a catalog using Pipeline A or B (that we freely distribute) and upload the VCF file through MALVIRUS interface.</p>
    </sec>
    <sec id="Sec4">
      <title>Variant genotyping and lineage assignment</title>
      <p id="Par27">MALVIRUS allows to genotype a newly-sequenced sample and assign it to its most likely Pango lineage [<xref ref-type="bibr" rid="CR3">3</xref>]. For this task, MALVIRUS requires as input a sample of reads in FASTA/Q format and a catalog of known variations (either created from a set of assemblies, uploaded, or chosen from the set of precomputed catalogs). The output of MALVIRUS consists of a VCF file containing the genotyped and annotated variations of the considered catalog and the most likely lineage assigned to the input sample. To fulfill these tasks, MALVIRUS integrates a pipeline (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>) based on 5 state-of-the-art tools: KMC, MALVA, SnpEff, BCFtools, and pangolin.<fig id="Fig2"><label>Fig. 2</label><caption><p>Variant genotyping and lineage assignment. Schematic representation of the variant genotyping and lineage assignment module of MALVIRUS</p></caption><graphic xlink:href="12859_2022_4668_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">First of all, MALVIRUS genotypes the input variants using MALVA [<xref ref-type="bibr" rid="CR21">21</xref>], an efficient and accurate mapping-free approach for genotyping a set of known SNPs and indels, initially developed for genotyping human individuals. MALVIRUS first counts <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M26"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq13.gif"/></alternatives></inline-formula>-mers in the sample using KMC [<xref ref-type="bibr" rid="CR26">26</xref>], then genotypes with MALVA each input variant (i.e., each variant in the input catalog) exploiting <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M28"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq14.gif"/></alternatives></inline-formula>-mers frequencies and using a multinomial probability model to take into account multi-allelic variation, that are those variations with more than one alternate allele (a common situation with population VCFs). Since MALVA was initially developed for human individuals, before integrating it in MALVIRUS, we extended it to support haploid organisms, such as viruses. Moreover, MALVA was originally developed for Illumina short reads whereas most RNA viruses are sequenced using third-generation sequencing technologies (like Oxford Nanopore). Such samples exhibit a very high coverage since the viruses’ genomes are quite short. Thus, we modified MALVA to work with very-high-coverage samples.</p>
      <p id="Par29">Next, if gene annotation is available, MALVIRUS also annotates the functional effects of each genotyped variation using SnpEff [<xref ref-type="bibr" rid="CR27">27</xref>]. This tool annotates a set of variations based on their reference position and predicts their functional effects on known genes. Variant annotation is relevant since it may help in shedding more light on the evolution of the considered genome [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p id="Par30">Finally, MALVIRUS computes the most likely Pango lineage using pangolin [<xref ref-type="bibr" rid="CR15">15</xref>]. Since pangolin only accepts full-length assemblies as input, we use BCFtools (more precisely, its <italic>consensus</italic> command) to reconstruct the genome sequence of the computed genotype. Please notice that the genome built in this step should not be considered as the complete genomic sequence of the sample as it is built with respect to only the variations that are present in the chosen catalog. pangolin uses a decision tree trained using SARS-CoV-2 GISAID sequences to assign a new sequence to a lineage, i.e., a cluster of sequences associated with an epidemiological event. Such assignment is of the utmost importance to better understand the expanding phylogenetic diversity of SARS-CoV-2 and to track its global spread [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
      <p id="Par31">Finally, the results of each analysis can be visualized as a table (see Fig. <xref rid="Fig3" ref-type="fig">3</xref> for an example) or downloaded in VCF format or as a spreadsheet for further analysis.<fig id="Fig3"><label>Fig. 3</label><caption><p>Report. Example of the final report of MALVIRUS</p></caption><graphic xlink:href="12859_2022_4668_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Additional implementation details</title>
      <p id="Par32">MALVIRUS is available as a self-hosted web application distributed as a Docker container image that can be installed and run on multiple platforms, from personal laptops to large cloud infrastructures. All pipelines described in this section have been implemented as Snakemake workflows [<xref ref-type="bibr" rid="CR19">19</xref>], thus easy to use and fully reproducible. Extensive documentation and a detailed tutorial are available at <ext-link ext-link-type="uri" xlink:href="https://algolab.github.io/MALVIRUS">https://algolab.github.io/MALVIRUS</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <p id="Par33">To test the effectiveness of MALVIRUS, we performed two experimental evaluations. In the first one, we evaluated MALVIRUS accuracy in genotyping viral samples exploiting the current knowledge publicly available on the variants of SARS-CoV-2. Indeed, in this first analysis, we ran MALVIRUS using the precomputed catalogs distributed along with the application—which are also readily available to any user. The results of this first experiment should reflect the most common scenario a user may come across: genotyping and analyzing a new sample in the fastest and most straightforward way, without worrying about building an ad-hoc variation catalog.</p>
    <p id="Par34">In the second experimental evaluation, instead, we evaluated the accuracy of MALVIRUS pipeline in assigning the correct lineage to a viral sample. To better evaluate its accuracy, we created a variation catalog starting from the SARS-CoV-2 sequences available on GISAID (accessed on April 7, 2021). This experiment should reflect the more complex scenario in which a user wants to analyze a sample with respect to a given population of sequences of interest; for example a set of genomes that cannot be freely shared—such as GISAID itself—or a set of already available private samples for which a custom catalog needs to be generated.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Samples considered in the experimental evaluation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">SRA ID</th><th align="left">Technology</th><th align="left">Coverage</th><th align="left">GISAID ID</th><th align="left">Lineage</th></tr></thead><tbody><tr><td align="left">ERR5026409</td><td align="left">ILL</td><td align="left">62</td><td align="left">730750</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5040238</td><td align="left">ILL</td><td align="left">725</td><td align="left">756390</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5053597</td><td align="left">ILL</td><td align="left">366</td><td align="left">768932</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5174710</td><td align="left">ILL</td><td align="left">753</td><td align="left">858801</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5189961</td><td align="left">ILL</td><td align="left">707</td><td align="left">862989</td><td align="left">A.23.1</td></tr><tr><td align="left">ERR5074718</td><td align="left">ILL</td><td align="left">123</td><td align="left">706608</td><td align="left">AP.1</td></tr><tr><td align="left">ERR4082432</td><td align="left">ONT</td><td align="left">115</td><td align="left">425449</td><td align="left">B.1</td></tr><tr><td align="left">ERR4246852</td><td align="left">ONT</td><td align="left">285</td><td align="left">457212</td><td align="left">B.1.1</td></tr><tr><td align="left">ERR4437884</td><td align="left">ILL</td><td align="left">2200</td><td align="left">489377</td><td align="left">B.1.1.134</td></tr><tr><td align="left">ERR4584869</td><td align="left">ILL</td><td align="left">1600</td><td align="left">532794</td><td align="left">B.1.1.253</td></tr><tr><td align="left">ERR4668432</td><td align="left">ILL</td><td align="left">483</td><td align="left">575675</td><td align="left">B.1.1.255</td></tr><tr><td align="left">ERR4615778</td><td align="left">ILL</td><td align="left">847</td><td align="left">539900</td><td align="left">B.1.1.269</td></tr><tr><td align="left">ERR4439830</td><td align="left">ILL</td><td align="left">17</td><td align="left">499533</td><td align="left">B.1.1.323</td></tr><tr><td align="left">ERR4438180</td><td align="left">ILL</td><td align="left">367</td><td align="left">488906</td><td align="left">B.1.157</td></tr><tr><td align="left">ERR4848290</td><td align="left">ILL</td><td align="left">509</td><td align="left">643640</td><td align="left">B.1.160</td></tr><tr><td align="left">ERR5011401</td><td align="left">ILL</td><td align="left">838</td><td align="left">710801</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5042696</td><td align="left">ILL</td><td align="left">1000</td><td align="left">760798</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5052852</td><td align="left">ILL</td><td align="left">457</td><td align="left">769604</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5183522</td><td align="left">ILL</td><td align="left">726</td><td align="left">846539</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR5184915</td><td align="left">ILL</td><td align="left">854</td><td align="left">833702</td><td align="left">B.1.1.7</td></tr><tr><td align="left">ERR4759202</td><td align="left">ILL</td><td align="left">105</td><td align="left">595464</td><td align="left">B.1.177</td></tr><tr><td align="left">ERR4860691</td><td align="left">ILL</td><td align="left">401</td><td align="left">646554</td><td align="left">B.1.177.19</td></tr><tr><td align="left">ERR5049949</td><td align="left">ILL</td><td align="left">804</td><td align="left">767261</td><td align="left">B.1.177.8</td></tr><tr><td align="left">ERR5082229</td><td align="left">ONT</td><td align="left">136</td><td align="left">680109</td><td align="left">B.1.258.5</td></tr><tr><td align="left">ERR5041219</td><td align="left">ILL</td><td align="left">815</td><td align="left">762499</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5074602</td><td align="left">ONT</td><td align="left">27</td><td align="left">764231</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5093255</td><td align="left">ILL</td><td align="left">226</td><td align="left">819798</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5178844</td><td align="left">ILL</td><td align="left">141</td><td align="left">812064</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR5179824</td><td align="left">ILL</td><td align="left">631</td><td align="left">821134</td><td align="left">B.1.351</td></tr><tr><td align="left">ERR4651735</td><td align="left">ILL</td><td align="left">430</td><td align="left">567575</td><td align="left">B.1.36.17</td></tr><tr><td align="left">SRR13261896</td><td align="left">ILL</td><td align="left">10</td><td align="left">708631</td><td align="left">B.1.366</td></tr><tr><td align="left">ERR4973704</td><td align="left">ILL</td><td align="left">467</td><td align="left">655669</td><td align="left">B.1.36.9</td></tr><tr><td align="left">SRR13606385</td><td align="left">ILL</td><td align="left">55</td><td align="left">903433</td><td align="left">B.1.427</td></tr><tr><td align="left">ERR5042239</td><td align="left">ILL</td><td align="left">983</td><td align="left">760883</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5176822</td><td align="left">ILL</td><td align="left">459</td><td align="left">797195</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5181246</td><td align="left">ILL</td><td align="left">564</td><td align="left">836880</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5181360</td><td align="left">ILL</td><td align="left">633</td><td align="left">836839</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR5190001</td><td align="left">ILL</td><td align="left">89</td><td align="left">863189</td><td align="left">B.1.525</td></tr><tr><td align="left">ERR4366428</td><td align="left">ONT</td><td align="left">13</td><td align="left">493559</td><td align="left">B.23</td></tr><tr><td align="left">SRR11494747</td><td align="left">ILL</td><td align="left">186</td><td align="left">419918</td><td align="left">B.31</td></tr><tr><td align="left">SRR13530301</td><td align="left">ILL</td><td align="left">58</td><td align="left">873257</td><td align="left">P.1</td></tr></tbody></table><table-wrap-foot><p>For each sample, we report the SRA Accession ID, the technology used (ILLumina or Oxford Nanopore Techonology), the coverage in terms of number of bases (in millions), the corresponding GISAID Accession ID (for ease of presentation we removed the <italic>EPI_ISL_</italic> prefix), and the Pango lineage computed using pangolin on the corresponding assembly downloaded from GISAID</p></table-wrap-foot></table-wrap></p>
    <p id="Par35">For both experimental evaluations we randomly selected a total of 41 samples with raw reads available on the Sequence Read Archive (SRA) and that were also cross-referenced on the GISAID database (see Table <xref rid="Tab2" ref-type="table">2</xref> for the list of samples). In particular, we specifically included 5 randomly-selected samples of the lineages <italic>B.1.1.7</italic>, <italic>B.1.351</italic>, <italic>P.1</italic>, <italic>A.23.1</italic>, and <italic>B.1.525</italic> since these lineages are considered as Variants of Concern due to their peculiar epidemiological characteristics. For lineage <italic>P.1</italic> we were able to include only a single sample since we were not able to find other read samples on SRA cross-referenced on GISAID and assigned to that lineage. To balance the chosen set of samples, we included 20 samples assigned to other lineages (without stratification). Furthermore, the selected set includes samples sequenced using either Illumina or Oxford Nanopore Technologies in order to assess the accuracy of MALVIRUS on both technologies.</p>
    <p id="Par36">All the experiments can be reproduced (for the second experimental evaluation, after non-freely redistributable data are downloaded from GISAID) using the Snakemake workflows available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/MALVIRUS-repro/">https://github.com/AlgoLab/MALVIRUS-repro/</ext-link>.</p>
    <sec id="Sec7">
      <title>Genotyping accuracy</title>
      <p id="Par37">In this part we assess the accuracy of MALVIRUS in genotyping a read sample on the precomputed catalogs that are readily available to the users and that have been computed as described in the Implementation section. We recall that the precomputed catalogs are built starting from all the SARS-CoV-2 genomic sequences deposited on GenBank, that are then filtered and subsampled according to their lineage and finally aligned to the reference. From the alignment, two catalogs of variants are computed using the pipelines A (on SNPs only) and B (on both SNPs and indels) as described before. To better evaluate how the choice of the subsampling parameters <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq16.gif"/></alternatives></inline-formula> affects the accuracy, we ran the two pipelines with three different combinations of the parameters value: the default setting <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq18.gif"/></alternatives></inline-formula>, a more stringent setting <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 20$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 50$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq20.gif"/></alternatives></inline-formula>, and a more relaxed setting <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = max_{lin} = 100$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq21.gif"/></alternatives></inline-formula>. As such, a total of 6 different catalogs were generated and considered in this part.</p>
      <p id="Par38">We compared the accuracy of MALVIRUS with that of two state-of-the-art callers: BCFtools and lofreq (as indicated in most of the workflows published on Galaxy). Differently from MALVIRUS, these tools rely on the alignments of the input read sample to the reference genome to call variations. We aligned Illumina samples using BWA [<xref ref-type="bibr" rid="CR28">28</xref>] whereas we mapped ONT samples with minimap2 [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par39">Accuracy has been evaluated in terms of precision and recall and we considered as ground truth the variations induced by the alignment to the SARS-CoV-2 reference of the full-length genomic assembly associated to each sample as deposited to GISAID. The “true” genotype of each sample has been extracted from the alignment with the script that we use in the pipeline B for the construction of the precomputed catalogs. We classified each variant of the considered catalog as a <italic>reference variant</italic> if its true genotype is 0, i.e., the reference allele, and as an <italic>alternate variant</italic> if its genotype is not 0. Finally, we computed precision and recall of the tools in genotyping alternate variants: any alternate variant called alternate is considered a true positive; any alternate variant called reference is a false negative; and finally any reference variant called alternate is a false positive.</p>
      <p id="Par40">We report the results of the analysis in Table <xref rid="Tab3" ref-type="table">3</xref>. MALVIRUS scored the best in terms of <italic>precision</italic> in all settings with an average of 96% against 91% and 76% of BCFtools and lofreq respectively; in terms of <italic>recall</italic> the tools score much closer with another clear advantage of MALVIRUS (94%) over the others (92% and 84%).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Results on NCBI catalogs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pipeline</th><th align="left"><inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq22.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq23.gif"/></alternatives></inline-formula></th><th align="left" colspan="2">MALVIRUS</th><th align="left" colspan="2">bcftools</th><th align="left" colspan="2">lofreq</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">20</td><td align="left">50</td><td align="left"><bold>.951</bold></td><td align="left">.919</td><td align="left">.909</td><td align="left"><bold>.932</bold></td><td align="left">.778</td><td align="left">.856</td></tr><tr><td align="left">B</td><td align="left">20</td><td align="left">50</td><td align="left"><bold>.972</bold></td><td align="left"><bold>.955</bold></td><td align="left">.921</td><td align="left">.909</td><td align="left">.788</td><td align="left">.823</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">100</td><td align="left"><bold>.951</bold></td><td align="left">.924</td><td align="left">.907</td><td align="left"><bold>.931</bold></td><td align="left">.757</td><td align="left">.856</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">100</td><td align="left"><bold>.967</bold></td><td align="left"><bold>.959</bold></td><td align="left">.916</td><td align="left">.909</td><td align="left">.763</td><td align="left">.821</td></tr><tr><td align="left">A</td><td align="left">100</td><td align="left">100</td><td align="left"><bold>.952</bold></td><td align="left">.924</td><td align="left">.908</td><td align="left"><bold>.932</bold></td><td align="left">.738</td><td align="left">.857</td></tr><tr><td align="left">B</td><td align="left">100</td><td align="left">100</td><td align="left"><bold>.968</bold></td><td align="left"><bold>.962</bold></td><td align="left">.916</td><td align="left">.909</td><td align="left">.744</td><td align="left">.822</td></tr></tbody></table><table-wrap-foot><p>For each catalog, we report the precision and recall achieved by MALVIRUS, BCFtools, and lofreq in calling the variations available in the catalog. The results are shown in terms of average over all the 41 considered samples. We highlighted in bold the best results. We considered 6 different catalogs built using pipeline A or B on the set of assemblies retrieved from NCBI, prefiltered using <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N = 1\%$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq24.gif"/></alternatives></inline-formula> and then subsampled using different combinations of parameters <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq26.gif"/></alternatives></inline-formula></p></table-wrap-foot></table-wrap></p>
      <p id="Par41">We also analyzed the role of sequencing technology on the accuracy of predictions (Table <xref rid="Tab4" ref-type="table">4</xref>). Using the default catalog (including indels), MALVIRUS achieved average precision of 99% and recall of 96% on the considered Illumina samples; whereas it scored 79% precision and 95% recall on the ONT ones. The change in sequencing technology does not affect MALVIRUS recall while it impacts its precision: this is mainly due to the higher error-rate of the latter type of data. Indeed, the same trend is also present in BCFtools (precision drops from 94 to 73%) and lofreq (77–68%). Notice that MALVIRUS is the tool with best precision on both types of sequencing technology. However, the gain in terms of precision with respect to alignment-based approaches was expected. Indeed, especially with exhaustive and complete input knowledge, genotyping a set of known variations is more precise than discovering variants from alignments [<xref ref-type="bibr" rid="CR21">21</xref>].<table-wrap id="Tab4"><label>Table 4</label><caption><p>Results on NCBI catalogs depending on sequencing technology</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Technology</th><th align="left" colspan="2">MALVIRUS</th><th align="left" colspan="2">bcftools</th><th align="left" colspan="2">lofreq</th></tr><tr><th align="left"/><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">Recall</th></tr></thead><tbody><tr><td align="left">ILL</td><td align="left"><bold>.991</bold></td><td align="left"><bold>.961</bold></td><td align="left">.942</td><td align="left">.899</td><td align="left">.775</td><td align="left">.817</td></tr><tr><td align="left">ONT</td><td align="left"><bold>.792</bold></td><td align="left">.946</td><td align="left">.731</td><td align="left"><bold>.980</bold></td><td align="left">.680</td><td align="left">.845</td></tr></tbody></table><table-wrap-foot><p>We report the precision and recall achieved by MALVIRUS, BCFtools, and lofreq in calling the variations available in the default catalog (NCBI catalog, Pipeline B, <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq28.gif"/></alternatives></inline-formula>). The results are shown in terms of average over all the considered samples aggregated by sequencing technology. We highlighted in bold the best results</p></table-wrap-foot></table-wrap></p>
      <p id="Par42">We note that lofreq is way less precise than the other tools. Indeed, analyzing its calls, we observed that lofreq calls a lot of variation with low quality: a post-filtering of its calls may improve its precision while affecting its recall (that is already lower than that of other tested approaches). Moreover, although alignment-based approaches do not rely on an input catalog of known variations, their accuracy varies with respect to the considered catalog since the set of variations of interest (i.e., the truth used to compute precision and recall) changes.</p>
      <p id="Par43">Finally, it is interesting to notice that increasing the quantity of sequences in the catalog creation has very little effect, while changing from pipeline A to B—thus including indels—produce a noticeable improvement on both precision and recall. It is important to remark that catalogs that include indels may also contain variants that are called only due to the presence of technical artifacts in the deposited assemblies, hence false variants. On the other hand, some deletions apparently have a role in determining the characteristics of the virus (for example, the spike deletion 69-70del has been described in the context of evasion to the human immune response [<xref ref-type="bibr" rid="CR25">25</xref>]) hence, for some analyses, it is important to characterize and identify them. The improvement on both precision and recall using the catalogs containing indels provides an indirect evidence that MALVA’s predictions are robust against possible technical artifacts, but we believe that the ultimate choice of the catalog is upon the user based on the intended usage of MALVIRUS’s results.</p>
      <p id="Par44">On the default catalogs (those with <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 50$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq30.gif"/></alternatives></inline-formula>), MALVIRUS, ran with a single thread, completed the analysis of each sample in 168 s on average. On the more stringent catalog (<inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 20$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 50$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq32.gif"/></alternatives></inline-formula>) it took 64 s while on the more relaxed one (<inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} = 100$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} = 100$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq34.gif"/></alternatives></inline-formula>), 410 s. This was expected since MALVIRUS execution heavily depends on the size of the input catalog: the more exhaustive and complete it is, the more computational time is required to analyze it.</p>
      <p id="Par45">In terms of memory requirements, MALVIRUS required less than 4GB of RAM in any tested settings. Such amount of resources is nowadays available on any computer, allowing MALVIRUS to run even on laptops and desktop machines. The computational requirements of catalog creation is dominated by the multiple alignment step. However, since these catalogs are precomputed and bundled with the application, this step is not executed on the user’s computer.</p>
      <p id="Par46">To complete the analysis of MALVIRUS results, we also analyzed how many samples have been assigned to the correct Pango lineage. MALVIRUS classified correctly 36–38 (over 41) of them (depending on the considered catalog, 36 for the smallest catalogs and 37–38 for the largest ones). MALVIRUS could not correctly classify all the samples since the set of assemblies currently freely available on NCBI does not contain a sufficient amount of information (i.e., enough assemblies) for correct lineage inference. In the following section, we thus further explore MALVIRUS effectiveness in inferring a lineage from a sample by considering a more complete and exhaustive (but not redistributable) database, i.e., GISAID.</p>
    </sec>
    <sec id="Sec8">
      <title>Lineage assignment accuracy</title>
      <p id="Par47">The second experiment has the goal to assess the quality of MALVIRUS in the assignment of SARS-CoV-2 lineages. In order to build a catalog as representative as possible of the different lineages, in this part we relied on not redistributable sequences from GISAID data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We constructed a total of 8 catalogs from these sequences using the two previously described pipelines (A and B)—all reproducible with our published procedures after obtaining the data from the database, since those data cannot be shared. We used this platform because it currently (as of April 7, 2021) contains around 1 million of assembled sequences—in contrast to the approximately 70 thousands in NCBI/ENA—thus including a much high number of lineages.</p>
      <p id="Par48">In more detail, we downloaded all complete sequences available on GISAID (accessed on April 7, 2021) and we filtered out all those sequences having more than 5% (<inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq35.gif"/></alternatives></inline-formula> parameter) ambiguous nucleotides. From the remaining set of assemblies, we randomly selected either 5 to 20 or exactly 50 samples from each lineage and computed VCF catalogs according to the pipelines A and B. Then we pruned variants that had less than either 2 or 5 sequences supporting them to reduce the noise and errors contained in the large GISAID dataset. The different choice of the parameters <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq37.gif"/></alternatives></inline-formula>, <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq38.gif"/></alternatives></inline-formula> and the addition of a final pruning step, compared to the procedure used to build the precomputed catalogs from publicly available data, is motivated by the significant difference in the number of sequences involved. Indeed, we increased <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq39.gif"/></alternatives></inline-formula> from 1 to 5% in order to avoid discarding upfront lineages represented by a small number of sequences. At the same time, we have been more restrictive on subsampling (i.e., we reduced the minimum and the maximum number of sequences selected for each lineage) since, if all lineages are represented in the set of sequences, then a small number of sequences per lineage should suffice to include variants that characterize the lineage into the catalog. Furthermore, please notice that the additional pruning step we introduced should not filter out variants that are common in a lineage since the minimum support we require (2 or 5) is not greater than the minimum number of sequences we select for each lineage.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Results on GISAID catalogs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pipeline</th><th align="left"><inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq40.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq41.gif"/></alternatives></inline-formula></th><th align="left">Min support</th><th align="left">Precision</th><th align="left">Recall</th><th align="left">Time (s)</th><th align="left">No. of correct lineages</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">5</td><td align="left">20</td><td align="left">2</td><td align="left">.953</td><td align="left">.947</td><td align="left">38</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">5</td><td align="left">20</td><td align="left">5</td><td align="left">.951</td><td align="left">.945</td><td align="left">19</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">5</td><td align="left">20</td><td align="left">2</td><td align="left">.992</td><td align="left">.967</td><td align="left">48</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">5</td><td align="left">20</td><td align="left">5</td><td align="left">.993</td><td align="left">.960</td><td align="left">21</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">50</td><td align="left">2</td><td align="left">.933</td><td align="left">.918</td><td align="left">897</td><td align="left">40</td></tr><tr><td align="left">A</td><td align="left">50</td><td align="left">50</td><td align="left">5</td><td align="left">.942</td><td align="left">.948</td><td align="left">355</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">50</td><td align="left">2</td><td align="left">.960</td><td align="left">.962</td><td align="left">2465</td><td align="left">40</td></tr><tr><td align="left">B</td><td align="left">50</td><td align="left">50</td><td align="left">5</td><td align="left">.972</td><td align="left">.960</td><td align="left">677</td><td align="left">40</td></tr></tbody></table><table-wrap-foot><p>For each catalog, we report the precision and recall achieved by MALVIRUS in genotyping its variations, the average running times, and the number of input samples (out of 41) assigned to the correct lineage. We considered 8 different catalogs, built using pipeline A or B on the set of assemblies retrieved from GISAID, prefiltered using <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _N = 5\%$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq42.gif"/></alternatives></inline-formula> and then subsampled using different combinations of parameters <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq44.gif"/></alternatives></inline-formula>. In addition, we also filtered out from the catalogs all variations present in less than either 2 or 5 assemblies (<italic>Min support</italic> columns)</p></table-wrap-foot></table-wrap></p>
      <p id="Par49">As reported in Table <xref rid="Tab5" ref-type="table">5</xref>, MALVIRUS consistently and accurately detects 40 out of 41 samples (see Table <xref rid="Tab2" ref-type="table">2</xref>) achieving an accuracy of 97.5% on each of the 8 catalogs considered.</p>
      <p id="Par50">MALVIRUS pipeline always failed to correctly classify Illumina sample SRR13261896 (real lineage: B.1.366, USA lineage). We believe that MALVIRUS pipeline is unable to classify it correctly due to the low coverage of the Illumina sample. Indeed, as we can see from Table <xref rid="Tab2" ref-type="table">2</xref>, SRR13261896 is the sample with the lowest coverage: this low coverage may make harder the genotyping process and the subsequent lineage assignment based on genotyped variations. Moreover, MALVIRUS assign this sample to lineage B.1.612, another USA lineage: since both these lineages are quite rare and come from the same region, we believe that it may be easier to mistake one for the other one.</p>
      <p id="Par51">This analysis allowed us to better evaluate the effect of the amount of samples needed for the catalog creation and the minimum allele support. Interestingly they both have very little effect on the precision and recall of variants detection (<inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 2\%$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq45.gif"/></alternatives></inline-formula>), while increasing the number of support from 2 to 5 significantly reduces running times (66% on average) at none or negligible changes of the other scores.</p>
      <p id="Par52">Such results would suggest that increasing the number of samples used to build the catalogs will not yield measurable advantages in terms of precision and will on contrary worsen running times, due to the higher number of variations; thus we suggest using pipeline B with parameters <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$min_{lin} =5$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq46.gif"/></alternatives></inline-formula>, <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max_{lin} =20$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">lin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4668_Article_IEq47.gif"/></alternatives></inline-formula> and with a minimum allele support of 5 when running MALVIRUS on GISAID assemblies—which we expect to be an usual case.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par53">In this work, we presented MALVIRUS, an application for analyzing newly-sequenced viral strains. Starting from a read sample and a set of known variations that can be easily produced using MALVIRUS utilities, it allows to genotype the input sample, annotate the genotyped variants, and—in the case of a SARS-CoV-2 virus sample—assign it to the most likely Pango lineages.</p>
    <p id="Par54">As shown by our results, MALVIRUS is able to efficiently and accurately genotype a newly sequenced SARS-CoV-2 virus both from short (Illumina) and long (Oxford Nanopore) reads. Moreover, it also assign the sample to the correct Pango lineage with very high accuracy (40 samples out of 41 in our experimental setting). Finally, MALVIRUS efficiency and accuracy heavily depend on the considered variant catalog. Therefore, we tested different catalogs built with multiple pipelines from different sets of assemblies: from the publicly available assemblies on NCBI/ENA to the more complete but non redistributable assemblies available on GISAID. As expected, the more assemblies are considered for building the catalog, the more information MALVIRUS can use, increasing the quality of the analysis of a new sample, albeit at the expense of its running times.</p>
    <p id="Par55">Since MALVIRUS benefits from comprehensive variant catalogs, the constantly increasing number of available strains will broaden the completeness of the current variant knowledge, thus boosting the overall accuracy of our pipeline.</p>
  </sec>
  <sec id="Sec10">
    <title>Availability and requirements</title>
    <p id="Par56">Project name: MALVIRUS</p>
    <p id="Par57">Project home page: <ext-link ext-link-type="uri" xlink:href="https://algolab.github.io/MALVIRUS">https://algolab.github.io/MALVIRUS</ext-link></p>
    <p id="Par58">Operating system(s): Platform independent (Docker container)</p>
    <p id="Par59">Programming language: C++ / Python / JavaScript</p>
    <p id="Par60">Other requirements: Docker 20 or higher</p>
    <p id="Par61">License: GNU GPL-3.0</p>
    <p id="Par62">Any restrictions to use by non-academics: none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec11">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4668_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1:</bold> The full list of samples, laboratories, and authors of the data retrieved from GISAID and used in this manuscript.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par4">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>VOC</term>
        <def>
          <p id="Par5">Variant of concern</p>
        </def>
      </def-item>
      <def-item>
        <term>VOI</term>
        <def>
          <p id="Par6">Variant of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par7">Variant call format</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p id="Par8">Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>ILL</term>
        <def>
          <p id="Par9">Illumina</p>
        </def>
      </def-item>
      <def-item>
        <term>ONT</term>
        <def>
          <p id="Par10">Oxford Nanopore Technologies</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Simone Ciccolella and Luca Denti are joint first authors</p>
    </fn>
    <fn>
      <p>Yuri Pirola and Marco Previtali are joint last authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We gratefully acknowledge the Authors and the Originating laboratories where the clinical specimen or virus isolate was first obtained and the Submitting laboratories, where sequence data have been generated and submitted to GISAID.</p>
    <sec id="d32e3357">
      <title>About this supplement</title>
      <p id="Par63">This article has been published as part of BMC Bioinformatics Volume 22 Supplement 15 2021: Proceedings from the 15th Bioinformatics and Computational Biology International Conference - BBCC2020. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-22-supplement-15">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-22-supplement-15</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>PB and GDV suggested the problem and contributed to the design of the work. SC, LD, YP, MP developed the approach and implemented the application. LD and YP designed and performed the empirical analyses. YP and MP supervised the work. All authors wrote, read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No. 872539. The funding body had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript. Publication costs are funded by University of Milano-Bicocca under the project 2019-ATE-0533.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All the programs, scripts, and workflows needed to reproduce the analyses are available in the GitHub MALVIRUS-repro repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/MALVIRUS-repro/">https://github.com/AlgoLab/MALVIRUS-repro/</ext-link>. The datasets analysed in first experimental part (Genotyping accuracy) are available from GenBank and SRA and the aforementioned repository provides detailed instraction to retrieve them. The datasets analysed in the second experimental part also include some data available from GISAID but restrictions apply to redistribution of these data, which were used under license for the current study, and are publicly available from the GISAID website subject to GISAID’s Terms and Conditions (<ext-link ext-link-type="uri" xlink:href="https://www.gisaid.org/registration/terms-of-use/">https://www.gisaid.org/registration/terms-of-use/</ext-link>). The aforementioned repository provides detailed instructions to retrieve them. The full list of samples, laboratories and authors of the data retrieved from GISAID and used in this manuscript is available as Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </notes>
  <notes>
    <title>Declaration</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par64">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par65">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par66">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Helgason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>OT</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Norddahl</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Saemundsdottir</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sigurdsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sulem</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Agustsdottir</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Eiriksdottir</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fridriksdottir</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gardarsdottir</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Georgsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gretarsdottir</surname>
            <given-names>OS</given-names>
          </name>
          <name>
            <surname>Gudmundsson</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gunnarsdottir</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Gylfason</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jensson</surname>
            <given-names>BO</given-names>
          </name>
          <name>
            <surname>Jonasdottir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Josefsdottir</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Kristjansson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Magnusdottir</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>le Roux</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sigmundsdottir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sveinbjornsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sveinsdottir</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Sveinsdottir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thorarensen</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Thorbjornsson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Löve</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jonsdottir</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Möller</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Gudnason</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kristinsson</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Thorsteinsdottir</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Stefansson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Spread of SARS-CoV-2 in the Icelandic population</article-title>
        <source>N Engl J Med</source>
        <year>2020</year>
        <volume>382</volume>
        <issue>24</issue>
        <fpage>2302</fpage>
        <lpage>2315</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa2006100</pub-id>
        <?supplied-pmid 32289214?>
        <pub-id pub-id-type="pmid">32289214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Böhmer</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buchholz</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Corman</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Hoch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marosevic</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Böhm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Woudenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Konrad</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eberle</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Treis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dangel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bengs</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fingerle</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hörmansdorfer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ippisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wicklein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pörtner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zeitlmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boender</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>an der Heiden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rexroth</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hamouda</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mühlemann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wölfel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Antwerpen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Protzer</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Liebl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sing</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Drosten</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zapf</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Investigation of a COVID-19 outbreak in Germany resulting from a single</article-title>
        <source>Lancet Infect Dis</source>
        <year>2020</year>
        <volume>20</volume>
        <issue>8</issue>
        <fpage>920</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(20)30314-5</pub-id>
        <?supplied-pmid 32422201?>
        <pub-id pub-id-type="pmid">32422201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>du Plessis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title>
        <source>Nat Microbiol</source>
        <year>2020</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>1403</fpage>
        <lpage>1407</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-0770-5</pub-id>
        <?supplied-pmid 32669681?>
        <pub-id pub-id-type="pmid">32669681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monticelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hay Mele</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cubellis</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Riccio</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Why does SARS-CoV-2 hit in different ways? Host genetic factors can influence the acquisition or the course of COVID-19</article-title>
        <source>Eur J Med Genet</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1016/j.ejmg.2021.104227</pub-id>
        <?supplied-pmid 33872774?>
        <pub-id pub-id-type="pmid">33872774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Potential role of ACE2 in coronavirus disease 2019 (COVID-19) prevention and management</article-title>
        <source>J Transl Intern Med</source>
        <year>2020</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.2478/jtim-2020-0003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monticelli</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protective role of a TMPRSS2 variant on severe COVID-19 outcome in young males and elderly women</article-title>
        <source>Genes</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>596</fpage>
        <pub-id pub-id-type="doi">10.3390/genes12040596</pub-id>
        <?supplied-pmid 33921689?>
        <pub-id pub-id-type="pmid">33921689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casner</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kwong</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DD</given-names>
          </name>
        </person-group>
        <article-title>Increased resistance of SARS-CoV-2 variant P.1 to antibody neutralization</article-title>
        <source>Cell Host Microbe</source>
        <year>2021</year>
        <volume>29</volume>
        <issue>5</issue>
        <fpage>747</fpage>
        <lpage>7514</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2021.04.007</pub-id>
        <?supplied-pmid 33887205?>
        <pub-id pub-id-type="pmid">33887205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <?supplied-pmid 20644199?>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aw</surname>
            <given-names>PPK</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>GHT</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Khor</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Petric</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hibberd</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>LoFreq: a sequence-quality aware, ultra-sensitive variant caller for uncovering cell-population heterogeneity from high-throughput sequencing datasets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>22</issue>
        <fpage>11189</fpage>
        <lpage>11201</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks918</pub-id>
        <?supplied-pmid 23066108?>
        <pub-id pub-id-type="pmid">23066108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCauley</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>GISAID: global initiative on sharing all influenza data—from vision to reality</article-title>
        <source>Eurosurveillance</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id>
        <?supplied-pmid 28537546?>
        <pub-id pub-id-type="pmid">28537546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>48</volume>
        <issue>D1</issue>
        <fpage>84</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eaaswarkhanth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Al Madhoun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Al-Mulla</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Could the D614G substitution in the SARS-CoV-2 spike (S) protein be associated with higher COVID-19 mortality?</article-title>
        <source>Int J Infect Dis</source>
        <year>2020</year>
        <volume>96</volume>
        <fpage>459</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijid.2020.05.071</pub-id>
        <?supplied-pmid 32464271?>
        <pub-id pub-id-type="pmid">32464271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>SWX</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Lye</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Lack of detail in population-level data impedes analysis of SARS-CoV-2 variants of concern and clinical outcomes</article-title>
        <source>Lancet Infect Dis</source>
        <year>2021</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1195</fpage>
        <lpage>1197</lpage>
        <pub-id pub-id-type="doi">10.1016/s1473-3099(21)00201-2</pub-id>
        <?supplied-pmid 33857407?>
        <pub-id pub-id-type="pmid">33857407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Toole</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Scher</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Underwood</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McCrone</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Colquhoun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abu-Dahab</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yeats</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Plessis</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Maloney</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Medd</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Attwood</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title>
        <source>Virus Evol</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/ve/veab064</pub-id>
        <?supplied-pmid 34527285?>
        <pub-id pub-id-type="pmid">34527285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">World Health Organization (WHO): Tracking SARS-CoV-2 variants (2021) <ext-link ext-link-type="uri" xlink:href="https://www.who.int/en/activities/tracking-SARS-CoV-2-variants/">https://www.who.int/en/activities/tracking-SARS-CoV-2-variants/</ext-link>. Accessed 5 Oct 2021</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altmann</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Boyton</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Beale</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Immunity to SARS-CoV-2 variants of concern</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>371</volume>
        <issue>6534</issue>
        <fpage>1103</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abg7404</pub-id>
        <?supplied-pmid 33707254?>
        <pub-id pub-id-type="pmid">33707254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Will SARS-CoV-2 variants of concern affect the promise of vaccines?</article-title>
        <source>Nat Rev Immunol</source>
        <year>2021</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>340</fpage>
        <lpage>341</lpage>
        <pub-id pub-id-type="doi">10.1038/s41577-021-00556-5</pub-id>
        <?supplied-pmid 33927376?>
        <pub-id pub-id-type="pmid">33927376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mölder</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Letcher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Twardziok</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holtgrewe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Sustainable data analysis with Snakemake</article-title>
        <source>F1000Research</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.12688/f1000research.29032.2</pub-id>
        <?supplied-pmid 34035898?>
        <pub-id pub-id-type="pmid">34035898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merkel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Docker: lightweight linux containers for consistent development and deployment</article-title>
        <source>Linux J</source>
        <year>2014</year>
        <volume>2014</volume>
        <issue>239</issue>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bernardini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALVA: genotyping by Mapping-free ALlele detection of known VAriants</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>20</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.07.011</pub-id>
        <?supplied-pmid 31352182?>
        <pub-id pub-id-type="pmid">31352182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">OToole Á, Hill V, et al (2021) Tracking the international spread of SARS-CoV-2 lineages B.1.1.7 and B.1.351/501Y-V2 with grinch. Wellcome Open Res. 10.12688/wellcomeopenres.16661.2</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <?supplied-pmid 23329690?>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Seemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Keane</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>SNP-sites: rapid efficient extraction of SNPs from multi-FASTA alignments</article-title>
        <source>Microb Genom</source>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000056</pub-id>
        <?supplied-pmid 28348874?>
        <pub-id pub-id-type="pmid">28348874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Andrew Rambaut et al (2020) Preliminary genomic characterisation of an emergent SARS-CoV-2 lineage in the UK defined by a novel set of spike mutations. <ext-link ext-link-type="uri" xlink:href="https://virological.org/t/preliminary-genomic-characterisation-of-an-emergent-sars-cov-2-lineage-in-the-uk-defined-by-a-novel-set-of-spike-mutations/563/1">https://virological.org/t/preliminary-genomic-characterisation-of-an-emergent-sars-cov-2-lineage-in-the-uk-defined-by-a-novel-set-of-spike-mutations/563/1</ext-link>. Accessed 19 Dec 2020.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Długosz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KMC 3: counting and manipulating k-mer statistics</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>17</issue>
        <fpage>2759</fpage>
        <lpage>2761</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx304</pub-id>
        <?supplied-pmid 28472236?>
        <pub-id pub-id-type="pmid">28472236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cingolani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Platts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ruden</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A program for annotating and predicting the effects of single nucleotide polymorphisms. SnpEff</article-title>
        <source>Fly</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>80</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.4161/fly.19695</pub-id>
        <?supplied-pmid 22728672?>
        <pub-id pub-id-type="pmid">22728672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Li H (2013) Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. 10.48550/arXiv.1303.3997</mixed-citation>
    </ref>
  </ref-list>
</back>
