<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870555</article-id>
    <article-id pub-id-type="pmid">28881982</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx248</article-id>
    <article-id pub-id-type="publisher-id">btx248</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2017: The 25th Annual Conference Intelligent Systems for Molecular Biology Held Jointly with the 16th Annual European Conference on Computational Biology, Prague, Czech Republic, July 21–25, 2017</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Transmed</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Association testing of bisulfite-sequencing methylation data via a Laplace approximation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Weissbrod</surname>
          <given-names>Omer</given-names>
        </name>
        <xref ref-type="aff" rid="btx248-aff1">1</xref>
        <xref ref-type="aff" rid="btx248-aff2">2</xref>
        <xref ref-type="corresp" rid="btx248-cor1"/>
        <!--<email>omerw@cs.technion.ac.il</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rahmani</surname>
          <given-names>Elior</given-names>
        </name>
        <xref ref-type="aff" rid="btx248-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schweiger</surname>
          <given-names>Regev</given-names>
        </name>
        <xref ref-type="aff" rid="btx248-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rosset</surname>
          <given-names>Saharon</given-names>
        </name>
        <xref ref-type="aff" rid="btx248-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Halperin</surname>
          <given-names>Eran</given-names>
        </name>
        <xref ref-type="aff" rid="btx248-aff4">4</xref>
        <xref ref-type="aff" rid="btx248-aff5">5</xref>
        <xref ref-type="corresp" rid="btx248-cor1"/>
        <!--<email>ehalperin@cs.ucla.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="btx248-aff1"><label>1</label>Statistics Department, Tel Aviv University, Tel Aviv, Israel</aff>
    <aff id="btx248-aff2"><label>2</label>Computer Science Department, Technion - Israel Institute of Technology, Haifa, Israel</aff>
    <aff id="btx248-aff3"><label>3</label>Blavatnik School of Computer Science, Tel Aviv University, Tel Aviv, Israel</aff>
    <aff id="btx248-aff4"><label>4</label>Computer Science Department, University of California Los Angeles, Los Angeles, CA, USA</aff>
    <aff id="btx248-aff5"><label>5</label>Department of Anesthesiology and Perioperative Medicine, University of California Los Angeles, Los Angeles, CA, USA</aff>
    <author-notes>
      <corresp id="btx248-cor1">To whom correspondence should be addressed. Email: <email>omerw@cs.technion.ac.il</email> or <email>ehalperin@cs.ucla.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-07-12">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>14</issue>
    <fpage>i325</fpage>
    <lpage>i332</lpage>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx248.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Epigenome-wide association studies can provide novel insights into the regulation of genes involved in traits and diseases. The rapid emergence of bisulfite-sequencing technologies enables performing such genome-wide studies at the resolution of single nucleotides. However, analysis of data produced by bisulfite-sequencing poses statistical challenges owing to low and uneven sequencing depth, as well as the presence of confounding factors. The recently introduced Mixed model Association for Count data via data AUgmentation (MACAU) can address these challenges via a generalized linear mixed model when confounding can be encoded via a single variance component. However, MACAU cannot be used in the presence of multiple variance components. Additionally, MACAU uses a computationally expensive Markov Chain Monte Carlo (MCMC) procedure, which cannot directly approximate the model likelihood.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We present a new method, Mixed model Association via a Laplace ApproXimation (MALAX), that is more computationally efficient than MACAU and allows to model multiple variance components. MALAX uses a Laplace approximation rather than MCMC based approximations, which enables to directly approximate the model likelihood. Through an extensive analysis of simulated and real data, we demonstrate that MALAX successfully addresses statistical challenges introduced by bisulfite-sequencing while controlling for complex sources of confounding, and can be over 50% faster than the state of the art.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>The full source code of MALAX is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/omerwe/MALAX">https://github.com/omerwe/MALAX</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Israel Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003977</named-content>
        </funding-source>
        <award-id>Grant 1425/13</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, epigenetic variation has proven to be an important factor in many traits and diseases (<xref rid="btx248-B3" ref-type="bibr">Bird, 2007</xref>). One of the most prominent sources of epigenetic variation is differential DNA methylation (<xref rid="btx248-B17" ref-type="bibr">Jones, 2012</xref>). Currently, the predominant technology for measuring methylation levels is based on methylation arrays, which can probe a specific list of sites. However, the recently emerging bisulfite-sequencing technology enables measuring methylation levels across the entire genome (<xref rid="btx248-B7" ref-type="bibr">Cokus <italic>et al.</italic>, 2008</xref>). In spite of the clear advantages, testing for associations between methylation patterns and phenotypes via bisulfite-sequencing data is hindered by several challenges.</p>
    <p>The main challenge in the analysis of bisulfite-sequencing data is their typically low and uneven sequencing depth. Specifically, the proportion of the number of methylated reads to the total number of reads is an unreliable measure of the true methylation level, when the total number of reads is small. Consequently, naive application of regression models for such data leads to loss of power and to spurious results (<xref rid="btx248-B26" ref-type="bibr">Sun <italic>et al.</italic>, 2014</xref>). To circumvent this difficulty, several methods proposed treating the phenotype as an explanatory variable and the methylation sites as beta-binomial (BB) distributed response variables (<xref rid="btx248-B9" ref-type="bibr">Dolzhenko and Smith, 2014</xref>; <xref rid="btx248-B11" ref-type="bibr">Feng <italic>et al.</italic>, 2014</xref>; <xref rid="btx248-B26" ref-type="bibr">Sun <italic>et al.</italic>, 2014</xref>). The use of a BB distribution accounts for both the binomial nature of the methylation levels and for their tendency to be highly overdispersed relative to a standard binomial distribution.</p>
    <p>Although the aforementioned methods successfully account for independent overdispersion, methylation counts of different individuals are often correlated owing to confounding factors such as population structure, cryptic relatedness or batch effects in the data (<xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic>, 2015</xref>). Such confounding factors must be accounted for to prevent spurious findings. Linear mixed models (LMMs) are often used to control for confounding in genetic studies (<xref rid="btx248-B30" ref-type="bibr">Yang <italic>et al.</italic>, 2014</xref>), but similarly to other regression models, LMMs suffer from loss of power and spurious results in the presence of bisulfite-sequencing data (<xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic>, 2015</xref>). To address this challenge, Mixed model Association for Count data via data AUgmentation (MACAU) (<xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic>, 2015</xref>) combines the idea of treating methylation sites as response variables, with a generalized linear mixed model (GLMM) that can control for confounding.</p>
    <p>A severe limitation of GLMMs is that numerical likelihood evaluation is computationally infeasible in typical settings. To overcome this limitation, MACAU assigns a prior distribution to the model parameters and then estimates their posterior distribution via MCMC. The posterior mean and variance estimates of the effect of the phenotype on a certain site are then used to test for association, by treating them as maximum likelihood estimates (MLEs) and using them in a Wald test context.</p>
    <p>Although MACAU addresses the computational infeasibility limitation, the proposed MCMC approach suffers from two caveats. First and foremost, MACAU cannot be used in the presence of multiple variance components, because it uses an approximation that specifically exploits the structure of its probabilistic model when there is only a single variance component (in addition to the variance component associated with the identity matrix). In recent years it has been shown that it is often beneficial to use multiple variance components to control for multiple sources of confounding. For example, <xref rid="btx248-B29" ref-type="bibr">Widmer <italic>et al.</italic> (2014</xref>) suggested using two variance components to improve the model fit; <xref rid="btx248-B5" ref-type="bibr">Chen <italic>et al.</italic> (2016</xref>) used three variance components to control for genetic relatedness as well as household and block group membership; <xref rid="btx248-B6" ref-type="bibr">Cohen <italic>et al.</italic> (2016</xref>) used two variance components to control for both genetic relatedness and for experimental variability; <xref rid="btx248-B22" ref-type="bibr">Powell <italic>et al.</italic> (2013</xref>) used two variance components corresponding to additive and dominance effects. In the context of Epigenome-wide association studies (EWASs), it can be beneficial to control for genetic similarity as well as methylation similarity, which can for example capture confounding due to cell type composition (<xref rid="btx248-B31" ref-type="bibr">Zou <italic>et al.</italic>, 2014</xref>).</p>
    <p>A second caveat of the proposed MCMC approach is the need to carry out convergence diagnostics and fine-tune many parameters, which hinders the use of MCMC methods in practice.</p>
    <p>Here we present Mixed model Association via a Laplace ApproXimation (MALAX), which directly approximates the likelihood of the GLMM used by MACAU via a Laplace approximation (<xref rid="btx248-B24" ref-type="bibr">Rasmussen and Williams, 2006</xref>). Briefly, MALAX approximates the conditional distribution of the logit of the methylation levels given the data as a multivariate normal distribution, by using a second order Taylor expansion. This approximation enables a fast analytical approximation of the MLEs of all parameters, allowing MALAX to successfully address the caveats above: MALAX can be used with multiple variance components, it does not assume the existence of a prior distribution of the model parameters, and it does not require parameter fine-tuning. Additionally, MALAX can be over 50% faster than the state of the art.</p>
    <p>In order to evaluate MALAX we carry out extensive simulations of studies with diverse sources of confounding. We additionally demonstrate the advantages of MALAX in an analysis of 50 baboons with multiple variance components, which was not possible using previous methods. Our simulations and real data analysis indicate that MALAX has high power to discover phenotype-epigenetic associations, while controlling for diverse sources of confounding.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Methods overview</title>
      <p>We begin by providing an overview of association testing in the presence of bisulfite-sequencing data. Consider a dataset of <italic>n</italic> individuals with measured phenotypes, covariates, read counts and methylated read counts. We are interested in testing the null hypothesis that the proportion of methylated reads at site <italic>j</italic> is independent of the phenotype.</p>
      <p>A naive approach is to treat the observed proportion of methylated reads at site <italic>j</italic> as an additional covariate and test for association between this covariate and the phenotype via a regression model. Specifically, assuming a quantitative phenotype and denoting <inline-formula id="IE1"><mml:math id="IEQ1"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> as a vector of observed phenotypes, <inline-formula id="IE2"><mml:math id="IEQ2"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IEQ3"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> as vectors with the number of methylated reads and the total number of reads for site <italic>j</italic>, respectively, and <inline-formula id="IE4"><mml:math id="IEQ4"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> as a matrix of covariates including an intercept, (where each element <inline-formula id="IE5"><mml:math id="IEQ5"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a vector of <italic>c</italic> covariates for individual <italic>i</italic>), a naive regression model is defined as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="EQ1"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Wα</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>β</mml:mo><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here, <inline-formula id="IE6"><mml:math id="IEQ6"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a vector of independent normally distributed residuals with variance <inline-formula id="IE7"><mml:math id="IEQ7"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE8"><mml:math id="IEQ8"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a vector of methylation levels, <inline-formula id="IE9"><mml:math id="IEQ9"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mo>α</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>α</mml:mo><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a vector of fixed effects, and <italic>β</italic> is the fixed effect of the methylation level. Association testing amounts to testing the null hypothesis <inline-formula id="IE10"><mml:math id="IEQ10"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>β</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The above model can be extended to account for complex sources of confounding by using a LMM, which consists of changing the distribution of <inline-formula id="IE11"><mml:math id="IEQ11"><mml:mi>ε</mml:mi></mml:math></inline-formula> to <inline-formula id="IE12"><mml:math id="IEQ12"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE13"><mml:math id="IEQ13"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is an <italic>n</italic> × <italic>n</italic> matrix describing the effect of the <italic>v</italic>th source of confounding, and <inline-formula id="IE14"><mml:math id="IEQ14"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the <italic>v</italic>th variance component.</p>
      <p>Unfortunately, the observed proportions encoded in the vector <inline-formula id="IE15"><mml:math id="IEQ15"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are unreliable estimators of the true proportions when <inline-formula id="IE16"><mml:math id="IEQ16"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> contains small numbers, which can in turn lead to loss of power and to spurious results (<xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic>, 2015</xref>). A common solution is to treat the phenotype as a covariate and the observed number of reads as a response variable, which enables to explicitly model the binomial nature of the methylation levels. We now present the statistical model of MALAX and MACAU, which adopts this approach in the framework of a GLMM.</p>
    </sec>
    <sec>
      <title>2.2 Statistical model</title>
      <p>MALAX models the distribution of <inline-formula id="IE17"><mml:math id="IEQ17"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> conditional on all the other variables via a binomial GLMM as follows:
<disp-formula id="E2"><label>(2)</label><mml:math id="EQ2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>π</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mo>π</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>α</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Here, <inline-formula id="IE18"><mml:math id="IEQ18"><mml:mrow><mml:msubsup><mml:mo>π</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the methylation probability of a probe coming from site <italic>j</italic> in individual <italic>i</italic>, and <inline-formula id="IE19"><mml:math id="IEQ19"><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is the vector of the logits of these probabilities. The variance component <inline-formula id="IE20"><mml:math id="IEQ20"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> accounts for independent over-dispersion, which describes the observation that the variance of methylation levels across different individuals is often much larger than expected under a binomial model.</p>
      <p>A natural interpretation of this model is that every individual <italic>i</italic> is associated with a latent random variable <italic>l<sub>i</sub></italic> which is affected by her covariates and genetic variants, such that larger values of <italic>l<sub>i</sub></italic> lead to higher methylation levels. In this respect, the model is similar to the well-known liability threshold model often employed in case-control studies (<xref rid="btx248-B28" ref-type="bibr">Weissbrod <italic>et al.</italic>, 2015</xref>), wherein every individual is associated with a latent liability value. If <inline-formula id="IE21"><mml:math id="IEQ21"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a matrix of inner-products of normalized genetic vectors, it encodes the assumption that genetic variants exert a linear effect on <italic>l<sub>i</sub></italic>, similarly to the assumption often employed in standard LMMs.</p>
      <p>Association testing consists of testing the null hypothesis <inline-formula id="IE22"><mml:math id="IEQ22"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>β</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and can be carried out via a Wald test, which requires computing the MLE of the model parameters. The log likelihood function is given by:
<disp-formula id="E3"><label>(3)</label><mml:math id="EQ3"><mml:mrow><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where we omitted conditioning <bold><italic>l</italic></bold> on the observed variables and on the model parameters for brevity. <xref ref-type="disp-formula" rid="E3">Equation (3)</xref> demonstrates that likelihood evaluation requires numerically evaluating an <italic>n</italic>-dimensional integral, which scales exponentially with <italic>n</italic> when using state of the art algorithms, such as adaptive Gauss-Kronrod quadrature (<xref rid="btx248-B18" ref-type="bibr">Kahaner <italic>et al.</italic>, 1989</xref>). To circumvent this difficulty, MACAU adopts a Bayesian framework by first assigning a prior distribution to the fixed effects and variance components, and then sampling parameter values from their posterior distribution. In contrast, MALAX does not assume that the parameters have a prior distribution, and instead directly approximates the likelihood via a Laplace approximation.</p>
    </sec>
    <sec>
      <title>2.3 Laplace approximation</title>
      <p>The underlying idea behind MALAX is that the conditional density <inline-formula id="IE23"><mml:math id="IEQ23"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be approximated to follow a multivariate Gaussian via a second order Taylor expansion. Under this approximation, the log likelihood can be approximated as follows:
<disp-formula id="E4"><label>(4)</label><mml:math id="EQ4"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">GA</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Here, <inline-formula id="IE24"><mml:math id="IEQ24"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:math></inline-formula> is the overall covariance matrix, <inline-formula id="IE25"><mml:math id="IEQ25"><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Wα+xβ</mml:mi></mml:mrow></mml:math></inline-formula> is the mean of <bold><italic>l</italic></bold>, <inline-formula id="IE26"><mml:math id="IEQ26"><mml:mrow><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the gradient of <inline-formula id="IE27"><mml:math id="IEQ27"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with respect to <bold><italic>l</italic></bold>, evaluated at <inline-formula id="IE28"><mml:math id="IEQ28"><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE29"><mml:math id="IEQ29"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>≜</mml:mo><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Hessian of the negative logarithm of the conditional density of <bold><italic>l</italic></bold> with respect to <bold><italic>l</italic></bold>, evaluated at <inline-formula id="IE30"><mml:math id="IEQ30"><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>A brief sketch of the derivation of <xref ref-type="disp-formula" rid="E4">Equation (4)</xref> is now provided, with a longer description available in (<xref rid="btx248-B24" ref-type="bibr">Rasmussen and Williams, 2006</xref>). First, we apply a second order Taylor expansion to the logarithm of <inline-formula id="IE31"><mml:math id="IEQ31"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> around <inline-formula id="IE32"><mml:math id="IEQ32"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> as follows:
<disp-formula id="E5"><label>(5)</label><mml:math id="EQ5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≈</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Using this approximation, the log likelihood can be approximated analytically as follows:
<disp-formula id="E6"><label>(6)</label><mml:math id="EQ6"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≈</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>GA</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>GA</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The second equality can be verified by noting that the integral is equal to the reciprocal of the normalizing constant of a multivariate normal distribution with mean vector <inline-formula id="IE33"><mml:math id="IEQ33"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and covariance matrix <inline-formula id="IE34"><mml:math id="IEQ34"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The third equality is derived by using the definition of <inline-formula id="IE35"><mml:math id="IEQ35"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and some algebra. The fourth equality uses the following equation:
<disp-formula id="E7"><label>(7)</label><mml:math id="EQ7"><mml:mrow><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
and the fact that the above equation is equal to 0 by definition when <inline-formula id="IE36"><mml:math id="IEQ36"><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>The computation of <inline-formula id="IE37"><mml:math id="IEQ37"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> can be performed via Newton–Raphson iterations, which require inverting the Hessian of <inline-formula id="IE38"><mml:math id="IEQ38"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with respect to <bold><italic>l</italic></bold>. Additionally, the likelihood approximation requires evaluating the determinant of the matrix <bold><italic>AG</italic></bold>. Both operations scale cubically with <italic>n</italic> under standard implementations. Hence, the computational complexity of the algorithm is <inline-formula id="IE39"><mml:math id="IEQ39"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The number of cubic operations required for each methylation site depends on the number of iterations required for convergence of the Newton-Raphson algorithm and of the optimization scheme, and was typically around 50 in our implementation.</p>
    </sec>
    <sec>
      <title>2.4 Testing for association</title>
      <p>MALAX tests for association between a phenotype vector <bold><italic>x</italic></bold> and a vector of methylation counts <inline-formula id="IE40"><mml:math id="IEQ40"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> by attempting to reject the null hypothesis <inline-formula id="IE41"><mml:math id="IEQ41"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>β</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> via a Wald test. The test statistic is given by <inline-formula id="IE42"><mml:math id="IEQ42"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mtext>var</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE43"><mml:math id="IEQ43"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the MLE of <italic>β</italic>, and asymptotically follows a <inline-formula id="IE44"><mml:math id="IEQ44"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> distribution with one degree of freedom under the null hypothesis. MALAX estimates <inline-formula id="IE45"><mml:math id="IEQ45"><mml:mrow><mml:mtext>var</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> via the diagonal entry corresponding to <italic>β</italic> in the inverse of the Hessian of the log likelihood. MALAX approximates the Hessian via finite differences.</p>
    </sec>
    <sec>
      <title>2.5 Gradient computation</title>
      <p>The gradient of the approximate log likelihood above is required both for approximating the Hessian and for the maximum likelihood estimation procedure. A subtle point that requires consideration is that while the quantities <bold><italic>G</italic></bold> and <bold><italic>m</italic></bold> depend explicitly on the model parameters, the quantities <inline-formula id="IE46"><mml:math id="IEQ46"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <bold><italic>A</italic></bold> also implicitly depend on these parameters. We therefore divide the partial derivative according to each parameter <italic>θ</italic> (which can represent variance components or fixed effects) into its explicit and implicit components, by using the chain rule as follows:
<disp-formula id="E8"><label>(8)</label><mml:math id="EQ8"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mtext>explicit</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula id="IE47"><mml:math id="IEQ47"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. A full derivation is provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>. The gradient computation scales cubically with the sample size under standard implementations, similarly to the likelihood approximation.</p>
    </sec>
    <sec>
      <title>2.6 Optimization and implementation details</title>
      <p>The model parameters were optimized via the L-BFGS-B algorithm (<xref rid="btx248-B4" ref-type="bibr">Byrd <italic>et al.</italic>, 1995</xref>), using the implementation provided in the SciPy package (<xref rid="btx248-B16" ref-type="bibr">Jones <italic>et al.</italic>, 2001</xref>). To begin the optimization procedure with reasonable initial values, the initial values of the fixed effects were computed via a BB model. The initial value of each variance component was 0.5. The code was compiled using Cython (<xref rid="btx248-B2" ref-type="bibr">Behnel <italic>et al.</italic>, 2011</xref>) for efficient computations. When testing each site, individuals with zero reads at this site were excluded from the analysis.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We evaluated the performance of MALAX on synthetic and real data. In all experiments, we compared the following methods: (i) MALAX-2, which uses two variance components, corresponding to both genetic kinship and to similarity estimated from methylation data; (ii) MALAX-1g, which uses a single variance component of genetic kinship; (iii) MALAX-1m, which uses a single variance component of methylation similarity; (iv) BB model can only control for independent over-dispersion; and (v) MACAU (using default settings), which uses a single variance component of genetic kinship. Specifically, MACAU used 1000 MCMC iterations and 100 burn-in iterations. We verified that increasing these numbers increased the run-time and had a negligible effect on the results (results not shown).</p>
    <p>In the synthetic experiments, the genetic kinship matrix was computed via normalized single nucleotide polymorphisms (SNPs), and the methylation similarity was based on cell-type composition, as described in the next section. In the real data analysis, the genetic kinship matrix was computed as described in <xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic> (2015)</xref>, and the methylation similarity matrix was constructed as described in Section 3.3.1.</p>
    <sec>
      <title>3.1 Data simulation</title>
      <p>We simulated synthetic data with two sources of confounding: genetic confounding and confounding due to cell-type composition, which was shown to be a major source of confounding in methylation studies (<xref rid="btx248-B14" ref-type="bibr">Jaffe and Irizarry, 2014</xref>). Specifically, we simulated individuals with cell-type composition and SNPs. Every individual was sampled from a mixture of four populations, and the SNP distribution of every individual reflected the SNP distributions in the corresponding populations. The phenotype of every individual was affected by the SNPs and by two normally distributed covariates. Finally, the methylation levels were affected by the SNPs, the covariates, and possibly also by the cell-type composition and the phenotype (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
      <p>The populations were generated via the Balding Nichols model, which assumes that several populations diverged from a single ancestral population (<xref rid="btx248-B1" ref-type="bibr">Balding and Nichols, 1995</xref>). Under this model, the distance between populations can be quantified via the <italic>F</italic><sup>ST</sup> measure, where <italic>F</italic><sup>ST</sup> = 0.01 corresponds to the typical difference between human individuals across remote regions in Europe.</p>
      <p>Unless stated otherwise, in all experiments we simulated 200 individuals with 2 covariates, 60 000 SNPs, a normally distributed phenotype affected by 500 of the SNPs, and 10 000 methylation sites, such that either 0, 25 or 50% of the methylation sites were differentially methylated (DM) according to five different cell-types, and 500 out of the 10 000 sites were associated with the phenotype. The allele frequencies of each population were generated using <italic>F</italic><sup>ST</sup> = 0.01. Ten datasets were generated for each unique combination of evaluated settings. A full description of the simulations procedure is provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
    </sec>
    <sec>
      <title>3.2 Synthetic data experiments</title>
      <p>We performed several experiments to evaluate the performance of the evaluated methods. In all experiments, the genetic kinship matrix was given by <inline-formula id="IE48"><mml:math id="IEQ48"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, where <bold><italic>X</italic></bold> is a matrix of normalized SNPs and <italic>m</italic> is the number of SNPs. The methylation similarity matrix was similarly given by <inline-formula id="IE49"><mml:math id="IEQ49"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, where <bold><italic>Z</italic></bold> is a matrix of normalized cell-type compositions (which can be estimated using e.g. methylomes from purified cell types), and <italic>p</italic> is the number of cell-types.</p>
      <p>Our first experiment examined the benefits of using two variance components. To this end, we generated datasets with various degrees of cell-type composition effects by varying the number of sites that are DM across different cell-types. We first measured the robustness of the methods to false positive detections. The false positive rate of MALAX-2 was comparable or superior to that of the other methods under all settings, as evidenced by both QQ plots and by the genomic control inflation factor (<xref rid="btx248-B8" ref-type="bibr">Devlin and Roeder, 1999</xref>) (<xref ref-type="fig" rid="btx248-F1">Fig. 1</xref>). We also evaluated a version of MACAU which used only a matrix of methylation similarities (similarly to MALAX-1m). As expected, this version of MACAU performed very similarly to MALAX-1m (results not shown).</p>
      <fig id="btx248-F1" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>QQ plots of the evaluated methods, computed using only sites not directly associated with the phenotype, under simulated datasets with population structure and with various proportions of DM sites. Each figure aggregates the results of 10 simulated datasets. The 95% CI of the expected null distribution is shaded in gray. The mean and SD of the genomic control inflation factor of each method is shown next to its name. all methods suffer from some degree of inflation in the presence of severe confounding, but MALAX-2 always controls for type I error as well as or better than the alternative methods. The three methods that do not control for confounding due to methylation similarity become increasingly less calibrated as the percentage of DM sites increases</p>
        </caption>
        <graphic xlink:href="btx248f1"/>
      </fig>
      <p>Next, we measured the ability to identify truly associated sites via detection power (defined as the proportion of top ranked sites that are directly associated with the phenotype) of the top 500 sites (corresponding to the number of truly associated sites), as this measure allows a fair comparison between methods with different false positives rates. As expected, MALAX-1g and MACAU outperformed the other methods in the absence of DM sites, but the advantage of MALAX-2 and MALAX-1m increased with the proportion of DM sites (<xref ref-type="fig" rid="btx248-F2">Fig. 2</xref>). MALAX-2 clearly outperformed the other methods at distinguishing associated from non-associated sites when 50% of the sites were DM. Exact power results are presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>, which shows very similar results. We further verified that the results remained similar when modifying some of the simulation parameters such as the number of covariates, the proportions of DM sites and the numbers of populations (results not shown). Additionally, we evaluated the performance of two additional recently proposed methods for GLMM approximations (<xref rid="btx248-B15" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>; <xref rid="btx248-B5" ref-type="bibr">Chen <italic>et al.</italic>, 2016</xref>), and found that MALAX outperforms both methods (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
      <fig id="btx248-F2" orientation="portrait" position="float">
        <label>Fig. 2</label>
        <caption>
          <p>The detection power of the evaluated methods under simulated datasets with various proportions of DM sites. All results are averaged over 10 simulated datasets. The three methods that control only for genetic confounding are more powerful than the other ones in the absence of DM sites, but MALAX-2 and MALAX-1m become increasingly more powerful as the percentage of DM sites increases</p>
        </caption>
        <graphic xlink:href="btx248f2"/>
      </fig>
      <p>To explore the computational efficiency of the methods, we measured their run time under varying sample sizes, using a single core of a Linux workstation with a 2GHz Xeon CPU. BB was the fastest method, owing to its relatively simple model, while MACAU was substantially slower than the MALAX methods (<xref ref-type="fig" rid="btx248-F3">Fig. 3</xref>). Interestingly, the three MALAX settings had very similar run times, indicating that using additional variance components incurs a negligible computational price. We note that MACAU was invoked with the default parameter of 1000 MCMC iterations, which could make the advantage of MALAX even greater in practice.</p>
      <fig id="btx248-F3" orientation="portrait" position="float">
        <label>Fig. 3</label>
        <caption>
          <p>Box plots describing the running times of the evaluated methods in the presence of simulated datasets with varying proportions of DM sites and sample sizes (<italic>n</italic>), and with 10 000 sites. The flat boxes at the bottom represent the BB method</p>
        </caption>
        <graphic xlink:href="btx248f3"/>
      </fig>
      <p>Finally, we explored the differences between MALAX-1g and MACAU, which both use a single variance component of genetic kinship. The <italic>P</italic>-values computed by the two methods were highly correlated (<xref ref-type="fig" rid="btx248-F4">Fig. 4</xref>), indicating that MALAX-1g can be routinely used at a substantially reduced computational cost compared with the state of the art.</p>
      <fig id="btx248-F4" orientation="portrait" position="float">
        <label>Fig. 4</label>
        <caption>
          <p>The correlation between the <italic>P</italic>-values computed by MALAX-1g and by MACAU across simulated datasets. The sites are sorted according to the <italic>P</italic>-values computed by MALAX-1g. The shown values <italic>ρ</italic> are the Pearson correlation between the <italic>P</italic>-values (in log scale)</p>
        </caption>
        <graphic xlink:href="btx248f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Real data analysis</title>
      <p>To demonstrate the differences between the evaluated methods in the analysis of real data, we investigated a dataset of 50 baboons with measured relatedness values and methylation levels at 438 311 sites, which were tested for association with age. This dataset was previously described in <xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic> (2015)</xref>, where it was analyzed by MACAU. Here, we reanalyzed this dataset using MALAX with multiple variance components, which can potentially control for additional sources of confounding, such as cell-type composition (<xref rid="btx248-B14" ref-type="bibr">Jaffe and Irizarry, 2014</xref>).</p>
      <p>MALAX-1g used a single variance component associated with genetic kinship, MALAX-1m used a single variance component associated with mehylation similarity, and MALAX-2 used two variance components associated with the two matrices. The genetic kinship matrix was computed via microsatellite data, as described in <xref rid="btx248-B20" ref-type="bibr">Lea <italic>et al.</italic> (2015)</xref>. The methylation similarity matrix was computed as described in Section 3.3.1, with a selected value of <italic>b</italic> = 80 (indicating that 80 sites were used for estimating methylation similarity). The covariates included sex, sample age and efficiency of the bisulfite conversion rate estimated from the lambda phage spike-in.</p>
      <sec>
        <title>3.3.1 Construction of methylation-based similarity matrix</title>
        <p>To control for sources of confounding that can be captured in the real methylation data, we applied methodology similar to the one previously proposed in (<xref rid="btx248-B31" ref-type="bibr">Zou <italic>et al.</italic>, 2014</xref>). Namely, we first computed a <italic>P</italic>-value for every site via a BB model, and then constructed a similarity matrix using the <italic>b</italic> sites most associated with the phenotype.</p>
        <p>One difficulty in applying this approach in the presence of bisulfite-sequencing data is that construction of the matrix is not straightforward, as some sites have many more reads (and thus provide a greater degree of confidence in their methylation levels) than others. Therefore, naively using the proportion of the number of methylated to observed reads will lead to highly inaccurate estimates.</p>
        <p>To address this challenge, we first estimated the (logit of the) methylation level of every individual <italic>i</italic> in every site <italic>k</italic>, <inline-formula id="IE50"><mml:math id="IEQ50"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, using the Laplace approximation of MALAX. Afterwards, we defined the methylation similarity between individuals <italic>i</italic>,<italic>j</italic> as <inline-formula id="IE51"><mml:math id="IEQ51"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>l</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>T<sub>b</sub></italic> is the set of the <italic>b</italic> sites with the smallest <italic>P</italic>-values according to a BB model.</p>
        <p>The parameter <italic>b</italic> was determined by maximizing the out of sample log likelihood of the phenotype on held-out data when using the similarity matrix described earlier, using a 10-fold cross-validation with a standard LMM, as in (<xref rid="btx248-B31" ref-type="bibr">Zou <italic>et al.</italic>, 2014</xref>). Formally, the phenotype <bold><italic>x</italic></bold> was modeled as <inline-formula id="IE52"><mml:math id="IEQ52"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Wα</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mi>b</mml:mi></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE53"><mml:math id="IEQ53"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a vector of estimated methylation levels in logit space.</p>
        <p>The individuals were divided into 10 random equally sized folds. For each evaluated value of <italic>b</italic>, the parameters <inline-formula id="IE54"><mml:math id="IEQ54"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IEQ55"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> were estimated via a standard LMM maximum likelihood procedure for each combination of 9/10 of the folds, and the likelihood of the left-out fold conditional on the others was computed using the estimated model, under varying values of <italic>b</italic>. The selected value of <italic>b</italic> was the value that maximized the average out of sample likelihood across the 10 folds. The list of estimated values of <italic>b</italic> was [1,2,3…50, 60,70,80…250, 275,300,325…,500, 600,700…,1000].</p>
      </sec>
      <sec>
        <title>3.3.2 Real data results</title>
        <p>We first verified that all methods perform comparably with regards to type 1 error control, indicating a limited degree of genetic confounding in this data (<xref ref-type="fig" rid="btx248-F5">Fig. 5</xref>). Interestingly, MALAX-1g often estimated slightly lower <italic>P</italic>-values than MACAU, despite the close similarity of the models used by the two methods. Nevertheless, the <italic>P</italic>-values computed by MALAX-1g and by MACAU were highly correlated (Pearson correlation = 0.953, Spearman correlation = 0.924), leading to very similar rankings of the sites according to the two methods.</p>
        <fig id="btx248-F5" orientation="portrait" position="float">
          <label>Fig. 5</label>
          <caption>
            <p>A QQ plot of the <italic>P</italic>-values obtained by the evaluated methods in the analysis of the baboons data</p>
          </caption>
          <graphic xlink:href="btx248f5"/>
        </fig>
        <p>Next, we examined the effect of adding a second variance component, by comparing the results of MALAX-2 and MACAU. The correlation between the <italic>P</italic>-values computed by MALAX-2 and by MACAU (Pearson correlation = 0.889, Spearman correlation = 0.835) was substantially lower than between MALAX-1g and MACAU, as expected based on the difference between their underlying models. Additionally, there were several substantial differences between the top ranking <italic>P</italic>-values computed by MALAX-2 and by MACAU (<xref ref-type="fig" rid="btx248-F6">Fig. 6</xref>, <xref rid="btx248-T1" ref-type="table">Table 1</xref>). Namely, 2 of the 10 sites ranked highest by MACAU were ranked substantially lower by MALAX-2, possibly indicating spurious results. Notably, the site ranked highest by MACAU (chr17, locus 8 779 721) obtained a non-significant <italic>P</italic>-value of 0.15 by MALAX-2. In contrast, the 10 sites ranked highest by MALAX-2 all received <italic>P</italic>-values &lt; 8 × 10<sup>−5</sup> by MACAU, and were among its 700 top ranking sites. Although these results are suggestive that inclusion of a second variance component can be beneficial, additional in-depth analysis is required to verify the results obtained by the two methods.</p>
        <fig id="btx248-F6" orientation="portrait" position="float">
          <label>Fig. 6</label>
          <caption>
            <p>A Manhattan plot of the <italic>P</italic>-values obtained by the evaluated methods in the analysis of the baboons data. The axis labels for several chromosomes are omitted to improve clarity</p>
          </caption>
          <graphic xlink:href="btx248f6"/>
        </fig>
        <p>
          <table-wrap id="btx248-T1" orientation="portrait" position="float">
            <label>Table 1</label>
            <caption>
              <p>The top 10 sites found by MALAX-2 and MACAU in the analysis of the baboons data</p>
            </caption>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col valign="top" align="left" span="1"/>
                <col valign="top" align="char" char="." span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="char" char="." span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="char" char="." span="1"/>
                <col valign="top" align="char" char="." span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="center" span="1"/>
                <col valign="top" align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th colspan="6" rowspan="1">MALAX-2<hr/></th>
                  <th colspan="6" rowspan="1">MACAU<hr/></th>
                </tr>
                <tr>
                  <th rowspan="1" colspan="1">rank</th>
                  <th rowspan="1" colspan="1">chr</th>
                  <th rowspan="1" colspan="1">pos</th>
                  <th rowspan="1" colspan="1"><italic>P</italic>-value</th>
                  <th rowspan="1" colspan="1">alt. rank</th>
                  <th rowspan="1" colspan="1">alt. <italic>P</italic>-value</th>
                  <th rowspan="1" colspan="1">rank</th>
                  <th rowspan="1" colspan="1">chr</th>
                  <th rowspan="1" colspan="1">pos</th>
                  <th rowspan="1" colspan="1"><italic>P</italic>-value</th>
                  <th rowspan="1" colspan="1">alt. rank</th>
                  <th rowspan="1" colspan="1">alt. <italic>P</italic>-value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">19 531 653</td>
                  <td rowspan="1" colspan="1">5.10 × 10<sup>–12</sup></td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">1.09 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">17</td>
                  <td rowspan="1" colspan="1">8 779 721</td>
                  <td rowspan="1" colspan="1">9.57 × 10<sup>–12</sup></td>
                  <td rowspan="1" colspan="1">108 947</td>
                  <td rowspan="1" colspan="1">1.53E-01</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">76 782 787</td>
                  <td rowspan="1" colspan="1">8.61 × 10<sup>–11</sup></td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">1.30 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">13</td>
                  <td rowspan="1" colspan="1">127 550 470</td>
                  <td rowspan="1" colspan="1">2.23 × 10<sup>–11</sup></td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">1.92 × 10<sup>–10</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">43 268 737</td>
                  <td rowspan="1" colspan="1">1.37 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">2.92 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">19 531 653</td>
                  <td rowspan="1" colspan="1">1.09 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">5.10 × 10<sup>–12</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">15</td>
                  <td rowspan="1" colspan="1">4 962 834</td>
                  <td rowspan="1" colspan="1">1.81 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">11</td>
                  <td rowspan="1" colspan="1">2.18 × 10<sup>–8</sup></td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">76 782 787</td>
                  <td rowspan="1" colspan="1">1.30 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">8.61 × 10<sup>–11</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">13</td>
                  <td rowspan="1" colspan="1">127 550 470</td>
                  <td rowspan="1" colspan="1">1.92 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">2.23 × 10<sup>–11</sup></td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">43 268 737</td>
                  <td rowspan="1" colspan="1">2.92 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">1.37 × 10<sup>–10</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">13 480 448</td>
                  <td rowspan="1" colspan="1">3.75 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">42</td>
                  <td rowspan="1" colspan="1">2.93 × 10<sup>–7</sup></td>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">20</td>
                  <td rowspan="1" colspan="1">67 348 840</td>
                  <td rowspan="1" colspan="1">3.57 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">14</td>
                  <td rowspan="1" colspan="1">1.06 × 10<sup>–8</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">7</td>
                  <td rowspan="1" colspan="1">13</td>
                  <td rowspan="1" colspan="1">118 109 650</td>
                  <td rowspan="1" colspan="1">6.02 × 10<sup>–10</sup></td>
                  <td rowspan="1" colspan="1">47</td>
                  <td rowspan="1" colspan="1">3.62 × 10<sup>–7</sup></td>
                  <td rowspan="1" colspan="1">7</td>
                  <td rowspan="1" colspan="1">7</td>
                  <td rowspan="1" colspan="1">19 570 278</td>
                  <td rowspan="1" colspan="1">1.27 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">11</td>
                  <td rowspan="1" colspan="1">2.98 × 10<sup>–9</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">33 299 965</td>
                  <td rowspan="1" colspan="1">1.47 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">115</td>
                  <td rowspan="1" colspan="1">2.59 × 10<sup>–6</sup></td>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">20</td>
                  <td rowspan="1" colspan="1">67 035 039</td>
                  <td rowspan="1" colspan="1">4.88 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">50</td>
                  <td rowspan="1" colspan="1">3.13 × 10<sup>–7</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">16</td>
                  <td rowspan="1" colspan="1">48 764 429</td>
                  <td rowspan="1" colspan="1">2.18 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">1.63 × 10<sup>–8</sup></td>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">100 757 817</td>
                  <td rowspan="1" colspan="1">8.39 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">8043</td>
                  <td rowspan="1" colspan="1">2.75 × 10<sup>–3</sup></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">31 702 787</td>
                  <td rowspan="1" colspan="1">2.27 × 10<sup>–9</sup></td>
                  <td rowspan="1" colspan="1">696</td>
                  <td rowspan="1" colspan="1">7.58 × 10<sup>–5</sup></td>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">16</td>
                  <td rowspan="1" colspan="1">48 764 429</td>
                  <td rowspan="1" colspan="1">1.63 × 10<sup>–8</sup></td>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">2.18 × 10<sup>–9</sup></td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <fn id="tblfn1">
                <p>For each top site, we report its chromosome (chr), position (pos), rank and <italic>P</italic>-value under the main method and its rank and <italic>P</italic>-value under the alternative method.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
        </p>
        <p>We also evaluated the performance of two recently proposed methods for GLMM approximations (<xref rid="btx248-B5" ref-type="bibr">Chen <italic>et al.</italic>, 2016</xref>; <xref rid="btx248-B15" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>), and found that their reported top sites were substantially different from each other and from the top sites reported by MALAX and MACAU, which likely indicates low power on this dataset (results not shown).</p>
        <p>Finally, we evaluated the run time of the evaluated methods. The BB model completed the analysis in 4 hours, MALAX-2, MALAX-1g and MALAX-1m completed the analysis in 8.2, 7.45 and 7.77 h, respectively, and MACAU with default parameters competed the analysis in 23.6 h. These results demonstrate that MALAX can reduce the running time required to perform an epigenome-wide analysis by over 50%.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented MALAX, a novel method for association testing for count data, which is especially useful for analysis of data generated by bisulfite-sequencing. MALAX adopts the probabilistic model initially proposed by MACAU, but unlike MACAU, it can be used in the presence of multiple variance components representing diverse sources of confounding. Additionally, MALAX directly approximates the likelihood function via a Laplace approximation, and is thus both conceptually simpler and computationally faster than MACAU, which adopts a Bayesian framework and requires expensive MCMC-based analysis.</p>
    <p>Long read-sequencing technologies, such as the Pacific Biosciences and the Oxford Nanopore platforms (<xref rid="btx248-B13" ref-type="bibr">Goodwin <italic>et al.</italic>, 2016</xref>), may eventually replace bisulfite sequencing for EWAS purposes. However, analysis of methylation data via MALAX will remain useful as long as these technologies cannot probe methylation at a very high coverage at reasonable costs. We further point out that MALAX is a general technique for GLMM approximation. Consequently, MALAX can be readily adapted to other settings with non-normally distributed responses, such as analysis of gene expression data obtained via RNA sequencing (<xref rid="btx248-B27" ref-type="bibr">Sun <italic>et al.</italic>, 2016</xref>).</p>
    <p>In recent years, several methods for GLMM approximations have been proposed in statistical genetics and other domains: GMMAT (<xref rid="btx248-B5" ref-type="bibr">Chen <italic>et al.</italic>, 2016</xref>) and CARAT (<xref rid="btx248-B15" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>) are somewhat similar to MALAX but use simpler approximations, which lead to lower statistical power (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Variational approximation and Expectation Propagation are two methods which approximate the likelihood of GLMMs in a different manner than MALAX (<xref rid="btx248-B21" ref-type="bibr">Nickisch and Rasmussen, 2008</xref>), but are much slower and do not provide an advantage over MALAX in practice (results not shown). Finally, INLA (<xref rid="btx248-B25" ref-type="bibr">Rue <italic>et al.</italic>, 2009</xref>), adopts a Bayesian framework similarly to MACAU, but approximates the likelihood analytically similarly to MALAX. Our results indicate that such a Bayesian framework is not required for association testing, but we note that INLA might be useful should one wish to adopt a Bayesian framework without resorting to expensive MCMC computations.</p>
    <p>Although MALAX can be over 50% faster than MACAU, both methods have the same computational bottleneck of having to invert or compute determinants of matrices of size <italic>n</italic> × <italic>n</italic>, whose computation scales cubically with the sample size under standard implementations. Therefore, both methods cannot currently be used with samples of thousands of individuals. In the future, we intend to investigate the possibility to accelerate MALAX via low rank matrix approximations, using techniques such as the Nyström method (<xref rid="btx248-B10" ref-type="bibr">Drineas and Mahoney, 2005</xref>), incomplete Cholesky factorization (<xref rid="btx248-B12" ref-type="bibr">Fine and Scheinberg, 2001</xref>) or Bregman matrix divergence kernel learning (<xref rid="btx248-B19" ref-type="bibr">Kulis <italic>et al.</italic>, 2009</xref>).</p>
    <p>In this work, we evaluated several implementations of MALAX, which are differentiated by using different combinations of variance components. In practice, the use of MALAX requires domain knowledge in order to select the set of variance components that can control for all the sources of confounding in a given dataset, similarly to the use of LMMs in practice.</p>
    <p>Finally, the experiments in this paper used the technique of (<xref rid="btx248-B31" ref-type="bibr">Zou <italic>et al.</italic>, 2014</xref>) to construct a matrix of methylation similarities, which can potentially capture sources of confounding such as cell-type composition. Recently, another technique has been demonstrated to improve control for cell-type composition by first selecting a subset of the methylation sites, and then incorporating the top principal components of the selected sites as covariates (<xref rid="btx248-B23" ref-type="bibr">Rahmani <italic>et al.</italic>, 2016</xref>). However, both methods suffer from the caveat that there is currently no analytical proof or empirical evidence that they are suitable for the analysis of bisulfite-sequencing data. Specifically, a major difficulty is that computation of methylation similarity matrices and of their principal components is unreliable in the presence of a small number of reads. Adapting one of the above techniques for bisulfite-sequencing data therefore remains a future endeavor.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx248_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This research was partially supported by the Edmond J. Safra Center for Bioinformatics at Tel Aviv University. E.H., and R.S. and E.R. were supported in part by the Israel Science Foundation [Grant 1425/13], E.H. and R.S. by the US Israel Binational Science Foundation grant 2012304, E.R. by Len Blavatnik and the Blavatnik Research Foundation, R.S. by the Colton Family Foundation, and S.R. by the Israeli Science Foundation [grants 1487/12 and 1804/16].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btx248-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Balding</surname><given-names>D.J.</given-names></name>, <name name-style="western"><surname>Nichols</surname><given-names>R.A.</given-names></name></person-group> (<year>1995</year>) 
<article-title>A method for quantifying differentiation between populations at multi-allelic loci and its implications for investigating identity and paternity</article-title>. <source>Genetica</source>, <volume>96</volume>, <fpage>3</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">7607457</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Behnel</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Cython: the best of both worlds</article-title>. <source>Comput. Sci. Eng</source>., <volume>13</volume>, <fpage>31</fpage>–<lpage>39</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bird</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Perceptions of epigenetics</article-title>. <source>Nature</source>, <volume>447</volume>, <fpage>396</fpage>–<lpage>398</lpage>.<pub-id pub-id-type="pmid">17522671</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Byrd</surname><given-names>R.H.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) 
<article-title>A limited memory algorithm for bound constrained optimization</article-title>. <source>SIAM J. Sci. Comput</source>, <volume>16</volume>, <fpage>1190</fpage>–<lpage>1208</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models</article-title>. <source>Am. J. Hum. Genet</source>., <volume>98</volume>, <fpage>653</fpage>–<lpage>666</lpage>.<pub-id pub-id-type="pmid">27018471</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cohen</surname><given-names>K.A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Paradoxical hypersusceptibility of drug-resistant m. tuberculosis to <italic>β</italic>-lactam antibiotics</article-title>. <source>EBioMedicine</source>, <volume>9</volume>, <fpage>170</fpage>–<lpage>179</lpage>.<pub-id pub-id-type="pmid">27333036</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cokus</surname><given-names>S.J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>. <source>Nature</source>, <volume>452</volume>, <fpage>215</fpage>–<lpage>219</lpage>.<pub-id pub-id-type="pmid">18278030</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Devlin</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Roeder</surname><given-names>K.</given-names></name></person-group> (<year>1999</year>) 
<article-title>Genomic control for association studies</article-title>. <source>Biometrics</source>, <volume>55</volume>, <fpage>997</fpage>–<lpage>1004</lpage>.<pub-id pub-id-type="pmid">11315092</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dolzhenko</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>A.D.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Using beta-binomial regression for high-precision differential methylation analysis in multifactor whole-genome bisulfite sequencing experiments</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>215.</fpage><pub-id pub-id-type="pmid">24962134</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drineas</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Mahoney</surname><given-names>M.W.</given-names></name></person-group> (<year>2005</year>) 
<article-title>On the Nyström method for approximating a gram matrix for improved kernel-based learning</article-title>. <source>J. Mach. Learn. Res</source>., <volume>6</volume>, <fpage>2153</fpage>–<lpage>2175</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Feng</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A Bayesian hierarchical model to detect differentially methylated loci from single nucleotide resolution sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>e69.</fpage><pub-id pub-id-type="pmid">24561809</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fine</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Scheinberg</surname><given-names>K.</given-names></name></person-group> (<year>2001</year>) 
<article-title>Efficient SVM training using low-rank kernel representations</article-title>. <source>J. Mach. Learn. Res</source>., <volume>2</volume>, <fpage>243</fpage>–<lpage>264</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goodwin</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>333</fpage>–<lpage>351</lpage>.<pub-id pub-id-type="pmid">27184599</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaffe</surname><given-names>A.E.</given-names></name>, <name name-style="western"><surname>Irizarry</surname><given-names>R.A.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Accounting for cellular heterogeneity is critical in epigenome-wide association studies</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>1.</fpage></mixed-citation>
    </ref>
    <ref id="btx248-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Retrospective binary-trait association test elucidates genetic architecture of Crohn disease</article-title>. <source>Am. J. Hum. Genet</source>., <volume>98</volume>, <fpage>243</fpage>–<lpage>255</lpage>.<pub-id pub-id-type="pmid">26833331</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>). Scipy: Open source scientific tools for Python. <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www. scipy. org/</ext-link> (30 December 2016, date last accessed).</mixed-citation>
    </ref>
    <ref id="btx248-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>P.A.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Functions of DNA methylation: islands, start sites, gene bodies and beyond</article-title>. <source>Nat. Rev. Genet</source>., <volume>13</volume>, <fpage>484</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">22641018</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Kahaner</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>1989</year>). <source>Numerical Methods and Software, Vol</source>. <volume>1</volume><italic>.</italic><publisher-loc>Englewood Cliffs</publisher-loc>, 
<publisher-name>Prentice Hall</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btx248-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kulis</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Low-rank kernel learning with Bregman matrix divergences</article-title>. <source>J. Mach. Learn. Res</source>., <volume>10</volume>, <fpage>341</fpage>–<lpage>376</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lea</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A flexible, efficient binomial mixed model for identifying differential dna methylation in bisulfite sequencing data</article-title>. <source>PLoS Genet</source>., <volume>11</volume>, <fpage>e1005650.</fpage><pub-id pub-id-type="pmid">26599596</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nickisch</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Rasmussen</surname><given-names>C.E.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Approximations for binary Gaussian process classification</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2035</fpage>–<lpage>2078</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Powell</surname><given-names>J.E.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Congruence of additive and non-additive effects on gene expression estimated from pedigree and SNP data</article-title>. <source>PLoS Genet</source>., <volume>9</volume>, <fpage>e1003502.</fpage><pub-id pub-id-type="pmid">23696747</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rahmani</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Sparse PCA corrects for cell type heterogeneity in epigenome-wide association studies</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>443</fpage>–<lpage>445</lpage>.<pub-id pub-id-type="pmid">27018579</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Rasmussen</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>C.</given-names></name></person-group> (<year>2006</year>). <source>Gaussian Processes for Machine Learning</source>. 
<publisher-name>The MIT Press, Cambridge, MA</publisher-name>. </mixed-citation>
    </ref>
    <ref id="btx248-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rue</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>71</volume>, <fpage>319</fpage>–<lpage>392</lpage>.</mixed-citation>
    </ref>
    <ref id="btx248-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>MOABS: model based analysis of bisulfite sequencing data</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R38.</fpage><pub-id pub-id-type="pmid">24565500</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Differential expression analysis for RNAseq using Poisson mixed models</article-title>. <source>Nucleic Acids Res.</source>, In press.</mixed-citation>
    </ref>
    <ref id="btx248-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weissbrod</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Accurate liability estimation improves power in ascertained case-control studies</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>332</fpage>–<lpage>334</lpage>.<pub-id pub-id-type="pmid">25664543</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Widmer</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Further improvements to linear mixed models for genome-wide association studies</article-title>. <source>Sci. Rep</source>., <volume>4</volume>, <fpage>6874.</fpage><pub-id pub-id-type="pmid">25387525</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Advantages and pitfalls in the application of mixed-model association methods</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>100</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">24473328</pub-id></mixed-citation>
    </ref>
    <ref id="btx248-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zou</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Epigenome-wide association studies without the need for cell-type composition</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>309</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">24464286</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
