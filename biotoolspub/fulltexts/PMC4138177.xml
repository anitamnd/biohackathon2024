<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4138177</article-id>
    <article-id pub-id-type="pmid">25137074</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-17784</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0105015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
            <subject>Evolutionary Modeling</subject>
            <subject>Genome Analysis</subject>
            <subject>Genome Evolution</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subject>Evolutionary Theory</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Data Management</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Orthology Detection Combining Clustering and Synteny for Very Large Datasets</article-title>
      <alt-title alt-title-type="running-head">Combining Clustering and Synteny for Orthology Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lechner</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hernandez-Rosales</surname>
          <given-names>Maribel</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Doerr</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wieseke</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="aff8">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thévenin</surname>
          <given-names>Annelyse</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stoye</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hartmann</surname>
          <given-names>Roland K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prohaska</surname>
          <given-names>Sonja J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff9">
          <sup>9</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff10">
          <sup>10</sup>
        </xref>
        <xref ref-type="aff" rid="aff11">
          <sup>11</sup>
        </xref>
        <xref ref-type="aff" rid="aff12">
          <sup>12</sup>
        </xref>
        <xref ref-type="aff" rid="aff13">
          <sup>13</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Institut für Pharmazeutische Chemie, Philipps-Universität Marburg, Marburg, Germany</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Bioinformatics Group, Department of Computer Science, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Interdisciplinary Center for Bioinformatics, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>Max Planck Institute for Mathematics in the Sciences, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff5">
      <label>5</label>
      <addr-line>Departamento de Ciência da Computação, Instituto de Ciências Exatas, Universidade de Brasília, Brasília, Brasil</addr-line>
    </aff>
    <aff id="aff6">
      <label>6</label>
      <addr-line>Genome Informatics, Faculty of Technology, Bielefeld University, Bielefeld, Germany</addr-line>
    </aff>
    <aff id="aff7">
      <label>7</label>
      <addr-line>Institute for Bioinformatics, Center for Biotechnology, Bielefeld University, Bielefeld, Germany</addr-line>
    </aff>
    <aff id="aff8">
      <label>8</label>
      <addr-line>Faculty of Mathematics and Computer Science University of Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff9">
      <label>9</label>
      <addr-line>Computational EvoDevo Group, Department of Computer Science, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff10">
      <label>10</label>
      <addr-line>Institute for Theoretical Chemistry, University of Vienna, Vienna, Austria</addr-line>
    </aff>
    <aff id="aff11">
      <label>11</label>
      <addr-line>Center for non-coding RNA in Technology and Health, University of Copenhagen, Frederiksberg, Denmark</addr-line>
    </aff>
    <aff id="aff12">
      <label>12</label>
      <addr-line>The Santa Fe Institute, Santa Fe, New Mexico, United States of America</addr-line>
    </aff>
    <aff id="aff13">
      <label>13</label>
      <addr-line>RNomics Group, Fraunhofer Institut for Cell Therapy and Immunology, Leipzig, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hellas, Greece</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>lechner@staff.uni-marburg.de</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: ML MHR JS SJP PFS. Analyzed the data: ML. Contributed reagents/materials/analysis tools: ML MHR DD AT NW. Contributed to the writing of the manuscript: ML RKH PFS. Performed the simulations: ML DD. Read and approved the final manuscript: ML MHR DD NW AT JS RKH SJP PFS.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>8</issue>
    <elocation-id>e105015</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Lechner et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Lechner et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The elucidation of orthology relationships is an important step both in gene function prediction as well as towards understanding patterns of sequence evolution. Orthology assignments are usually derived directly from sequence similarities for large data because more exact approaches exhibit too high computational costs. Here we present <monospace>PoFF</monospace>, an extension for the standalone tool <monospace>Proteinortho</monospace>, which enhances orthology detection by combining clustering, sequence similarity, and synteny. In the course of this work, <monospace>FFAdj-MCS</monospace>, a heuristic that assesses pairwise gene order using adjacencies (a similarity measure related to the breakpoint distance) was adapted to support multiple linear chromosomes and extended to detect duplicated regions. <monospace>PoFF</monospace> largely reduces the number of false positives and enables more fine-grained predictions than purely similarity-based approaches. The extension maintains the low memory requirements and the efficient concurrency options of its basis <monospace>Proteinortho</monospace>, making the software applicable to very large datasets.</p>
    </abstract>
    <funding-group>
      <funding-statement>We acknowledge support for the Article Processing Charge by the German Research Foundation and the Open Access Publication Fund of Bielefeld University Library. This work was supported in part by the Deutsche Forschungsgemeinschaft grants no. GRK-1384, MA5082/1- 1, MI439/14-1. DD receives a scholarship from the CLIB Graduate Cluster Industrial Biotechnology. AT is a research fellow of the Alexander von Humboldt Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files. The source code of PoFF as well as the Online Supplemental Material can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/poff/">http://www.bioinf.uni-leipzig.de/Software/poff/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files. The source code of PoFF as well as the Online Supplemental Material can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/poff/">http://www.bioinf.uni-leipzig.de/Software/poff/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Detailed knowledge on the history of large gene families is crucial to the understanding of their patterns of sequence evolution and their functional interpretation. Throughout this contribution we use the term “gene” to denote any genomic feature that can be represented as a sequence interval. No further functional or structural properties are implied. An important step towards this goal is the elucidation of orthology relationships. Two genes are <underline>orthologs</underline> if they arose via a speciation event from their last common ancestor in the gene tree. In contrast, <underline>paralogs</underline> originate from a gene duplication event <xref rid="pone.0105015-Fitch1" ref-type="bibr">[1]</xref>, <xref rid="pone.0105015-Fitch2" ref-type="bibr">[2]</xref>. The definition of orthology implies that an event-annotated gene tree is available, and thus a gene tree and its reconciliation with the underlying species tree must be known to determine with certainty which pairs of genes are orthologs. Since ancestral states are in general experimentally inaccessible, the orthology relation, just like the gene phylogeny, has to be inferred from extant sequence data.</p>
    <p>A large class of orthology detection tools therefore attempts to explicitly infer gene phylogenies and their reconciliation with species trees, e.g. <monospace>Orthology analysis using MCMC</monospace>
<xref rid="pone.0105015-Arvestad1" ref-type="bibr">[3]</xref>, <monospace>MultiMSOAR</monospace>
<xref rid="pone.0105015-Shi1" ref-type="bibr">[4]</xref>, <monospace>LOFT</monospace>
<xref rid="pone.0105015-vanderHeijden1" ref-type="bibr">[5]</xref>, <monospace>Ensembl Compara</monospace>
<xref rid="pone.0105015-Hubbard1" ref-type="bibr">[6]</xref>, and <monospace>Synergy</monospace>
<xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. Although this tree-based approach is often considered the most accurate, it suffers from high computational costs and is hence limited in practice to a moderate number of species and genes. Moreover, all practical issues that hamper phylogenetic inference (e.g. variability of evolutionary rate, mistaken homology, homoplasy, and horizontal gene transfer) limit the accuracy of both the gene and the species trees.</p>
    <p>The second class of algorithms bypasses the construction of gene and species trees by directly deriving orthology assignments from similarity data. Approaches of this type are <monospace>COG</monospace>
<xref rid="pone.0105015-Tatusov1" ref-type="bibr">[8]</xref>, <monospace>OrthoMCL</monospace>
<xref rid="pone.0105015-Li1" ref-type="bibr">[9]</xref>, <xref rid="pone.0105015-Chen1" ref-type="bibr">[10]</xref>, <monospace>OMA</monospace>
<xref rid="pone.0105015-Schneider1" ref-type="bibr">[11]</xref>, <xref rid="pone.0105015-Altenhoff1" ref-type="bibr">[12]</xref>, <monospace>InParanoid</monospace>
<xref rid="pone.0105015-Berglund1" ref-type="bibr">[13]</xref>, <monospace>eggNOG</monospace>
<xref rid="pone.0105015-Jensen1" ref-type="bibr">[14]</xref>, <monospace>HomoloGene</monospace>
<xref rid="pone.0105015-Wheeler1" ref-type="bibr">[15]</xref>, <monospace>Roundup</monospace> 2.0 <xref rid="pone.0105015-DeLuca1" ref-type="bibr">[16]</xref>, or <monospace>EGM2</monospace>
<xref rid="pone.0105015-Mahmood1" ref-type="bibr">[17]</xref>. Since orthology is not a transitive relation, the problem of orthology detection is fundamentally different from clustering or partitioning of the input gene set. In particular, a set <italic>A</italic> of genes can be orthologous to another gene <inline-formula><inline-graphic xlink:href="pone.0105015.e001.jpg"/></inline-formula> but the genes within <italic>A</italic> are not necessarily orthologous to each other. In this case, the genes in <italic>A</italic> are called co-orthologs to gene <italic>x</italic>
<xref rid="pone.0105015-Koonin1" ref-type="bibr">[18]</xref>. A common feature of most of the methods mentioned above is that they do not produce an estimate for the pairwise orthology relations but return orthologous groups containing genes which are mutually orthologous to the greatest extent but also comprise co-orthologous genes. We refer to these groups as orthologous groups in the following. In addition to <monospace>OMA</monospace> and <monospace>Proteinortho</monospace>
<xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref>, only <monospace>Synergy</monospace>, <monospace>EGM2</monospace>, and <monospace>InParanoid</monospace> attempt to resolve the orthology relation at the level of gene pairs. The latter two tools can only be used for the analysis of two species at a time, while <monospace>Synergy</monospace> is not available as standalone tool and therefore cannot be applied to arbitrary user-defined datasets. The use of these tools is limited to the species offered through the databases published by their authors.</p>
    <p>The orthology relation can be represented as a graph on the set of genes. It forms a cograph rather than a partition <xref rid="pone.0105015-Hellmuth1" ref-type="bibr">[20]</xref>. Clustering approaches identify dense subgraphs of these cographs and hence introduce false-positive edges corresponding to recent paralogs. On the other hand, ancient paralogs are often separated into different groups of co-orthologs. Despite this theoretical shortcoming, cluster-based methods have consistently been reported to yield very good results <xref rid="pone.0105015-Altenhoff2" ref-type="bibr">[21]</xref>–<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref>. Since they are much faster than tree-based algorithms, they can be applied to very large datasets.</p>
    <p>The clustering method and, in many cases, user-defined parameters determine the granularity of the orthologous groups and thus the tolerance to false positive orthology assignments. Some methods are very inclusive <xref rid="pone.0105015-vanderHeijden1" ref-type="bibr">[5]</xref>, but the aim typically is to remove as many paralogs as possible to approach a one-to-one orthology relation. These simple relationships are especially useful for phylogenetic analysis and for exact functional predictions. Phylogenomic studies typically employ pipelines such as <monospace>HaMStR</monospace>
<xref rid="pone.0105015-Ebersberger1" ref-type="bibr">[24]</xref> to restrict the data to one-to-one orthologs. When the phylogenetic range of interest includes duplication events however, such approaches are bound to fail <xref rid="pone.0105015-Shi2" ref-type="bibr">[25]</xref>.</p>
    <p>Here we focus on an intermediate balance. Our main aim is to avoid false positive orthology assignments within the phylogenetic range of the reported orthologous groups, while we tolerate recent in-paralogs (speciation preceding duplication) as unavoidable contamination. Clustering approaches for orthology detection are usually based on the “best match method”, which attempts to find orthologs as the sequence in another genome that is most similar to the query. It often fails in the presence of paralogs with comparable similarity to the query. Best match approaches are nevertheless routinely used to gain insight into relationships of genes among phylogenetically very diverse organisms. These approaches are used in particular for gene annotation in newly sequenced genomes for which a well studied close relative is lacking. However, the large number of sequencing projects of the last decade have largely reduced the gaping holes in phylogenetic coverage and most large-scale comparative studies nowadays focus on closely related species or even strains <xref rid="pone.0105015-Grigoriev1" ref-type="bibr">[26]</xref>, <xref rid="pone.0105015-Cao1" ref-type="bibr">[27]</xref>. As a result, the evolutionary distances within a phylogeny of interest are often rather small, hence additional information to resolve evolutionary relationships between genes can be obtained from genomic context. Furthermore synteny, i.e., the conservation of gene order (also referred to as gene context) provides information independent of sequence similarity, which can help to sort paralogs. Both <monospace>Synergy</monospace> and <monospace>EGM2</monospace> incorporate synteny information to compute orthology relations. The <monospace>Synergy</monospace> algorithm achieves high accuracy due to the fact that it reconstructs gene family trees <xref rid="pone.0105015-Wapinski2" ref-type="bibr">[28]</xref>. <monospace>EGM2</monospace> considers synteny by identifying similar genomic regions to detect orthologs. However, this tool is not suitable for large datasets due to its restriction to only two genomes at a time. Genes with a common ancestry that are functionally linked with each other frequently show a conservation in local gene order over long evolutionary distances <xref rid="pone.0105015-Dandekar1" ref-type="bibr">[29]</xref>, <xref rid="pone.0105015-Suyama1" ref-type="bibr">[30]</xref>. Thus, synteny is frequently used to disentangle complex duplication histories, see e.g. <xref rid="pone.0105015-Lehmann1" ref-type="bibr">[31]</xref> and references therein. The intricacies of conserved synteny and positional orthology have been reviewed recently <xref rid="pone.0105015-Dewey1" ref-type="bibr">[32]</xref>.</p>
    <p>The computational prediction of syntenic regions usually relies on the detection of genomic neighborhoods that are conserved between genomes of related species. Proximity relations among genes, such as adjacencies <xref rid="pone.0105015-Waterson1" ref-type="bibr">[33]</xref> (two genes encoded adjacent to each other in several genomes), generalized adjacencies <xref rid="pone.0105015-Bergeron1" ref-type="bibr">[34]</xref> or conserved intervals <xref rid="pone.0105015-Bergeron2" ref-type="bibr">[35]</xref>, are used to assess genomic neighborhoods. Typical methods for the detection of syntenic regions utilize gene family information, similarity scores or conserved distances to establish putative homologies and then apply chaining or clustering algorithms. When paralogous genes are considered, the underlying computational problems become prohibitive because many alternative synteny assignments are possible. Exact algorithms are therefore slow and limited to small datasets. In fact, the problem of computing the syntenic distance between two genomes is NP-hard <xref rid="pone.0105015-LibenNowell1" ref-type="bibr">[36]</xref>, <xref rid="pone.0105015-Ting1" ref-type="bibr">[37]</xref>. Efficient heuristics are therefore employed to deal with large datasets.</p>
    <p>If gene family information is available, popular synteny tools such as <monospace>i-ADHoRe 3.0</monospace>
<xref rid="pone.0105015-Proost1" ref-type="bibr">[38]</xref> and <monospace>MCScanX</monospace>
<xref rid="pone.0105015-Wang1" ref-type="bibr">[39]</xref> can efficiently detect homologous regions even in large-scale analyses. Otherwise, using local alignments of sequences, tools such as <monospace>CYNTENATOR</monospace>
<xref rid="pone.0105015-Roedelsperger1" ref-type="bibr">[40]</xref> and <monospace>DAGchainer</monospace>
<xref rid="pone.0105015-Haas1" ref-type="bibr">[41]</xref> allow for detection of syntenic regions based on pairwise similarity scores of sequence intervals. The heuristic method <monospace>FFAdj-MCS</monospace>
<xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref> has proven to be a good compromise in terms of both, speed and accuracy, as it takes a different approach by calculating a matching whose objective function maximizes towards a balance between adjacencies and similarity scores of genes.</p>
    <p>In this contribution we describe <monospace>PoFF</monospace>, an extension of <monospace>Proteinortho</monospace>
<xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref>, to include synteny information in a systematic way. More precisely, a pair of genes (<italic>A</italic>1, <italic>A</italic>2) in genome <italic>A</italic> is considered syntenous with another pair of genes (<italic>B</italic>1, <italic>B</italic>2) in genome <italic>B</italic>, if both <italic>A</italic>1, <italic>B</italic>1 and <italic>A</italic>2, <italic>B</italic>2 are potential orthologs (as determined by sequence similarity), and both (<italic>A</italic>1, <italic>A</italic>2) as well as (<italic>B</italic>1, <italic>B</italic>2) are adjacent gene pairs on their corresponding chrosomosomal locations. In case other genes are located between (<italic>A</italic>1, <italic>A</italic>2) or (<italic>B</italic>1, <italic>B</italic>2), these must not be orthologous to any other genes in genomes <italic>A</italic> or <italic>B</italic>. <monospace>Proteinortho</monospace> applies an adaptive best match method together with spectral clustering to define (co-)orthologs. Its performance in terms of accuracy has been shown to be comparable to other clustering-based methods. At the same time it has modest requirements in terms of memory and computation time and is thus suitable for very large datasets. Complementing the evaluation of pairwise sequence similarities, we incorporate here the efficient heuristic algorithm <monospace>FFAdj-MCS</monospace> that computes ortholog assignments by maximizing the above synteny measure between pairs of genomes. Following a recent suggestion <xref rid="pone.0105015-Braga1" ref-type="bibr">[43]</xref>, true orthologs among multiple candidates were defined as those that retained their original genomic context. In the course of this work, we adapted <monospace>FFAdj-MCS</monospace> to include multiple linear chromosomes within single organisms and extended it for the detection of duplicated genes and large duplicated genomic regions. We note that the algorithm may also be applied to circular chromosomes at the expense of losing synteny information for at most two pairs of genes at the very ends of the linearized representation. This minor shortcoming should have no or only a vanishingly low effect in the overall process of orthology assignment.</p>
    <p><xref ref-type="fig" rid="pone-0105015-g001">Figure 1</xref> illustrates the idea of the synteny-enhanced version of <monospace>Proteinortho</monospace>. In this example, four genes (<italic>A</italic>1, <italic>A</italic>2, <italic>B</italic>1, <italic>B</italic>2) in two species (<italic>A</italic> and <italic>B</italic>) are considered. The gene tree in <xref ref-type="fig" rid="pone-0105015-g001">Figure 1a</xref> shows a duplication preceding a speciation event. <italic>A</italic>1 and <italic>B</italic>1 as well as <italic>A</italic>2 and <italic>B</italic>2 are orthologous to each other as they derived from a common ancestor by speciation. Given sufficient similarity, however, all four genes would be reported as an orthologous group using regular sequence similarity-based approaches. The gene order depicted in <xref ref-type="fig" rid="pone-0105015-g001">Figure 1b</xref> allows one to distinguish the genes 1 and 2 from each other. The combined approach therefore predicts the two distinct orthologous groups {<italic>A</italic>1, <italic>B</italic>1} and {<italic>A</italic>2, <italic>B</italic>2} and thus avoids false positive orthology assignments.</p>
    <fig id="pone-0105015-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Synteny-enhanced orthology prediction.</title>
        <p>Four genes (<italic>A</italic>1, <italic>A</italic>2, <italic>B</italic>1, <italic>B</italic>2) in two species (<italic>A</italic> and <italic>B</italic>). a) The gene tree with a duplication (filled double circle) and a speciation event (empty circle). b) Gene order in the genomic context of both genes. Genes <italic>A'x</italic> and <italic>B'x</italic> are orthologous to each other. Lines depict suggested partners based on sequence similarity of which the dashed were neglected by the gene order algorithm.</p>
      </caption>
      <graphic xlink:href="pone.0105015.g001"/>
    </fig>
    <p>We argue that the level of granularity achieved in this way is more useful in most cases than an arbitrary separation of groups solely based on sequence similarity scores which tend to lack significance when sequences are closely related. The same holds compared to inclusive strategies which hardly discriminate subgroups. Assuming that numerous extant genes have derived from a limited set of common ancestors by a series of duplication events, inclusive strategies will include entire gene families, and hence lead to very large groups with a significant amount of actually non-orthologous genes. An emphasis on including all pairwise orthology relations when reporting orthologous groups thus seems to be of little use.</p>
    <p>We evaluated <monospace>PoFF</monospace> using several sets of simulated protein-coding genes. Each set was derived from event-annotated gene trees. Thus, for each pair of genes, the true relationship regarding orthology is unambiguously defined and used to validate the predictions. Our results reveal a significant improvement with respect to true negative and false positive predictions at the expense of only a marginal decrease of the true positive rate.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2a">
      <title>Conceptual Outline</title>
      <p>Our starting point for orthology detection is a directed graph <inline-formula><inline-graphic xlink:href="pone.0105015.e002.jpg"/></inline-formula> whose vertices are all the genes of all input genomes. A directed edge <inline-formula><inline-graphic xlink:href="pone.0105015.e003.jpg"/></inline-formula> is introduced if (i) <italic>x</italic> and <italic>y</italic> are taken from two different genomes (<italic>A</italic> and <italic>B</italic>) and (ii) the similarity <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) is not much smaller than the gene <italic>z</italic> in <italic>B</italic> that is most similar to <italic>x</italic>, i.e., if <inline-formula><inline-graphic xlink:href="pone.0105015.e004.jpg"/></inline-formula> for some stringency parameter <italic>f</italic>≤1. Since any true ortholog of <inline-formula><inline-graphic xlink:href="pone.0105015.e005.jpg"/></inline-formula> in genome <italic>B</italic> should be among the most similar sequences that can be found in <italic>B</italic>, <inline-formula><inline-graphic xlink:href="pone.0105015.e006.jpg"/></inline-formula> should have few false negatives (i.e. missing true edges) as long as the stringency is not set to a value that is too restrictive. The idea is, therefore, to remove edges from the graph <inline-formula><inline-graphic xlink:href="pone.0105015.e007.jpg"/></inline-formula> that are likely false positives. Since orthology is a symmetric relation, we only retain edges <inline-formula><inline-graphic xlink:href="pone.0105015.e008.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0105015.e009.jpg"/></inline-formula> is also contained in <inline-formula><inline-graphic xlink:href="pone.0105015.e010.jpg"/></inline-formula>.</p>
      <p>Synteny information determined by <monospace>FFAdj-MCS</monospace> provides an additional filter for the edge set of <inline-formula><inline-graphic xlink:href="pone.0105015.e011.jpg"/></inline-formula>. By construction, the subgraph <inline-formula><inline-graphic xlink:href="pone.0105015.e012.jpg"/></inline-formula> induced by the genes in <italic>A</italic> and <italic>B</italic> is bipartite. Synteny is modeled as the relative order of edges along both genomes. Synteny as a filter reduces the edge set of <inline-formula><inline-graphic xlink:href="pone.0105015.e013.jpg"/></inline-formula> to a matching that maximizes a trade-off between the total number of edges and the number of conserved adjacencies. Among similar paralogs, this strategy favors the one with the best-conserved local gene order as representative of the orthologous group. In the final step, a clustering algorithm <xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref> is employed to extract groups of co-orthologs from <inline-formula><inline-graphic xlink:href="pone.0105015.e014.jpg"/></inline-formula>, which contains all subgraphs <inline-formula><inline-graphic xlink:href="pone.0105015.e015.jpg"/></inline-formula> for all pairs of genomes.</p>
    </sec>
    <sec id="s2b">
      <title>Implementation</title>
      <p><monospace>Proteinortho</monospace> uses the <monospace>blast</monospace> bit score to determine potential homologs in another species and to measure sequence similarity. The definition of the edge set above makes it possible to construct <inline-formula><inline-graphic xlink:href="pone.0105015.e016.jpg"/></inline-formula> directly from pairwise comparisons. Thus, this initial state can be trivially parallelized and does not require the storage of genome-wide <monospace>blast</monospace> comparison data in memory. As the <monospace>FFAdj-MCS</monospace> algorithm applies to pairs of genomes <italic>A</italic> and <italic>B</italic>, it can be added to the workflow without breaking these advantageous properties. The algorithm requires information on gene order and pairwise gene similarity for two genomes and determines a matching that maximizes a weighted sum of edge weights and weights of conserved adjacencies. To this end <monospace>FFAdj-MCS</monospace> matches genes in regions with conserved gene order that locally maximize the objective of <monospace>FF-Adjacencies</monospace>
<xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref>. These regions are called <underline>maximum common substrings</underline> (MCSs). Since the <monospace>blast</monospace> scores <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) are not symmetric, they are symmetrized (taking the average of both scores) for use in <monospace>FFAdj-MCS</monospace>. The combination <monospace>PoFF</monospace> of <monospace>Proteinortho</monospace> and <monospace>FFAdj-MCS</monospace> yields, for each pair of genomes, a pruned set of edges that is highly enriched in true orthologous pairs. The workflow of our extension is illustrated in <xref ref-type="fig" rid="pone-0105015-g002">Figure 2</xref>.</p>
      <fig id="pone-0105015-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Workflow of <monospace>PoFF</monospace>.</title>
          <p>Similar gene sequences are determined by an all-against-all blast search. Top reciprocal matches are ordered by their positions in the respective genomes. The <monospace>FFAdj-MCS</monospace> algorithm is applied to determine the maximum matching with respect to sequence similarity and gene order. As a result the orthology graph <inline-formula><inline-graphic xlink:href="pone.0105015.e017.jpg"/></inline-formula> only contains the remaining edges from pairwise comparisons. Finally, orthologous groups are extracted by clustering.</p>
        </caption>
        <graphic xlink:href="pone.0105015.g002"/>
      </fig>
      <p>We added three extensions to the <monospace>FFAdj-MCS</monospace> program as presented in <xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref>. Firstly, it was adapted to allow for more than one chromosome per genome. Secondly, the detection of duplicated genes and large duplicated regions was implemented: The heuristic was adapted to repeat a user-defined number of complete matchings, where edges selected by preceding matchings are removed before each subsequent matching. Thirdly, <monospace>FFAdj-MCS</monospace> allows to filter the size of MCSs obtained from subsequent matchings by means of a user-defined minimal size <inline-formula><inline-graphic xlink:href="pone.0105015.e018.jpg"/></inline-formula> that defines the minimum number of gene pairs in each MCS.</p>
      <p>Finally, we relaxed the criteria for very similar neighboring genes: If two adjacent genes <italic>x</italic> and <italic>y</italic> in <italic>A</italic> both have their best alignment to the same gene <inline-formula><inline-graphic xlink:href="pone.0105015.e019.jpg"/></inline-formula>, we include both edges {<italic>x</italic>, <italic>y</italic>} and {<italic>y</italic>, <italic>z</italic>} in <inline-formula><inline-graphic xlink:href="pone.0105015.e020.jpg"/></inline-formula>, since <italic>x</italic> and <italic>y</italic> are likely in-paralogs and a decision for one of the two edges based on a small score difference is not reasonable from a biological perspective. Even though this makes <monospace>PoFF</monospace> more inclusive, we argue that this behavior is more reasonable because such in-paralogs can be quite easily detected in a post-processing step if required for a particular application.</p>
      <p><monospace>PoFF</monospace> has several parameters that can be set by the user – in particular score thresholds and coverage requirements of the <monospace>blast</monospace> searches. We used the default settings throughout. The stringency parameter <italic>f</italic> defines the fraction of the bit score of the best <monospace>blast</monospace> hit that must be reached by an alternative candidate ortholog. <monospace>Proteinortho</monospace>'s default value, <italic>f</italic> = 0.95, has been shown to work also in conjunction with the synteny filter. The <monospace>FFAdj-MCS</monospace> algorithm provides an adjustable parameter <inline-formula><inline-graphic xlink:href="pone.0105015.e021.jpg"/></inline-formula> that controls the relative importance of edge weights and the weights of adjacencies. Benchmarking <monospace>PoFF</monospace> did not reveal a strong dependency of the results on this parameter, likely because nucleotide sequences and order of genes evolve in parallel and with comparable speeds. We therefore used the default value <inline-formula><inline-graphic xlink:href="pone.0105015.e022.jpg"/></inline-formula> throughout. By default, we perform one matching iteration with <inline-formula><inline-graphic xlink:href="pone.0105015.e023.jpg"/></inline-formula> to cover the detection of large duplicated regions. If multiple copies of a region are expected in a dataset, this number of iterative matchings can be increased further. Practical experience with <monospace>Proteinortho</monospace> also led to the decision to increase the default E-value threshold from 10<sup>−10</sup> to 10<sup>−5</sup> in order to improve coverage of less conserved orthologs.</p>
    </sec>
    <sec id="s2c">
      <title>Benchmarking</title>
      <p>Since implementations of competing tools that generate fully resolved orthology relations are not publicly available, we cannot employ the usual evaluation strategy of comparing all tools on series of benchmarking datasets of our choice. Instead we apply both <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> to several reference datasets that either comprise simulated data for which the underlying gene trees are known, or real data which defines orthologous groups and/or pairwise orthologous relationships by extensive analysis, often including manual curation. Results are then compared to the published performance of alternative tools.</p>
      <p>For <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> we used standard parameters, including an E-value threshold of 10<sup>−5</sup>. However, the more recent <monospace>blastp+</monospace> software <xref rid="pone.0105015-Camacho1" ref-type="bibr">[44]</xref> instead of the original <monospace>blastp</monospace> implementation <xref rid="pone.0105015-Altschul1" ref-type="bibr">[45]</xref> was applied to find the initial matches. This can be set by a parameter in <monospace>Proteinortho</monospace>.</p>
      <p>The generation of simulated data is described below. As some of these sets were sufficiently small, we also applied <monospace>OrthoMCL</monospace>, <monospace>OMA</monospace> and <monospace>InParanoid</monospace> in order to evaluate the results. Again, standard parameters were used, including an E-value threshold of 10<sup>−5</sup> for <monospace>OrthoMCL</monospace>. Real life data was taken from various sources also described hereafter. The <monospace>YGOB</monospace> dataset <xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref>, was used in a previous study to evaluate the <monospace>Synergy</monospace> approach <xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. Hence, we took the opportunity to include the available results to the benchmark.</p>
      <sec id="s2c1">
        <title>Simulated data</title>
        <p>In the absence of extensive gold standard datasets comprising sequence and synteny data as well as the underlying gene trees that could be used for benchmarking our orthology prediction method, we simulated sequence evolution and genomic rearrangements on a single chromosome for three example datasets comprising 50, 80 and 100 gene families (proteins) in 20 species (named hereafter <italic>F</italic>50, <italic>F</italic>80<italic>d</italic> and <italic>F</italic>100, respectively). All test sets feature duplications of both individual genes and gene clusters. The set <italic>F</italic>80<italic>d</italic> in addition includes whole genome duplications. <xref ref-type="table" rid="pone-0105015-t001">Table 1</xref> gives a closer look to the composition of all three datasets as well as to their average breakpoint distances determined by <monospace>PoFF</monospace>. The simulation pipeline is available in the Online Supplemental Material.</p>
        <table-wrap id="pone-0105015-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Composition of simulated datasets.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0105015-t001-1" xlink:href="pone.0105015.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Dataset</td>
                  <td align="left" rowspan="1" colspan="1">Families</td>
                  <td align="left" rowspan="1" colspan="1">Proteins</td>
                  <td align="left" rowspan="1" colspan="1">ø Family size</td>
                  <td align="left" rowspan="1" colspan="1">ø Breakpoint distance</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>50</td>
                  <td align="left" rowspan="1" colspan="1">50</td>
                  <td align="left" rowspan="1" colspan="1">8,363</td>
                  <td align="left" rowspan="1" colspan="1">167 proteins</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>80<italic>d</italic></td>
                  <td align="left" rowspan="1" colspan="1">80</td>
                  <td align="left" rowspan="1" colspan="1">15,296</td>
                  <td align="left" rowspan="1" colspan="1">191 proteins</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>100</td>
                  <td align="left" rowspan="1" colspan="1">100</td>
                  <td align="left" rowspan="1" colspan="1">27,258</td>
                  <td align="left" rowspan="1" colspan="1">273 proteins</td>
                  <td align="left" rowspan="1" colspan="1">14</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The simulated datasets differ by the number of gene families present in the species as well as by the size of these families. The larger the families the more diversity among the set of species can be considered. Set <italic>F</italic>80<italic>d</italic> additionally comprises whole genome duplications.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Species trees were simulated according to the <italic>Age Model</italic>
<xref rid="pone.0105015-KellerSchmidt1" ref-type="bibr">[47]</xref>. These trees are balanced and edge lengths are normalized so that the total length of the path from the root to each leaf is 1. For each species tree <italic>S</italic>, we then simulated gene trees using the following rules:</p>
        <list list-type="order">
          <list-item>
            <p>The root of <italic>S</italic> contains an ordered list of ancestral genes one for each gene family. The number of families is a user-defined parameter.</p>
          </list-item>
          <list-item>
            <p><italic>S</italic> is traversed in a depth first order. All changes to the genome are simulated independently for each edge of <italic>S</italic> with constant rates.</p>
          </list-item>
          <list-item>
            <p>At each internal node of <italic>S</italic>, the ordered gene list received from its parental edge is copied without change to both offspring edges.</p>
          </list-item>
          <list-item>
            <p>Along each edge of <italic>S</italic> a number of events is sampled from a Poisson Process <inline-formula><inline-graphic xlink:href="pone.0105015.e024.jpg"/></inline-formula>, where the parameter <inline-formula><inline-graphic xlink:href="pone.0105015.e025.jpg"/></inline-formula> is the probability of the event to happen and <italic>l</italic> is the branch length. The process may generate none, one, or several events of the following types: gene duplication, cluster duplication, genome duplication, and gene loss. Here we used the parameters <inline-formula><inline-graphic xlink:href="pone.0105015.e026.jpg"/></inline-formula> for gene duplication, <inline-formula><inline-graphic xlink:href="pone.0105015.e027.jpg"/></inline-formula> for cluster duplication, <inline-formula><inline-graphic xlink:href="pone.0105015.e028.jpg"/></inline-formula> for gene loss. For the dataset <italic>F</italic>80<italic>d</italic> we consider genome duplications with <inline-formula><inline-graphic xlink:href="pone.0105015.e029.jpg"/></inline-formula> instead.</p>
          </list-item>
          <list-item>
            <p>A special rule applies to recently duplicated genes to account for the deletion of redundant gene copies before they can be stabilized by sufficient functional divergence or subfunctionalization <xref rid="pone.0105015-Ohno1" ref-type="bibr">[48]</xref>, <xref rid="pone.0105015-Lynch1" ref-type="bibr">[49]</xref>. We model this by a probability of 0.3.</p>
          </list-item>
          <list-item>
            <p>To obtain an order of the generated genes, rearrangements are carried out for each edge of <italic>S</italic> using translocation and inversion operations on the ordered list of genes that “survived” until the next speciation. Rearrangements are picked randomly and the number of inversion operations is chosen uniformly proportional to the branch length <xref rid="pone.0105015-Xu1" ref-type="bibr">[50]</xref>.</p>
          </list-item>
        </list>
        <p>The result of this simulation is a gene tree <italic>G<sub>i</sub></italic> for each family <italic>i</italic> together with a true reconciliation map to the species tree <italic>S</italic>. All gene lineages terminating in a deletion event are pruned from the gene tree so that we retain a gene tree <italic>G<sub>i</sub></italic> in which only extant genes appear as its leaves. The known reconciliation furthermore provides us with a labeling of the internal nodes of <italic>G<sub>i</sub></italic> with <italic>duplication</italic> or <italic>speciation</italic> events, see <xref ref-type="fig" rid="pone-0105015-g003">Figure 3</xref> for an example. This in turn determines the true orthology relation for all genes received in the leaves of <italic>S</italic>. In addition, the gene orders within their respective genomes are obtained. The simulations were performed using a simulation environment for large gene families <xref rid="pone.0105015-HernandezRosales1" ref-type="bibr">[51]</xref>.</p>
        <fig id="pone-0105015-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>A reconciled tree for gene families.</title>
            <p>The gene tree is embedded in the species tree. Internal nodes represent either gene duplication (filled double circle) or speciation events (empty circles). Gene loss is depicted by ×.</p>
          </caption>
          <graphic xlink:href="pone.0105015.g003"/>
        </fig>
        <p>Since large-scale orthology analysis are usually performed for protein sequences, we use <monospace>indel-Seq-Gen</monospace>
<xref rid="pone.0105015-Strope1" ref-type="bibr">[52]</xref> to generate simulated amino acid (aa) sequences for the gene trees <italic>G<sub>i</sub></italic>. For each gene family a random seed sequence is initiated with a length between 100 and 1,000 aa. Then, to define the offspring genes, <monospace>indel-Seq-Gen</monospace> introduces substitutions according to <monospace>PAM</monospace> substitution matrix and insertions and deletions with a Zipfian probability distribution <xref rid="pone.0105015-Chang1" ref-type="bibr">[53]</xref> with maximal length between 1% to 10% of the sequence length. For the gene trees a branch scale factor of 0.5 was used. This is the frequency of a single amino acid to be substituted. Hence, approximately half of the amino acids are changed during the simulation on the path from the root to the leaf.</p>
        <p>We remark that the Artificial Life Framework (<monospace>ALF</monospace>) <xref rid="pone.0105015-Dalquen1" ref-type="bibr">[54]</xref> for simulating sequence evolution could in principle have been used for simulating test data. However, in its current version, this tool does not support genome-wide duplications and selective loss of recently duplicated genes. We therefore opted to construct our own simulation framework.</p>
      </sec>
      <sec id="s2c2">
        <title>Real life data</title>
        <p>COG: We used proteome data from the <monospace>COG</monospace>-database, which provides manually curated orthology relations (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/pub/COG/COG/">ftp://ftp.ncbi.nih.gov/pub/COG/COG/</ext-link>, 2009/10/15), for the following set of 16 species covering three bacterial groups: <italic>Bacillus halodurans</italic>, <italic>Bacillus subtilis</italic>, <italic>Lactococcus lactis</italic>, <italic>Listeria innocua</italic>, <italic>Streptococcus pneumoniae</italic> TIGR4, <italic>Streptococcus pyogenes</italic> M1 GAS from the Gram-positive bacilli class, <italic>Buchnera sp.</italic> APS, <italic>Escherichia coli</italic> K12, <italic>Pasteurella multocida</italic>, <italic>Salmonella typhimurium</italic> LT2, <italic>Vibrio cholerae</italic>, <italic>Yersinia pestis</italic> from the gamma proteobacteria class and <italic>Brucella melitensis</italic>, <italic>Caulobacter vibrioides</italic>, <italic>Mesorhizobium loti</italic>, <italic>Rickettsia prowazekii</italic> from the alpha proteobacteria class. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 642.</p>
        <p>To obtain the gene orders we retrieved the genomes from the <monospace>NCBI</monospace>-database (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/">ftp://ftp.ncbi.nih.gov/genomes/Bacteria/</ext-link>, 2012/12/13, see supplement). When several strains were available, we picked the one with the smallest <underline>uid</underline> as they represent the older genomes preferentially included in secondary databases. All genes were then located in the genomes using <monospace>tblastn+</monospace> with an E-value threshold of 10<sup>−8</sup>. The best match was considered to be the gene of interest. A small minority of genes (98 out of 53,264) could not be located unambiguously and was thus removed from the dataset.</p>
        <p>As we used an extract of the <monospace>COG</monospace>-database (16 out of 66 species), only <monospace>COG</monospace>-groups covering at least eight proteins within the set of the chosen 16 species were considered to estimate the orthology matrix as described below (see Evaluation). Otherwise, their classification might have been based on species not in the dataset used here, which would make a comparison of approaches unreasonable.</p>
        <p>OrthoBench: We also used the reference annotation <monospace>OrthoBench</monospace>
<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref>. Manually curated orthologous groups were downloaded from <ext-link ext-link-type="uri" xlink:href="http://eggnog.embl.de/orthobench/">http://eggnog.embl.de/orthobench/</ext-link> at 2013/01/05. The set comprises 12 metazoan proteomes and is based on the <monospace>Ensembl</monospace>
<italic>v</italic>60 genome annotation <xref rid="pone.0105015-Flicek1" ref-type="bibr">[55]</xref> which was downloaded from <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ensembl.org/pub/release-60/">ftp://ftp.ensembl.org/pub/release-60/</ext-link> at 2013/01/11. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 5,433. 124 out of 1,692 proteins stated in <monospace>OrthoBench</monospace> could not be located in the <italic>v</italic>60 set and were excluded from the analysis.</p>
        <p>YGOB: From this dataset we obtained orthology assignments of five ascomycete fungi <italic>Ashbya gossypii</italic>, <italic>Saccharomyces cerevisiae</italic>, <italic>Candida glabrata</italic>, <italic>Kluyveromyces lactis</italic>, and <italic>Kluyveromyces waltii</italic> that have been used in the evaluation of <monospace>Synergy</monospace> in the original study <xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 2, 697. The data provided by the authors included pairwise <monospace>blast</monospace> results with an E-value threshold of 10<sup>−5</sup>, which we directly used in our analysis, omitting the <monospace>blast</monospace> step. In this way, the initial blast data on which <monospace>Synergy</monospace>, <monospace>Proteinortho</monospace>, and <monospace>PoFF</monospace> operated was assured to be identical. We then compared orthologs predicted by the three approaches to orthologs from the YGOB dataset (v1, 2005) <xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref>. We excluded genes from the predictions that were not contained in the <monospace>YGOB</monospace> dataset (6, 218, 6, 076 and 6, 817 out of 23, 134 for <monospace>Proteinortho</monospace>, <monospace>PoFF</monospace> and <monospace>Synergy</monospace>, respectively). In this way, we avoid to bias our evaluation with data that is not present in the reference dataset.</p>
      </sec>
      <sec id="s2c3">
        <title>Evaluation</title>
        <p>For each gene family/orthologous group in the reference sets, we compared the pairwise orthologous relationships between its members to the predictions, counting true positives (<italic>tp</italic>), false positives (<italic>fp</italic>), true negatives (<italic>tn</italic>) and false negatives (<italic>fn</italic>) as well as the number of orthology relations between reference groups. These data were then used for statistics as follows:<disp-formula id="pone.0105015.e030"><graphic xlink:href="pone.0105015.e030.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>For evaluation of <monospace>PoFF</monospace> and <monospace>Proteinortho</monospace>, we used the orthology graph returned in addition to orthologous groups which contains information on pairwise orthology relations. <monospace>OMA</monospace> returns this graph equivalently in the <underline>PairwiseOrthologs</underline> output. <monospace>InParanoid</monospace> was applied to all pairs of species successively. After merging the results, this resulted in pairwise orthology relations for the whole dataset as well. <monospace>OrthoMCL</monospace> on the other hand, does not return the orthology graph directly. We extracted the information on pairwise orthology relations from the <monospace>MCL</monospace> clustering output file. Connected components in there are used by <monospace>OrthoMCL</monospace> to determine orthologous groups, making this output file similar to the orthology graph returned by <monospace>PoFF/Proteinortho</monospace>. We note however, that the file was not meant to be used as orthology graph. Given the mode of calculation applied by <monospace>OrthoMCL</monospace>, it contains numerous orthology relations for paralogs of the same species which cannot occur using <monospace>PoFF/Proteinortho</monospace>. For <monospace>Synergy</monospace> and <monospace>YGOB</monospace>, pairwise orthology relations were present. For <monospace>COG</monospace> and <monospace>OrthoBench</monospace>, however, only data on orthologous groups was provided. The pairwise orthology relations had to be estimated. We did this by assuming each protein of an orthologous group to be orthologous to each other protein in the same group, except when both proteins belong to the same species. We emphasize that this strategy strictly overestimates the number of orthologous relationships in the dataset. Nonetheless, this method makes it possible to compare the results on a pairwise level.</p>
        <p>The simulated data also provides gene trees. These were used to acquire pairwise orthology relations. Two genes of a simulated gene family are orthologous to each other, if and only if their most recent common ancestor event was a speciation.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>In order to estimate how <monospace>PoFF</monospace> performs with respect to closely related species and compared to the original <monospace>Proteinortho</monospace> implementation, we simulated and subsequently evaluated three datasets (<italic>F</italic>50, <italic>F</italic>80<italic>d</italic>, <italic>F</italic>100), for which the gene histories and hence the true orthology relations are defined. The datasets differ in number and size of gene families, thus representing increasing levels of diversity among closely related species. The results are summarized in <xref ref-type="table" rid="pone-0105015-t002">Table 2</xref>. <monospace>Proteinortho</monospace> already performs very efficiently. However, as the number of paralogs with similar sequences increases, the basic algorithm becomes less effective in precisely predicting the correct orthology relations within these gene families, a trend that exacerbates with increasing size of gene families. The use of the synteny information provided by the <monospace>FFAdj-MCS</monospace> algorithm efficiently counteracts this tendency and substantially improves the precision. Other performance statistics as well as the runtime remain nearly unchanged, which indicates a significant advantage of <monospace>PoFF</monospace> over the original <monospace>Proteinortho</monospace> tool.</p>
    <table-wrap id="pone-0105015-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison using simulated data.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0105015-t002-2" xlink:href="pone.0105015.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset</td>
              <td align="left" rowspan="1" colspan="1">Method</td>
              <td align="left" rowspan="1" colspan="1">Precision</td>
              <td align="left" rowspan="1" colspan="1">Recall</td>
              <td align="left" rowspan="1" colspan="1">Accuracy</td>
              <td align="left" rowspan="1" colspan="1"><italic>tn</italic> rate</td>
              <td align="left" rowspan="1" colspan="1">Runtime</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">F50</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">3.06%</td>
              <td align="left" rowspan="1" colspan="1">7.26%</td>
              <td align="left" rowspan="1" colspan="1">86.18%</td>
              <td align="left" rowspan="1" colspan="1">89.71%</td>
              <td align="left" rowspan="1" colspan="1">7 h, 22 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OMA</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">38.64%</td>
              <td align="left" rowspan="1" colspan="1">9.62%</td>
              <td align="left" rowspan="1" colspan="1">95.49%</td>
              <td align="left" rowspan="1" colspan="1">99.32%</td>
              <td align="left" rowspan="1" colspan="1">1 day, 14 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">98.01%</td>
              <td align="left" rowspan="1" colspan="1">5.02%</td>
              <td align="left" rowspan="1" colspan="1">95.94%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">2 days, 2 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">80.63%</td>
              <td align="left" rowspan="1" colspan="1">23.11%</td>
              <td align="left" rowspan="1" colspan="1">97.62%</td>
              <td align="left" rowspan="1" colspan="1">99.83%</td>
              <td align="left" rowspan="1" colspan="1">0 h, 36 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">96.15%</td>
              <td align="left" rowspan="1" colspan="1">24.18%</td>
              <td align="left" rowspan="1" colspan="1">97.53%</td>
              <td align="left" rowspan="1" colspan="1">99.96%</td>
              <td align="left" rowspan="1" colspan="1">0 h, 36 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">F80d</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">0.92%</td>
              <td align="left" rowspan="1" colspan="1">0.88%</td>
              <td align="left" rowspan="1" colspan="1">87.44%</td>
              <td align="left" rowspan="1" colspan="1">93.43%</td>
              <td align="left" rowspan="1" colspan="1">15 h, 46 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OMA</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">43.97%</td>
              <td align="left" rowspan="1" colspan="1">5.25%</td>
              <td align="left" rowspan="1" colspan="1">93.51%</td>
              <td align="left" rowspan="1" colspan="1">99.54%</td>
              <td align="left" rowspan="1" colspan="1">3 days, 23 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">97.67%</td>
              <td align="left" rowspan="1" colspan="1">0.89%</td>
              <td align="left" rowspan="1" colspan="1">93.65%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">8 days, 23 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">79.36%</td>
              <td align="left" rowspan="1" colspan="1">16.64%</td>
              <td align="left" rowspan="1" colspan="1">97.68%</td>
              <td align="left" rowspan="1" colspan="1">99.88%</td>
              <td align="left" rowspan="1" colspan="1">1 h, 29 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">93.98%</td>
              <td align="left" rowspan="1" colspan="1">15.52%</td>
              <td align="left" rowspan="1" colspan="1">97.30%</td>
              <td align="left" rowspan="1" colspan="1">99.96%</td>
              <td align="left" rowspan="1" colspan="1">1 h, 30 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">F100</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL/OMA/InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">&gt;31 days</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">23.99%</td>
              <td align="left" rowspan="1" colspan="1">20.48%</td>
              <td align="left" rowspan="1" colspan="1">99.37%</td>
              <td align="left" rowspan="1" colspan="1">99.71%</td>
              <td align="left" rowspan="1" colspan="1">6 h, 39 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">90.16%</td>
              <td align="left" rowspan="1" colspan="1">18.17%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">6 h, 44 min</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Comparison of computational results with orthology relations derived from simulated datasets with different gene family sizes. Statistical values are explained in <xref ref-type="sec" rid="s2">Materials and Methods</xref>. <italic>tn</italic> rate refers to true negative rate. Running time was measured on a quad core CPU (Intel core i7 at 2.9 GHz) with eight threads.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>It would be desirable to include several other orthology detection tools to directly compare the results achieved using the simulated datasets. To our knowledge, only <monospace>OrthoMCL</monospace>, <monospace>OMA</monospace>, <monospace>InParanoid</monospace> and <monospace>Roundup 2.0</monospace> are available as standalone tools that can be used for large input datasets. Since <monospace>Roundup 2.0</monospace> largely relies on a commercial implementation of <monospace>blast</monospace>, we were only able to include the first two tools in the benchmark. We observed that <monospace>OrthoMCL</monospace> is very inclusive. It returns huge orthologous groups comprising whole gene families but, according to the results, does not reflect pairwise orthology to a reasonable extent. This results in a large number of false positive predictions. It also requires extensive computational resources: We terminated the analysis of the biggest dataset (<italic>F</italic>100) after 31 days of runtime without obtaining a result (using an Intel core i7 quad core CPU at 2.9 GHz). <monospace>OMA</monospace> and <monospace>InParanoid</monospace> required even more computational resources. We also had to terminate the analysis of the biggest dataset without obtaining a result from these tools. The results obtained for the two other datasets, however, were superior to those obtained from <monospace>OrthoMCL</monospace>. <monospace>InParanoid</monospace> reports the smallest amount of orthology relations (only ∼1–5% recall) and exhibits the longest runtime. The results however hardly include any false positives.</p>
    <p>Since <monospace>FFAdj-MCS</monospace> acts as an efficient filter against false orthology predictions, we tested whether we could rely entirely on the synteny information. After all, this information is also derived from the alignment scores determined by <monospace>blast</monospace>, hence low-scoring edges are unlikely to enter the final matching and would thus be dismissed either way. We therefore removed <monospace>Proteinortho</monospace>'s filter for near-optimal alignment scores by setting <italic>f</italic> = 0, which includes all reciprocal alignments above the given E-value threshold. We observed that this did not improve the quality of the predictions but increased the CPU time by a factor of 20 to 40 on the simulated datasets. A cutoff value of <italic>f</italic> close to 1 thus not only saves computational resources but also contributes to the identification of the correct edges in <inline-formula><inline-graphic xlink:href="pone.0105015.e031.jpg"/></inline-formula> independent of <monospace>FFAdj-MCS</monospace>. This observation justifies the design decision to run the gene order filter only on the nearly optimal orthology candidates.</p>
    <p>In addition to simulated data, we performed benchmarks using estimated orthology relationships from several real life datasets. The <monospace>COG</monospace>-database <xref rid="pone.0105015-Tatusov1" ref-type="bibr">[8]</xref> was used as complete reference annotation for a set of 16 prokaryotes. All proteins present in this set are assigned to some group. <monospace>OrthoBench</monospace>
<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref> and <monospace>YGOB</monospace>
<xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref> provided a partial annotation for a number of reference proteins in twelve metazoan and five fungal species, respectively. The <monospace>YGOB</monospace> dataset was used in a previous study to evaluate the tool <monospace>Synergy</monospace>
<xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. While the latter is not publicly available, the results of its application to <monospace>YGOB</monospace> have been published, which allowed us to compare <monospace>Synergy</monospace> and <monospace>PoFF</monospace> on this dataset (see <xref ref-type="table" rid="pone-0105015-t003">Table 3</xref> and <xref ref-type="sec" rid="s3">discussion</xref> below).</p>
    <table-wrap id="pone-0105015-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison using real data.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0105015-t003-3" xlink:href="pone.0105015.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset</td>
              <td align="left" rowspan="1" colspan="1">Method</td>
              <td align="left" rowspan="1" colspan="1">Precision</td>
              <td align="left" rowspan="1" colspan="1">Recall</td>
              <td align="left" rowspan="1" colspan="1">Accuracy</td>
              <td align="left" rowspan="1" colspan="1"><italic>tn</italic> rate</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>COG</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">99.50%</td>
              <td align="left" rowspan="1" colspan="1">23.80%</td>
              <td align="left" rowspan="1" colspan="1">29.12%</td>
              <td align="left" rowspan="1" colspan="1">98.45%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">99.52%</td>
              <td align="left" rowspan="1" colspan="1">22.50%</td>
              <td align="left" rowspan="1" colspan="1">27.93%</td>
              <td align="left" rowspan="1" colspan="1">98.47%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>YGOB</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Synergy</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">61.36%</td>
              <td align="left" rowspan="1" colspan="1">42.82%</td>
              <td align="left" rowspan="1" colspan="1">99.64%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">59.10%</td>
              <td align="left" rowspan="1" colspan="1">38.35%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">59.07%</td>
              <td align="left" rowspan="1" colspan="1">36.97%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoBench</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">100%</td>
              <td align="left" rowspan="1" colspan="1">17.68%</td>
              <td align="left" rowspan="1" colspan="1">24.71%</td>
              <td align="left" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">100%</td>
              <td align="left" rowspan="1" colspan="1">9.72%</td>
              <td align="left" rowspan="1" colspan="1">17.44%</td>
              <td align="left" rowspan="1" colspan="1">90.27%</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt103">
          <label/>
          <p>Comparison of tools on the basis of estimated orthology relations from real data sets. Statistical values are explained in <xref ref-type="sec" rid="s2">Materials and Methods</xref>. <italic>tn</italic> rate refers to true negative rate.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>For real life datasets, <monospace>PoFF</monospace> predicts 4 to 57% fewer pairwise orthology relations than <monospace>Proteinortho</monospace>. This tendency is even more pronounced for the very similar simulated datasets (23 to 77%, data not shown). The reduced number of pairwise orthology relations allows separating the orthologous groups in a more fine-grained way and reduces the number of false positive assignments. In turn, however, the number of true positive assignments is reduced as well. For the real life datasets, which comprise far more distant species than the simulated data, this results in reduced recall and sometimes also reduced accuracy (<xref ref-type="table" rid="pone-0105015-t003">Table 3</xref>).</p>
    <p>We emphasize that neither the <monospace>COG</monospace> nor the <monospace>OrthoBench</monospace> data are ideal benchmarking sets for fine-grained orthology predictions. Both provide orthologous groups rather than pairwise orthology relations which, in turn, had to be estimated for evaluation (see <xref ref-type="sec" rid="s2">Materials and Methods</xref>). Moreover, many of these groups are rather large as they contain numerous paralogs, which were – as we would argue – correctly clustered into subgroups by <monospace>PoFF</monospace> and/or <monospace>Proteinortho</monospace>. The <monospace>COG</monospace>-database was originally constructed using 13 Archaea, three Eukarya and 50 Bacteria. For evaluation, we used a bacterial subset of 16 species. This in turn makes duplications specific to the chosen subset harder to detect. The combination of these issues leads to artifacts in the reference datasets that might have a negative impact on recall and accuracy. Both, <monospace>PoFF</monospace> and <monospace>Proteinortho</monospace> tend to split the groups annotated in the reference sets into smaller subgroups. This effect of subdividing is more pronounced for <monospace>PoFF</monospace>. <monospace>OrthoBench</monospace> groups contain on average 23.5 genes while comprising only up to 12 species. On average these groups are divided into 3.8 subgroups by <monospace>Proteinortho</monospace> and 5.4 groups using <monospace>PoFF</monospace>. <monospace>COG</monospace> groups contain 18.4 genes on average. These groups are divided into 3.0 and 3.1 subgroups, respectively (see <xref ref-type="supplementary-material" rid="pone.0105015.s001">File S1</xref>).</p>
    <p>Only the <monospace>YGOB</monospace> dataset offers pairwise orthology data and can thus be regarded as more exact than the other two sets. Here, the results of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> are quite similar. Again we find the slight decrease in recall observed already for the simulated dataset. Increased phylogenetic distance decreases the positive impact on precision, which was found for the more closely related simulated datasets. The predictions for this dataset achieved by Synergy are slightly better than those of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace>. However, the algorithm relies on genome-wide reconstruction of phylogenetic gene trees and is thus far more time-consuming. Moreover, a standalone tool that applies the algorithm is currently not available.</p>
    <p>The strategy pursued by <monospace>PoFF</monospace> is particularly useful to separate large orthologous groups with many co-orthologs into smaller subgroups. Typically, there is one major group for each gene family in each simulated dataset that spans all species of the original group but includes only one or a small number of genes from each species. In addition, we observe one or more “minor” groups of duplicates that contain diverged and/or largely rearranged paralogs. Using the real life dataset <monospace>OrthoBench</monospace> we see this trend in particular for Otoferlin, Dilute myosin heavy chain, GPS domain-containing GPCRs and S-adenosylmethionine synthetase isoform families. This type of subdivision appears useful and desirable in most practical applications of automatic orthology detectors.</p>
    <p>The increase in runtime introduced by <monospace>FFAdj-MCS</monospace> is marginal for small genomes (e.g. Bacteria). For simulated data as well as the <monospace>COG</monospace> set we observed an increase by 1–3%. For large genomes as present in the <monospace>OrthoBench</monospace> set the increase was 5–10% and thus more notable. For example, the analysis of <italic>Rattus norvegicus</italic> and <italic>Pan troglodytes</italic> took 12.5h using <monospace>Proteinortho</monospace> and 13.5 h using <monospace>PoFF</monospace> applying a single thread. The memory requirements remained unchanged.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>Dissecting large gene families from many genomes into clusters of orthologs is not a well-posed problem. Orthology, as defined by Fitch <xref rid="pone.0105015-Fitch1" ref-type="bibr">[1]</xref>, <xref rid="pone.0105015-Fitch2" ref-type="bibr">[2]</xref>, is a binary relation of the set of genes. Gene duplication events typically appear in many different locations of the underlying phylogenetic tree and give rise to a complex structure of co-orthologs and paralogs at different levels. The resulting cograph nevertheless contains dense clusters that can be meaningfully associated with orthologous groups. Clustering-based orthology detection is therefore a useful pragmatic way to easily and correctly identify orthologous groups, provided duplications are absent within the phylogenetic range of the input data. It is a common feature of orthology methods, in particular those geared towards large datasets, that the orthology is approximated by a partition of the genes into groups of co-orthologs. The tool <monospace>PoFF</monospace> described here also follows this paradigm but provides pairwise orthology predictions in addition.</p>
    <p>Several orthology prediction methods that avoid the explicit use of gene and species trees have been described in the literature. Most of them can be applied to large datasets only at high performance computing facilities. Their pre-computed results are usually available in databases, whereas the software itself is not available for public use or restricted in practice to small datasets. This limits their usefulness since poorly studied or newly sequenced organisms that are not (yet) available in the pre-computed results cannot easily be included in large-scale studies. <monospace>PoFF</monospace> is specifically designed to overcome these limitations and provides users a tool for compiling large-scale orthology datasets with moderate computational resources. Here we have shown that the combination of the fast, clustering-based orthology heuristic, <monospace>Proteinortho</monospace>, with the equally efficient heuristic for large-scale synteny assessment, <monospace>FFAdj-MCS</monospace>, leads to a substantial improvement of the data quality for related species without loss of performance. Synteny information proves to be a highly efficient filter against false-positive orthology assignments without a huge increase of the false negative rate. The extended approach, <monospace>PoFF</monospace>, is capable of boosting large-scale comparative studies which focus on closely related species or even strains.</p>
    <p>Orthologous groups can provide a convenient starting point for more detailed analyses of the history of entire gene families. To this end, it is necessary to reduce in particular false positive orthology assignments. <xref ref-type="fig" rid="pone-0105015-g004">Figure 4</xref> illustrates that the filtering and clustering strategy can have a strong influence on both the false positive and false negative rates of orthology assignments. Orthology is only defined as a pairwise relationship which is not transitive. Hence, reducing the false positive rate within orthologous groups will ultimately lead to a reduction of true positive rates when the pairwise definition is applied, as we did here (see <xref ref-type="fig" rid="pone-0105015-g004">Figure 4</xref>, e.g., separating the paralogs <italic>B</italic>1 and <italic>B</italic>2 into two distinct orthologous groups requires to discard the true orthology relation to <italic>A</italic>1 for one of them, otherwise both genes would be connected via <italic>A</italic>1). Given this, we had expected <monospace>PoFF</monospace> to perform much worse regarding true positives, which was, however, not the case.</p>
    <fig id="pone-0105015-g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g004</object-id>
      <label>Figure 4</label>
      <caption>
        <title>The false negative issue.</title>
        <p>The genes {<italic>A</italic>1, <italic>B</italic>1, <italic>B</italic>2, <italic>C</italic>1, <italic>C</italic>2} form an orthologous group. {<italic>B</italic>1, <italic>B</italic>2} as well as {<italic>C</italic>1, <italic>C</italic>2} are not orthologous to each other but co-orthologous with respect to <italic>A</italic>1 (<italic>A</italic>1 and {<italic>B</italic>1, <italic>B</italic>2, <italic>C</italic>1, <italic>C</italic>2} are separated by a speciation event). Pairwise true orthology relationships are marked by black arcs, false ones are grey. <monospace>Proteinortho</monospace> is more inclusive, it would report all five genes as one group, yielding six true and two false positives (grey). Assuming that the gene copies 1 and 2 exhibit distinct genomic neighborhoods in all three species <italic>A</italic> to <italic>C</italic>, <monospace>PoFF</monospace> would report two separate groups, namely {<italic>A</italic>1, <italic>B</italic>1, <italic>C</italic>1} and {<italic>B</italic>2, <italic>C</italic>2}. This more fine-grained method avoids false positive orthology assignments. However, it introduces false negative assignments. Two in this example, depicted by dashed arcs.</p>
      </caption>
      <graphic xlink:href="pone.0105015.g004"/>
    </fig>
    <p>While conserved synteny is a powerful feature to support the confidence in orthology predictions <xref rid="pone.0105015-Rolland1" ref-type="bibr">[56]</xref>, gene orders evolve faster than protein sequences <xref rid="pone.0105015-Kristensen1" ref-type="bibr">[57]</xref>. This fact is reflected by the benchmark results of the closely related simulated datasets compared to the real-life sets including more distantly related species, where the advantage of <monospace>PoFF</monospace> regarding pairwise orthology prediction was clearly reduced (see <xref ref-type="table" rid="pone-0105015-t002">Tables 2</xref> and <xref ref-type="table" rid="pone-0105015-t003">3</xref>). However, <monospace>PoFF</monospace> yields orthologous groups that are more fine-grained and contain fewer paralogs. We argue that this is a practical improvement for subsequent analyses, such as gene function prediction, genome annotation, marker development and phylogenetics. There, the presence of many-to-many relations in orthologous groups due to co-orthologs may lead to inconclusive results. In turn, these groups are often omitted and single-copy orthologs (a single gene per species) are used only <xref rid="pone.0105015-Creevey1" ref-type="bibr">[58]</xref>–<xref rid="pone.0105015-Liu1" ref-type="bibr">[60]</xref>. This fact could make an application of <monospace>PoFF</monospace> desirable, even for more distant species.</p>
    <p>The extension of <monospace>Proteinortho</monospace> by <monospace>FFAdj-MCS</monospace> leads to a very moderate increase in runtime and does not increase the hardware requirements, making this combined method applicable to very large datasets further on. The current approach of combining sequence similarity, conserved synteny and clustering entails a significant improvement when comparing closely related species. As gene orders generally evolve faster than protein sequences <xref rid="pone.0105015-Kristensen1" ref-type="bibr">[57]</xref>, the improvement decreases with growing phylogenetic distance of species in the set, which may even compromise precision. Future extensions of the approach could thus aim at deciding on a case-by-case basis if the <monospace>FFAdj-MCS</monospace> algorithm should be used as additional filter for the comparison of two species, e.g., based on the respective breakpoint distance. Alternatively, a less restrictive synteny measure (e.g. common intervals instead of adjacencies) could be applied.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0105015.s001">
      <label>File S1</label>
      <caption>
        <p>Table S1: Accuracy of separation of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> evaluated in reference dataset <monospace>Orthobench</monospace>. Table S2: Accuracy of separation of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> evaluated in reference dataset <monospace>COG</monospace>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0105015.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are thankful with Chunfang Zheng for providing us her scripts and guidance for genome rearrangements.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0105015-Fitch1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fitch</surname><given-names>WM</given-names></name> (<year>1970</year>) <article-title>Distinguishing homologous from analogous proteins</article-title>. <source>Syst Zool</source>
<volume>19</volume>: <fpage>99</fpage>–<lpage>113</lpage>.<pub-id pub-id-type="pmid">5449325</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Fitch2">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Fitch</surname><given-names>WM</given-names></name> (<year>2000</year>) <article-title>Homology a personal view on some of the problems</article-title>. <source>Trends Genet</source>
<volume>16</volume>: <fpage>227</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">10782117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Arvestad1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Arvestad</surname><given-names>L</given-names></name>, <name><surname>Berglund</surname><given-names>AC</given-names></name>, <name><surname>Lagergren</surname><given-names>J</given-names></name>, <name><surname>Sennblad</surname><given-names>B</given-names></name> (<year>2003</year>) <article-title>Bayesian gene/species tree reconciliation and orthology analysis using MCMC</article-title>. <source>Bioinformatics</source>
<volume>19</volume>
<issue>Suppl.1</issue>: <fpage>7</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Shi1">
      <label>4</label>
      <mixed-citation publication-type="other">Shi G, Peng MC, Jiang T (2011) MultiMSOAR 2.0: an accurate tool to identify ortholog groups among multiple genomes. PLoS One 6.</mixed-citation>
    </ref>
    <ref id="pone.0105015-vanderHeijden1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>van der Heijden</surname><given-names>RT</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>van Noort</surname><given-names>V</given-names></name>, <name><surname>Huynen</surname><given-names>MA</given-names></name> (<year>2007</year>) <article-title>Orthology prediction at scalable resolution by phylogenetic tree analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>83</fpage>.<pub-id pub-id-type="pmid">17346331</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Hubbard1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hubbard</surname><given-names>TJ</given-names></name>, <name><surname>Aken</surname><given-names>BL</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Ballester</surname><given-names>B</given-names></name>, <name><surname>Caccamo</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Ensembl 2007</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>D610</fpage>–<lpage>617</lpage>.<pub-id pub-id-type="pmid">17148474</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wapinski1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wapinski</surname><given-names>I</given-names></name>, <name><surname>Pfeffer</surname><given-names>A</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Automatic genome-wide reconstruction of phylogenetic gene trees</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>549</fpage>–<lpage>558</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Tatusov1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Tatusov</surname><given-names>RL</given-names></name>, <name><surname>Galperin</surname><given-names>MY</given-names></name>, <name><surname>Natale</surname><given-names>DA</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2000</year>) <article-title>The COG database: a tool for genomescale analysis of protein functions and evolution</article-title>. <source>Nucleic Acids Res</source>
<volume>28</volume>: <fpage>33</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">10592175</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Li1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Stoeckert</surname><given-names>CJ</given-names><suffix>Jr</suffix></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2003</year>) <article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>. <source>Genome Res</source>
<volume>13</volume>: <fpage>2178</fpage>–<lpage>2189</lpage>.<pub-id pub-id-type="pmid">12952885</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chen1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Mackey</surname><given-names>AJ</given-names></name>, <name><surname>Stoeckert</surname><given-names>CJ</given-names><suffix>Jr</suffix></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2006</year>) <article-title>Orthomcl-db: querying a comprehensive multi-species collection of ortholog groups</article-title>. <source>Nucleic Acids Res</source>
<volume>34</volume>: <fpage>D363</fpage>–<lpage>368</lpage>.<pub-id pub-id-type="pmid">16381887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Schneider1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>A</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name> (<year>2007</year>) <article-title>OMA browser–exploring orthologous relations across 352 complete genomes</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>2180</fpage>–<lpage>2182</lpage>.<pub-id pub-id-type="pmid">17545180</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altenhoff1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Altenhoff</surname><given-names>AM</given-names></name>, <name><surname>Schneider</surname><given-names>A</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>OMA 2011: orthology inference among 1000 complete genomes</article-title>. <source>Nucleic Acids Res</source>
<volume>39</volume>: <fpage>D289</fpage>–<lpage>D294</lpage>.<pub-id pub-id-type="pmid">21113020</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Berglund1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Berglund</surname><given-names>AC</given-names></name>, <name><surname>Sjölund</surname><given-names>E</given-names></name>, <name><surname>Ostlund</surname><given-names>G</given-names></name>, <name><surname>Sonnhammer</surname><given-names>EL</given-names></name> (<year>2008</year>) <article-title>InParanoid 6: eukaryotic ortholog clusters with inparalogs</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D263</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">18055500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Jensen1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Jensen</surname><given-names>LJ</given-names></name>, <name><surname>Julien</surname><given-names>P</given-names></name>, <name><surname>Kuhn</surname><given-names>M</given-names></name>, <name><surname>von Mering</surname><given-names>C</given-names></name>, <name><surname>Muller</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>eggNOG: automated construction and annotation of orthologous groups of genes</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D250</fpage>–<lpage>254</lpage>.<pub-id pub-id-type="pmid">17942413</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wheeler1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Wheeler</surname><given-names>DL</given-names></name>, <name><surname>Barrett</surname><given-names>T</given-names></name>, <name><surname>Benson</surname><given-names>DA</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>, <name><surname>Canese</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D13</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">18045790</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-DeLuca1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>DeLuca</surname><given-names>TF</given-names></name>, <name><surname>Cui</surname><given-names>J</given-names></name>, <name><surname>Jung</surname><given-names>JY</given-names></name>, <name><surname>St Gabriel</surname><given-names>KC</given-names></name>, <name><surname>Wall</surname><given-names>DP</given-names></name> (<year>2012</year>) <article-title>Roundup 2.0: enabling comparative genomics for over 1800 genomes</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>715</fpage>–<lpage>716</lpage>.<pub-id pub-id-type="pmid">22247275</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Mahmood1">
      <label>17</label>
      <mixed-citation publication-type="other">Mahmood K, Webb GI, Song J, Whisstock JC, Konagurthu AS (2012) Efficient large-scale protein sequence comparison and gene matching to identify orthologs and co-orthologs. Nucleic Acids Res 40.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Koonin1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2005</year>) <article-title>Orthologs, paralogs, and evolutionary genomics</article-title>. <source>Annu Rev Genet</source>
<volume>39</volume>: <fpage>309</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">16285863</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lechner1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lechner</surname><given-names>M</given-names></name>, <name><surname>Findeiss</surname><given-names>S</given-names></name>, <name><surname>Steiner</surname><given-names>L</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Proteinortho: detection of (co-)orthologs in large-scale analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume>: <fpage>124</fpage>.<pub-id pub-id-type="pmid">21526987</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Hellmuth1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hellmuth</surname><given-names>M</given-names></name>, <name><surname>Hernandez-Rosales</surname><given-names>M</given-names></name>, <name><surname>Huber</surname><given-names>KT</given-names></name>, <name><surname>Moulton</surname><given-names>V</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Orthology relations, symbolic ultrametrics, and cographs</article-title>. <source>J Math Biol</source>
<volume>66</volume>: <fpage>399</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">22456957</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altenhoff2">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Altenhoff</surname><given-names>AM</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2009</year>) <article-title>Phylogenetic and functional assessment of orthologs inference projects and methods</article-title>. <source>PLoS Comput Biol</source>
<volume>5</volume>: <fpage>e1000262</fpage>.<pub-id pub-id-type="pmid">19148271</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chen2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Mackey</surname><given-names>AJ</given-names></name>, <name><surname>Vermunt</surname><given-names>JK</given-names></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2007</year>) <article-title>Assessing performance of orthology detection strategies applied to eukaryotic genomes</article-title>. <source>PLoS One</source>
<volume>2</volume>: <fpage>e383</fpage>.<pub-id pub-id-type="pmid">17440619</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Trachana1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Trachana</surname><given-names>K</given-names></name>, <name><surname>Larsson</surname><given-names>TA</given-names></name>, <name><surname>Powell</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Doerks</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Orthology prediction methods: a quality assessment using curated protein families</article-title>. <source>Bioessays</source>
<volume>33</volume>: <fpage>769</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">21853451</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Ebersberger1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Ebersberger</surname><given-names>I</given-names></name>, <name><surname>Strauss</surname><given-names>S</given-names></name>, <name><surname>von Haeseler</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>HaMStR: Profile hidden markov model based search for orthologs in ESTs</article-title>. <source>BMC Evol Biol</source>
<volume>9</volume>: <fpage>157</fpage>.<pub-id pub-id-type="pmid">19586527</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Shi2">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>G</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name> (<year>2010</year>) <article-title>Msoar 2.0: Incorporating tandem duplications into ortholog assignment based on genome rearrangement</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>10</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">20053291</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Grigoriev1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Grigoriev</surname><given-names>IV</given-names></name>, <name><surname>Cullen</surname><given-names>D</given-names></name>, <name><surname>Goodwin</surname><given-names>SB</given-names></name>, <name><surname>Hibbett</surname><given-names>D</given-names></name>, <name><surname>Jeffries</surname><given-names>TW</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Fueling the future with fungal genomics</article-title>. <source>Mycology</source>
<volume>2</volume>: <fpage>192</fpage>–<lpage>209</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Cao1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Schneeberger</surname><given-names>K</given-names></name>, <name><surname>Ossowski</surname><given-names>S</given-names></name>, <name><surname>Günther</surname><given-names>T</given-names></name>, <name><surname>Bender</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Whole-genome sequencing of multiple <italic>Arabidopsis thaliana</italic> populations</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>956</fpage>–<lpage>963</lpage>.<pub-id pub-id-type="pmid">21874002</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wapinski2">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Wapinski</surname><given-names>I</given-names></name>, <name><surname>Pfeffer</surname><given-names>A</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Natural history and evolutionary principles of gene duplication in fungi</article-title>. <source>Nature</source>
<volume>449</volume>: <fpage>54</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">17805289</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dandekar1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Dandekar</surname><given-names>T</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>1998</year>) <article-title>Conservation of gene order: a fingerprint of proteins that physically interact</article-title>. <source>Trends Biochem Sci</source>
<volume>23</volume>: <fpage>324</fpage>–<lpage>328</lpage>.<pub-id pub-id-type="pmid">9787636</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Suyama1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Suyama</surname><given-names>M</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2001</year>) <article-title>Evolution of prokaryotic gene order: genome rearrangements in closely related species</article-title>. <source>Trends Genet</source>
<volume>17</volume>: <fpage>10</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">11163906</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lehmann1">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Lehmann</surname><given-names>J</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>Prohaska</surname><given-names>SJ</given-names></name> (<year>2008</year>) <article-title>SynBlast: Assisting the analysis of conserved synteny information</article-title>. <source>BMC Bioinformatics</source>
<volume>9</volume>: <fpage>351</fpage>.<pub-id pub-id-type="pmid">18721485</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dewey1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Dewey</surname><given-names>CN</given-names></name> (<year>2011</year>) <article-title>Positional orthology: putting genomic evolutionary relationships into context</article-title>. <source>Briefings Bioinf</source>
<volume>12</volume>: <fpage>401</fpage>–<lpage>412</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Waterson1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Waterson</surname><given-names>G</given-names></name>, <name><surname>Ewens</surname><given-names>W</given-names></name>, <name><surname>Hall</surname><given-names>T</given-names></name>, <name><surname>Morgan</surname><given-names>A</given-names></name> (<year>1982</year>) <article-title>The chromosome inversion problem</article-title>. <source>J Theor Biol</source>
<volume>99</volume>: <fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Bergeron1">
      <label>34</label>
      <mixed-citation publication-type="other">Bergeron A, Corteel S, Raffinot M (2002) The algorithmic of gene teams. In: Guigó R, Gusfield D, editors, WABI 2002. Heidelberg: Springer, volume 2452, pp. 464–476.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Bergeron2">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bergeron</surname><given-names>A</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>On the similarity of sets of permutations and its applications to genome comparison</article-title>. <source>J Comp Biol</source>
<volume>13</volume>: <fpage>1340</fpage>–<lpage>1354</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-LibenNowell1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Liben-Nowell</surname><given-names>D</given-names></name> (<year>2002</year>) <article-title>Gossip is synteny: Incomplete gossip and the syntenic distance between genomes</article-title>. <source>J Algorithms</source>
<volume>43</volume>: <fpage>264</fpage>–<lpage>283</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Ting1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Ting</surname><given-names>C</given-names></name>, <name><surname>Yong</surname><given-names>HE</given-names></name> (<year>2006</year>) <article-title>Optimal algorithms for uncovering synteny problem</article-title>. <source>J Comb Optimization</source>
<volume>12</volume>: <fpage>421</fpage>–<lpage>432</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Proost1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Proost</surname><given-names>S</given-names></name>, <name><surname>Fostier</surname><given-names>J</given-names></name>, <name><surname>De Witte</surname><given-names>D</given-names></name>, <name><surname>Dhoedt</surname><given-names>B</given-names></name>, <name><surname>Demeester</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>i-ADHoRe 3.0–fast and sensitive detection of genomic homology in extremely large data sets</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e11</fpage>.<pub-id pub-id-type="pmid">22102584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wang1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Debarry</surname><given-names>JD</given-names></name>, <name><surname>Tan</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>MCScanX: a toolkit for detection and evolutionary analysis of gene synteny and collinearity</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e49</fpage>.<pub-id pub-id-type="pmid">22217600</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Roedelsperger1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Roedelsperger</surname><given-names>C</given-names></name>, <name><surname>Dieterich</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>CYNTENATOR: Progressive gene order alignment of 17 vertebrate genomes</article-title>. <source>PLoS ONE</source>
<volume>5</volume>: <fpage>e8861</fpage>.<pub-id pub-id-type="pmid">20126624</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Haas1">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Haas</surname><given-names>BJ</given-names></name>, <name><surname>Delcher</surname><given-names>AL</given-names></name>, <name><surname>Wortman</surname><given-names>JR</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2004</year>) <article-title>DAGchainer: a tool for mining segmental genome duplications and synteny</article-title>. <source>Bioinformatics</source>
<volume>20(18)</volume>: <fpage>3643</fpage>–<lpage>3646</lpage>.<pub-id pub-id-type="pmid">15247098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Doerr1">
      <label>42</label>
      <mixed-citation publication-type="other">Doerr D, Thévenin A, Stoye J (2012) Gene family assignment-free comparative genomics. BMC Bioinformatics 13: S3 19.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Braga1">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Braga</surname><given-names>MD</given-names></name>, <name><surname>Machado</surname><given-names>R</given-names></name>, <name><surname>Ribeiro</surname><given-names>LC</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Genomic distance under gene substitutions</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume> (Suppl. 9)<fpage>S8</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Camacho1">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altschul1">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Byrne1">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Byrne</surname><given-names>KP</given-names></name>, <name><surname>Wolfe</surname><given-names>KH</given-names></name> (<year>2005</year>) <article-title>The Yeast Gene Order Browser: combining curated homology and syntenic context reveals gene fate in polyploid species</article-title>. <source>Genome Res</source>
<volume>15</volume>: <fpage>1456</fpage>–<lpage>1461</lpage>.<pub-id pub-id-type="pmid">16169922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-KellerSchmidt1">
      <label>47</label>
      <mixed-citation publication-type="other">Keller-Schmidt S, Tuğrul M, Eguíluz VM, Hernández-García E, Klemm K (2010) An age dependent branching model for macroevolution. Technical Report 1012.3298v1, arXiv.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Ohno1">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ohno</surname><given-names>S</given-names></name> (<year>1999</year>) <article-title>Gene duplication and the uniqueness of vertebrate genomes circa 1970–1999</article-title>. <source>Seminars in Cell and Developmental Biology</source>
<volume>10</volume>: <fpage>517</fpage>–<lpage>522</lpage>.<pub-id pub-id-type="pmid">10597635</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lynch1">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Lynch</surname><given-names>M</given-names></name>, <name><surname>Conery</surname><given-names>JS</given-names></name> (<year>2000</year>) <article-title>The evolutionary fate and consequences of duplicate genes</article-title>. <source>Science</source>
<volume>290</volume>: <fpage>1151</fpage>–<lpage>1155</lpage>.<pub-id pub-id-type="pmid">11073452</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Xu1">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>W</given-names></name>, <name><surname>Zheng</surname><given-names>C</given-names></name>, <name><surname>Sankoff</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Paths and cycles in breakpoint graph of random multichromosomal genomes</article-title>. <source>J Comput Biol</source>
<volume>14</volume>: <fpage>423</fpage>–<lpage>435</lpage>.<pub-id pub-id-type="pmid">17572021</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-HernandezRosales1">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Hernandez-Rosales</surname><given-names>M</given-names></name>, <name><surname>Wieseke</surname><given-names>N</given-names></name>, <name><surname>Hellmuth</surname><given-names>M</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name> (<year>2014</year>) <article-title>Simulation of gene family histories</article-title>. <source>BMC Bioinformatics</source>
<volume>15</volume>: <fpage>S3</fpage>–<lpage>A8</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Strope1">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Strope</surname><given-names>CL</given-names></name>, <name><surname>Abel</surname><given-names>K</given-names></name>, <name><surname>Scott</surname><given-names>SD</given-names></name>, <name><surname>Moriyama</surname><given-names>EN</given-names></name> (<year>2009</year>) <article-title>Biological sequence simulation for testing complex evolutionary hypotheses: indel-Seq-Gen version 2.0</article-title>. <source>Mol Biol Evol</source>
<volume>26</volume>: <fpage>2581</fpage>–<lpage>2593</lpage>.<pub-id pub-id-type="pmid">19651852</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chang1">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Chang</surname><given-names>MSS</given-names></name>, <name><surname>Brenner</surname><given-names>SA</given-names></name> (<year>2004</year>) <article-title>Empirical analysis of protein insertions and deletions determining parameters for the correct placement of gaps in protein sequence alignments</article-title>. <source>J Mol Biol</source>
<volume>341</volume>: <fpage>617</fpage>–<lpage>631</lpage>.<pub-id pub-id-type="pmid">15276848</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dalquen1">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Dalquen</surname><given-names>DA</given-names></name>, <name><surname>Anisimova</surname><given-names>M</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>ALF–a simulation framework for genome evolution</article-title>. <source>Mol Biol Evol</source>
<volume>29</volume>: <fpage>1115</fpage>–<lpage>1123</lpage>.<pub-id pub-id-type="pmid">22160766</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Flicek1">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Ensembl 2011</article-title>. <source>Nucleic Acids Res</source>
<volume>39</volume>: <fpage>800</fpage>–<lpage>806</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Rolland1">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Rolland</surname><given-names>T</given-names></name>, <name><surname>Neuvéglise</surname><given-names>C</given-names></name>, <name><surname>Sacerdot</surname><given-names>C</given-names></name>, <name><surname>Dujon</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>Insertion of horizontally transferred genes within conserved syntenic regions of yeast genomes</article-title>. <source>PLoS One</source>
<volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Kristensen1">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Kristensen</surname><given-names>DM</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Mushegian</surname><given-names>AR</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2011</year>) <article-title>Computational methods for Gene Orthology inference</article-title>. <source>Brief Bioinform</source>
<volume>12</volume>: <fpage>379</fpage>–<lpage>391</lpage>.<pub-id pub-id-type="pmid">21690100</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Creevey1">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Creevey</surname><given-names>CJ</given-names></name>, <name><surname>Muller</surname><given-names>J</given-names></name>, <name><surname>Doerks</surname><given-names>T</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Arendt</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Identifying single copy orthologs in Metazoa</article-title>. <source>PLoS Comput Biol</source>
<volume>7</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Franzn1">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Franzén</surname><given-names>O</given-names></name>, <name><surname>Jerlström-Hultqvist</surname><given-names>J</given-names></name>, <name><surname>Einarsson</surname><given-names>E</given-names></name>, <name><surname>Ankarklev</surname><given-names>J</given-names></name>, <name><surname>Ferella</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Transcriptome profiling of <italic>Giardia intestinalis</italic> using strand-specific RNA-seq</article-title>. <source>PLoS Comput Biol</source>
<volume>9</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Liu1">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>GB</given-names></name>, <name><surname>Ying</surname><given-names>Y</given-names></name> (<year>2013</year>) <article-title>Development of universal genetic markers based on single-copy orthologous (COSII) genes in Poaceae</article-title>. <source>Plant Cell Rep</source>
<volume>32</volume>: <fpage>379</fpage>–<lpage>388</lpage>.<pub-id pub-id-type="pmid">23233129</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4138177</article-id>
    <article-id pub-id-type="pmid">25137074</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-17784</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0105015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
            <subject>Evolutionary Modeling</subject>
            <subject>Genome Analysis</subject>
            <subject>Genome Evolution</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subject>Evolutionary Theory</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Data Management</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Orthology Detection Combining Clustering and Synteny for Very Large Datasets</article-title>
      <alt-title alt-title-type="running-head">Combining Clustering and Synteny for Orthology Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lechner</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hernandez-Rosales</surname>
          <given-names>Maribel</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Doerr</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wieseke</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="aff8">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thévenin</surname>
          <given-names>Annelyse</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stoye</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hartmann</surname>
          <given-names>Roland K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prohaska</surname>
          <given-names>Sonja J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff9">
          <sup>9</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff10">
          <sup>10</sup>
        </xref>
        <xref ref-type="aff" rid="aff11">
          <sup>11</sup>
        </xref>
        <xref ref-type="aff" rid="aff12">
          <sup>12</sup>
        </xref>
        <xref ref-type="aff" rid="aff13">
          <sup>13</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Institut für Pharmazeutische Chemie, Philipps-Universität Marburg, Marburg, Germany</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Bioinformatics Group, Department of Computer Science, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Interdisciplinary Center for Bioinformatics, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>Max Planck Institute for Mathematics in the Sciences, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff5">
      <label>5</label>
      <addr-line>Departamento de Ciência da Computação, Instituto de Ciências Exatas, Universidade de Brasília, Brasília, Brasil</addr-line>
    </aff>
    <aff id="aff6">
      <label>6</label>
      <addr-line>Genome Informatics, Faculty of Technology, Bielefeld University, Bielefeld, Germany</addr-line>
    </aff>
    <aff id="aff7">
      <label>7</label>
      <addr-line>Institute for Bioinformatics, Center for Biotechnology, Bielefeld University, Bielefeld, Germany</addr-line>
    </aff>
    <aff id="aff8">
      <label>8</label>
      <addr-line>Faculty of Mathematics and Computer Science University of Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff9">
      <label>9</label>
      <addr-line>Computational EvoDevo Group, Department of Computer Science, Universität Leipzig, Leipzig, Germany</addr-line>
    </aff>
    <aff id="aff10">
      <label>10</label>
      <addr-line>Institute for Theoretical Chemistry, University of Vienna, Vienna, Austria</addr-line>
    </aff>
    <aff id="aff11">
      <label>11</label>
      <addr-line>Center for non-coding RNA in Technology and Health, University of Copenhagen, Frederiksberg, Denmark</addr-line>
    </aff>
    <aff id="aff12">
      <label>12</label>
      <addr-line>The Santa Fe Institute, Santa Fe, New Mexico, United States of America</addr-line>
    </aff>
    <aff id="aff13">
      <label>13</label>
      <addr-line>RNomics Group, Fraunhofer Institut for Cell Therapy and Immunology, Leipzig, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouzounis</surname>
          <given-names>Christos A.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hellas, Greece</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>lechner@staff.uni-marburg.de</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: ML MHR JS SJP PFS. Analyzed the data: ML. Contributed reagents/materials/analysis tools: ML MHR DD AT NW. Contributed to the writing of the manuscript: ML RKH PFS. Performed the simulations: ML DD. Read and approved the final manuscript: ML MHR DD NW AT JS RKH SJP PFS.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>8</issue>
    <elocation-id>e105015</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Lechner et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Lechner et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The elucidation of orthology relationships is an important step both in gene function prediction as well as towards understanding patterns of sequence evolution. Orthology assignments are usually derived directly from sequence similarities for large data because more exact approaches exhibit too high computational costs. Here we present <monospace>PoFF</monospace>, an extension for the standalone tool <monospace>Proteinortho</monospace>, which enhances orthology detection by combining clustering, sequence similarity, and synteny. In the course of this work, <monospace>FFAdj-MCS</monospace>, a heuristic that assesses pairwise gene order using adjacencies (a similarity measure related to the breakpoint distance) was adapted to support multiple linear chromosomes and extended to detect duplicated regions. <monospace>PoFF</monospace> largely reduces the number of false positives and enables more fine-grained predictions than purely similarity-based approaches. The extension maintains the low memory requirements and the efficient concurrency options of its basis <monospace>Proteinortho</monospace>, making the software applicable to very large datasets.</p>
    </abstract>
    <funding-group>
      <funding-statement>We acknowledge support for the Article Processing Charge by the German Research Foundation and the Open Access Publication Fund of Bielefeld University Library. This work was supported in part by the Deutsche Forschungsgemeinschaft grants no. GRK-1384, MA5082/1- 1, MI439/14-1. DD receives a scholarship from the CLIB Graduate Cluster Industrial Biotechnology. AT is a research fellow of the Alexander von Humboldt Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files. The source code of PoFF as well as the Online Supplemental Material can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/poff/">http://www.bioinf.uni-leipzig.de/Software/poff/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files. The source code of PoFF as well as the Online Supplemental Material can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/poff/">http://www.bioinf.uni-leipzig.de/Software/poff/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Detailed knowledge on the history of large gene families is crucial to the understanding of their patterns of sequence evolution and their functional interpretation. Throughout this contribution we use the term “gene” to denote any genomic feature that can be represented as a sequence interval. No further functional or structural properties are implied. An important step towards this goal is the elucidation of orthology relationships. Two genes are <underline>orthologs</underline> if they arose via a speciation event from their last common ancestor in the gene tree. In contrast, <underline>paralogs</underline> originate from a gene duplication event <xref rid="pone.0105015-Fitch1" ref-type="bibr">[1]</xref>, <xref rid="pone.0105015-Fitch2" ref-type="bibr">[2]</xref>. The definition of orthology implies that an event-annotated gene tree is available, and thus a gene tree and its reconciliation with the underlying species tree must be known to determine with certainty which pairs of genes are orthologs. Since ancestral states are in general experimentally inaccessible, the orthology relation, just like the gene phylogeny, has to be inferred from extant sequence data.</p>
    <p>A large class of orthology detection tools therefore attempts to explicitly infer gene phylogenies and their reconciliation with species trees, e.g. <monospace>Orthology analysis using MCMC</monospace>
<xref rid="pone.0105015-Arvestad1" ref-type="bibr">[3]</xref>, <monospace>MultiMSOAR</monospace>
<xref rid="pone.0105015-Shi1" ref-type="bibr">[4]</xref>, <monospace>LOFT</monospace>
<xref rid="pone.0105015-vanderHeijden1" ref-type="bibr">[5]</xref>, <monospace>Ensembl Compara</monospace>
<xref rid="pone.0105015-Hubbard1" ref-type="bibr">[6]</xref>, and <monospace>Synergy</monospace>
<xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. Although this tree-based approach is often considered the most accurate, it suffers from high computational costs and is hence limited in practice to a moderate number of species and genes. Moreover, all practical issues that hamper phylogenetic inference (e.g. variability of evolutionary rate, mistaken homology, homoplasy, and horizontal gene transfer) limit the accuracy of both the gene and the species trees.</p>
    <p>The second class of algorithms bypasses the construction of gene and species trees by directly deriving orthology assignments from similarity data. Approaches of this type are <monospace>COG</monospace>
<xref rid="pone.0105015-Tatusov1" ref-type="bibr">[8]</xref>, <monospace>OrthoMCL</monospace>
<xref rid="pone.0105015-Li1" ref-type="bibr">[9]</xref>, <xref rid="pone.0105015-Chen1" ref-type="bibr">[10]</xref>, <monospace>OMA</monospace>
<xref rid="pone.0105015-Schneider1" ref-type="bibr">[11]</xref>, <xref rid="pone.0105015-Altenhoff1" ref-type="bibr">[12]</xref>, <monospace>InParanoid</monospace>
<xref rid="pone.0105015-Berglund1" ref-type="bibr">[13]</xref>, <monospace>eggNOG</monospace>
<xref rid="pone.0105015-Jensen1" ref-type="bibr">[14]</xref>, <monospace>HomoloGene</monospace>
<xref rid="pone.0105015-Wheeler1" ref-type="bibr">[15]</xref>, <monospace>Roundup</monospace> 2.0 <xref rid="pone.0105015-DeLuca1" ref-type="bibr">[16]</xref>, or <monospace>EGM2</monospace>
<xref rid="pone.0105015-Mahmood1" ref-type="bibr">[17]</xref>. Since orthology is not a transitive relation, the problem of orthology detection is fundamentally different from clustering or partitioning of the input gene set. In particular, a set <italic>A</italic> of genes can be orthologous to another gene <inline-formula><inline-graphic xlink:href="pone.0105015.e001.jpg"/></inline-formula> but the genes within <italic>A</italic> are not necessarily orthologous to each other. In this case, the genes in <italic>A</italic> are called co-orthologs to gene <italic>x</italic>
<xref rid="pone.0105015-Koonin1" ref-type="bibr">[18]</xref>. A common feature of most of the methods mentioned above is that they do not produce an estimate for the pairwise orthology relations but return orthologous groups containing genes which are mutually orthologous to the greatest extent but also comprise co-orthologous genes. We refer to these groups as orthologous groups in the following. In addition to <monospace>OMA</monospace> and <monospace>Proteinortho</monospace>
<xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref>, only <monospace>Synergy</monospace>, <monospace>EGM2</monospace>, and <monospace>InParanoid</monospace> attempt to resolve the orthology relation at the level of gene pairs. The latter two tools can only be used for the analysis of two species at a time, while <monospace>Synergy</monospace> is not available as standalone tool and therefore cannot be applied to arbitrary user-defined datasets. The use of these tools is limited to the species offered through the databases published by their authors.</p>
    <p>The orthology relation can be represented as a graph on the set of genes. It forms a cograph rather than a partition <xref rid="pone.0105015-Hellmuth1" ref-type="bibr">[20]</xref>. Clustering approaches identify dense subgraphs of these cographs and hence introduce false-positive edges corresponding to recent paralogs. On the other hand, ancient paralogs are often separated into different groups of co-orthologs. Despite this theoretical shortcoming, cluster-based methods have consistently been reported to yield very good results <xref rid="pone.0105015-Altenhoff2" ref-type="bibr">[21]</xref>–<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref>. Since they are much faster than tree-based algorithms, they can be applied to very large datasets.</p>
    <p>The clustering method and, in many cases, user-defined parameters determine the granularity of the orthologous groups and thus the tolerance to false positive orthology assignments. Some methods are very inclusive <xref rid="pone.0105015-vanderHeijden1" ref-type="bibr">[5]</xref>, but the aim typically is to remove as many paralogs as possible to approach a one-to-one orthology relation. These simple relationships are especially useful for phylogenetic analysis and for exact functional predictions. Phylogenomic studies typically employ pipelines such as <monospace>HaMStR</monospace>
<xref rid="pone.0105015-Ebersberger1" ref-type="bibr">[24]</xref> to restrict the data to one-to-one orthologs. When the phylogenetic range of interest includes duplication events however, such approaches are bound to fail <xref rid="pone.0105015-Shi2" ref-type="bibr">[25]</xref>.</p>
    <p>Here we focus on an intermediate balance. Our main aim is to avoid false positive orthology assignments within the phylogenetic range of the reported orthologous groups, while we tolerate recent in-paralogs (speciation preceding duplication) as unavoidable contamination. Clustering approaches for orthology detection are usually based on the “best match method”, which attempts to find orthologs as the sequence in another genome that is most similar to the query. It often fails in the presence of paralogs with comparable similarity to the query. Best match approaches are nevertheless routinely used to gain insight into relationships of genes among phylogenetically very diverse organisms. These approaches are used in particular for gene annotation in newly sequenced genomes for which a well studied close relative is lacking. However, the large number of sequencing projects of the last decade have largely reduced the gaping holes in phylogenetic coverage and most large-scale comparative studies nowadays focus on closely related species or even strains <xref rid="pone.0105015-Grigoriev1" ref-type="bibr">[26]</xref>, <xref rid="pone.0105015-Cao1" ref-type="bibr">[27]</xref>. As a result, the evolutionary distances within a phylogeny of interest are often rather small, hence additional information to resolve evolutionary relationships between genes can be obtained from genomic context. Furthermore synteny, i.e., the conservation of gene order (also referred to as gene context) provides information independent of sequence similarity, which can help to sort paralogs. Both <monospace>Synergy</monospace> and <monospace>EGM2</monospace> incorporate synteny information to compute orthology relations. The <monospace>Synergy</monospace> algorithm achieves high accuracy due to the fact that it reconstructs gene family trees <xref rid="pone.0105015-Wapinski2" ref-type="bibr">[28]</xref>. <monospace>EGM2</monospace> considers synteny by identifying similar genomic regions to detect orthologs. However, this tool is not suitable for large datasets due to its restriction to only two genomes at a time. Genes with a common ancestry that are functionally linked with each other frequently show a conservation in local gene order over long evolutionary distances <xref rid="pone.0105015-Dandekar1" ref-type="bibr">[29]</xref>, <xref rid="pone.0105015-Suyama1" ref-type="bibr">[30]</xref>. Thus, synteny is frequently used to disentangle complex duplication histories, see e.g. <xref rid="pone.0105015-Lehmann1" ref-type="bibr">[31]</xref> and references therein. The intricacies of conserved synteny and positional orthology have been reviewed recently <xref rid="pone.0105015-Dewey1" ref-type="bibr">[32]</xref>.</p>
    <p>The computational prediction of syntenic regions usually relies on the detection of genomic neighborhoods that are conserved between genomes of related species. Proximity relations among genes, such as adjacencies <xref rid="pone.0105015-Waterson1" ref-type="bibr">[33]</xref> (two genes encoded adjacent to each other in several genomes), generalized adjacencies <xref rid="pone.0105015-Bergeron1" ref-type="bibr">[34]</xref> or conserved intervals <xref rid="pone.0105015-Bergeron2" ref-type="bibr">[35]</xref>, are used to assess genomic neighborhoods. Typical methods for the detection of syntenic regions utilize gene family information, similarity scores or conserved distances to establish putative homologies and then apply chaining or clustering algorithms. When paralogous genes are considered, the underlying computational problems become prohibitive because many alternative synteny assignments are possible. Exact algorithms are therefore slow and limited to small datasets. In fact, the problem of computing the syntenic distance between two genomes is NP-hard <xref rid="pone.0105015-LibenNowell1" ref-type="bibr">[36]</xref>, <xref rid="pone.0105015-Ting1" ref-type="bibr">[37]</xref>. Efficient heuristics are therefore employed to deal with large datasets.</p>
    <p>If gene family information is available, popular synteny tools such as <monospace>i-ADHoRe 3.0</monospace>
<xref rid="pone.0105015-Proost1" ref-type="bibr">[38]</xref> and <monospace>MCScanX</monospace>
<xref rid="pone.0105015-Wang1" ref-type="bibr">[39]</xref> can efficiently detect homologous regions even in large-scale analyses. Otherwise, using local alignments of sequences, tools such as <monospace>CYNTENATOR</monospace>
<xref rid="pone.0105015-Roedelsperger1" ref-type="bibr">[40]</xref> and <monospace>DAGchainer</monospace>
<xref rid="pone.0105015-Haas1" ref-type="bibr">[41]</xref> allow for detection of syntenic regions based on pairwise similarity scores of sequence intervals. The heuristic method <monospace>FFAdj-MCS</monospace>
<xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref> has proven to be a good compromise in terms of both, speed and accuracy, as it takes a different approach by calculating a matching whose objective function maximizes towards a balance between adjacencies and similarity scores of genes.</p>
    <p>In this contribution we describe <monospace>PoFF</monospace>, an extension of <monospace>Proteinortho</monospace>
<xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref>, to include synteny information in a systematic way. More precisely, a pair of genes (<italic>A</italic>1, <italic>A</italic>2) in genome <italic>A</italic> is considered syntenous with another pair of genes (<italic>B</italic>1, <italic>B</italic>2) in genome <italic>B</italic>, if both <italic>A</italic>1, <italic>B</italic>1 and <italic>A</italic>2, <italic>B</italic>2 are potential orthologs (as determined by sequence similarity), and both (<italic>A</italic>1, <italic>A</italic>2) as well as (<italic>B</italic>1, <italic>B</italic>2) are adjacent gene pairs on their corresponding chrosomosomal locations. In case other genes are located between (<italic>A</italic>1, <italic>A</italic>2) or (<italic>B</italic>1, <italic>B</italic>2), these must not be orthologous to any other genes in genomes <italic>A</italic> or <italic>B</italic>. <monospace>Proteinortho</monospace> applies an adaptive best match method together with spectral clustering to define (co-)orthologs. Its performance in terms of accuracy has been shown to be comparable to other clustering-based methods. At the same time it has modest requirements in terms of memory and computation time and is thus suitable for very large datasets. Complementing the evaluation of pairwise sequence similarities, we incorporate here the efficient heuristic algorithm <monospace>FFAdj-MCS</monospace> that computes ortholog assignments by maximizing the above synteny measure between pairs of genomes. Following a recent suggestion <xref rid="pone.0105015-Braga1" ref-type="bibr">[43]</xref>, true orthologs among multiple candidates were defined as those that retained their original genomic context. In the course of this work, we adapted <monospace>FFAdj-MCS</monospace> to include multiple linear chromosomes within single organisms and extended it for the detection of duplicated genes and large duplicated genomic regions. We note that the algorithm may also be applied to circular chromosomes at the expense of losing synteny information for at most two pairs of genes at the very ends of the linearized representation. This minor shortcoming should have no or only a vanishingly low effect in the overall process of orthology assignment.</p>
    <p><xref ref-type="fig" rid="pone-0105015-g001">Figure 1</xref> illustrates the idea of the synteny-enhanced version of <monospace>Proteinortho</monospace>. In this example, four genes (<italic>A</italic>1, <italic>A</italic>2, <italic>B</italic>1, <italic>B</italic>2) in two species (<italic>A</italic> and <italic>B</italic>) are considered. The gene tree in <xref ref-type="fig" rid="pone-0105015-g001">Figure 1a</xref> shows a duplication preceding a speciation event. <italic>A</italic>1 and <italic>B</italic>1 as well as <italic>A</italic>2 and <italic>B</italic>2 are orthologous to each other as they derived from a common ancestor by speciation. Given sufficient similarity, however, all four genes would be reported as an orthologous group using regular sequence similarity-based approaches. The gene order depicted in <xref ref-type="fig" rid="pone-0105015-g001">Figure 1b</xref> allows one to distinguish the genes 1 and 2 from each other. The combined approach therefore predicts the two distinct orthologous groups {<italic>A</italic>1, <italic>B</italic>1} and {<italic>A</italic>2, <italic>B</italic>2} and thus avoids false positive orthology assignments.</p>
    <fig id="pone-0105015-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Synteny-enhanced orthology prediction.</title>
        <p>Four genes (<italic>A</italic>1, <italic>A</italic>2, <italic>B</italic>1, <italic>B</italic>2) in two species (<italic>A</italic> and <italic>B</italic>). a) The gene tree with a duplication (filled double circle) and a speciation event (empty circle). b) Gene order in the genomic context of both genes. Genes <italic>A'x</italic> and <italic>B'x</italic> are orthologous to each other. Lines depict suggested partners based on sequence similarity of which the dashed were neglected by the gene order algorithm.</p>
      </caption>
      <graphic xlink:href="pone.0105015.g001"/>
    </fig>
    <p>We argue that the level of granularity achieved in this way is more useful in most cases than an arbitrary separation of groups solely based on sequence similarity scores which tend to lack significance when sequences are closely related. The same holds compared to inclusive strategies which hardly discriminate subgroups. Assuming that numerous extant genes have derived from a limited set of common ancestors by a series of duplication events, inclusive strategies will include entire gene families, and hence lead to very large groups with a significant amount of actually non-orthologous genes. An emphasis on including all pairwise orthology relations when reporting orthologous groups thus seems to be of little use.</p>
    <p>We evaluated <monospace>PoFF</monospace> using several sets of simulated protein-coding genes. Each set was derived from event-annotated gene trees. Thus, for each pair of genes, the true relationship regarding orthology is unambiguously defined and used to validate the predictions. Our results reveal a significant improvement with respect to true negative and false positive predictions at the expense of only a marginal decrease of the true positive rate.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2a">
      <title>Conceptual Outline</title>
      <p>Our starting point for orthology detection is a directed graph <inline-formula><inline-graphic xlink:href="pone.0105015.e002.jpg"/></inline-formula> whose vertices are all the genes of all input genomes. A directed edge <inline-formula><inline-graphic xlink:href="pone.0105015.e003.jpg"/></inline-formula> is introduced if (i) <italic>x</italic> and <italic>y</italic> are taken from two different genomes (<italic>A</italic> and <italic>B</italic>) and (ii) the similarity <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) is not much smaller than the gene <italic>z</italic> in <italic>B</italic> that is most similar to <italic>x</italic>, i.e., if <inline-formula><inline-graphic xlink:href="pone.0105015.e004.jpg"/></inline-formula> for some stringency parameter <italic>f</italic>≤1. Since any true ortholog of <inline-formula><inline-graphic xlink:href="pone.0105015.e005.jpg"/></inline-formula> in genome <italic>B</italic> should be among the most similar sequences that can be found in <italic>B</italic>, <inline-formula><inline-graphic xlink:href="pone.0105015.e006.jpg"/></inline-formula> should have few false negatives (i.e. missing true edges) as long as the stringency is not set to a value that is too restrictive. The idea is, therefore, to remove edges from the graph <inline-formula><inline-graphic xlink:href="pone.0105015.e007.jpg"/></inline-formula> that are likely false positives. Since orthology is a symmetric relation, we only retain edges <inline-formula><inline-graphic xlink:href="pone.0105015.e008.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="pone.0105015.e009.jpg"/></inline-formula> is also contained in <inline-formula><inline-graphic xlink:href="pone.0105015.e010.jpg"/></inline-formula>.</p>
      <p>Synteny information determined by <monospace>FFAdj-MCS</monospace> provides an additional filter for the edge set of <inline-formula><inline-graphic xlink:href="pone.0105015.e011.jpg"/></inline-formula>. By construction, the subgraph <inline-formula><inline-graphic xlink:href="pone.0105015.e012.jpg"/></inline-formula> induced by the genes in <italic>A</italic> and <italic>B</italic> is bipartite. Synteny is modeled as the relative order of edges along both genomes. Synteny as a filter reduces the edge set of <inline-formula><inline-graphic xlink:href="pone.0105015.e013.jpg"/></inline-formula> to a matching that maximizes a trade-off between the total number of edges and the number of conserved adjacencies. Among similar paralogs, this strategy favors the one with the best-conserved local gene order as representative of the orthologous group. In the final step, a clustering algorithm <xref rid="pone.0105015-Lechner1" ref-type="bibr">[19]</xref> is employed to extract groups of co-orthologs from <inline-formula><inline-graphic xlink:href="pone.0105015.e014.jpg"/></inline-formula>, which contains all subgraphs <inline-formula><inline-graphic xlink:href="pone.0105015.e015.jpg"/></inline-formula> for all pairs of genomes.</p>
    </sec>
    <sec id="s2b">
      <title>Implementation</title>
      <p><monospace>Proteinortho</monospace> uses the <monospace>blast</monospace> bit score to determine potential homologs in another species and to measure sequence similarity. The definition of the edge set above makes it possible to construct <inline-formula><inline-graphic xlink:href="pone.0105015.e016.jpg"/></inline-formula> directly from pairwise comparisons. Thus, this initial state can be trivially parallelized and does not require the storage of genome-wide <monospace>blast</monospace> comparison data in memory. As the <monospace>FFAdj-MCS</monospace> algorithm applies to pairs of genomes <italic>A</italic> and <italic>B</italic>, it can be added to the workflow without breaking these advantageous properties. The algorithm requires information on gene order and pairwise gene similarity for two genomes and determines a matching that maximizes a weighted sum of edge weights and weights of conserved adjacencies. To this end <monospace>FFAdj-MCS</monospace> matches genes in regions with conserved gene order that locally maximize the objective of <monospace>FF-Adjacencies</monospace>
<xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref>. These regions are called <underline>maximum common substrings</underline> (MCSs). Since the <monospace>blast</monospace> scores <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) are not symmetric, they are symmetrized (taking the average of both scores) for use in <monospace>FFAdj-MCS</monospace>. The combination <monospace>PoFF</monospace> of <monospace>Proteinortho</monospace> and <monospace>FFAdj-MCS</monospace> yields, for each pair of genomes, a pruned set of edges that is highly enriched in true orthologous pairs. The workflow of our extension is illustrated in <xref ref-type="fig" rid="pone-0105015-g002">Figure 2</xref>.</p>
      <fig id="pone-0105015-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Workflow of <monospace>PoFF</monospace>.</title>
          <p>Similar gene sequences are determined by an all-against-all blast search. Top reciprocal matches are ordered by their positions in the respective genomes. The <monospace>FFAdj-MCS</monospace> algorithm is applied to determine the maximum matching with respect to sequence similarity and gene order. As a result the orthology graph <inline-formula><inline-graphic xlink:href="pone.0105015.e017.jpg"/></inline-formula> only contains the remaining edges from pairwise comparisons. Finally, orthologous groups are extracted by clustering.</p>
        </caption>
        <graphic xlink:href="pone.0105015.g002"/>
      </fig>
      <p>We added three extensions to the <monospace>FFAdj-MCS</monospace> program as presented in <xref rid="pone.0105015-Doerr1" ref-type="bibr">[42]</xref>. Firstly, it was adapted to allow for more than one chromosome per genome. Secondly, the detection of duplicated genes and large duplicated regions was implemented: The heuristic was adapted to repeat a user-defined number of complete matchings, where edges selected by preceding matchings are removed before each subsequent matching. Thirdly, <monospace>FFAdj-MCS</monospace> allows to filter the size of MCSs obtained from subsequent matchings by means of a user-defined minimal size <inline-formula><inline-graphic xlink:href="pone.0105015.e018.jpg"/></inline-formula> that defines the minimum number of gene pairs in each MCS.</p>
      <p>Finally, we relaxed the criteria for very similar neighboring genes: If two adjacent genes <italic>x</italic> and <italic>y</italic> in <italic>A</italic> both have their best alignment to the same gene <inline-formula><inline-graphic xlink:href="pone.0105015.e019.jpg"/></inline-formula>, we include both edges {<italic>x</italic>, <italic>y</italic>} and {<italic>y</italic>, <italic>z</italic>} in <inline-formula><inline-graphic xlink:href="pone.0105015.e020.jpg"/></inline-formula>, since <italic>x</italic> and <italic>y</italic> are likely in-paralogs and a decision for one of the two edges based on a small score difference is not reasonable from a biological perspective. Even though this makes <monospace>PoFF</monospace> more inclusive, we argue that this behavior is more reasonable because such in-paralogs can be quite easily detected in a post-processing step if required for a particular application.</p>
      <p><monospace>PoFF</monospace> has several parameters that can be set by the user – in particular score thresholds and coverage requirements of the <monospace>blast</monospace> searches. We used the default settings throughout. The stringency parameter <italic>f</italic> defines the fraction of the bit score of the best <monospace>blast</monospace> hit that must be reached by an alternative candidate ortholog. <monospace>Proteinortho</monospace>'s default value, <italic>f</italic> = 0.95, has been shown to work also in conjunction with the synteny filter. The <monospace>FFAdj-MCS</monospace> algorithm provides an adjustable parameter <inline-formula><inline-graphic xlink:href="pone.0105015.e021.jpg"/></inline-formula> that controls the relative importance of edge weights and the weights of adjacencies. Benchmarking <monospace>PoFF</monospace> did not reveal a strong dependency of the results on this parameter, likely because nucleotide sequences and order of genes evolve in parallel and with comparable speeds. We therefore used the default value <inline-formula><inline-graphic xlink:href="pone.0105015.e022.jpg"/></inline-formula> throughout. By default, we perform one matching iteration with <inline-formula><inline-graphic xlink:href="pone.0105015.e023.jpg"/></inline-formula> to cover the detection of large duplicated regions. If multiple copies of a region are expected in a dataset, this number of iterative matchings can be increased further. Practical experience with <monospace>Proteinortho</monospace> also led to the decision to increase the default E-value threshold from 10<sup>−10</sup> to 10<sup>−5</sup> in order to improve coverage of less conserved orthologs.</p>
    </sec>
    <sec id="s2c">
      <title>Benchmarking</title>
      <p>Since implementations of competing tools that generate fully resolved orthology relations are not publicly available, we cannot employ the usual evaluation strategy of comparing all tools on series of benchmarking datasets of our choice. Instead we apply both <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> to several reference datasets that either comprise simulated data for which the underlying gene trees are known, or real data which defines orthologous groups and/or pairwise orthologous relationships by extensive analysis, often including manual curation. Results are then compared to the published performance of alternative tools.</p>
      <p>For <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> we used standard parameters, including an E-value threshold of 10<sup>−5</sup>. However, the more recent <monospace>blastp+</monospace> software <xref rid="pone.0105015-Camacho1" ref-type="bibr">[44]</xref> instead of the original <monospace>blastp</monospace> implementation <xref rid="pone.0105015-Altschul1" ref-type="bibr">[45]</xref> was applied to find the initial matches. This can be set by a parameter in <monospace>Proteinortho</monospace>.</p>
      <p>The generation of simulated data is described below. As some of these sets were sufficiently small, we also applied <monospace>OrthoMCL</monospace>, <monospace>OMA</monospace> and <monospace>InParanoid</monospace> in order to evaluate the results. Again, standard parameters were used, including an E-value threshold of 10<sup>−5</sup> for <monospace>OrthoMCL</monospace>. Real life data was taken from various sources also described hereafter. The <monospace>YGOB</monospace> dataset <xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref>, was used in a previous study to evaluate the <monospace>Synergy</monospace> approach <xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. Hence, we took the opportunity to include the available results to the benchmark.</p>
      <sec id="s2c1">
        <title>Simulated data</title>
        <p>In the absence of extensive gold standard datasets comprising sequence and synteny data as well as the underlying gene trees that could be used for benchmarking our orthology prediction method, we simulated sequence evolution and genomic rearrangements on a single chromosome for three example datasets comprising 50, 80 and 100 gene families (proteins) in 20 species (named hereafter <italic>F</italic>50, <italic>F</italic>80<italic>d</italic> and <italic>F</italic>100, respectively). All test sets feature duplications of both individual genes and gene clusters. The set <italic>F</italic>80<italic>d</italic> in addition includes whole genome duplications. <xref ref-type="table" rid="pone-0105015-t001">Table 1</xref> gives a closer look to the composition of all three datasets as well as to their average breakpoint distances determined by <monospace>PoFF</monospace>. The simulation pipeline is available in the Online Supplemental Material.</p>
        <table-wrap id="pone-0105015-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Composition of simulated datasets.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0105015-t001-1" xlink:href="pone.0105015.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Dataset</td>
                  <td align="left" rowspan="1" colspan="1">Families</td>
                  <td align="left" rowspan="1" colspan="1">Proteins</td>
                  <td align="left" rowspan="1" colspan="1">ø Family size</td>
                  <td align="left" rowspan="1" colspan="1">ø Breakpoint distance</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>50</td>
                  <td align="left" rowspan="1" colspan="1">50</td>
                  <td align="left" rowspan="1" colspan="1">8,363</td>
                  <td align="left" rowspan="1" colspan="1">167 proteins</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>80<italic>d</italic></td>
                  <td align="left" rowspan="1" colspan="1">80</td>
                  <td align="left" rowspan="1" colspan="1">15,296</td>
                  <td align="left" rowspan="1" colspan="1">191 proteins</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"><italic>F</italic>100</td>
                  <td align="left" rowspan="1" colspan="1">100</td>
                  <td align="left" rowspan="1" colspan="1">27,258</td>
                  <td align="left" rowspan="1" colspan="1">273 proteins</td>
                  <td align="left" rowspan="1" colspan="1">14</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>The simulated datasets differ by the number of gene families present in the species as well as by the size of these families. The larger the families the more diversity among the set of species can be considered. Set <italic>F</italic>80<italic>d</italic> additionally comprises whole genome duplications.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Species trees were simulated according to the <italic>Age Model</italic>
<xref rid="pone.0105015-KellerSchmidt1" ref-type="bibr">[47]</xref>. These trees are balanced and edge lengths are normalized so that the total length of the path from the root to each leaf is 1. For each species tree <italic>S</italic>, we then simulated gene trees using the following rules:</p>
        <list list-type="order">
          <list-item>
            <p>The root of <italic>S</italic> contains an ordered list of ancestral genes one for each gene family. The number of families is a user-defined parameter.</p>
          </list-item>
          <list-item>
            <p><italic>S</italic> is traversed in a depth first order. All changes to the genome are simulated independently for each edge of <italic>S</italic> with constant rates.</p>
          </list-item>
          <list-item>
            <p>At each internal node of <italic>S</italic>, the ordered gene list received from its parental edge is copied without change to both offspring edges.</p>
          </list-item>
          <list-item>
            <p>Along each edge of <italic>S</italic> a number of events is sampled from a Poisson Process <inline-formula><inline-graphic xlink:href="pone.0105015.e024.jpg"/></inline-formula>, where the parameter <inline-formula><inline-graphic xlink:href="pone.0105015.e025.jpg"/></inline-formula> is the probability of the event to happen and <italic>l</italic> is the branch length. The process may generate none, one, or several events of the following types: gene duplication, cluster duplication, genome duplication, and gene loss. Here we used the parameters <inline-formula><inline-graphic xlink:href="pone.0105015.e026.jpg"/></inline-formula> for gene duplication, <inline-formula><inline-graphic xlink:href="pone.0105015.e027.jpg"/></inline-formula> for cluster duplication, <inline-formula><inline-graphic xlink:href="pone.0105015.e028.jpg"/></inline-formula> for gene loss. For the dataset <italic>F</italic>80<italic>d</italic> we consider genome duplications with <inline-formula><inline-graphic xlink:href="pone.0105015.e029.jpg"/></inline-formula> instead.</p>
          </list-item>
          <list-item>
            <p>A special rule applies to recently duplicated genes to account for the deletion of redundant gene copies before they can be stabilized by sufficient functional divergence or subfunctionalization <xref rid="pone.0105015-Ohno1" ref-type="bibr">[48]</xref>, <xref rid="pone.0105015-Lynch1" ref-type="bibr">[49]</xref>. We model this by a probability of 0.3.</p>
          </list-item>
          <list-item>
            <p>To obtain an order of the generated genes, rearrangements are carried out for each edge of <italic>S</italic> using translocation and inversion operations on the ordered list of genes that “survived” until the next speciation. Rearrangements are picked randomly and the number of inversion operations is chosen uniformly proportional to the branch length <xref rid="pone.0105015-Xu1" ref-type="bibr">[50]</xref>.</p>
          </list-item>
        </list>
        <p>The result of this simulation is a gene tree <italic>G<sub>i</sub></italic> for each family <italic>i</italic> together with a true reconciliation map to the species tree <italic>S</italic>. All gene lineages terminating in a deletion event are pruned from the gene tree so that we retain a gene tree <italic>G<sub>i</sub></italic> in which only extant genes appear as its leaves. The known reconciliation furthermore provides us with a labeling of the internal nodes of <italic>G<sub>i</sub></italic> with <italic>duplication</italic> or <italic>speciation</italic> events, see <xref ref-type="fig" rid="pone-0105015-g003">Figure 3</xref> for an example. This in turn determines the true orthology relation for all genes received in the leaves of <italic>S</italic>. In addition, the gene orders within their respective genomes are obtained. The simulations were performed using a simulation environment for large gene families <xref rid="pone.0105015-HernandezRosales1" ref-type="bibr">[51]</xref>.</p>
        <fig id="pone-0105015-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>A reconciled tree for gene families.</title>
            <p>The gene tree is embedded in the species tree. Internal nodes represent either gene duplication (filled double circle) or speciation events (empty circles). Gene loss is depicted by ×.</p>
          </caption>
          <graphic xlink:href="pone.0105015.g003"/>
        </fig>
        <p>Since large-scale orthology analysis are usually performed for protein sequences, we use <monospace>indel-Seq-Gen</monospace>
<xref rid="pone.0105015-Strope1" ref-type="bibr">[52]</xref> to generate simulated amino acid (aa) sequences for the gene trees <italic>G<sub>i</sub></italic>. For each gene family a random seed sequence is initiated with a length between 100 and 1,000 aa. Then, to define the offspring genes, <monospace>indel-Seq-Gen</monospace> introduces substitutions according to <monospace>PAM</monospace> substitution matrix and insertions and deletions with a Zipfian probability distribution <xref rid="pone.0105015-Chang1" ref-type="bibr">[53]</xref> with maximal length between 1% to 10% of the sequence length. For the gene trees a branch scale factor of 0.5 was used. This is the frequency of a single amino acid to be substituted. Hence, approximately half of the amino acids are changed during the simulation on the path from the root to the leaf.</p>
        <p>We remark that the Artificial Life Framework (<monospace>ALF</monospace>) <xref rid="pone.0105015-Dalquen1" ref-type="bibr">[54]</xref> for simulating sequence evolution could in principle have been used for simulating test data. However, in its current version, this tool does not support genome-wide duplications and selective loss of recently duplicated genes. We therefore opted to construct our own simulation framework.</p>
      </sec>
      <sec id="s2c2">
        <title>Real life data</title>
        <p>COG: We used proteome data from the <monospace>COG</monospace>-database, which provides manually curated orthology relations (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/pub/COG/COG/">ftp://ftp.ncbi.nih.gov/pub/COG/COG/</ext-link>, 2009/10/15), for the following set of 16 species covering three bacterial groups: <italic>Bacillus halodurans</italic>, <italic>Bacillus subtilis</italic>, <italic>Lactococcus lactis</italic>, <italic>Listeria innocua</italic>, <italic>Streptococcus pneumoniae</italic> TIGR4, <italic>Streptococcus pyogenes</italic> M1 GAS from the Gram-positive bacilli class, <italic>Buchnera sp.</italic> APS, <italic>Escherichia coli</italic> K12, <italic>Pasteurella multocida</italic>, <italic>Salmonella typhimurium</italic> LT2, <italic>Vibrio cholerae</italic>, <italic>Yersinia pestis</italic> from the gamma proteobacteria class and <italic>Brucella melitensis</italic>, <italic>Caulobacter vibrioides</italic>, <italic>Mesorhizobium loti</italic>, <italic>Rickettsia prowazekii</italic> from the alpha proteobacteria class. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 642.</p>
        <p>To obtain the gene orders we retrieved the genomes from the <monospace>NCBI</monospace>-database (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/">ftp://ftp.ncbi.nih.gov/genomes/Bacteria/</ext-link>, 2012/12/13, see supplement). When several strains were available, we picked the one with the smallest <underline>uid</underline> as they represent the older genomes preferentially included in secondary databases. All genes were then located in the genomes using <monospace>tblastn+</monospace> with an E-value threshold of 10<sup>−8</sup>. The best match was considered to be the gene of interest. A small minority of genes (98 out of 53,264) could not be located unambiguously and was thus removed from the dataset.</p>
        <p>As we used an extract of the <monospace>COG</monospace>-database (16 out of 66 species), only <monospace>COG</monospace>-groups covering at least eight proteins within the set of the chosen 16 species were considered to estimate the orthology matrix as described below (see Evaluation). Otherwise, their classification might have been based on species not in the dataset used here, which would make a comparison of approaches unreasonable.</p>
        <p>OrthoBench: We also used the reference annotation <monospace>OrthoBench</monospace>
<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref>. Manually curated orthologous groups were downloaded from <ext-link ext-link-type="uri" xlink:href="http://eggnog.embl.de/orthobench/">http://eggnog.embl.de/orthobench/</ext-link> at 2013/01/05. The set comprises 12 metazoan proteomes and is based on the <monospace>Ensembl</monospace>
<italic>v</italic>60 genome annotation <xref rid="pone.0105015-Flicek1" ref-type="bibr">[55]</xref> which was downloaded from <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ensembl.org/pub/release-60/">ftp://ftp.ensembl.org/pub/release-60/</ext-link> at 2013/01/11. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 5,433. 124 out of 1,692 proteins stated in <monospace>OrthoBench</monospace> could not be located in the <italic>v</italic>60 set and were excluded from the analysis.</p>
        <p>YGOB: From this dataset we obtained orthology assignments of five ascomycete fungi <italic>Ashbya gossypii</italic>, <italic>Saccharomyces cerevisiae</italic>, <italic>Candida glabrata</italic>, <italic>Kluyveromyces lactis</italic>, and <italic>Kluyveromyces waltii</italic> that have been used in the evaluation of <monospace>Synergy</monospace> in the original study <xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. According to <monospace>PoFF</monospace>, the average breakpoint distance of this set is 2, 697. The data provided by the authors included pairwise <monospace>blast</monospace> results with an E-value threshold of 10<sup>−5</sup>, which we directly used in our analysis, omitting the <monospace>blast</monospace> step. In this way, the initial blast data on which <monospace>Synergy</monospace>, <monospace>Proteinortho</monospace>, and <monospace>PoFF</monospace> operated was assured to be identical. We then compared orthologs predicted by the three approaches to orthologs from the YGOB dataset (v1, 2005) <xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref>. We excluded genes from the predictions that were not contained in the <monospace>YGOB</monospace> dataset (6, 218, 6, 076 and 6, 817 out of 23, 134 for <monospace>Proteinortho</monospace>, <monospace>PoFF</monospace> and <monospace>Synergy</monospace>, respectively). In this way, we avoid to bias our evaluation with data that is not present in the reference dataset.</p>
      </sec>
      <sec id="s2c3">
        <title>Evaluation</title>
        <p>For each gene family/orthologous group in the reference sets, we compared the pairwise orthologous relationships between its members to the predictions, counting true positives (<italic>tp</italic>), false positives (<italic>fp</italic>), true negatives (<italic>tn</italic>) and false negatives (<italic>fn</italic>) as well as the number of orthology relations between reference groups. These data were then used for statistics as follows:<disp-formula id="pone.0105015.e030"><graphic xlink:href="pone.0105015.e030.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
        <p>For evaluation of <monospace>PoFF</monospace> and <monospace>Proteinortho</monospace>, we used the orthology graph returned in addition to orthologous groups which contains information on pairwise orthology relations. <monospace>OMA</monospace> returns this graph equivalently in the <underline>PairwiseOrthologs</underline> output. <monospace>InParanoid</monospace> was applied to all pairs of species successively. After merging the results, this resulted in pairwise orthology relations for the whole dataset as well. <monospace>OrthoMCL</monospace> on the other hand, does not return the orthology graph directly. We extracted the information on pairwise orthology relations from the <monospace>MCL</monospace> clustering output file. Connected components in there are used by <monospace>OrthoMCL</monospace> to determine orthologous groups, making this output file similar to the orthology graph returned by <monospace>PoFF/Proteinortho</monospace>. We note however, that the file was not meant to be used as orthology graph. Given the mode of calculation applied by <monospace>OrthoMCL</monospace>, it contains numerous orthology relations for paralogs of the same species which cannot occur using <monospace>PoFF/Proteinortho</monospace>. For <monospace>Synergy</monospace> and <monospace>YGOB</monospace>, pairwise orthology relations were present. For <monospace>COG</monospace> and <monospace>OrthoBench</monospace>, however, only data on orthologous groups was provided. The pairwise orthology relations had to be estimated. We did this by assuming each protein of an orthologous group to be orthologous to each other protein in the same group, except when both proteins belong to the same species. We emphasize that this strategy strictly overestimates the number of orthologous relationships in the dataset. Nonetheless, this method makes it possible to compare the results on a pairwise level.</p>
        <p>The simulated data also provides gene trees. These were used to acquire pairwise orthology relations. Two genes of a simulated gene family are orthologous to each other, if and only if their most recent common ancestor event was a speciation.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>In order to estimate how <monospace>PoFF</monospace> performs with respect to closely related species and compared to the original <monospace>Proteinortho</monospace> implementation, we simulated and subsequently evaluated three datasets (<italic>F</italic>50, <italic>F</italic>80<italic>d</italic>, <italic>F</italic>100), for which the gene histories and hence the true orthology relations are defined. The datasets differ in number and size of gene families, thus representing increasing levels of diversity among closely related species. The results are summarized in <xref ref-type="table" rid="pone-0105015-t002">Table 2</xref>. <monospace>Proteinortho</monospace> already performs very efficiently. However, as the number of paralogs with similar sequences increases, the basic algorithm becomes less effective in precisely predicting the correct orthology relations within these gene families, a trend that exacerbates with increasing size of gene families. The use of the synteny information provided by the <monospace>FFAdj-MCS</monospace> algorithm efficiently counteracts this tendency and substantially improves the precision. Other performance statistics as well as the runtime remain nearly unchanged, which indicates a significant advantage of <monospace>PoFF</monospace> over the original <monospace>Proteinortho</monospace> tool.</p>
    <table-wrap id="pone-0105015-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison using simulated data.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0105015-t002-2" xlink:href="pone.0105015.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset</td>
              <td align="left" rowspan="1" colspan="1">Method</td>
              <td align="left" rowspan="1" colspan="1">Precision</td>
              <td align="left" rowspan="1" colspan="1">Recall</td>
              <td align="left" rowspan="1" colspan="1">Accuracy</td>
              <td align="left" rowspan="1" colspan="1"><italic>tn</italic> rate</td>
              <td align="left" rowspan="1" colspan="1">Runtime</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">F50</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">3.06%</td>
              <td align="left" rowspan="1" colspan="1">7.26%</td>
              <td align="left" rowspan="1" colspan="1">86.18%</td>
              <td align="left" rowspan="1" colspan="1">89.71%</td>
              <td align="left" rowspan="1" colspan="1">7 h, 22 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OMA</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">38.64%</td>
              <td align="left" rowspan="1" colspan="1">9.62%</td>
              <td align="left" rowspan="1" colspan="1">95.49%</td>
              <td align="left" rowspan="1" colspan="1">99.32%</td>
              <td align="left" rowspan="1" colspan="1">1 day, 14 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">98.01%</td>
              <td align="left" rowspan="1" colspan="1">5.02%</td>
              <td align="left" rowspan="1" colspan="1">95.94%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">2 days, 2 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">80.63%</td>
              <td align="left" rowspan="1" colspan="1">23.11%</td>
              <td align="left" rowspan="1" colspan="1">97.62%</td>
              <td align="left" rowspan="1" colspan="1">99.83%</td>
              <td align="left" rowspan="1" colspan="1">0 h, 36 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">96.15%</td>
              <td align="left" rowspan="1" colspan="1">24.18%</td>
              <td align="left" rowspan="1" colspan="1">97.53%</td>
              <td align="left" rowspan="1" colspan="1">99.96%</td>
              <td align="left" rowspan="1" colspan="1">0 h, 36 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">F80d</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">0.92%</td>
              <td align="left" rowspan="1" colspan="1">0.88%</td>
              <td align="left" rowspan="1" colspan="1">87.44%</td>
              <td align="left" rowspan="1" colspan="1">93.43%</td>
              <td align="left" rowspan="1" colspan="1">15 h, 46 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OMA</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">43.97%</td>
              <td align="left" rowspan="1" colspan="1">5.25%</td>
              <td align="left" rowspan="1" colspan="1">93.51%</td>
              <td align="left" rowspan="1" colspan="1">99.54%</td>
              <td align="left" rowspan="1" colspan="1">3 days, 23 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">97.67%</td>
              <td align="left" rowspan="1" colspan="1">0.89%</td>
              <td align="left" rowspan="1" colspan="1">93.65%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">8 days, 23 h</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">79.36%</td>
              <td align="left" rowspan="1" colspan="1">16.64%</td>
              <td align="left" rowspan="1" colspan="1">97.68%</td>
              <td align="left" rowspan="1" colspan="1">99.88%</td>
              <td align="left" rowspan="1" colspan="1">1 h, 29 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">93.98%</td>
              <td align="left" rowspan="1" colspan="1">15.52%</td>
              <td align="left" rowspan="1" colspan="1">97.30%</td>
              <td align="left" rowspan="1" colspan="1">99.96%</td>
              <td align="left" rowspan="1" colspan="1">1 h, 30 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">F100</td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoMCL/OMA/InParanoid</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">&gt;31 days</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">23.99%</td>
              <td align="left" rowspan="1" colspan="1">20.48%</td>
              <td align="left" rowspan="1" colspan="1">99.37%</td>
              <td align="left" rowspan="1" colspan="1">99.71%</td>
              <td align="left" rowspan="1" colspan="1">6 h, 39 min</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">90.16%</td>
              <td align="left" rowspan="1" colspan="1">18.17%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.99%</td>
              <td align="left" rowspan="1" colspan="1">6 h, 44 min</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Comparison of computational results with orthology relations derived from simulated datasets with different gene family sizes. Statistical values are explained in <xref ref-type="sec" rid="s2">Materials and Methods</xref>. <italic>tn</italic> rate refers to true negative rate. Running time was measured on a quad core CPU (Intel core i7 at 2.9 GHz) with eight threads.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>It would be desirable to include several other orthology detection tools to directly compare the results achieved using the simulated datasets. To our knowledge, only <monospace>OrthoMCL</monospace>, <monospace>OMA</monospace>, <monospace>InParanoid</monospace> and <monospace>Roundup 2.0</monospace> are available as standalone tools that can be used for large input datasets. Since <monospace>Roundup 2.0</monospace> largely relies on a commercial implementation of <monospace>blast</monospace>, we were only able to include the first two tools in the benchmark. We observed that <monospace>OrthoMCL</monospace> is very inclusive. It returns huge orthologous groups comprising whole gene families but, according to the results, does not reflect pairwise orthology to a reasonable extent. This results in a large number of false positive predictions. It also requires extensive computational resources: We terminated the analysis of the biggest dataset (<italic>F</italic>100) after 31 days of runtime without obtaining a result (using an Intel core i7 quad core CPU at 2.9 GHz). <monospace>OMA</monospace> and <monospace>InParanoid</monospace> required even more computational resources. We also had to terminate the analysis of the biggest dataset without obtaining a result from these tools. The results obtained for the two other datasets, however, were superior to those obtained from <monospace>OrthoMCL</monospace>. <monospace>InParanoid</monospace> reports the smallest amount of orthology relations (only ∼1–5% recall) and exhibits the longest runtime. The results however hardly include any false positives.</p>
    <p>Since <monospace>FFAdj-MCS</monospace> acts as an efficient filter against false orthology predictions, we tested whether we could rely entirely on the synteny information. After all, this information is also derived from the alignment scores determined by <monospace>blast</monospace>, hence low-scoring edges are unlikely to enter the final matching and would thus be dismissed either way. We therefore removed <monospace>Proteinortho</monospace>'s filter for near-optimal alignment scores by setting <italic>f</italic> = 0, which includes all reciprocal alignments above the given E-value threshold. We observed that this did not improve the quality of the predictions but increased the CPU time by a factor of 20 to 40 on the simulated datasets. A cutoff value of <italic>f</italic> close to 1 thus not only saves computational resources but also contributes to the identification of the correct edges in <inline-formula><inline-graphic xlink:href="pone.0105015.e031.jpg"/></inline-formula> independent of <monospace>FFAdj-MCS</monospace>. This observation justifies the design decision to run the gene order filter only on the nearly optimal orthology candidates.</p>
    <p>In addition to simulated data, we performed benchmarks using estimated orthology relationships from several real life datasets. The <monospace>COG</monospace>-database <xref rid="pone.0105015-Tatusov1" ref-type="bibr">[8]</xref> was used as complete reference annotation for a set of 16 prokaryotes. All proteins present in this set are assigned to some group. <monospace>OrthoBench</monospace>
<xref rid="pone.0105015-Trachana1" ref-type="bibr">[23]</xref> and <monospace>YGOB</monospace>
<xref rid="pone.0105015-Byrne1" ref-type="bibr">[46]</xref> provided a partial annotation for a number of reference proteins in twelve metazoan and five fungal species, respectively. The <monospace>YGOB</monospace> dataset was used in a previous study to evaluate the tool <monospace>Synergy</monospace>
<xref rid="pone.0105015-Wapinski1" ref-type="bibr">[7]</xref>. While the latter is not publicly available, the results of its application to <monospace>YGOB</monospace> have been published, which allowed us to compare <monospace>Synergy</monospace> and <monospace>PoFF</monospace> on this dataset (see <xref ref-type="table" rid="pone-0105015-t003">Table 3</xref> and <xref ref-type="sec" rid="s3">discussion</xref> below).</p>
    <table-wrap id="pone-0105015-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison using real data.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0105015-t003-3" xlink:href="pone.0105015.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset</td>
              <td align="left" rowspan="1" colspan="1">Method</td>
              <td align="left" rowspan="1" colspan="1">Precision</td>
              <td align="left" rowspan="1" colspan="1">Recall</td>
              <td align="left" rowspan="1" colspan="1">Accuracy</td>
              <td align="left" rowspan="1" colspan="1"><italic>tn</italic> rate</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>COG</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">99.50%</td>
              <td align="left" rowspan="1" colspan="1">23.80%</td>
              <td align="left" rowspan="1" colspan="1">29.12%</td>
              <td align="left" rowspan="1" colspan="1">98.45%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">99.52%</td>
              <td align="left" rowspan="1" colspan="1">22.50%</td>
              <td align="left" rowspan="1" colspan="1">27.93%</td>
              <td align="left" rowspan="1" colspan="1">98.47%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>YGOB</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Synergy</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">61.36%</td>
              <td align="left" rowspan="1" colspan="1">42.82%</td>
              <td align="left" rowspan="1" colspan="1">99.64%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">59.10%</td>
              <td align="left" rowspan="1" colspan="1">38.35%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">59.07%</td>
              <td align="left" rowspan="1" colspan="1">36.97%</td>
              <td align="left" rowspan="1" colspan="1">99.62%</td>
              <td align="left" rowspan="1" colspan="1">99.89%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>OrthoBench</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <monospace>Proteinortho</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">100%</td>
              <td align="left" rowspan="1" colspan="1">17.68%</td>
              <td align="left" rowspan="1" colspan="1">24.71%</td>
              <td align="left" rowspan="1" colspan="1">100%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">
                <monospace>PoFF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">100%</td>
              <td align="left" rowspan="1" colspan="1">9.72%</td>
              <td align="left" rowspan="1" colspan="1">17.44%</td>
              <td align="left" rowspan="1" colspan="1">90.27%</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt103">
          <label/>
          <p>Comparison of tools on the basis of estimated orthology relations from real data sets. Statistical values are explained in <xref ref-type="sec" rid="s2">Materials and Methods</xref>. <italic>tn</italic> rate refers to true negative rate.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>For real life datasets, <monospace>PoFF</monospace> predicts 4 to 57% fewer pairwise orthology relations than <monospace>Proteinortho</monospace>. This tendency is even more pronounced for the very similar simulated datasets (23 to 77%, data not shown). The reduced number of pairwise orthology relations allows separating the orthologous groups in a more fine-grained way and reduces the number of false positive assignments. In turn, however, the number of true positive assignments is reduced as well. For the real life datasets, which comprise far more distant species than the simulated data, this results in reduced recall and sometimes also reduced accuracy (<xref ref-type="table" rid="pone-0105015-t003">Table 3</xref>).</p>
    <p>We emphasize that neither the <monospace>COG</monospace> nor the <monospace>OrthoBench</monospace> data are ideal benchmarking sets for fine-grained orthology predictions. Both provide orthologous groups rather than pairwise orthology relations which, in turn, had to be estimated for evaluation (see <xref ref-type="sec" rid="s2">Materials and Methods</xref>). Moreover, many of these groups are rather large as they contain numerous paralogs, which were – as we would argue – correctly clustered into subgroups by <monospace>PoFF</monospace> and/or <monospace>Proteinortho</monospace>. The <monospace>COG</monospace>-database was originally constructed using 13 Archaea, three Eukarya and 50 Bacteria. For evaluation, we used a bacterial subset of 16 species. This in turn makes duplications specific to the chosen subset harder to detect. The combination of these issues leads to artifacts in the reference datasets that might have a negative impact on recall and accuracy. Both, <monospace>PoFF</monospace> and <monospace>Proteinortho</monospace> tend to split the groups annotated in the reference sets into smaller subgroups. This effect of subdividing is more pronounced for <monospace>PoFF</monospace>. <monospace>OrthoBench</monospace> groups contain on average 23.5 genes while comprising only up to 12 species. On average these groups are divided into 3.8 subgroups by <monospace>Proteinortho</monospace> and 5.4 groups using <monospace>PoFF</monospace>. <monospace>COG</monospace> groups contain 18.4 genes on average. These groups are divided into 3.0 and 3.1 subgroups, respectively (see <xref ref-type="supplementary-material" rid="pone.0105015.s001">File S1</xref>).</p>
    <p>Only the <monospace>YGOB</monospace> dataset offers pairwise orthology data and can thus be regarded as more exact than the other two sets. Here, the results of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> are quite similar. Again we find the slight decrease in recall observed already for the simulated dataset. Increased phylogenetic distance decreases the positive impact on precision, which was found for the more closely related simulated datasets. The predictions for this dataset achieved by Synergy are slightly better than those of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace>. However, the algorithm relies on genome-wide reconstruction of phylogenetic gene trees and is thus far more time-consuming. Moreover, a standalone tool that applies the algorithm is currently not available.</p>
    <p>The strategy pursued by <monospace>PoFF</monospace> is particularly useful to separate large orthologous groups with many co-orthologs into smaller subgroups. Typically, there is one major group for each gene family in each simulated dataset that spans all species of the original group but includes only one or a small number of genes from each species. In addition, we observe one or more “minor” groups of duplicates that contain diverged and/or largely rearranged paralogs. Using the real life dataset <monospace>OrthoBench</monospace> we see this trend in particular for Otoferlin, Dilute myosin heavy chain, GPS domain-containing GPCRs and S-adenosylmethionine synthetase isoform families. This type of subdivision appears useful and desirable in most practical applications of automatic orthology detectors.</p>
    <p>The increase in runtime introduced by <monospace>FFAdj-MCS</monospace> is marginal for small genomes (e.g. Bacteria). For simulated data as well as the <monospace>COG</monospace> set we observed an increase by 1–3%. For large genomes as present in the <monospace>OrthoBench</monospace> set the increase was 5–10% and thus more notable. For example, the analysis of <italic>Rattus norvegicus</italic> and <italic>Pan troglodytes</italic> took 12.5h using <monospace>Proteinortho</monospace> and 13.5 h using <monospace>PoFF</monospace> applying a single thread. The memory requirements remained unchanged.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>Dissecting large gene families from many genomes into clusters of orthologs is not a well-posed problem. Orthology, as defined by Fitch <xref rid="pone.0105015-Fitch1" ref-type="bibr">[1]</xref>, <xref rid="pone.0105015-Fitch2" ref-type="bibr">[2]</xref>, is a binary relation of the set of genes. Gene duplication events typically appear in many different locations of the underlying phylogenetic tree and give rise to a complex structure of co-orthologs and paralogs at different levels. The resulting cograph nevertheless contains dense clusters that can be meaningfully associated with orthologous groups. Clustering-based orthology detection is therefore a useful pragmatic way to easily and correctly identify orthologous groups, provided duplications are absent within the phylogenetic range of the input data. It is a common feature of orthology methods, in particular those geared towards large datasets, that the orthology is approximated by a partition of the genes into groups of co-orthologs. The tool <monospace>PoFF</monospace> described here also follows this paradigm but provides pairwise orthology predictions in addition.</p>
    <p>Several orthology prediction methods that avoid the explicit use of gene and species trees have been described in the literature. Most of them can be applied to large datasets only at high performance computing facilities. Their pre-computed results are usually available in databases, whereas the software itself is not available for public use or restricted in practice to small datasets. This limits their usefulness since poorly studied or newly sequenced organisms that are not (yet) available in the pre-computed results cannot easily be included in large-scale studies. <monospace>PoFF</monospace> is specifically designed to overcome these limitations and provides users a tool for compiling large-scale orthology datasets with moderate computational resources. Here we have shown that the combination of the fast, clustering-based orthology heuristic, <monospace>Proteinortho</monospace>, with the equally efficient heuristic for large-scale synteny assessment, <monospace>FFAdj-MCS</monospace>, leads to a substantial improvement of the data quality for related species without loss of performance. Synteny information proves to be a highly efficient filter against false-positive orthology assignments without a huge increase of the false negative rate. The extended approach, <monospace>PoFF</monospace>, is capable of boosting large-scale comparative studies which focus on closely related species or even strains.</p>
    <p>Orthologous groups can provide a convenient starting point for more detailed analyses of the history of entire gene families. To this end, it is necessary to reduce in particular false positive orthology assignments. <xref ref-type="fig" rid="pone-0105015-g004">Figure 4</xref> illustrates that the filtering and clustering strategy can have a strong influence on both the false positive and false negative rates of orthology assignments. Orthology is only defined as a pairwise relationship which is not transitive. Hence, reducing the false positive rate within orthologous groups will ultimately lead to a reduction of true positive rates when the pairwise definition is applied, as we did here (see <xref ref-type="fig" rid="pone-0105015-g004">Figure 4</xref>, e.g., separating the paralogs <italic>B</italic>1 and <italic>B</italic>2 into two distinct orthologous groups requires to discard the true orthology relation to <italic>A</italic>1 for one of them, otherwise both genes would be connected via <italic>A</italic>1). Given this, we had expected <monospace>PoFF</monospace> to perform much worse regarding true positives, which was, however, not the case.</p>
    <fig id="pone-0105015-g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0105015.g004</object-id>
      <label>Figure 4</label>
      <caption>
        <title>The false negative issue.</title>
        <p>The genes {<italic>A</italic>1, <italic>B</italic>1, <italic>B</italic>2, <italic>C</italic>1, <italic>C</italic>2} form an orthologous group. {<italic>B</italic>1, <italic>B</italic>2} as well as {<italic>C</italic>1, <italic>C</italic>2} are not orthologous to each other but co-orthologous with respect to <italic>A</italic>1 (<italic>A</italic>1 and {<italic>B</italic>1, <italic>B</italic>2, <italic>C</italic>1, <italic>C</italic>2} are separated by a speciation event). Pairwise true orthology relationships are marked by black arcs, false ones are grey. <monospace>Proteinortho</monospace> is more inclusive, it would report all five genes as one group, yielding six true and two false positives (grey). Assuming that the gene copies 1 and 2 exhibit distinct genomic neighborhoods in all three species <italic>A</italic> to <italic>C</italic>, <monospace>PoFF</monospace> would report two separate groups, namely {<italic>A</italic>1, <italic>B</italic>1, <italic>C</italic>1} and {<italic>B</italic>2, <italic>C</italic>2}. This more fine-grained method avoids false positive orthology assignments. However, it introduces false negative assignments. Two in this example, depicted by dashed arcs.</p>
      </caption>
      <graphic xlink:href="pone.0105015.g004"/>
    </fig>
    <p>While conserved synteny is a powerful feature to support the confidence in orthology predictions <xref rid="pone.0105015-Rolland1" ref-type="bibr">[56]</xref>, gene orders evolve faster than protein sequences <xref rid="pone.0105015-Kristensen1" ref-type="bibr">[57]</xref>. This fact is reflected by the benchmark results of the closely related simulated datasets compared to the real-life sets including more distantly related species, where the advantage of <monospace>PoFF</monospace> regarding pairwise orthology prediction was clearly reduced (see <xref ref-type="table" rid="pone-0105015-t002">Tables 2</xref> and <xref ref-type="table" rid="pone-0105015-t003">3</xref>). However, <monospace>PoFF</monospace> yields orthologous groups that are more fine-grained and contain fewer paralogs. We argue that this is a practical improvement for subsequent analyses, such as gene function prediction, genome annotation, marker development and phylogenetics. There, the presence of many-to-many relations in orthologous groups due to co-orthologs may lead to inconclusive results. In turn, these groups are often omitted and single-copy orthologs (a single gene per species) are used only <xref rid="pone.0105015-Creevey1" ref-type="bibr">[58]</xref>–<xref rid="pone.0105015-Liu1" ref-type="bibr">[60]</xref>. This fact could make an application of <monospace>PoFF</monospace> desirable, even for more distant species.</p>
    <p>The extension of <monospace>Proteinortho</monospace> by <monospace>FFAdj-MCS</monospace> leads to a very moderate increase in runtime and does not increase the hardware requirements, making this combined method applicable to very large datasets further on. The current approach of combining sequence similarity, conserved synteny and clustering entails a significant improvement when comparing closely related species. As gene orders generally evolve faster than protein sequences <xref rid="pone.0105015-Kristensen1" ref-type="bibr">[57]</xref>, the improvement decreases with growing phylogenetic distance of species in the set, which may even compromise precision. Future extensions of the approach could thus aim at deciding on a case-by-case basis if the <monospace>FFAdj-MCS</monospace> algorithm should be used as additional filter for the comparison of two species, e.g., based on the respective breakpoint distance. Alternatively, a less restrictive synteny measure (e.g. common intervals instead of adjacencies) could be applied.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0105015.s001">
      <label>File S1</label>
      <caption>
        <p>Table S1: Accuracy of separation of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> evaluated in reference dataset <monospace>Orthobench</monospace>. Table S2: Accuracy of separation of <monospace>Proteinortho</monospace> and <monospace>PoFF</monospace> evaluated in reference dataset <monospace>COG</monospace>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0105015.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are thankful with Chunfang Zheng for providing us her scripts and guidance for genome rearrangements.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0105015-Fitch1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fitch</surname><given-names>WM</given-names></name> (<year>1970</year>) <article-title>Distinguishing homologous from analogous proteins</article-title>. <source>Syst Zool</source>
<volume>19</volume>: <fpage>99</fpage>–<lpage>113</lpage>.<pub-id pub-id-type="pmid">5449325</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Fitch2">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Fitch</surname><given-names>WM</given-names></name> (<year>2000</year>) <article-title>Homology a personal view on some of the problems</article-title>. <source>Trends Genet</source>
<volume>16</volume>: <fpage>227</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">10782117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Arvestad1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Arvestad</surname><given-names>L</given-names></name>, <name><surname>Berglund</surname><given-names>AC</given-names></name>, <name><surname>Lagergren</surname><given-names>J</given-names></name>, <name><surname>Sennblad</surname><given-names>B</given-names></name> (<year>2003</year>) <article-title>Bayesian gene/species tree reconciliation and orthology analysis using MCMC</article-title>. <source>Bioinformatics</source>
<volume>19</volume>
<issue>Suppl.1</issue>: <fpage>7</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Shi1">
      <label>4</label>
      <mixed-citation publication-type="other">Shi G, Peng MC, Jiang T (2011) MultiMSOAR 2.0: an accurate tool to identify ortholog groups among multiple genomes. PLoS One 6.</mixed-citation>
    </ref>
    <ref id="pone.0105015-vanderHeijden1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>van der Heijden</surname><given-names>RT</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>van Noort</surname><given-names>V</given-names></name>, <name><surname>Huynen</surname><given-names>MA</given-names></name> (<year>2007</year>) <article-title>Orthology prediction at scalable resolution by phylogenetic tree analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>83</fpage>.<pub-id pub-id-type="pmid">17346331</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Hubbard1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hubbard</surname><given-names>TJ</given-names></name>, <name><surname>Aken</surname><given-names>BL</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Ballester</surname><given-names>B</given-names></name>, <name><surname>Caccamo</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Ensembl 2007</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>D610</fpage>–<lpage>617</lpage>.<pub-id pub-id-type="pmid">17148474</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wapinski1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wapinski</surname><given-names>I</given-names></name>, <name><surname>Pfeffer</surname><given-names>A</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Automatic genome-wide reconstruction of phylogenetic gene trees</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>549</fpage>–<lpage>558</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Tatusov1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Tatusov</surname><given-names>RL</given-names></name>, <name><surname>Galperin</surname><given-names>MY</given-names></name>, <name><surname>Natale</surname><given-names>DA</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2000</year>) <article-title>The COG database: a tool for genomescale analysis of protein functions and evolution</article-title>. <source>Nucleic Acids Res</source>
<volume>28</volume>: <fpage>33</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">10592175</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Li1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Stoeckert</surname><given-names>CJ</given-names><suffix>Jr</suffix></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2003</year>) <article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>. <source>Genome Res</source>
<volume>13</volume>: <fpage>2178</fpage>–<lpage>2189</lpage>.<pub-id pub-id-type="pmid">12952885</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chen1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Mackey</surname><given-names>AJ</given-names></name>, <name><surname>Stoeckert</surname><given-names>CJ</given-names><suffix>Jr</suffix></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2006</year>) <article-title>Orthomcl-db: querying a comprehensive multi-species collection of ortholog groups</article-title>. <source>Nucleic Acids Res</source>
<volume>34</volume>: <fpage>D363</fpage>–<lpage>368</lpage>.<pub-id pub-id-type="pmid">16381887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Schneider1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>A</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name> (<year>2007</year>) <article-title>OMA browser–exploring orthologous relations across 352 complete genomes</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>2180</fpage>–<lpage>2182</lpage>.<pub-id pub-id-type="pmid">17545180</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altenhoff1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Altenhoff</surname><given-names>AM</given-names></name>, <name><surname>Schneider</surname><given-names>A</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>OMA 2011: orthology inference among 1000 complete genomes</article-title>. <source>Nucleic Acids Res</source>
<volume>39</volume>: <fpage>D289</fpage>–<lpage>D294</lpage>.<pub-id pub-id-type="pmid">21113020</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Berglund1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Berglund</surname><given-names>AC</given-names></name>, <name><surname>Sjölund</surname><given-names>E</given-names></name>, <name><surname>Ostlund</surname><given-names>G</given-names></name>, <name><surname>Sonnhammer</surname><given-names>EL</given-names></name> (<year>2008</year>) <article-title>InParanoid 6: eukaryotic ortholog clusters with inparalogs</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D263</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">18055500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Jensen1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Jensen</surname><given-names>LJ</given-names></name>, <name><surname>Julien</surname><given-names>P</given-names></name>, <name><surname>Kuhn</surname><given-names>M</given-names></name>, <name><surname>von Mering</surname><given-names>C</given-names></name>, <name><surname>Muller</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>eggNOG: automated construction and annotation of orthologous groups of genes</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D250</fpage>–<lpage>254</lpage>.<pub-id pub-id-type="pmid">17942413</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wheeler1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Wheeler</surname><given-names>DL</given-names></name>, <name><surname>Barrett</surname><given-names>T</given-names></name>, <name><surname>Benson</surname><given-names>DA</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>, <name><surname>Canese</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D13</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">18045790</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-DeLuca1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>DeLuca</surname><given-names>TF</given-names></name>, <name><surname>Cui</surname><given-names>J</given-names></name>, <name><surname>Jung</surname><given-names>JY</given-names></name>, <name><surname>St Gabriel</surname><given-names>KC</given-names></name>, <name><surname>Wall</surname><given-names>DP</given-names></name> (<year>2012</year>) <article-title>Roundup 2.0: enabling comparative genomics for over 1800 genomes</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>715</fpage>–<lpage>716</lpage>.<pub-id pub-id-type="pmid">22247275</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Mahmood1">
      <label>17</label>
      <mixed-citation publication-type="other">Mahmood K, Webb GI, Song J, Whisstock JC, Konagurthu AS (2012) Efficient large-scale protein sequence comparison and gene matching to identify orthologs and co-orthologs. Nucleic Acids Res 40.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Koonin1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2005</year>) <article-title>Orthologs, paralogs, and evolutionary genomics</article-title>. <source>Annu Rev Genet</source>
<volume>39</volume>: <fpage>309</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">16285863</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lechner1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lechner</surname><given-names>M</given-names></name>, <name><surname>Findeiss</surname><given-names>S</given-names></name>, <name><surname>Steiner</surname><given-names>L</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Proteinortho: detection of (co-)orthologs in large-scale analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume>: <fpage>124</fpage>.<pub-id pub-id-type="pmid">21526987</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Hellmuth1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hellmuth</surname><given-names>M</given-names></name>, <name><surname>Hernandez-Rosales</surname><given-names>M</given-names></name>, <name><surname>Huber</surname><given-names>KT</given-names></name>, <name><surname>Moulton</surname><given-names>V</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Orthology relations, symbolic ultrametrics, and cographs</article-title>. <source>J Math Biol</source>
<volume>66</volume>: <fpage>399</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">22456957</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altenhoff2">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Altenhoff</surname><given-names>AM</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2009</year>) <article-title>Phylogenetic and functional assessment of orthologs inference projects and methods</article-title>. <source>PLoS Comput Biol</source>
<volume>5</volume>: <fpage>e1000262</fpage>.<pub-id pub-id-type="pmid">19148271</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chen2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Mackey</surname><given-names>AJ</given-names></name>, <name><surname>Vermunt</surname><given-names>JK</given-names></name>, <name><surname>Roos</surname><given-names>DS</given-names></name> (<year>2007</year>) <article-title>Assessing performance of orthology detection strategies applied to eukaryotic genomes</article-title>. <source>PLoS One</source>
<volume>2</volume>: <fpage>e383</fpage>.<pub-id pub-id-type="pmid">17440619</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Trachana1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Trachana</surname><given-names>K</given-names></name>, <name><surname>Larsson</surname><given-names>TA</given-names></name>, <name><surname>Powell</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>WH</given-names></name>, <name><surname>Doerks</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Orthology prediction methods: a quality assessment using curated protein families</article-title>. <source>Bioessays</source>
<volume>33</volume>: <fpage>769</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">21853451</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Ebersberger1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Ebersberger</surname><given-names>I</given-names></name>, <name><surname>Strauss</surname><given-names>S</given-names></name>, <name><surname>von Haeseler</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>HaMStR: Profile hidden markov model based search for orthologs in ESTs</article-title>. <source>BMC Evol Biol</source>
<volume>9</volume>: <fpage>157</fpage>.<pub-id pub-id-type="pmid">19586527</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Shi2">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>G</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name> (<year>2010</year>) <article-title>Msoar 2.0: Incorporating tandem duplications into ortholog assignment based on genome rearrangement</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>10</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">20053291</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Grigoriev1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Grigoriev</surname><given-names>IV</given-names></name>, <name><surname>Cullen</surname><given-names>D</given-names></name>, <name><surname>Goodwin</surname><given-names>SB</given-names></name>, <name><surname>Hibbett</surname><given-names>D</given-names></name>, <name><surname>Jeffries</surname><given-names>TW</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Fueling the future with fungal genomics</article-title>. <source>Mycology</source>
<volume>2</volume>: <fpage>192</fpage>–<lpage>209</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Cao1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Schneeberger</surname><given-names>K</given-names></name>, <name><surname>Ossowski</surname><given-names>S</given-names></name>, <name><surname>Günther</surname><given-names>T</given-names></name>, <name><surname>Bender</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Whole-genome sequencing of multiple <italic>Arabidopsis thaliana</italic> populations</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>956</fpage>–<lpage>963</lpage>.<pub-id pub-id-type="pmid">21874002</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wapinski2">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Wapinski</surname><given-names>I</given-names></name>, <name><surname>Pfeffer</surname><given-names>A</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Natural history and evolutionary principles of gene duplication in fungi</article-title>. <source>Nature</source>
<volume>449</volume>: <fpage>54</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">17805289</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dandekar1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Dandekar</surname><given-names>T</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>1998</year>) <article-title>Conservation of gene order: a fingerprint of proteins that physically interact</article-title>. <source>Trends Biochem Sci</source>
<volume>23</volume>: <fpage>324</fpage>–<lpage>328</lpage>.<pub-id pub-id-type="pmid">9787636</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Suyama1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Suyama</surname><given-names>M</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2001</year>) <article-title>Evolution of prokaryotic gene order: genome rearrangements in closely related species</article-title>. <source>Trends Genet</source>
<volume>17</volume>: <fpage>10</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">11163906</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lehmann1">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Lehmann</surname><given-names>J</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>Prohaska</surname><given-names>SJ</given-names></name> (<year>2008</year>) <article-title>SynBlast: Assisting the analysis of conserved synteny information</article-title>. <source>BMC Bioinformatics</source>
<volume>9</volume>: <fpage>351</fpage>.<pub-id pub-id-type="pmid">18721485</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dewey1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Dewey</surname><given-names>CN</given-names></name> (<year>2011</year>) <article-title>Positional orthology: putting genomic evolutionary relationships into context</article-title>. <source>Briefings Bioinf</source>
<volume>12</volume>: <fpage>401</fpage>–<lpage>412</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Waterson1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Waterson</surname><given-names>G</given-names></name>, <name><surname>Ewens</surname><given-names>W</given-names></name>, <name><surname>Hall</surname><given-names>T</given-names></name>, <name><surname>Morgan</surname><given-names>A</given-names></name> (<year>1982</year>) <article-title>The chromosome inversion problem</article-title>. <source>J Theor Biol</source>
<volume>99</volume>: <fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Bergeron1">
      <label>34</label>
      <mixed-citation publication-type="other">Bergeron A, Corteel S, Raffinot M (2002) The algorithmic of gene teams. In: Guigó R, Gusfield D, editors, WABI 2002. Heidelberg: Springer, volume 2452, pp. 464–476.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Bergeron2">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bergeron</surname><given-names>A</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>On the similarity of sets of permutations and its applications to genome comparison</article-title>. <source>J Comp Biol</source>
<volume>13</volume>: <fpage>1340</fpage>–<lpage>1354</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-LibenNowell1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Liben-Nowell</surname><given-names>D</given-names></name> (<year>2002</year>) <article-title>Gossip is synteny: Incomplete gossip and the syntenic distance between genomes</article-title>. <source>J Algorithms</source>
<volume>43</volume>: <fpage>264</fpage>–<lpage>283</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Ting1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Ting</surname><given-names>C</given-names></name>, <name><surname>Yong</surname><given-names>HE</given-names></name> (<year>2006</year>) <article-title>Optimal algorithms for uncovering synteny problem</article-title>. <source>J Comb Optimization</source>
<volume>12</volume>: <fpage>421</fpage>–<lpage>432</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Proost1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Proost</surname><given-names>S</given-names></name>, <name><surname>Fostier</surname><given-names>J</given-names></name>, <name><surname>De Witte</surname><given-names>D</given-names></name>, <name><surname>Dhoedt</surname><given-names>B</given-names></name>, <name><surname>Demeester</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>i-ADHoRe 3.0–fast and sensitive detection of genomic homology in extremely large data sets</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e11</fpage>.<pub-id pub-id-type="pmid">22102584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Wang1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Debarry</surname><given-names>JD</given-names></name>, <name><surname>Tan</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>MCScanX: a toolkit for detection and evolutionary analysis of gene synteny and collinearity</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e49</fpage>.<pub-id pub-id-type="pmid">22217600</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Roedelsperger1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Roedelsperger</surname><given-names>C</given-names></name>, <name><surname>Dieterich</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>CYNTENATOR: Progressive gene order alignment of 17 vertebrate genomes</article-title>. <source>PLoS ONE</source>
<volume>5</volume>: <fpage>e8861</fpage>.<pub-id pub-id-type="pmid">20126624</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Haas1">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Haas</surname><given-names>BJ</given-names></name>, <name><surname>Delcher</surname><given-names>AL</given-names></name>, <name><surname>Wortman</surname><given-names>JR</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2004</year>) <article-title>DAGchainer: a tool for mining segmental genome duplications and synteny</article-title>. <source>Bioinformatics</source>
<volume>20(18)</volume>: <fpage>3643</fpage>–<lpage>3646</lpage>.<pub-id pub-id-type="pmid">15247098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Doerr1">
      <label>42</label>
      <mixed-citation publication-type="other">Doerr D, Thévenin A, Stoye J (2012) Gene family assignment-free comparative genomics. BMC Bioinformatics 13: S3 19.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Braga1">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Braga</surname><given-names>MD</given-names></name>, <name><surname>Machado</surname><given-names>R</given-names></name>, <name><surname>Ribeiro</surname><given-names>LC</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Genomic distance under gene substitutions</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume> (Suppl. 9)<fpage>S8</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Camacho1">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Altschul1">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Byrne1">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Byrne</surname><given-names>KP</given-names></name>, <name><surname>Wolfe</surname><given-names>KH</given-names></name> (<year>2005</year>) <article-title>The Yeast Gene Order Browser: combining curated homology and syntenic context reveals gene fate in polyploid species</article-title>. <source>Genome Res</source>
<volume>15</volume>: <fpage>1456</fpage>–<lpage>1461</lpage>.<pub-id pub-id-type="pmid">16169922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-KellerSchmidt1">
      <label>47</label>
      <mixed-citation publication-type="other">Keller-Schmidt S, Tuğrul M, Eguíluz VM, Hernández-García E, Klemm K (2010) An age dependent branching model for macroevolution. Technical Report 1012.3298v1, arXiv.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Ohno1">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ohno</surname><given-names>S</given-names></name> (<year>1999</year>) <article-title>Gene duplication and the uniqueness of vertebrate genomes circa 1970–1999</article-title>. <source>Seminars in Cell and Developmental Biology</source>
<volume>10</volume>: <fpage>517</fpage>–<lpage>522</lpage>.<pub-id pub-id-type="pmid">10597635</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Lynch1">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Lynch</surname><given-names>M</given-names></name>, <name><surname>Conery</surname><given-names>JS</given-names></name> (<year>2000</year>) <article-title>The evolutionary fate and consequences of duplicate genes</article-title>. <source>Science</source>
<volume>290</volume>: <fpage>1151</fpage>–<lpage>1155</lpage>.<pub-id pub-id-type="pmid">11073452</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Xu1">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>W</given-names></name>, <name><surname>Zheng</surname><given-names>C</given-names></name>, <name><surname>Sankoff</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Paths and cycles in breakpoint graph of random multichromosomal genomes</article-title>. <source>J Comput Biol</source>
<volume>14</volume>: <fpage>423</fpage>–<lpage>435</lpage>.<pub-id pub-id-type="pmid">17572021</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-HernandezRosales1">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Hernandez-Rosales</surname><given-names>M</given-names></name>, <name><surname>Wieseke</surname><given-names>N</given-names></name>, <name><surname>Hellmuth</surname><given-names>M</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name> (<year>2014</year>) <article-title>Simulation of gene family histories</article-title>. <source>BMC Bioinformatics</source>
<volume>15</volume>: <fpage>S3</fpage>–<lpage>A8</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Strope1">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Strope</surname><given-names>CL</given-names></name>, <name><surname>Abel</surname><given-names>K</given-names></name>, <name><surname>Scott</surname><given-names>SD</given-names></name>, <name><surname>Moriyama</surname><given-names>EN</given-names></name> (<year>2009</year>) <article-title>Biological sequence simulation for testing complex evolutionary hypotheses: indel-Seq-Gen version 2.0</article-title>. <source>Mol Biol Evol</source>
<volume>26</volume>: <fpage>2581</fpage>–<lpage>2593</lpage>.<pub-id pub-id-type="pmid">19651852</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Chang1">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Chang</surname><given-names>MSS</given-names></name>, <name><surname>Brenner</surname><given-names>SA</given-names></name> (<year>2004</year>) <article-title>Empirical analysis of protein insertions and deletions determining parameters for the correct placement of gaps in protein sequence alignments</article-title>. <source>J Mol Biol</source>
<volume>341</volume>: <fpage>617</fpage>–<lpage>631</lpage>.<pub-id pub-id-type="pmid">15276848</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Dalquen1">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Dalquen</surname><given-names>DA</given-names></name>, <name><surname>Anisimova</surname><given-names>M</given-names></name>, <name><surname>Gonnet</surname><given-names>GH</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>ALF–a simulation framework for genome evolution</article-title>. <source>Mol Biol Evol</source>
<volume>29</volume>: <fpage>1115</fpage>–<lpage>1123</lpage>.<pub-id pub-id-type="pmid">22160766</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Flicek1">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Ensembl 2011</article-title>. <source>Nucleic Acids Res</source>
<volume>39</volume>: <fpage>800</fpage>–<lpage>806</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Rolland1">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Rolland</surname><given-names>T</given-names></name>, <name><surname>Neuvéglise</surname><given-names>C</given-names></name>, <name><surname>Sacerdot</surname><given-names>C</given-names></name>, <name><surname>Dujon</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>Insertion of horizontally transferred genes within conserved syntenic regions of yeast genomes</article-title>. <source>PLoS One</source>
<volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Kristensen1">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Kristensen</surname><given-names>DM</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Mushegian</surname><given-names>AR</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name> (<year>2011</year>) <article-title>Computational methods for Gene Orthology inference</article-title>. <source>Brief Bioinform</source>
<volume>12</volume>: <fpage>379</fpage>–<lpage>391</lpage>.<pub-id pub-id-type="pmid">21690100</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0105015-Creevey1">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Creevey</surname><given-names>CJ</given-names></name>, <name><surname>Muller</surname><given-names>J</given-names></name>, <name><surname>Doerks</surname><given-names>T</given-names></name>, <name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Arendt</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Identifying single copy orthologs in Metazoa</article-title>. <source>PLoS Comput Biol</source>
<volume>7</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Franzn1">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Franzén</surname><given-names>O</given-names></name>, <name><surname>Jerlström-Hultqvist</surname><given-names>J</given-names></name>, <name><surname>Einarsson</surname><given-names>E</given-names></name>, <name><surname>Ankarklev</surname><given-names>J</given-names></name>, <name><surname>Ferella</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Transcriptome profiling of <italic>Giardia intestinalis</italic> using strand-specific RNA-seq</article-title>. <source>PLoS Comput Biol</source>
<volume>9</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0105015-Liu1">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>GB</given-names></name>, <name><surname>Ying</surname><given-names>Y</given-names></name> (<year>2013</year>) <article-title>Development of universal genetic markers based on single-copy orthologous (COSII) genes in Poaceae</article-title>. <source>Plant Cell Rep</source>
<volume>32</volume>: <fpage>379</fpage>–<lpage>388</lpage>.<pub-id pub-id-type="pmid">23233129</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
