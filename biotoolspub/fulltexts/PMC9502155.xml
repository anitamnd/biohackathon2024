<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9502155</article-id>
    <article-id pub-id-type="pmid">34145874</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab429</article-id>
    <article-id pub-id-type="publisher-id">btab429</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AutoCCS: automated collision cross-section calculation software for ion mobility spectrometry–mass spectrometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5864-8518</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Joon-Yong</given-names>
        </name>
        <xref rid="btab429-cor1" ref-type="corresp"/>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
        <!--joonyong.lee@pnnl.gov-->
        <xref rid="btab429-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2985-8249</contrib-id>
        <name>
          <surname>Bilbao</surname>
          <given-names>Aivett</given-names>
        </name>
        <xref rid="btab429-cor1" ref-type="corresp"/>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
        <!--aivett.bilbao@pnnl.gov-->
        <xref rid="btab429-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conant</surname>
          <given-names>Christopher R</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bloodsworth</surname>
          <given-names>Kent J</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Orton</surname>
          <given-names>Daniel J</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Mowei</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilson</surname>
          <given-names>Jesse W</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9782-4521</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Xueyun</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Webb</surname>
          <given-names>Ian K</given-names>
        </name>
        <aff><institution>Department of Chemistry &amp; Chemical Biology, Indiana University–Purdue University Indianapolis</institution>, Indianapolis, IN 46202, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ailin</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hixson</surname>
          <given-names>Kim K</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fjeldsted</surname>
          <given-names>John C</given-names>
        </name>
        <aff><institution>Agilent Technologies</institution>, Santa Clara, CA 95051, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ibrahim</surname>
          <given-names>Yehia M</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Payne</surname>
          <given-names>Samuel H</given-names>
        </name>
        <aff><institution>Department of Biology, Brigham Young University</institution>, Provo, UT 84602, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jansson</surname>
          <given-names>Christer</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Richard D</given-names>
        </name>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6049-3968</contrib-id>
        <name>
          <surname>Metz</surname>
          <given-names>Thomas O</given-names>
        </name>
        <xref rid="btab429-cor1" ref-type="corresp"/>
        <aff><institution>Earth and Biological Sciences Directorate, Pacific Northwest National Laboratory</institution>, Richland, WA 99352, <country country="US">USA</country></aff>
        <!--thomas.metz@pnnl.gov-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab429-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btab429-cor1">To whom correspondence should be addressed. <email>joonyong.lee@pnnl.gov</email>, <email>aivett.bilbao@pnnl.gov</email>, <email>thomas.metz@pnnl.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-06-19">
      <day>19</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>22</issue>
    <fpage>4193</fpage>
    <lpage>4201</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>22</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>01</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab429.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Ion mobility spectrometry (IMS) separations are increasingly used in conjunction with mass spectrometry (MS) for separation and characterization of ionized molecular species. Information obtained from IMS measurements includes the ion’s collision cross section (CCS), which reflects its size and structure and constitutes a descriptor for distinguishing similar species in mixtures that cannot be separated using conventional approaches. Incorporating CCS into MS-based workflows can improve the specificity and confidence of molecular identification. At present, there is no automated, open-source pipeline for determining CCS of analyte ions in both targeted and untargeted fashion, and intensive user-assisted processing with vendor software and manual evaluation is often required.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present AutoCCS, an open-source software to rapidly determine CCS values from IMS-MS measurements. We conducted various IMS experiments in different formats to demonstrate the flexibility of AutoCCS for automated CCS calculation: (i) stepped-field methods for drift tube-based IMS (DTIMS), (ii) single-field methods for DTIMS (supporting two calibration methods: a standard and a new enhanced method) and (iii) linear calibration for Bruker timsTOF and non-linear calibration methods for traveling wave based-IMS in Waters Synapt and Structures for Lossless Ion Manipulations. We demonstrated that AutoCCS offers an accurate and reproducible determination of CCS for both standard and unknown analyte ions in various IMS-MS platforms, IMS-field methods, ionization modes and collision gases, without requiring manual processing. </p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/PNNL-Comp-Mass-Spec/AutoCCS" ext-link-type="uri">https://github.com/PNNL-Comp-Mass-Spec/AutoCCS</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online. Demo datasets are publicly available at MassIVE (Dataset ID: MSV000085979).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Genomic Science Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Office of Biological and Environmental Research</institution>
            <institution-id institution-id-type="DOI">10.13039/100006206</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Environmental Health Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000066</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U2CES030170</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>P41 GM103493-15</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>US Department of Energy Advanced Research Projects Agency</institution>
          </institution-wrap>
        </funding-source>
        <award-id>14/CJ000/09/02</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pacific Northwest National Laboratory</institution>
            <institution-id institution-id-type="DOI">10.13039/100011661</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DE-AC05-76RL01830</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Ion mobility spectrometry (IMS) coupled with mass spectrometry (MS) is increasingly utilized in studies of biomolecules as it offers highly reproducible and extremely fast separations (milliseconds to seconds). IMS separates molecules in the gas phase based on their collision cross sections (CCS) with a neutral buffer gas, a property that represents the three-dimensional structure of the corresponding ion. IMS-MS provides high throughput, two-dimensional information (i.e. mass and mobility) enabling the identification and quantification of metabolites with greater confidence and effectiveness than approaches based on MS alone.</p>
    <p>Automated data processing tools are increasingly critical as instrumentation, data density and acquisition speed advance. Unfortunately, processing the large amounts of data generated in large-scale IMS analyses is still a bottleneck (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab429-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>). We previously developed PIXiE, which is a software for automated arrival time extraction and CCS calculation of standard analytes measured using the ‘stepped-field’ method in drift tube-based IMS (DTIMS)-MS instruments (<xref rid="btab429-B10" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>Here, we present a new IMS-MS software tool, AutoCCS, capable of calculating CCS from stepped- (i.e. multi-) field data and single-field analyses of unknowns where CCS determination is based on calibration against well-characterized ions measured under the same conditions. In contrast to PIXiE, which only performs a targeted extraction of predefined ions for stepped-field IMS-MS measurements, AutoCCS can utilize features detected from single-field IMS-MS measurements in an untargeted fashion to calculate CCS values for all measurable analytes and their various conformers. These functionalities enable CCS determination for unknown molecules, as well as for experiments performed on traveling wave based-IMS (TWIMS), including Waters Synapt and Structures for Lossless Ion Manipulations (SLIM) IMS devices (<xref rid="btab429-B6" ref-type="bibr">Ibrahim <italic toggle="yes">et al.</italic>, 2017</xref>). For single-field methods, AutoCCS supports internal or external calibration (with an arbitrary or configurable list of reference ions) and an ‘enhanced’ CCS calibration mode with external calibration that corrects for temperature and pressure variations that may be present in sample runs that are temporally distant from the calibrant run. Also, AutoCCS performs non-linear regression analysis with either a polynomial or linearized power function for TWIMS data. For use with in-house SLIM IMS-MS systems, we modified the typical non-regression methods by incorporating the accumulation time for the arrival time adjustment.</p>
    <p>We demonstrate AutoCCS with data collected in various IMS systems and methods: DTIMS-MS, RapidFire-DTIMS-MS, TWIMS-MS, trapped IMS (TIMS)-MS and SLIM IMS-MS, for both authentic standard reference compounds and complex samples in various conditions (e.g. buffer gas and ionization mode).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of AutoCCS</title>
      <p>AutoCCS is a freely available command-line tool to determine CCS values from various IMS-MS platforms and data acquisition modes. It is written in Python for greater accessibility and is complementary to other data processing layers, such as raw MS-data preprocessing [i.e. PNNL-PreProcessor (<xref rid="btab429-B1" ref-type="bibr">Bilbao, 2020</xref>)] and feature finding. The main input is the list of IMS features (i.e. tables of mass and arrival time), which can be generated with the user’s preferred software (Agilent proprietary Mass Profiler .cef and open-source MZmine .csv formats are currently supported). </p>
      <p>AutoCCS allows users to change configurations as needed to calculate CCS in various use cases. Configuration parameters (e.g. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) and command-line options that users can control can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>, respectively.</p>
      <p>For the stepped-field DTIMS method (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>), AutoCCS allows users to automatically determine CCS values for targeted ions by performing linear regression using various fields(<xref rid="btab429-F1" ref-type="fig">Fig. 1a</xref>). For the single-field DTIMS method (<xref rid="btab429-B8" ref-type="bibr">Kurulugama <italic toggle="yes">et al.</italic>, 2015</xref>), AutoCCS supports two modes: the standard method and also an ‘enhanced’ calibration method to improve CCS determination in high-throughput experiments by accounting for temperature and pressure variations between calibrant and complex sample analyses (<xref rid="btab429-F1" ref-type="fig">Fig. 1b</xref>). For TWIMS methods, AutoCCS offers a polynomial function and linearized power function to apply to calibration curves.</p>
      <fig position="float" id="btab429-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Overall workflow of AutoCCS for different types of IMS-MS experiments. (<bold>a</bold>) Stepped-field (also known as multi-field) example with IMS features found in each field for a target molecule and two configured adducts (protonated in blue and sodiated in red). The features from each field are grouped to fit a linear regression model, from which the slope derives the mobility (<italic toggle="yes">k</italic><sub>0</sub>) of the ions and is used in the fundamental ion mobility equation (<xref rid="btab429-B15" ref-type="bibr">Revercomb and Mason, 1975</xref>) to determine the CCS. The AutoCCS comprehensive output includes all detected conformers and various metrics to help researchers evaluate the quality and select plausible CCS values. For the sodiated adduct shown, two high-quality conformers were found with high and medium intensity features detected in all fields. Only one high-quality conformer was detected for the protonated adduct with high intensity (the smaller intensity conformer was detected in only two fields). (<bold>b</bold>) Single-field example with all (unknown) detected features shown in green before calibration. Features detected for the calibrant ions with known CCS (internal or external measured under the same conditions) are used to build the calibration curve and calculate CCS for the unknown features, which are shown in blue after calibration. Based on the calibrants, linear regression is performed for DTIMS and timsTOF (yellow features on top panel) and non-linear regression (with polynomial or linearized power functions) is utilized for TWIMS (purple features on bottom panel)</p>
        </caption>
        <graphic xlink:href="btab429f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Stepped-field DTIMS</title>
      <p>A traditional, standardized stepped-field DTIMS method provides straightforward and highly reproducible accurate CCS determination, with very low relative standard deviations, even among different laboratories (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>). The stepped-field method employed in DTIMS takes advantage of the linear relationship of arrival time (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and reduced mobility (<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>), as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>273.15</mml:mn></mml:mrow><mml:mrow><mml:mn>760</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula>using the length of the drift tube (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula>), temperature (<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>T</mml:mi></mml:math></inline-formula>), drift gas pressure (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>), drift voltage (<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>V</mml:mi></mml:math></inline-formula>) and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> which encompasses time spent outside of the drift cell. Based on this linear regression analysis, the molecular CCS values can be directly computed as below (<xref rid="btab429-B15" ref-type="bibr">Revercomb and Mason, 1975</xref>):
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mo>Ω</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>μ</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mfrac><mml:mrow><mml:mn>760</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>273.15</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>μ</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo> </mml:mo></mml:math></disp-formula>where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mi>e</mml:mi></mml:math></inline-formula> is the ionic charge (<inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula>: charge state of the ion, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>e</mml:mi></mml:math></inline-formula>: unit electronic charge), <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the number density of the drift gas, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula> is the reduced mass of the ion, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> is the Boltzmann constant and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>E</mml:mi></mml:math></inline-formula>(=<inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>V</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:math></inline-formula>) is the electric field.</p>
      <p>AutoCCS allows users to automatically search for multiple adduct ions. A list of target ions with neutral exact masses (e.g. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) and metadata files with IMS acquisition conditions (e.g. electric fields, pressures and temperatures which are exported using the PNNL-PreProcessor) are also required. Based on the exact mass and configured adducts, the target ions are generated and selected from the measured mass-to-charge (<italic toggle="yes">m/z</italic>) ratio of the given IMS features and <italic toggle="yes">m/z</italic> tolerance as defined by users. For each combination of the selected features (i.e. arrival time) in all <italic toggle="yes">n</italic> fields, AutoCCS performs linear regression analysis between <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> where <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates the arrival time of the <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>th features in the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>th field, and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the pressure and temperature in the <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>th field, respectively. Among all combinations of selected features, AutoCCS identifies the best fit regressors by the <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> threshold value (e.g. <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>0.99</mml:mn></mml:math></inline-formula> by default), which users can customize. To reduce the number of combinations, users can limit the number of selected features in each field based on peak intensity ranks. See the details about the user parameters in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>.</p>
      <p>AutoCCS delivers the following output files for the stepped-field method analysis: (i) a tab-delimited text file containing calculated CCS values of target ions found for each standard compound and all information about the experimental features used (e.g. arrival time, intensity, mass error and linear regression analysis in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>), (ii) plots of linear regressors and the selected features (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), (iii) plots of the distributions of feature intensities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and (iv) plots of the metadata (temperatures, pressures and voltages in drift tubes) in all frames (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Single-field DTIMS</title>
      <p>As an alternative to the stepped-field method, a single-field method has been widely accepted as more practical for estimating the CCS values of detected ions in complex samples, particularly when liquid chromatography and similar front-end separation methods are coupled with DTIMS. Contrary to the stepped-field method that depends on multiple instrument parameters, the single-field DTIMS method (Kurulugama <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>.</mml:mo></mml:math></inline-formula>, 2015) is based on a linear regression using known CCS (from literature or stepped-field experiments) of calibrant species. An example of the list of calibrant ions is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. This calibration curve allows CCS determination of other analytes from their arrival times measured under the same IMS conditions as the calibrants. As such, for the single-field CCS determination a target list of analyte ions is not required and AutoCCS processes data in an untargeted fashion by applying the calibration function to all detected features.</p>
    </sec>
    <sec>
      <title>2.4 Enhanced single-field DTIMS</title>
      <p>In a typical single-field experiment, there is an assumption that temperature and pressure will not change between the calibrant and actual sample analyses (i.e. using ‘external’ calibration). In practice, the analysis of calibrants is usually performed once or twice a day in order to maintain the data acquisition throughput for the analysis of real samples. However, the instrument conditions (e.g. temperature and pressure) may vary enough to affect the CCS determination if there is a considerable time gap (e.g. few hours) between the calibrant and real sample analyses or if the ambient laboratory conditions changed significantly.</p>
      <p>To reduce the undesired effects of both temperature and pressure variations between sample runs and to improve accuracy using external calibration, we implemented an enhanced single-field method with an adjusted CCS (<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">″</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) derived by additionally accounting for temperature (<inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>T</mml:mi></mml:math></inline-formula>) and pressure (<inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>) to the reduced CCS (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>), used in a standard method, as shown in <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">and</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">″</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mi>T</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:msqrt><mml:mi>T</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>Ω</mml:mo><mml:mo> </mml:mo></mml:math></disp-formula>where <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula>, <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>Ω</mml:mo></mml:math></inline-formula> denote the ion charge state, the ion mass, the buffer gas mass and the known CCS value, respectively. Combining <xref rid="E1" ref-type="disp-formula">Equations (1)</xref> and <xref rid="E2" ref-type="disp-formula">(2)</xref>, a linear calibration function can be derived as follows (<xref rid="btab429-B11" ref-type="bibr">Marchand <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>):
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mo>μ</mml:mo></mml:msqrt></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>Ω</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mi>T</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mn>16</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>273.15</mml:mn></mml:mrow><mml:mrow><mml:mn>760</mml:mn><mml:mi>V</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Pressure and temperature terms were incorporated into the reduced CCS in the enhanced method whereas empirical correlation with <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:msqrt><mml:mi>T</mml:mi></mml:msqrt></mml:math></inline-formula> has been ignored as a constant in the conventional method. AutoCCS provides an option to select whether to use this enhanced version or to use the default one to characterize the calibration curve.</p>
      <p>For single-field methods, AutoCCS visualizes the calibration curves, which facilitates visual inspection of the curve fitting result and its quality (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) and easy verification of selected ions and the regression models.</p>
    </sec>
    <sec>
      <title>2.5 Calibration methods for TWIMS</title>
      <p>For TWIMS instrumentation, such as for SLIM devices, CCS cannot be calculated directly using the mathematical function provided by the fundamental low-field ion mobility equation (<xref rid="btab429-B15" ref-type="bibr">Revercomb and Mason, 1975</xref>) due to the variable electric field used in TWIMS (<xref rid="btab429-B4" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab429-B9" ref-type="bibr">Lanucara <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab429-B16" ref-type="bibr">Ruotolo <italic toggle="yes">et al.</italic>, 2008</xref>). Unlike the single-field method in DTIMS, a non-linear relationship needs to be accounted for effective calibration in TWIMS. For this purpose, AutoCCS performs either a polynomial (<xref rid="btab429-B2" ref-type="bibr">Bush <italic toggle="yes">et al.</italic>, 2012</xref>) or power (<xref rid="btab429-B4" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab429-B16" ref-type="bibr">Ruotolo <italic toggle="yes">et al.</italic>, 2008</xref>) regression analysis using the arrival time <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and known CCS values of reference compounds to create a calibration function for determination of TWIMS CCS.</p>
      <p>For polynomial regression, data for each calibrant run is fit using the <xref rid="E5" ref-type="disp-formula">Equation (5)</xref>:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">and</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">acc</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:math></disp-formula>where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> denotes the degree of the polynomial function that users choose, <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the ion accumulation time in the SLIM system and <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> represents the reduced CCS. For example, if <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>=2 or 3, it becomes a quadratic function for the binomial regression or a cubic function for the trinomial regression, respectively.</p>
      <p>In the power regression, the calibrant arrival times were corrected by <xref rid="E6" ref-type="disp-formula">Equation (6)</xref>:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">acc</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:math></disp-formula>where <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> is a constant coefficient designated as the EDC (Enhanced Duty Cycle) delay coefficient for the Synapt Q-IM-o-ToF instrument (<xref rid="btab429-B16" ref-type="bibr">Ruotolo <italic toggle="yes">et al.</italic>, 2008</xref>), but was set to 0 for the SLIM system. Then the linear relationship between corrected arrival time (<inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) and the reduced CCS values (<inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) is fit to the linearized power function as follows:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mrow><mml:mo> </mml:mo></mml:math></disp-formula>where <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> denote the coefficients of the power function. From this regression analysis, we calculate the new corrected arrival time (<inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) from <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mi mathvariant="normal">z</mml:mi><mml:mo>×</mml:mo><mml:msqrt><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>μ</mml:mo></mml:msqrt><mml:mo> </mml:mo></mml:math></disp-formula>where <italic toggle="yes">z</italic> and <italic toggle="yes">μ</italic> denote a charge state and a reduced mass of the ion, respectively. Finally, <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> can be translated to the known CCS values (<inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mo>Ω</mml:mo></mml:math></inline-formula>) by fitting a linear regressor as follows:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">b</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.6 Sample preparation</title>
      <p>Agilent ESI-L low concentration tuning mix solution (Agilent Santa Clara, CA; <ext-link xlink:href="https://www.agilent.com/cs/library/certificateofanalysis/G1969-85000cofa872022-U-LB86189.pdf" ext-link-type="uri">https://www.agilent.com/cs/library/certificateofanalysis/G1969-85000cofa872022-U-LB86189.pdf</ext-link>) was used without further purification, hereafter referred as tune-mix. Tetraalkyl ammonium (TAA) salts were purchased from Sigma-Aldrich (Milwaukee, WI USA) and used without any further purification. The TAA salts, consisting of tetraethylammonium through tetraoctylammonium, were prepared as a mixture to a final concentration of 1 µM in 50/50 water/methanol with 0.5% acetic acid (<italic toggle="yes">v</italic>/<italic toggle="yes">v</italic>). Rotenone was spiked into a complex background of 3553 plant leaf extracts at 0.001 mg/ml. Briefly, leaf samples were harvested from a field located at the University of California Agriculture &amp; Natural Resources (UC-ANR) Kearney Agricultural Research &amp; Extension Center (KARE) in Parlier, CA for a large-scale plant study to assay the natural diversity of <italic toggle="yes">Sorghum bicolor</italic>. The leaves were placed into 50-ml conical tubes and frozen with liquid nitrogen in the field and then lyophilized. Dried samples were pulverized and ground. 60 mg aliquots were measured out of each leaf sample for metabolite extraction. 1 ml of 80:20 MeOH: H2O was added and samples were centrifuged. The supernatant was removed (∼800 µl) and further aliquoted into conical bottom 96 well plates, analyzed via solid-phase extraction with IMS-MS (SPE-IMS-MS) (<xref rid="btab429-B19" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <p>The IROA standards (Adenine, <sc>d</sc>-(+)-Trehalose and Pterin) were purchased from IROA Technologies (Sea Girt, NJ, USA), and all reagents were purchased from Thermo Fisher Scientific (Waltham, MA, USA). Standards were supplied as 5 µg dried weight and reconstituted using a combination of 0.1% acetic acid, 79.9% methanol and 19.9% water. Stock solutions of the standards were prepared at either 100 or 500 µM concentration and then further diluted to a concentration of 10 µM prior to analysis.</p>
    </sec>
    <sec>
      <title>2.7 Data acquisition</title>
      <sec>
        <label>2.7.1</label>
        <title>Stepped-field DTIMS-MS measurements</title>
        <p>For the experiments with nitrogen, the Agilent tune-mix solution was analyzed by direct infusion using an Agilent jet stream orthogonal electrospray ionization source maintained at the following parameters: nitrogen sheath gas, sheath gas temperature, drying gas, drying gas temperature, nozzle voltage and inlet capillary voltage of at 8 l/min, 275°C, 3 l/min, 325°C, 2 kV and 4 kV respectively. Data were acquired on an Agilent 6560 Ion Mobility QTOF MS system (Agilent Technologies, Santa Clara, CA) using a stepped-field method and the drift potential was varied between 850 and 1450 V by 100 V increments, and each drift potential was acquired for 30 s.</p>
        <p>For the IROA standards and TAA mixture experiments with helium, a customized flow injection system (<xref rid="btab429-B12" ref-type="bibr">Orton <italic toggle="yes">et al.</italic>, 2018</xref>) was coupled to an in-house built IMS-MS instrument that combines a 1 m drift tube with an Agilent 6538 QTOF MS (<xref rid="btab429-B5" ref-type="bibr">Ibrahim <italic toggle="yes">et al.</italic>, 2015</xref>) and is comparable to the commercial Agilent 6560 system but providing increased IMS resolution. For these experiments, the drift potential was varied between 677 and 1198 V by 87 V increments, and each drift potential was acquired for 44 s. The IMS was pressurized with ultrahigh purity helium, and the trapping funnel pressure and drift tube pressure were maintained at 3.8 and 4.0 Torr, respectively.</p>
      </sec>
      <sec>
        <label>2.7.2</label>
        <title>SLIM IMS measurements</title>
        <p>The SLIM TWIMS-MS platform used for these experiments has been described in detail elsewhere (<xref rid="btab429-B18" ref-type="bibr">Wojcik <italic toggle="yes">et al.</italic>, 2019</xref>) and is comparable to an instrument that will soon be commercially available (<ext-link xlink:href="https://mobilionsystems.com" ext-link-type="uri">https://mobilionsystems.com</ext-link>). The Agilent tune-mix, TAA mixture and IROA standards were infused by a customized flow injection system (<xref rid="btab429-B12" ref-type="bibr">Orton <italic toggle="yes">et al.</italic>, 2018</xref>) at 300 nl/min for nano-electrospray ionization at 3 kV into an inlet capillary heated to 130°C. Ions pass through an ion funnel (3.60 Torr, helium buffer gas) before entering the SLIM module (3.80 Torr, He buffer gas). As described previously, ions were accumulated in the SLIM module at an interface 9 m into the 13.5 m ion path (<xref rid="btab429-B3" ref-type="bibr">Deng <italic toggle="yes">et al.</italic>, 2017</xref>). For these experiments, an accumulation period of 1000 ms was performed prior to separation in the remaining 4.5 m at a TW amplitude of 12 Vpp and TW speed of 180 m/s. An Agilent 6224 TOF mass spectrometer (Agilent Technologies, Santa Clara, CA) was used for all experiments. All SLIM TWIMS-MS data was acquired using home-built software.</p>
      </sec>
      <sec>
        <label>2.7.3</label>
        <title>Synapt IMS measurements</title>
        <p>The Agilent tune-mix solution was infused into a Waters Synapt G2s-i mass spectrometer using a static nanoelectrospray source. A borosilicate glass emitter (in house pulled using Sutter Instrument, model P-1000) containing the sample was in contact with a platinum wire, applied with 1.3 kV for electrospray. Source temperature was 150°C and sampling cone at 150 V. No source gas was used. Instrument tune parameters were at default values. Trap (argon), helium cell and IMS (nitrogen) gas flow was 2, 180 and 90 ml/min, respectively. Traveling wave (default) settings were 313 m/s 4 V trap, 650 m/s 40 V IMS and 175 m/s 4 V transfer. Spectra were averaged over 1.6 min, and the IMS peak list was generated using default peak detection settings in DriftScope v2.4 and manually formatted as MZmine csv output. EDC delay coefficient was 1.45.</p>
      </sec>
      <sec>
        <label>2.7.4</label>
        <title>Bruker timsTOF data</title>
        <p>Agilent tune-mix data were kindly provided by Bruker Corporation. Data were acquired on a Bruker timsTOF Pro™ instrument equipped with trapped ion mobility coupled to a QTOF MS. Ions were generated in positive electrospray ionization mode using a scan range of 100–1600 <italic toggle="yes">m/z</italic>. Tune mix features were extracted using MetaboScape and IMS scan numbers were used as a substitute for drift times for CCS calibration.</p>
      </sec>
      <sec>
        <label>2.7.5</label>
        <title>Single-field DTIMS-MS measurements with RapidFire</title>
        <p>Plant extracts were analyzed by SPE-IMS-MS using a RapidFire 365 (Agilent Technologies, Santa Clara, CA) coupled with an Agilent 6560 Ion Mobility QTOF MS system (Agilent Technologies, Santa Clara, CA). Samples were loaded onto Graphitic Carbon and C18 SPE cartridges. The IMS was pressurized with ultrahigh purity nitrogen. All data were acquired in positive electrospray mode with a mass range of <italic toggle="yes">m/z</italic> 50–1700. A total of 7106 metabolite IMS runs were acquired. Agilent tune-mix was analyzed daily for single-field CCS calibration (28 calibrant runs).</p>
      </sec>
    </sec>
    <sec>
      <title>2.8 IMS data pre-processing and feature finding</title>
      <p>The Unified Ion Mobility Frame (UIMF) file format (<ext-link xlink:href="https://github.com/PNNL-Comp-Mass-Spec/UIMF-Library" ext-link-type="uri">https://github.com/PNNL-Comp-Mass-Spec/UIMF-Library</ext-link>) was used for in-house IMS/SLIM platforms to store both the raw data and the metadata associated with an IMS-MS experiment in a single cross platform file. Raw MS files (MassHunter ‘.d’ or UIMF format) were pre-processed in batch mode using the PNNL-PreProcessor v2020.07.24 (<ext-link xlink:href="https://omics.pnl.gov/software/pnnl-preprocessor" ext-link-type="uri">https://omics.pnl.gov/software/pnnl-preprocessor</ext-link>) to apply smoothing and generate new raw files with all frames (ion mobility separations) summed into a single frame and export frame metadata text files containing the IMS acquisition conditions (e.g. electric fields, pressure and temperature). For the stepped-field method, the option to split the file by field was used and a new raw file was generated for each field. For RapidFire, the first and last four frames were excluded to remove chemical noise and background ions. Ion mobility smoothing using 3 points and a minimum intensity threshold of 30 counts were applied for DTIM files, and 15 points and a minimum intensity threshold of 1 count for SLIM files. For Agilent and in-house SLIM data processing, we employed the PNNL-PreProcessor in the pipeline. However, any other tools can be applied for feature finding (i.e. identifying peaks with <italic toggle="yes">m/z</italic> and drift time). The PreProcessor was mandatory for the stepped-field method, since it was the only tool with the functionality to export the IMS instrument parameters needed for the stepped-field and the enhanced single-field CCS calculations.</p>
      <p>Single-frame files were converted to mzML using ProteoWizard v3.0.19228 64-bit (<xref rid="btab429-B7" ref-type="bibr">Kessner <italic toggle="yes">et al.</italic>, 2008</xref>), arrival time was used as a substitute for retention time to generate ‘LC-MS-like’ files and feature detection was performed in batch mode using MZmine 2 v2.41.2 (<xref rid="btab429-B14" ref-type="bibr">Pluskal <italic toggle="yes">et al.</italic>, 2010</xref>) with the steps: mzML raw data import, mass detector ‘Wavelet transform’, chromatogram builder, chromatogram deconvolution (‘Local minimum search’ for DTIM and ‘Noise amplitude’ for SLIM) and CSV data export. Supplementary Figure S6 describes the complete procedures for IMS data pre-processing and feature finding from the raw data files.</p>
    </sec>
    <sec>
      <title>2.9 CCS calculation using IM-MS browser</title>
      <p>The Agilent MassHunter IM-MS Browser v10.0 was used for manual CCS determination. For single-field runs, the corresponding infusion run of the tune-mix was used for CCS calibration followed by IMFE feature finding and exporting of features as csv. For stepped-field calculation of each run, all frames from the 4th field were selected and summed and then each target adduct ion was selected by boxing the first two isotopic peaks to run the CCS calculation and copy-and-paste the results in MS-Excel.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Tune-mix sample runs in different IMS platforms and modes</title>
      <p>To evaluate the performance of AutoCCS, we conducted five infusion experiments with tune-mix sample runs in positive electrospray mode: (i) stepped-field DTIMS-MS utilizing seven electric fields, (ii) single-field DTIMS-MS, (iii) TWIMS analysis on a SLIM and (iv) Waters Synapt and (v) trapped IMS data from a Bruker timsTOF. <xref rid="btab429-T1" ref-type="table">Table 1</xref> shows that the reproducibility of the CCS determinations of the ions from the Agilent tune-mix sample was excellent across these IMS systems and that AutoCCS was effective for all IMS methods, automatically calculating CCS values with acceptable differences compared to manually determined CCS using vendor software.</p>
      <table-wrap position="float" id="btab429-T1">
        <label>Table 1.</label>
        <caption>
          <p>CCS values calculated for Agilent tune-mix samples measured in positive electrospray mode in nitrogen drift gas with four different IMS platforms</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Type</th>
              <th rowspan="1" colspan="1">Tune-mix calibrants</th>
              <th rowspan="1" colspan="1">Adduct Ions <italic toggle="yes">m/z</italic></th>
              <th rowspan="1" colspan="1">AutoCCS CCS (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>1</sup>CCS<sub>Browser</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>1</sup><inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>Browser</sub> (%)</th>
              <th rowspan="1" colspan="1"><sup>2</sup>CCS<sub>PNNL</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>2</sup><inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>PNNL</sub> (%)</th>
              <th rowspan="1" colspan="1"><sup>3</sup>CCS<sub>McLean</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>3</sup><inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>McLean</sub> (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="10" colspan="1">Stepped-field DTIMS-MS</td>
              <td rowspan="2" colspan="1">TuneMix321</td>
              <td rowspan="2" colspan="1">322.0481</td>
              <td rowspan="2" colspan="1">153.6123</td>
              <td rowspan="2" colspan="1">153.9</td>
              <td rowspan="2" colspan="1">0.19</td>
              <td rowspan="2" colspan="1">153.7</td>
              <td rowspan="2" colspan="1">0.06</td>
              <td rowspan="1" colspan="1">153.4(1)</td>
              <td rowspan="1" colspan="1">0.14(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">153.5(6)</td>
              <td rowspan="1" colspan="1">0.07(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix621</td>
              <td rowspan="2" colspan="1">622.0290</td>
              <td rowspan="2" colspan="1">202.9291</td>
              <td rowspan="2" colspan="1">203.5</td>
              <td rowspan="2" colspan="1">0.28</td>
              <td rowspan="2" colspan="1">203.0</td>
              <td rowspan="2" colspan="1">0.03</td>
              <td rowspan="1" colspan="1">202.8(6)</td>
              <td rowspan="1" colspan="1">0.06(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">203(8)</td>
              <td rowspan="1" colspan="1">0.03(8)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix921</td>
              <td rowspan="2" colspan="1">922.0098</td>
              <td rowspan="2" colspan="1">244.9022</td>
              <td rowspan="2" colspan="1">244.4</td>
              <td rowspan="2" colspan="1">0.21</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">243.9(1)</td>
              <td rowspan="1" colspan="1">0.41(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">243.5(6)</td>
              <td rowspan="1" colspan="1">0.58(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1220</td>
              <td rowspan="2" colspan="1">1221.9906</td>
              <td rowspan="2" colspan="1">283.1977</td>
              <td rowspan="2" colspan="1">282.9</td>
              <td rowspan="2" colspan="1">0.11</td>
              <td rowspan="2" colspan="1">282.2</td>
              <td rowspan="2" colspan="1">0.35</td>
              <td rowspan="1" colspan="1">283.1(1)</td>
              <td rowspan="1" colspan="1">0.03(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">281.8(6)</td>
              <td rowspan="1" colspan="1">0.50(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1520</td>
              <td rowspan="2" colspan="1">1521.9715</td>
              <td rowspan="2" colspan="1">317.0891</td>
              <td rowspan="2" colspan="1">317.8</td>
              <td rowspan="2" colspan="1">0.22</td>
              <td rowspan="2" colspan="1">317.0</td>
              <td rowspan="2" colspan="1">0.03</td>
              <td rowspan="1" colspan="1">318.9(1)</td>
              <td rowspan="1" colspan="1">0.57(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">316.5(6)</td>
              <td rowspan="1" colspan="1">0.19(6)</td>
            </tr>
            <tr>
              <td rowspan="9" colspan="1">Single-field DTIMS-MS</td>
              <td rowspan="2" colspan="1">TuneMix321</td>
              <td rowspan="2" colspan="1">322.0481</td>
              <td rowspan="2" colspan="1">153.9290</td>
              <td rowspan="2" colspan="1">153.8</td>
              <td rowspan="2" colspan="1">0.08</td>
              <td rowspan="2" colspan="1">153.7</td>
              <td rowspan="2" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">153.4(1)</td>
              <td rowspan="1" colspan="1">0.34(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">153.5(6)</td>
              <td rowspan="1" colspan="1">0.28(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix621</td>
              <td rowspan="2" colspan="1">622.0290</td>
              <td rowspan="2" colspan="1">203.0138</td>
              <td rowspan="2" colspan="1">203.0</td>
              <td rowspan="2" colspan="1">0.01</td>
              <td rowspan="2" colspan="1">203.0</td>
              <td rowspan="2" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">202.8(6)</td>
              <td rowspan="1" colspan="1">0.11(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">203(8)</td>
              <td rowspan="1" colspan="1">0.01(8)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix921</td>
              <td rowspan="2" colspan="1">922.0098</td>
              <td rowspan="2" colspan="1">243.4948</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.04</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.04</td>
              <td rowspan="1" colspan="1">243.9(1)</td>
              <td rowspan="1" colspan="1">0.17(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">243.5(6)</td>
              <td rowspan="1" colspan="1">0.00(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TuneMix1220</td>
              <td rowspan="1" colspan="1">1221.9906</td>
              <td rowspan="1" colspan="1">281.7040</td>
              <td rowspan="1" colspan="1">282.1</td>
              <td rowspan="1" colspan="1">0.14</td>
              <td rowspan="1" colspan="1">282.2</td>
              <td rowspan="1" colspan="1">0.18</td>
              <td rowspan="1" colspan="1">283.1(1)<break/>281.8(6)</td>
              <td rowspan="1" colspan="1">0.49(1)<break/>0.03(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1520</td>
              <td rowspan="2" colspan="1">1521.9715</td>
              <td rowspan="2" colspan="1">317.4272</td>
              <td rowspan="2" colspan="1">317.0</td>
              <td rowspan="2" colspan="1">0.13</td>
              <td rowspan="2" colspan="1">317</td>
              <td rowspan="2" colspan="1">0.13</td>
              <td rowspan="1" colspan="1">318.9(1)</td>
              <td rowspan="1" colspan="1">0.46(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">316.5(6)</td>
              <td rowspan="1" colspan="1">0.29(6)</td>
            </tr>
            <tr>
              <td rowspan="8" colspan="1">TWIMS-MS (SLIM)</td>
              <td rowspan="2" colspan="1">TuneMix621</td>
              <td rowspan="2" colspan="1">622.0290</td>
              <td rowspan="2" colspan="1">203.1121</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">203</td>
              <td rowspan="2" colspan="1">0.06</td>
              <td rowspan="1" colspan="1">202.8(6)</td>
              <td rowspan="1" colspan="1">0.15(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">203(8)</td>
              <td rowspan="1" colspan="1">0.06(8)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix921</td>
              <td rowspan="2" colspan="1">922.0098</td>
              <td rowspan="2" colspan="1">243.2938</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.13</td>
              <td rowspan="1" colspan="1">243.9(1)</td>
              <td rowspan="1" colspan="1">0.25(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">243.5(6)</td>
              <td rowspan="1" colspan="1">0.08(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1220</td>
              <td rowspan="2" colspan="1">1221.9906</td>
              <td rowspan="2" colspan="1">282.4849</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">282.2</td>
              <td rowspan="2" colspan="1">0.10</td>
              <td rowspan="1" colspan="1">283.1(1)</td>
              <td rowspan="1" colspan="1">0.22(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">281.8(6)</td>
              <td rowspan="1" colspan="1">0.24(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1520</td>
              <td rowspan="2" colspan="1">1521.9715</td>
              <td rowspan="2" colspan="1">316.9095</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">317</td>
              <td rowspan="2" colspan="1">0.03</td>
              <td rowspan="1" colspan="1">318.9(1)</td>
              <td rowspan="1" colspan="1">0.62(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">316.5(6)</td>
              <td rowspan="1" colspan="1">0.13(6)</td>
            </tr>
            <tr>
              <td rowspan="10" colspan="1">TWIMS-MS (SYNAPT)</td>
              <td rowspan="2" colspan="1">TuneMix321</td>
              <td rowspan="2" colspan="1">322.0481</td>
              <td rowspan="2" colspan="1">154.1847</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">153.7</td>
              <td rowspan="2" colspan="1">0.32</td>
              <td rowspan="1" colspan="1">153.4(1)</td>
              <td rowspan="1" colspan="1">0.51(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">153.5(6)</td>
              <td rowspan="1" colspan="1">0.45(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix621</td>
              <td rowspan="2" colspan="1">622.0290</td>
              <td rowspan="2" colspan="1">202.9855</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">203</td>
              <td rowspan="2" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">202.8(6)</td>
              <td rowspan="1" colspan="1">0.09(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">203(8)</td>
              <td rowspan="1" colspan="1">0.01(8)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix921</td>
              <td rowspan="2" colspan="1">922.0098</td>
              <td rowspan="2" colspan="1">242.8969</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.29</td>
              <td rowspan="1" colspan="1">243.9(1)</td>
              <td rowspan="1" colspan="1">0.41(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">243.5(6)</td>
              <td rowspan="1" colspan="1">0.25(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1220</td>
              <td rowspan="2" colspan="1">1221.9906</td>
              <td rowspan="2" colspan="1">281.7227</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">282.2</td>
              <td rowspan="2" colspan="1">0.17</td>
              <td rowspan="1" colspan="1">283.1(1)</td>
              <td rowspan="1" colspan="1">0.49(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">281.8(6)</td>
              <td rowspan="1" colspan="1">0.03(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1520</td>
              <td rowspan="2" colspan="1">1521.9715</td>
              <td rowspan="2" colspan="1">317.4757</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">317</td>
              <td rowspan="2" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">318.9(1)</td>
              <td rowspan="1" colspan="1">0.45(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">316.5(6)</td>
              <td rowspan="1" colspan="1">0.31(6)</td>
            </tr>
            <tr>
              <td rowspan="10" colspan="1">TIMS-MS (timsTOF)</td>
              <td rowspan="2" colspan="1">TuneMix321</td>
              <td rowspan="2" colspan="1">322.0481</td>
              <td rowspan="2" colspan="1">153.8775</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">153.7</td>
              <td rowspan="2" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">153.4(1)</td>
              <td rowspan="1" colspan="1">0.31(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">153.5(6)</td>
              <td rowspan="1" colspan="1">0.25(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix621</td>
              <td rowspan="2" colspan="1">622.0290</td>
              <td rowspan="2" colspan="1">202.5721</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">203</td>
              <td rowspan="2" colspan="1">0.21</td>
              <td rowspan="1" colspan="1">202.8(6)</td>
              <td rowspan="1" colspan="1">0.11(6)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">203(8)</td>
              <td rowspan="1" colspan="1">0.21(8)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix921</td>
              <td rowspan="2" colspan="1">922.0098</td>
              <td rowspan="2" colspan="1">243.5977</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">243.6</td>
              <td rowspan="2" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">243.9(1)</td>
              <td rowspan="1" colspan="1">0.12(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">243.5(6)</td>
              <td rowspan="1" colspan="1">0.04(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1220</td>
              <td rowspan="2" colspan="1">1221.9906</td>
              <td rowspan="2" colspan="1">282.7998</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">282.2</td>
              <td rowspan="2" colspan="1">0.21</td>
              <td rowspan="1" colspan="1">283.1(1)</td>
              <td rowspan="1" colspan="1">0.11(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">281.8(6)</td>
              <td rowspan="1" colspan="1">0.35(6)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">TuneMix1520</td>
              <td rowspan="2" colspan="1">1521.9715</td>
              <td rowspan="2" colspan="1">316.6544</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">—</td>
              <td rowspan="2" colspan="1">317</td>
              <td rowspan="2" colspan="1">0.11</td>
              <td rowspan="1" colspan="1">318.9(1)</td>
              <td rowspan="1" colspan="1">0.70(1)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">316.5(6)</td>
              <td rowspan="1" colspan="1">0.05(6)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: All adduct ions are [M+H]<sup>+</sup>. In ΔCCS<sub>ref</sub> (%) columns: 100×|AutoCCS CCS - CCS<sub>ref</sub>|/CCS<sub>ref</sub>. <sup>1</sup>CCS<sub>Browser</sub> is obtained from the Agilent MassHunter IM-MS Browser 10.0 with raw .d files. <sup>2</sup>CCS<sub>PNNL</sub> is obtained from the PNNL CCS library (<ext-link xlink:href="http://panomics.pnnl.gov/metabolites/" ext-link-type="uri">http://panomics.pnnl.gov/metabolites/</ext-link>) (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab429-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>). <sup>3</sup>CCS<sub>McLean</sub> is from the Unified CCS Compendium (<ext-link xlink:href="https://mcleanresearchgroup.shinyapps.io/CCS-Compendium/" ext-link-type="uri">https://mcleanresearchgroup.shinyapps.io/CCS-Compendium/</ext-link>, 2020/08/26 release) (<xref rid="btab429-B13" ref-type="bibr">Picache <italic toggle="yes">et al.</italic>, 2019</xref>) (#) in <sup>3</sup>CCS<sub>McLean</sub> and <sup>3</sup>ΔCCS<sub>McLean</sub> (%) columns represents the different data sources used in the CCS Compendium repository. For example, CCS values of (6) in the CCS<sub>McLean</sub> were sourced from the interlaboratory experimental study (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>). For SLIM data, the quadratic function with polynomial calibration method was employed (Tune-Mix ion 321 was excluded due to low signal-to-noise). For Waters Synapt data, the linearized power function was used. For Bruker timsTOF data, the linear function was employed with IMS scan numbers used as substitute for drift time.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The Agilent IM-MS Browser is a user-friendly tool for visualization and processing of DTIMS data, which is the reference software for CCS calculation in the DTIMS scientific community. Here, we refer to the CCS determination using this vendor software as manual since it processes one file-compound-adduct at a time for stepped-field CCS calculations. In the case of single-field data, the user must manually select through the GUI each calibrant run and the corresponding runs to be calibrated. This user-interaction driven method is necessary for quality control and helps to educate users about the data but cannot be automated. Therefore, we developed AutoCCS using automated software components.</p>
      <p>Inherent differences in feature detection algorithms between MZmine and IM-MS Browser led to small differences in CCS values. While the difference was minimal for most cases (under 0.2%), we observed a larger difference for a few ions using the stepped-field method. A detailed inspection revealed that the arrival time determined by the IM-MS Browser software when performing stepped-field CCS calculations could result in larger differences for low intensity ions due to two main factors: (i) the field used for the manual selection of the ion and (ii) the IM-MS Browser applies a Gaussian fit and MZmine uses the peak apex. While a Gaussian model is generally more accurate for determining the centroid of low intensity ions which are noisy, inconsistencies due to the manual selection of ions could be more detrimental. Overall, we observed that the differences are within acceptable ranges according to the instrument resolution.</p>
    </sec>
    <sec>
      <title>3.2 Standard molecules with stepped-field DTIMS-MS</title>
      <p>In addition to the tune-mix calibrants, we also evaluated AutoCCS for the automatic calculation of CCS using DTIMS-MS for well-studied metabolites and peptides (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). Previously collected raw data (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab429-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>) was re-processed for the three metabolites and seven peptides in positive and negative electrospray modes (only positive for D-Biotin). AutoCCS provided good reproducibility (0.4% RSD) and consistency against manually determined CCS values as well (<xref rid="btab429-T2" ref-type="table">Table 2</xref>). Once the target list of molecules with neutral masses was defined and the adducts in the AutoCCS configuration file were specified, AutoCCS automatically generated all adduct ions for each molecule, performed all calculations, generated various visualization plots and generated a single output table with the CCS and all the information of all molecules, including statistics such as mean and RSD per technical replicates. Using AutoCCS, all processing for metabolites took 17 min in an unattended fashion; in contrast, about 2 h were required to manually process the 15 raw .d files, including numerous mouse clicks as well as additional calculations in MS Excel to compare replicates.</p>
      <table-wrap position="float" id="btab429-T2">
        <label>Table 2.</label>
        <caption>
          <p>Results of CCS determination from stepped-field measurements in nitrogen drift gas using the demo dataset of the target compounds described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Name</th>
              <th rowspan="1" colspan="1">Type</th>
              <th rowspan="1" colspan="1">Adduct</th>
              <th rowspan="1" colspan="1">Adduct <italic toggle="yes">m/z</italic></th>
              <th rowspan="1" colspan="1">CCS<sub>avg</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1">%RSD</th>
              <th rowspan="1" colspan="1"><sup>1</sup>CCS<sub>Browser</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>1</sup><inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>Browser</sub> (%)</th>
              <th rowspan="1" colspan="1"><sup>2</sup>CCS<sub>PNNL</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>2</sup><inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>PNNL</sub> (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><sc>d</sc>-Biotin</td>
              <td rowspan="1" colspan="1">Metabolite</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">245.10</td>
              <td rowspan="1" colspan="1">154.0411</td>
              <td rowspan="1" colspan="1">0.40</td>
              <td rowspan="1" colspan="1">154.0</td>
              <td rowspan="1" colspan="1">0.03</td>
              <td rowspan="1" colspan="1">154.16</td>
              <td rowspan="1" colspan="1">0.08</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">[M+Na]<sup>+</sup></td>
              <td rowspan="1" colspan="1">267.08</td>
              <td rowspan="1" colspan="1">163.9419</td>
              <td rowspan="1" colspan="1">0.63</td>
              <td rowspan="1" colspan="1">164.3</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">164.45</td>
              <td rowspan="1" colspan="1">0.31</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Sucrose</td>
              <td rowspan="1" colspan="1">Metabolite</td>
              <td rowspan="1" colspan="1">[M+Na]<sup>+</sup></td>
              <td rowspan="1" colspan="1">365.11</td>
              <td rowspan="1" colspan="1">174.7238</td>
              <td rowspan="1" colspan="1">0.34</td>
              <td rowspan="1" colspan="1">174.7</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">173.93</td>
              <td rowspan="1" colspan="1">0.46</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">β-Nicotinamide adenine dinucleotide</td>
              <td rowspan="3" colspan="1">Metabolite</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">664.12</td>
              <td rowspan="1" colspan="1">229.6815</td>
              <td rowspan="1" colspan="1">0.41</td>
              <td rowspan="1" colspan="1">229.3</td>
              <td rowspan="1" colspan="1">0.18</td>
              <td rowspan="1" colspan="1">229.46</td>
              <td rowspan="1" colspan="1">0.10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+Na]<sup>+</sup></td>
              <td rowspan="1" colspan="1">686.10</td>
              <td rowspan="1" colspan="1">226.6511</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">226.1</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">226.24</td>
              <td rowspan="1" colspan="1">0.18</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M-H]<sup>-</sup></td>
              <td rowspan="1" colspan="1">662.10</td>
              <td rowspan="1" colspan="1">230.1841</td>
              <td rowspan="1" colspan="1">0.28</td>
              <td rowspan="1" colspan="1">229.0</td>
              <td rowspan="1" colspan="1">0.50</td>
              <td rowspan="1" colspan="1">228.12</td>
              <td rowspan="1" colspan="1">0.90</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Angiotensin I</td>
              <td rowspan="3" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+2H] <sup>2+</sup></td>
              <td rowspan="1" colspan="1">648.85</td>
              <td rowspan="1" colspan="1">386.06</td>
              <td rowspan="1" colspan="1">0.42</td>
              <td rowspan="1" colspan="1">386.2</td>
              <td rowspan="1" colspan="1">0.04</td>
              <td rowspan="1" colspan="1">386.13</td>
              <td rowspan="1" colspan="1">0.02</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+3H] <sup>3+</sup></td>
              <td rowspan="1" colspan="1">432.90</td>
              <td rowspan="1" colspan="1">474.32</td>
              <td rowspan="1" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">475.5</td>
              <td rowspan="1" colspan="1">0.26</td>
              <td rowspan="1" colspan="1">476.05</td>
              <td rowspan="1" colspan="1">0.36</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+4H]<sup>4+</sup></td>
              <td rowspan="1" colspan="1">324.93</td>
              <td rowspan="1" colspan="1">545.51</td>
              <td rowspan="1" colspan="1">0.32</td>
              <td rowspan="1" colspan="1">548.9</td>
              <td rowspan="1" colspan="1">0.62</td>
              <td rowspan="1" colspan="1">548.67</td>
              <td rowspan="1" colspan="1">0.58</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Angiotensin II</td>
              <td rowspan="3" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">1046.54</td>
              <td rowspan="1" colspan="1">312.73</td>
              <td rowspan="1" colspan="1">0.89</td>
              <td rowspan="1" colspan="1">313.4</td>
              <td rowspan="1" colspan="1">0.22</td>
              <td rowspan="1" colspan="1">314.2</td>
              <td rowspan="1" colspan="1">0.47</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+2H]<sup>2+</sup></td>
              <td rowspan="1" colspan="1">523.78</td>
              <td rowspan="1" colspan="1">355.88</td>
              <td rowspan="1" colspan="1">0.51</td>
              <td rowspan="1" colspan="1">354.1</td>
              <td rowspan="1" colspan="1">0.49</td>
              <td rowspan="1" colspan="1">354.43</td>
              <td rowspan="1" colspan="1">0.41</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">349.52</td>
              <td rowspan="1" colspan="1">434.70</td>
              <td rowspan="1" colspan="1">0.04</td>
              <td rowspan="1" colspan="1">435.3</td>
              <td rowspan="1" colspan="1">0.14</td>
              <td rowspan="1" colspan="1">435.63</td>
              <td rowspan="1" colspan="1">0.21</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Bradykinin</td>
              <td rowspan="3" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">1060.57</td>
              <td rowspan="1" colspan="1">315.35</td>
              <td rowspan="1" colspan="1">1.10</td>
              <td rowspan="1" colspan="1">312.9</td>
              <td rowspan="1" colspan="1">0.79</td>
              <td rowspan="1" colspan="1">312.97</td>
              <td rowspan="1" colspan="1">0.76</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+2H]<sup>2+</sup></td>
              <td rowspan="1" colspan="1">530.79</td>
              <td rowspan="1" colspan="1">343.14</td>
              <td rowspan="1" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">343.1</td>
              <td rowspan="1" colspan="1">0.02</td>
              <td rowspan="1" colspan="1">343.47</td>
              <td rowspan="1" colspan="1">0.10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">354.20</td>
              <td rowspan="1" colspan="1">449.70</td>
              <td rowspan="1" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">447.7</td>
              <td rowspan="1" colspan="1">0.44</td>
              <td rowspan="1" colspan="1">448.16</td>
              <td rowspan="1" colspan="1">0.34</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Melittin</td>
              <td rowspan="2" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">949.26</td>
              <td rowspan="1" colspan="1">718.65</td>
              <td rowspan="1" colspan="1">0.28</td>
              <td rowspan="1" colspan="1">719.5</td>
              <td rowspan="1" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">720.95</td>
              <td rowspan="1" colspan="1">0.32</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+4H]<sup>4+</sup></td>
              <td rowspan="1" colspan="1">712.20</td>
              <td rowspan="1" colspan="1">756.02</td>
              <td rowspan="1" colspan="1">0.23</td>
              <td rowspan="1" colspan="1">756.4</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">757.08</td>
              <td rowspan="1" colspan="1">0.14</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Neurotensin</td>
              <td rowspan="2" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+2H]<sup>2+</sup></td>
              <td rowspan="1" colspan="1">836.96</td>
              <td rowspan="1" colspan="1">433.72</td>
              <td rowspan="1" colspan="1">0.39</td>
              <td rowspan="1" colspan="1">434.5</td>
              <td rowspan="1" colspan="1">0.18</td>
              <td rowspan="1" colspan="1">434.89</td>
              <td rowspan="1" colspan="1">0.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">558.31</td>
              <td rowspan="1" colspan="1">524.65</td>
              <td rowspan="1" colspan="1">0.26</td>
              <td rowspan="1" colspan="1">525.1</td>
              <td rowspan="1" colspan="1">0.09</td>
              <td rowspan="1" colspan="1">525.54</td>
              <td rowspan="1" colspan="1">0.17</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Renin</td>
              <td rowspan="2" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">586.98</td>
              <td rowspan="1" colspan="1">519.66</td>
              <td rowspan="1" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">519.0</td>
              <td rowspan="1" colspan="1">0.12</td>
              <td rowspan="1" colspan="1">519.58</td>
              <td rowspan="1" colspan="1">0.02</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+4H]<sup>4+</sup></td>
              <td rowspan="1" colspan="1">440.49</td>
              <td rowspan="1" colspan="1">634.50</td>
              <td rowspan="1" colspan="1">0.70</td>
              <td rowspan="1" colspan="1">635.9</td>
              <td rowspan="1" colspan="1">0.21</td>
              <td rowspan="1" colspan="1">636.34</td>
              <td rowspan="1" colspan="1">0.29</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Substance P</td>
              <td rowspan="3" colspan="1">Peptide</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">1347.74</td>
              <td rowspan="1" colspan="1">357.83</td>
              <td rowspan="1" colspan="1">1.11</td>
              <td rowspan="1" colspan="1">359.3</td>
              <td rowspan="1" colspan="1">0.40</td>
              <td rowspan="1" colspan="1">359.66</td>
              <td rowspan="1" colspan="1">0.51</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+2H]<sup>2+</sup></td>
              <td rowspan="1" colspan="1">674.37</td>
              <td rowspan="1" colspan="1">399.02</td>
              <td rowspan="1" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">398.4</td>
              <td rowspan="1" colspan="1">0.16</td>
              <td rowspan="1" colspan="1">398.87</td>
              <td rowspan="1" colspan="1">0.04</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[M+3H]<sup>3+</sup></td>
              <td rowspan="1" colspan="1">449.92</td>
              <td rowspan="1" colspan="1">497.19</td>
              <td rowspan="1" colspan="1">0.20</td>
              <td rowspan="1" colspan="1">496.9</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">497.36</td>
              <td rowspan="1" colspan="1">0.03</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic toggle="yes">Note</italic>: %RSD (Percent relative standard deviation) = 100 × standard deviation/CCS<sub>avg</sub>, In ΔCCS<sub>ref</sub> (%) columns: 100×|AutoCCS CCS - CCS<sub>ref</sub>|/CCS<sub>ref</sub>. <sup>1</sup>CCS<sub>Browser</sub> is obtained from the Agilent MassHunter IM-MS Browser 10.0 with raw .d files. <sup>2</sup>CCS<sub>PNNL</sub> for metabolites is obtained from the PNNL CCS library (<ext-link xlink:href="http://panomics.pnnl.gov/metabolites/" ext-link-type="uri">http://panomics.pnnl.gov/metabolites/</ext-link>) (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab429-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>) and <sup>2</sup>CCS<sub>PNNL</sub> for peptides is obtained from <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> of the interlaboratory evaluation study paper (<xref rid="btab429-B17" ref-type="bibr">Stow <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.3 Single-field DTIMS-MS with RapidFire sample injection</title>
      <p>We then demonstrated CCS calibration for data acquired from real-world metabolomic analyses of plant samples using SPE-IMS-MS with the single-field method and external calibration; stepped-field measurements are not feasible in many cases where analysis time is constrained due to either a front-end separation stage, limited sample amount or acquisition throughput needed.</p>
      <p>All 7106 SPE-IMS-MS runs were processed in two weeks, which includes the computational time for preprocessing, feature finding and AutoCCS calculations, the latter of which required just 15 min on a desktop computer (3.6 GHz Intel Core i7, 16 GB 2400 MHz DDR4, Windows 10). Importantly, AutoCCS automatically assigned the corresponding tune-mix calibrant run based on the ionization mode (positive or negative) and the acquisition time stamp extracted from the raw file metadata information. On the other hand, manual data processing for CCS calibration and feature finding in this massive dataset would take more than a month due to many user interactions required.</p>
      <p>When analyzing this data, we observed that unexpected fluctuations of pressure and temperature occurred during IMS data acquisition (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>) and were sufficiently large to reduce CCS accuracy. Such large variations may happen due to instrumental issues (e.g. a malfunctioning flow controller or rough pump), an improper setting of the flow regime which are difficult to monitor in real time and correct during automated and large-scale studies.</p>
      <p>We found that in cases where these fluctuations occur, the CCS error can be significantly reduced by taking into account the specific temperature and pressure values from each run as shown in <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>. Our enhanced single-field method incorporates the pressure and temperature well-recorded readings from each IMS-MS analysis, into the single-field CCS calibration (<xref rid="btab429-F2" ref-type="fig">Fig. 2</xref>). Using this method, hourly fluctuations of temperature and pressure can be mitigated, beyond the daily fluctuations that are taken into account with the conventional single-field calibration. 7106 RapidFire runs were calibrated using the linear regressor derived from the following and subsequent closest tune-mix run in the acquisition batch. As shown in <xref rid="btab429-F3" ref-type="fig">Figure 3</xref>, for protonated ions of the internal standard rotenone, the proposed enhanced single-field method provided a small variance (194.7 with 0.4% RSD) and almost a single distribution in the calibrated CCS values for rotenone ions despite an irregular distribution of arrival times due to temperature and pressure changes, while the conventional method provided a large variance (195.6 with 1.4% RSD) with the same set of features. This case demonstrates that the enhanced single-field method for DTIMS can correct any fluctuations due to changes in realized pressure and temperature, which could be encountered in real-world applications, and would be a benefit to the research community.</p>
      <fig position="float" id="btab429-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Single-field linear models for 28 tune-mix sample runs in positive electrospray mode using the same instrument as for SPE-IMS-MS analyses, conducted on 26 days from Sep. 2018 to May 2019 (see Section 2). Each dot represents a feature identified as a calibrant ion in Agilent tune-mix sample runs. Each line indicates the linear regressor from each tune-mix sample run. The plots show the impact of the enhanced single-field calibration, taking advantage of pressure and temperature when calibrating using multiple datasets for a set of long-term experiments</p>
        </caption>
        <graphic xlink:href="btab429f2" position="float"/>
      </fig>
      <fig position="float" id="btab429-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Distribution of replicate SPE-IMS-MS measurements by arrival time centroids and calibrated CCS values with conventional and enhanced single-field calibration of the internal standard rotenone [M+H]<sup>+</sup> (<italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> = 395.1489, ±20ppm). This internal standard ion was measured in 7106 runs, conducted on 26 days from September 2018 to May 2019 (see Section 2). The left panel shows three main distributions of arrival times due to parameter fluctuations across the multiple days. The right panel shows calibrated CCS values. Each SPE-IMS-MS run was calibrated using the linear regressor derived from the following and closest tune-mix run in the acquisition batch. With the same set of features, the proposed enhanced single-field method that takes into account the temperature and pressure from each run for regression, provided a small variance (194.7 with 0.4% RSD) and almost a single distribution in the calibrated CCS values for rotenone [M+H]<sup>+</sup>, while the conventional method provided a large variance (195.6 with 1.4% RSD)</p>
        </caption>
        <graphic xlink:href="btab429f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Calibration for SLIM IMS-MS (TAA, He)</title>
      <p>We also conducted experiments to demonstrate the calibration methods for SLIM IMS-MS with measurements of TAA salts using helium as a buffer gas. The reference CCS values of the TAA used as external calibrant ions were obtained by the DTIMS stepped-field method. To compute the SLIM IMS-MS calibration curves, AutoCCS used the reference CCS values and the arrival times of the corresponding features detected by SLIM IMS-MS. The results of the two non-linear regression methods supported are shown in Supplementary Figure S8. High <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> values of each calibration curve for the reference ions were observed for both modes, indicating that the two regression methods worked well and were comparable. Since IM-MS browser does not support non-linear calibration, we could not directly compare the CCS determination between the two software.</p>
      <p>We demonstrated CCS determination for representative metabolites using three IROA standards measured by both DTIMS-MS and SLIM IMS-MS using helium gas. <xref rid="btab429-T3" ref-type="table">Table 3</xref> shows that AutoCCS successfully calculates CCS values from measurements from both platforms. The linearized power regression provided more similar CCS values to DTIMS than the polynomial regression. However, the error for Pterin when using linearized power regression was notably higher at 2.26%. A possible explanation for this larger error could be that the measured arrival time of Pterin was slightly outside of the range of the TAA calibrants, and therefore CCS values calibrated in the extrapolation range would have a larger uncertainty level (<xref rid="btab429-F4" ref-type="fig">Fig. 4</xref>). To improve the calibration, extrapolation uncertainty can be eliminated by measuring other calibrant ions in this range. The evaluation and optimization of different calibrants and experimental conditions is an active area of research for small molecules measured in SLIM systems.</p>
      <fig position="float" id="btab429-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Calibrated results for TAA calibrants (blue dots) and three IROA standards in the linearized power function with 95% confidence interval (light blue). The solid line and dashed line represent the regression lines within the range of TAA data (i.e. interpolation) and outside of the range (extrapolation), respectively.</p>
        </caption>
        <graphic xlink:href="btab429f4" position="float"/>
      </fig>
      <table-wrap position="float" id="btab429-T3">
        <label>Table 3.</label>
        <caption>
          <p>Results of CCS determination using AutoCCS for 3 IROA standards measured in helium gas via the DTIMS-MS and SLIM IMS-MS platforms</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="[" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Compound name</th>
              <th rowspan="1" colspan="1">Target adduct</th>
              <th rowspan="1" colspan="1">Adduct <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic></th>
              <th rowspan="1" colspan="1"><sup>DT</sup>CCS (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>SLIM</sup>CCS<sub>bin</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><sup>SLIM</sup>CCS<sub>power</sub> (Å<sup>2</sup>)</th>
              <th rowspan="1" colspan="1"><inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>bin</sub> (%)</th>
              <th rowspan="1" colspan="1"><inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>CCS<sub>power</sub> (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Adenine</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">136.0624</td>
              <td rowspan="1" colspan="1">58.44</td>
              <td rowspan="1" colspan="1">63.53</td>
              <td rowspan="1" colspan="1">58.51</td>
              <td rowspan="1" colspan="1">8.71</td>
              <td rowspan="1" colspan="1">0.12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><sc>d</sc>-(+)-Trehalose</td>
              <td rowspan="1" colspan="1">[M+Na]<sup>+</sup></td>
              <td rowspan="1" colspan="1">365.1060</td>
              <td rowspan="1" colspan="1">104.90</td>
              <td rowspan="1" colspan="1">102.50</td>
              <td rowspan="1" colspan="1">104.50</td>
              <td rowspan="1" colspan="1">2.29</td>
              <td rowspan="1" colspan="1">0.38</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pterin</td>
              <td rowspan="1" colspan="1">[M+H]<sup>+</sup></td>
              <td rowspan="1" colspan="1">164.0574</td>
              <td rowspan="1" colspan="1">63.85</td>
              <td rowspan="1" colspan="1">65.90</td>
              <td rowspan="1" colspan="1">62.41</td>
              <td rowspan="1" colspan="1">3.21</td>
              <td rowspan="1" colspan="1">2.26</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic toggle="yes">Note</italic>: <sup>DT</sup>CCS and <sup>SLIM</sup>CCS represent the CCS values calculated by AutoCCS from DTIMS and SLIM IMS measurements, respectively. <sup>SLIM</sup>CCS<sub>bin</sub> and <sup>SLIM</sup>CCS<sub>power</sub> indicate the use of the two different regression methods in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref>, a binomial regression and a linearized power regression, respectively. ΔCCS<sub>reg</sub> (%) columns represent the CCS differences between DTIMS-MS and SLIM IMS-MS: 100×|<sup>SLIM</sup>CCS<sub>reg</sub>−<sup>DT</sup>CCS|/<sup>DT</sup>CCS (reg∈{bin, power}).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Limitations</title>
      <p>As demonstrated in various case studies, the current version of AutoCCS can be directly used for CCS determination from experimental data measured in two instruments (Agilent DTIMS and SLIM) and substantially reduce time-consuming and labor-intensive tasks, especially for large-scale experiments. We also demonstrated that AutoCCS can be used with other commercial vendors, e.g. Waters Synapt and Bruker timsTOF. However, for Waters and Bruker data, conversions of the raw data into open format (e.g. mzML) and file formatting for IMS features are required since AutoCCS currently supports only Agilent MassProfiler cef and MZmine ouput csv format as input files.</p>
      <p>Another limitation is that AutoCCS determines the CCS of an ion based on a peak apex or centroid rather than accounting for the width of the arrival time distribution; therefore, CCS distributions driven by ion structural ensembles cannot be characterized. For identifying CCS distributions of analyte ions in a stepped-field experiment, FWHMstep (<xref rid="btab429-B11" ref-type="bibr">Marchand <italic toggle="yes">et al.</italic>, 2017</xref>) can be utilized, which allows to characterize the analyte’s conformational diversity.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>We present an open-source software, AutoCCS, for calculating the CCS of ions detected from various IMS platforms and data acquisition modes such as drift tube (Agilent), traveling wave (Waters Synapt and SLIM) and trapped (Bruker timsTOF) IMS-MS technologies. AutoCCS shows its effectiveness and utility to determine CCS values from various platforms, supporting different instruments, IMS-field methods, buffer gas (e.g. He or N<sub>2</sub>) and most importantly, an automatic workflow that generates reproducible results and is applicable for determining CCS in any omics study.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab429_Supplementary_Data</label>
      <media xlink:href="btab429_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Lucy Woods and Ulrike Schweiger Hufnagel from Bruker Corporation for providing the timsTOF data and features.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Genomic Science Program (GSP), Office of Biological and Environmental Research (BER), U.S. Department of Energy (DOE), and is a contribution of the Metabolic and Spatial Interactions in Communities Scientific Focus Area. Additional support was provided by the National Institutes of Health, National Institute of Environmental Health Sciences [U2CES030170] and National Institute of General Medical Sciences [P41 GM103493-15]. The CASP project was supported by the US Department of Energy Advanced Research Projects Agency—Energy under award number 14/CJ000/09/02. IMS-MS analyses were performed in the Environmental Molecular Sciences Laboratory (EMSL), a national scientific user facility sponsored by BER and located at Pacific Northwest National Laboratory (PNNL). PNNL is operated for DOE by Battelle Memorial Institute under contract DE-AC05-76RL01830. </p>
      <p><italic toggle="yes">Conflict of Interest</italic>: John C. Fjeldsted is employee of Agilent Technologies. All the other authors declare no conflict of interest.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab429-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bilbao</surname><given-names>A.</given-names></string-name></person-group> (<year>2020</year>) PNNL PreProcessor. <ext-link xlink:href="https://omics.pnl.gov/software/pnnl-preprocessor" ext-link-type="uri">https://omics.pnl.gov/software/pnnl-preprocessor</ext-link> (20 December 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btab429-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bush</surname><given-names>M.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Ion mobility mass spectrometry of peptide ions: effects of drift gas and calibration strategies</article-title>. <source>Anal. Chem</source>., <volume>84</volume>, <fpage>7124</fpage>–<lpage>7130</lpage>.<pub-id pub-id-type="pmid">22845859</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Serpentine Ultralong Path with Extended Routing (SUPER) high resolution traveling wave ion mobility-MS using structures for lossless ion manipulations</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>4628</fpage>–<lpage>4634</lpage>.<pub-id pub-id-type="pmid">28332832</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabelica</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Recommendations for reporting ion mobility Mass Spectrometry measurements</article-title>. <source>Mass Spectrom. Rev</source>., <volume>38</volume>, <fpage>291</fpage>–<lpage>320</lpage>.<pub-id pub-id-type="pmid">30707468</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ibrahim</surname><given-names>Y.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Development of a new ion mobility time-of-flight mass spectrometer</article-title>. <source>Int. J. Mass Spectrom</source>., <volume>377</volume>, <fpage>655</fpage>–<lpage>662</lpage>.<pub-id pub-id-type="pmid">26185483</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ibrahim</surname><given-names>Y.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>New frontiers for mass spectrometry based upon structures for lossless ion manipulations</article-title>. <source>Analyst</source>, <volume>142</volume>, <fpage>1010</fpage>–<lpage>1021</lpage>.<pub-id pub-id-type="pmid">28262893</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kessner</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>2534</fpage>–<lpage>2536</lpage>.<pub-id pub-id-type="pmid">18606607</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurulugama</surname><given-names>R.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Evaluation of drift gas selection in complex sample analyses using a high performance drift tube ion mobility-QTOF mass spectrometer</article-title>. <source>Analyst</source>, <volume>140</volume>, <fpage>6834</fpage>–<lpage>6844</lpage>.<pub-id pub-id-type="pmid">26178817</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lanucara</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>The power of ion mobility-mass spectrometry for structural characterization and the study of conformational dynamics</article-title>. <source>Nat. Chem</source>., <volume>6</volume>, <fpage>281</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">24651194</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>PIXiE: an algorithm for automated ion mobility arrival time extraction and collision cross section calculation using global data association</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2715</fpage>–<lpage>2722</lpage>.<pub-id pub-id-type="pmid">28505286</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marchand</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Drift tube ion mobility: how to reconstruct collision cross section distributions from arrival time distributions?</article-title>  <source>Anal. Chem</source>., <volume>89</volume>, <fpage>12674</fpage>–<lpage>12681</lpage>.<pub-id pub-id-type="pmid">29131943</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orton</surname><given-names>D.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A customizable flow injection system for automated, high throughput, and time sensitive ion mobility spectrometry and mass spectrometry measurements</article-title>. <source>Anal. Chem</source>., <volume>90</volume>, <fpage>737</fpage>–<lpage>744</lpage>.<pub-id pub-id-type="pmid">29161511</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Picache</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Collision cross section compendium to annotate and predict multi-omic compound identities</article-title>. <source>Chem. Sci</source>., <volume>10</volume>, <fpage>983</fpage>–<lpage>993</lpage>.<pub-id pub-id-type="pmid">30774892</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pluskal</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>395</fpage>.<pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Revercomb</surname><given-names>H.E.</given-names></string-name>, <string-name><surname>Mason</surname><given-names>E.A.</given-names></string-name></person-group> (<year>1975</year>) <article-title>Theory of plasma chromatography/gaseous electrophoresis</article-title>. <source>Rev. Anal. Chem</source>., <volume>47</volume>, <fpage>970</fpage>–<lpage>983</lpage>.</mixed-citation>
    </ref>
    <ref id="btab429-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruotolo</surname><given-names>B.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Ion mobility-mass spectrometry analysis of large protein complexes</article-title>. <source>Nat. Protoc</source>., <volume>3</volume>, <fpage>1139</fpage>–<lpage>1152</lpage>.<pub-id pub-id-type="pmid">18600219</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stow</surname><given-names>S.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>An interlaboratory evaluation of drift tube ion mobility–mass spectrometry collision cross section measurements</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>9048</fpage>–<lpage>9055</lpage>.<pub-id pub-id-type="pmid">28763190</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wojcik</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>SLIM ultrahigh resolution ion mobility spectrometry separations of isotopologues and isotopomers reveal mobility shifts due to mass distribution changes</article-title>. <source>Anal. Chem</source>., <volume>91</volume>, <fpage>11952</fpage>–<lpage>11962</lpage>.<pub-id pub-id-type="pmid">31450886</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>SPE-IMS-MS: an automated platform for sub-sixty second surveillance of endogenous metabolites and xenobiotics in biofluids</article-title>. <source>Clin. Mass Spectrom</source>., <volume>2</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">29276770</pub-id></mixed-citation>
    </ref>
    <ref id="btab429-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>A structural examination and collision cross section database for over 500 metabolites and xenobiotics using drift tube ion mobility spectrometry</article-title>. <source>Chem. Sci</source>., <volume>8</volume>, <fpage>7724</fpage>–<lpage>7736</lpage>.<pub-id pub-id-type="pmid">29568436</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
