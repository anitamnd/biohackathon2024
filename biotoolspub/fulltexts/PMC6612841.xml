<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612841</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz323</article-id>
    <article-id pub-id-type="publisher-id">btz323</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Macromolecular Sequence, Structure, and Function</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A joint method for marker-free alignment of tilt series in electron tomography</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Renmin</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bao</surname>
          <given-names>Zhipeng</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zeng</surname>
          <given-names>Xiangrui</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niu</surname>
          <given-names>Tongxin</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Fa</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Min</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff3">3</xref>
        <xref ref-type="corresp" rid="btz323-cor1"/>
        <!--<email>mxu1@cs.cmu.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Xin</given-names>
        </name>
        <xref ref-type="aff" rid="btz323-aff1">1</xref>
        <xref ref-type="corresp" rid="btz323-cor1"/>
        <!--<email>xin.gao@kaust.edu.sa</email>-->
      </contrib>
    </contrib-group>
    <aff id="btz323-aff1"><label>1</label>Computer, Electrical and Mathematical Sciences and Engineering (CEMSE) Division, Computational Bioscience Research Center (CBRC), King Abdullah University of Science and Technology (KAUST), Thuwal, Saudi Arabia</aff>
    <aff id="btz323-aff2"><label>2</label>Department of Electronic Engineering, Tsinghua University, Beijing, China</aff>
    <aff id="btz323-aff3"><label>3</label>Computational Biology Department, School of Computer Science, Carnegie Mellon University, Pittsburgh, PA, USA</aff>
    <aff id="btz323-aff4"><label>4</label>National Laboratory of Biomacromolecules, Institute of Biophysics, Chinese Academy of Sciences, Beijing, China</aff>
    <aff id="btz323-aff5"><label>5</label>High Performance Computer Research Center, Chinese Academy of Sciences, Beijing, China</aff>
    <author-notes>
      <corresp id="btz323-cor1">To whom correspondence should be addressed. <email>mxu1@cs.cmu.edu</email> or <email>xin.gao@kaust.edu.sa</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i249</fpage>
    <lpage>i259</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz323.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Electron tomography (ET) is a widely used technology for 3D macro-molecular structure reconstruction. To obtain a satisfiable tomogram reconstruction, several key processes are involved, one of which is the calibration of projection parameters of the tilt series. Although fiducial marker-based alignment for tilt series has been well studied, marker-free alignment remains a challenge, which requires identifying and tracking the identical objects (landmarks) through different projections. However, the tracking of these landmarks is usually affected by the pixel density (intensity) change caused by the geometry difference in different views. The tracked landmarks will be used to determine the projection parameters. Meanwhile, different projection parameters will also affect the localization of landmarks. Currently, there is no alignment method that takes interrelationship between the projection parameters and the landmarks.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we propose a novel, joint method for marker-free alignment of tilt series in ET, by utilizing the information underlying the interrelationship between the projection model and the landmarks. The proposed method is the first joint solution that combines the extrinsic (track-based) alignment and the intrinsic (intensity-based) alignment, in which the localization of landmarks and projection parameters keep refining each other until convergence. This iterative approach makes our solution robust to different initial parameters and extreme geometric changes, which ensures a better reconstruction for marker-free ET. Comprehensive experimental results on three real datasets show that our new method achieved a significant improvement in alignment accuracy and reconstruction quality, compared to the state-of-the-art methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The main program is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/icthrm/joint-marker-free-alignment">https://github.com/icthrm/joint-marker-free-alignment</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">King Abdullah University of Science and Technology</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004052</named-content>
        </funding-source>
        <award-id>FCC/1/1976-04</award-id>
        <award-id>URF/1/2601-01</award-id>
        <award-id>URF/1/3007-01</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">U.S. National Institutes of Health</named-content>
        </funding-source>
        <award-id>P41 GM103712</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Carnegie Mellon University's Center for Machine Learning and Health</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Electron tomography (ET) is an important technology for structural biology and offers 3D imaging of cellular ultrastructure. The ultrastructure can be solved from a tilt series of micrographs (projections) taken with different tilt angles (<xref rid="btz323-B8" ref-type="bibr">Fernández, 2012</xref>; <xref rid="btz323-B10" ref-type="bibr">Frank, 2006</xref>; <xref rid="btz323-B24" ref-type="bibr">Lučić <italic>et al.</italic>, 2013</xref>). The fundamental principle of obtaining high-quality 3D density maps is to keep the consistency between the 3D model and the 2D projections. However, the instability of the instrument and the deformation of the sample introduce uncertainty in the projections. Before reconstruction, an accurate refinement of projection parameters is required to compensate for the transformation and deformation of the tilt series.</p>
    <p>According to the availability of fiducial markers in a sample, alignment methods can be classified into two main types: marker-based alignment and marker-free alignment. Fiducial marker-based alignment is currently the most widely used alignment method (<xref rid="btz323-B14" ref-type="bibr">Han <italic>et al.</italic>, 2015</xref>, <xref rid="btz323-B16" ref-type="bibr">2018</xref>; <xref rid="btz323-B18" ref-type="bibr">Kremer <italic>et al.</italic>, 1996</xref>; <xref rid="btz323-B20" ref-type="bibr">Lawrence, 1992</xref>). It is also called the extrinsic method, which requires fiducial markers to be embedded in the sample (<xref rid="btz323-B25" ref-type="bibr">Markelj <italic>et al.</italic>, 2012</xref>). However, not all the samples can be embedded with fiducial markers, and undesirable artifacts may occur due to the interference of the colloidal gold in the sample (<xref rid="btz323-B11" ref-type="bibr">Frank <italic>et al.</italic>, 1987</xref>). Marker-free alignment does not require fiducial markers and can be divided into two categories: correlation methods and feature-based methods. Correlation methods, such as cross-correlation (<xref rid="btz323-B12" ref-type="bibr">Guckenberger, 1982</xref>) and common lines (<xref rid="btz323-B22" ref-type="bibr">Liu <italic>et al.</italic>, 1995</xref>), provide coarse alignment to calculate large translation and in-plane rotation. The iterative cross-correlation alignment (<xref rid="btz323-B32" ref-type="bibr">Winkler and Taylor, 2006</xref>, <xref rid="btz323-B33" ref-type="bibr">2013</xref>) with parameter-based stretching produces better results but is sensitive to the choice of initialization, pitch angle change and large sample thickness. Feature-based (virtual track-based) methods utilize the image features as virtual markers and align images in a workflow similar to the marker-based alignment (<xref rid="btz323-B3" ref-type="bibr">Brandt and Ziese, 2006</xref>; <xref rid="btz323-B4" ref-type="bibr">Brandt <italic>et al.</italic>, 2001</xref>; <xref rid="btz323-B6" ref-type="bibr">Castaño-Díez <italic>et al.</italic>, 2007</xref>, <xref rid="btz323-B7" ref-type="bibr">2010</xref>; <xref rid="btz323-B13" ref-type="bibr">Han <italic>et al.</italic>, 2014</xref>; <xref rid="btz323-B26" ref-type="bibr">Phan <italic>et al.</italic>, 2009</xref>; <xref rid="btz323-B29" ref-type="bibr">Sorzano <italic>et al.</italic>, 2009</xref>). However, the extracted features may not be stable enough to cover the entire tilt series, due to the change of the tilt angle and the impact of noise. Another type of parameter refinement is the maximum-likelihood estimation based on reconstruction–reprojection procedure, where the relationship (intensity) between the 3D volume and 2D projection is considered and iteratively refined. Such a solution is also called the intrinsic method, which has been widely used in computed tomography (CT) and single particle analysis (SPA) (<xref rid="btz323-B25" ref-type="bibr">Markelj <italic>et al.</italic>, 2012</xref>; <xref rid="btz323-B28" ref-type="bibr">Scheres, 2010</xref>; <xref rid="btz323-B30" ref-type="bibr">Tang <italic>et al.</italic>, 2007</xref>).</p>
    <p>The key problem in marker-free alignment is to identify and track the identical objects (landmarks) in different projections, by either cross-correlation or features. In feature-based methods, different features (<xref rid="btz323-B4" ref-type="bibr">Brandt <italic>et al.</italic>, 2001</xref>; <xref rid="btz323-B13" ref-type="bibr">Han <italic>et al.</italic>, 2014</xref>; <xref rid="btz323-B29" ref-type="bibr">Sorzano <italic>et al.</italic>, 2009</xref>) have been used to compensate for the projection parameter change of the views, by organizing a set of identical descriptors. However, when the tilt angle increases, most features either vanish or become difficult to track. In addition, the 2D features do not necessarily correspond to a 3D ultrastructure. Cross-correlation methods may use large image areas to keep tracking candidate ultrastructures. Because its comparison is view-to-view, the methods are sensitive to the pixel intensity change caused by different sample geometry, resulting in a low localization accuracy. In either method, tracked landmarks are used to determine the projection parameters. Meanwhile, different prior information of the projection parameters will affect the localization of the landmarks. Until now, to our knowledge, there is no alignment method that takes the interrelationship between projection parameters and landmarks into consideration.</p>
    <p>In this article, we propose a novel, joint solution by explicitly considering the interrelationship between projection parameters and landmarks, to achieve a robust and accurate marker-free alignment of tilt series. Our solution consists of the following steps: (i) automatic calculation of the view-to-view relationship of the tilt series, (ii) selection and tracking of landmarks along the tilt series, (iii) iterative refinement of the landmark locations based on a reconstruction–reprojection scheme and (iv) projection parameter calibration based on the landmark tracks. In our solution, the projection parameters are refined by the localization of a set of virtual tracks, and the locations of the landmarks are re-estimated when refined projection parameters are obtained. This process is implemented by reconstructing the local ultrastructure of the landmarks and analyzing the difference between the ultrastructure’s reprojections and the original micrographs. Step (iii) and (iv) will be iteratively updated in an alternate manner until convergence.</p>
    <p>Consequently, the proposed method is a joint solution that combines the extrinsic (track-based) alignment and the intrinsic (intensity-based) alignment. We use landmarks as fiducial markers (extrinsic information) while refining their localization based on their intensity information (intrinsic information) in a similar way as single particle analysis. Because the extrinsic alignment is robust to different initial parameters and the utility of intensity information in intrinsic alignment is able to compensate the localization accuracy loss of the landmarks, the joint method ensures a better reconstruction for marker-free ET.</p>
    <p>The proposed method was compared with the state-of-the-art methods including IMOD and AuTom on three real datasets. Results demonstrate that our joint method significantly improves the alignment accuracy and reconstruction quality over the existing methods.</p>
  </sec>
  <sec>
    <title>2 Preliminaries</title>
    <sec>
      <title>2.1 Local consistency of the projections</title>
      <sec>
        <label>2.1.1</label>
        <title>Basic concept</title>
        <p>Generally, the projection process in ET follows an orthogonal projection model, which is described as follows (conventionally, we denote vectors or matrices by bold symbols and denote a 2D point by 2 × 1 vector):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>v</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Z</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a coordinate representing a spatial point located in the ultrastructure; <italic>α</italic> represents the pitch angle along the tilt axis; <italic>β</italic> represents the tilt angle; <italic>γ</italic> represents the in-plane rotation within the projection plane; <italic>s</italic> represents the scale change of the view; <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> represents the translation of the view; <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is the measured projection point and <bold><italic>P</italic></bold> denotes the orthogonal projection matrix. The detailed <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>, <bold><italic>P</italic></bold> and <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> are defined as follows:
<disp-formula id="E2"><mml:math id="M2"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p>Given a tilt series, if the corresponding relationship is configured, a projection model can be fitted to minimize the deviation between the measured value and estimated one (parameters). In most cases, the origin of the reconstructed 3D density map is chosen to be directly above the center of the projection (micrograph) of <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle. However, a derivation from <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> claims that the optimal projection model is not unique.</p>
        <p>By substituting <bold><italic>P</italic></bold>, <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> into <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>, the equation can be rewritten as follows:
<disp-formula id="E3"><label>(2)</label><mml:math id="M3"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>v</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>Implicitly, the origin <italic>O</italic> of the spatial coordinate locates at <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and it produces the center point on a projection with any tilt angle if the translation <bold><italic>t</italic></bold> is set to <bold>0</bold>. If we would like to relocate the origin <italic>O</italic> inside the sample, for example, with a shift of <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> along <italic>z</italic>-axis, the projection model will be reformed as:
<disp-formula id="E4"><label>(3)</label><mml:math id="M4"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>v</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>Z</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>Compared with <xref ref-type="disp-formula" rid="E3">Equation (2)</xref>, a shift <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> will be added to the translation <bold><italic>t</italic></bold> to compensate for the re-centering of the spatial coordinate. Here, though the projection parameters have been changed, the consistency of projection-slice theorem between the spatial ultrastructure and its projections holds. Similarly, a <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> may also be applied to a projection system.</p>
        <p>
          <statement id="mthst1">
            <p><sc>Lemma</sc>. If a set of suitable translations applied to the projections (micrographs) is given, the spatial coordinate <italic>O</italic> could be relocated at any position without the destruction of the consistency of projection-slice theorem between the spatial ultrastructure and its projections.</p>
            <p><sc>Proof</sc>. If the original point of spatial coordinate <italic>O</italic> is translated from (0, 0, 0) to <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, the projection model will be reformed as:
<disp-formula id="E5"><label>(4)</label><mml:math id="M5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>v</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Z</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Z</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
            <p>Now set
<disp-formula id="E6"><label>(5)</label><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a constant and <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> are fixed for a certain projection. By substituting <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> to <xref ref-type="disp-formula" rid="E5">Equation (4)</xref>, we can find that the equation is reduced to <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>. Therefore, for a tilt series, the system could be relocated to <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> with such a translation <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> applied to any projection.</p>
          </statement>
        </p>
      </sec>
      <sec>
        <label>2.1.2</label>
        <title>Local refined landmark within a local tilt series</title>
        <p>The conclusion above is simple but important. <xref ref-type="fig" rid="btz323-F1">Figure 1</xref> demonstrates such an example.
</p>
        <fig id="btz323-F1" orientation="portrait" position="float">
          <label>Fig. 1.</label>
          <caption>
            <p>An example of recentering of a tilt series, in which the local patches around <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> of the projections recompose a new tilt series</p>
          </caption>
          <graphic xlink:href="btz323f1"/>
        </fig>
        <p>In <xref ref-type="fig" rid="btz323-F1">Figure 1</xref>, we assume that the projection parameters for the projections in the tilt series are already known. Therefore, for a 3D spatial point in the spatial coordinate, its 2D reprojection can be easily calculated (i.e. <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>). If we select the local patches around <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> of the projections, these local patches would recompose a new tilt series. With a suitable size of the local patch, such a local tilt series always retain the consistency of projection-slice theorem between the projections and the 3D ultrastructure. On the contrary, if the corresponding relationship of the local patches is known within an unaligned tilt series, we could try to recompose these local patches into a tilt series with projection parameters consistent with the spatial object. And the centers of these local patches can be used to produce the landmarks for the entire tilt series alignment. Here, we call these center points the <italic>reprojection–invariant landmarks</italic>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <p><xref ref-type="fig" rid="btz323-F2">Figure 2</xref> shows the overall workflow of our joint method for marker-free alignment. The workflow mainly contains four steps, in which our solution tries to reveal the corresponding relationship of the projection system from 2D to 3D. The first step is the calculation of the view-to-view relationship between two consecutive images along the tilt series. In this step, a coarse affine transformation mapping one image to another is calculated. The second step is the selection and tracking of the candidate landmarks. In this step, a set of landmarks with stable structures or randomly selected coordinates are localized along the tilt series based on the view-to-view transformation matrix. The third step is the extraction of local patches, the composition of local tilt series, the refinement of local projection parameters and the reproduction of these patches’ centers (i.e. reprojection–invariant landmarks). In this step, the landmarks that are coarsely selected from the view-to-view relationship will be refined and reproduced, according to the current configuration of the projection model. In the fourth step, a new projection model will be calculated with the virtual tracks composed by the reprojection–invariant landmarks. If the system converges, the refined projection model will be outputted. Otherwise, the procedure will return to the third step. In this section, the detailed implementation of our workflow will be introduced in the following context.
</p>
    <fig id="btz323-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>The workflow of our joint method for marker-free alignment</p>
      </caption>
      <graphic xlink:href="btz323f2"/>
    </fig>
    <sec>
      <title>3.1 Calculation of view-to-view relationship</title>
      <p>For marker-free alignment, to obtain accurate landmarks that reflect the geometric change of the projection system is very important. However, this problem has not been solved, in which the main obstacle is that a point of interest on a projection does not necessarily correspond to a specific point on the spatial ultrastructure. In addition, the link of the key feature points between projections is not tight: the points of interest often vanish during the tilt angle changing. In our joint solution, we will not try to find such landmarks in a one-pass optimization, but try to find the coarse positions first and then refine them iteratively in the subsequent processes.</p>
      <sec>
        <label>3.1.1</label>
        <title>Affine constraint of two images</title>
        <p>According to the most recent theoretical results (<xref rid="btz323-B16" ref-type="bibr">Han <italic>et al.</italic>, 2018</xref>), the landmarks upon two projections of a tilt series approximately follow an affine relationship within a very small deviation. In particular, given a set of coordinate <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> belonging to the <italic>j</italic>th projection and its corresponding set <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> belonging to the <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>th projection, we can always find such a transformation <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:math></inline-formula>, where <bold><italic>A</italic></bold> is a 2 × 2 matrix and <bold><italic>t</italic></bold> is the translation), to make <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mo>‖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>‖</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula> for any <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>ϵ</italic> is a very small number.</p>
        <p>On the contrary, if the affine constraint between two projections has been revealed, we can find all corresponding coordinate pairs between the two projections.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Affine matrix calculation based on matched features</title>
        <p>Though the direct use of image features will produce short virtual tracks (<xref rid="btz323-B4" ref-type="bibr">Brandt <italic>et al.</italic>, 2001</xref>; <xref rid="btz323-B13" ref-type="bibr">Han <italic>et al.</italic>, 2014</xref>; <xref rid="btz323-B29" ref-type="bibr">Sorzano <italic>et al.</italic>, 2009</xref>), the feature technique is very suitable for the discovery of view-to-view relationship (<xref rid="btz323-B27" ref-type="bibr">Saalfeld <italic>et al.</italic>, 2010</xref>). In our default implementation, the scale-invariant feature transform (SIFT) (<xref rid="btz323-B23" ref-type="bibr">Lowe, 2004</xref>) is used to recover robust ultrastructure and produce corresponding coordinates between two consecutive views.</p>
        <p><bold>Feature extraction and matching with SIFT:</bold> As a descriptor, SIFT contains the key point of the interesting structure and the descriptor to code the information around the key point. SIFT is able to localize the stable points in the space of difference-of-Gaussian (DoG) pyramid as key point and organize the neighborhood information around the key point into a 128 dimensional descriptor that redundantly contains the neighboring gradient and magnification information.</p>
        <p>Given the 128 dimensional descriptor, view-to-view correspondence points can be identified by a kd-tree searching (<xref rid="btz323-B2" ref-type="bibr">Bentley, 1975</xref>) with local window constraint. Here, a threshold of 0.7 for ET images is set as the significance for the Euclidean distance measurement. The left part of <xref ref-type="fig" rid="btz323-F3">Figure 3</xref> demonstrates a matching result with different projections.
</p>
        <fig id="btz323-F3" orientation="portrait" position="float">
          <label>Fig. 3.</label>
          <caption>
            <p>A demonstration from the view-to-view relationship to a set of candidate landmarks. The left part is the matching result between two consecutive projections and the right part is the tracked candidate landmarks</p>
          </caption>
          <graphic xlink:href="btz323f3"/>
        </fig>
        <p><bold>Robust estimation of the affine matrix:</bold> As introduced in the beginning, the view-to-view relationship can be estimated from the matched correspondence of points of interest. However, the descriptor matching results still contain a lot of spurious correspondences. Here, we propose a random sample consensus (RANSAC) (<xref rid="btz323-B9" ref-type="bibr">Fischler and Bolles, 1981</xref>) algorithm to robustly estimate the affine matrix of two views.</p>
        <p>
          <boxed-text position="float" orientation="portrait">
            <label>Algorithm 1:</label>
            <caption>
              <p>Robust estimation of view-to-view relationship</p>
            </caption>
            <p>
              <inline-graphic xlink:href="btz323ilf1.jpg"/>
            </p>
          </boxed-text>
        </p>
        <p>Algorithm 1 elaborates the details of robust transformation matrix estimation, which requires the correspondence of <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula>, and a distance threshold <italic>d</italic> as input and outputs the transformation <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<list list-type="order"><list-item><p>From the <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula>, select random sets of correspondences <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>), and calculate the transformation <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> between these correspondences.</p></list-item><list-item><p>Find the correspondences from <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> whose model error is less than <italic>d</italic> under <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, record the result as <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>If the cardinality of <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">}</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is larger than the current maximal record <italic>M</italic><sub>max</sub>, save the current value and refresh the termination condition <italic>I</italic>.</p></list-item><list-item><p>Repeat Steps 1∼3 until termination, finally return <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> from <italic>M</italic><sub>max</sub>.</p></list-item></list></p>
        <p>Here, we refresh the maximum iteration count according to <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi><mml:mi>K</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>p</italic><sub>s</sub> is the required success rate, <italic>p</italic><sub>g</sub> is the minimum percentage of inliers and <italic>K</italic> is the minimum sampling number of the dataset (<italic>K </italic>=<italic> </italic>3). The distance threshold <italic>d</italic> is set to <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mo>Δ</mml:mo><mml:mo>β</mml:mo><mml:mo>·</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<xref rid="btz323-B16" ref-type="bibr">Han <italic>et al.</italic>, 2018</xref>), where <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:math></inline-formula> is the tilt angle difference between the two projections and <italic>T</italic> is an estimated sample thickness.</p>
        <p>The initial affine matrix carries two pieces of useful information: (i) an initial estimation of the center of each projection and (ii) the related in-plane rotation between two consecutive views. With the use of such information, the initial projection model is able to be estimated.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Selection and tracking of the landmarks</title>
      <p>Once the view-to-view relationship is obtained, the common structures among all the tilt series would be easy to track. Here, we generate the track of landmarks with the following steps:
<list list-type="order"><list-item><p>Select a set of candidate landmarks from the projection of the <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle.</p></list-item><list-item><p>Propagate the landmarks to the consecutive views, based on the solved affine transformation model.</p></list-item><list-item><p>Correspond the landmarks from the projection of the low tilt angle to the high tilt angle until all the projections have been visited.</p></list-item></list></p>
      <p>By default, we use a uniform sampling to select the landmarks. However, the results from any other landmark selection methods can be used here.</p>
      <p><xref ref-type="fig" rid="btz323-F3">Figure 3</xref> presents a tracking example, where the left part is the matching result between two consecutive projections and the right part is the tracked candidate landmarks. Projections of <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>49</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angles are selected for demonstration. The matched points of interest are linked by the green lines across two views and the tracked candidate landmarks are marked by the green crosses. Obviously, the projections of the ultrastructures have changed a lot from the low tilt angle to the high one. Although we can find a large number of matched correspondences between the two consecutive projections, it is difficult to find a set of completely traceable features that correspond to each other from the image of the low tilt angle to the one of the high tilt angle. However, with the help of the view-to-view relationship (affine relationship) solved from the correspondence of points of interest, the landmark locations in the view of <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> can be calculated from the ones in the view of <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. Generally, according to our tracking steps, the landmark locations in the <italic>i</italic>-th view can be calculated from the ones of the <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>-th view based on the solved affine relationship. As shown in the right part of <xref ref-type="fig" rid="btz323-F3">Figure 3</xref>, we successfully made such a complete tracking, and the positions of landmarks in the high tilt angle views (e.g. the view of <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) further reflect the affine relationship between the high tilt angle views and the view of <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle.</p>
    </sec>
    <sec>
      <title>3.3 Refinement of the landmarks with local patches</title>
      <p>The tracking of landmarks based on the affine transformation of two views cannot directly reflect the true projection model because it is limited by the loss of information along the <italic>z</italic>-axis. A further refinement is required. With the tracking of local ultrastructures, a tilt series with local patches can be reformed and refined. Multiple numbers of local patch’s tilt series comprise the possibility of multiple correspondences of reprojection–invariant landmarks and the consequent global refinement of the projection model.</p>
      <sec>
        <label>3.3.1</label>
        <title>Local patch refinement</title>
        <p>Assume in previous object tracking, the interested local ultrastructure has a localization in projection 1 as (<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>), a localization in projection 2 as (<italic>x</italic><sub>2</sub>, <italic>y</italic><sub>2</sub>) and so on [(<italic>x<sub>n</sub></italic>, <italic>y<sub>n</sub></italic>) in projection <italic>n</italic>]. Sufficiently large patches (e.g. <italic>W </italic>×<italic> W</italic> patch size with <italic>W</italic> larger than the thickness of the samples) can be used to include the local ultrastructure of interest and form a tilt series of the certain local patches (<xref ref-type="fig" rid="btz323-F1">Fig. 1</xref>). For each tilt series of local patches, we try to refine its projection parameters based on the pixel density (to simplify the calculation, we only focus on the in-plane rotation <italic>γ</italic>, pitch angle <italic>α</italic> and image translation <bold><italic>t</italic></bold>).</p>
        <p><bold>Initialization:</bold> The local patch refinement is within the extrinsic refinement based on landmark tracks (as shown in <xref ref-type="fig" rid="btz323-F2">Fig. 2</xref>). The values of image scale <italic>s</italic> and tilt angle <italic>β</italic> are assumed to be accurate in local patch refinement. If it is not the first turn’s local patch refinement, all the initial parameters are inherited from the previous bundle adjustment. If it is the first turn’s local patch refinement, we will set image scale <italic>s</italic> to 1, tilt angle <italic>β</italic> to the value read from the goniometer. The shift <bold><italic>t</italic></bold> is set to <bold>0</bold> (the global <bold><italic>t</italic></bold> is an integrated value of the invariant point <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of different views that makes <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:math></inline-formula>); the pitch angle <italic>α</italic> and in-plane <italic>γ</italic> are set according to the decomposition of <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">RS</mml:mi></mml:mrow></mml:math></inline-formula>, where <bold><italic>R</italic></bold> is the rotation matrix and <bold><italic>S</italic></bold> is the shear matrix (here, <bold><italic>A</italic></bold> and <bold><italic>t</italic></bold> are from the view-to-view relationship <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>).</p>
        <p><bold>Intrinsic alignment:</bold> The consequent projection parameter refinement is similar to the process in single particle analysis (<xref rid="btz323-B28" ref-type="bibr">Scheres, 2010</xref>). However, we do not need an exhaustive search, because we already have an accurate guess of the initial parameters based on the extrinsic refinement.</p>
        <p>Step 1) With the initial parameters, a coarse alignment based on the cross-correlation of stretched images is carried out to compensate for large translation, following the principle proposed by <xref rid="btz323-B32" ref-type="bibr">Winkler and Taylor (2006)</xref>. First of all, a reference is selected from the original extracted local patches, which is often the projection (micrograph) with <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle. Then the parameters of the adjacent projections will be solved to fit the reference. After the initialization, the consequent reference will not be a projection selected from the tilt series, but a specialized reprojection from the already aligned projections. The process will continue with each time a projection selected and calibrated into the aligned projections. Such process continues until all the micrographs are configured.</p>
        <p>Step 2) Next we try to solve the following optimization for the entire system (<xref rid="btz323-B19" ref-type="bibr">Kyme <italic>et al.</italic>, 2003</xref>; <xref rid="btz323-B34" ref-type="bibr">Yang and Penczek, 2008</xref>):
<disp-formula id="E7"><label>(6)</label><mml:math id="M7"><mml:mrow><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>I<sub>j</sub></italic> is the <italic>j</italic>th 2D image (projection), (<italic>u<sub>x</sub></italic>, <italic>u<sub>y</sub></italic>) is the pixel of <italic>I<sub>j</sub></italic> located in (<italic>x</italic>, <italic>y</italic>), <italic>D</italic> is a selected center area of projection, <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>γ</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is a rotation operation applied on an image with <italic>γ</italic>, <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is a translation operation applied on the image with <bold><italic>t</italic></bold>, <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is a projection operation that projects a 3D object to a 2D plane, and <italic>V</italic> is a 3D object reconstructed from <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>
          <boxed-text position="float" orientation="portrait">
            <label>Algorithm 2:</label>
            <caption>
              <p>Refine the parameters of local patches</p>
            </caption>
            <p>
              <inline-graphic xlink:href="btz323ilf2.jpg"/>
            </p>
          </boxed-text>
        </p>
        <p>First, we reconstruct the object <italic>V</italic> based on the projections and their current parameters. Then, we optimize the pitch angle, in-plane rotation and translation for each projection one by one. Because the cross-correlation of stretched images can produce a result within a few pixel deviations, For a projection, we will first search the pitch angle in a grid way within a small interval (<xref rid="btz323-B35" ref-type="bibr">Zampighi <italic>et al.</italic>, 2005</xref>), and then get a suitable optimized value of translation and in-plane rotation. Then, we further refine the parameters based on a gradient descent optimization. We iterate the refinement of projection parameters and the reconstruction of 3D volume until the residual in <xref ref-type="disp-formula" rid="E7">Equation (6)</xref> converges. Algorithm 2 gives a detailed description of the process.</p>
      </sec>
      <sec>
        <label>3.3.2</label>
        <title>Production of reprojection–invariant landmarks</title>
        <p>Once the projection parameters for the local tilt series have been solved, it is very easy to find the new center (i.e. the projection point of <italic>O</italic>) of each local patches in the projection system. Because the local patches closely represent their corresponding 3D ultrastructure, the original point of the local 3D projection system will locate inside the ultrastructure. Consequently, the projections of the original point in the 3D projection system reflect the position change of the interested ultrastructure under different tilt angles. According to the proof in Section 2.1, for a tilt series of local patches, its <italic>j</italic>th projection’s center point is <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. By substituting the <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> back to the location of each extracted local patch, we could obtain the refined localization of the interested ultrastructure in the original tilt series, as shown in <xref ref-type="fig" rid="btz323-F4">Figure 4</xref>. Compared with the location of landmarks extracted from the view-to-view relationship, here, we thus call these landmarks ‘the reprojection–invariant landmark’.
</p>
        <fig id="btz323-F4" orientation="portrait" position="float">
          <label>Fig. 4.</label>
          <caption>
            <p>The relocation of the refined original points from local patches to the entire tilt series</p>
          </caption>
          <graphic xlink:href="btz323f4"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.4 Projection parameter optimization</title>
      <sec>
        <label>3.4.1</label>
        <title>Bundle adjustment with virtual tracks</title>
        <p>With enough tracks of reprojection–invariant landmarks, it is not difficult to discover the global projection parameters. Given a tilt series with <italic>N</italic> projections, for the <italic>i</italic>th projection, its projection parameters can be estimated from the optimization of the following L-2 norm objective function:
<disp-formula id="E8"><label>(7)</label><mml:math id="M8"><mml:mrow><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Proj</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> is the spatial points that define the spatial geometry of the sample, <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Proj</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is the operation of the orthogonal projection defined in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> for the <italic>j</italic>th micrograph (mapping <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>), and <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the reproduced reprojection–invariant landmarks.</p>
        <p>In the extrinsic alignment, all the parameters defined in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> are supposed to be refined. Because both the projection parameters and the spatial points are unknown, it is a non-linear optimization for solving the projection parameters. Considering the sparsity of the reprojection landmarks in the entire system, the sparse bundle adjustment (SBA) (<xref rid="btz323-B31" ref-type="bibr">Triggs <italic>et al.</italic>, 2000</xref>) is adapted to solve the non-linear least square problem defined in <xref ref-type="disp-formula" rid="E8">Equation (7)</xref>. In the intrinsic alignment, we noticed that some landmarks located on patches with fewer ultrastructures will not produce high-quality localization. Therefore, a procedure against these poor landmarks is also adapted to ensure a robust estimation of the projection parameters (<xref rid="btz323-B17" ref-type="bibr">Han <italic>et al.</italic>, 2019</xref>).</p>
        <p>During the optimization of bundle adjustment (extrinsic alignment), all the landmarks will be assigned with a confidence value. The bundle adjustment will iteratively interact with the process of local patch refinement (intrinsic alignment), in which the global projection parameters serve as the initial value for local patches refinement. When this procedure converges, the joint solution will terminate and output the final projection parameters.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Experiments and results</title>
    <sec>
      <title>4.1 Datasets</title>
      <p>Three experimental datasets are used to evaluate the proposed method. The first one is a tilt series with well-distributed fiducial markers, to show the comparison of our method with the fiducial marker-based methods. The second dataset is a tilt series without fiducial markers, which has a relatively large change of pitch angles, to compare our method with the classic feature-based methods. The third dataset is a tilt series with a high noise to demonstrate the application of our method on the dataset that feature-based methods are difficult to be applied on.</p>
      <p>The first dataset (the filament dataset) is a tilt series of F-actin filaments (<xref ref-type="fig" rid="btz323-F5">Fig. 5A</xref>). It is a negative-stained cryo-ET dataset with fiducial markers embedded in, provided by the National Institute of Biological Sciences of China. The data were collected by an FEI Titan Krios (operated at 300 kV) with a Gatan camera. The tilt angles of the projection images range from <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>60.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>58.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> at a <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> interval. In total, there are 60 images in the tilt series. The size of each tilt image is 2048 × 2048 with a pixel size of 1.01 nm.
</p>
      <fig id="btz323-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Illustration of the three test datasets. (<bold>A</bold>) Filament, (<bold>B</bold>) mitochondria and (<bold>C</bold>) vesicle</p>
        </caption>
        <graphic xlink:href="btz323f5"/>
      </fig>
      <p>The second dataset (the mitochondria dataset) is a tilt series of mitochondria of mouse hepatic cells without fiducial markers (<xref ref-type="fig" rid="btz323-F5">Fig. 5B</xref>), which is taken with an FEI Tecnai 20, with the voltage at 200 kV. This dataset was collected by the Institute of Biophysics, Chinese Academy of Sciences, which was used as the benchmark set for the previous state-of-art feature-based alignment (<xref rid="btz323-B13" ref-type="bibr">Han <italic>et al.</italic>, 2014</xref>). The tilt angles of the projection images range from <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>52.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>59.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> at a <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> interval. In total, there are 112 images in the tilt series. The size of each tilt image is 2048 × 2048 with a pixel size of 0.4 nm.</p>
      <p>The third dataset (the vesicle dataset) is a tilt series of synaptic vesicles of the calyceal terminal without fiducial markers (<xref ref-type="fig" rid="btz323-F5">Fig. 5C</xref>), which is taken with an FEI Tecnai 20, with the voltage at 200 kV. This dataset was also collected by the Institute of Biophysics, Chinese Academy of Sciences. The tilt angles of the projection images range from <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>59.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>60.0</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> at a <inline-formula id="IE82"><mml:math id="IM82"><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> interval. In total, there are 120 images in the tilt series. The size of each tilt image is 2048 × 2048 with a pixel size of 0.2 nm.</p>
      <p>Specifically, to ensure a fair comparison between different methods, in the following context, all the reconstructions of the samples are carried out by the Simultaneous Algebraic Reconstruction Technique (SART) (<xref rid="btz323-B1" ref-type="bibr">Andersen and Kak, 1984</xref>) under the same configuration. SART is a widely used reconstruction method that has the ability to model the inverse projection problem discretizing the geometric optics models of the image formation process.</p>
    </sec>
    <sec>
      <title>4.2 Results</title>
      <sec>
        <label>4.2.1</label>
        <title>Demonstration of landmark tracks</title>
        <p>The joint method is based on the iterative tracking and refinement of the landmarks on the local patches. Here, we first use the filament dataset to demonstrate the landmark tracking of these local patches.</p>
        <p><xref ref-type="fig" rid="btz323-F6">Figure 6</xref> demonstrates the tracking and alignment of landmarks in the filament dataset. To align the tilt series, 81 grid distributed landmarks with 256 × 256 local patch size were used. These landmarks were first selected from the micrographs of the <inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle and then propagated from the micrographs of the low tilt angle to those of the high tilt angle, with the transformation matrix of view-to-view relationship. After several rounds of refinement of local tilt series, the reproduced landmarks were used for the final refinement of the projection parameter estimation. <xref ref-type="fig" rid="btz323-F6">Figure 6A</xref> shows the tracking process. The bottom part of <xref ref-type="fig" rid="btz323-F6">Figure 6A</xref> shows the correspondence of landmarks between the micrographs of the <inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle and the <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>58</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> tilt angle. As shown, although the geometry is highly dynamic, the location of these landmarks still corresponds to one another. <xref ref-type="fig" rid="btz323-F6">Figure 6B</xref> shows the overlay of the location of landmarks in the image space (<italic>y</italic>–<italic>z</italic> coordinates) before refinement. Because the projection parameters have not been corrected, the locations of landmarks have a large shift and almost overlap with one another. <xref ref-type="fig" rid="btz323-F6">Figure 6C and D</xref> show the location of the landmarks after refinement (image space with <italic>x</italic>–<italic>y</italic> and <italic>y</italic>–<italic>z</italic> coordinates). From the view of <italic>x</italic>–<italic>y</italic> coordinates (<xref ref-type="fig" rid="btz323-F6">Fig. 6C</xref>), we find that the virtual tracks are clearly separated with each other as parallel lines (81 parallel lines when zooming in), due to the correct optimization of projection parameters. From the view of <italic>y</italic>–<italic>z</italic> coordinates (<xref ref-type="fig" rid="btz323-F6">Fig. 6D</xref>), we can find that the trajectories behave in a similar way to the trace in a cosine curve, which also indicates that the projection parameters of each view have been successfully calibrated.
</p>
        <fig id="btz323-F6" orientation="portrait" position="float">
          <label>Fig. 6.</label>
          <caption>
            <p>The track and alignment of the landmarks in the filament dataset. (<bold>A</bold>) An illustration of the view-to-view relationship and the tracked landmarks. (<bold>B</bold>) Overlay of the locations of raw landmarks in the image space (<italic>y</italic>–<italic>z</italic> coordinates). (<bold>C</bold>) Overlay of the locations of refined landmarks in the image space (<italic>x</italic>–<italic>y</italic> coordinates). (<bold>D</bold>) Overlay of the locations of refined landmarks in the image space (<italic>y</italic>–<italic>z</italic> coordinates)</p>
          </caption>
          <graphic xlink:href="btz323f6"/>
        </fig>
      </sec>
      <sec>
        <label>4.2.2</label>
        <title>Alignment and reconstruction results</title>
        <p><bold>The filament dataset:</bold> For the filament dataset, the fiducial markers are available. We further compared the results of our joint method with IMOD’s fiducial marker-based alignment. To align the tilt series, we chose 81 fiducial markers in IMOD and got a mean alignment residual of 0.52 pixel. On the other hand, the mean alignment residual of our joint method is 0.48 pixel, which is on the same level as the one of IMOD.</p>
        <p><xref ref-type="fig" rid="btz323-F7">Figure 7</xref> demonstrates the tomograms of the filament dataset reconstructed from both the alignment results of our joint method and the one of IMOD’s marker-based alignment. To present the details, here, we only show the center 512 × 256 areas for both results, while the large view tomogram is provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. Both the results of IMOD and our joint method have clear ultrastructure details and round fiducial markers. Judging from the visual appearance, we can find that the alignment and reconstruction results carried out by our joint method have almost no difference from the results obtained by fiducial marker-based alignment. This is a remarkable result because our method is marker-free, which is often expected to be much less accurate than marker-based methods.
</p>
        <fig id="btz323-F7" orientation="portrait" position="float">
          <label>Fig. 7.</label>
          <caption>
            <p>The reconstructed tomograms of the filament dataset. The presented tomograms are reconstructed by SART with 40 iterations and 0.2 relaxation factor. (<bold>A</bold>, <bold>C</bold>) The middle and top <italic>x</italic>–<italic>y</italic> slices of the tomogram reconstructed from the result of IMOD’s fiducial marker-based alignment. (<bold>B</bold>, <bold>D</bold>) The middle and top <italic>x</italic>–<italic>y</italic> slices of the tomogram reconstructed from the result of our joint method</p>
          </caption>
          <graphic xlink:href="btz323f7"/>
        </fig>
        <p><bold>The mitochondria dataset:</bold> The mitochondria dataset was used as a benchmark dataset to challenge the feature-based alignment in AuTom (<xref rid="btz323-B13" ref-type="bibr">Han <italic>et al.</italic>, 2014</xref>, <xref rid="btz323-B15" ref-type="bibr">2017</xref>). However, although the work has achieved an obvious improvement of the reconstruction quality by introducing SIFT as the feature transform and aligning the tracked features, it still faced the risk of insufficient calibration in feature-based alignment because of the relatively short length of the feature tracks (few tracks can cover more than half projections in the tilt series). If a large change of the pitch angle exists, the short feature tracks cannot truthfully reflect the projection parameter change. Here, we demonstrate that the reconstruction quality of the mitochondria dataset can be further improved by introducing reprojection–invariant landmarks.</p>
        <p>To align the tilt series of the mitochondria dataset, 81 grid distributed landmarks with 256 × 256 local patch size were used. After the refinement of local patches and final projection parameter estimation, a mean alignment residual of 0.78 pixels is obtained. Specifically, with the help of long landmark tracks, the pitch angle for each projection is calibrated. Here, we noticed a gradient change of the pitch angles from <inline-formula id="IE86"><mml:math id="IM86"><mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> up to <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:msup><mml:mrow><mml:mn>8</mml:mn></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. Therefore, the reconstruction module (<inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:mi mathvariant="italic">vol</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="italic">rec</mml:mi></mml:mrow></mml:math></inline-formula>) that considers high pitch angle is used to cope with these projection parameters (<xref rid="btz323-B17" ref-type="bibr">Han <italic>et al.</italic>, 2019</xref>).</p>
        <p><xref ref-type="fig" rid="btz323-F8">Figure 8</xref> demonstrates the tomograms of the mitochondria dataset reconstructed from both the alignment results of our joint method and the one of AuTom’s feature-based alignment (volume reconstructed with 300 pixels thickness). <xref ref-type="fig" rid="btz323-F8">Figure 8A and B</xref> show the middle <italic>x</italic>–<italic>y</italic> slices of the two tomograms, and <xref ref-type="fig" rid="btz323-F8">Figure 8C and D</xref> show the typical <italic>y</italic>–<italic>z</italic> slices of the two tomograms (Different projection parameter refinements will cause a slight difference in geometry and the ultrastructure between the results of different methods. Here, we ensure that the presented slices are the closest one to each other.). From the middle <italic>x</italic>–<italic>y</italic> slices of the tomograms, we found that the structure of the mitochondria is very clear in both reconstructions, and the sharpness of the two tomograms are very similar, except for some very detailed ultrastructures in which structure difference exists (red arrows). However, from the <italic>y</italic>–<italic>z</italic> slices of the tomograms, we found that the reconstruction with our joint method shows much clearer sample boundary and details, and fewer artifacts. Especially, we can clearly figure out the double membranes on any part of <xref ref-type="fig" rid="btz323-F8">Figure 8D</xref>, while most of the membrane structures are blurry or vanished in <xref ref-type="fig" rid="btz323-F8">Figure 8C</xref> (red arrows). More examples of the <italic>y</italic>–<italic>z</italic> slice difference can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>.
</p>
        <fig id="btz323-F8" orientation="portrait" position="float">
          <label>Fig. 8.</label>
          <caption>
            <p>The reconstructed tomograms of the mitochondria dataset. The presented tomograms are reconstructed by SART with 40 iterations and 0.2 relaxation factor. (<bold>A</bold>, <bold>C</bold>) The middle <italic>x</italic>–<italic>y</italic> slice and a typical <italic>y</italic>–<italic>z</italic> slice of the tomogram reconstructed from the result of AuTom’s feature-based alignment. (<bold>B</bold>, <bold>D</bold>) The middle <italic>x</italic>–<italic>y</italic> slice and a typical <italic>y</italic>–<italic>z</italic> slice of the tomogram reconstructed from the result of our joint method. The sharpness of details is similar in <italic>x</italic>–<italic>y</italic> slice, but the ultrastructure (membrane) details in <italic>y</italic>–<italic>z</italic> slice is much clearer in our joint method</p>
          </caption>
          <graphic xlink:href="btz323f8"/>
        </fig>
        <p><bold>The vesicle dataset:</bold> The vesicle dataset is a tilt series with a high level of noise, which results in an extremely short feature tracks and makes the classic feature-based alignment fail to process the dataset. Here, we tried to use our joint method to refine the projection parameters for the vesicle dataset, while IMOD’s marker-free alignment based on cross-correlation is used to compare with our joint method.</p>
        <p>To align the tilt series of the vesicle dataset, 49 grid distributed landmarks with 480 × 480 local patch size were used. Because the sample has about 400 thickness in pixels, here, we used a relatively large patch size for the refinement of local patches, to ensure the retainment of depth information. After the refinement of local patches and final projection parameter estimation, a mean alignment residual of 0.82 pixels is obtained.</p>
        <p><xref ref-type="fig" rid="btz323-F9">Figure 9</xref> demonstrates the tomograms of the vesicle dataset reconstructed from both the alignment results of our joint method and the one of IMOD’s marker-free alignment (volume reconstructed with 500 pixels thickness). <xref ref-type="fig" rid="btz323-F9">Figure 9A and B</xref> show the middle <italic>x</italic>–<italic>y</italic> slices of the two tomograms, and <xref ref-type="fig" rid="btz323-F9">Figure 9C and D</xref> show typical <italic>y</italic>–<italic>z</italic> slices of the two tomograms. In general, the performance of the cross-correlation method will be affected by such a sample thickness. From the middle <italic>x</italic>–<italic>y</italic> slices of the tomograms, we found that the structures of the vesicles and membranes are very clear in the reconstruction of our joint method, with obviously distinguishable sharpness. On the contrary, the vesicles in the tomogram reconstructed from IMOD’s marker-free alignment appear not so clear, with parts of the membranes vanished (red arrows). From the <italic>y</italic>–<italic>z</italic> slices of the tomograms, we also found that the reconstruction with our joint method shows much clearer details and fewer artifacts. Especially, the obvious artifacts in <xref ref-type="fig" rid="btz323-F9">Figure 9C</xref> are significantly reduced in <xref ref-type="fig" rid="btz323-F9">Figure 9D</xref>.
</p>
        <fig id="btz323-F9" orientation="portrait" position="float">
          <label>Fig. 9.</label>
          <caption>
            <p>The reconstructed tomograms of the vesicle dataset. The presented tomograms are reconstructed by SART with 40 iterations and 0.2 relaxation factor. (<bold>A</bold>, <bold>C</bold>) The middle <italic>x</italic>–<italic>y</italic> slice and a typical <italic>y</italic>–<italic>z</italic> slice of the tomogram reconstructed from the result of IMOD’s marker-free alignment. (<bold>B</bold>, <bold>D</bold>) The middle <italic>x</italic>–<italic>y</italic> slice and a typical <italic>y</italic>–<italic>z</italic> slice of the tomogram reconstructed from the result of our joint method. On both the <italic>x</italic>–<italic>y</italic> slices and the <italic>y</italic>–<italic>z</italic> slices, the background noise is considerably lower and the details are much clearer in our joint method. Especially, the artifacts are notably reduced in the <italic>y</italic>–<italic>z</italic> slice</p>
          </caption>
          <graphic xlink:href="btz323f9"/>
        </fig>
      </sec>
      <sec>
        <label>4.2.3</label>
        <title>Quantitative assessment of the performance</title>
        <p>We further used two different criteria to comprehensively evaluate the quantitative performance of the proposed method.</p>
        <p><bold>Cross-validation with LOO-NCC:</bold> Firstly, we made cross-validation between each original projection and its corresponding reprojection calculated from the tomogram reconstructed with all the projections except for itself (<xref rid="btz323-B5" ref-type="bibr">Cardone <italic>et al.</italic>, 2005</xref>). This strategy is also called leave-one-out (LOO) analysis, which is the most unbiased estimation to the generalization power. Since only one projection is missing, the resolution of this tomogram should be very close to that of the complete tomogram. The normalized cross coefficient (LOO-NCC) is used to compare the similarity between the original projection and its reprojection. A higher value suggests a better agreement between the projection and reprojection. In practice, SART with 10 iterations and 0.2 relaxation factor is used for this analysis.</p>
        <p><xref ref-type="fig" rid="btz323-F10">Figure 10</xref> shows the curves of the LOO-NCC value for each projection in the three datasets. In particular, we achieved a mean LOO-NCC value of 0.9613, 0.9355 and 0.8869 for the filament, mitochondria and vesicle datasets, respectively. As a comparison, the mean LOO-NCC values of the classic alignment methods for the corresponding datasets are 0.9610, 0.9311 and 0.8696, respectively. From <xref ref-type="fig" rid="btz323-F10">Figure 10A</xref>, we can find that the curve of our joint method is as good as or even better than the one obtained by the marker-based alignment by IMOD. <xref ref-type="fig" rid="btz323-F10">Figure 10B and C</xref> show that the alignment of our method always has a better consistency (higher LOO-NCC value) in the tilt series. The special shapes of the curves in <xref ref-type="fig" rid="btz323-F10">Figure 10B</xref> may be caused by the uneven distribution of the tilt angle and the large change of the pitch angle.
</p>
        <fig id="btz323-F10" orientation="portrait" position="float">
          <label>Fig. 10.</label>
          <caption>
            <p>Curves of the LOO-NCC value. (<bold>A</bold>) Filament, (<bold>B</bold>) mitochondria and (<bold>C</bold>) vesicle</p>
          </caption>
          <graphic xlink:href="btz323f10"/>
        </fig>
        <p><bold>Resolution estimation with FSC</bold><italic><sub>e/o</sub></italic><bold>:</bold> The Fourier shell correlation comparison between tomograms calculated from the even and odd projection images in a tomography dataset (FSC<italic><sub>e/o</sub></italic>) is the most commonly used measurement for the determination of resolution in ET (<xref rid="btz323-B5" ref-type="bibr">Cardone <italic>et al.</italic>, 2005</xref>; <xref rid="btz323-B8" ref-type="bibr">Fernández, 2012</xref>), which is adapted from the idea of gold standard FSC in single-particle analysis (SPA) (<xref rid="btz323-B5" ref-type="bibr">Cardone <italic>et al.</italic>, 2005</xref>). Here, we used FSC<italic><sub>e</sub></italic><sub>/</sub><italic><sub>o</sub></italic> to further evaluate our reconstructions.</p>
        <p>Assuming that the SNR for each map from a half dataset is half of that of the full dataset, FSC<italic><sub>e</sub></italic><sub>/</sub><italic><sub>o</sub></italic> is defined as follows:
<disp-formula id="E9"><label>(8)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext>FSC</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>k</italic> is Fourier shell correlation, and <inline-formula id="IE93"><mml:math id="IM89"><mml:mrow><mml:mtext>FSC</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is the corresponding spatial frequency (i.e. the inverse of the resolution) when Fourier shell correlation equals to <italic>k</italic>.</p>
        <p>To avoid the influence of edges, we chose the central volume of the reconstructions for estimation (<inline-formula id="IE94"><mml:math id="IM90"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with the 0.5 resolution cutoff). As illustrated in <xref rid="btz323-T1" ref-type="table">Table 1</xref>, the resolution obtained by our joint method is 38.3 <inline-formula id="IE95"><mml:math id="IM91"><mml:mo>Å</mml:mo></mml:math></inline-formula> for filament, 19.3 <inline-formula id="IE96"><mml:math id="IM92"><mml:mo>Å</mml:mo></mml:math></inline-formula> for mitochondria and 27.0 <inline-formula id="IE97"><mml:math id="IM93"><mml:mo>Å</mml:mo></mml:math></inline-formula> for vesicle. It can be found that our joint method results in the same resolution with the marker-based alignment in the filament dataset, and better resolutions than the classic alignment methods in the mitochondria and vesicle datasets. Specifically, the joint method achieved a 0.5 <inline-formula id="IE98"><mml:math id="IM94"><mml:mo>Å</mml:mo></mml:math></inline-formula> resolution gain for the mitochondria dataset and 0.6 <inline-formula id="IE99"><mml:math id="IM95"><mml:mo>Å</mml:mo></mml:math></inline-formula> resolution gain for the vesicle dataset. We also show the detailed FSC<italic><sub>e</sub></italic><sub>/</sub><italic><sub>o</sub></italic> curves for each dataset in <xref ref-type="fig" rid="btz323-F11">Figure 11</xref>, in which the FSC curve obtained by our joint method is almost coincident with the one obtained by the marker-based alignment of IMOD (<xref ref-type="fig" rid="btz323-F11">Fig. 11A</xref>). For the other two datasets, our method has a clear improvement over the classic marker-free alignment (<xref ref-type="fig" rid="btz323-F11">Fig. 11B and C</xref>).</p>
        <table-wrap id="btz323-T1" orientation="portrait" position="float">
          <label>Table 1.</label>
          <caption>
            <p>Resolution estimation by <inline-formula id="IE102"><mml:math id="IM96"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (0.5)</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">Filament</th>
                <th rowspan="1" colspan="1">Mitochondria</th>
                <th rowspan="1" colspan="1">Vesicle</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Pixel width (nm)</td>
                <td rowspan="1" colspan="1">1.01</td>
                <td rowspan="1" colspan="1">0.4</td>
                <td rowspan="1" colspan="1">0.2</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Selected volume (pixel)</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE103">
                    <mml:math id="IM97">
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mn>1800</mml:mn>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>×</mml:mo>
                        <mml:mn>180</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE104">
                    <mml:math id="IM98">
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mn>1800</mml:mn>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>×</mml:mo>
                        <mml:mn>280</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE105">
                    <mml:math id="IM99">
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mn>1800</mml:mn>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>×</mml:mo>
                        <mml:mn>450</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><inline-formula id="IE106"><mml:math id="IM100"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (0.5) of comparison<xref ref-type="table-fn" rid="tblfn1"><sup>a</sup></xref></td>
                <td rowspan="1" colspan="1">38.3 <inline-formula id="IE107"><mml:math id="IM101"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
                <td rowspan="1" colspan="1">19.8 <inline-formula id="IE108"><mml:math id="IM102"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
                <td rowspan="1" colspan="1">27.7 <inline-formula id="IE109"><mml:math id="IM103"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><inline-formula id="IE110"><mml:math id="IM104"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>FSC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (0.5) of joint method</td>
                <td rowspan="1" colspan="1">38.3 <inline-formula id="IE111"><mml:math id="IM105"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
                <td rowspan="1" colspan="1">19.3 <inline-formula id="IE112"><mml:math id="IM106"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
                <td rowspan="1" colspan="1">27.1 <inline-formula id="IE113"><mml:math id="IM107"><mml:mo>Å</mml:mo></mml:math></inline-formula></td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn1">
              <label>a</label>
              <p>For the filament dataset, the compared method is IMOD’s marker-based method. For the mitochondria dataset, the compared method is AuTom’s feature-based method. For the vesicle dataset, the compared method is IMOD’s marker-free method.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <fig id="btz323-F11" orientation="portrait" position="float">
          <label>Fig. 11.</label>
          <caption>
            <p>Curves of FSC<italic><sub>e</sub></italic><sub>/</sub><italic><sub>o</sub></italic>. (<bold>A</bold>) Filament, (<bold>B</bold>) mitochondria and (<bold>C</bold>) vesicle</p>
          </caption>
          <graphic xlink:href="btz323f11"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion and discussion</title>
    <p>In this article, we proposed a joint method for projection parameter calibration of marker-free alignment in ET. Our method combines the strength of extrinsic alignment and intrinsic alignment. By extrinsic alignment based on these landmark tracks, the high-level information underlying the projection system could be flexibly calibrated. On the other hand, the 2D-to-3D relationship of the ultrastructures in the sample is monitored in every local tilt series. By intrinsic alignment based on the reconstruction–reprojection refinement of the local patches, the intensity information underlying the shape of the ultrastructure can be well utilized. With the integration of intrinsic alignment and extrinsic alignment, we overcome the short length of the virtual tracks in classic marker-free alignments to make a more accurate and adequate estimation of the projection parameters.</p>
    <p>It should be noted that although we used SIFT in the view-to-view relationship calibration, SIFT is not directly used to compose the virtual track as in the conventional paradigm of feature-based alignment. Other techniques, for example, the tracking of single particles or deep learning technique (<xref rid="btz323-B21" ref-type="bibr">Li <italic>et al.</italic>, 2018</xref>), could be used to discover the view-to-view relationship as well. Another point is that our joint solution could also be used in the fiducial marker-based alignment, focusing on the location refinement of the fiducial markers. This is an important potential application of our joint method, especially in the case that the fiducial markers do not appear as a perfect spherical shape. The localization of the fiducial markers could be further refined by the intrinsic alignment, which can make the locations of the fiducial markers to be the true center of mass. Therefore, the paradigm of our joint solution could be migrated to other solutions to further improve the calibration of projection parameters.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the King Abdullah University of Science and Technology (KAUST) Office of Sponsored Research (OSR) [Awards No. FCC/1/1976-04, URF/1/2601-01, URF/1/3007-01]. M.X. acknowledges partial support from U.S. National Institutes of Health (NIH) [P41 GM103712]. X.Z. was supported by a fellowship from Carnegie Mellon University's Center for Machine Learning and Health.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz323_Supplementary_Data</label>
      <media xlink:href="btz323_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz323-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Andersen</surname><given-names>A.H.</given-names></name>, <name name-style="western"><surname>Kak</surname><given-names>A.C.</given-names></name></person-group> (<year>1984</year>) 
<article-title>Simultaneous algebraic reconstruction technique (SART): a superior implementation of the art algorithm</article-title>. <source>Ultrasonic Imaging</source>, <volume>6</volume>, <fpage>81</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">6548059</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bentley</surname><given-names>J.L.</given-names></name></person-group> (<year>1975</year>) 
<article-title>Multidimensional binary search trees used for associative searching</article-title>. <source>Commun. ACM</source>, <volume>18</volume>, <fpage>509</fpage>–<lpage>517</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brandt</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Ziese</surname><given-names>U.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Automatic tem image alignment by trifocal geometry</article-title>. <source>J. Microsc</source>., <volume>222</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">16734708</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brandt</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Automatic alignment of transmission electron microscope tilt series without fiducial markers</article-title>. <source>J. Struct. Biol</source>., <volume>136</volume>, <fpage>201</fpage>–<lpage>213</lpage>.<pub-id pub-id-type="pmid">12051900</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cardone</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>A resolution criterion for electron tomography based on cross-validation</article-title>. <source>J. Struct. Biol</source>., <volume>151</volume>, <fpage>117</fpage>–<lpage>129</lpage>.<pub-id pub-id-type="pmid">15964766</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Castaño-Díez</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Fiducial-less alignment of cryo-sections</article-title>. <source>J. Struct. Biol</source>., <volume>159</volume>, <fpage>413</fpage>–<lpage>423</lpage>.<pub-id pub-id-type="pmid">17651988</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Castaño-Díez</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Alignator: a gpu powered software package for robust fiducial-less alignment of cryo tilt-series</article-title>. <source>J. Struct. Biol</source>., <volume>170</volume>, <fpage>117</fpage>–<lpage>126</lpage>.<pub-id pub-id-type="pmid">20117216</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fernández</surname><given-names>J.-J.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Computational methods for electron tomography</article-title>. <source>Micron</source>, <volume>43</volume>, <fpage>1010</fpage>–<lpage>1030</lpage>.<pub-id pub-id-type="pmid">22658288</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fischler</surname><given-names>M.A.</given-names></name>, <name name-style="western"><surname>Bolles</surname><given-names>R.C.</given-names></name></person-group> (<year>1981</year>) 
<article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title>. <source>Commun. ACM</source>, <volume>24</volume>, <fpage>381</fpage>–<lpage>395</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Frank</surname><given-names>J.</given-names></name></person-group> (<year>2006</year>) <source>Electron Tomography: Methods for Three-Dimensional Visualization of Structures in the Cell</source>. 
<publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz323-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frank</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>1987</year>) 
<article-title>Three-dimensional tomographic reconstruction in high voltage electron microscopy</article-title>. <source>J. Electron Microsc. Technol</source>., <volume>6</volume>, <fpage>193</fpage>–<lpage>205</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guckenberger</surname><given-names>R.</given-names></name></person-group> (<year>1982</year>) 
<article-title>Determination of a common origin in the micrographs of tilt series in three-dimensional electron microscopy</article-title>. <source>Ultramicroscopy</source>, <volume>9</volume>, <fpage>167</fpage>–<lpage>173</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A marker-free automatic alignment method based on scale-invariant features</article-title>. <source>J. Struct. Biol</source>., <volume>186</volume>, <fpage>167</fpage>–<lpage>180</lpage>.<pub-id pub-id-type="pmid">24582712</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A novel fully automatic scheme for fiducial marker-based alignment in electron tomography</article-title>. <source>J. Struct. Biol</source>., <volume>192</volume>, <fpage>403</fpage>–<lpage>417</lpage>.<pub-id pub-id-type="pmid">26433028</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Autom: a novel automatic platform for electron tomography reconstruction</article-title>. <source>J. Struct. Biol</source>., <volume>199</volume>, <fpage>196</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">28756247</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>A fast fiducial marker tracking model for fully automatic alignment in electron tomography</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>853</fpage>–<lpage>863</lpage>.<pub-id pub-id-type="pmid">29069299</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Autom-dualx: a toolkit for fully automatic fiducial marker-based alignment of dual-axis tilt series with simultaneous reconstruction</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>319</fpage>–<lpage>328</lpage>.<pub-id pub-id-type="pmid">30010792</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kremer</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) 
<article-title>Computer visualization of three-dimensional image data using IMOD</article-title>. <source>J. Struct. Biol</source>., <volume>116</volume>, <fpage>71</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">8742726</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kyme</surname><given-names>A.Z.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Practical aspects of a data-driven motion correction approach for brain spect</article-title>. <source>IEEE T. Med. Imaging</source>, <volume>22</volume>, <fpage>722</fpage>–<lpage>729</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>M.</given-names></name></person-group> (<year>1992</year>) <chapter-title>Least-squares method of alignment using markers</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Frank</surname><given-names>J.</given-names></name></person-group> (ed.) <source>Electron Tomography</source>. 
<publisher-name>Springer, US</publisher-name>, pp. <fpage>197</fpage>–<lpage>204</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Dlbi: deep learning guided Bayesian inference for structure reconstruction of super-resolution fluorescence microscopy</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i284</fpage>–<lpage>i294</lpage>.<pub-id pub-id-type="pmid">29950012</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) 
<article-title>A marker-free alignment method for electron tomography</article-title>. <source>Ultramicroscopy</source>, <volume>58</volume>, <fpage>393</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">7571119</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lowe</surname><given-names>D.G.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Distinctive image features from scale-invariant keypoints</article-title>. <source>Int. J. Comput. Vis</source>., <volume>60</volume>, <fpage>91</fpage>–<lpage>110</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lučić</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cryo-electron tomography: the challenge of doing structural biology in situ</article-title>. <source>J. Cell Biol</source>., <volume>202</volume>, <fpage>407</fpage>–<lpage>419</lpage>.<pub-id pub-id-type="pmid">23918936</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Markelj</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>A review of 3D/2D registration methods for image-guided interventions</article-title>. <source>Med. Image Anal</source>., <volume>16</volume>, <fpage>642</fpage>–<lpage>661</lpage>.<pub-id pub-id-type="pmid">20452269</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Phan</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) Non-linear bundle adjustment for electron tomography. In <italic>2009 WRI World Congress on Computer Science and Information Engineering</italic>, Vol. 1. IEEE, pp. <fpage>604</fpage>–<lpage>612</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saalfeld</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>As-rigid-as-possible mosaicking and serial section registration of large sstem datasets</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>i57</fpage>–<lpage>i63</lpage>.<pub-id pub-id-type="pmid">20529937</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheres</surname><given-names>S.H.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Maximum-likelihood methods in cryo-EM. Part II: application to experimental data</article-title>. <source>Methods Enzymol</source>., <volume>482</volume>, <fpage>295.</fpage><pub-id pub-id-type="pmid">20888966</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sorzano</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Marker-free image registration of electron tomography tilt-series</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>124</fpage>.<pub-id pub-id-type="pmid">19397789</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Eman2: an extensible image processing suite for electron microscopy</article-title>. <source>J. Struct. Biol</source>., <volume>157</volume>, <fpage>38</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">16859925</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Triggs</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) Bundle adjustment–a modern synthesis. In: <italic>Vision Algorithms: Theory and Practice</italic>
<publisher-name>Springer</publisher-name>, pp. <fpage>298</fpage>–<lpage>372</lpage>.</mixed-citation>
    </ref>
    <ref id="btz323-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Winkler</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>K.A.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Accurate marker-free alignment with simultaneous geometry determination and reconstruction of tilt series in electron tomography</article-title>. <source>Ultramicroscopy</source>, <volume>106</volume>, <fpage>240</fpage>–<lpage>254</lpage>.<pub-id pub-id-type="pmid">16137829</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Winkler</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>K.A.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Marker-free dual-axis tilt series alignment</article-title>. <source>J. Struct. Biol</source>., <volume>182</volume>, <fpage>117</fpage>–<lpage>124</lpage>.<pub-id pub-id-type="pmid">23435123</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Penczek</surname><given-names>P.A.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Cryo-EM image alignment based on nonuniform fast Fourier transform</article-title>. <source>Ultramicroscopy</source>, <volume>108</volume>, <fpage>959</fpage>–<lpage>969</lpage>.<pub-id pub-id-type="pmid">18499351</pub-id></mixed-citation>
    </ref>
    <ref id="btz323-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zampighi</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Conical tomography ii: a method for the study of cellular organelles in thin sections</article-title>. <source>J. Struct. Biol</source>., <volume>151</volume>, <fpage>263</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">16084109</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
