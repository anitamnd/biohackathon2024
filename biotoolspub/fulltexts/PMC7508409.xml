<?properties open_access?>
<?properties open_access?>
<?subarticle pone.0238422.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7508409</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-26876</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238422</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Experimental Design</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Random Variables</subject>
              <subj-group>
                <subject>Covariance</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecosystems</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecosystems</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Optimization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Aquatic Environments</subject>
          <subj-group>
            <subject>Freshwater Environments</subject>
            <subj-group>
              <subject>Fresh Water</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Marine and Aquatic Sciences</subject>
          <subj-group>
            <subject>Aquatic Environments</subject>
            <subj-group>
              <subject>Freshwater Environments</subject>
              <subj-group>
                <subject>Fresh Water</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SSNdesign—An R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks</article-title>
      <alt-title alt-title-type="running-head">SSNdesign—An R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4133-8548</contrib-id>
        <name>
          <surname>Pearse</surname>
          <given-names>Alan R.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McGree</surname>
          <given-names>James M.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Som</surname>
          <given-names>Nicholas A.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4186-1678</contrib-id>
        <name>
          <surname>Leigh</surname>
          <given-names>Catherine</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="author-notes" rid="currentaff001">
          <sup>¤</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maxwell</surname>
          <given-names>Paul</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ver Hoef</surname>
          <given-names>Jay M.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peterson</surname>
          <given-names>Erin E.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institute for Future Environments, Queensland University of Technology, Brisbane, QLD, Australia</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Australian Research Council Centre of Excellence for Mathematical and Statistical Frontiers, Queensland University of Technology, Brisbane, QLD, Australia</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>School of Mathematical Sciences, Queensland University of Technology, Brisbane, Australia</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>US Fish and Wildlife Service, Arcata, CA, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Humboldt State University, Arcata, CA, United States of America</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Healthy Land and Water, Brisbane, QLD, Australia</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Alaska Fisheries Science Center, NOAA Fisheries, Seattle, WA, Australia</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bryhn</surname>
          <given-names>Andreas C.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Swedish University of Agricultural Science, SWEDEN</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <label>¤</label>
        <p>Current address: Biosciences and Food Technology Discipline, School of Science, RMIT University, Bundoora, Victoria, Australia</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>arp320@uowmail.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>9</issue>
    <elocation-id>e0238422</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">
        <license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0</ext-link> public domain dedication.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0238422.pdf"/>
    <abstract>
      <p>Streams and rivers are biodiverse and provide valuable ecosystem services. Maintaining these ecosystems is an important task, so organisations often monitor the status and trends in stream condition and biodiversity using field sampling and, more recently, autonomous <italic>in-situ</italic> sensors. However, data collection is often costly, so effective and efficient survey designs are crucial to maximise information while minimising costs. Geostatistics and optimal and adaptive design theory can be used to optimise the placement of sampling sites in freshwater studies and aquatic monitoring programs. Geostatistical modelling and experimental design on stream networks pose statistical challenges due to the branching structure of the network, flow connectivity and directionality, and differences in flow volume. Geostatistical models for stream network data and their unique features already exist. Some basic theory for experimental design in stream environments has also previously been described. However, open source software that makes these design methods available for aquatic scientists does not yet exist. To address this need, we present <monospace>SSNdesign</monospace>, an R package for solving optimal and adaptive design problems on stream networks that integrates with existing open-source software. We demonstrate the mathematical foundations of our approach, and illustrate the functionality of <monospace>SSNdesign</monospace> using two case studies involving real data from Queensland, Australia. In both case studies we demonstrate that the optimal or adaptive designs outperform random and spatially balanced survey designs implemented in existing open-source software packages. The <monospace>SSNdesign</monospace> package has the potential to boost the efficiency of freshwater monitoring efforts and provide much-needed information for freshwater conservation and management.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Healthy Land and Water</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Peterson</surname>
            <given-names>Erin E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Healthy Land and Water</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>McGree</surname>
            <given-names>James M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Australian Research Council Discovery Project</institution>
        </funding-source>
        <award-id>DP200101263</award-id>
        <principal-award-recipient>
          <name>
            <surname>McGree</surname>
            <given-names>James M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This study received funding and support from Healthy Land and Water (<ext-link ext-link-type="uri" xlink:href="https://hlw.org.au/">https://hlw.org.au/</ext-link>) and was motivated by their monitoring needs and desire to transition their freshwater monitoring program to the use of in-situ sensors at broad spatial scales. E.E.P and J.M.M received the award from Healthy Land and Water. P.M. works for Healthy Land and Water and P.M. assisted in identifying the two motivating examples / case studies for the study and provided the data used in the second case study. P.M. also contributed to the preparation of the manuscript. In addition, JMM was supported by an Australian Research Council Discovery Project (DP200101263).</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data referred to in the text are available with the SSNdesign package on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/apear9/SSNdesign">https://github.com/apear9/SSNdesign</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data referred to in the text are available with the SSNdesign package on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/apear9/SSNdesign">https://github.com/apear9/SSNdesign</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Streams and rivers are highly biodiverse ecosystems supporting both aquatic and terrestrial species [<xref rid="pone.0238422.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0238422.ref002" ref-type="bibr">2</xref>] and provide important ecosystem services including clean water, food, and energy [<xref rid="pone.0238422.ref003" ref-type="bibr">3</xref>]. The ecological and economic importance of waterways has driven government and non-government organisations worldwide to invest large amounts of time and money into their monitoring, assessment and rehabilitation [<xref rid="pone.0238422.ref004" ref-type="bibr">4</xref>]. However, monitoring data remain relatively sparse [<xref rid="pone.0238422.ref005" ref-type="bibr">5</xref>] because the cost of sampling makes it impossible to gather data everywhere, on every stream, at all times. Thus, it is crucial to select sampling locations that yield as much information as possible about water quality and aquatic ecosystem health, especially when the stream system is large and resources for sampling are limited.</p>
    <p>Geostatistical models are commonly used to analyse environmental data collected at different locations and to make predictions, with estimates of uncertainty, at unobserved (i.e. unsampled) sites [<xref rid="pone.0238422.ref006" ref-type="bibr">6</xref>]. These models are a generalisation of the classic linear regression model, which contains a deterministic mean describing the relationship between the response (i.e. dependent variable) and the covariates (i.e. independent variables). In a geostatistical model, the assumption of independence of the errors is relaxed to allow spatial autocorrelation, which is modelled as a function of the distance separating any two locations [<xref rid="pone.0238422.ref007" ref-type="bibr">7</xref>]. This provides a way to extract additional information from the data by modelling local deviations from the mean using the spatial autocorrelation, or covariance, between sites. However, spatial autocorrelation may exist in streams data that is not well described using Euclidean distance, given the branching network structure, stream flow connectivity, direction and volume [<xref rid="pone.0238422.ref008" ref-type="bibr">8</xref>]. In addition, many traditional covariance functions are invalid if an in-stream (i.e. hydrologic) distance measure is substituted for Euclidean distance [<xref rid="pone.0238422.ref004" ref-type="bibr">4</xref>, <xref rid="pone.0238422.ref009" ref-type="bibr">9</xref>]. The use of covariance functions based on Euclidean distance may produce physically implausible results; for example, implying that two adjacent streams that do not flow into each other and that have separate watersheds are strongly related. This led to the development of covariance functions that are specifically designed to describe the unique spatial relationships found in streams data [<xref rid="pone.0238422.ref004" ref-type="bibr">4</xref>, <xref rid="pone.0238422.ref010" ref-type="bibr">10</xref>]. Geostatistical models fit to streams data describe a number of in-stream relationships in a way that is scientifically consistent with the hydrological features of natural streams and, as such, are increasingly being used for broad-scale monitoring and modelling of stream networks; see, for example, Isaak et al. [<xref rid="pone.0238422.ref011" ref-type="bibr">11</xref>] and Marsha et al. [<xref rid="pone.0238422.ref012" ref-type="bibr">12</xref>], both model temperature in streams, with Marsha et al. [<xref rid="pone.0238422.ref012" ref-type="bibr">12</xref>] further considering questions of site placement and sample size based on their data.</p>
    <p>The theoretical properties of geostatistical models can also be exploited in optimal and adaptive experimental designs [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>–<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>], which are used to select sampling locations that maximize information gain and minimize costs. However, the exact locations included in an optimal design will depend on the objectives of the monitoring program. Common objectives include estimating the parameters of the underlying geostatistical model (e.g. fixed effects estimates and/or covariance parameters), making accurate predictions at unsampled locations, or both. Utility functions are mathematical representations of the objectives used to measure the suitability of a design for a specific purpose. Depending on the objective of the sampling, the best design might be one that includes spatially balanced sites distributed across the study area or it could be a design that includes clusters of sites in close proximity to one another [<xref rid="pone.0238422.ref017" ref-type="bibr">17</xref>]. A variety of utility functions are available [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>] and are described more specifically in Section 2.4. An adaptive design (i.e. sequential design) is constructed by making a series of optimal decisions about where to put sampling sites as new information becomes available over time [<xref rid="pone.0238422.ref014" ref-type="bibr">14</xref>]. For example, the spatial location of monitoring sites may change through time, with some sites removed due to changes in access, or additional sites added as new funding becomes available. In these situations, the information gained from the data collected up to that point can be used to inform where the optimal sampling locations will be at the next time step. Hence, adaptive designs may provide additional benefits for long-term environmental monitoring programs because one-off optimal designs ignore the evolving nature of environmental processes and do not allow for adjustments as monitoring needs change [<xref rid="pone.0238422.ref017" ref-type="bibr">17</xref>].</p>
    <p>Bayesian and pseudo-Bayesian methods can enhance optimal and adaptive designs. Utility functions often depend on the parameters of the geostatistical model that one intends to fit over the design; however, the utility function can only be evaluated when these parameter values are fixed [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>]. If the values change, for example, through random variations in field conditions, then the design may no longer be optimal. Bayesian and pseudo-Bayesian optimal design addresses this issue by using simulation to construct more robust designs and to incorporate prior information about the distribution of the model parameters when constructing the design [<xref rid="pone.0238422.ref018" ref-type="bibr">18</xref>]. A drawback is that these methods are computationally intensive [<xref rid="pone.0238422.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0238422.ref019" ref-type="bibr">19</xref>]. In <monospace>SSNdesign</monospace>, we use the pseudo-Bayesian approach. This is different than a fully Bayesian approach because we are committed to performing frequentist inference on the data we collect from an experiment. The pseudo-Bayesian approach also does not take a Bayesian view of uncertainty, particularly with respect to model uncertainty, and as such we do not always have access to Bayesian utilities. Nevertheless, the pseudo-Bayesian approach allows us to incorporate prior information in the design process, which is not possible for purely frequentist designs, and can be more computationally efficient than the fully Bayesian approach.</p>
    <p>Although numerous software packages have been developed to implement geostatistical models on streams and to solve experimental design problems, none have done both. The <monospace>SSN</monospace> package [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>] for R statistical Software [<xref rid="pone.0238422.ref021" ref-type="bibr">21</xref>] is currently the only software available for implementing geostatistical models on stream networks [<xref rid="pone.0238422.ref010" ref-type="bibr">10</xref>]. However, various software packages exist to solve experimental design problems. For example, <monospace>acebayes</monospace> provides an implementation of the approximate coordinate exchange algorithm for finding optimal Bayesian designs given a user-specified utility function [<xref rid="pone.0238422.ref022" ref-type="bibr">22</xref>]. For spatial design problems, <monospace>spsurvey</monospace> [<xref rid="pone.0238422.ref023" ref-type="bibr">23</xref>] implements a variety of sampling designs including the Generalised Random Tessellation Sampling (GRTS) design for spatially balanced samples [<xref rid="pone.0238422.ref024" ref-type="bibr">24</xref>]. The package <monospace>geospt</monospace> [<xref rid="pone.0238422.ref025" ref-type="bibr">25</xref>] focuses on drawing optimal and adaptive spatial samples in the conventional 2-D geostatistical domain, with Euclidean distance used to describe spatial relationships between locations. However, it does not allow for stream-specific distance measures and covariance functions or it does not calculate design criteria consistent with a Bayesian or pseudo-Bayesian approach. This is important for constructing designs that are robust to changes in parameter values that the utility function depends on. Som et al. [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>] and Falk et al. [<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>] made use of the geostatistical modelling functions in the <monospace>SSN</monospace> package for solving design problems on stream networks, but neither addressed adaptive design problems and both used customised code that was not made publicly available.</p>
    <p>To our knowledge, <monospace>SSNdesign</monospace> is the first software package that allows users to optimise experimental designs on stream networks using geostatistical models and covariance functions that account for unique stream characteristics within a robust design framework. It combines the statistical modelling functionality found in the <monospace>SSN</monospace>package [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>] with principles of pseudo-Bayesian design [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>] into a generalised toolkit for solving optimal and adaptive design problems on stream networks. In Section 2, we discuss the mathematical principles underpinning these tools and outline the structure of the core functions in <monospace>SSNdesign</monospace> package along with a summary of the package’s speed and performance. This section is extended by <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>, which gives a deeper treatment of the required mathematics. In Section 3 we present two case studies using real data from Queensland, Australia. <xref ref-type="supplementary-material" rid="pone.0238422.s002">S2 Appendix</xref> is the package vignette, and provides the reader with detailed code required to reproduce the example. We conclude with a brief discussion of the package and future developments in Section 4. A glossary of terms is also provided in <xref ref-type="supplementary-material" rid="pone.0238422.s003">S3 Appendix</xref> for those unfamiliar with the language of experimental design.</p>
  </sec>
  <sec id="sec002">
    <title>The SSNdesign package</title>
    <sec sec-type="data-availability" id="sec003">
      <title>Software and data availability</title>
      <p>The <monospace>SSNdesign</monospace> package is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/apear9/">https://github.com/apear9/</ext-link>
<monospace>SSNdesign</monospace>, along with the data used in this paper. This R package requires R version 3.5.0 or later, and depends on the packages <monospace>SSN</monospace> [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>], <monospace>doParallel</monospace> [<xref rid="pone.0238422.ref026" ref-type="bibr">26</xref>], <monospace>doRNG</monospace> [<xref rid="pone.0238422.ref027" ref-type="bibr">27</xref>], <monospace>spsurvey</monospace> [<xref rid="pone.0238422.ref023" ref-type="bibr">23</xref>], and <monospace>shp2graph</monospace> [<xref rid="pone.0238422.ref028" ref-type="bibr">28</xref>]. These are downloaded from CRAN during the installation of the package.</p>
    </sec>
    <sec id="sec004">
      <title>Workflow</title>
      <p>There are three different workflows in <monospace>SSNdesign</monospace> corresponding to different design types, as well as for importing and manipulating stream network data (Figs <xref ref-type="fig" rid="pone.0238422.g001">1</xref> and <xref ref-type="fig" rid="pone.0238422.g002">2</xref>). The general process is to import a stream dataset (see Section 2.2) and if necessary, create potential sampling locations and simulate data at those locations. The next step is to use the main workhorse function <monospace>optimiseSSNDesign</monospace> to find optimal or adaptive designs, or use <monospace>drawStreamNetworkSamples</monospace> to find probability-based designs. In the case of adaptive design problems, there are always multiple ‘timesteps’. The first timestep is important because adaptive designs cannot be constructed without a pre-existing design. Therefore, it is not possible to go straight from data processing to an adaptive design; as such, the first design decision must be based on either an optimal or probability-based design before implementing the adaptive design process in subsequent timesteps (<xref ref-type="fig" rid="pone.0238422.g002">Fig 2</xref>).</p>
      <fig id="pone.0238422.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A flow chart of the function calls used to import and prepare streams data for use in <monospace>SSNdesign</monospace>.</title>
          <p>Grey boxes with solid outlines indicate a call to a function (N.B. <monospace>importSSN</monospace> and <monospace>SimulateOnSSN</monospace> belong to <monospace>SSN</monospace>, not <monospace>SSNdesign</monospace>). Clear boxes with dashed outlines indicate a file, folder or R object that is created as a result of a function call. The one dashed line represents an action that will not always be necessary.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g001"/>
      </fig>
      <fig id="pone.0238422.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>A flow chart of the function calls used to construct optimal (blue), adaptive (red), and probability-based (green) designs for stream networks.</title>
          <p>The yellow box is discussed in more detail in <xref ref-type="fig" rid="pone.0238422.g001">Fig 1</xref>. Grey boxes with solid outlines represent a call to a function (N.B. <monospace>glmssn</monospace> belongs to <monospace>SSN</monospace>, not <monospace>SSNdesign</monospace>). Clear boxes with dashed outlines indicate a file, folder or R object that is created as a result of a function call. The dash-dot-dot lines represent optional steps or connections between function calls that do not always occur.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g002"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>Data format, ingestion and manipulation</title>
      <p>The <monospace>SSNdesign</monospace> package builds on the functionality in the package SSN [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>], most notably the S4 <monospace>SpatialStreamNetwork</monospace> class for stream network datasets and the function and class <monospace>glmssn</monospace> which fits and stores fitted spatial stream network models. <monospace>SpatialStreamNetwork</monospace> objects are an extention of the <monospace>sp</monospace> class, but are unique because they contain a set of stream lines (i.e. edges) and a set of observed sites. Prediction sites can also be included, but are optional. These spatial data are imported from.ssn folders, which are created using the Spatial Tools for the Analysis of River Sytems (STARS) ArcGIS custom toolset [<xref rid="pone.0238422.ref029" ref-type="bibr">29</xref>]. The <monospace>importSSN</monospace> found in the SSN package is used to ingest data contained in the.ssn folders, but this function will not work if there are no observed sites in the.ssn folder. Therefore, the <monospace>SSNdesign</monospace> package provides the function <monospace>importStreams</monospace> for creating a <monospace>SpatialStreamNetwork</monospace> object with no observed or predicted sites. Additional functions such as <monospace>generateSites</monospace> are provided to add potential sampling sites to these empty networks. Four distinct workflows for importing and preprocessing stream data are shown in <xref ref-type="fig" rid="pone.0238422.g001">Fig 1</xref>, but the end result is a <monospace>SpatialStreamNetwork</monospace> object that contains streams and observed sites where data were collected or simulated that can be used for optimal or adaptive designs.</p>
      <p>The data processing (<xref ref-type="fig" rid="pone.0238422.g001">Fig 1</xref>) and design (<xref ref-type="fig" rid="pone.0238422.g002">Fig 2</xref>) workflows produce objects of class <monospace>ssndesign</monospace>, which are lists containing 1) information about the way the design optimisation function (<monospace>optimiseSSNdesign</monospace>) was used, including the <monospace>SpatialStreamNetwork</monospace> objects before and after an optimal design is found, 2) data about the optimal or adaptive design, and 3) diagnostic information about the optimisation procedure. This class also has a plot method, <monospace>plot.ssndesign</monospace>, which plots the trace for the optimisation algorithm. The method <monospace>plot.SpatialStreamNetwork</monospace> from the package <monospace>SSN</monospace> can be used to visualise the locations of the selected sites. Further details are provided in the package vignette (<xref ref-type="supplementary-material" rid="pone.0238422.s002">S2 Appendix</xref>). The vignette is intended as a practical guide that demonstrates the functionality and workflow of the package and as a practical reference for managers.</p>
    </sec>
    <sec id="sec006">
      <title>Expected utility estimation and maximisation</title>
      <p>There are many ways to configure a fixed number of monitoring sites. Each potential configuration represents a ‘design’ <italic>d</italic>, and the set of all possible configurations is denoted as <italic>D</italic>. The goal of optimal design theory as applied to stream networks is to find which configuration of sites is most suitable to achieve a purpose (e.g. precise parameter estimation in a statistical model). We refer to the optimal configuration of sites as <italic>d</italic>*. Inside <monospace>SSNdesign</monospace>, the quality of a design and its suitability for a stated goal is measured using a function called the expected utility <italic>U</italic>(<italic>d</italic>) [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>]. Larger values of <italic>U</italic>(<italic>d</italic>) indicate better designs and the calculation of <italic>U</italic>(<italic>d</italic>) is linked to the utility function, <italic>U</italic>(<italic>d</italic>, <italic>θ</italic>, <italic>y</italic>). The utility function may depend on elements of the geostatistical model fitted over the design, including its parameters <italic>θ</italic> and either observed or predicted data <italic>y</italic> [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>]. However, in many cases of pseudo-Bayesian utility functions, the utility function does not depend on <italic>y</italic> and can be written <italic>U</italic>(<italic>d</italic>, <italic>θ</italic>) [<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]. This function mathematically encodes the criterion used to compare designs. Examples of utility functions can be found in Section 2.1.2. The utility function, however, cannot be used directly to assess the quality of designs. This is because <italic>U</italic>(<italic>d</italic>, <italic>θ</italic>, <italic>y</italic>) depends on specific values of <italic>θ</italic> and <italic>y</italic> and the relative rankings of designs may change, sometimes dramatically, if there are small variations in these two quantities. Therefore, the parameters <italic>θ</italic> and the data <italic>y</italic> must be integrated out such that the values used to rank designs depend only on the designs themselves. We achieve this using Monte-Carlo integration [<xref rid="pone.0238422.ref013" ref-type="bibr">13</xref>]. Further details are provided in <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>.</p>
      <p>The set of possible designs <italic>D</italic> is usually large and, due to time and computational constraints, we cannot find <italic>d</italic>* by evaluating <italic>U</italic>(<italic>d</italic>) for every <italic>d</italic> ∈ <italic>D</italic>. <monospace>SSNdesign</monospace> deals with this problem in two ways. Firstly, we do not treat the design problem as a continuous one. That is, we do not allow sites to shift to any place along the stream edges during the search for the best design. The user must first create a set of <italic>N</italic> candidate points, and a design containing <italic>n</italic> points is chosen from among them. This ensures that <italic>D</italic> has a finite size. Secondly, we reduce the computational load of finding <italic>d</italic>* [<xref rid="pone.0238422.ref019" ref-type="bibr">19</xref>] by applying a coordinate exchange algorithm called the Greedy Exchange Algorithm (<xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>, Algorithm 1). This algorithm rapidly converges on highly efficient designs, although this efficient design may not be the best design [<xref rid="pone.0238422.ref030" ref-type="bibr">30</xref>]. Note that the Greedy Exchange Algorithm has previously been used for optimal designs on stream networks [<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>].</p>
    </sec>
    <sec id="sec007">
      <title>Utility functions for optimal and adaptive experimental designs</title>
      <p>The utility functions implemented in the <monospace>SSNdesign</monospace> package are suitable for solving either static optimal design problems or evolving, adaptive design problems. For optimal design, there are six utility functions for common monitoring objectives including parameter estimation and prediction (<xref rid="pone.0238422.t001" ref-type="table">Table 1</xref>; <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>). For adaptive design, there are three utility functions for similar monitoring objectives that are appropriate for adaptive decision-making. These are intended to be used with the function <monospace>optimiseSSNDesign</monospace>. We also provide two utility functions for finding space-filling designs (<xref rid="pone.0238422.t001" ref-type="table">Table 1</xref>), using the optimisation function <monospace>constructSpaceFillingDesigns</monospace>. These designs contain roughly equally spaced and unclustered sets of monitoring sites along the stream network [<xref rid="pone.0238422.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0238422.ref032" ref-type="bibr">32</xref>].</p>
      <table-wrap id="pone.0238422.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Utility functions implemented in <monospace>SSNdesign</monospace>.</title>
          <p><bold>Empirical utility functions are utility functions where the covariance parameters are estimated from data simulated using the prior draws</bold>. <italic>θ</italic> = a vector of covariance parameters from a geostatistical model; and <italic>y</italic> = data that is either directly observed from a process or simulated from it. OP = optimal design; AD = adaptive design. n/a = no covariance parameters involved. <italic>I</italic>(<italic>θ</italic>) = the expected Fisher Information Matrix; <inline-formula id="pone.0238422.e002"><alternatives><graphic id="pone.0238422.e002g" xlink:href="pone.0238422.e002"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext>gls</mml:mtext></mml:msub><mml:mo>=</mml:mo></mml:mrow><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>estimates</mml:mtext><mml:mspace width="4pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>fixed</mml:mtext><mml:mspace width="4pt"/><mml:mtext>effects</mml:mtext></mml:math></alternatives></inline-formula>; <inline-formula id="pone.0238422.e003"><alternatives><graphic id="pone.0238422.e003g" xlink:href="pone.0238422.e003"/><mml:math id="M3"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mtext>gls</mml:mtext></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mtext>covariance</mml:mtext><mml:mspace width="4pt"/><mml:mtext>matrix</mml:mtext><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>fixed</mml:mtext><mml:mspace width="4pt"/><mml:mtext>effects</mml:mtext></mml:math></alternatives></inline-formula>. <italic>s</italic><sub><italic>z</italic></sub> = a prediction site; <italic>S</italic> = the set of all prediction sites. <inline-formula id="pone.0238422.e004"><alternatives><graphic id="pone.0238422.e004g" xlink:href="pone.0238422.e004"/><mml:math id="M4"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>predicted</mml:mtext><mml:mspace width="4pt"/><mml:mtext>value</mml:mtext><mml:mspace width="4pt"/><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mtext>a</mml:mtext><mml:mspace width="4pt"/><mml:mtext>prediction</mml:mtext><mml:mspace width="4pt"/><mml:mtext>site</mml:mtext></mml:math></alternatives></inline-formula>. <inline-formula id="pone.0238422.e005"><alternatives><graphic id="pone.0238422.e005g" xlink:href="pone.0238422.e005"/><mml:math id="M5"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>kriging</mml:mtext><mml:mspace width="4pt"/><mml:mtext>variance</mml:mtext></mml:math></alternatives></inline-formula>. <italic>O</italic><sub><italic>t</italic></sub>(<italic>θ</italic>) = a summary statistic from the existing design. <italic>D</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub>) = the distance between two points <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub>. The distance can be measured as Euclidean distance or hydrological distance along the stream network [<xref rid="pone.0238422.ref010" ref-type="bibr">10</xref>]. <italic>D</italic> = a sorted vector of non-zero distances in a distance matrix; <italic>J</italic> = the number of times each distance occurs in one triangle of the matrix. The subscript <italic>w</italic> = 1, 2, …, <italic>W</italic> counts the <italic>W</italic> unique non-zero entries in the distance matrix. <italic>p</italic> = a weighting power, with <italic>p</italic> ≥ 1. In the Empirical column, × means No, ✓ means Yes.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0238422.t001g" xlink:href="pone.0238422.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Name</th>
                <th align="left" rowspan="1" colspan="1">Purpose</th>
                <th align="left" rowspan="1" colspan="1">Application</th>
                <th align="left" rowspan="1" colspan="1">Empirical</th>
                <th align="left" rowspan="1" colspan="1">Definition of the expected utility</th>
                <th align="left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">CP-optimality</td>
                <td align="left" rowspan="1" colspan="1">Covariance parameters</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">log det[<italic>I</italic>(<italic>θ</italic>)<sup>−1</sup>]</td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">D-optimality</td>
                <td align="left" rowspan="1" colspan="1">Fixed effects parameters</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e006">
                    <alternatives>
                      <graphic id="pone.0238422.e006g" xlink:href="pone.0238422.e006"/>
                      <mml:math id="M6">
                        <mml:mrow>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:mi>V</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>β</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mtext>gls</mml:mtext>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ED-optimality</td>
                <td align="left" rowspan="1" colspan="1">Fixed effects parameters</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">✓</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e007">
                    <alternatives>
                      <graphic id="pone.0238422.e007g" xlink:href="pone.0238422.e007"/>
                      <mml:math id="M7">
                        <mml:mrow>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>V</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>β</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mtext>gls</mml:mtext>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CPD-optimality</td>
                <td align="left" rowspan="1" colspan="1">Fixed effects and covariance parameters, a mixture of CP- and D-optimality</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e008">
                    <alternatives>
                      <graphic id="pone.0238422.e008g" xlink:href="pone.0238422.e008"/>
                      <mml:math id="M8">
                        <mml:mrow>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:mi>V</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>β</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mtext>gls</mml:mtext>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                          <mml:mo>+</mml:mo>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:mi>I</mml:mi>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K-optimality</td>
                <td align="left" rowspan="1" colspan="1">Predictions</td>
                <td align="left" rowspan="1" colspan="1">OP, AD</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e009">
                    <alternatives>
                      <graphic id="pone.0238422.e009g" xlink:href="pone.0238422.e009"/>
                      <mml:math id="M9">
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:msub>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>s</mml:mi>
                                  <mml:mi>z</mml:mi>
                                </mml:msub>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mi>V</mml:mi>
                            <mml:mi>a</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mo>(</mml:mo>
                            <mml:mover accent="true">
                              <mml:mi>y</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mi>s</mml:mi>
                                <mml:mi>z</mml:mi>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EK-optimality</td>
                <td align="left" rowspan="1" colspan="1">Predictions</td>
                <td align="left" rowspan="1" colspan="1">OP, AD</td>
                <td align="left" rowspan="1" colspan="1">✓</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e010">
                    <alternatives>
                      <graphic id="pone.0238422.e010g" xlink:href="pone.0238422.e010"/>
                      <mml:math id="M10">
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:msub>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>s</mml:mi>
                                  <mml:mi>z</mml:mi>
                                </mml:msub>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>V</mml:mi>
                                <mml:mi>a</mml:mi>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mo>(</mml:mo>
                            <mml:mover accent="true">
                              <mml:mi>y</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mi>s</mml:mi>
                                <mml:mi>z</mml:mi>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequential CP-optimality</td>
                <td align="left" rowspan="1" colspan="1">Covariance parameters</td>
                <td align="left" rowspan="1" colspan="1">AD</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">log det[(<italic>I</italic>(<italic>θ</italic>)+ <italic>O</italic><sub><italic>t</italic></sub>(<italic>θ</italic>))<sup>−1</sup>]</td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequential D-optimality</td>
                <td align="left" rowspan="1" colspan="1">Fixed effects parameters</td>
                <td align="left" rowspan="1" colspan="1">AD</td>
                <td align="left" rowspan="1" colspan="1">×</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e011">
                    <alternatives>
                      <graphic id="pone.0238422.e011g" xlink:href="pone.0238422.e011"/>
                      <mml:math id="M11">
                        <mml:mrow>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>V</mml:mi>
                              <mml:mi>a</mml:mi>
                              <mml:mi>r</mml:mi>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>β</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mtext>gls</mml:mtext>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mi>t</mml:mi>
                              </mml:msub>
                              <mml:mo>(</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sequential ED-optimality</td>
                <td align="left" rowspan="1" colspan="1">Fixed effects parameters</td>
                <td align="left" rowspan="1" colspan="1">AD</td>
                <td align="left" rowspan="1" colspan="1">✓</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e012">
                    <alternatives>
                      <graphic id="pone.0238422.e012g" xlink:href="pone.0238422.e012"/>
                      <mml:math id="M12">
                        <mml:mrow>
                          <mml:mo form="prefix">log</mml:mo>
                          <mml:mo form="prefix" movablelimits="true">det</mml:mo>
                          <mml:mo>[</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mi>V</mml:mi>
                                  <mml:mi>a</mml:mi>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>β</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mtext>gls</mml:mtext>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mi>O</mml:mi>
                                <mml:mi>t</mml:mi>
                              </mml:msub>
                              <mml:mo>(</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Maximin</td>
                <td align="left" rowspan="1" colspan="1">Space-filling, with an emphasis on increasing the minimum distance between pairs of points</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">n/a</td>
                <td align="left" rowspan="1" colspan="1">min<sub><italic>i</italic>≠<italic>j</italic></sub>
<italic>D</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub>)</td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref032" ref-type="bibr">32</xref>]</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Morris-Mitchell</td>
                <td align="left" rowspan="1" colspan="1">Space-filling, with an emphasis on increasing separations larger than the minimum</td>
                <td align="left" rowspan="1" colspan="1">OP</td>
                <td align="left" rowspan="1" colspan="1">n/a</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0238422.e013">
                    <alternatives>
                      <graphic id="pone.0238422.e013g" xlink:href="pone.0238422.e013"/>
                      <mml:math id="M13">
                        <mml:mrow>
                          <mml:mo>-</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msubsup>
                                <mml:mo>∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mi>W</mml:mi>
                              </mml:msubsup>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msub>
                                    <mml:mi>J</mml:mi>
                                    <mml:mi>w</mml:mi>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mi>D</mml:mi>
                                    <mml:mi>w</mml:mi>
                                  </mml:msub>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:msup>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>/</mml:mo>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">[<xref rid="pone.0238422.ref031" ref-type="bibr">31</xref>]</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>To solve adaptive design problems, we use a myopic design approach; that is, when making an adaptive design decision at a given point in time, we try to find the best decision for the next time step only [<xref rid="pone.0238422.ref033" ref-type="bibr">33</xref>]. An alternative method is to use backward induction, which involves enumerating all possible future decisions for a set number of time steps and then choosing the best series of decisions from among them [<xref rid="pone.0238422.ref014" ref-type="bibr">14</xref>]. However, this approach is often computationally prohibitive. Here we use an algorithm that assumes an initial design <italic>d</italic><sub>0</sub> that we seek to improve by adding sites or by rearranging the existing ones. We know <italic>a priori</italic> that, instead of solving this problem once, we will have to make a further <italic>T</italic> decisions in the future about the arrangement of the design points (Algorithm 2, <xref ref-type="supplementary-material" rid="pone.0238422.s001">S1 Appendix</xref>). At each step <italic>t</italic> = 1, 2, …, <italic>T</italic> in this iterative process, we fit a model to the existing design at <italic>d</italic><sub><italic>t</italic>−1</sub> and summarise the fit of the model using the summary statistic <italic>O</italic><sub><italic>t</italic></sub>(<italic>θ</italic>). The summary statistic can be arbitrarily defined, though it should be low-dimensional and preferably fast to compute [<xref rid="pone.0238422.ref014" ref-type="bibr">14</xref>]. In evaluating the designs at each timestep <italic>t</italic>, we incorporate the summary statistic <italic>O</italic><sub><italic>t</italic>−1</sub>(<italic>θ</italic>) in the calculation of the expected utility given the previous design decisions <italic>U</italic>(<italic>d</italic>|<italic>d</italic><sub>0:<italic>t</italic>−1</sub>, <italic>y</italic><sub>0:<italic>t</italic>−1</sub>). Data simulated from the likelihood at time <italic>t</italic>, <italic>p</italic>(<italic>y</italic>|<italic>θ</italic><sup><italic>t</italic></sup>, <italic>d</italic>), can involve real data collection. However, for most design studies, this step will simply involve generating predictions, with associated errors, from an assumed model. As with optimal design problems, the best design <inline-formula id="pone.0238422.e001"><alternatives><graphic xlink:href="pone.0238422.e001.jpg" id="pone.0238422.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> at step <italic>t</italic> is the one which maximises <italic>U</italic>(<italic>d</italic>|<italic>d</italic><sub>0:<italic>t</italic>−1</sub>, <italic>y</italic><sub>0:<italic>t</italic>−1</sub>). We also update the priors on the parameters for each new design. The process is repeated until the best design has been found for each of <italic>T</italic> time steps. For the objectives of covariance parameter estimation and fixed effects parameter estimation, we have defined utility functions specifically. Note that the main difference between the adaptive and static utility functions is the use of the summary statistic <italic>O</italic><sub><italic>t</italic></sub>(<italic>θ</italic>) from the model fitted to the existing sites (<xref rid="pone.0238422.t001" ref-type="table">Table 1</xref>; Supplementary Information A). These utility functions can be used with <monospace>optimiseSSNDesign</monospace>.</p>
      <p>Users may also define their own utility functions since the <monospace>optimiseSSNDesign</monospace> function has the flexibility to accept utility functions as an argument. The utility function must be defined in this format: <monospace>utility.function(ssn, glmssn, design, prior.parameters, n.draws, extra.arguments)</monospace>. The exact requirements in terms of input type and additional data accessible within the function <monospace>optimiseSSNDesign</monospace> are described in the function documentation. It is not necessary to use all the arguments inside the function. Ultimately, the only requirement for a working user-defined utility function is that the function returns a single number, representing the expected utility.</p>
    </sec>
    <sec id="sec008">
      <title>Other standard designs</title>
      <p>The <monospace>SSNdesign</monospace> package focuses on optimal and adaptive design problems, but we also include a number of standard designs such as simple random sampling and GRTS [<xref rid="pone.0238422.ref024" ref-type="bibr">24</xref>]. We have also included heuristic sampling schemes designed specifically for stream networks, such as designs with sites allocated to headwater streams (i.e. streams at the top of the network), to outlets (i.e. most downstream location on the network), or in clusters around stream confluences (i.e. junctions where stream segments converge; Som et al., [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>]). These are all options for the function <monospace>drawStreamNetworkSamples</monospace> (<xref rid="pone.0238422.t002" ref-type="table">Table 2</xref>).</p>
      <table-wrap id="pone.0238422.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Standard designs from Som et al. [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>].</title>
          <p>Note that ‘name in package’ is the string argument that must be passed to the <monospace>drawStreamNetworkSamples</monospace> function to use the sampling scheme.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0238422.t002g" xlink:href="pone.0238422.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">ID</th>
                <th align="left" rowspan="1" colspan="1">Name in package</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRS</td>
                <td align="left" rowspan="1" colspan="1">SRS</td>
                <td align="left" rowspan="1" colspan="1">Simple random sampling. An unstratified random sample of sites.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">G1</td>
                <td align="left" rowspan="1" colspan="1">GRTS</td>
                <td align="left" rowspan="1" colspan="1">GRTS. Spatially balanced design [<xref rid="pone.0238422.ref024" ref-type="bibr">24</xref>].</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">G2</td>
                <td align="left" rowspan="1" colspan="1">GRTSmouth</td>
                <td align="left" rowspan="1" colspan="1">GRTS with one site always assigned to the stream outlet.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">G4</td>
                <td align="left" rowspan="1" colspan="1">GRTSclus</td>
                <td align="left" rowspan="1" colspan="1">GRTS with clusters of sites around confluences.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">H1</td>
                <td align="left" rowspan="1" colspan="1">Headwater.Clusts.and.Singles</td>
                <td align="left" rowspan="1" colspan="1">Headwater samples. One site allocated to the outlet and others preferentially allocated to tributaries.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">C3</td>
                <td align="left" rowspan="1" colspan="1">Trib.Sets.Head.Singles.sample</td>
                <td align="left" rowspan="1" colspan="1">Clustered triplets. As many points as possible are allocated to triplets clustered where each segment meets at a confluence. All remaining points are assigned to tributaries.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">C4</td>
                <td align="left" rowspan="1" colspan="1">Trib.Sets.Head.Singles.Mouth.sample</td>
                <td align="left" rowspan="1" colspan="1">C3 with a single point allocated to the outlet segment.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec009">
      <title>Computational performance</title>
      <p>The optimisation of Bayesian and pseudo-Bayesian experimental designs via simulation is notoriously slow [<xref rid="pone.0238422.ref019" ref-type="bibr">19</xref>]. Other experimental design packages explicitly warn users to expect this (e.g. acebayes [<xref rid="pone.0238422.ref022" ref-type="bibr">22</xref>]). In our case, we have parallelised the functions (compatible with any OS) to increase computational efficiency for large problems. However, in many common situations users can expect run-times of hours, to days, and even weeks. The expected computation time in hours is given by <italic>K</italic> × <italic>L</italic> × <italic>T</italic> × <italic>n</italic> × (<italic>N</italic> − <italic>n</italic>)/(3600 × <italic>C</italic>), where <italic>K</italic> is the number of random starts that are used to seed the algorithm, <italic>L</italic> is the number of times the algorithm must iterate before converging, <italic>T</italic> is the time in seconds that is required to calculate <italic>U</italic>(<italic>d</italic>) for a single design, <italic>n</italic> is the number of desired sampling locations, <italic>N</italic> is the number of potential sampling locations, and <italic>C</italic> is the number of CPUs allocated to the task. The parameter <italic>K</italic> is specified by the user in <monospace>optimiseSSNDesign</monospace>, but <italic>L</italic> is more difficult to constrain. The number of times the algorithm must iterate until convergence is stochastic but, in our experience, <italic>L</italic> = 2 is most common; though we have observed <italic>L</italic> ∈ {3, 4, 5}. Unsurprisingly, the number of potential sampling locations and the number of desired sampling locations strongly influence computing time, and these make the largest contribution when <italic>n</italic> ≈ <italic>N</italic>/2. Large problems <italic>N</italic> ≥ 300 generally take at least a day, if not more, to compute. Our second case study below with <italic>N</italic> = 900 required approximately 4 days to complete using 20-32 CPUs and <italic>n</italic> ≪ <italic>N</italic>. Using complicated or intensive utility functions will also add significantly to computation time. The empirical prediction or estimation utilities are particularly prone to computational inefficiences because they rely on iteratively fitting and predicting from geostatistical stream network models. This is compounded by the fact that larger <italic>n</italic> is often associated with larger <italic>T</italic> values, due to the increased size of the matrices (e.g. covariance matrix, design matrix) that must be created and/or inverted.</p>
    </sec>
  </sec>
  <sec id="sec010">
    <title>Case studies</title>
    <p>We present two case studies where we illustrate how <monospace>SSNdesign</monospace> can be used to address common monitoring challenges. Field data collection can be expensive, so existing monitoring programs often need to reduce sampling effort due to resource constraints. In the first case study, we demonstrate how to ensure that the remaining survey sites are optimally placed to minimize information loss when sampling effort is reduced. In the second case study, we show how adaptive sampling can be used to design a monitoring program in a previously unsampled area, by gradually adding additional survey sites year-by-year. The R code used to create these examples is provided in Supplementary Information B so that readers can re-create them and also apply these methods to their own data.</p>
    <p>In a model-based design problem, a ‘true model’ must be specified. Here, a true model refers to the statistical model which most adequately characterises the underlying spatial process given what we know about the system. If a historical dataset from the study area exists, a standard model-selection process can be used to determine which model has the most support in the data using a range of approaches (e.g. information criteria or cross validation). If historical data are not available, simulated data can also be used to implement the model-based design. In this case, the general approach is to:</p>
    <list list-type="order">
      <list-item>
        <p>Specify the form of the statistical model;</p>
      </list-item>
      <list-item>
        <p>Identify which potential covariates should be related to the response (e.g. temperature affects the solubility of dissolved oxygen in water) based on prior knowledge of the system, or similar systems; and</p>
      </list-item>
      <list-item>
        <p>Set priors that specify the likely relationship between covariates and the response based on previously collected data, expert opinion and/or a literature review.</p>
      </list-item>
    </list>
    <p>The same process must be undertaken to specify the spatial covariance structure and covariance parameters for the model. The <monospace>SimulateOnSSN</monospace> function from <monospace>SSN</monospace> [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>] can then be used to simulate data that are subsequently used to implement the model-based design. Needless to say, the quality of the design will depend strongly on the quality of the prior information.</p>
    <sec id="sec011">
      <title>Case study 1: Lake Eacham</title>
      <p>Water temperature samples were collected at 88 sites along a stream network near Lake Eacham in north Queensland, Australia (<xref ref-type="fig" rid="pone.0238422.g003">Fig 3</xref>) [<xref rid="pone.0238422.ref034" ref-type="bibr">34</xref>]. The dataset includes a shapefile of streams, the 88 observed sites with rainfall data and GIS-derived urban and grazing land use percentages in the catchment, and 237 prediction sites with the same covariates. Most survey sites were clustered at stream confluences, with multiple sites located in the upstream and downstream segments. In a similar experiment to that of Falk et al. [<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>], we used optimal experimental design to reduce the number of survey sites by half, with the least amount of information loss possible. More specifically, we wanted to retain the ability to 1) estimate the effect that land use and rainfall are having on water temperature and 2) accurately predict temperature at unsampled locations. In the former case, we optimised the design using CPD-optimality, which is maximised when uncertainties in both the fixed-effects and covariance parameters are minimised (<xref rid="pone.0238422.t001" ref-type="table">Table 1</xref>). In the latter case, we used K-optimality, which is maximised when the total prediction uncertainty across all sites is minimised. Note that this situation where two designs are built separately using different utility functions is not ideal. There is no way to reconcile the two resulting designs into a single one. Ideally, we would be able to use the EK-optimality function. This utility function aims to maximise prediction accuracy but also involves a parameter estimation step, and therefore serves as a dual purpose utility function that yields designs that are efficient for parameter estimation and prediction. However, it was not practical to use the EK-optimality function because it is extremely computationally expensive, even for this dataset with only 88 potential sites.</p>
      <fig id="pone.0238422.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The Lake Eacham stream network (blue lines) with all potential sampling sites (red squares).</title>
          <p>The width of the stream lines is proportional to the catchment area for each stream segment. The inset shows the spatial distribution of sampling sites around a confluence in the stream network.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g003"/>
      </fig>
      <p>We fit a spatial stream-network model to the temperature data, using riparian land use (i.e. percent grazing and urban area) and the total rainfall recorded on the sampling date (mm) as covariates. The covariance structure contained exponential tail-up and tail-down components [<xref rid="pone.0238422.ref010" ref-type="bibr">10</xref>]. Log-normal priors were set on the covariance parameters using the natural logarithm of the estimated covariance parameters as the means and the log-scale standard errors of {0.35, 0.56, 0.63, 0.69, 0.68}, which were also estimated from the existing data using restricted maximum likelihood (REML).</p>
      <p>We set about finding CPD- and K-optimal designs with 44 sites by removing one site at a time from the original 88 sites. An alternative approach would be to optimise for a 44 site design with no intermediate steps. However, we chose to remove one site at a time because it helps reveal differences in the decision process between the CPD- and K-optimality utility functions that would otherwise be difficult to identify. Note that this is not an adaptive design because the model is not refit and the priors on the covariance parameters are not updated at each step. The expected CPD- and K-optimal utilities were calculated at each step using 500 Monte Carlo draws.</p>
      <p>As expected, the results revealed differences between the intermediate and final designs discovered under CPD- and K-optimality. Both utility functions preserved clusters in groups of at least three sites around confluences (one on each of the upstream segments and one on the downstream segment). However, CPD-optimality appeared to remove single sites that were not part of clusters in preference to sites within clusters. By comparison, K-optimality appeared to reduce clusters around confluences down to three sites much more quickly, while preserving sites that were located away from confluences. This reflects the previously observed tendency of designs constructed for parameter estimation to favour spatial clusters and the tendency of designs that optimise prediction to contain sites spread out in space, with some clusters to characterise spatial dependence at short distances [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>]. These results suggest that clusters located around confluences provide valuable information about the covariance structure that is needed to generate precise parameter estimates and accurate predictions.</p>
      <p>We tracked the information loss from the design process over time and compared the performance of our final 44-site optimal designs against 20 random and GRTS designs of the same size (<xref ref-type="fig" rid="pone.0238422.g004">Fig 4</xref>). We compared them to multiple GRTS and random designs because these designs have many potential configurations. Therefore, we needed to characterise the range of their performances under the chosen expected utilities. Information in this context is measured as relative design efficiency; a ratio of the expected utility of a given design and the expected utility of the ‘best’ design, which in this case contained all 88 sites. There was a linear reduction of information available for parameter estimation as sites were eliminated from the design (<xref ref-type="fig" rid="pone.0238422.g004">Fig 4a</xref>). While the optimal design containing 44 sites provided only 20% of the information gained from 88 sites, it provided significantly more information than the random and GRTS designs. These results suggest that reducing sampling effort by 50% would signficantly impact parameter estimation. However, the same was not true for prediction. We observed only minor reductions in the efficiency of the optimal 44-site design compared to the full 88-site design, while also demonstrating considerable gains in efficiency over random and GRTS designs (<xref ref-type="fig" rid="pone.0238422.g004">Fig 4b</xref>). As such, a 50% reduction in sampling effort would have little impact on the predictive ability of the models.</p>
      <fig id="pone.0238422.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Information loss in our optimal designs as we remove sites one-by-one using the (a, c) CPD-optimal and (b, d) K-optimal utility functions.</title>
          <p>The panels (a) and (b) have axes for efficiency fixed between 0 and 1. Panel (c) is zoomed on the y-axis range 0-0.3 and panel (d) on the y-axis range 0.7-1.0. Efficiency represents a ratio of the expected utilities of each design and the full 88 site design. The black line indicates the efficiency of the optimal design with a certain number of sampling sites. The 20 red dots and 20 blue dots in each panel represent the efficiencies of 44-site GRTS and random designs, respectively. These serve as a baseline measure of comparison for the optimal design, which should have higher relative efficiency. We only compare the efficiencies of the GRTS, random and optimal designs when there are 44 sampling sites in the design because the 44 site monitoring program is the final result.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g004"/>
      </fig>
      <p>The findings from this case study fit inside the framework established by Falk et al. [<xref rid="pone.0238422.ref016" ref-type="bibr">16</xref>] and Som et al. [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>], and broadly agree with their findings. However, for us, <monospace>SSNdesign</monospace> streamlined the process of discovering these results. The same code sufficed for both the CPD- and K-optimality experiments, with only a few lines’ difference to account for the change in utility function (<xref ref-type="supplementary-material" rid="pone.0238422.s002">S2 Appendix</xref>). If required, we could easily have changed the covariance function underpinning the spatial relationships in the Lake Eacham network or the priors on the covariance parameters. <monospace>SSNdesign</monospace> will enable aquatic scientists and statisticians to construct designs for their own monitoring programs or make decisions about them with ease. Bespoke code will no longer be required, expanding access to the sophisticated methodologies of optimal and adaptive design.</p>
    </sec>
    <sec id="sec012">
      <title>Case study 2: Pine River</title>
      <p>In the second case study, we demonstrate how additional sites can be selected to complement the information provided by a set of legacy sites using simulated data. The objective of the adaptive design process is to generate a design that can be used to accurately predict dissolved oxygen over the stream network at unsampled locations.</p>
      <p>We did not actually have data at legacy sites. Therefore, for this example, we started by simulating four years of maximum daily dissolved oxygen (DO, mg/L) data at 900 locations throughout the river network. We then selected 200 of these sites using a GRTS design, which were treated as legacy sites. The first two years of data from the legacy sites were treated as historical data and used to estimate the fixed effects and covariance parameters using a spatial statistical stream-network model (<xref ref-type="supplementary-material" rid="pone.0238422.s002">S2 Appendix</xref>). Five random starts were used to find an adaptive design which maximises the K-optimality utility function (<xref rid="pone.0238422.t001" ref-type="table">Table 1</xref>). We estimated <italic>U</italic>(<italic>d</italic>) using <italic>M</italic> = 500 Monte-Carlo draws from our independent log-normal priors on the covariance parameters. The results were used to select an additional 50 sites in year 3; after which the model was refit to the full dataset and an additional 50 sites were selected in year 4. Thus, the final dataset included 300 sites, giving rise to 950 observed DO measurements collected across four years (<xref ref-type="fig" rid="pone.0238422.g005">Fig 5</xref>). The result is shown in <xref ref-type="fig" rid="pone.0238422.g006">Fig 6</xref>.</p>
      <fig id="pone.0238422.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>A schematic diagram showing the adaptive design process over four years.</title>
          <p>Green rectangles indicate new sites (i.e. sampling locations) that have been added to the monitoring program, and blue rectangles indicate that sites have been retained from previous years.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g005"/>
      </fig>
      <fig id="pone.0238422.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The Pine River stream network.</title>
          <p>The sites on the network represent the evolution of the adaptive design through time.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g006"/>
      </fig>
      <p>We validated the adaptive design by computing its relative efficiency compared to 20 GRTS and 20 random designs of the same size. The GRTS designs were sequentially constructed using the ‘master sample’ approach [<xref rid="pone.0238422.ref035" ref-type="bibr">35</xref>]. We compared relative efficiency by computing the sum of the kriging variances for the same 900 prediction sites that were used when optimising the design. Note that the sum of the kriging variances is simply the inverse of the expected utility. For the purpose of validation, this expected utility was computed using 1000 prior draws to ensure our approximations to the expected utility were accurate. We did not include the 200 fixed GRTS sites in the validation procedure because we wanted to assess whether there were any additional benefits gleaned from the adaptive design. Thus, the efficiencies for each design (i.e. adaptive, GRTS, and random) were based on the 150 measurements collected at 100 locations in years 3 and 4.</p>
      <p>The results showed that the adaptive design was more efficient than both the GRTS and random designs, which had 74.5-84% relative efficiency. In terms of variance units, using the adaptive design reduces the total variance across 900 prediction sites by approximately 545-1004 variance units compared to GRTS and random designs (<xref ref-type="fig" rid="pone.0238422.g007">Fig 7</xref>). This demonstrates that adaptive design represents a far better investment in terms of predictive ability than designs formed without optimisation.</p>
      <fig id="pone.0238422.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0238422.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>The sum of kriging variances for both Generalised Random Tessellation Sampling (GRTS) and random designs computed using 1000 draws from the priors set on the covariance parameters.</title>
          <p>The dashed red line represents the sum of the kriging variances for the adaptive design. The performance of the adaptive design is plotted this way as opposed to as a boxplot because there is only one adaptive design.</p>
        </caption>
        <graphic xlink:href="pone.0238422.g007"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Conclusions</title>
    <p>The SSNdesign package brings together a large body of work on optimal spatial sampling, pseudo-Bayesian experimental design, and the complex spatial data processing and spatial statistical modelling of stream network data. We demonstrate how the package can be used in two contexts which should prove useful for scientists and managers working in stream ecosystems; particularly where monitoring programs lack the resources to comprehensively sample the network, but must nevertheless estimate parameters for complicated spatial processes and accurately predict in-stream conditions across broad areas.</p>
    <p>Compared with other packages for spatial sampling, such as <monospace>geospt</monospace> [<xref rid="pone.0238422.ref025" ref-type="bibr">25</xref>] and <monospace>spsurvey</monospace> [<xref rid="pone.0238422.ref023" ref-type="bibr">23</xref>], <monospace>SSNdesign</monospace> represents a significant advance in functionality for stream network data. The <monospace>SSNdesign</monospace> package integrates directly with the data structures, modelling and model diagnostic functions from a well-established R package for streams, <monospace>SSN</monospace> [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>]. As a result, the hydrological distance measures and unique covariance functions for streams data can also be used in the design process. This cannot be accomplished using other packages for spatial design, which are restricted to using Euclidean distance in the conventional 2-dimensional domain of geostatistics. <monospace>SSNdesign</monospace> has been written specifically to deal with problems of model-based design (i.e. obtaining the best information from a model given that a spatial statistical model for in-stream processes can be specified). This distinguishes <monospace>SSNdesign</monospace> from packages such as <monospace>spsurvey</monospace> [<xref rid="pone.0238422.ref023" ref-type="bibr">23</xref>], which selects designs based on factors such as the inclusion probability for a site given characteristics of the underlying stream segments. However, note that we also include tailored functions to simplify the process of generating designs for stream networks as per Som et al. [<xref rid="pone.0238422.ref015" ref-type="bibr">15</xref>], which include designs that can be formed using <monospace>spsurvey</monospace>.</p>
    <p>In addition to the existing functionality in <monospace>SSNdesign</monospace>, there are opportunities for further development. In particular, the authors of the <monospace>SSN</monospace> package [<xref rid="pone.0238422.ref020" ref-type="bibr">20</xref>] are working on extending its functionality to include computationally efficient models for big data (Personal Comm., J. Ver Hoef) and we expect there will be major performance boosts for the empirical utility functions where spatial stream network models must be fit iteratively. Computationally efficient spatial stream network models also open up possibilities to include new functionality within the <monospace>SSNdesign</monospace> package. For example, users must currently specify a single spatial stream network model as the ‘true’ model underpinning the design problem. This raises several important questions about the possibility of true models, and the uncertainty about which of several plausible, competing models ought to be chosen as the true model. Increased computational efficiency would allow us to implement a model-averaging approach [<xref rid="pone.0238422.ref036" ref-type="bibr">36</xref>] so that users will be able to specify several plausible models as reasonable approximations for the true model. Expected utilities for designs will then be averages of the expected utilities of the design under each plausible model. This approach would make optimal and adaptive designs more robust because the averaging mitigates the possibility that designs are being chosen to obtain the best information about the wrong model. Our hope is that managers of freshwater monitoring programs can more efficiently allocate scarce resources using optimal and adaptive designs for stream networks, which we have made accessible through the <monospace>SSNdesign</monospace> package.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec014">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0238422.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Background on optimal and adaptive pseudo-Bayesian design.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0238422.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238422.s002">
      <label>S2 Appendix</label>
      <caption>
        <title>SSNdesign—An R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0238422.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0238422.s003">
      <label>S3 Appendix</label>
      <caption>
        <title>Glossary of terms.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0238422.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Computational resources and services used in this work were provided by the eResearch Office, Queensland University of Technology, Brisbane, Australia.</p>
    <p>The findings and conclusions in this article are those of the authors and do not necessarily represent the views of the US Fish and Wildlife Service nor the National Marine Fisheries Service, NOAA. Any use of trade, product, or firm names is for descriptive purposes only and does not imply endorsement by the US Government.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0238422.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>David</surname><given-names>D</given-names></name>, <name><surname>H.</surname><given-names>AA</given-names></name>, <name><surname>O.</surname><given-names>GM</given-names></name>, <name><surname>Zen-Ichiro</surname><given-names>K</given-names></name>, <name><surname>J.</surname><given-names>KD</given-names></name>, <name><surname>Christian</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Freshwater biodiversity: Importance, threats, status and conservation challenges</article-title>. <source>Biological Reviews</source>. <year>2006</year>;<volume>81</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>82</lpage>. <pub-id pub-id-type="doi">10.1017/S1464793105006950</pub-id><?supplied-pmid 16336747?><pub-id pub-id-type="pmid">16336747</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref002">
      <label>2</label>
      <mixed-citation publication-type="book"><name><surname>Poff</surname><given-names>NL</given-names></name>, <name><surname>Olden</surname><given-names>JD</given-names></name>, <name><surname>Strayer</surname><given-names>DL</given-names></name>. <chapter-title>Climate change and freshwater fauna extinction risk</chapter-title> In: <name><surname>Hannah</surname><given-names>L</given-names></name>, editor. <source>Saving a million species: Extinction risk from climate change</source>. <publisher-loc>Washington, DC</publisher-loc>: <publisher-name>Island Press/Center for Resource Economics</publisher-name>; <year>2012</year> pp. <fpage>309</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Vorosmarty</surname><given-names>CJ</given-names></name>, <name><surname>McIntyre</surname><given-names>PB</given-names></name>, <name><surname>Gessner</surname><given-names>MO</given-names></name>, <name><surname>Dudgeon</surname><given-names>D</given-names></name>, <name><surname>Prusevich</surname><given-names>A</given-names></name>, <name><surname>Green</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Global threats to human water security and river biodiversity</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>:<fpage>555</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1038/nature09440</pub-id><?supplied-pmid 20882010?><pub-id pub-id-type="pmid">20882010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Peterson</surname><given-names>EE</given-names></name>, <name><surname>Theobald</surname><given-names>D</given-names></name>. <article-title>Spatial statistical models that use flow and stream distance</article-title>. <source>Environmental and Ecological Statistics</source>. <year>2006</year>;<volume>13</volume>:<fpage>449</fpage>–<lpage>64</lpage>. <pub-id pub-id-type="doi">10.1007/s10651-006-0022-8</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref005">
      <label>5</label>
      <mixed-citation publication-type="other">United Nations Water. The right to privacy in the digital age. Geneva, Switzerland; 2016.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref006">
      <label>6</label>
      <mixed-citation publication-type="book"><name><surname>Cressie</surname><given-names>N</given-names></name>. <source>Statistics for spatial data</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>; <year>1993</year>.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref007">
      <label>7</label>
      <mixed-citation publication-type="book"><name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Cressie</surname><given-names>N</given-names></name>, <name><surname>Fisher</surname><given-names>RN</given-names></name>, <name><surname>Case</surname><given-names>TJ</given-names></name>. <chapter-title>Uncertainty and spatial linear models for ecological data</chapter-title> In: <source>Spatial uncertainty in ecology</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2001</year> pp. <fpage>214</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Peterson</surname><given-names>EE</given-names></name>, <name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Isaak</surname><given-names>DJ</given-names></name>, <name><surname>Falke</surname><given-names>JA</given-names></name>, <name><surname>Fortin</surname><given-names>MJ</given-names></name>, <name><surname>Jordan</surname><given-names>CE</given-names></name>, <etal>et al</etal><article-title>Modelling dendritic ecological networks in space: An integrated network perspective</article-title>. <source>Ecology Letters</source>. <year>2013</year>;<volume>16</volume><issue>(5</issue>). <pub-id pub-id-type="doi">10.1111/ele.12084</pub-id><?supplied-pmid 23458322?><pub-id pub-id-type="pmid">23458322</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Ver Hoef</surname><given-names>JM</given-names></name>. <article-title>Kriging models for linear networks and non-euclidean distances: Cautions and solutions</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2018</year>;<volume>9</volume>:<fpage>1600</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12979</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Peterson</surname><given-names>EE</given-names></name>. <article-title>A moving average approach for spatial statistical models of stream networks</article-title>. <source>Journal of the American Statistical Association</source>. <year>2010</year>;<volume>105</volume>(<issue>489</issue>). <pub-id pub-id-type="doi">10.1198/jasa.2009.ap08248</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Isaak</surname><given-names>DJ</given-names></name>, <name><surname>Wenger</surname><given-names>SJ</given-names></name>, <name><surname>Peterson</surname><given-names>EE</given-names></name>, <name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Nagel</surname><given-names>DE</given-names></name>, <name><surname>Luce</surname><given-names>CH</given-names></name>, <etal>et al</etal><article-title>The norwest summer stream temperature model and scenarios for the western u.S.: A crowd-sourced database and new geospatial tools foster a user community and predict broad climate warming of rivers and streams</article-title>. <source>Water Resources Research</source> [Internet]. <year>2017</year>;<volume>53</volume>(<issue>11</issue>):<fpage>9181</fpage>–<lpage>205</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1002/2017WR020969">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1002/2017WR020969</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Marsha</surname><given-names>A</given-names></name>, <name><surname>Steel</surname><given-names>EA</given-names></name>, <name><surname>Fullerton</surname><given-names>AH</given-names></name>, <name><surname>Sowder</surname><given-names>C</given-names></name>. <article-title>Monitoring riverine thermal regimes on stream networks: Insights into spatial sampling design from the snoqualmie river</article-title>. <source>Ecological Indicators</source>. <year>2018</year>;<volume>84</volume>:<fpage>11</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1016/j.ecolind.2017.08.028</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Mueller</surname><given-names>P</given-names></name>. <article-title>Simulation-based optimal design</article-title>. <source>Bayesian Statistics</source>. <year>1999</year>;<volume>6</volume>:<fpage>459</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1007/s00477-015-1067-8</pub-id><?supplied-pmid 27563280?><pub-id pub-id-type="pmid">27563280</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Mueller</surname><given-names>P</given-names></name>, <name><surname>Berry</surname><given-names>DA</given-names></name>, <name><surname>Grieve</surname><given-names>AP</given-names></name>, <name><surname>Smith</surname><given-names>M</given-names></name>, <name><surname>Krams</surname><given-names>M</given-names></name>. <article-title>Simulation based sequential bayesian design</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2007</year>;<volume>137</volume>:<fpage>3140</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1016/j.jspi.2006.05.021</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Som</surname><given-names>NA</given-names></name>, <name><surname>Monestiez</surname><given-names>P</given-names></name>, <name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Zimmerman</surname><given-names>DL</given-names></name>, <name><surname>Peterson</surname><given-names>EE</given-names></name>. <article-title>Spatial sampling on streams: Principles for inference on aquatic networks</article-title>. <source>Environmetrics</source>. <year>2014</year>;<volume>25</volume>(<issue>5</issue>):<fpage>306</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.1002/env.2284</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Falk</surname><given-names>MG</given-names></name>, <name><surname>McGree</surname><given-names>JM</given-names></name>, <name><surname>Pettitt</surname><given-names>AN</given-names></name>. <article-title>Sampling designs on stream networks using the pseudo-bayesian approach</article-title>. <source>Environmental and Ecological Statistics</source>. <year>2014</year>;<volume>21</volume>:<fpage>751</fpage>–<lpage>73</lpage>. <pub-id pub-id-type="doi">10.1007/s10651-014-0279-2</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>SY</given-names></name>, <name><surname>McGree</surname><given-names>JM</given-names></name>, <name><surname>Drovandi</surname><given-names>CC</given-names></name>, <name><surname>Caley</surname><given-names>MJ</given-names></name>, <name><surname>Mengersen</surname><given-names>KL</given-names></name>. <article-title>Bayesian adaptive design: Improving the effectiveness of monitoring of the great barrier reef</article-title>. <source>Ecological Applications</source>. <year>2016</year>;<volume>26</volume>(<issue>8</issue>):<fpage>2637</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1002/eap.1409</pub-id><?supplied-pmid 27862584?><pub-id pub-id-type="pmid">27862584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Atkinson</surname><given-names>AC</given-names></name>, <name><surname>Donev</surname><given-names>AN</given-names></name>, <name><surname>Tobias</surname><given-names>RD</given-names></name>. <source>Optimum experimental designs, with sas</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2007</year>.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Royle</surname><given-names>JA</given-names></name>. <article-title>Exchange algorithms for constructing large spatial designs</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2002</year>;<volume>100</volume>(<issue>2</issue>):<fpage>121</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1016/S0378-3758(01)00127-6</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Ver Hoef</surname><given-names>JM</given-names></name>, <name><surname>Peterson</surname><given-names>EE</given-names></name>, <name><surname>Clifford</surname><given-names>D</given-names></name>, <name><surname>Shah</surname><given-names>R</given-names></name>. <article-title>SSN: An r package for spatial statistical modelling on stream networks</article-title>. <source>Journal of Statistical Software</source>. <year>2014</year>;<volume>56</volume>(<issue>3</issue>).</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref021">
      <label>21</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A language and environment for statistical computing</source> [Internet]. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>; <year>2018</year> Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">Overstall AM, Woods DC, Adamou M. Acebayes: Optimal bayesian experimental design using the ace algorithm [Internet]. 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=acebayes">https://CRAN.R-project.org/package=acebayes</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Kincaid</surname><given-names>TM</given-names></name>, <name><surname>Olsen</surname><given-names>AR</given-names></name>. <source>Spsurvey: Spatial survey design and analysis</source>. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pone.0238422.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Stevens</surname><given-names>DL</given-names></name>, <name><surname>Olsen</surname><given-names>AR</given-names></name>. <article-title>Spatially balanced sampling of natural resources</article-title>. <source>Journal of the American Statistical Association</source>. <year>2004</year>;<volume>99</volume>(<issue>465</issue>):<fpage>262</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1198/016214504000000250</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Melo C, Santacruz A, Melo O. Geospt: An r package for spatial statistics. [Internet]. 2012. Available from: <ext-link ext-link-type="uri" xlink:href="http://geospt.r-forge.r-project.org/">geospt.r-forge.r-project.org/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Corporation M, Weston S. DoParallel: Foreach parallel adaptor for the’parallel’ package [Internet]. 2019. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=doParallel">https://CRAN.R-project.org/package=doParallel</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Gaujoux R. DoRNG: Generic reproducible parallel backend for’foreach’ loops [Internet]. 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=doRNG">https://CRAN.R-project.org/package=doRNG</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>B</given-names></name>, <name><surname>Sun</surname><given-names>H</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Harris</surname><given-names>P</given-names></name>, <name><surname>Charlton</surname><given-names>M</given-names></name>. <article-title>Shp2graph: Tools to convert a spatial network into an igraph graph in r</article-title>. <source>ISPRS International Journal of Geo-Information</source> [Internet]. <year>2018</year>;<volume>7</volume>(<issue>8</issue>):<fpage>293</fpage> Available from: <pub-id pub-id-type="doi">10.3390/ijgi7080293</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Peterson</surname><given-names>EE</given-names></name>, <name><surname>Ver Hoef</surname><given-names>JM</given-names></name>. <article-title>STARS: An arcgis toolset used to calculate the spatial data needed to fit spatial statistical models to stream network data</article-title>. <source>Journal of Statistical Software</source>. <year>2014</year>;<volume>56</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v056.i02</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Evangelou</surname><given-names>E</given-names></name>, <name><surname>Zhu</surname><given-names>Z</given-names></name>. <article-title>Optimal predictive design augmentation for spatial generalised linear mixed models</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2012</year>;<volume>142</volume>(<issue>12</issue>):<fpage>3242</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1016/j.jspi.2012.05.008</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Morris</surname><given-names>MD</given-names></name>, <name><surname>Mitchell</surname><given-names>TJ</given-names></name>. <article-title>Exploratory designs for computational experiments</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>1995</year>;<volume>43</volume>(<issue>3</issue>):<fpage>381</fpage>–<lpage>402</lpage>. <pub-id pub-id-type="doi">10.1016/0378-3758(94)00035-T</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Pronzato</surname><given-names>L</given-names></name>, <name><surname>Muller</surname><given-names>WG</given-names></name>. <article-title>Design of computer experiments: Space filling and beyond</article-title>. <source>Statistics and Computing</source>. <year>2012</year>;<volume>22</volume><pub-id pub-id-type="doi">10.1007/s11222-011-9242-3</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>McGree</surname><given-names>JM</given-names></name>, <name><surname>Drovandi</surname><given-names>CC</given-names></name>, <name><surname>Thompson</surname><given-names>MH</given-names></name>, <name><surname>Eccleston</surname><given-names>JA</given-names></name>, <name><surname>Duffull</surname><given-names>SB</given-names></name>, <name><surname>Mengersen</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Adaptive bayesian compound designs for dose finding studies</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2012</year>;<volume>142</volume>(<issue>6</issue>):<fpage>1480</fpage>–<lpage>92</lpage>. <pub-id pub-id-type="doi">10.1016/j.jspi.2011.12.029</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Peterson EE. STARS: Spatial tools for the analysis of river systems—a tutorial [Internet]. Commonwealth Scientific Industrial Research Organisation (CSIRO); 2011. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc">http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Larsen</surname><given-names>DP</given-names></name>, <name><surname>Olsen</surname><given-names>AR</given-names></name>, <name><surname>Stevens</surname><given-names>DL</given-names></name>. <article-title>Using a master sample to integrate stream monitoring programs</article-title>. <source>Journal of the Agricultural, Biological and Environmental Statistics</source>. <year>2008</year>;<volume>13</volume>(<issue>3</issue>):<fpage>243</fpage>–<lpage>54</lpage>. <pub-id pub-id-type="doi">10.1198/108571108X336593</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0238422.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Clyde</surname><given-names>MA</given-names></name>. <article-title>Bayesian model averaging and model search strategies</article-title>. <source>Bayesian Statistics</source>. <year>1999</year>;<volume>6</volume>:<fpage>157</fpage>–<lpage>85</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0238422.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238422.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bryhn</surname>
          <given-names>Andreas C.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Andreas C. Bryhn</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Andreas C. Bryhn</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238422" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Jan 2020</named-content>
    </p>
    <p>PONE-D-19-26876</p>
    <p>SSNdesign – an R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks</p>
    <p>PLOS ONE</p>
    <p>Dear Dr Pearse,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by February 20, 2020. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Andreas C. Bryhn</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>Additional Editor Comments (if provided):</p>
    <p>Dear authors,</p>
    <p>Thank you for a well-written manuscript, Both reviewers recommended a minor revision and I agree with them. Again, I would like to apologise for the long review process, which was due to the difficulty to find suitable reviewers who agreed to participate. Please make sure to address all of the reviewers' comments in your rebuttal letter.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: This paper presents a new R statistical computing package called "SSNdesign" for obtaining statistically optimal (according to a range of different criteria) sampling designs on stream networks. As such, it provides a useful tool for scientists who manage freshwater ecosystems. The package takes advantage of recently (within the last 10-15 years) developed methodology for statistically modeling spatially correlated data taken at points on a stream network.</p>
    <p>The paper describes the software package at an appropriate level of detail, and the two case studies are nice and (in my opinion) need no improvement. I do not have expertise on the computational aspects (storage requirements, speed, reliability) of the package so I will limit my comments to those things on which I do have expertise, namely the relevant statistical models and utility functions, as presented in Supplement 1. First, however, here are a few minor comments referring to specific line numbers in the paper itself.</p>
    <p>Line 80: Change "pseudo-Baeysian" to "pseudo-Bayesian"</p>
    <p>Line 100: Change "Tesselation" to "Tessellation"</p>
    <p>Line 200: Change "before" to "then" (so that the sentence reads more smoothly)</p>
    <p>Line 279: Delete "based"</p>
    <p>Line 298: Delete the period after "distribution"</p>
    <p>Line 346: Change "dissovled" to "dissolved"</p>
    <p>Now here are some comments on Supplement 1, with references to its line numbers.</p>
    <p>Line 32: Remove the comma between "second-order" and "stationary"</p>
    <p>Lines 32-33: It is a bit of an oversimplification to say that the moving average models produce covariance functions that depend on "the separation distance between two locations" because tail-down covariance functions generally are functions of two distances (distance of each location to their common confluence) rather than merely the separation distance between locations. So this sentence needs a minor correction.</p>
    <p>Line 34: It is somewhat imprecise to refer to a point at which a function "starts." What you mean is that the moving average function is nonzero (positive, in fact) only at and upstream from a point. So you should change this sentence by changing "starts at some location and is nonzero only upstream from that location" to "is nonzero only upstream from a location." Make a similar edit in line 37 when describing the tail-down covariance function.</p>
    <p>Line 44: Change "set" to "vector"</p>
    <p>Line 67: When two sites are flow-unconnected, a and b, as defined, ALWAYS sum to h (the stream distance between the two sites). Thus, just change this sentence by deleting the phrase "when a+b=h"</p>
    <p>Lines 71-78 and expression (5): For consistency with expression (4), use bold type for Y, X, etc.</p>
    <p>Line 72: Here it should be noted that X is assumed to have full column rank; otherwise, the matrix in parentheses in line 158 is not invertible.</p>
    <p>Line 94: Change "join" to "joint"</p>
    <p>Line 106: Change "funciton" to "function"</p>
    <p>Lines 120-133: As this is written it is unclear (1) what is the "first" site in d_o, and (2) whether the design with the largest utility (among the N-n designs) or an arbitrary design among the N-n designs is the design that replaces d^*. Please clarify.</p>
    <p>Line 164: Because you gave an expression for the information matrix associated with the covariance parameters in expression (9), it would be good to give an expression for the information matrix associated with the fixed effect parameters here as well.</p>
    <p>Reviewer #2: Comments for the author have been attached</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
    <supplementary-material content-type="local-data" id="pone.0238422.s004">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Review_PONE-D-19-26876.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0238422.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0238422.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238422.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238422" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">28 Jul 2020</named-content>
    </p>
    <p>Response to reviewers</p>
    <p>Reviewer 1</p>
    <p>The reviewer’s comments were that</p>
    <p>This paper presents a new R statistical computing package called "SSNdesign" for obtaining statistically optimal (according to a range of different criteria) sampling designs on stream networks. As such, it provides a useful tool for scientists who manage freshwater ecosystems. The package takes advantage of recently (within the last 10-15 years) developed methodology for statistically modeling spatially correlated data taken at points on a stream network.</p>
    <p>The paper describes the software package at an appropriate level of detail, and the two case studies are nice and (in my opinion) need no improvement. I do not have expertise on the computational aspects (storage requirements, speed, reliability) of the package so I will limit my comments to those things on which I do have expertise, namely the relevant statistical models and utility functions, as presented in Supplement 1. First, however, here are a few minor comments referring to specific line numbers in the paper itself.</p>
    <p>The reviewer then provides a list of line-by-line corrections for small matters (spelling, grammar, etc.). </p>
    <p>Firstly, in response, we thank Reviewer 1 for their constructive and positive feedback on our manuscript. Secondly, we list our responses/changes below against the line-by-line commentary of the reviewer. The reviewer’s comments are shown in bold font. </p>
    <p>Line 80: Change "pseudo-Baeysian" to "pseudo-Bayesian"</p>
    <p>Done.</p>
    <p>Line 100: Change “Tesselation” to “Tessellation”</p>
    <p>Done.</p>
    <p>Line 200: Change “before” to “then” (so that the sentence reads more smoothly)</p>
    <p>Done.</p>
    <p>Line 279: Delete “based”</p>
    <p>Done.</p>
    <p>Line 298: Delete the period after “distribution”</p>
    <p>Done.</p>
    <p>Line 346: Change “ issolved” to “dissolved”</p>
    <p>Done.</p>
    <p>Now here are some comments on Supplement 1, with references to its line numbers.</p>
    <p>Line 32: Remove the comma between "second-order" and "stationary"</p>
    <p>Done. </p>
    <p>Lines 32-33: It is a bit of an oversimplification to say that the moving average models produce covariance functions that depend on "the separation distance between two locations" because tail-down covariance functions generally are functions of two distances (distance of each location to their common confluence) rather than merely the separation distance between locations. So this sentence needs a minor correction.</p>
    <p>We agree with the reviewer. This now reads </p>
    <p>…they can be described by a mean function that depends on the location within the network, and a second-order stationary covariance function. Traditional covariance functions parameterise the dependence between observations in terms of the Euclidean distance separating two locations, but this is less straightforward in the context of stream networks. Stream network covariance functions and the distance metrics they use may depend on flow connectivity. Details on these covariance functions are provided below.</p>
    <p>Line 34: It is somewhat imprecise to refer to a point at which a function “starts.” What you mean is that the moving average function is nonzero (positive, in fact) only at and upstream from a point. So you should change this sentence by changing “starts at some location and is nonzero only upstream from that location” to “is nonzero only upstream from a location.” Make a similar edit in line 37 when describing the tail-down covariance function.</p>
    <p>Done.</p>
    <p>Line 44: Change "set" to "vector"</p>
    <p>Done.</p>
    <p>Line 67: When two sites are flow-unconnected, a and b, as defined, ALWAYS sum to h (the stream distance between the two sites). Thus, just change this sentence by deleting the phrase "when a+b=h"</p>
    <p>Done.</p>
    <p>Lines 71-78 and expression (5): For consistency with expression (4), use bold type for Y, X, etc.</p>
    <p>We have decided to drop the bold type for Y, X in Expression (4). This makes this expression consistent with the rest of the appendix and the main manuscript, where bold font is not used for Y, X.</p>
    <p>Line 72: Here it should be noted that X is assumed to have full column rank; otherwise, the matrix in parentheses in line 158 is not invertible.</p>
    <p>Done. The sentence now reads “… X is a design matrix with full column rank for the fixed effects”.</p>
    <p>Line 94: Change "join" to "joint"</p>
    <p>Done.</p>
    <p>Line 106: Change "funciton" to "function"</p>
    <p>Done. </p>
    <p>Lines 120-133: As this is written it is unclear (1) what is the "first" site in d_o, and (2) whether the design with the largest utility (among the N-n designs) or an arbitrary design among the N-n designs is the design that replaces d^*. Please clarify.</p>
    <p>In response to (1), the initial randomly-selected design can be thought of as a set of sites d_0={s_1,s_2,s_3,…,s_n}. The “first site” in this design simply refers to s_1 in the set. We agree this could be unclear to a reader. The updated text is given beneath the next paragraph.</p>
    <p>As for (2), the design with the largest utility among the N-n designs replaces d^* if and only if its utility is greater than the utility of d^*. That is, if d^b is the “best” design among the N-n designs evaluated at that iteration of the coordinate exchange algorithm, d^* is replaced by d^b if and only if U(d^b )&gt;U(d^* ). Sometimes U(d^b) does not satisfy this condition because there is no design among the N-n recently evaluated designs that improves on the current best design. We agree this could be unclear to readers so we have updated the text to be:</p>
    <p>In this work, we use a greedy exchange algorithm (Algorithm 2) to locate optimal designs (9,13). The greedy exchange algorithm works by optimising the choice of each of n sites one-by-one. Initially, a random design with n sites is proposed and becomes d_0 = {s_1 ,s_2 ,...,s_n } (the initial design) and d^* (the design which currently has the highest value of U(d)). From this point, we begin the coordinate exchange. Note that there are N - n candidate points not currently in d^*. The first site in d_0 (s_1) is then swapped out for each of the N-n candidate sites. The expected utilities of the resulting designs are recorded. If any designs have an expected utility larger than U(d^* ), the design with the highest expected utility replaces d^*. Then we update our pool of candidate sites, and we begin to exchange the next site. Otherwise, the design reverts to d^* and the next site in the design is exchanged for each candidate site. </p>
    <p>Line 164: Because you gave an expression for the information matrix associated with the covariance parameters in expression (9), it would be good to give an expression for the information matrix associated with the fixed effect parameters here as well.</p>
    <p>We agree with the reviewer here. Thank you for catching this oversight. The expression for I(d,β_gls) is now given in the expanded inline at Line 167.</p>
    <p>Reviewer 2</p>
    <p> Case study 1 </p>
    <p> In this paper, case study one (Lake Eacham) is based on an existing dataset (i.e. Falk 2014 uses this dataset as well) and the underlying methodology used for the study is not new (optimal experimental design was used in Falk 2014 and Som 2014). I think it's important to state this clearly and cite the above-mentioned prior work. </p>
    <p>We agree that we should have more prominently cited and acknowledged these previous works. However, we note the Lake Eacham dataset was originally published on the U.S. Forest Service website ( <ext-link ext-link-type="uri" xlink:href="https://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html">https://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html</ext-link>) as an example data set for the software package STARS (Peterson, 2011):</p>
    <p>Peterson EE (2011). STARS: Spatial Tools for the Analysis of River Systems – A Tutorial. Technical Report EP111313, Commonwealth Scientific Industrial Research Organisation (CSIRO). URL: <ext-link ext-link-type="uri" xlink:href="http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc">http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc</ext-link>.</p>
    <p>We have adjusted the text of the first two paragraphs of Case Study 1 to reflect the origins of the data set and to emphasise the previous work done by Som et al. (2014) and Falk et al. (2014). </p>
    <p> Furthermore, the case study is currently presented like a vignette (an application of the SSNdesign package to real data), but doesn't make clear how it is relevant in demonstrating the contribution of the SSNdesign package. Given that both the dataset and the methodology in this case study were already presented in prior work, the majority of content of the case study is better suited for an R package vignette or as supplementary material. Instead, I think the paper would be better served by giving (i) a more concise overview of the case study using SSNdesign, with emphasis on how the software improves the ability to do such analysis, and (ii) a discussion of how the SSNdesign package better addresses the experimental design problem compared with alternatively available software like spsurvey or geospt. </p>
    <p>Though the reviewer is correct that neither the Lake Eacham dataset nor optimal design problems on stream networks are novel, we must point out that the following elements of the case study differentiate it from previously published examples with these data:</p>
    <p> The CPD-optimality utility function was not used in either Falk et al. (2014) or Som et al. (2014). At best those two papers used the C-optimality and D-optimality utility functions separately. </p>
    <p> Our method of dropping sites one-by-one from the design was not used in Falk et al. (2014). Consequently, the insights we gain from tracking information loss over the successive designs are novel. </p>
    <p>To address the point that the case study reads like a vignette, we would like to first point out that, in some ways, it is meant to do so. This paper documents our R package SSNdesign and showcases its capabilities. We chose the case studies to be of interest to a wide audience of readers and both address common (applied) design challenges that aquatic managers face; noting that novel methods are also presented in Case Study 2. The code used in Som et al. (2014) and Falk et al. (2014) were not made publicly available and, as a result, optimal and adaptive design methods on stream networks have remained inaccessible to the vast majority of potential users over the last six years. Thus, our main purpose is simply to demonstrate how the SSNdesign package simplifies previously complex tasks that required bespoke code to be developed. </p>
    <p>At the same time, we agree with the reviewer that we would benefit shifting the focus of our discussion of Case Study 1. We have edited the discussion of the first case study to highlight the utility of SSNdesign in producing these results, and we have also highlighted the connections between this case study and Falk et al. (2014). </p>
    <p>At Lines 289-290, we have entered:</p>
    <p>In a similar experiment to that of Falk et al. (21), we used optimal experimental design to reduce the number of survey sites by half, …</p>
    <p>At Lines 344-352, we have added the following paragraph of discussion:</p>
    <p>The findings from this case study fit inside the framework established by Falk et al. (21) and Som et al. (20), and broadly agree with their findings. However, for us, SSNdesign streamlined the process of discovering these results. The same code sufficed for both the CPD- and K-optimality experiments, with only a few lines’ difference to account for the change in utility function (S2 Appendix). If required, we could easily have changed the covariance function underpinning the spatial relationships in the Lake Eacham network or the priors on the covariance parameters. SSNdesign will enable aquatic scientists and statisticians to construct designs for their own monitoring programs or make decisions about them with ease. Bespoke code will no longer be required, expanding access to the sophisticated methodologies of optimal and adaptive design.</p>
    <p>Case study 2 </p>
    <p> Case study two (Pine River) is a new dataset (synthetically simulated) and the underlying methodology used for the study is new (the authors state that adaptive experimental design problems have not been used under the SSNM framework). This is a case study that supports the motivations of this paper. </p>
    <p>Yes, thank you.</p>
    <p>In my experience, this R package will be an invaluable tool to researchers and managers in the freshwater monitoring field. I recommend this manuscript be published pending minor revisions. I look forward to reading a revised version of the manuscript.</p>
    <p>Thank you for your insightful and positive feedback! </p>
    <p>Abstract Line 17 “and so effective and efficient survey designs…”: delete “and” (double conjunction).</p>
    <p>Done.</p>
    <p>Abstract Lines 21 - 23 “Thus, unique challenges of geostatistics and…”: This sentence doesn’t feel supported by the sentences which precede it. This sentence suggests that the unique challenges of geostatistics on stream networks motivated the development of SSNdesign. But, it would be more accurate to say that these challenges motivate the development of the methodology implemented in SSNdesign. A better motivation for an R package like SSNdesign would be the lack of available software that provides access to, or application of, these methods. For example, a sentence summarizing the lack experimental design R packages which account for the unique SSN structure would be stronger motivation (i.e. see 5th paragraph, lines 94 - 109 of the introduction).</p>
    <p>We agree with the reviewer’s assessment. We have therefore modified this part of the abstract to read:</p>
    <p>Geostatistical models for stream network data and their unique features already exist. Some basic theory for experimental design in stream environments has also previously been described. However, open source software that makes these design methods available for aquatic scientists does not yet exist. To address this need, we present SSNdesign, ...</p>
    <p>Lines 58 - 61: Here the authors have demonstrated the increased use of SSNMs in the literature. The end of this paragraph would be a good place to cite other papers which empirically looked at experimental design utilizing SSNMs. I think it would strengthen the paper’s motivation and further highlight the research needs of an R package which tackles these questions. For example Marsha et al, 2018, Monitoring riverine thermal regimes on stream networks: Insights into spatial sampling design from the Snoqualmie River, WA, Ecological Indicators 84: 11-26. Some of the takeaways from these papers align with those learned from the case studies you have included.</p>
    <p>We agree with the reviewer on this point. Being able to point to specific studies focussing on experimental design on stream networks would indeed strengthen our case studies. Thank you for pointing us to this useful reference. We have incorporated and cited this paper on Lines 61 - 62:</p>
    <p>see, for example, Isaak et al. (11) and Marsha et al. (12), both of whom model thermal regimes in streams. Marsha et al. (12) further consider questions of site placement and sample size based on their data.</p>
    <p>Line 67 “Utility functions are mathematical…”: This sentence feels out of place here. Suggest moving it to line 70 before “A variety of utility functions are available…”</p>
    <p>We agree that this sentence reads a bit awkwardly, but we also thought carefully about where to introduce this concept. We believe it is important to keep it in place because it defines what utility functions are in general before the following sentence, which is about differing design objectives affecting the spatial distribution of samples. </p>
    <p>Line 81 “which measure the suitability of an experimental design for some purpose”: The authors already defined a utility function in the previous paragraph. I suggest deleting this and continue with “often depend on…”</p>
    <p>Done.</p>
    <p>Line 87 “In this paper and in SSNdesign…”: Upon first reading I don’t understand the separation between “this paper” and “SSNdesign.” By this paper do you mean application to the case studies? Perhaps make this clearer.</p>
    <p>On further reflection, we agree with the reviewer that this is confusing. In fact, separating the two is unnecessary. Therefore, we have cut out the reference to the paper and now the sentence reads “In SSNdesign, we use the pseudo-Bayesian approach.”</p>
    <p>Figure 1: </p>
    <p> It is not clear where the reader should be starting with this flowchart. My experience with using SSNMs in R indicate to me how to interpret this flowchart, but I can see how a reader who is new to working with SSNMs in R could be confused. A flow chart which is left justified (or column aligned) and which then flows in parallel would be clearer (like Figure 2). </p>
    <p>Thank you for this feedback. We agree the intended reading of the flowchart is not clear. We also agree with your suggestions on how to improve it. Please see the response to your comment below on specifically how we went about this.</p>
    <p> When interpreting this flowchart it is not clear if the two “.ssn folder” objects are the same object fundamentally. If they are, then the reader wonders why one is required to be run through the importSSN function before SimulateOnSSN, while the other can go straight to SimulateOnSSN. My interpretation is that the bottom path “createSSN → .ssn folder → SimulateOnSSN” represents a continued R session (the scenario where the user starts with nothing); while the other path represents a new R session where the user starts with a “.ssn folder” object. If this interpretation is correct, I would suggest splitting this figure into two sections (one right and one left; or one top and one bottom) illustrating the two scenarios. </p>
    <p>Again, thank you for this feedback. To clarify, </p>
    <p> The 2x “.ssn folder” do not refer to the same object, just to a data structure that the two workflows have in common. (i.e. both use .ssn folders to store the stream network data.) </p>
    <p> The “.ssn folder” appearing in the top workflow refers to a pre-existing dataset where the user has, at a minimum, a set of stream edges in a shapefile. From here, if the user has no observed data in a sites shapefile, then they can simulate observed and prediction locations using generateSites. Once the observed and prediction locations have been generated, the user may then simulate observed response values on those sites using SimulateOnSSN. Alternatively, if the user has a .ssn folder that already contains an observed sites and prediction locations shapefile(s), then they can go straight to simulating response values if necessary.</p>
    <p> The “createSSN -&gt; “.ssn folder” -&gt; SimulateOnSSN” refers to a situation where the user has no data for a stream network. That is, they must artificially generate all parts of the stream dataset including the stream edges and sites. The createSSN function is responsible for creating a new .ssn folder that contains the completely simulated stream network. These data are then passed on to the SimulateOnSSN function to provide simulated response values for the simulated survey sites.</p>
    <p>We have updated Figure 1, incorporating your suggestions for improving readability. Specifically, we have disentangled each of the three cases from one another. There are now three rectangles stacked vertically, each one representing a different scenario (i.e. whether you have stream edges and survey data, just stream edges, or no GIS or survey data at all). We believe the new Figure 1 is a vast improvement on the original. </p>
    <p>The Expected utility estimation and maximisation section: In general these two paragraphs are concise and very well explained. </p>
    <p>Thank you!</p>
    <p>The Utility functions for optimal and adaptive experimental designs section: </p>
    <p> Reading about the adaptive design technique in SSNdesign, I see that maximizing U(d | d0:t-1, y0:t-1) depends upon d0 (an initial model design). This naturally makes the reader wonder the sensitivity of the initial model chosen. Did the authors look at how the choice of d0 affects future iterations, or even the final outcome, in their adaptive design? Or are there any other studies that looked at this that can be cited? </p>
    <p>This is an insightful question. The choice of d0 will affect design choices in future iterations. This is because initially, prior information about the model parameters is formed based on d0. If this is vague, then it is likely that the iteratively chosen designs will become more informative as we become more certain about the parameter values. In contrast, if the prior information is initially quite informative, then the iteratively chosen designs should start out being relatively informative. The effect that the choice of d0 has on subsequent designs was not formally investigated via simulation as typically (at least in the stream modelling scenarios we have encountered) d0 will be quite uninformative, particularly for covariance parameters. Indeed, this really motivates the need to adopt adaptive design methods as, if the parameters are well estimated based on d0, then static (non-adaptive) design approaches would probably be suitable.</p>
    <p> I see where the authors explicitly discuss solving adaptive design problems (paragraph 2), but where are optimal design problems discussed in this section? </p>
    <p>The main purpose of this section is to provide concise definitions of all the utility functions that we have included in SSNdesign. The main focus of this section is Table 1 where we write out the equations for the utility functions; describe their arguments; and their intended use-cases (e.g. for selecting covariance/fixed effects parameters, or for minimising the average kriging standard errors across prediction sites). However, detailed discussions of both the optimal and adaptive design procedures are actually provided elsewhere (see the section entitled “Expected utility estimation and maximisation”, as well as the S1 Appendix). We explicitly discuss the myopic design approach in paragraph 2 of this section (while also pointing readers to the relevant sections and algorithms in the S1 Appendix for more detailed information) because it is critical information for understanding the utility functions we have included in the package for adaptive design. Utility functions for myopic designs look different to those used in backward induction. Therefore, we believe this brief discussion of the myopic design approach is necessary here. </p>
    <p>Line 195 “Space-filling designs are designs which…”: delete “are designs which, ideally” so it reads “Space-filling designs contain roughly…” </p>
    <p>Done.</p>
    <p>Line 201 “Here we used an algorithm…”: change “used” to “use” </p>
    <p>Done.</p>
    <p>Line 219 “Users may also define…”: change to “Users may also define their own utility functions since the optimiseSSNDesign function has the flexibility to…” It doesn’t make sense to use a function to define another function.</p>
    <p>Done.</p>
    <p>Line 258 “Field data collection can be expensive and so existing…”: delete “and” (double conjunction). </p>
    <p>Done.</p>
    <p>Lines 271 - 275: Just a formatting note to capitalize “Identify” and “Set” as the beginning of each list point. </p>
    <p>Done.</p>
    <p>Line 274 “Set priors that specify what the…”: I suggest changing this sentence as follows, “Set priors that specify the likely relationship between covariates and the response based on expert opinion and/or a literature review.” This feels more concise and clear. </p>
    <p>Done, but we have added “previously collected data” so that the sentence reads:</p>
    <p>Set priors that specify the likely relationship between covariates and the response based on previously collected data, expert opinion and/or a literature review.</p>
    <p>Line 281: This is a previously published dataset that should be cited. </p>
    <p>Yes, we have now cited it correctly as</p>
    <p>Peterson EE (2011). STARS: Spatial Tools for the Analysis of River Systems – A Tutorial. Technical Report EP111313, Commonwealth Scientific Industrial Research Organisation (CSIRO). URL: <ext-link ext-link-type="uri" xlink:href="http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc">http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc</ext-link>.</p>
    <p>Figure 4: This is a good figure which effectively illustrates the author’s conclusions from case study 1. </p>
    <p>Thank you! </p>
    <p> I suggest the two plots use the same y-axis scale (0.0 – 1.0). It could be misleading to the reader otherwise. </p>
    <p>Yes, we have done this for the updated version of Figure 4. However, we have expanded the number of panels to four. The reasons for this are partially explored below and further explained in our response to the reviewer’s next point. </p>
    <p>The updated plot now looks like this:</p>
    <p>The following outlines how this figure works:</p>
    <p> Panels (a) and (d) are the panels (a) and (b) respectively from the original Figure 4. </p>
    <p> Panels (a) and (b) in this version have their y-axes scaled to 0.0-1.0. The fact that both plots have the same axis scales means that it is possible to make direct comparisons of the two plots side-by-side. </p>
    <p> Panels (c) and (d) are zoomed into the regions of the y-axes that allow the variability in the GRTS and random designs to be more clearly displayed. The total range of the y-axis is the same for both panels (0.3) but panel (c) shows the region of the plot with the y-axis fixed between 0.0-0.3 whereas panel (d) has its y-axis fixed between 0.7-1.0. </p>
    <p> The feature in this figure that stands out to me the most is the lack of variability in efficiency under the GRTS designs using the CPD-optimal utility function (a) and the larger variability under the GRTS designs using the K-optimal utility function (b). Do the authors have any ideas about why that would be?</p>
    <p>The problem that the reviewer has described here is an artifact of the inconsistent y-axis scales in the original Figure 4. The efficiencies of GRTS designs exhibit similar levels of variability under the CPD- and K-optimality utility functions. As it is now clear from panel (c) in the updated Figure 4, the GRTS designs under CPD-optimality exhibit efficiencies approximately in the range of 0.03-0.09 (total range = 0.06). Similarly, under K-optimality, the GRTS designs have efficiencies between 0.90-0.96 (total range = 0.06). We believe our updated Figure 4 no longer risks misleading readers in this way. </p>
    <p>Line 382 “Compared to other packages…”: change to “Compared with other packages…” Typical convention is that “compared to” is used for discussing similarities between fundamentally different objects while “compared with” is for discussing differences between two fundamentally similar objects. </p>
    <p>Done.</p>
    <p>References</p>
    <p>Falk MG, McGree JM, Pettitt AN. Sampling designs on stream networks using the pseudo-bayesian approach. Environmental and Ecological Statistics. 2014;21:751–73.</p>
    <p>Peterson EE (2011). STARS: Spatial Tools for the Analysis of River Systems – A Tutorial. Technical Report EP111313, Commonwealth Scientific Industrial Research Organisation (CSIRO). URL: <ext-link ext-link-type="uri" xlink:href="http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc">http://www.fs.fed.us/rm/boise/AWAE/projects/SSN_STARS/software_data.html#doc</ext-link>.</p>
    <p>Som NA, Monestiez P, Ver Hoef JM, Zimmerman DL, Peterson EE. Spatial sampling on streams: Principles for inference on aquatic networks. Environmetrics. 2014;25(5):306–23.</p>
    <supplementary-material content-type="local-data" id="pone.0238422.s005">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0238422.s005.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0238422.r003" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238422.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bryhn</surname>
          <given-names>Andreas C.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Andreas C. Bryhn</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Andreas C. Bryhn</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238422" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Aug 2020</named-content>
    </p>
    <p>SSNdesign – an R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks</p>
    <p>PONE-D-19-26876R1</p>
    <p>Dear Dr. Pearse,</p>
    <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
    <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
    <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="http://www.editorialmanager.com/pone/">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>Kind regards,</p>
    <p>Andreas C. Bryhn</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
  </body>
</sub-article>
<sub-article id="pone.0238422.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0238422.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bryhn</surname>
          <given-names>Andreas C.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Andreas C. Bryhn</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Andreas C. Bryhn</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0238422" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Aug 2020</named-content>
    </p>
    <p>PONE-D-19-26876R1 </p>
    <p>SSNdesign – an R package for pseudo-Bayesian optimal and adaptive sampling designs on stream networks </p>
    <p>Dear Dr. Pearse:</p>
    <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
    <p>Kind regards, </p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Andreas C. Bryhn </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
