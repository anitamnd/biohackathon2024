<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9883715</article-id>
    <article-id pub-id-type="pmid">31504159</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz647</article-id>
    <article-id pub-id-type="publisher-id">btz647</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">NACHO:</italic> an R package for quality control of NanoString nCounter data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3396-4549</contrib-id>
        <name>
          <surname>Canouil</surname>
          <given-names>Mickaël</given-names>
        </name>
        <aff><institution>Université de Lille, CNRS, Institut Pasteur de Lille</institution>, UMR 8199 - EGID, F-59000 Lille, <country country="FR">France</country></aff>
        <xref rid="btz647-FM1" ref-type="author-notes"/>
        <xref rid="btz647-cor1" ref-type="corresp"/>
        <!--mickael.canouil@cnrs.fr-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bouland</surname>
          <given-names>Gerard A</given-names>
        </name>
        <aff><institution>Department of Cell and Chemical Biology, Leiden University Medical Center</institution>, 2333 ZC Leiden, <country country="NL">The Netherlands</country></aff>
        <xref rid="btz647-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonnefond</surname>
          <given-names>Amélie</given-names>
        </name>
        <aff><institution>Université de Lille, CNRS, Institut Pasteur de Lille</institution>, UMR 8199 - EGID, F-59000 Lille, <country country="FR">France</country></aff>
        <aff><institution>Department of Medicine, Section of Genomics of Common Disease, Imperial College London</institution>, London SW7 2AZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Froguel</surname>
          <given-names>Philippe</given-names>
        </name>
        <aff><institution>Université de Lille, CNRS, Institut Pasteur de Lille</institution>, UMR 8199 - EGID, F-59000 Lille, <country country="FR">France</country></aff>
        <aff><institution>Department of Medicine, Section of Genomics of Common Disease, Imperial College London</institution>, London SW7 2AZ, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>’t Hart</surname>
          <given-names>Leen M</given-names>
        </name>
        <aff><institution>Department of Cell and Chemical Biology, Leiden University Medical Center</institution>, 2333 ZC Leiden, <country country="NL">The Netherlands</country></aff>
        <aff><institution>Department of Epidemiology and Biostatistics, Amsterdam Public Health Institute, Amsterdam UMC, VU University Medical Center</institution>, Amsterdam 1081 HV, <country country="NL">The Netherlands</country></aff>
        <aff><institution>Molecular Epidemiology Section, Department of Biomedical Data Sciences, Leiden University Medical Center</institution>, Leiden 2333 ZC, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0961-9152</contrib-id>
        <name>
          <surname>Slieker</surname>
          <given-names>Roderick C</given-names>
        </name>
        <aff><institution>Department of Cell and Chemical Biology, Leiden University Medical Center</institution>, 2333 ZC Leiden, <country country="NL">The Netherlands</country></aff>
        <aff><institution>Department of Epidemiology and Biostatistics, Amsterdam Public Health Institute, Amsterdam UMC, VU University Medical Center</institution>, Amsterdam 1081 HV, <country country="NL">The Netherlands</country></aff>
        <xref rid="btz647-cor1" ref-type="corresp"/>
        <!--r.c.slieker@lumc.nl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btz647-FM1">
        <p>Mickaël Canouil and Gerard A. Bouland wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btz647-cor1">To whom correspondence should be addressed. <email>mickael.canouil@cnrs.fr</email> or <email>r.c.slieker@lumc.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date iso-8601-date="2019-08-23" pub-type="epub">
      <day>23</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <volume>36</volume>
    <issue>3</issue>
    <fpage>970</fpage>
    <lpage>971</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bioinformatics_36_3_970.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The NanoString<sup>TM</sup> nCounter<sup>®</sup> is a platform for the targeted quantification of expression data in biofluids and tissues. While software by the manufacturer is available in addition to third parties packages, they do not provide a complete quality control (QC) pipeline. Here, we present NACHO (‘NAnostring quality Control dasHbOard’), a comprehensive QC R-package. The package consists of three subsequent steps: summarize, visualize and normalize. The summarize function collects all the relevant data and stores it in a tidy format, the visualize function initiates a dashboard with plots of the relevant QC outcomes. It contains QC metrics that are measured by default by the manufacturer, but also calculates other insightful measures, including the scaling factors that are needed in the normalization step. In this normalization step, different normalization methods can be chosen to optimally preprocess data. Together, <italic toggle="yes">NACHO</italic> is a comprehensive method that optimizes insight and preprocessing of nCounter<sup>®</sup> data.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">NACHO</italic> is available as an R-package on CRAN and the development version on GitHub <ext-link xlink:href="https://github.com/mcanouil/NACHO" ext-link-type="uri">https://github.com/mcanouil/NACHO</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>Innovative Medicines Initiative 2 Joint Undertaking</institution>
        </funding-source>
        <award-id>115881</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>RHAPSODY</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>European Union: Centre National de la Recherche Scientifique</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>Université de Lille, Institut Pasteur de Lille</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>European Genomics Institute for Diabetes</institution>
        </funding-source>
        <award-id>ANR-10-LABX-46</award-id>
        <award-id>ANR-10-EQPX-07-01</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="doi">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GEPIDIAB-294785</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The NanoString<sup>TM</sup> nCounter<sup>®</sup> platform enables the quantification of expression data in biofluids and tissues with prebuild panels (e.g. miRNA panel). Before any data can be analyzed and interpreted, data has to undergo quality control (QC) to identify poor measurements, samples and perform adequate normalization. The manufacturer’s software nSolver<sup>TM</sup> contains basic normalization and correction methods but lacks flexibility for data visualization. Other NanoString<sup>TM</sup> quality-control solutions such as NanoStringDiff (<xref rid="btz647-B7" ref-type="bibr">Wang, 2016</xref>) or NanoStringNorm (<xref rid="btz647-B6" ref-type="bibr">Waggott, 2012</xref>) also lack insightful graphical representations. To address the lack of a complete, visual QC and normalization pipeline, we developed an R package that we called <italic toggle="yes">NACHO</italic> (‘NAnostring quality Control dasHbOard’). It allows the user to systematically perform QC on miRNA, CodeSet or PlexSet panels from NanoString<sup>TM</sup> nCounter<sup>®</sup> platform.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p><italic toggle="yes">NACHO</italic> consists of three subsequent quality steps, <italic toggle="yes">1.summarize</italic>, <italic toggle="yes">2.visualize</italic> and <italic toggle="yes">3.normalize</italic>.</p>
    <p><bold>1. summarize</bold> A typical analysis of nCounter<sup>®</sup> starts with parsing of the raw data from RCC files and pre-processing to obtain quality metrics. The arguments that need to be given are the directory of the data, the samplesheet path, the column within the sample sheet that represents the file names and which housekeeping genes to use. For the latter, one can use all default housekeeping genes, provide a subset of the default housekeeping genes or identify custom housekeeping genes (<xref rid="btz647-B2" ref-type="bibr">Mestdagh, 2009</xref>).</p>
    <p><bold>2. visualize</bold> Next, one can assess the quality of the data on an interactive web application based on Rstudio’s <italic toggle="yes">shiny</italic> and <italic toggle="yes">ggplot2</italic> (<xref rid="btz647-B8" ref-type="bibr">Wickham, 2016</xref>) using the <italic toggle="yes">visualize</italic> function. The web application is initiated with the visualize function that only requires the object generated with the summarize function. The web application dashboard consists of six tabs (<xref rid="btz647-F1" ref-type="fig">Fig. 1</xref>) <italic toggle="yes">QC Metrics</italic>, <italic toggle="yes">Control Genes</italic>, <italic toggle="yes">QC Visuals</italic>, <italic toggle="yes">Normalization Factors</italic>, <italic toggle="yes">Outlier table</italic> and <italic toggle="yes">About</italic>. Under the <italic toggle="yes">QC Metrics</italic> tab four metrics are shown, <italic toggle="yes">Binding Density</italic>, <italic toggle="yes">Imaging</italic>, <italic toggle="yes">Positive Control Linearity</italic> and <italic toggle="yes">Limit of Detection</italic> (also see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Binding density is the number of optical features per square micron. Imaging or Field of View is a metric that indicates how many sections of a lane are successfully processed. Positive control linearity is the Pearson’s correlation coefficient of the observed counts against the known positive control concentrations. Finally, limit of detection reflects the lower boundary of the detection spectrum.
</p>
    <fig position="float" id="btz647-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Screenshot of the dashboard of the <italic toggle="yes">NACHO</italic> interface. Data used are miRNA levels of individuals with nasopharyngeal carcinoma (<xref rid="btz647-B1" ref-type="bibr">Bruce, 2015</xref>). Figure shows the binding density against the average counts colored by Cartridge ID</p>
      </caption>
      <graphic xlink:href="bioinformatics_36_3_970_f1" position="float"/>
    </fig>
    <p>To further provide insight into the quality of the spike-in control probes, on the Control Genes tab plots are shown of the counts against the known concentrations of the positive control probes, the negative control probes, the predicted or default housekeeping genes (e.g. <italic toggle="yes">ACTB</italic>, <italic toggle="yes">B2M</italic>, <italic toggle="yes">GAPDH</italic>, <italic toggle="yes">RPL19</italic>, <italic toggle="yes">RPLP0</italic>).</p>
    <p>The <italic toggle="yes">QC Visuals</italic> tab is subdivided in three sub tabs: <italic toggle="yes">Average Counts</italic> versus <italic toggle="yes">Binding Density</italic>, <italic toggle="yes">Average Counts</italic> versus <italic toggle="yes">Median Counts</italic> and <italic toggle="yes">Principal Components</italic>. The first two sub tabs are mainly focused on providing overall insight of the data. The usefulness hereof is illustrated using the public miRNA data of individuals with nasopharyngeal carcinoma (GEO, <italic toggle="yes">GSE70970</italic>), where two distinct groups of individuals are observed (<xref rid="btz647-F1" ref-type="fig">Fig. 1</xref>). Of note, these two groups were analyzed separately in the original manuscript (<xref rid="btz647-B1" ref-type="bibr">Bruce, 2015</xref>). On the last tab of the QC Visuals, principal components of the data can be plotted against an outcome of interest.</p>
    <p><bold>3. normalize</bold> In the last step of the QC of nCounter<sup>®</sup> data, outliers are removed and the data is normalized. The effect of normalization on the data and the outliers can be found on the <italic toggle="yes">Normalization Factors</italic>—and the <italic toggle="yes">Outliers</italic> tab. Different methods are implemented in <italic toggle="yes">NACHO</italic>. For the housekeeping genes, the default genes or predicted housekeeping genes can be used (<xref rid="btz647-B2" ref-type="bibr">Mestdagh, 2009</xref>; <xref rid="btz647-B5" ref-type="bibr">Vandesompele, 2002</xref>). The normalization based on the positive control spike-ins can be done based on either the geometric mean (<xref rid="btz647-B4" ref-type="bibr">NanoString, 2018</xref>) or using a general linearized model (<xref rid="btz647-B7" ref-type="bibr">Wang, 2016</xref>). The raw counts, normalization factors, normalized counts and settings used are returned to the user as a list.</p>
  </sec>
  <sec>
    <title>3 Conclusion and future prospects</title>
    <p>The <italic toggle="yes">NACHO</italic> package is a complete pipeline to process nCounter<sup>®</sup> data by providing insight in the data quality, removal of poor samples and normalization of the data. In future versions of <italic toggle="yes">NACHO</italic>, new normalization methods will be added including a recently published normalization method (<xref rid="btz647-B3" ref-type="bibr">Molania, 2019</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study was supported by grants from the Innovative Medicines Initiative 2 Joint Undertaking under grant agreement No 115881 (RHAPSODY). This Joint Undertaking receives support from the European Union’s Horizon 2020 research and innovation programme and EFPIA. This work is supported by the Swiss State Secretariat for Education, Research and Innovation (SERI) under contract number 16.0097-2. The opinions expressed and arguments employed herein do not necessarily reflect the official views of these funding bodies. This study was supported by grants for funding of scientific research conducted in France and within the European Union: Centre National de la Recherche Scientifique, Université de Lille, Institut Pasteur de Lille, Contrat de Plan Etat-Région, Agence Nationale de la Recherche, ‘Fédération de Recherche’ 3508 Labex EGID (European Genomics Institute for Diabetes; ANR-10-LABX-46), ANR EQUIPEX LIGAN-MP (ANR-10-EQPX-07-01), European Research Council GEPIDIAB-294785.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btz647_Supplementary_Data</label>
      <media xlink:href="bioinformatics_36_3_970_s2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz647-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bruce</surname>
 <given-names>J.P.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Identification of a microRNA signature associated with risk of distant metastasis in nasopharyngeal carcinoma</article-title>. <source>Oncotarget</source>, <volume>6</volume>, <fpage>4537</fpage>–<lpage>4550</lpage>.<pub-id pub-id-type="pmid">25738365</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mestdagh</surname>
 <given-names>P.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>A novel and universal method for microRNA RT-qPCR data normalization</article-title>. <source>Genome Biol</source>., <volume>10</volume>, <fpage>R64</fpage>.<pub-id pub-id-type="pmid">19531210</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molania</surname>
 <given-names>R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>A new normalization for Nanostring nCounter gene expression data</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>6073</fpage>–<lpage>6083</lpage>.<pub-id pub-id-type="pmid">31114909</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B4">
      <mixed-citation publication-type="other">NanoString (<year>2018</year>) <italic toggle="yes">Analysis Software User Manual nSolver 4.0</italic>. NanoString Technologies, Inc., Seattle, USA.</mixed-citation>
    </ref>
    <ref id="btz647-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vandesompele</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2002</year>) 
<article-title>Accurate normalization of real-time quantitative RT-PCR data by geometric averaging of multiple internal control genes</article-title>. <source>Genome Biol</source>., <volume>3</volume>, <fpage>research0034.1</fpage>.<pub-id pub-id-type="pmid">12184808</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waggott</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2012</year>) 
<article-title>NanoStringNorm: an extensible R package for the pre-processing of NanoString mRNA and miRNA data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1546</fpage>–<lpage>1548</lpage>.<pub-id pub-id-type="pmid">22513995</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>NanoStringDiff: a novel statistical method for differential expression analysis based on NanoString nCounter data</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>e151</fpage>.<pub-id pub-id-type="pmid">27471031</pub-id></mixed-citation>
    </ref>
    <ref id="btz647-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname>
 <given-names>H.</given-names></string-name></person-group> (<year>2016</year>) <source>ggplot2: Elegant Graphics for Data Analysis</source>. 
<publisher-name>Springer</publisher-name>, New York.</mixed-citation>
    </ref>
  </ref-list>
</back>
