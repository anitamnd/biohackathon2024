<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">mSphere</journal-id>
    <journal-id journal-id-type="iso-abbrev">mSphere</journal-id>
    <journal-id journal-id-type="hwp">msph</journal-id>
    <journal-id journal-id-type="pmc">msph</journal-id>
    <journal-id journal-id-type="publisher-id">mSphere</journal-id>
    <journal-title-group>
      <journal-title>mSphere</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2379-5042</issn>
    <publisher>
      <publisher-name>American Society for Microbiology</publisher-name>
      <publisher-loc>1752 N St., N.W., Washington, DC</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6315083</article-id>
    <article-id pub-id-type="publisher-id">mSphere00676-18</article-id>
    <article-id pub-id-type="doi">10.1128/mSphere.00676-18</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="overline">
        <subject>Applied and Environmental Science</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Image-Processing Software for High-Throughput Quantification of Colony Luminescence</article-title>
      <alt-title alt-title-type="running-head">Colony Luminescence Image-Processing Software</alt-title>
      <alt-title alt-title-type="short-authors">Dafni et al.</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dafni</surname>
          <given-names>Eyal</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9554-346X</contrib-id>
        <name>
          <surname>Weiner</surname>
          <given-names>Iddo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="no">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9929-7622</contrib-id>
        <name>
          <surname>Shahar</surname>
          <given-names>Noam</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="no">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4194-7068</contrib-id>
        <name>
          <surname>Tuller</surname>
          <given-names>Tamir</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>b</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>c</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="no">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0177-0624</contrib-id>
        <name>
          <surname>Yacoby</surname>
          <given-names>Iftach</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>a</sup>
        </xref>
      </contrib>
      <aff id="aff1">
        <label>a</label>
        <addr-line>School of Plant Sciences and Food Security, The George S. Wise Faculty of Life Sciences, Tel Aviv University, Tel Aviv, Israel</addr-line>
      </aff>
      <aff id="aff2">
        <label>b</label>
        <addr-line>Department of Biomedical Engineering, The Iby and Aladar Fleischman Faculty of Engineering, Tel Aviv University, Tel Aviv, Israel</addr-line>
      </aff>
      <aff id="aff3">
        <label>c</label>
        <addr-line>The Sagol School of Neuroscience, Tel Aviv University, Tel Aviv, Israel</addr-line>
      </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ellermeier</surname>
          <given-names>Craig D.</given-names>
        </name>
        <role>Editor</role>
        <aff>University of Iowa</aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Address correspondence to Tamir Tuller, <email>tamirtul@post.tau.ac.il</email>, or Iftach Yacoby, <email>iftachy@tau.ac.il</email>.</corresp>
      <fn fn-type="equal">
        <p>E.D. and I.W. contributed equally to this article.</p>
      </fn>
      <fn fn-type="other">
        <p><bold>Citation</bold> Dafni E, Weiner I, Shahar N, Tuller T, Yacoby I. 2019. Image-processing software for high-throughput quantification of colony luminescence. mSphere 4:e00676-18. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/mSphere.00676-18">https://doi.org/10.1128/mSphere.00676-18</ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <season>Jan-Feb</season>
      <year>2019</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>e00676-18</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Dafni et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Dafni et al.</copyright-holder>
      <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="sph001192734001.pdf"/>
    <abstract abstract-type="precis">
      <p>Luminescent markers are widely used as reporters for various biologically interesting traits. In colony luminescence assays, the levels of luminescence around each colony can be used to compare the levels of traits of interest for different strains, treatments, etc., using quantitative measurements of the luminescence. However, automatic methods of obtaining this data are underdeveloped, making this a laborious manual process, especially in analyzing large numbers of colonies. The significance of this work is in developing an automatic, high-throughput tool for quantitative analysis of colony luminescence assays, which will allow fast collection of qualitative data from these assays and thus increase their overall usability.</p>
    </abstract>
    <abstract>
      <title>ABSTRACT</title>
      <p>Many microbiological assays include colonies that produce a luminescent or fluorescent (here generalized as “luminescent”) signal, often in the form of luminescent halos around the colonies. These signals are used as reporters for a trait of interest; therefore, exact measurements of the luminescence are often desired. However, there is currently a lack of high-throughput methods for analyzing these assays, as common automatic image analysis tools are unsuitable for identifying these halos in the presence of the inherent biological noise. In this work, we have developed CFQuant—automatic, high-throughput software for the analysis of images from colony luminescence assays. CFQuant overcomes the problems of automatic identification by relying on the luminescence halo's expected shape and provides measurements of several features of the colonies and halos. We examined the performance of CFQuant using one such colony luminescence assay, where we achieved a high correlation (<italic>R</italic> = 0.85) between the measurements of CFQuant and known protein expression levels. This demonstrates CFQuant's potential as a fast and reliable tool for analysis of colony luminescence assays.</p>
      <p><bold>IMPORTANCE</bold> Luminescent markers are widely used as reporters for various biologically interesting traits. In colony luminescence assays, the levels of luminescence around each colony can be used to compare the levels of traits of interest for different strains, treatments, etc., using quantitative measurements of the luminescence. However, automatic methods of obtaining this data are underdeveloped, making this a laborious manual process, especially in analyzing large numbers of colonies. The significance of this work is in developing an automatic, high-throughput tool for quantitative analysis of colony luminescence assays, which will allow fast collection of qualitative data from these assays and thus increase their overall usability.</p>
    </abstract>
    <kwd-group>
      <title>KEYWORDS</title>
      <kwd>fluorescent-image analysis</kwd>
      <kwd>microbial method</kwd>
      <kwd>software</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="award1">
        <funding-source>
          <institution-wrap>
            <institution>United States-Israel Binational Science Foundation (BSF)</institution>
            <institution-id>https://doi.org/10.13039/501100001742</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2016666</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yacoby</surname>
            <given-names>Iftach</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award2">
        <funding-source>
          <institution-wrap>
            <institution>Israel Science Foundation (ISF)</institution>
            <institution-id>https://doi.org/10.13039/501100003977</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1646/16</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yacoby</surname>
            <given-names>Iftach</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award3">
        <funding-source>
          <institution-wrap>
            <institution>Israel Science Foundation (ISF)</institution>
            <institution-id>https://doi.org/10.13039/501100003977</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2185/17</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yacoby</surname>
            <given-names>Iftach</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <counts>
      <count count="3" count-type="supplementary-material"/>
      <fig-count count="3"/>
      <table-count count="0"/>
      <equation-count count="9"/>
      <ref-count count="30"/>
      <page-count count="11"/>
      <word-count count="8134"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>January/February 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>INTRODUCTION</title>
    <p>Luminescent and fluorescent reporters (here generalized as “luminescent” reporters [<xref rid="B1" ref-type="bibr">1</xref>]) are widely used in all fields of biological research (<xref rid="B2" ref-type="bibr">2</xref><xref ref-type="bibr" rid="B3">–</xref><xref rid="B5" ref-type="bibr">5</xref>). As research progresses, the scale of experiments is growing and the need for high-throughput quantitative analyses from a large set of luminescence-based assays is rising accordingly (<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>The analysis of colony luminescence is a major step in various assays; in such setups, colonies typically express a luminescent marker (e.g., green fluorescent protein [GFP], luciferase, mCherry, etc.) which is used to verify transformation (<xref rid="B7" ref-type="bibr">7</xref><xref ref-type="bibr" rid="B8">–</xref><xref rid="B9" ref-type="bibr">9</xref>), report on gene expression (<xref rid="B10" ref-type="bibr">10</xref><xref ref-type="bibr" rid="B11">–</xref><xref rid="B13" ref-type="bibr">13</xref>), report on cellular localization (<xref rid="B14" ref-type="bibr">14</xref><xref ref-type="bibr" rid="B15">–</xref><xref rid="B16" ref-type="bibr">16</xref>), indicate binding between entities (<xref rid="B17" ref-type="bibr">17</xref><xref ref-type="bibr" rid="B18">–</xref><xref rid="B19" ref-type="bibr">19</xref>), or monitor growth rates (<xref rid="B20" ref-type="bibr">20</xref><xref ref-type="bibr" rid="B21">–</xref><xref rid="B22" ref-type="bibr">22</xref>) or for any other purpose. In these types of assays, the output usually consists of a pair of images: (i) an image displaying the plated microbe or cell colonies and (ii) an image of the same plate taken with a relevant camera and exhibiting various levels of colony luminescence. The typical task is that of quantifying the probed trait from the luminescence image while normalizing the signal by the size of the colonies, as deduced from the first image.</p>
    <p>Current technologies for large-scale accurate quantification of these images are underdeveloped. The reason for this gap in relevant analysis tools lies in the inherent noise of these biological assays. While a theoretical plate (<xref ref-type="fig" rid="fig1">Fig. 1A</xref>) could be analyzed with common image-processing tools (e.g., the ImageJ [<xref rid="B23" ref-type="bibr">23</xref>] user interface or similar tools), images obtained from real experiments contain artifacts which hinder the ability of general image-processing algorithms to properly analyze them. The most common artifacts are soft edges of the luminescent halos (<xref ref-type="fig" rid="fig1">Fig. 1B</xref>), image noise (<xref ref-type="fig" rid="fig1">Fig. 1C</xref>), halo overlaps (<xref ref-type="fig" rid="fig1">Fig. 1D</xref>), and split colonies (<xref ref-type="fig" rid="fig1">Fig. 1E</xref>). If general image-processing tools are used, quantitative analysis of images with combinations of all these artifacts (<xref ref-type="fig" rid="fig1">Fig. 1F</xref>) requires heavy user input. Thus, researchers interested in accurate quantification of their assay often have to (i) adjust the contrast until a threshold that seems right according to their perception is found, (ii) manually mark each halo separately, and (iii) manually subtract halo intensity data resulting from overlapping regions. The laboriousness of this procedure drives researchers toward either keeping their assays small or analyzing the results qualitatively.</p>
    <fig id="fig1" orientation="portrait" position="float">
      <label>FIG 1</label>
      <caption>
        <p>Illustration of common artifacts in automatic identification of luminescent halos. (A) An ideal image, with clear halo borders. The darker spots in the center of each halo represent the colonies. (B) A more realistic halo, with its values slowly decreasing from the center. This creates soft edges, with very small difference in values between the halo's edge and the background. (C) As described for panel B, but with the addition of noise, which lessens the difference between the halo and the background even further. (D) Two overlapping halos. Notice that the area of overlap is brighter (i.e., has higher values) than the other side of each halo. (E) A split colony, separated into two areas (indicated by the two dark spots). (F) The common result of a colony luminescence assay: the image is noisy, the halo values are gradually decreasing, and both overlaps and split colonies may exist.</p>
      </caption>
      <graphic xlink:href="sph0011927340001"/>
    </fig>
    <p>To address these issues, we developed a general software package—CFQuant—for analyzing colony luminescence while taking typical levels of biological noise (<xref ref-type="fig" rid="fig1">Fig. 1</xref>) into consideration. As a study case, we used the <named-content content-type="genus-species">Rhodobacter capsulatus</named-content> high-throughput screening system (<xref rid="B24" ref-type="bibr">24</xref>, <xref rid="B25" ref-type="bibr">25</xref>). In that assay, plates containing algal colonies are overlaid with engineered bacteria which produce GFP in the presence of gaseous hydrogen (H<sub>2</sub>). This system, which generates a luminescence image (GFP) alongside a colony image (chlorophyll), is typically used as a qualitative phenotypic screen that reports on desirable genetic traits in heterogeneous populations (<xref rid="B25" ref-type="bibr">25</xref><xref ref-type="bibr" rid="B26">–</xref><xref rid="B29" ref-type="bibr">29</xref>). This assay represents a classical large-scale experiment in which the output is a colony luminescence image with an array of biological noise data which have so far prevented a quantitative analysis. Using our novel image-processing tool, we show here that we are able to overcome the noise issues and formulate a sound quantitative prediction of active-enzyme abundance in each colony on the basis of these large-scale screening images alone.</p>
    <p>CFQuant is available at <ext-link ext-link-type="uri" xlink:href="https://www.energylabtau.com/cfquant">https://www.energylabtau.com/cfquant</ext-link>.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <sec id="s2.1">
      <title>Software details.</title>
      <p>Upon initiation of the software, the user is required to upload the colony and halo images and to choose the colony detection method—either arrangement-based or scatter-based detection. To use arrangement-based detection, the user must also upload an approximate arrangement of the colonies in a grid of rows and columns (see Materials and Methods for image requirements). The user also has the choice of either analyzing a single image or performing batch processing—analysis of multiple images—without the user interaction steps.</p>
      <p>Once the input is received, CFQuant starts analyzing the colony image (<xref ref-type="fig" rid="fig2">Fig. 2A</xref>). The software begins with an initial background removal step, after which the image is left with several foreground areas (<xref ref-type="fig" rid="fig2">Fig. 2B</xref>). However, in some images the number of foreground areas exceeds the specified number of colonies. In arrangement-based detection, CFQuant compares the arrangement of the foreground areas with the user-specified arrangement and determines by this comparison if the excess areas are due to persisting background noise or cases of split colonies (<xref ref-type="fig" rid="fig1">Fig. 1E</xref>) or both. It then either joins foreground areas that are in close proximity or deletes low-value ones until no excess areas remain. In scatter-based detection, the colony number is unknown, so the software uses the shapes, sizes, and values of the foreground areas to ensure that background noise is deleted. Split-colony identification is not performed using this method. Regardless of the method chosen, in the final stage the software determines the background threshold value (i.e., the value below which pixels are considered part of the background). Once the colonies are identified, the user can view the results and make changes if necessary (<xref ref-type="fig" rid="fig2">Fig. 2C</xref>).</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>FIG 2</label>
        <caption>
          <p>The flow of the software in analyzing a single plate. (A) The colony image of the plate before analysis. (B) The colony image after the background removal step. (C) The colony image after colony identification. The identified colony borders are shown in red. The blue borders mark two areas that were identified as parts of a split colony. (D) The halo image before analysis. Image contrast was adjusted for visibility. (E) The halo image after identification. The identified halo borders are shown in red. The blue dots mark the centers of the colonies, which are used in the halo identification.</p>
        </caption>
        <graphic xlink:href="sph0011927340002"/>
      </fig>
      <p>After ensuring that colonies were correctly identified, CFQuant moves on to the halo image (<xref ref-type="fig" rid="fig2">Fig. 2D</xref>). For each halo, the software attempts to find the threshold value separating it from the background. Since edge detection is problematic in the luminescent halos (<xref ref-type="fig" rid="fig1">Fig. 1</xref>), CFQuant relies on the fact that halos form circular shapes centered at (or near) the middle of the colony. In cases of halo overlaps (<xref ref-type="fig" rid="fig1">Fig. 1D</xref>), each halo is expected to resemble a partial circle. Therefore, the software first assigns to each halo the highest possible background threshold value and then gradually decreases it until the area no longer resembles a circle (or a partial one). The stopping point is determined based on the distances corresponding to each edge point from the colony center being roughly equal while still allowing some noise in the distance and center location. As in the previous phase, once all the halos are identified, the user can view the results and make changes if necessary (<xref ref-type="fig" rid="fig2">Fig. 2E</xref>).</p>
      <p>After the analysis is completed, data on both the colonies and the halos are saved. The saved data include the area, pixel sum, mean pixel value, and maximal pixel value corresponding to each colony and each halo. The latter three parameters are also evaluated using normalized calculations based on the selected background thresholds (see Materials and Methods for more details). In the halo image, pixel values in areas of overlap are corrected to the values expected for each halo to avoid the additive effect in the overlap area (<xref ref-type="fig" rid="fig1">Fig. 1D</xref>).</p>
    </sec>
    <sec id="s2.2">
      <title>Automatic identification test.</title>
      <p>Colony identification performed using arrangement-based detection correctly identified 100% of the colonies on all 31 plates tested (each plate contained 20 to 109 colonies). Using scatter-based detection on the same plates, 99% of the colonies were correctly identified. In testing performed on plates containing 16 to 656 scattered colonies, 88% of the colonies were correctly identified (83% to 94% for each plate individually). A total of 60 areas representing background noise were mistakenly identified as colonies (3% of identified colonies); all were dark spots at the edge of the plates. <xref ref-type="supplementary-material" rid="figS1">Fig. S1</xref> in the supplemental material shows an example of images identified with scatter-based detection.</p>
      <supplementary-material content-type="local-data" id="figS1">
        <object-id pub-id-type="doi">10.1128/mSphere.00676-18.1</object-id>
        <label>FIG S1</label>
        <p>Results of automatic identification of an image with scattered colonies, without manual corrections. (A) Most colonies were correctly identified. However, some noise at the edge of the plate was erroneously identified as well. (B) Halo identification on the same plate. Download <inline-supplementary-material id="fS1" mimetype="image" mime-subtype="tif" xlink:href="sph001192734sf1.tif" content-type="local-data">FIG S1, TIF file, 0.7 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2019 Dafni et al.</copyright-statement>
          <copyright-year>2019</copyright-year>
          <copyright-holder>Dafni et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>Among 695 noticeable halos in all 37 plates, 671 (97%) were identified automatically. However, 13% of them were considerably smaller or larger than their size as perceived by eye. Twelve colonies (2% of the identified halos) were erroneously given a halo.</p>
      <p>In images with fewer than 200 colonies and sizes of up to 625-by-625 pixels, the durations of automatic identification were at most 5 s for the colony image and 34 s for the halo image, using CFQuant from MATLAB version 2017b on Windows 7 (Intel Core i7 6700; CPU, 3.4 Ghz). It should be noted that the individual images had no more than 36 noticeable halos in them. With the largest colony number (656, only 8 of which had noticeable halos), automatic identification took 21 s for the colonies and 77 s for the halos.</p>
    </sec>
    <sec id="s2.3">
      <title>Performance test.</title>
      <p>To test our software, we performed the <named-content content-type="genus-species">R. capsulatus</named-content> assay on 20 engineered strains of <named-content content-type="genus-species">Chlamydomonas reinhardtii</named-content> with known expression levels of a synthetic H<sub>2</sub>-producing enzyme (<xref rid="B29" ref-type="bibr">29</xref>). To produce images for the software, these strains were plated on four replica plates of 20 clones each. Two images were obtained for each plate: a colony image and a halo image of the GFP fluorescence. <xref ref-type="fig" rid="fig3">Fig. 3A</xref> shows a composite (manually colored and contrasted) image of one of the plates from this assay. We analyzed these images using CFQuant (<xref ref-type="fig" rid="fig3">Fig. 3B</xref> and <xref ref-type="fig" rid="fig3">C</xref> show the identified colonies and halos, respectively, of the plate displayed in <xref ref-type="fig" rid="fig3">Fig. 3A</xref>) and obtained the features (measured values) of each halo and colony. To control for colony size, we divided the halo feature data by the colony feature data. We then averaged the results of all four plates and searched for the single feature that best predicted the known protein abundance (calculated from three repetitions of active-protein quantification; see “MV protein quantification” in Materials and Methods). Of the 10 halo features, the best predictor was the pixel sum normalized by each halo's individual threshold (see Materials and Methods). This value (divided by the colony area value) had a Spearman's rho of 0.854 (<italic>P</italic> value &lt; 10<sup>−5</sup>) when correlated with the known protein abundance levels (<xref ref-type="fig" rid="fig3">Fig. 3D</xref>). To further validate the performance of CFQuant, we performed a manual analysis of the same images using ImageJ (<xref rid="B23" ref-type="bibr">23</xref>). In measuring a similar normalized pixel sum divided by the colony area, the correlation of the values with the known protein abundance had a Spearman's rho of 0.759 (<italic>P</italic> value &lt; 2*10<sup>−4</sup>) (<xref ref-type="supplementary-material" rid="figS2">Fig. S2</xref>). Levels of correlation of other values (area, sum, etc.) divided by colony area with the protein abundance were lower (not shown).</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>FIG 3</label>
        <caption>
          <p>The results of the performance test. (A) Composite image of one of the plates used in the assay, combining the colony and halo images. The colonies are shown in red, and the GFP halos are shown in green. (B) The colony image after CFQuant analysis. The detected colony borders are shown in red. (C) The halo image after CFQuant analysis. The detected borders of the halos are shown in red, and the colony centers are shown in blue. (D) The best correlation of a single halo feature with the known protein expression values of the strains (<italic>P</italic> value &lt; 10<italic><sup>−</sup></italic><sup>5</sup>). The CFQuant prediction represents the normalized sum of pixels for the halos divided by the area of the colonies, as described in the text. The values used in the figure represent averages of the measurements from all four plates. The protein abundance represents the average of results from three measurements performed with methyl viologen (see “MV protein quantification” in Materials and Methods). chl, chlorophyll.</p>
        </caption>
        <graphic xlink:href="sph0011927340003"/>
      </fig>
      <supplementary-material content-type="local-data" id="figS2">
        <object-id pub-id-type="doi">10.1128/mSphere.00676-18.2</object-id>
        <label>FIG S2</label>
        <p>Correlation between the values measured manually with ImageJ and the known levels of protein abundance (<italic>P</italic> value &lt; 2*10<sup>−4</sup>). The manual measurement is the pixel sum of each halo (normalized by reducing the minimal value of the halo from every pixel) divided by the area of its colony. Note that the values are presented on a larger scale than the values in <xref ref-type="fig" rid="fig3">Fig. 3D</xref>, since CFQuant reduces 16-bit images to a lower bit size for faster processing. Download <inline-supplementary-material id="fS2" mimetype="image" mime-subtype="tif" xlink:href="sph001192734sf2.tif" content-type="local-data">FIG S2, TIF file, 0.02 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2019 Dafni et al.</copyright-statement>
          <copyright-year>2019</copyright-year>
          <copyright-holder>Dafni et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>DISCUSSION</title>
    <p>In this work, we developed CFQuant—a MATLAB-based image-processing tool built to meet the needs for a growing practice of using luminescent markers in large-scale assays. CFQuant is designed as a quick and reliable tool for quantifying colony luminescence while overcoming an array of prevalent forms of biological noise. CFQuant is a high-throughput tool. In addition to providing automatic analysis of individual plates, CFQuant also has a batch-processing mode that allows it to analyze multiple images with no user interaction. This enables CFQuant to provide fast analyses of very large numbers of colonies. These qualities allow CFQuant to be a considerably faster alternative to manual analysis of images, especially in working with larger assays.</p>
    <sec id="s3.1">
      <title>Halo edge detection.</title>
      <p>The most fundamental issue that CFQuant had to overcome was the problem of automatically detecting halos. Most classical edge detection algorithms (such as are implemented in most generalist image analysis software) look for a noticeable drop in pixel intensity in order to determine object edges (<xref rid="B30" ref-type="bibr">30</xref>). However, colony luminescence halos tend to be gradual, with soft edges (see <xref ref-type="supplementary-material" rid="figS3">Fig. S3A</xref> in the supplemental material), and lack this drop in pixel intensity. In manually adjusting the contrast, it might appear as if clear edges are present (<xref ref-type="supplementary-material" rid="figS3">Fig. S3B</xref>), but the pixels hidden by the contrast settings would still pose a problem for automatic tools. Therefore, mainstream edge detection methods struggle to define clear halo boundaries (<xref ref-type="supplementary-material" rid="figS3">Fig. S3C</xref>). Permanently changing the image's pixel values to the manually selected contrast values could remedy this problem but would do so at the expense of loss of information from the image.</p>
      <supplementary-material content-type="local-data" id="figS3">
        <object-id pub-id-type="doi">10.1128/mSphere.00676-18.3</object-id>
        <label>FIG S3</label>
        <p>Comparison of halo identification methods on a halo image. (A) The unedited image. The halos are slightly darker than the rest of the plate. (B) The image after contrast adjustment, with the halos now easy to spot. (C) The result of edge detection on the original image. The white lines represent the detected edges. Detection was carried out using the MATLAB edge function with the Canny method (<xref rid="B30" ref-type="bibr">30</xref>), a threshold value of 0.006, and a sigma value of 7. Parameters were gradually adjusted (first the threshold, then the sigma, and finally the threshold again) to maximize the edges around the halos while reducing noise. Other methods were also tested but performed more poorly than Canny (not shown). (D) The boundaries detected by CFQuant. Download <inline-supplementary-material id="fS3" mimetype="image" mime-subtype="tif" xlink:href="sph001192734sf3.tif" content-type="local-data">FIG S3, TIF file, 0.9 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2019 Dafni et al.</copyright-statement>
          <copyright-year>2019</copyright-year>
          <copyright-holder>Dafni et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>We tackled this issue in a different way; as CFQuant is a software program optimized for detecting and quantifying colony luminescence, we used some of the natural traits of these assays to solve the problems of halo detection. Instead of looking for steep decreases in pixel intensity, we exploited the fact that halos are roughly centered around the colony producing them—and thus, we begin our halo search from the colony coordinates. From this point, the area analyzed by the software gradually spreads out in a search for the halo’s edge. Since halation takes on a circular shape by definition, we can look for radial signals instead of intensity drops; thus, CFQuant is able to detect halo boundaries properly (<xref ref-type="supplementary-material" rid="figS3">Fig. S3D</xref>), uniformly and automatically—making it suitable for large-scale assays. It should be noted that the halo centers are not expected to be exactly at the location of the colony centers, and thus, our method allows for some freedom in their alignment (<xref ref-type="fig" rid="fig3">Fig. 3C</xref>).</p>
      <p>This method also allows CFQuant to overcome another common issue in halo identification—overlaps. By identifying the partial circle belonging to each of the overlapping halos, CFQuant is able to estimate the original boundaries of each halo. These boundaries are later used to avoid overestimating the intensity of overlapping halos. CFQuant performs well even in assay plates with many overlaps (<xref ref-type="fig" rid="fig3">Fig. 3</xref>).</p>
      <p>It is worth mentioning that in quantifying images of colony fluorescence from the <named-content content-type="genus-species">R. capsulatus</named-content> assay, we achieved better results with CFQuant than were achieved in measurement of the images manually with ImageJ (Spearman's rho of 0.854 versus 0.759, respectively, when correlated with the known protein abundance). We believe this is mostly due to CFQuant's ability to compensate for the halo overlaps, which were abundant in our images (<xref ref-type="fig" rid="fig3">Fig. 3C</xref>), though it is also possible that the determination of halo edges was less consistent when working manually.</p>
    </sec>
    <sec id="s3.2">
      <title>Using CFQuant.</title>
      <p>In this work, we tested the performance of CFQuant on a specific assay and obtained high levels of correlation with active-protein abundance measurements in using the normalized pixel sum of the halos. However, CFQuant was built as a generic tool for colony assays that produce luminescent halos. It is unlikely that the same features of the colonies and halos would provide optimal measurements for every assay of this sort. For this reason, CFQuant calculates and returns multiple features on both the colonies and the halos.</p>
      <p>When using CFQuant for the first time, we strongly encourage users to calibrate their assay. Users should start by quantifying the probed trait (e.g., protein abundance, as in the experiment we describe here) using a known method. In the next step, users should run the luminescence assay on the same colonies, analyze the results using CFQuant, and search for the value (or set of values) that best predicts the probed trait. We do expect that dividing halo feature data by colony feature data will improve correlations, as doing so normalizes for colony size. Depending on the assay used, there may be additional requirements, such as the use of a minimal or maximal colony size that can be analyzed reliably, etc. With the <named-content content-type="genus-species">R. capsulatus</named-content> assay, algae colonies need some time to grow before producing enough hydrogen to have visible fluorescence.</p>
      <p>Another factor to consider is colony placement. While CFQuant can identify randomly scattered colonies, a few limitations do exist with respect to reliable halo identification and quantification. It is advised not to place colonies closer together than the expected radii of their halos. CFQuant handles partial overlaps between halos, but large overlaps can disrupt halo detection and prevent reliable quantification of halo values, particularly if multiple halos overlap and completely obscure the background. It is also advised to keep similar distances between the colonies and the edge of the plate; otherwise, the halos might be cut off by the edge, causing underestimation of their size.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4.1">
      <title>Software overview.</title>
      <p>After uploading the colony and halo images, the user can select from two different methods of colony detection. If the colonies have a known arrangement, the user can input a simplified version of it (see “Image requirements” below) that CFQuant will use for arrangement-based detection. If not, the software can use scatter-based detection, where no previous assumptions on colony number or arrangement are made.</p>
      <p>Either way, CFQuant begins automated identification of the colonies with a background elimination stage. In arrangement-based detection, that step is followed by image rotation (to ensure that the image aligns with the specified arrangement) and, finally, testing of foreground areas against the user-specified arrangement to delete any persisting background noise and join split colonies. In scatter-based detection, persisting noise is filtered out based on shape and pixel values, and detection of split colonies is not carried out. After the automated identification, the results are displayed and the user can correct mistakes in identification (if any). After user approval, data on the colonies are collected.</p>
      <p>Next, the luminescent halos are automatically identified using the location of the colonies. The program searches for the largest area around each colony that is approximately circular. Incomplete circles are also accepted, to account for overlapping halos. After identification, the user is once again prompted to make any necessary corrections, and then the data on them are collected.</p>
      <p>CFQuant can also perform batch processing, analyzing multiple images without user interaction.</p>
      <p>A simplified flow chart of the image analysis stages is shown in <xref ref-type="fig" rid="fig2">Fig. 2</xref>.</p>
    </sec>
    <sec id="s4.2">
      <title>Image requirements.</title>
      <p>The program requires one image of the colonies and a second image of the luminescent halos. The two images should be taken with the same camera, using the same focus and camera location, since the location of the colonies is used in analyzing the halo image. Additionally, the colonies must be the darkest or brightest objects in the image, and the same is also recommended for the halos (though areas outside the halos should not affect the analysis). Scatter-based colony detection can handle some noise from areas that are darker/brighter than the colonies, but it is recommended to avoid this if possible.</p>
      <p>The images can be in any format supported by MATLAB, including TIF, BMP, GIF, PNG, and JPEG. The images can have any bit depth, but it is recommended to use 16-bit images if possible. Such images are reduced by CFQuant to have values of only between 0 and 511 (effectively 9-bit, though stored as 16-bit) for faster analysis, but they still have a larger value range and thus provide more-accurate results.</p>
      <p>In arrangement-based colony detection, the colonies need to be arranged on a grid of rows and columns (similar to those shown in <xref ref-type="fig" rid="fig2">Fig. 2B</xref> and <xref ref-type="fig" rid="fig3">3A</xref>). The arrangement does not need to be precise, but rows and columns should be roughly recognizable. This arrangement is specified by the user upon initiation of the process and is used for the automatic identification of the colonies.</p>
    </sec>
    <sec id="s4.3">
      <title>Colony identification.</title>
      <p>CFQuant has two methods of colony detection: arrangement-based and scatter-based detection. Arrangement-based detection uses a simplified arrangement (input by the user) of the colonies to identify the colonies more reliably and to detect split colonies and join them. Scatter-based detection requires no user input aside from the images; however, it is more error prone and cannot join split colonies.</p>
      <p>After the colony image has been loaded (<xref ref-type="fig" rid="fig2">Fig. 2A</xref>), both methods begin by calculating a minimal estimate of the background area in the image, under the assumption that the distance between adjacent colonies is no smaller than the average diameter of the colonies. In arrangement-based detection, it is calculated from the user-specified arrangement as follows:<disp-formula id="FD1"><label>(1)</label><alternatives><graphic xlink:href="sph00118-2734-m01.jpg" position="float" orientation="portrait"/><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>N</mml:mi><mml:mi>π</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>N</mml:mi><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>where <italic>A<sub>B</sub></italic> is the background area estimate, <italic>A<sub>T</sub></italic> is the total image area, <italic>N</italic> is the number of colonies, <italic>R</italic> is the average radius of a colony, and <italic>r<sub>n</sub></italic> and <italic>c<sub>n</sub></italic> are the numbers of row and columns, respectively, in the user-specified arrangement.</p>
      <p>In scatter-based detection, the colony number and arrangement are both unknown, so a modified equation is used:<disp-formula id="FD2"><label>(2)</label><alternatives><graphic xlink:href="sph00118-2734-m02.jpg" position="float" orientation="portrait"/><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>lim</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>N</mml:mi><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>π</mml:mi></mml:mrow><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>where <italic>r<sub>n</sub></italic> was set to 1, <italic>c<sub>n</sub></italic> was set to <italic>N</italic>, and <italic>N</italic> approaches infinity, thus decreasing the calculated area to a minimum.</p>
      <p>This value is used to ensure that the colonies have higher pixel values than the background. Background values are expected to have a considerably smaller range than the colony values. Therefore, the software compares the range of low pixel values in the image that occupy the estimated background area to the range of high pixel values that occupy the same area. If the range of high pixel values is smaller, the image values are reversed.</p>
      <p>CFQuant then sets an initial background threshold value (i.e., the highest value belonging to the background) as the highest value under which the background area is still no larger than the minimal background area estimate.</p>
      <p>This initial background threshold might not eliminate enough of the background, and some colonies might remain connected in the same foreground area. Therefore, CFQuant tests the entirety of the foreground area to see if any of them can be split by some increase to the threshold value. To guarantee that the split is between two colonies, it is accepted only if both parts are still in the foreground after a second, identical increase. The highest value to cause such a split (if any) is selected as the new threshold value.</p>
      <p>From this point, the two detection methods differ greatly. In arrangement-based detection, small areas of persisting background noise is deleted by the following criteria:<disp-formula id="FD3"><label>(3)</label><alternatives><graphic xlink:href="sph00118-2734-m03.jpg" position="float" orientation="portrait"/><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mtext>Delete</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mn>5</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>where <italic>A</italic><sub>Delete</sub> is of a size small enough to delete and <italic>A<sub>n</sub></italic> is the size of the <italic>n</italic>th largest area, with <italic>n</italic> being the number of colonies in the user-specified arrangement. The use of the 5 value is based on parameter optimization.</p>
      <p>This concludes the background removal process (<xref ref-type="fig" rid="fig2">Fig. 2B</xref>). However, excess foreground areas that remain after this stage can still represent either persisting background noise or split colonies or both. To determine how many of them represent background noise, CFQuant creates multiple copies of the colony image, with each copy representing a possible solution to the classification problem. One copy uses the selected background threshold value, but other copies use increasingly larger threshold values to delete excess areas. The excess areas remaining in these copies are regarded as parts of split colonies and are joined on the basis of proximity until no excess areas remain.</p>
      <p>The software then ensures that the image is not rotated (i.e., that the colony rows are horizontal). In each copy image, the distances between colony canters (after joining) and their corresponding angles are calculated and are normalized to be within ±45°. The software then pools the same number of shortest distances as the number of distances between adjacent colonies in the user-specified arrangement. After removal of outliers in distance and angle, the average angle is used as the rotation angle of the image, which is then rotated accordingly.</p>
      <p>Following the rotation, the colony centers are used to calculate the ideal location of each colony on the basis of the locations of the centers and the average distances between them. Each colony is then assigned to an ideal location based on proximity and position. The sum of the squares of the distances between the colonies and their ideal location is then used to evaluate each copy image, and the one that resulted in the smallest sum is chosen.</p>
      <p>In scatter-based detection, these stages do not exist, and persisting areas of background noise are deleted based on their shape and values. To use those reliably, CFQuant first tests if any 1 of the 10 largest foreground areas is comprised mostly of pixels with the same small value. If so, that value likely still represents part of the background, and the threshold value is raised to erase it.</p>
      <p>Following this step, all colonies are expected to have a roughly circular shape, so the circularity of each foreground area is tested using the following equation:<disp-formula id="FD4"><label>(4)</label><alternatives><graphic xlink:href="sph00118-2734-m04.jpg" position="float" orientation="portrait"/><mml:math id="m4"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:msubsup><mml:mi>R</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>where <italic>C</italic> is the circularity value, <italic>A</italic> is the area, and <italic>R<sub>m</sub></italic> is the distance from the area's center to its furthest edge point. Colonies with a circularity value below 0.18 are treated as background and deleted. This value is based on parameter optimization and is about half of the lowest circularity value observed for any colony in our plates.</p>
      <p>After the circularity test, CFQuant once again tries to increase the background threshold value. For every possible threshold, the software compares the foreground areas that are to be deleted by it with those that are not to be deleted by dividing the smallest mean value of the persisting areas by the largest mean value of the deleted ones. If the new threshold separates high-value colonies from low-value noise, that division value is expected to be larger than 1, and so the threshold with the largest division value above 1.2 is selected (value based on parameter optimization). If no such threshold value is found, the old threshold value is kept.</p>
      <p>As a final step to delete background noise, the foreground areas are sorted into groups based on their sum, with the smallest sum in the first group being double the largest sum of the next group and so on. If this creates two or more groups, the software tests if a group exists that has the largest total sum and the largest number of areas. If such a group is identified, only that group is selected. If not, the groups are sorted on the basis of the maximal pixel values of their foreground areas. The group with the largest maximal value is selected, as well as any group whose maximal value is higher than the selected group's average maximal value. Areas that belong to groups that were not selected are deleted, based on the assumption that colonies have much higher sums than background noise. This also allows the deletion of large areas such as smears on the plate.</p>
      <p>Once all colonies are identified (regardless of method), CFQuant identifies the minimal splitting value (i.e., the lowest value separating the colonies into different foreground areas) and the highest value where no colonies is deleted. The background threshold value used for data acquisition is set as the mean of these two values. This value seems to fit well with the visible borders of the colonies (<xref ref-type="fig" rid="fig2">Fig. 2C</xref>).</p>
      <p>After this stage is complete, CFQuant displays an interface that enables manual deletion and addition of whole colonies or split parts, if necessary.</p>
      <p>Once the user confirms the identification, data on the colonies are calculated (see “Measured values” below).</p>
    </sec>
    <sec id="s4.4">
      <title>Halo identification.</title>
      <p>In images from our laboratory, the halos often have “holes” with lower values at the location of the colonies (<xref ref-type="fig" rid="fig2">Fig. 2D</xref>). CFQuant begins halo identification by filling these low-value areas, using the following criteria to find them:<disp-formula id="FD5"><label>(5)</label><alternatives><graphic xlink:href="sph00118-2734-m05.jpg" position="float" orientation="portrait"/><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>R</mml:mi><mml:mtext> and </mml:mtext><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>where <italic>D</italic><sub>min</sub> is the distance between the colony center and the point on the area that is closest to it, <italic>D</italic><sub>max</sub> is the distance between the colony center and the point on the area that is furthest from it, and <italic>R</italic> is the mean radius of the colonies. The multipliers for the colony radius were chosen by parameter optimization.</p>
      <p>Next, CFQuant makes sure that the halos have higher values than the background. To do so, the software repeats the hole-filling process for both the regular image and the image with reversed values. It then determines the number of pixels that have higher values than the colony centers in each filled image. If the regular image has more of these pixels, it means that the background has higher values than the halos, and the reversed image is used instead.</p>
      <p>After these initial corrections to the image, CFQuant starts inspecting each halo individually. To account for noise in the location of the halos' centers, their potential centers are set as the center of the halo's colony, as well as any point up to 1.5 times the mean radius of the colonies away from that center (specific value chosen after optimization). Next, the software attempts to fit a background threshold value to each halo.</p>
      <p>Starting from the highest threshold value possible, CFQuant finds the foreground area containing the colony center, and the boundaries of that area, ignoring inner boundaries with areas smaller than the average colony area and boundaries caused by the edge of the image. For each possible center location, the halo radius is calculated as follows:<disp-formula id="FD6"><label>(6)</label><alternatives><graphic xlink:href="sph00118-2734-m06.jpg" position="float" orientation="portrait"/><mml:math id="m6"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mtext> max</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.045</mml:mn><mml:mtext>*</mml:mtext><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>0.2</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>where <italic>R</italic> is the selected radius and <italic>R</italic><sub>min</sub> is the distance from the specific center location to the closest boundary point. In cases in which the colony arrangement was specified, <italic>D</italic> is the mean of the average row distance and average column distance. Otherwise, it is the average distance between adjacent colonies. It is used as a scale for the expected size of the halos. The constants in this equation were optimized on multiple images (see “Parameter optimization” below).</p>
      <p>Once the halo's radius is found, a circularity test is performed. The algorithm checks which border points are within that distance from the center, and these border points are translated to angle coverage. If the border points form arcs with a total angle of at least <inline-formula id="ui1"><alternatives><inline-graphic xlink:href="sph00118-2734-u01.jpg"/><mml:math id="u1"><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:mfrac><mml:mi>π</mml:mi></mml:math></alternatives></inline-formula> (in radians), the halo is accepted for that threshold (the specific value was optimized; see “Parameter optimization” below). Accepting incomplete circles like this is necessary, since overlapping halos do not form a full circle (<xref ref-type="fig" rid="fig1">Fig. 1D</xref>).</p>
      <p>This circularity test is done with every possible center. If the halo passes the circularity test, the center that results in the highest radius (while still passing the test) is selected, and the software proceeds to test the halo with a lower threshold value (and thus with a larger area). If not, the software assumes that the halo ended at a higher threshold value. However, the software still reduces the threshold value and performs the test again as long as any other halo is still circular. This means a halo could fail the circularity test due to some noise and then pass it with a lower threshold value.</p>
      <p>Once a threshold value is set for all the halos, the results are presented to the user. The user can then shrink or expand a halo (which changes its threshold value), delete one entirely, or create a halo for a colony with no identified halo.</p>
      <p>Once the user confirms the identification, data on the halos are calculated (see “Measured values” below).</p>
    </sec>
    <sec id="s4.5">
      <title>Measured values.</title>
      <p>CFQuant calculates multiple parameters for each colony or halo, including the total area in pixels as well as the sum, mean, and maximal pixel values.</p>
      <p>Additionally, two sets of normalized values are calculated for each of the sum, mean, and maximal pixel values by subtracting a different threshold value from each pixel of the colonies/halos prior to the calculation. For colonies, the selected background threshold and the minimal splitting value are used (see “Colony identification” above). For halos, the individual threshold of each halo and the lowest of these individual thresholds are used (see “Halo identification” above).</p>
      <p>For the halo image, pixel values in areas of overlaps of halos are calculated differently, since the combination of the influences of the two halos can artifactually increase pixel values (<xref ref-type="fig" rid="fig1">Fig. 1D</xref>). CFQuant relies on the calculated radius of the halos at every threshold value. For each halo, each pixel in the overlapping area gets the value corresponding to the highest threshold where it is still within the radius of that halo.</p>
    </sec>
    <sec id="s4.6">
      <title>MV protein quantification.</title>
      <p>Protein quantification was carried out precisely as previously reported (<xref rid="B26" ref-type="bibr">26</xref>). Briefly, following 2 h of dark anaerobiosis, cells were transferred into a buffer containing reduced methyl viologen and Triton X for lysing the cells. A 500‐μl sample was drawn from the headspace, and the H<sub>2</sub> concentration was determined by gas chromatography. The amount of enzyme was calculated based on the constant enzyme’s specific activity.</p>
    </sec>
    <sec id="s4.7">
      <title><named-content content-type="genus-species">Rhodobacter capsulatus</named-content> high-throughput screen.</title>
      <p>A high-throughput screen was done using previously described methods (<xref rid="B26" ref-type="bibr">26</xref>). Algal strains, overlaid with engineered H<sub>2</sub>-sensing <named-content content-type="genus-species">R. capsulatus</named-content>, were scanned using a Fuji FLA-5100 fluorescence imager. A 473-nm-wavelength laser was used for excitation, whereas 510-nm and 665-nm filters were used for quantifying emerald GFP luminescence and chlorophyll density, respectively.</p>
    </sec>
    <sec id="s4.8">
      <title>ImageJ manual quantification.</title>
      <p>Analysis was performed on ImageJ 1.51j8, using the same images as were used in the performance test (see Results).</p>
      <p>Colony area was calculated by applying a threshold value to the colony image and then using the “analyze particles” option.</p>
      <p>Halo data was collected for each halo individually. A perfect circle was drawn around each halo, and then the “measure” option was used, yielding the area, mean value, and minimal value of the halo. The normalized sum of the halo was then calculated as follows:<disp-formula id="FD7"><label>(7)</label><alternatives><graphic xlink:href="sph00118-2734-m07.jpg" position="float" orientation="portrait"/><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>where <italic>S</italic><sub>norm</sub> is the normalized sum, <italic>A</italic> is the area, <italic>V̄</italic> is the mean value, and <italic>V</italic><sub>min</sub> is the minimal value. This is comparable to the normalized sum calculation from CFQuant, with <italic>V</italic><sub>min</sub> substituting for the halo threshold value.</p>
      <p>Finally, this value was divided by the colony area for comparison with the known protein values of each colony.</p>
    </sec>
    <sec id="s4.9">
      <title>Parameter optimization.</title>
      <p>To optimize the parameters of CFQuant, we ran the software on a set of 38 image pairs (colony and halo) of the <named-content content-type="genus-species">R. capsulatus</named-content> assay. The software was used multiple times with different values for each parameter individually, and the automatic identification results were manually inspected. The value that was selected was the one that resulted in the best fit with the perceived boundaries of the colonies or halos. Seven of the images had multiple (up to 656) scattered colonies and were not used to test arrangement-based detection.</p>
      <p>All manual comparisons between the automated CFQuant results and the perceived colonies or halos in the images were performed by the same member of the team, using the same computer each time (desktop computer running Windows 7).</p>
    </sec>
    <sec id="s4.10">
      <title>Data availability.</title>
      <p>CFQuant is available at <ext-link ext-link-type="uri" xlink:href="https://www.energylabtau.com/cfquant">https://www.energylabtau.com/cfquant</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>We thank Matthew Posewitz for the <italic>hydA<sub>1</sub></italic><sub>,</sub><italic><sub>2</sub></italic> double hydrogenase knockout mutant, Matt Wecker and Maria Ghirardi for H<sub>2</sub>-sensing <named-content content-type="genus-species">R. capsulatus</named-content>, and Barel Weiner for designing CFQuant’s webpage.</p>
    <p>This study was supported in part by The Israeli Ministry of Science, Technology and Space; the Israel Science Foundation (1646/16); NSF-BSF Energy for Sustainability (2016666); a fellowship from the Edmond J. Safra Center for Bioinformatics at Tel Aviv University; a fellowship from the Manna Center for Plant Biosciences; and a fellowship from the Rieger Foundation for Environmental Studies.</p>
    <p>E.D., I.W., T.T., and I.Y. designed the research; E.D., I.W., and N.S. performed the computational procedures; E.D. and I.W. performed the experimental procedures; E.D., I.W., T.T., and I.Y. wrote the paper.</p>
    <p>We declare that we have no conflict of interest.</p>
    <p>No conflicts with respect to informed consent or human or animal rights are applicable. All of us declare that we agree to the representation of authorship and to submission of the manuscript for peer review.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Valeur</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Berberan-Santos</surname><given-names>MN</given-names></name></person-group><year>2012</year><source>Molecular fluorescence: principles and applications</source>, <edition>2nd ed</edition><publisher-name>WILEY-VCH</publisher-name>, <publisher-loc>Weinheim, Germany</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Chalfie</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kain</surname><given-names>S</given-names></name></person-group><year>2006</year><source>Green fluorescent protein properties, applications and protocols</source>. <publisher-name>Wiley-Interscience</publisher-name>, <publisher-loc>Hoboken, NJ</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>De Wet</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Wood</surname><given-names>KV</given-names></name>, <name name-style="western"><surname>DeLuca</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Helinski</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Subramani</surname><given-names>S</given-names></name></person-group><year>1987</year><article-title>Firefly luciferase gene: structure and expression in mammalian cells</article-title>. <source>Mol Cell Biol</source><volume>7</volume>:<fpage>725</fpage>–<lpage>737</lpage>. doi:<pub-id pub-id-type="doi">10.1128/MCB.7.2.725</pub-id>.<pub-id pub-id-type="pmid">3821727</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shimomura</surname><given-names>O</given-names></name></person-group><year>2009</year><article-title>Discovery of green fluorescent protein (GFP) (Nobel Lecture)</article-title>. <source>Angew Chem Int ed Engl</source><volume>48</volume>:<fpage>5590</fpage>–<lpage>5602</lpage>. doi:<pub-id pub-id-type="doi">10.1002/anie.200902240</pub-id>.<pub-id pub-id-type="pmid">19579247</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shaner</surname><given-names>NC</given-names></name>, <name name-style="western"><surname>Steinbach</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Tsien</surname><given-names>RY</given-names></name></person-group><year>2005</year><article-title>A guide to choosing fluorescent proteins</article-title>. <source>Nat Methods</source><volume>2</volume>:<fpage>905</fpage>–<lpage>909</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth819</pub-id>.<pub-id pub-id-type="pmid">16299475</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barone</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Micklos</surname><given-names>D</given-names></name></person-group><year>2017</year><article-title>Unmet needs for analyzing biological big data: a survey of 704 NSF principal investigators</article-title>. <source>PLoS Comput Biol</source><volume>13</volume>:<elocation-id>e1005755</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005755</pub-id>.<pub-id pub-id-type="pmid">29049281</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sorensen</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Fei</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Andreas</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Willats</surname><given-names>WGT</given-names></name>, <name name-style="western"><surname>Domozych</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Rose</surname><given-names>JKC</given-names></name></person-group><year>2014</year><article-title>Stable transformation and reverse genetic analysis of Penium margaritaceum: a platform for studies of charophyte green algae, the immediate ancestors of land plants</article-title>. <source>Plant J</source><volume>77</volume>:<fpage>339</fpage>–<lpage>351</lpage>. doi:<pub-id pub-id-type="doi">10.1111/tpj.12375</pub-id>.<pub-id pub-id-type="pmid">24308430</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>YH</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>Oh</surname><given-names>S</given-names></name>, <name name-style="western"><surname>You</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>SH</given-names></name></person-group><year>2005</year><article-title>Optimization of technical conditions for the transformation of Lactobacillus acidophilus strains by electroporation</article-title>. <source>J Appl Microbiol</source><volume>99</volume>:<fpage>167</fpage>–<lpage>174</lpage>. doi:<pub-id pub-id-type="doi">10.1111/j.1365-2672.2005.02563.x</pub-id>.<pub-id pub-id-type="pmid">15960677</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grimaldi</surname><given-names>B</given-names></name>, <name name-style="western"><surname>de Raaf</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Filetici</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ottonello</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ballario</surname><given-names>P</given-names></name></person-group><year>2005</year><article-title>Agrobacterium-mediated gene transfer and enhanced green fluorescent protein visualization in the mycorrhizal ascomycete Tuber borchii: a first step towards truffle genetics</article-title>. <source>Curr Genet</source><volume>48</volume>:<fpage>69</fpage>–<lpage>74</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s00294-005-0579-z</pub-id>.<pub-id pub-id-type="pmid">15868150</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scranton</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Ostrand</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Georgianna</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Lofgren</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ellis</surname><given-names>RC</given-names></name>, <name name-style="western"><surname>Carruthers</surname><given-names>DN</given-names></name>, <name name-style="western"><surname>Dräger</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Masica</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Mayfield</surname><given-names>SP</given-names></name></person-group><year>2016</year><article-title>Synthetic promoters capable of driving robust nuclear gene expression in the green alga Chlamydomonas reinhardtii</article-title>. <source>Algal Res</source><volume>15</volume>:<fpage>135</fpage>–<lpage>142</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.algal.2016.02.011</pub-id>.</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yofe</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Zafrir</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Blau</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Schuldiner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tuller</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Shapiro</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ben-Yehezkel</surname><given-names>T</given-names></name></person-group><year>2014</year><article-title>Accurate, model-based tuning of synthetic gene expression using introns in S. cerevisiae</article-title>. <source>PLoS Genet</source><volume>10</volume>:<elocation-id>e1004407</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pgen.1004407</pub-id>.<pub-id pub-id-type="pmid">24968317</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tannous</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Fernandez</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Weissleder</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Breakefield</surname><given-names>XO</given-names></name></person-group><year>2005</year><article-title>Codon-optimized gaussia luciferase cDNA for mammalian gene expression in culture and in vivo</article-title>. <source>Mol Ther</source><volume>11</volume>:<fpage>435</fpage>–<lpage>443</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ymthe.2004.10.016</pub-id>.<pub-id pub-id-type="pmid">15727940</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cormack</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Bertram</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Egerton</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gow</surname><given-names>NAR</given-names></name>, <name name-style="western"><surname>Falkow</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>AJP</given-names></name></person-group><year>1997</year><article-title>Yeast-enhanced green fluorescent protein (yEGFP): a reporter of gene expression in Candida albicans</article-title>. <source>Microbiology</source><volume>143</volume>:<fpage>303</fpage>–<lpage>311</lpage>. doi:<pub-id pub-id-type="doi">10.1099/00221287-143-2-303</pub-id>.<pub-id pub-id-type="pmid">9043107</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hao</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Chao</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Jin</surname><given-names>Q</given-names></name></person-group><year>2017</year><article-title>Facile manipulation of protein localization in fission yeast through binding of GFP-binding protein to GFP</article-title>. <source>J Cell Sci</source><volume>130</volume>:<fpage>1003</fpage>–<lpage>1015</lpage>. doi:<pub-id pub-id-type="doi">10.1242/jcs.198457</pub-id>.<pub-id pub-id-type="pmid">28082423</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mei</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>W</given-names></name></person-group><year>2017</year><article-title>Newly identified CSP41b gene localized in chloroplasts affects leaf color in rice</article-title>. <source>Plant Sci</source><volume>256</volume>:<fpage>39</fpage>–<lpage>45</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2016.12.005</pub-id>.<pub-id pub-id-type="pmid">28167036</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Murley</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sarsam</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Toulmay</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Yamada</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Prinz</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Nunnari</surname><given-names>J</given-names></name></person-group><year>2015</year><article-title>Ltc1 is an ER-localized sterol transporter and a component of ER-mitochondria and ER-vacuole contacts</article-title>. <source>J Cell Biol</source><volume>209</volume>:<fpage>539</fpage>–<lpage>548</lpage>. doi:<pub-id pub-id-type="doi">10.1083/jcb.201502033</pub-id>.<pub-id pub-id-type="pmid">25987606</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilson</surname><given-names>CGM</given-names></name>, <name name-style="western"><surname>Magliery</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Regan</surname><given-names>L</given-names></name></person-group><year>2004</year><article-title>Detecting protein-protein interactions with GFP-fragment reassembly</article-title>. <source>Nat Methods</source><volume>1</volume>:<fpage>255</fpage>–<lpage>262</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth1204-255</pub-id>.<pub-id pub-id-type="pmid">16145770</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Straight</surname><given-names>AF</given-names></name>, <name name-style="western"><surname>Belmont</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Robinett</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Murray</surname><given-names>AW</given-names></name></person-group><year>1996</year><article-title>GFP tagging of budding yeast chromosomes reveals that protein-protein interactions can mediate sister chromatid cohesion</article-title>. <source>Curr Biol</source><volume>6</volume>:<fpage>1599</fpage>–<lpage>1608</lpage>. doi:<pub-id pub-id-type="doi">10.1016/S0960-9822(02)70783-5</pub-id>.<pub-id pub-id-type="pmid">8994824</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fan</surname><given-names>JY</given-names></name>, <name name-style="western"><surname>Cui</surname><given-names>ZQ</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>HP</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>ZP</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>YF</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>YP</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>XE</given-names></name></person-group><year>2008</year><article-title>Split mCherry as a new red bimolecular fluorescence complementation system for visualizing protein-protein interactions in living cells</article-title>. <source>Biochem Biophys Res Commun</source><volume>367</volume>:<fpage>47</fpage>–<lpage>53</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.bbrc.2007.12.101</pub-id>.<pub-id pub-id-type="pmid">18158915</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nichols</surname><given-names>NN</given-names></name>, <name name-style="western"><surname>Quarterman</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Frazer</surname><given-names>SE</given-names></name></person-group><year>2018</year><article-title>Use of green fluorescent protein to monitor fungal growth in biomass hydrolysate</article-title>. <source>Biol Methods Protoc</source><volume>3</volume>:<fpage>bpx012</fpage>. doi:<pub-id pub-id-type="doi">10.1093/biomethods/bpx012</pub-id>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gubbels</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Striepen</surname><given-names>B</given-names></name></person-group><year>2003</year><article-title>High-throughput growth assay for Toxoplasma gondii using yellow fluorescent protein</article-title>. <source>Antimicrob Agents Chemother</source><volume>47</volume>:<fpage>309</fpage>–<lpage>316</lpage>. doi:<pub-id pub-id-type="doi">10.1128/AAC.47.1.309-316.2003</pub-id>.<pub-id pub-id-type="pmid">12499207</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rojas</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Theriot</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>KC</given-names></name></person-group><year>2014</year><article-title>Response of Escherichia coli growth rate to osmotic shock</article-title>. <source>Proc Natl Acad Sci U S A</source><volume>111</volume>:<fpage>7807</fpage>–<lpage>7812</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1402591111</pub-id>.<pub-id pub-id-type="pmid">24821776</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schneider</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Rasband</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Eliceiri</surname><given-names>KW</given-names></name></person-group><year>2012</year><article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat Methods</source><volume>9</volume>:<fpage>671</fpage>–<lpage>675</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id>.<pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wecker</surname><given-names>MSA</given-names></name>, <name name-style="western"><surname>Meuser</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Posewitz</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Ghirardi</surname><given-names>ML</given-names></name></person-group><year>2011</year><article-title>Design of a new biosensor for algal H2 production based on the H2-sensing system of Rhodobacter capsulatus</article-title>. <source>Int J Hydrogen Energy</source><volume>36</volume>:<fpage>11229</fpage>–<lpage>11237</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ijhydene.2011.05.121</pub-id>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wecker</surname><given-names>MSA</given-names></name>, <name name-style="western"><surname>Ghirardi</surname><given-names>ML</given-names></name></person-group><year>2014</year><article-title>High-throughput biosensor discriminates between different algal H2-photoproducing strains</article-title>. <source>Biotechnol Bioeng</source><volume>111</volume>:<fpage>1332</fpage>–<lpage>1340</lpage>. doi:<pub-id pub-id-type="doi">10.1002/bit.25206</pub-id>.<pub-id pub-id-type="pmid">24578287</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weiner</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Atar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schweitzer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Eilenberg</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Feldman</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Avitan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Blau</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Danon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tuller</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yacoby</surname><given-names>I</given-names></name></person-group><year>2018</year><article-title>Enhancing heterologous expression in Chlamydomonas reinhardtii by transcript sequence optimization</article-title>. <source>Plant J</source><volume>94</volume>:<fpage>22</fpage>–<lpage>31</lpage>. doi:<pub-id pub-id-type="doi">10.1111/tpj.13836</pub-id>.<pub-id pub-id-type="pmid">29383789</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eilenberg</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Weiner</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Ben-Zvi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Pundak</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Marmari</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liran</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Wecker</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Milrad</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yacoby</surname><given-names>I</given-names></name></person-group><year>2016</year><article-title>The dual effect of a ferredoxin-hydrogenase fusion protein in vivo: successful divergence of the photosynthetic electron flux towards hydrogen production and elevated oxygen tolerance</article-title>. <source>Biotechnol Biofuels</source><volume>9</volume>:<fpage>182</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s13068-016-0601-3</pub-id>.<pub-id pub-id-type="pmid">27582874</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Noone</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ratcliff</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Subramanian</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Meuser</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Posewitz</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>King</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Ghirardi</surname><given-names>ML</given-names></name></person-group><year>2017</year><article-title>Expression of a clostridial [FeFe]-hydrogenase in Chlamydomonas reinhardtii prolongs photo-production of hydrogen from water splitting</article-title>. <source>Algal Res</source><volume>22</volume>:<fpage>116</fpage>–<lpage>121</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.algal.2016.12.014</pub-id>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weiner</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Shahar</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Feldman</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Landman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Milrad</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ben-Zvi</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Avitan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dafni</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Schweitzer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Eilenberg</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Atar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Diament</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tuller</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yacoby</surname><given-names>I</given-names></name></person-group><year>2018</year><article-title>Overcoming the expression barrier of the ferredoxin-hydrogenase chimera in Chlamydomonas reinhardtii supports a linear increment in photosynthetic hydrogen output</article-title>. <source>Algal Res</source><volume>33</volume>:<fpage>310</fpage>–<lpage>315</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.algal.2018.06.011</pub-id>.</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Canny</surname><given-names>JF</given-names></name></person-group><year>1986</year><article-title>A computational approach to edge detection</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><volume>8</volume>:<fpage>679</fpage>–<lpage>698</lpage>. doi:<pub-id pub-id-type="doi">10.1109/TPAMI.1986.4767851</pub-id>.<pub-id pub-id-type="pmid">21869365</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
