<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">peerj</journal-id>
    <journal-id journal-id-type="pmc">peerj</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7382364</article-id>
    <article-id pub-id-type="publisher-id">9277</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.9277</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Science</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Aquatic and Marine Chemistry</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Biogeochemistry</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>WHONDRS-GUI: a web application for global survey of surface water metabolites</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Xinming</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Huiying</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Goldman</surname>
          <given-names>Amy E.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <contrib id="author-4" contrib-type="author" corresp="yes">
        <name>
          <surname>Stegen</surname>
          <given-names>James C.</given-names>
        </name>
        <email>James.Stegen@pnnl.gov</email>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <contrib id="author-5" contrib-type="author">
        <name>
          <surname>Scheibe</surname>
          <given-names>Timothy D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1"/>
      </contrib>
      <aff id="aff-1"><institution>Pacific Northwest National Laboratory</institution>, <city>Richland</city>, <state>WA</state>, <country>United States of America</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valsaraj</surname>
          <given-names>Kalliat</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2020-07-22">
      <day>22</day>
      <month>7</month>
      <year iso-8601-date="2020">2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>e9277</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-02-26">
        <day>26</day>
        <month>2</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2020-05-11">
        <day>11</day>
        <month>5</month>
        <year iso-8601-date="2020">2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2020 Battelle Memorial Institute</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Battelle Memorial Institute</copyright-holder>
      <license xlink:href="https://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/9277"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The Worldwide Hydrobiogeochemistry Observation Network for Dynamic River Systems (WHONDRS) is a consortium that aims to understand complex hydrologic, biogeochemical, and microbial connections within river corridors experiencing perturbations such as dam operations, floods, and droughts. For one ongoing WHONDRS sampling campaign, surface water metabolite and microbiome samples are collected through a global survey to generate knowledge across diverse river corridors. Metabolomics analysis and a suite of geochemical analyses have been performed for collected samples through the Environmental Molecular Sciences Laboratory (EMSL). The obtained knowledge and data package inform mechanistic and data-driven models to enhance predictions of outcomes of hydrologic perturbations and watershed function, one of the most critical components in model-data integration. To support efforts of the multi-domain integration and make the ever-growing data package more accessible for researchers across the world, a Shiny/R Graphical User Interface (GUI) called WHONDRS-GUI was created.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The web application can be run on any modern web browser without any programming or operational system requirements, thus providing an open, well-structured, discoverable dataset for WHONDRS. Together with a context-aware dynamic user interface, the WHONDRS-GUI has functionality for searching, compiling, integrating, visualizing and exporting different data types that can easily be used by the community. The web application and data package are available at <ext-link ext-link-type="uri" xlink:href="https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811">https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811</ext-link>, which enables users to simultaneously obtain access to the data and code and to subsequently run the web app locally. The WHONDRS-GUI is also available for online use at Shiny Server (<ext-link ext-link-type="uri" xlink:href="https://xmlin.shinyapps.io/whondrs/">https://xmlin.shinyapps.io/whondrs/</ext-link>).</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>WHONDRS</kwd>
      <kwd>Graphical User Interface</kwd>
      <kwd>Web application</kwd>
      <kwd>Shiny</kwd>
      <kwd>Open source</kwd>
      <kwd>Data package</kwd>
      <kwd>River corridors</kwd>
      <kwd>Hydrobiogeochemistry</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>U.S. Department of Energy (DOE)</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source> Office of Biological and Environmental Research (BER)</funding-source>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Scientific Focus Area (SFA) at the Pacific Northwest National Laboratory (PNNL)</funding-source>
        <award-id>DE-AC06-76RLO1830</award-id>
      </award-group>
      <funding-statement>This research is supported by the U.S. Department of Energy (DOE), Office of Biological and Environmental Research (BER), as part of the Subsurface Biogeochemical Research (SBR) Scientific Focus Area (SFA) at the Pacific Northwest National Laboratory (PNNL). PNNL is operated by Battelle for DOE under Contract DE-AC06-76RLO1830. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Watershed systems play a critical role in human society and environmental health by providing ecosystem services such as drinking water for humans, water for irrigation and industrial activities, and habitats for plants and animals (<xref rid="ref-7" ref-type="bibr">Postel &amp; Thompson Jr, 2005</xref>). The associated river corridors, including the river, adjacent land, and subsurface environments, are key components of watershed systems (<xref rid="ref-5" ref-type="bibr">Harvey &amp; Gooseff, 2015</xref>). Recurring, episodic, or chronic perturbations to river corridors, such as those caused by dam operations, wastewater effluent, floods, storm pulses, and droughts, are common but difficult to study due to their transient nature. Understanding the connections among hydrologic, biogeochemical, and microbial function within river corridors is not only important to help predict the outcomes of these perturbations in terms of watershed function, but also to maintain a healthy environment (<xref rid="ref-4" ref-type="bibr">Graham et al., 2019</xref>). The Worldwide Hydrobiogeochemistry Observation Network for Dynamic River Systems (WHONDRS) (<xref rid="ref-12" ref-type="bibr">Stegen &amp; Goldman, 2018</xref>) is a global consortium of researchers and other interested parties dedicated to studying these connections.</p>
    <p>WHONDRS generates knowledge across river corridors from local to global scales. For one ongoing study, surface water metabolite and microbiome samples are collected by local collaborators around the world through a global survey. This study aims to provide broad understanding of the functioning of dynamic river corridors. Metabolomics analysis via Fourier transform ion cyclotron resonance mass spectrometry (FTICR-MS) (<xref rid="ref-6" ref-type="bibr">Marshall, Hendrickson &amp; Jackson, 1998</xref>) and a supporting suite of geochemical analyses have been conducted through the Environmental Molecular Sciences Laboratory (EMSL) for the field-collected samples. The data obtained are intended to inform mechanistic and data-driven models to enhance predictions of the hydro-biogeochemical function of river corridors and watersheds, thus serving as a critical component of the model-data integration process (<xref rid="ref-9" ref-type="bibr">Scheibe et al., 2018</xref>). However, as the number of collected samples increases, the resulting WHONDRS data package will reach a size and complexity that makes it challenging for researchers to manage and search for the part of the data package in which they are most interested.</p>
    <p>To support the efforts of multi-domain integration of physical, biological, and chemical processes within river corridors, a shiny-based web application called WHONDRS-GUI was created. This web app is intended to make the collected, ever-growing WHONDRS data package more accessible for researchers to use in performing new analyses or updating prior analyses, in keeping with the FAIR principles for scientific data management (<xref rid="ref-14" ref-type="bibr">Wilkinson, 2016</xref>).</p>
    <p>The WHONDRS-GUI is a user-friendly graphical user interface (GUI) developed using R (<xref rid="ref-8" ref-type="bibr">R Development Core Team, 2018</xref>), and Shiny (<xref rid="ref-15" ref-type="bibr">Winston Chang et al., 2018</xref>). Like any other Shiny app, the WHONDRS-GUI can run on any modern web browser without any programming or operational system requirements. It provides open, well-structured, discoverable data, visualization of specific data types, as well as a global map of all collected sampling sites. Together with a context-aware dynamic user interface, the WHONDRS-GUI includes functionality for searching, compiling, integrating, and exporting different data types that can easily be used by the scientific community. The data types used to build WHONDRS-GUI include metadata of collected surface water samples, FTICR data and geochemistry data from analyses performed in EMSL, surface water hydrographs collected from existing instrumentation, and standardized photos of each field system (<xref rid="ref-11" ref-type="bibr">Stegen et al., 2018</xref>). By engaging with the global scientific community, the WHONDRS-GUI promotes sharing and extracting knowledge from the WHONDRS data package (<xref rid="ref-11" ref-type="bibr">Stegen et al., 2018</xref>), and enables researchers to better address science questions relevant to their individual sites as well as perform integrative cross-site analyses.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials &amp; Methods</title>
    <sec>
      <title>Data sources and description</title>
      <p>The data package used in this study is from an on-going global survey of surface water metabolites that started in 2018. Surface water metabolites and microbiome samples from streams and river corridors around the world were collected by local collaborators and sent to EMSL for analysis. Metabolomics analysis via FTICR-MS and a suite of geochemical analyses were conducted on all samples at EMSL. The application is designed to use five different data types from the data package:</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label> 1.</label>
          <p>Metadata of collected surface water samples. These are recorded by local collaborators who collected the surface water samples. The metadata include names of samplers, sample ID, sampling time, location, water temperature, distance from gauging station, and river names of the water samples.</p>
        </list-item>
        <list-item>
          <label> 2.</label>
          <p>FTICR-MS data. These are results of metabolomic analysis for collected surface water samples.</p>
        </list-item>
        <list-item>
          <label> 3.</label>
          <p>Basic geochemistry data. These are results of geochemistry analyses conducted for surface water samples, including ion and non-purgeable organic carbon concentrations.</p>
        </list-item>
        <list-item>
          <label> 4.</label>
          <p>Surface water hydrographs. These are open-access water-resources data of gauging stations downloaded from United States Geological Survey (USGS) website based on sampling locations of collected surface water samples.</p>
        </list-item>
        <list-item>
          <label> 5.</label>
          <p>Standardized photos taken from each field system. These are photos of field systems taken by collaborators.</p>
        </list-item>
      </list>
      <p>Following data cleaning, manipulation and adjustment of raw data (performed using the ‘dplyr’ R package (<xref rid="ref-13" ref-type="bibr">Wickham et al., 2015</xref>)), all available data types, except photos, were saved in comma-separated values (CSV) file format. The processed data types were then used as inputs for building the WHONDRS-GUI. The WHONDRS-GUI provides the option of downloading all or part of the data package for users who are interested in performing their own analysis.</p>
    </sec>
    <sec>
      <title>Graphical user interface</title>
      <p>The WHONDRS-GUI interface was created in R console using Shiny and its supplementary packages. It is an interactive web application that can be run on a local machine using R or R studio. The web application is also deployed online by hosting to Shiny Server. This allows for fast access to and easy sharing of the web application through any modern web browser.</p>
      <p>The WHONDRS-GUI interface is organized into dashboard pages using the ‘shinydashboard’ package (<xref rid="ref-1" ref-type="bibr">Chang &amp; Borges Ribeiro, 2017</xref>). It utilizes a tab-based dashboard format to make accessing each data type fast and intuitive. Data types, such as ‘Metadata’, ‘FTICR’, ‘Geochemistry’, ‘Hydrograph’ and ‘Photo’, are displayed with their names listed on the left-hand sidebar of the interface. The output tables, maps, and plots are displayed to the right of the sidebar, as the main body of the dashboard page. Users can explore each data type by clicking tab names on the left. This will result in the corresponding output page appearing on the right.</p>
      <p>The first tab on the left-hand sidebar of the interface, and the landing dashboard page when the web application is first loaded, is the ‘Home’ tab. Clicking this tab will lead users to the homepage of the web application. This page gives a short description of the WHONDRS-GUI. Clicking the ‘GET STARTED’ action button below the description paragraph will lead users to the ‘Help’ dashboard page, where users can find more information about the web application and how to navigate it locally.</p>
      <p>Following the ‘Home’ dashboard page are dashboards pages for the five available data types, including ‘Metadata’, ‘FTICR’, ‘Geochemistry’, ‘Hydrograph’ and ‘Photo’. User input widgets on the top of these dashboard pages, allow users to search for a subset of data based on different options. As shown in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>, these options include selecting latitude and longitude of a specific site, selecting site IDs, or dragging a bounding box on the map. Each option requires different inputs as searching criteria. For example, there are two inputs for the latitude/longitude option. One is the latitude and longitude values of a site, which can be chosen directly from the ‘Lat/Lon’ input widget. The other input is the distance value from a selected site, which can be obtained by dragging the slider of the ‘Distance(miles)’ widget.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.9277/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Metadata dashboard page.</title>
          <p>The ‘Metadata’ dashboard page shows a global map of collected sampling sites. User input widgets on the top of the page, including ’Latitude/Longtitude’, ’Bounding Box’, ’Site ID’, or ’All Stie IDs’, allow users to search for a subset of data based on different options. Clicking a marker on the map will return the metadata of the selected site.</p>
        </caption>
        <graphic xlink:href="peerj-08-9277-g001"/>
      </fig>
      <p>Dashboard pages for all data types except ‘Photo’ display a well-structured data table for selected sites. For the ‘Metadata’ dashboard page, it also displays a global map of collected sampling sites. Clicking a marker on the map will return the metadata of the selected site, which includes site ID, location, river name, and sampling date, as shown in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>. Apart from displaying data tables for a selected site, the ‘Hydrograph’ dashboard page displays a time-series plot of discharge and/or gage height for the selected site. This allows users to visually assess the quality of the timeseries data and see how gage height and discharge change over time for the site that they are interested in. Dragging the slider of the ‘Time range (days)’ widget allow users to change the time period of discharge and gage height.</p>
      <p>In the ‘Photo’ dashboard page, four standardized photos of a selected field system are exhibited. This allows users to know the physical environment where the surface water samples were collected. The previously selected subset of data can be exported to a separate folder in the default directory by clicking the ‘Save Data’ button in the selected dashboard. Users can then use the exported subset of data locally for their research needs.</p>
    </sec>
    <sec>
      <title>Availability</title>
      <p>The WHONDRS-GUI is available through Shiny Server (<ext-link ext-link-type="uri" xlink:href="https://xmlin.shinyapps.io/whondrs/">https://xmlin.shinyapps.io/whondrs/</ext-link>) for online use, which allows users to get access to the web application through any modern web browser without installing R or R studio. The website is free and open to all users without login requirement. The WHONDRS data package as well as the R code are hosted on the ESS-DIVE data archive (<ext-link ext-link-type="uri" xlink:href="https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811">https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811</ext-link>). This enables users to simultaneously obtain access to the data and code and to subsequently launch the web app locally from any R environment (e.g., R and RStudio) without any programming or operational system requirements. Documentation for how to run the WHONDRS-GUI locally can be found in the downloaded package.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <p>The WHONDRS-GUI, a web application written in R programming language, has been successfully implemented to assist in searching, compiling, visualizing, integrating and exporting different data types from the WHONDRS data package. It makes the ever-growing WHONDRS data package more accessible for researchers to use in performing new analyses or updating prior analyses. As an interactive web application, the WHONDRS-GUI is simple and intuitive to use without the need to download and install any specialized software.</p>
    <p>The WHONDRS-GUI web application provides interactive data tables, global maps, timeseries plots and standardized river photos of water samples collected across the world. Five data types, which include ‘Metadata’, ‘FTICR’, ‘Geochemistry’, ‘Hydrograph’ and ‘Photo’, are being used to demonstrate the collected WHONDRS data. Data processing, subsetting and manipulating are done automatically based on user inputs, such as latitude/ longitude, site ID and distance.</p>
    <p>Useful and detailed metadata of the collected samples are available on the ‘Metadata’ dashboard page. These metadata include site ID, sampling time, location, and river names of the water samples etc. A global map interactively displaying physical locations of selected samples based on user inputs is also available on the same dashboard page (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>). The global map will automatically zoom in or zoom out according to the number of selected site IDs.</p>
    <p>Data tables for all data types except ‘Photo’ are generated for selected sample sites on corresponding dashboard pages. <xref ref-type="fig" rid="fig-2">Figure 2</xref> shows a preview of the geochemistry data table for seven selected sites in the ‘Geochemistry’ dashboard page. For the analysis of hydrograph data, depending on the chosen sample ID, a plot of discharge and/or gage height is generated showing the changing pattern of discharge and/or gage height over time, as shown in <xref ref-type="fig" rid="fig-3">Fig. 3</xref>. The time-series plot is a variable width plot that defaults to show a time range of 30 days start from the earliest day of the available data. The time range can be adjusted between 1 day to 365 days using the slider of the ‘Time range (days)’ widget (<xref ref-type="fig" rid="fig-3">Fig. 3</xref>).</p>
    <fig id="fig-2" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.9277/fig-2</object-id>
      <label>Figure 2</label>
      <caption>
        <title>Geochemistry dashboard page.</title>
        <p>A preview of the geochemistry data table for seven selected sites.</p>
      </caption>
      <graphic xlink:href="peerj-08-9277-g002"/>
    </fig>
    <fig id="fig-3" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.9277/fig-3</object-id>
      <label>Figure 3</label>
      <caption>
        <title>Hydrograph dashboard page.</title>
        <p>This dashboard page displays an interactive time-series plot of discharge and/or gage height for a selected site. The plot shown in this fugure is a time-series plot of discharge and gage height for site ‘S000009’.</p>
      </caption>
      <graphic xlink:href="peerj-08-9277-g003"/>
    </fig>
    <p>Apart from the functionality of the WHONDRS-GUI demonstrated above, it also provides the option for users who are interested in performing further analyses of the data to download the whole data package or part of it, and to save to local drive, by clicking the ‘Save Data’ button on the dashboard page. If a user identifies a bug or problem while running the WHONDRS-GUI, it can be reported under the ”Issue Report” section. The bug report form is hosted on Google Drive and records each bug report and transmits it to the WHONDRS team automatically.</p>
    <p>The results described above show that the WHONDRS-GUI provides simple and convenient tools for researchers with limited programming experience to access and manipulate the WHONDRS data, and to interactively visualize some of the data types. The web application also offers a solution to integrate large amount of information contained in WHONDRS data with an intuitive and user-friendly interface, which further facilitates the use and exploration of WHONDRS data by the wider scientific community. The current version of the web application is focused on the ability to quickly demonstrate available data types, with limited ability to perform data analysis. Also, the format of input and output data used by the web application is limited to CSV file. To improve the flexibility of the WHONDRS-GUI and its ability to conduct more advanced data analysis, we will continue to develop this web application and implement these user-friendly changes in future versions.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>WHONDRS data are being collected to understand multi-domain connections within river corridors and help predict watershed function. In this work, we developed a web application, WHONDRS-GUI, to make WHONDRS data findable, accessible, interoperable, and reusable (<xref rid="ref-14" ref-type="bibr">Wilkinson et al., 2016</xref>) and to encourage users to perform their own analyses and extract new information from the data. The WHONDRS-GUI provides a convenient and user-friendly interface for different WHONDRS data types. It allows users to dynamically interact with the data package. Researchers can utilize the WHONDRS-GUI to find specific sample data.</p>
    <p>The WHONDRS-GUI is an important element of understanding connections among hydrologic, biogeochemical, and microbial function within river corridors. The GUI alone will not provide this understanding, however, and must be coupled with additional analyses and tools as well as additional data types that are not currently in the datasets. For example, detailed molecular properties of dissolved organic matter (DOM) are provided by the FTICR data, which can be paired with data on environmental characteristics (e.g., vegetation type, land use, ecosystem productivity, etc.) that are publicly available. Because all WHONDRS data are georeferenced, these additional environmental data can be extracted from other sources and paired with WHONDRS data to evaluate aspects of the environment that explain variation in DOM chemistry at the global scale. Outcomes of such analyses would provide novel hypotheses to be evaluated through additional sampling, experimentation, and/or modeling.</p>
    <p>The data can also be more directly analyzed to understand spatial and temporal variation in biogeochemically-relevant properties, such as the thermodynamic favorability of DOM for microbial oxidation. For example, (<xref rid="ref-2" ref-type="bibr">Danczak et al., 2020a</xref>; <xref rid="ref-3" ref-type="bibr">Danczak et al., 2020b</xref>) recently discovered the principle of ‘thermodynamic redundancy,’ whereby compositionally distinct metabolomes exhibit consistent levels of thermodynamic favorability. This new principle was revealed, in part, by linking FTICR data to a new conceptual/theoretical framework derived from meta-community ecology (<xref rid="ref-2" ref-type="bibr">Danczak et al., 2020a</xref>; <xref rid="ref-3" ref-type="bibr">Danczak et al., 2020b</xref>). This framework is referred to as ‘meta-metabolome ecology’ and provides a new window into river corridor function by integrating ecological principles with ultrahigh resolution molecular properties of DOM chemistry. The data necessary to use tools/concepts from meta-metabolome ecology can be accessed via the WHONDRS-GUI.</p>
    <p>To provide additional opportunities to generate new knowledge of integrated river corridor function, WHONDRS is collaborating with the Joint Genome Institute (JGI) to generate metagenomic and metatranscriptomic data of microbial communities. These data can be used with the FTICR and geochemical data (from the WHONDRS-GUI) to inform biogeochemical reaction network models that can be further integrated with reactive transport codes that simulate reactions and the movement of water and other materials (e.g., nutrients) through river corridors. The develop of such an integrated modeling framework is nascent, and some of the critical theory and modeling tools have recently been developed (<xref rid="ref-10" ref-type="bibr">Song et al., 2020</xref>). There are significant efforts underway to implement this integrated framework via publicly available tools in the US Department of Energy Systems Biology Knowledgebase (KBase; <ext-link ext-link-type="uri" xlink:href="https://kbase.us/">https://kbase.us/</ext-link>). Once fully implemented, researchers will be able to discover and access WHONDRS data using the GUI and other tools, and then integrate/study these data using tools in KBase that generate and link metabolic, biogeochemical reaction, and reactive transport models. This offers myriad opportunities to generate new knowledge, such as how hydrologic perturbation impacts biogeochemical function via changes to microbial metabolism. Researchers could use numerical <italic>in silico</italic> experimentation across places and times sampled by WHONDRS to study such impacts and connections. The WHONDRS-GUI is a key piece of the cyberinfrastructure needed to enable such studies and the broader vision of understanding connections among hydrologic, biogeochemical, and microbial function within river corridors.</p>
    <p>Both the data package and the R code are hosted on the ESS-DIVE data archive (<ext-link ext-link-type="uri" xlink:href="https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811">https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811</ext-link>), which enables users to simultaneously obtain access to the data and code and to subsequently run the web app locally. The WHONDRS-GUI is also available for online use at Shiny Server (<ext-link ext-link-type="uri" xlink:href="https://xmlin.shinyapps.io/whondrs/">https://xmlin.shinyapps.io/whondrs/</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title> Supplemental Information</title>
    <supplementary-material content-type="local-data" id="supp-1">
      <object-id pub-id-type="doi">10.7717/peerj.9277/supp-1</object-id>
      <label>Supplemental Information 1</label>
      <caption>
        <title>R script files for the web application</title>
      </caption>
      <media xlink:href="peerj-08-9277-s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank all collaborators for collecting the surface water samples and the EMSL teams for conducting a series of metabolomics analysis and geochemical analyses.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>Timothy D. Scheibe is an Academic Editor for PeerJ.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Xinming Lin</xref> conceived and designed the experiments, performed the experiments, analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Huiying Ren</xref> and <xref ref-type="contrib" rid="author-3">Amy E. Goldman</xref> conceived and designed the experiments, performed the experiments, analyzed the data, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn id="contribution-4" fn-type="con">
        <p><xref ref-type="contrib" rid="author-4">James C. Stegen</xref> and <xref ref-type="contrib" rid="author-5">Timothy D. Scheibe</xref> conceived and designed the experiments, performed the experiments, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The codes and data package are available at:</p>
        <p>Stegen JC; Goldman AE; Blackburn S E ; Chu RK ; Danczak RE; Garayburu-Caruso VA; Graham EB; Grieshauber C; Lin X; Morad JW; Ren H; Renteria L; Resch CT; Tfaily M; Tolic N ; Toyoda JG ; Wells JR ; Znotinas KR (2018): WHONDRS Surface Water Sampling for Metabolite Biogeography. Worldwide Hydrobiogeochemistry Observation Network for Dynamic River Systems (WHONDRS). DOI: <ext-link ext-link-type="uri" xlink:href="https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811">https://data.ess-dive.lbl.gov/view/doi:10.15485/1484811</ext-link>.</p>
        <p>The web application is available for online use at Shiny Server <ext-link ext-link-type="uri" xlink:href="https://xmlin.shinyapps.io/whondrs/">https://xmlin.shinyapps.io/whondrs/</ext-link>).</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Chang &amp; Borges Ribeiro (2017)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Borges Ribeiro</surname>
            <given-names>BJRPV</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <data-title>Shinydashboard: create dashboards with ‘Shiny’</data-title>
        <version designator="0.7.1">R package version 0.7.1</version>
        <uri xlink:href="https://CRAN.R-project.org/package=shinydashboard">https://CRAN.R-project.org/package=shinydashboard</uri>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Danczak et al. (2020a)</label>
      <element-citation publication-type="working-paper">
        <person-group person-group-type="author">
          <name>
            <surname>Danczak</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Fansler</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Tfaily</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Toyoda</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Stegen</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <year>2020a</year>
        <article-title>Unification of environmental metabolomics with metacommunity ecology</article-title>
        <source>bioRxiv</source>
        <pub-id pub-id-type="doi">10.1101/2020.01.31.929364</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Danczak et al. (2020b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danczak</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Toyoda</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Garayburu-Caruso</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Tolić</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Morad</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Renteria</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <year>2020b</year>
        <article-title>Ecological theory applied to environmental metabolomes reveals compositional divergence despite conserved molecular properties</article-title>
        <source>bioRxiv</source>
        <pub-id pub-id-type="doi">10.1101/2020.02.12.946459</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Graham et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graham</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Stegen</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Scheibe</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <year>2019</year>
        <article-title>Subsurface biogeochemistry is a missing link between ecology and hydrology in dam-impacted river corridors</article-title>
        <source>Science of the Total Environment</source>
        <volume>657</volume>
        <fpage>435</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="doi">10.1016/j.scitotenv.2018.11.414</pub-id>
        <pub-id pub-id-type="pmid">30550907</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Harvey &amp; Gooseff (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harvey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gooseff</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>River corridor science: hydrologic exchange and ecological consequences from bedforms to basins</article-title>
        <source>Water Resources Research</source>
        <volume>51</volume>
        <issue>9</issue>
        <fpage>6893</fpage>
        <lpage>6922</lpage>
        <pub-id pub-id-type="doi">10.1002/2015WR017617</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Marshall, Hendrickson &amp; Jackson (1998)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Marshall</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>GSJMSR</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Fourier transform ion cyclotron resonance mass spectrometry: a primer</article-title>
        <comment><bold>17(1)</bold>:1–35</comment>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Postel &amp; Thompson Jr (2005)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Postel</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Thompson Jr</surname>
            <given-names>BH</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Watershed protection: capturing the benefits of nature’s water supply services</article-title>
        <source>Natural Resources Forum</source>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>98</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1477-8947.2005.00119.x</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>R Development Core Team (2018)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Development Core Team</collab>
        </person-group>
        <year>2018</year>
        <data-title>R: a language and environment for statistical computing</data-title>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <uri xlink:href="http://www.R-project.org/">http://www.R-project.org/</uri>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Scheibe et al. (2018)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Scheibe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stegen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garayburu-Caruso</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2018</year>
        <article-title>Data-model integration for improved prediction of river corridor and watershed function</article-title>
        <conf-name>AGUFM 2018:H11H-1557</conf-name>
        <pub-id pub-id-type="doi">10.1002/essoar.10500258.1</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Song et al. (2020)</label>
      <element-citation publication-type="working-paper">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>H-S</given-names>
          </name>
          <name>
            <surname>Stegen</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J-Y</given-names>
          </name>
          <name>
            <surname>Garayburu-Caruso</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Moulton JD</surname>
          </name>
          <name>
            <surname>Scheibe</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <year>2020</year>
        <article-title>Representing organic matter thermodynamics in biogeochemical reactions via substrate-explicit modeling</article-title>
        <source>bioRxiv</source>
        <pub-id pub-id-type="doi">10.1101/2020.02.27.968669</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Stegen et al. (2018)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stegen</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Blackburn</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Danczak</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Garayburu-Caruso</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Grieshauber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Morad</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Renteria</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Resch</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Tfaily</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tolic</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Toyoda</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Znotinas</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Bouskill</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Newcomer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Saify</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Soltanian</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Trustschel</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Turetcaia</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2018</year>
        <article-title>WHONDRS surface water sampling for metabolite biogeography. United States</article-title>
        <pub-id pub-id-type="doi">10.15485/1484811</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Stegen &amp; Goldman (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegen</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <year>2018</year>
        <article-title>WHONDRS: a community resource for studying dynamic river corridors</article-title>
        <source>American Society for Microbiology Journals</source>
        <volume>3</volume>
        <issue>5</issue>
        <elocation-id>e00151-18</elocation-id>
        <pub-id pub-id-type="doi">10.1128/mSystems.00151-18</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Wickham et al. (2015)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Frano̧is</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <data-title>dplyr: a grammar of data manipulation</data-title>
        <version designator="1.0.0">R package version 1.0.0</version>
        <uri xlink:href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</uri>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Wilkinson et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Dumontier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aalbersberg</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Appleton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Axton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blomberg</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boiten</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>da Silva Santos</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <year>2016</year>
        <article-title>The FAIR guiding principles for scientific data management and stewardship</article-title>
        <source>Scientific Data</source>
        <volume>3</volume>
        <elocation-id>160018</elocation-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.18</pub-id>
        <pub-id pub-id-type="pmid">26978244</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Winston Chang et al. (2018)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Winston Chang</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Allaire</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2018</year>
        <data-title>shiny: web application framework for R</data-title>
        <version designator="1.3.2">R package version 1.3.2</version>
        <uri xlink:href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
