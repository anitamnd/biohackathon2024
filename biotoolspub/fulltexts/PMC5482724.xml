<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5482724</article-id>
    <article-id pub-id-type="pmid">28436466</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.4267</article-id>
    <article-id pub-id-type="manuscript">nihpa864151</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Genome-wide profiling of heritable and <italic>de novo</italic> STR
variations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Willems</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="FN1" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zielinski</surname>
          <given-names>Dina</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gordon</surname>
          <given-names>Assaf</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gymrek</surname>
          <given-names>Melissa</given-names>
        </name>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref ref-type="aff" rid="A5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Erlich</surname>
          <given-names>Yaniv</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A6">6</xref>
        <xref rid="FN1" ref-type="author-notes">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>New York Genome Center, New York, New York 10013, USA</aff>
    <aff id="A2"><label>2</label>Computational and Systems Biology Program, MIT, Cambridge,
Massachusetts 02139, USA</aff>
    <aff id="A3"><label>3</label>Department of Computer Science, Fu Foundation School of Engineering,
Columbia University, New York, New York 10027, USA</aff>
    <aff id="A4"><label>4</label>Analytic and Translational Genetics Unit, Massachusetts General
Hospital, Boston, Massachusetts, USA</aff>
    <aff id="A5"><label>5</label>Program in Medical and Population Genetics, Broad Institute of MIT
and Harvard, Cambridge, Massachusetts, USA</aff>
    <aff id="A6"><label>6</label>Center for Computational Biology and Bioinformatics, Columbia
University, New York, New York 10032, USA</aff>
    <author-notes>
      <corresp id="FN1"><label>*</label>To whom correspondence should be addressed: Y.E.
(<email>yaniv@cs.columbia.edu</email>) or T.W.
(<email>tfwillems@gmail.com</email>)</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>12</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <volume>14</volume>
    <issue>6</issue>
    <fpage>590</fpage>
    <lpage>592</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.4267-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the
content in such documents, for the purposes of academic research, subject
always to the full Conditions of use: <uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Short tandem repeats (STRs) are highly variable elements that play a
pivotal role in multiple genetic diseases, population genetics applications, and
forensic casework. However, STRs have proven problematic to genotype from
high-throughput sequencing data. Here, we describe HipSTR, a novel
haplotype-based method for robustly genotyping and phasing STRs from Illumina
sequencing data and report a genome-wide analysis and validation of <italic>de
novo</italic> STR mutations.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Main Text</title>
    <p id="P2">The impact of genomics is contingent upon its ability to identify genetic
variants. While tremendous progress has been made in identifying nearly every type
of genetic variation, short tandem repeat (STR) variations remain largely
understudied. Composed of repeating 1–6 base pair motifs, STRs are among the
most polymorphic variants in the human genome and are present at over 1 million
loci. STRs play a key etiological role in more than 30 Mendelian disorders<sup><xref rid="R1" ref-type="bibr">1</xref></sup> and recent evidence has underscored
their profound regulatory role and potential involvement in complex traits<sup><xref rid="R2" ref-type="bibr">2</xref>–<xref rid="R4" ref-type="bibr">4</xref></sup>. Beyond medical genetics, STRs have applications in
population genetics, forensics, and single cell lineage analysis. While several STR
callers exist<sup><xref rid="R5" ref-type="bibr">5</xref>, <xref rid="R6" ref-type="bibr">6</xref></sup>, they suffer from limited accuracy,
difficulties in calling homopolymer runs, sensitivity to PCR stutter noise, and
limited functionality compared to SNP callers. As a result, large-scale
projects<sup><xref rid="R7" ref-type="bibr">7</xref>–<xref rid="R9" ref-type="bibr">9</xref></sup> are reluctant to report STR genotypes and are
essentially blind to many of the most variable parts of the genome.</p>
    <p id="P3">Here, we developed a novel algorithm called HipSTR (Haplotype inference and
phasing for STRs) to create a mature tool for STR studies. HipSTR builds on our
extensive experience with STR genotyping<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, addresses major limitations of existing STR tools, and is
designed for Illumina reads (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Briefly, HipSTR begins by learning a parametric
model that captures each STR’s stutter noise profile. Using the genomic
location of the repeat, it then harnesses this profile and a hidden Markov model
(HMM) to realign the STR-containing reads to candidate haplotypes and mitigate the
effects of PCR stutter (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref>). The realignment framework is highly flexible and
can integrate population-scale data from other individuals and phased SNP scaffolds
to determine the most likely alleles, conferring robustness to the genotyping
process (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figs.
3–4</xref>). The output of HipSTR is a VCF file that consolidates all of
an STR’s variants into a single line.</p>
    <p id="P4">We benchmarked HipSTR’s accuracy by comparing its STR calls from
whole genome sequencing (WGS) data to capillary electrophoresis data, the current
gold standard for STR genotyping. To this end, we obtained 263 WGS datasets from the
Simons Genome Diversity Project (SGDP)<sup><xref rid="R10" ref-type="bibr">10</xref></sup> that were sequenced with an Illumina 100bp paired-end PCR-free
protocol to at least 30× coverage. A subset of these samples also have
capillary electrophoresis calls for 600 highly polymorphic STRs from the Marshfield
panel<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, providing a
challenging test case for STR callers. The capillary calls for a few duplicated
samples showed an internal consistency of ~98.5%, setting an upper bound on
the accuracy achievable in our tests. For comparison, we also genotyped the same
STRs with two STR-specific tools: lobSTR<sup><xref rid="R5" ref-type="bibr">5</xref></sup> and RepeatSeq<sup><xref rid="R6" ref-type="bibr">6</xref></sup>.
We optimized command line options to boost the accuracy of each tool and developed a
machine learning approach to rank each tool’s calls by quality (<xref rid="SD2" ref-type="supplementary-material">Supplementary Tables
1–2</xref>). Under all settings, HipSTR outperformed these tools. HipSTR
achieved an overall accuracy of 95.2%, while lobSTR and RepeatSeq achieved
overall accuracies of 88.2% and 57.8%, respectively (<xref rid="F1" ref-type="fig">Figure 1</xref>; <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>; <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref>). After filtering
the 10% least confident genotypes, HipSTR again exhibited superior
performance and its accuracy improved to 98.9%, saturating the capillary
data’s limit.</p>
    <p id="P5">Using the same benchmarking framework, we compared HipSTR to five widely used
variant callers: GATK HaplotypeCaller (GATK-HC)<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, Platypus<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, freebayes<sup><xref rid="R14" ref-type="bibr">14</xref></sup>,
SAMtools<sup><xref rid="R15" ref-type="bibr">15</xref></sup> and
VarScan<sup><xref rid="R16" ref-type="bibr">16</xref></sup> (<xref rid="F1" ref-type="fig">Figure 1</xref>; <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>; <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref>). Variant callers
that require reliable input alignments (SAMtools and VarScan) were the least
accurate, highlighting the challenges posed by repetitive regions. Local
assembly-based approaches demonstrated improved accuracy, but HipSTR outperformed
these tools under all relevant scenarios. GATK-HC was consistently the second best
tool, but it required 4.4x more computation time than HipSTR and only achieved
comparable accuracy after filtering a majority of calls. Analyses of downsampled
data from the SGDP indicated that HipSTR also consistently outperformed GATK-HC
across a wide range of sequencing coverage (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6</xref>).</p>
    <p id="P6">To explore the performance of HipSTR with longer Illumina reads, we performed
2×300bp targeted MiSeq sequencing of a panel of long forensic STRs in a
single individual from our lab collection. The resulting HipSTR calls perfectly
matched the capillary results even for markers with alleles longer than 100bp (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref>),
demonstrating that it has no intrinsic limitations in calling STRs other than
Illumina read lengths.</p>
    <p id="P7">Next, we evaluated the ability of HipSTR to report not only length
polymorphisms but also full STR haplotypes. About half of the STRs in the genome
display a repeat structure that includes short interruptions to the recurrent
motif<sup><xref rid="R17" ref-type="bibr">17</xref></sup>. Thus, two STR
alleles with identical lengths can differ in sequence due to distinct evolutionary
paths<sup><xref rid="R18" ref-type="bibr">18</xref></sup> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref>). Current STR
callers and capillary electrophoresis methods only report an STR’s length
and cannot differentiate between homoplastic alleles. Similarly, general-purpose
tools typically report multiple unphased variants per STR, limiting the utility of
these calls (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table
5</xref>). As HipSTR reports fully phased diploid STR sequences, we sought to
test its accuracy using the CEPH trio in the Illumina Platinum genomes dataset. For
~70,700 STR loci that passed our filters, at least two alleles had identical lengths
but different sequences. Only 304 of these loci (0.4%) were inconsistent
with Mendelian inheritance, highlighting the robustness of the reported sequence
variations. Next, for the same trio, we measured the ability of HipSTR to physically
phase the Marshfield STR genotypes onto SNP haplotypes. For 178 loci where the
algorithm confidently phased the child, we were also able to determine the
transmitted paternal and maternal STR alleles. In all 178 instances, HipSTR
correctly phased the paternal STR allele onto the paternal SNP scaffold. Taken
together, our results highlight that HipSTR not only accurately reports length
polymorphisms but also adds valuable information about the sequence and haplotype
context of STR variants.</p>
    <p id="P8">We found that HipSTR is scalable and apt to the analysis of large-scale
sequencing data. We ran HipSTR on 2,000 Illumina whole genome sequencing datasets
with at least 30× coverage available at the New York Genome Center. Using
HipSTR to genotype 1.6 million STRs in the human genome only required an average of
10 CPU hours per sample. For each genome, HipSTR reported an average of ~360,000 STR
loci that differed from the human reference.</p>
    <p id="P9">Encouraged by the accuracy and scalability of HipSTR, we wondered about its
ability to identity <italic>de novo</italic> STR mutations (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8</xref>). After genotyping
~1.6 million STRs in the CEPH trio, HipSTR identified ~745,000 loci with at least
one length variation. To enhance the specificity of our analysis, we applied
stringent quality filters and restricted our analysis to ~265,000 STRs. Across these
loci, HipSTR identified 423 <italic>de novo</italic> STR variants in which the child
possessed an allele length not observed in the parental genotypes. To validate these
mutations, we re-ran HipSTR on distinct Illumina datasets generated for these
samples and compared the variants between runs. Notably, 358 (85%) of the
mutations replicated as all samples’ allele lengths matched perfectly. These
<italic>de novo</italic> mutations predominantly occurred at homopolymer repeats
(293/358=81%). To further validate our results, we used Sanger
sequencing to genotype a subset of these loci. We TOPO cloned the STR alleles from
each member of the trio and sequenced at least eight independent clones per
individual, yielding high confidence Sanger calls for four STRs (<xref rid="F2" ref-type="fig">Figure 2</xref>, <xref rid="SD1" ref-type="supplementary-material">Supplementary Figs. 9–12</xref>). In
all cases, the Sanger calls confirmed the parental genotypes and the <italic>de
novo</italic> allele reported by HipSTR, validating our method.</p>
    <p id="P10">Finally, we sought to distinguish <italic>de novo</italic> STR variants that
arose in the germline of the child (NA12878) from mutations that arose during
cell-line passages of this sample. We used HipSTR to analyze the WGS data of her 11
offspring at the 358 STRs with a replicable mutation. For 31 loci, the <italic>de
novo</italic> allele was transmitted to at least three offspring and was absent
from the paternal genotype. For an additional 32 loci, the <italic>de novo</italic>
allele was observed in at least three of her offspring, but the husband carried the
same allele and the transmission could not be fully resolved. As we identified these
31 transmitted mutations by examining only ~35% of NA12878’s STRs,
the load of <italic>de novo</italic> STR mutations may rival the approximately 70
<italic>de novo</italic> SNP mutations expected per generation<sup><xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R19" ref-type="bibr">19</xref></sup>. However, we cannot exclude the possibility that some of these
detected mutations are actually due to cell-line mutations in NA12878’s
parents. Future studies using patient-derived DNA samples will therefore be
invaluable towards assessing the true contribution of STRs to <italic>de
novo</italic> variation.</p>
    <p id="P11">To summarize, our results show that HipSTR offers several advantages for STR
calling. First, the technique is considerably more accurate than other variant
callers and has exceptional computational tractability. Second, HipSTR offers new
capabilities such as phasing, haplotyping, and reporting full STR sequences,
important features for population genetic analyses, forensic work, and STR
association studies. Finally, our method enables highly specific detection of
<italic>de novo</italic> STR mutations. As HipSTR is limited to Illumina
sequencing data, future efforts may benefit from adapting it to linked reads or
longer reads from platforms such as PacBio and Oxford Nanopore. It is our hope that
these efforts, in addition to applying HipSTR to increasingly rich Illumina
datasets, will help unravel the role of STRs in human diseases and complex
traits.</p>
  </sec>
  <sec id="S2" specific-use="web-only">
    <title>Online Methods</title>
    <sec id="S3">
      <title>The HipSTR algorithm</title>
      <sec id="S4">
        <title>Modeling PCR stutter</title>
        <p id="P12">PCR stutter artifacts add or remove copies of an STR’s motif
to sequencing reads, resulting in observed STR sizes that differ from the
true underlying genotype. To mitigate these effects, we used a model that we
developed and extensively validated in our previous work to discern between
stutter noise and STR mutations on the Y chromosome<sup><xref rid="R20" ref-type="bibr">20</xref></sup>. HipSTR constructs a stutter model
<italic>θ<sub>x</sub></italic> for each STR locus
<italic>x</italic>, which contains the probability that stutter adds
(<italic>u</italic> ) or removes (<italic>d</italic> ) repeats from the
true allele in an observed read, and a geometric distribution with parameter
<italic>ρ<sub>s</sub></italic> that controls the size of the
stutter-induced changes. In our framework, the probability of observing a
stutter artifact of <italic>δ</italic> repeat units is:
<disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">stutter</mml:mi><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>u</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P13">To estimate each locus’ stutter model parameters, we extract
the size of the STR observed in each read for all individuals in the
population. We then use an Expectation-Maximization<sup><xref rid="R21" ref-type="bibr">21</xref></sup> approach to learn the parameters.
The E-step computes each sample’s genotype posteriors: <disp-formula id="FD2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>u</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P14">Here, <italic>R</italic> denotes the set of all reads,
<italic>g<sub>i</sub></italic> denotes the phased genotype for the
<italic>i<sup>th</sup></italic> individual,
<italic>n<sub>reads,i</sub></italic> denotes the number of reads for
the <italic>i<sup>th</sup></italic> individual,
<italic>r<sub>m,i</sub></italic> denotes the number of repeats in the
<italic>m<sup>th</sup></italic> read for the
<italic>i<sup>th</sup></italic> individual,
<italic>r<sub>a</sub></italic> denotes the number of repeats in the
<italic>a<sup>th</sup></italic> allele and
<italic>f<sub>j</sub></italic> denotes the frequency of the
<italic>j<sup>th</sup></italic> allele. For each possible phased
genotype, the E-step also computes the conditional probability that each
read originated from either allele: <disp-formula id="FD3"><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>u</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P15">Given <italic>N</italic> samples, <italic>A</italic> alleles and
<italic>Q</italic> reads, the M-step then updates the stutter model
parameters and allele frequencies using these probabilities: <disp-formula id="FD4"><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Q</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p id="P16">Intuitively, the update rules for the stutter probabilities
<italic>u</italic> and <italic>d</italic> compute the fraction of times
a read’s STR allele is either larger or smaller than its underlying
allele. The update rule for the step size parameter
<italic>ρ<sub>s</sub></italic> is more involved, but it
first restricts the computation to reads with non-zero stutter. It then
computes the inverse of the mean weighted step size, consistent with a
maximum likelihood estimator for a geometric distribution.</p>
      </sec>
      <sec id="S5">
        <title>Generating candidate alleles</title>
        <p id="P17">To identify an initial set of STR alleles, HipSTR selects reads that
fully span the STR. It requires that both ends of a read match the reference
genome for at least 10bp and that neither end of the read has a longer exact
match with the reference genome 15bp upstream or downstream from its
alignment. Based on this subset of reads, HipSTR includes a sequence as a
candidate allele if it is present in two or more and at least 20% of
a sample’s reads.</p>
        <p id="P18">HipSTR also uses an iterative approach to identify new candidate
alleles. At the end of every round of genotyping, it computes the
maximum-likelihood genotype for each sample and realigns every read relative
to the most probable allele in its sample’s genotype. Each of these
alignments generates a sequence in the STR region. If the same sequence is
observed in a sample in two or more alignments with stutter artifacts,
HipSTR selects the sequence as a new candidate allele.</p>
      </sec>
      <sec id="S6">
        <title>Computing genotype likelihoods</title>
        <p id="P19">The genotype likelihood model integrates information about every
read’s phasing likelihood and alignment likelihood. For the
<italic>m<sup>th</sup></italic> read for individual
<italic>i</italic>,
<italic>P</italic>(<italic>p<sub>m,i</sub></italic>|<italic>h</italic>
= 1) and
<italic>P</italic>(<italic>p<sub>m,i</sub></italic>|<italic>h</italic>
= 2) denote the phasing likelihoods of the read originating from the
first and second SNP haplotypes, while
<italic>P</italic>(<italic>s<sub>m,i</sub></italic>|<italic>a</italic>
= <italic>j</italic>) denotes the alignment likelihood of the read
to the <italic>j<sup>th</sup></italic> allele. We use a uniform prior for
each unphased genotype, such that heterozygous phased genotypes have half
the prior probability of their homozygous counterparts. The likelihoods for
the <italic>i<sup>th</sup></italic> sample’s phased genotypes are:
<disp-formula id="FD5"><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      </sec>
      <sec id="S7">
        <title>Read phasing likelihoods</title>
        <p id="P20">To compute the phasing likelihoods for each read, HipSTR examines
bases in the read or its mate pair that are aligned to heterozygous SNPs
with known phase. If the read originated from a haplotype, the likelihood of
the base <italic>b<sub>i</sub></italic> matching the SNP base
<italic>h<sub>j</sub></italic> is given by the base quality
<italic>q</italic><sub><italic>b</italic><sub><italic>i</italic></sub></sub>
while the likelihood of it not matching is one third of the residual
probability. We express this as: <disp-formula id="FD6"><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P21">We compute each read’s total phasing likelihood by
multiplying <italic>Q</italic>(<italic>b<sub>i</sub></italic>,
<italic>h<sub>j</sub></italic>) for every base
<italic>b<sub>i</sub></italic> in the read or its mate pair that is
aligned to a heterozygous haplotype SNP <italic>h<sub>j</sub></italic>. In
practice, SNP calls in and around STR regions are likely to be error-prone.
We therefore exclude SNPs that are within 15 base pairs of the STR region
when computing the phasing likelihoods. If no phased SNP information is
available, HipSTR assigns equal phasing likelihoods to both of the
strands.</p>
      </sec>
      <sec id="S8">
        <title>Read alignment likelihoods</title>
        <p id="P22">HipSTR assumes that each haplotype is composed of two distinct types
of regions: flanking sequences and STR sequences (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 1</xref>). As the
sources of error prevalent in these two types of regions differ
dramatically, HipSTR uses distinct models to align sequences to each type of
region (<xref rid="SD1" ref-type="supplementary-material">Supplementary
Figure 2</xref>). It then combines the likelihoods from these two
different models at the junctions of these regions by requiring that the
read match the flanking sequence at the first base preceding the STR
sequence and at the first base following an STR sequence.</p>
      </sec>
      <sec id="S9">
        <title>Aligning reads to flanking sequences</title>
        <p id="P23">In flanking sequences, the alignment model accounts for Illumina
sequencing errors using a previously described hidden Markov model<sup><xref rid="R22" ref-type="bibr">22</xref></sup>. To efficiently align
reads in these regions, we use three matrices to recursively compute the
maximum log-likelihood of aligning read bases <italic>b</italic><sub>1</sub>
… <italic>b<sub>i</sub></italic> with haplotype bases
<italic>h</italic><sub>1</sub> … <italic>h<sub>j</sub></italic>.
The matrices <italic>Match</italic> and <italic>Ins</italic> are used to
track the log-likelihoods that read base <italic>b<sub>i</sub></italic> is
aligned to haplotype base <italic>h<sub>j</sub></italic> or an insertion
following haplotype base <italic>h<sub>j</sub></italic>, respectively.
Matrix <italic>Del</italic> tracks the maximum log-likelihood that base
<italic>b<sub>i</sub></italic> is followed by one or more deletions.
In conjunction with values for <italic>t<sub>X</sub></italic>
<sub>→</sub>
<italic><sub>Y</sub></italic>, the log-probability of transitioning from
hidden state <italic>X</italic> to hidden state <italic>Y</italic>, we use
the following recursions to fill in each matrix column-by-column:
<disp-formula id="FD7"><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="italic">Match</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">log</mml:mi><mml:mspace width="0.16667em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Match</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Del</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Del</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Ins</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Ins</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="italic">Ins</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Ins</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Ins</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Ins</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Ins</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Match</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="italic">Del</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Match</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Del</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Match</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Del</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mtext>Del</mml:mtext><mml:mo>→</mml:mo><mml:mtext>Del</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      </sec>
      <sec id="S10">
        <title>Aligning reads to STR sequences</title>
        <p id="P24">In STR regions, HipSTR utilizes an alignment model that accounts for
STR-specific errors. As PCR stutter artifacts are prevalent in this domain,
it assumes that a read’s sequence differs from the underlying
haplotype by at most one indel whose magnitude <italic>D</italic> is a
multiple of the repeat unit length <italic>M.</italic> If no stutter
artifact has occurred, the likelihood of the observed sequence is governed
by the agreement between each base in the read and its corresponding
haplotype base. The probability of no stutter artifact and aligning base
<italic>b<sub>i</sub></italic> and its preceding bases to an STR
sequence <italic>h</italic><sub>1</sub> …
<italic>h<sub>L</sub></italic> of length <italic>L</italic> is:
<disp-formula id="FD8"><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mo>max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P25">If a stutter deletion occurs, we assume that it can arise anywhere
within the STR region. We iterate over these configurations, each of which
has a likelihood given by the agreement between the sequenced bases and
their corresponding haplotype bases: <disp-formula id="FD9"><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mo>max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:mfrac></mml:mstyle><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mspace linebreak="newline"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="P26">Finally, if a stutter insertion occurs, we assume that it can
precede any base in the STR region. As PCR stutter insertions typically
contain sequences that copy the local repeat structure, we assume that
inserted sequences are periodic copies of the STR sequence directly
preceding the insertion. We therefore measure the likelihood of inserted
bases according to their agreement with this sequence. Iterating over each
possible insertion position results in the likelihood: <disp-formula id="FD10"><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mo>max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>u</mml:mi><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mi>D</mml:mi><mml:mi>M</mml:mi></mml:mfrac></mml:mstyle><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.38889em"/><mml:msub><mml:mi mathvariant="normal">h</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>mod</mml:mo><mml:mspace width="0.16667em"/><mml:mi mathvariant="normal">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>mod</mml:mo><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.16667em"/><mml:msub><mml:mi mathvariant="normal">h</mml:mi><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">L</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>mod</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec id="S11">
      <title>Experiments</title>
      <sec id="S12">
        <title>Constructing a gold standard STR dataset</title>
        <p id="P27">We downloaded capillary genotypes for 628 STRs in the Marshfield
panel from <ext-link ext-link-type="uri" xlink:href="https://web.stanford.edu/group/rosenberglab/data/rosenbergEtAl2005/combinedmicrosats-1048.stru">https://web.stanford.edu/group/rosenberglab/data/rosenbergEtAl2005/combinedmicrosats-1048.stru</ext-link>
and other information from <ext-link ext-link-type="uri" xlink:href="https://web.stanford.edu/group/rosenberglab/data/pembertonEtAl2009/Pemberton_AdditionalFile1_11242009.txt">https://web.stanford.edu/group/rosenberglab/data/pembertonEtAl2009/Pemberton_AdditionalFile1_11242009.txt</ext-link>.
Using the is PCR<sup><xref rid="R23" ref-type="bibr">23</xref></sup> tool,
we mapped each STR’s primers to the hg19 reference genome. We then
used Tandem Repeats Finder<sup><xref rid="R24" ref-type="bibr">24</xref></sup> to scan between the primer sites and identified the
genomic coordinates of each STR based on the published repeat structure.</p>
        <p id="P28">Capillary STR genotypes report the lengths of amplified DNA
fragments containing the STR region. These lengths correctly capture STR
variations but also capture indels outside of STRs if they fall within the
amplified regions. To mitigate the effects of these indels, we downloaded
assembly-based FermiKit<sup><xref rid="R25" ref-type="bibr">25</xref></sup>
calls for each of the 263 SGDP samples from a publicly available repository
(<ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/sgdp-fermi">https://github.com/lh3/sgdp-fermi</ext-link>). For each STR, we
identified samples with indels located in between the two primer sites. We
then masked the capillary genotype for a sample if any of its indels
occurred more than 15bp upstream or downstream from the STR region, as these
are unlikely to originate from the STR.</p>
      </sec>
      <sec id="S13">
        <title>Assessing variant caller performance</title>
        <p id="P29">We downloaded BWA-MEM alignments<sup><xref rid="R26" ref-type="bibr">26</xref></sup> for 263 publicly available Simons Genome Diversity
Project samples (accession ERP010710). Using a BED file containing each
STR’s genomic coordinates, we ran every tool with default options.
For general-purpose tools that have no prior knowledge about repetitive
regions, we padded the STR regions by 15bp prior to genotyping to improve
the chance that it captured indels near the STR boundaries. We then explored
the effects of alternate command line options by rerunning each tool using
every combination of the settings listed in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>. The
combination of settings that led to the highest level of agreement with the
capillary genotypes was then selected as optimal. Despite multiple attempts,
we were unable to run STR-FM<sup><xref rid="R27" ref-type="bibr">27</xref></sup> outside of the Galaxy environment and we therefore
could not include this tool in our benchmarking experiments.</p>
        <p id="P30">Most general-purpose variant callers report multiple unphased
variants per STR region. Without phase information, it is frequently
impossible to determine the lengths of an individual’s two STR
alleles present at a locus. To overcome this issue, we summed the sizes of
all indels each caller reported within an STR region for a given sample. The
frequency with which these sums exactly matched those predicted by the
capillary electrophoresis data was then used as the variant caller’s
accuracy.</p>
        <p id="P31">To assess how variant filtration affects performance, we selected
FORMAT and INFO fields from each tool’s VCF file that might be
indicative of genotype robustness (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>). We then
used gradient boosting to train ensembles of regression trees that convert
these fields into a confidence level. Using five-fold cross-validation, we
trained these classifiers on 20% of the calls and ranked the
remaining 80% of calls by confidence level. <xref rid="F1" ref-type="fig">Figure 1</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 5</xref> depict
the relationship between mean accuracy and minimum confidence level observed
across the five iterations.</p>
        <p id="P32">To gauge the effect of sequencing coverage on variant caller
performance, we used the SAMtools <italic>view</italic> command and the
<italic>–s</italic> option to downsample the SGDP reads to
5×, 10× or 20× median coverage. We then reran
GATK-HC and HipSTR using the command line parameters optimized for STR
genotyping (<xref rid="SD2" ref-type="supplementary-material">Supplementary
Table 1</xref>) but also specified the <italic>--use-all-reads</italic>
HipSTR option.</p>
      </sec>
      <sec id="S14">
        <title>Calling STRs from longer reads</title>
        <p id="P33">Targeted 300bp paired end sequencing was performed on an Illumina
MiSeq (supplied by Kailos Genetics). After aligning FASTQ files with
BWA-MEM, we used HipSTR to call the GlobalFiler markers with the options
--<italic>haploid-chrs chrY --no-rmdup --min-reads 10 --read-qual-trim
5</italic>. To compare with capillary data, we used information from
NIST (<ext-link ext-link-type="uri" xlink:href="http://www.cstl.nist.gov/strbase/str_fact.htm">http://www.cstl.nist.gov/strbase/str_fact.htm</ext-link>) to determine
the number of repeats present in the hg19 reference genome (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref>). We then
computed the HipSTR predicted capillary sizes by adding HipSTR’s
estimated base pair differences (GB FORMAT field) to the number of repeats
in hg19.</p>
      </sec>
      <sec id="S15">
        <title>Phased trio SNP scaffolds</title>
        <p id="P34">We used the HaplotypeCaller module in GATK v3.5-0-g36282e4 to
jointly genotype all members of the CEPH trio using aligned and sorted BAMs
for runs ERR194147, ERR194160 and ERR194161. In accordance with guidelines
for hard filtering SNP calls, we used GATK’s SelectVariants and
VariantFiltration modules to select only those SNPs with a passing FILTER,
<italic>QD</italic> &gt; 2, <italic>FS</italic> &lt; 60,
<italic>MQ</italic> &gt; 40, <italic>MQRankSum</italic> &gt;
−12.5 and <italic>ReadPosRankSum</italic> &gt; −8. Next, we
downloaded v5a of Beagle’s<sup><xref rid="R28" ref-type="bibr">28</xref></sup> reference panels for Phase 3 of the 1000 Genomes
Project from the tool’s website and removed three samples that are
part of the CEPH pedigree (NA12878, NA12889 and NA12890). Using v4.0-r1399
of Beagle and these filtered reference panels, we phased the trio’s
SNP calls using the <italic>ped</italic> option,
<italic>phase-its</italic>=10,
<italic>burnin-its</italic>=10,
<italic>impute-its</italic>=0 and
<italic>impute</italic>=false.</p>
      </sec>
      <sec id="S16">
        <title>Generating CEPH trio STR genotypes for the Marshfield markers</title>
        <p id="P35">We downloaded FASTQ files from the Illumina Platinum Genomes Project
and an additional study of the effects of PCR amplification on sequencing
errors<sup><xref rid="R29" ref-type="bibr">29</xref></sup>,
resulting in data from twelve different sequencing runs (NA12878: ERR194147,
SRR826463, SRR826467, SRR826469; NA12891: ERR194160, SRR826427, SRR826448,
SRR826465; NA12892: ERR194161, SRR826428, SRR826473, SRR826471). We
individually aligned each run to the hg19 reference genome using BWA-MEM and
analyzed all of the resulting BAMs concurrently using HipSTRv0.2 and the
options <italic>--def-stutter-model --use-all-reads --min-reads</italic> 25
and <italic>--read-qual-trim #</italic>. To generate STR genotypes
that are phased onto SNP scaffolds, we reran HipSTR using the same arguments
but also specified the <italic>--snp-vcf</italic> option with the phased SNP
scaffolds VCF described above as input.</p>
      </sec>
      <sec id="S17">
        <title>Evaluating HipSTR’s physical phasing accuracy</title>
        <p id="P36">We began by restricting our analysis to Marshfield markers in which
the STR alleles transmitted from each parent to the child could be
determined from the unphased genotypes alone. We then required that the
child have a confidently phased STR genotype as indicated by a HipSTR FORMAT
field with PQ &gt; 0.9 (minimum phased genotype posterior of 90%).
Using the SNPs 50kb upstream and 50kb downstream of the STR region, we
determined the SNP haplotype each parent transmitted to the child by
requiring that each of the child’s SNP haplotypes exactly match one
parental haplotype and that these matches involve both a maternal and a
paternal haplotype. After enforcing all of these requirements, 178 markers
were available for downstream analyses. For each of these markers,
HipSTR’s phased genotypes correctly placed the paternally
transmitted STR allele onto the paternally transmitted SNP haplotype,
resulting in perfect phasing accuracy.</p>
      </sec>
      <sec id="S18">
        <title>Running HipSTR on a population-scale dataset</title>
        <p id="P37">WGS data for 2000 individuals sequenced using 150bp paired-end
Illumina reads and more than 30× coverage was internally available
at the New York Genome Center. Using the BWA-MEM aligned BAMs for each
sample as input, we jointly genotyped 200 samples at a time with HipSTR and
all default options. We aggregated the timing statistics across each of the
individual runs to determine the total run time of ~20,000 CPU hours.
NYGC’s IRB committee approved all human subject experiments prior to
this analysis.</p>
      </sec>
      <sec id="S19">
        <title>Using HipSTR to identify <italic>de novo</italic> mutations</title>
        <p id="P38">We downloaded FASTQs from the Illumina Platinum Genomes project
containing 200× sequencing data for NA12877 and NA12878 (runs
ERR174310-ERR174341). As before, we used BWA-MEM to align the reads in each
of these runs individually. Using all of these BAMs and two previously
generated BAMs for NA12891 and NA12892 (ERR194160 and ERR194161), we ran
HipSTR with the options <italic>--def-stutter-model --require-pairs
--min-reads</italic> 25 and a BED file containing 1.6 million STR
regions.</p>
        <p id="P39">We applied a series of stringent filters to the call set to reduce
the likelihood that genotyping errors introduce false positive <italic>de
novo</italic> calls. Using the FORMAT fields available in the HipSTR
VCF, we required that all three individuals in the trio have a minimum
genotype posterior (Q) of 0.9, no more than 10% of reads containing
either a stutter artifact or a flanking sequence indel (DSTUTTER/DP and
DFLANKINDEL/DP) and at least 10 reads spanning the STR region (MALLREADS).
Lastly, we required that the ratio of spanning reads supporting the alleles
for each individual be at least 20% (computed from MALLREADS).</p>
        <p id="P40">To identify an initial set of candidate mutations, we examined STRs
that satisfied all of these requirements. We identified a potential
<italic>de novo</italic> mutation for 423 loci where the child (NA12878)
had an allele length not observed in either of the parents (NA12891 and
NA12892).</p>
      </sec>
      <sec id="S20">
        <title>Validating <italic>de novo</italic> mutations using orthogonal
datasets</title>
        <p id="P41">We downloaded FASTQs containing 300× Illumina sequencing
data for NA12878 from the Genome in a Bottle consortium and FASTQs for
NA12878, NA12891 and NA12891 from the 1000 Genomes Project (SRR622457,
SRR622458 and SRR622459, respectively). After generating BAM files using
BWA-MEM, we collated these alignments with others generated in previous
analyses (NA12878: SRR826463, SRR826467, SRR826469; NA12891: SRR826427,
SRR826448, SRR826465; NA12892: SRR826428, SRR826471, SRR826473). We then
reran HipSTR using these BAMs and the options <italic>--def-stutter-model
--require-pairs --min-reads</italic> 25 and a BED file containing the
423 STR regions with previously detected <italic>de novo</italic>
mutations.</p>
        <p id="P42">Without performing any filtering, we compared the HipSTR calls from
these datasets to the calls generated during the discovery phase. For 358 of
the markers, each member of the trio had allele lengths that matched
perfectly between the two call sets, resulting in a set of sites with high
confidence <italic>de novo</italic> mutations.</p>
      </sec>
      <sec id="S21">
        <title>Sanger sequencing validation</title>
        <p id="P43">Primers were designed around the STR coordinates to generate
300–600bp PCR products (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 6</xref>). Primers
were tested using isPCR for unique products. Genomic DNA for NA12878,
NA12891, and NA12892 was obtained from the Coriell Institute (Camden, NJ,
USA). DNA was amplified for 30 cycles in 25 ul reactions according to the
manufacturer’s recommended cycling conditions using Q5 High Fidelity
Polymerase (NEB catalog #M0494) to reduce stutter, generating blunt
end products. Amplicons were purified on magnetic beads (Thermo Fisher
Scientific ChargeSwitch PCR Clean-Up Kit, catalog #CS12000) and
cloned into linearized pMiniT (NEB catalog #E1202). Plasmids were
transformed into 50ul of chemically competent E. coli (Lucigen E. cloni
Chemically Competent Cells catalog #60108). Outgrowth cultures
(50ul) were incubated overnight on ampicillin plates. Individual colonies
were selected and cultured overnight in 2mL LB + ampicillin
(100ug/mL). DNA was extracted and column purified (Thermo Fisher Scientific
PureLink Quick Plasmid Miniprep Kit, catalog #K210010). Sanger
sequencing of at least 8 clones per individual per locus was performed by
Eton Bioscience (Newark, NJ, USA) using the supplied primers for the pMiniT
plasmid. Only results with flanking sequences upstream and downstream of the
STR of sufficient quality were included in the final counts.</p>
      </sec>
      <sec id="S22">
        <title>Assessing <italic>de novo</italic> transmission to children</title>
        <p id="P44">We downloaded FASTQs containing 50× Illumina sequencing data
for each of the 11 children of NA12878 (ERR194148, ERR218433, ERR324432,
ERR324433, ERR194152, ERR324434, ERR194154, ERR194155, ERR324435, ERR194157
and ERR194162) and aligned them using BWA-ME. Using these BAMs as input, we
ran HipSTR with the options <italic>--def-stutter-model --require-pairs
--min-reads</italic> 25.</p>
      </sec>
      <sec id="S23">
        <title>Coordinates</title>
        <p id="P45">All reported coordinates are based on the hg19 genome build.</p>
      </sec>
      <sec id="S24">
        <title>Code availability</title>
        <p id="P46">The latest version of HipSTR and detailed usage information are
freely available under the GNU General Public License v2.0 at <ext-link ext-link-type="uri" xlink:href="https://hipstr-tool.github.io/HipSTR">https://hipstr-tool.github.io/HipSTR</ext-link></p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S25">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS864151-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d36e4133" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS864151-supplement-2.docx" orientation="portrait" xlink:type="simple" id="d36e4137" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>3</label>
      <media xlink:href="NIHMS864151-supplement-3.doc" orientation="portrait" xlink:type="simple" id="d36e4141" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S26">
    <p>Y.E. holds a Career Award at the Scientific Interface from the Burroughs Wellcome
Fund. This study was supported by NIJ grant 2014-DN-BX-K089 (T.W., D.Z, A.G., M.G.,
Y.E.) and a generous gift by Andria and Paul Heafy. Research reported in this
publication was supported by the National Human Genome Research Institute of the
National Institutes of Health under Award Number UM1HG008901. We thank Kailos
Genetics for providing the 300bp Illumina sequencing data. The content is solely the
responsibility of the authors and does not necessarily represent the official views
of the National Institutes of Health.</p>
  </ack>
  <fn-group>
    <fn id="FN2">
      <p>
        <bold>Data availability</bold>
      </p>
      <p>Sequencing datasets analyzed during the benchmarking and <italic>de novo</italic>
variant analyses are publicly available using the accession codes listed in the
Online Methods. The genotypes for STRs with a high confidence <italic>de
novo</italic> mutation and the various BED files used to genotype STRs are
available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HipSTR-Tool/HipSTR-paper">https://github.com/HipSTR-Tool/HipSTR-paper</ext-link>. The long read MiSeq
data is not publicly available as it could compromise the privacy of the
sequenced individual.</p>
    </fn>
    <fn id="FN3" fn-type="con">
      <p>
        <bold>Author Contributions</bold>
      </p>
      <p>T.W., M.G and Y.E. designed the HipSTR algorithm and subsequent analyses. T.W.
and A.G implemented the HipSTR software. T.W. and J.Y. performed the analyses.
D.Z. experimentally validated the <italic>de novo</italic> mutations and
analyzed the long MiSeq reads. T.W and Y.E wrote the manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN4">
      <p>
        <bold>Competing Financial Interests</bold>
      </p>
      <p>Y.E. is a consultant for Arc Bio, a company interested in DNA forensics.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirkin</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Expandable DNA repeats and human disease</article-title>
        <source>Nature</source>
        <volume>447</volume>
        <fpage>932</fpage>
        <lpage>940</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17581576</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Contente</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dittmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dobbelstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A polymorphic microsatellite that mediates induction of PIG3 by
p53</article-title>
        <source>Nat Genet</source>
        <volume>30</volume>
        <fpage>315</fpage>
        <lpage>320</lpage>
        <year>2002</year>
        <pub-id pub-id-type="pmid">11919562</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gymrek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Abundant contribution of short tandem repeats to gene expression
variation in humans</article-title>
        <source>Nat Genet</source>
        <volume>48</volume>
        <fpage>22</fpage>
        <lpage>29</lpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">26642241</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hefferon</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Groman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Yurk</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Cutting</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>A variable dinucleotide repeat in the CFTR gene contributes to
phenotype diversity by forming RNA secondary structures that alter
splicing</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>101</volume>
        <fpage>3504</fpage>
        <lpage>3509</lpage>
        <year>2004</year>
        <pub-id pub-id-type="pmid">14993601</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gymrek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Golan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosset</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Erlich</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>lobSTR: A short tandem repeat profiler for personal
genomes</article-title>
        <source>Genome Res</source>
        <volume>22</volume>
        <fpage>1154</fpage>
        <lpage>1162</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22522390</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Highnam</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate human microsatellite genotypes from high-throughput
resequencing data using informed error profiles</article-title>
        <source>Nucleic Acids Res</source>
        <volume>41</volume>
        <fpage>e32</fpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23090981</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kong</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rate of de novo mutations and the importance of father’s
age to disease risk</article-title>
        <source>Nature</source>
        <volume>488</volume>
        <fpage>471</fpage>
        <lpage>475</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22914163</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating human sequence data sets provides a resource of
benchmark SNP and indel genotype calls</article-title>
        <source>Nat Biotechnol</source>
        <volume>32</volume>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24531798</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <collab>The Genomes Project C</collab>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature</source>
        <volume>526</volume>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallick</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Simons Genome Diversity Project: 300 genomes from 142 diverse
populations</article-title>
        <source>Nature</source>
        <volume>538</volume>
        <fpage>201</fpage>
        <lpage>206</lpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27654912</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clines, clusters, and the effect of study design on the inference
of human population structure</article-title>
        <source>PLoS Genet</source>
        <volume>1</volume>
        <fpage>e70</fpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">16355252</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using
next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rimmer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating mapping-, assembly- and haplotype-based approaches
for calling variants in clinical sequencing applications</article-title>
        <source>Nat Genet</source>
        <volume>46</volume>
        <fpage>912</fpage>
        <lpage>918</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25017105</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-based variant detection from short-read
sequencing</article-title>
        <comment>arXiv preprint arXiv:1207.3907</comment>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan 2: somatic mutation and copy number alteration discovery
in cancer by exome sequencing</article-title>
        <source>Genome Res</source>
        <volume>22</volume>
        <fpage>568</fpage>
        <lpage>576</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willems</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The landscape of human STR variation</article-title>
        <source>Genome Res</source>
        <volume>24</volume>
        <fpage>1894</fpage>
        <lpage>1904</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25135957</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Estoup</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jarne</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cornuet</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Homoplasy and mutation model at microsatellite loci and their
consequences for population genetics analysis</article-title>
        <source>Mol Ecol</source>
        <volume>11</volume>
        <fpage>1591</fpage>
        <lpage>1604</lpage>
        <year>2002</year>
        <pub-id pub-id-type="pmid">12207711</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francioli</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide patterns and properties of de novo mutations in
humans</article-title>
        <source>Nat Genet</source>
        <volume>47</volume>
        <fpage>822</fpage>
        <lpage>826</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25985141</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willems</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population-Scale Sequencing Data Enable Precise Estimates of
Y-STR Mutation Rates</article-title>
        <source>Am J Hum Genet</source>
        <volume>98</volume>
        <fpage>919</fpage>
        <lpage>933</lpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27126583</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM
algorithm</article-title>
        <source>J R Stat Soc Ser B</source>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
        <year>1977</year>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dindel: accurate indel calls from short-read data</article-title>
        <source>Genome Res</source>
        <volume>21</volume>
        <fpage>961</fpage>
        <lpage>973</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">20980555</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hinrichs</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC Genome Browser Database: update 2006</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>D590</fpage>
        <lpage>598</lpage>
        <year>2006</year>
        <pub-id pub-id-type="pmid">16381938</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Tandem repeats finder: a program to analyze DNA
sequences</article-title>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <year>1999</year>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>FermiKit: assembly-based variant calling for Illumina
resequencing data</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <fpage>3694</fpage>
        <lpage>3696</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26220959</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs
with BWA-MEM</article-title>
        <comment>arXiv preprint arXiv:1303.3997</comment>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fungtammasan</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate typing of short tandem repeats from genome-wide
sequencing data and its applications</article-title>
        <source>Genome Res</source>
        <volume>25</volume>
        <fpage>736</fpage>
        <lpage>749</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25823460</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference
for whole-genome association studies by use of localized haplotype
clustering</article-title>
        <source>Am J Hum Genet</source>
        <volume>81</volume>
        <fpage>1084</fpage>
        <lpage>1097</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisenfeld</surname>
            <given-names>NI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive variation discovery in single human
genomes</article-title>
        <source>Nat Genet</source>
        <volume>46</volume>
        <fpage>1350</fpage>
        <lpage>1355</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25326702</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Performance of variant callers in STR regions</title>
      <p>The accuracy of each tool’s calls is shown as a function of sensitivity
for the Marshfield STR panel. Solid and dashed lines denote tools run using
default settings and settings optimized for STR genotyping, respectively.</p>
    </caption>
    <graphic xlink:href="nihms864151f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Experimental validation of <italic>de novo</italic> STR mutations</title>
      <p>The top panel depicts the number of repeats HipSTR identified in each family
member for four STRs with a predicted <italic>de novo</italic> mutation (novel
allele in bold). The bottom three panels illustrate the number of clones with
repeat sizes predicted (red) or not predicted (gray) by HipSTR during Sanger
sequencing of these same individuals.</p>
    </caption>
    <graphic xlink:href="nihms864151f2"/>
  </fig>
</floats-group>
