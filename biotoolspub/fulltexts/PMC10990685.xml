<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10990685</article-id>
    <article-id pub-id-type="pmid">38514421</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae162</article-id>
    <article-id pub-id-type="publisher-id">btae162</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AleRax: a tool for gene and species tree co-estimation and reconciliation under a probabilistic model of gene duplication, transfer, and loss</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6286-4419</contrib-id>
        <name>
          <surname>Morel</surname>
          <given-names>Benoit</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Tom A</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8 1TQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0353-0691</contrib-id>
        <name>
          <surname>Stamatakis</surname>
          <given-names>Alexandros</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
        <aff><institution>Institute of Computer Science, Biodiversity Computing Group</institution>, Heraklion GR-70013, <country country="GR">Greece</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Szöllősi</surname>
          <given-names>Gergely J</given-names>
        </name>
        <aff><institution>ELTE-MTA “Lendület”, Evolutionary Genomics Research Group</institution>, Budapest H-1117, <country country="HU">Hungary</country></aff>
        <aff><institution>Institute of Evolution, HUN-REN Centre for Ecological Research</institution>, Budapest H-1121, <country country="HU">Hungary</country></aff>
        <aff><institution>Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University</institution>, Okinawa 904-0495, <country country="JP">Japan</country></aff>
        <xref rid="btae162-cor1" ref-type="corresp"/>
        <!--Gergely.Szollosi@oist.jp-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae162-cor1">Corresponding author. Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University, 1919-1 Tancha, Onna, Kunigami District, Okinawa 904-0412, Japan. E-mail: <email>Gergely.Szollosi@oist.jp</email> (G.J.S.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-21">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae162</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>03</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae162.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genomes are a rich source of information on the pattern and process of evolution across biological scales. How best to make use of that information is an active area of research in phylogenetics. Ideally, phylogenetic methods should not only model substitutions along gene trees, which explain differences between homologous gene sequences, but also the processes that generate the gene trees themselves along a shared species tree. To conduct accurate inferences, one needs to account for uncertainty at both levels, that is, in gene trees estimated from inherently short sequences and in their diverse evolutionary histories along a shared species tree.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present AleRax, a software that can infer reconciled gene trees together with a shared species tree using a simple, yet powerful, probabilistic model of gene duplication, transfer, and loss. A key feature of AleRax is its ability to account for uncertainty in the gene tree and its reconciliation by using an efficient approximation to calculate the joint phylogenetic—reconciliation likelihood and sample reconciled gene trees accordingly. Simulations and analyses of empirical data show that AleRax is one order of magnitude faster than competing gene tree inference tools while attaining the same accuracy. It is consistently more robust than species tree inference methods such as SpeciesRax and ASTRAL-Pro 2 under gene tree uncertainty. Finally, AleRax can process multiple gene families in parallel thereby allowing users to compare competing phylogenetic hypotheses and estimate model parameters, such as duplication, transfer, and loss probabilities for genome-scale datasets with hundreds of taxa.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GNU GPL at <ext-link xlink:href="https://github.com/BenoitMorel/AleRax" ext-link-type="uri">https://github.com/BenoitMorel/AleRax</ext-link> and data are made available at <ext-link xlink:href="https://cme.h-its.org/exelixis/material/alerax_data.tar.gz" ext-link-type="uri">https://cme.h-its.org/exelixis/material/alerax_data.tar.gz</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Klaus Tschira Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100007316</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Simultaneously inferring gene trees and the species tree is challenging. Genomes contain abundant information about evolutionary history, but single gene sequences are often too short to reliably resolve gene trees (<xref rid="btae162-B9" ref-type="bibr">Haag <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, gene trees are not species trees, but each is the unique result of series of evolutionary events. Starting from an individual site in a genome up to the species level, a hierarchy of evolutionary processes generate genomic sequences, with each level of the hierarchy contributing to the phylogenetic signal that can induce differences between reconstructed gene trees (<xref rid="btae162-B20" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2015</xref>). Segregating mutations that cross speciation events (a process called incomplete lineage sorting) leave topological signatures in gene trees. Duplications, transfers, and losses of genes (DTL) lead to substantial differences in the size and phylogenetic distribution of families of homologous genes, and at the same time induce patent phylogenetic discord.</p>
    <p>While most species tree inference methods take single-copy genes as input that are assumed <italic toggle="yes">a priori</italic> to be orthologous (i.e. to have originated from a common ancestral gene solely through speciation), more recent methods are able to handle more general homologous gene families (i.e. genes that originated from a common ancestor through speciation, gene duplication and possibly transfer events) including multi-copy ones. DupTree (<xref rid="btae162-B21" ref-type="bibr">Wehe <italic toggle="yes">et al.</italic> 2008</xref>) searches for the species tree with the most parsimonious reconciliation cost, measured as the number of duplication events. STAG (<xref rid="btae162-B7" ref-type="bibr">Emms and Kelly 2018</xref>) infers a species tree by applying a distance method to each gene family that covers <italic toggle="yes">all</italic> species, and subsequently builds a consensus tree from all these distance-based trees. FastMulRFS (<xref rid="btae162-B13" ref-type="bibr">Molloy and Warnow 2020</xref>) extends the definition of the Robinson-Foulds (RF) distance to multi-copy gene trees and strives to minimize this distance between the species tree and all input gene trees. ASTRAL-Pro 2 (<xref rid="btae162-B23" ref-type="bibr">Zhang and Mirarab 2022</xref>) infers a species tree from multi-copy gene trees by maximizing a duplication-aware quartet score. We recently developed SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), a tool that models gene DTL events and that estimates a maximum likelihood (ML) rooted species tree under the so-called UndatedDTL model. However, all those methods only consider a single <italic toggle="yes">estimated</italic> gene tree per gene family as input, and are thus sensitive to gene tree uncertainty. Alternative methods such as Phyldog (<xref rid="btae162-B2" ref-type="bibr">Boussau <italic toggle="yes">et al.</italic> 2013</xref>) jointly estimate the species tree <italic toggle="yes">and</italic> the gene trees that evolved along it via speciation, duplication, and loss. However, Phyldog does not scale to large datasets, does not model gene transfer, and is less accurate than SpeciesRax and Astral-Pro on simulations, even in the absence of gene transfers (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>Another challenge is to infer a reconciled gene tree: that is, a gene tree together with a reconciliation, or series of DTL and speciation events that trace its evolution along the species tree. To this end, we previously developed GeneRax (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>), a probabilistic method that searches for the reconciled gene trees that maximize the joint likelihood, defined as the product of the phylogenetic likelihood (the probability of the multiple sequence alignment (MSA) given the gene tree) and the reconciliation likelihood (the probability of the gene tree given the species tree under UndatedDTL). However, GeneRax does not provide a confidence measure for the inferred gene trees. Amalgamated Likelihood Estimation (ALE) (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) is an alternative two-step approach that sums the joint likelihood over all reconciled gene trees. The probabilities of the gene trees are estimated based on the conditional clade probabilities of their constituent clades (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). Confidence in a particular DTL event can then be estimated by counting how frequently it appears in the different reconciled gene trees. However, ALE is not able to simultaneously process multiple gene families, or to infer the species tree.</p>
    <p>Here we present AleRax, a novel probabilistic method for phylogenetic tree inference that can perform both species tree inference <italic toggle="yes">and</italic> reconciled gene tree inference from a sample of gene trees. We first present the method and the key features of AleRax. Then, we present the results of our benchmarks: we found that AleRax is on par with ALE in terms of gene tree reconstruction accuracy, but an order of magnitude faster and robust to numerical underflow that sometimes causes ALE to fail. Based on simulations, AleRax is 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2 for species tree inference, but at least one order of magnitude slower than those two methods.</p>
  </sec>
  <sec>
    <title>2 Method</title>
    <sec>
      <title>2.1 Likelihood definition and computation</title>
      <p>Let <italic toggle="yes">S</italic> be the species tree, and <italic toggle="yes">A</italic> be an alignment of homologous genes, that is, a gene family alignment. The probability of observing <italic toggle="yes">A</italic> given <italic toggle="yes">S</italic> is obtained by summing over all possible rooted gene trees <italic toggle="yes">G</italic> for alignment <italic toggle="yes">A</italic>:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>(<xref rid="btae162-B8" ref-type="bibr">Felsenstein 1988</xref>, <xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>).</p>
      <p>AleRax approximates <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by using the ALE (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) algorithm, which takes as input a sample of gene trees for each gene family, ideally computed via a Bayesian inference tool such as Phylobayes (<xref rid="btae162-B12" ref-type="bibr">Lartillot <italic toggle="yes">et al.</italic> 2013</xref>) or MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>) prior to running AleRax. The gene trees in the samples can be rooted or unrooted. Instead of naïvely computing the sum <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, AleRax uses the sample of gene trees provided to estimate a nonzero probability for all gene tree topologies that can be “amalgamated” (<xref rid="btae162-B3" ref-type="bibr">David and Alm 2011</xref>) from clades present in the sample using conditional clade probabilities (CCPs) (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). This corresponds to the maximum entropy distribution given marginal split frequencies in the sample of gene trees provided as input (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). Using CCPs allows AleRax to exploit a joint dynamic programming recursion that efficiently and accurately approximates <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). An in-depth description of this algorithm is provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Importantly, unlike ALE, AleRax uses arbitrary-precision floating point values when necessary, allowing it to process datasets that cause ALE to fail due to numerical underflow. AleRax can also process multiple gene families in parallel given a sample of genes for each family allowing it to infer the species tree as well as more realistic DTL models, e.g. branch-wise DTL parameters on the species tree, by maximizing the likelihood of the species tree, which can be written as the product over all per-family alignment probabilities:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.2 Species tree inference</title>
      <p>AleRax searches for the rooted ML species tree. It implements the same tree search strategy as SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), which applies hill-climbing subtree prune and regraft (SPR) moves until it cannot find a move that yields a tree with a better likelihood. However, unlike SpeciesRax, which relies on a single gene tree per gene family, AleRax uses a sample of per family gene trees to integrate over gene tree uncertainty by approximating <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. AleRax recomputes the model parameters (described in the next subsection) after each round of SPR moves. The starting species tree can be generated at random, estimated with MiniNJ (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>) (a duplication-aware distance method), or specified by the user.</p>
    </sec>
    <sec>
      <title>2.3 Model parameter estimation</title>
      <p>In general, the reconciliation model used by AleRax, the so called UndatedDTL model (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>) can have three free parameters per gene family <italic toggle="yes">k</italic> and per species tree branch <italic toggle="yes">e</italic>: <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, representing the duplication, transfer, and loss probabilities, respectively. However, estimating such a large number of free parameters (proportional to the product of the number of species in <italic toggle="yes">S</italic> multiplied by the number of gene families) can lead to over-parameterization. Hence, AleRax implements three distinct approaches to parameter estimation that can be chosen by the user. In the <italic toggle="yes">global parameters</italic> mode, all families and all species share the same set of parameters <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mo>δ</mml:mo><mml:mo>,</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, resulting in only three free parameters. In the <italic toggle="yes">per-family parameters</italic> mode, AleRax optimizes a different set of parameters <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for each gene family <italic toggle="yes">k</italic>. This corresponds to 3<italic toggle="yes">K</italic> free parameters, where <italic toggle="yes">K</italic> is the number of gene families. In the <italic toggle="yes">per-species parameter</italic> mode, the user can provide a list of species groupings that share the same set of parameters. In this mode, the model has 3<italic toggle="yes">n</italic> free parameters, where <italic toggle="yes">n</italic> is the number of groupings defined. In each mode, AleRax optimizes the model parameter values with respect to the likelihood via gradient descent. Our experiments suggest that AleRax performs similarly in terms of gene tree and species tree accuracy under the different modes.</p>
    </sec>
    <sec>
      <title>2.4 Sampling reconciled gene trees</title>
      <p>AleRax samples, per gene family, <italic toggle="yes">r</italic> reconciled gene trees proportional to their joint likelihood using stochastic backtracking following the dynamic programming recursion (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) used to approximate <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. We describe the algorithm in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>. The number of gene trees <italic toggle="yes">r</italic> to sample is specified by the user. For each gene family, AleRax outputs the <italic toggle="yes">r</italic> reconciled gene trees, the rooted majority-rule consensus gene tree, and the number of gene events per species, averaged over all output samples for this specific gene family. The reconciliations are stored in RecPhyloXML format (<xref rid="btae162-B6" ref-type="bibr">Duchemin <italic toggle="yes">et al.</italic> 2018</xref>) and can be converted into SVG figures using Thirdkind (<xref rid="btae162-B17" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2022</xref>). AleRax also outputs the species pairs involved in horizontal gene transfers, sorted by the number of times those transfers have been sampled (per family and summed over all families). In addition, for each species, it returns the number of ancestral gene copies and the number of DTL events. We also provide scripts to extract lists of families that were involved in transfers between specific species pairs, or families that experienced a specific event for a given species (e.g., all families with a gene duplication in <italic toggle="yes">Arabidopsis thaliana</italic>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Here we only provide a summary of the experiments and their results. We describe them in detail in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>.</p>
    <sec>
      <title>3.1 Gene tree reconciliation</title>
      <p>We ran both ALE and AleRax on the simulated datasets used to benchmark SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>). As expected, ALE and AleRax perform analogously in terms of accuracy (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>). We also executed both tools on a real dataset derived from the HOGENOM (<xref rid="btae162-B16" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2009</xref>) database’s HOGENOM-CORE subdataset, which contains 666 representative genomes spanning the diversity of cellular life. ALE failed for 25 families (out of 12 408) because of numerical underflow. AleRax in contrast successfully processed all families. In terms of runtime, AleRax was on average an order of magnitude faster than ALE, both on simulated and empirical datasets (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btae162-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Results on simulated datasets for varying average gene sequence lengths (sites), with 100 gene families and 25 species. When inferring gene trees, the true species tree is assumed to be known.</p>
        </caption>
        <graphic xlink:href="btae162f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Species tree inference</title>
      <p>We investigated the impact of using gene tree distributions instead of single ML gene trees by comparing AleRax, SpeciesRax, and ASTRAL-Pro 2 on simulated datasets. We used the same benchmarks that were employed for assessing SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), that is, we varied different simulation parameters individually while keeping the rest fixed, and measured the distance between the true and the inferred species trees. We ran AleRax on gene tree distributions inferred with MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>). We found that, over all conditions tested, AleRax is on average 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2. For instance, <xref rid="btae162-F1" ref-type="fig">Fig. 1</xref> compares the accuracy of the different methods when varying the average gene sequence lengths. Our explanation is that using fixed gene tree estimates does not capture all the information contained in the gene sequences. Treating gene trees as latent variables allows AleRax to avoid this information loss, and thus to be more robust to phylogenetic uncertainty. When using gene tree distributions with 1000 gene trees per gene family, AleRax is from one to two orders of magnitude slower than SpeciesRax (<xref rid="btae162-F1" ref-type="fig">Fig. 1d</xref>).</p>
      <p>To investigate the performance of rooted species tree inference with AleRax on real data, we returned to an earlier phylogenetic analysis of the archaeal domain of life (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B4" ref-type="bibr">Davín <italic toggle="yes">et al.</italic> 2018</xref>). The Archaea constitute one of the two prokaryotic domains of life, but their early evolution and the position of the root remains poorly understood. Previous studies, including a 2017 analysis by some of us, have placed the root between the genome-reduced DPANN Archaea and the other lineages (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>). In the 2017 study, we used ALE to infer the optimal root position based on a fixed unrooted topology estimating using concatenation of a set of 45 vertically-evolving marker genes. This hybrid strategy was employed because ALE cannot search the space of rooted species trees. We performed AleRax, SpeciesRax, and ASTRAL-Pro-2 analyses on the set of 5379 gene families, using the same MCMC gene tree samples to represent gene tree uncertainty as in the original study in the case of AleRax. On a 40-cores machine, Astral-Pro 2 finished after 15 s, SpeciesRax after 167 s, and AleRax after 9215 s. AleRax inferred a rooted species tree closely similar to the original study and to other recent analyses (<xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>), with a root between DPANN Archaea and the rest, and recovering the monophyly of major archaeal groups including DPANN, TACK Archaea, and most of the Euryarchaeota (see <xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>), although two incomplete genomes (SAG I15 and Thaumarchaeota E09) were likely misplaced. The SpeciesRax tree was heterodox, recovering a mixture of TACK Archaea, Euryarchaeota and DPANN on both sides of the root (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). The unrooted species tree inferred by ASTRAL-Pro-2 was very similar to the topology of the AleRax tree (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). If current views about archaeal phylogeny are broadly correct, this analysis suggests that AleRax can be substantially more accurate than SpeciesRax when inferring the root and topology of species trees from real data, likely because of its ability to model gene tree uncertainty. The analysis also demonstrates that reconciliation methods can capture information about the root and topology of species trees, and that in the case of the Archaea this signal is congruent with that from traditional concatenation-based phylogenetics. In this case study, AleRax and ASTRAL-Pro-2 both recovered species trees that are consistent with current views. While ASTRAL-Pro-2 was much faster, the AleRax analysis provided an estimate of the root of the species tree, reconciliation scenarios for each gene family, and gene content reconstructions for each internal node of the tree. These comparative genomic outputs are an important part of the use case for AleRax and similar reconciliation tools, and can be used (for example) to propose hypotheses about ancestral gene repertoires and organismal characteristics, including metabolisms (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>).</p>
      <fig position="float" id="btae162-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Archaeal tree inferred with AleRax, with the four main groups: DPANN, Euryarchaeota, TACK, and Asgardarchaeota.</p>
        </caption>
        <graphic xlink:href="btae162f2" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion and future work</title>
    <p>AleRax is an efficient and user-friendly tool for species tree inference and gene tree-species tree reconciliation that can be applied to datasets from across the tree of life. It is particularly useful in biological applications where not only the species tree, but also the histories individual of gene families are of interest. We showed that AleRax is on par with ALE in terms of reconciled gene tree accuracy, while being one order of magnitude faster and more robust to numerical errors. Furthermore, it infers more accurate species trees than SpeciesRax and ASTRAL-Pro 2, because it can accommodate gene tree uncertainty. In the future, we plan to improve our model to accommodate DTL rate heterogeneity over species, incomplete lineage sorting, and horizontal gene transfer time constraints.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae162_Supplementary_Data</label>
      <media xlink:href="btae162_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>B.M. and A.S. are financially supported by the Klaus Tschira Foundation, by DFG grant STA 860/6–2, and by the European Union (EU) under Grant Agreement No 101087081 (Comp-Biodiv-GR). G.S. received funding from the European Research Council under the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 714774 and the grant GINOP-2.3.2.–15-2016–00057. This work was funded by the Gordon and Betty Moore Foundation through grant GBMF9741 to T.A.W. and G.S.</p>
    <p>
      <inline-graphic xlink:href="btae162ilf1.jpg"/>
    </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data are incorporated into the article and its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae162-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aouad</surname><given-names>M</given-names></string-name>, <string-name><surname>Flandrois</surname><given-names>J-P</given-names></string-name>, <string-name><surname>Jauffrit</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>A divide-and-conquer phylogenomic approach based on character supermatrices resolves early steps in the evolution of the archaea</article-title>. <source>BMC Ecol Evol</source><year>2022</year>;<volume>22</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34986784</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boussau</surname><given-names>B</given-names></string-name>, <string-name><surname>Szöllosi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Duret</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res</source><year>2013</year>;<volume>23</volume>:<fpage>323</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>David</surname><given-names>LA</given-names></string-name>, <string-name><surname>Alm</surname><given-names>EJ.</given-names></string-name></person-group><article-title>Rapid evolutionary innovation during an Archaean genetic expansion</article-title>. <source>Nature</source><year>2011</year>;<volume>469</volume>:<fpage>93</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21170026</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davín</surname><given-names>AA</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name></person-group><etal>et al</etal><article-title>Gene transfers can date the tree of life</article-title>. <source>Nat Ecol Evol</source><year>2018</year>;<volume>2</volume>:<fpage>904</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29610471</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dombrowski</surname><given-names>N</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Sun</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Undinarchaeota illuminate dpann phylogeny and the impact of gene transfer on archaeal evolution</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>3939</fpage>.<pub-id pub-id-type="pmid">32770105</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchemin</surname><given-names>W</given-names></string-name>, <string-name><surname>Gence</surname><given-names>G</given-names></string-name>, <string-name><surname>Arigon Chifolleau</surname><given-names>A-M</given-names></string-name></person-group><etal>et al</etal><article-title>RecPhyloXML: a format for reconciled gene trees</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>3646</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">29762653</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>D</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>Stag: species tree inference from all genes</article-title>. <source>bioRxiv</source><year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae162-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group><article-title>Phylogenies from molecular sequences: inference and reliability</article-title>. <source>Annu Rev Genet</source><year>1988</year>;<volume>22</volume>:<fpage>521</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">3071258</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haag</surname><given-names>J</given-names></string-name>, <string-name><surname>Höhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Bettisworth</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>From easy to hopeless—predicting the difficulty of phylogenetic analyses</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msac254</fpage>.<pub-id pub-id-type="pmid">36395091</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Höhna</surname><given-names>S</given-names></string-name>, <string-name><surname>Drummond</surname><given-names>AJ.</given-names></string-name></person-group><article-title>Guided tree topology proposals for bayesian phylogenetic inference</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">21828081</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larget</surname><given-names>B.</given-names></string-name></person-group><article-title>The estimation of tree posterior probabilities using conditional clade probability distributions</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>501</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">23479066</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname><given-names>N</given-names></string-name>, <string-name><surname>Rodrigue</surname><given-names>N</given-names></string-name>, <string-name><surname>Stubbs</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Phylobayes mpi: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>611</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molloy</surname><given-names>EK</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group><article-title>FastMulRFS: fast and accurate species tree estimation under generic gene duplication and loss models</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>i57</fpage>–<lpage>i65</lpage>.<pub-id pub-id-type="pmid">32657396</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Kozlov</surname><given-names>AM</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>GeneRax: a tool for species-tree-aware maximum likelihood-based gene family tree inference under gene duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2020</year>;<volume>37</volume>:<fpage>2763</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">32502238</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Schade</surname><given-names>P</given-names></string-name>, <string-name><surname>Lutteropp</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Speciesrax: a tool for maximum likelihood species tree inference from gene family trees under duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msab365</fpage>.<pub-id pub-id-type="pmid">35021210</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Arigon</surname><given-names>A-M</given-names></string-name>, <string-name><surname>Dufayard</surname><given-names>J-F</given-names></string-name></person-group><etal>et al</etal><article-title>Databases of homologous gene families for comparative genomics</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:<fpage>S3</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btae162-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Menet</surname><given-names>H</given-names></string-name>, <string-name><surname>Tricou</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Thirdkind: displaying phylogenetic encounters beyond 2-level reconciliation</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2350</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">35139153</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname><given-names>F</given-names></string-name>, <string-name><surname>Teslenko</surname><given-names>M</given-names></string-name>, <string-name><surname>van der Mark</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>MrBayes 3.2: efficient bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>539</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Boussau</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient exploration of the space of reconciled gene trees</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>901</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">23925510</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Daubin</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>The inference of gene trees with species trees</article-title>. <source>Syst Biol</source><year>2015</year>;<volume>64</volume>:<fpage>e42</fpage>–<lpage>e62</lpage>.<pub-id pub-id-type="pmid">25070970</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wehe</surname><given-names>A</given-names></string-name>, <string-name><surname>Bansal</surname><given-names>MS</given-names></string-name>, <string-name><surname>Burleigh</surname><given-names>JG</given-names></string-name></person-group><etal>et al</etal><article-title>DupTree: a program for large-scale phylogenetic analyses using gene tree parsimony</article-title>. <source>Bioinformatics</source><year>2008</year>;<volume>24</volume>:<fpage>1540</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">18474508</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Spang</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Integrative modeling of gene and genome evolution roots the archaeal tree of life</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2017</year>;<volume>114</volume>:<fpage>E4602</fpage>–<lpage>E4611</lpage>.<pub-id pub-id-type="pmid">28533395</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group><article-title>Astral-pro 2: ultrafast species tree reconstruction from multi-copy gene family trees</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>4949</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">36094339</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10990685</article-id>
    <article-id pub-id-type="pmid">38514421</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae162</article-id>
    <article-id pub-id-type="publisher-id">btae162</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AleRax: a tool for gene and species tree co-estimation and reconciliation under a probabilistic model of gene duplication, transfer, and loss</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6286-4419</contrib-id>
        <name>
          <surname>Morel</surname>
          <given-names>Benoit</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Tom A</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8 1TQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0353-0691</contrib-id>
        <name>
          <surname>Stamatakis</surname>
          <given-names>Alexandros</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
        <aff><institution>Institute of Computer Science, Biodiversity Computing Group</institution>, Heraklion GR-70013, <country country="GR">Greece</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Szöllősi</surname>
          <given-names>Gergely J</given-names>
        </name>
        <aff><institution>ELTE-MTA “Lendület”, Evolutionary Genomics Research Group</institution>, Budapest H-1117, <country country="HU">Hungary</country></aff>
        <aff><institution>Institute of Evolution, HUN-REN Centre for Ecological Research</institution>, Budapest H-1121, <country country="HU">Hungary</country></aff>
        <aff><institution>Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University</institution>, Okinawa 904-0495, <country country="JP">Japan</country></aff>
        <xref rid="btae162-cor1" ref-type="corresp"/>
        <!--Gergely.Szollosi@oist.jp-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae162-cor1">Corresponding author. Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University, 1919-1 Tancha, Onna, Kunigami District, Okinawa 904-0412, Japan. E-mail: <email>Gergely.Szollosi@oist.jp</email> (G.J.S.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-21">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae162</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>03</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae162.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genomes are a rich source of information on the pattern and process of evolution across biological scales. How best to make use of that information is an active area of research in phylogenetics. Ideally, phylogenetic methods should not only model substitutions along gene trees, which explain differences between homologous gene sequences, but also the processes that generate the gene trees themselves along a shared species tree. To conduct accurate inferences, one needs to account for uncertainty at both levels, that is, in gene trees estimated from inherently short sequences and in their diverse evolutionary histories along a shared species tree.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present AleRax, a software that can infer reconciled gene trees together with a shared species tree using a simple, yet powerful, probabilistic model of gene duplication, transfer, and loss. A key feature of AleRax is its ability to account for uncertainty in the gene tree and its reconciliation by using an efficient approximation to calculate the joint phylogenetic—reconciliation likelihood and sample reconciled gene trees accordingly. Simulations and analyses of empirical data show that AleRax is one order of magnitude faster than competing gene tree inference tools while attaining the same accuracy. It is consistently more robust than species tree inference methods such as SpeciesRax and ASTRAL-Pro 2 under gene tree uncertainty. Finally, AleRax can process multiple gene families in parallel thereby allowing users to compare competing phylogenetic hypotheses and estimate model parameters, such as duplication, transfer, and loss probabilities for genome-scale datasets with hundreds of taxa.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GNU GPL at <ext-link xlink:href="https://github.com/BenoitMorel/AleRax" ext-link-type="uri">https://github.com/BenoitMorel/AleRax</ext-link> and data are made available at <ext-link xlink:href="https://cme.h-its.org/exelixis/material/alerax_data.tar.gz" ext-link-type="uri">https://cme.h-its.org/exelixis/material/alerax_data.tar.gz</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Klaus Tschira Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100007316</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Simultaneously inferring gene trees and the species tree is challenging. Genomes contain abundant information about evolutionary history, but single gene sequences are often too short to reliably resolve gene trees (<xref rid="btae162-B9" ref-type="bibr">Haag <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, gene trees are not species trees, but each is the unique result of series of evolutionary events. Starting from an individual site in a genome up to the species level, a hierarchy of evolutionary processes generate genomic sequences, with each level of the hierarchy contributing to the phylogenetic signal that can induce differences between reconstructed gene trees (<xref rid="btae162-B20" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2015</xref>). Segregating mutations that cross speciation events (a process called incomplete lineage sorting) leave topological signatures in gene trees. Duplications, transfers, and losses of genes (DTL) lead to substantial differences in the size and phylogenetic distribution of families of homologous genes, and at the same time induce patent phylogenetic discord.</p>
    <p>While most species tree inference methods take single-copy genes as input that are assumed <italic toggle="yes">a priori</italic> to be orthologous (i.e. to have originated from a common ancestral gene solely through speciation), more recent methods are able to handle more general homologous gene families (i.e. genes that originated from a common ancestor through speciation, gene duplication and possibly transfer events) including multi-copy ones. DupTree (<xref rid="btae162-B21" ref-type="bibr">Wehe <italic toggle="yes">et al.</italic> 2008</xref>) searches for the species tree with the most parsimonious reconciliation cost, measured as the number of duplication events. STAG (<xref rid="btae162-B7" ref-type="bibr">Emms and Kelly 2018</xref>) infers a species tree by applying a distance method to each gene family that covers <italic toggle="yes">all</italic> species, and subsequently builds a consensus tree from all these distance-based trees. FastMulRFS (<xref rid="btae162-B13" ref-type="bibr">Molloy and Warnow 2020</xref>) extends the definition of the Robinson-Foulds (RF) distance to multi-copy gene trees and strives to minimize this distance between the species tree and all input gene trees. ASTRAL-Pro 2 (<xref rid="btae162-B23" ref-type="bibr">Zhang and Mirarab 2022</xref>) infers a species tree from multi-copy gene trees by maximizing a duplication-aware quartet score. We recently developed SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), a tool that models gene DTL events and that estimates a maximum likelihood (ML) rooted species tree under the so-called UndatedDTL model. However, all those methods only consider a single <italic toggle="yes">estimated</italic> gene tree per gene family as input, and are thus sensitive to gene tree uncertainty. Alternative methods such as Phyldog (<xref rid="btae162-B2" ref-type="bibr">Boussau <italic toggle="yes">et al.</italic> 2013</xref>) jointly estimate the species tree <italic toggle="yes">and</italic> the gene trees that evolved along it via speciation, duplication, and loss. However, Phyldog does not scale to large datasets, does not model gene transfer, and is less accurate than SpeciesRax and Astral-Pro on simulations, even in the absence of gene transfers (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>Another challenge is to infer a reconciled gene tree: that is, a gene tree together with a reconciliation, or series of DTL and speciation events that trace its evolution along the species tree. To this end, we previously developed GeneRax (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>), a probabilistic method that searches for the reconciled gene trees that maximize the joint likelihood, defined as the product of the phylogenetic likelihood (the probability of the multiple sequence alignment (MSA) given the gene tree) and the reconciliation likelihood (the probability of the gene tree given the species tree under UndatedDTL). However, GeneRax does not provide a confidence measure for the inferred gene trees. Amalgamated Likelihood Estimation (ALE) (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) is an alternative two-step approach that sums the joint likelihood over all reconciled gene trees. The probabilities of the gene trees are estimated based on the conditional clade probabilities of their constituent clades (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). Confidence in a particular DTL event can then be estimated by counting how frequently it appears in the different reconciled gene trees. However, ALE is not able to simultaneously process multiple gene families, or to infer the species tree.</p>
    <p>Here we present AleRax, a novel probabilistic method for phylogenetic tree inference that can perform both species tree inference <italic toggle="yes">and</italic> reconciled gene tree inference from a sample of gene trees. We first present the method and the key features of AleRax. Then, we present the results of our benchmarks: we found that AleRax is on par with ALE in terms of gene tree reconstruction accuracy, but an order of magnitude faster and robust to numerical underflow that sometimes causes ALE to fail. Based on simulations, AleRax is 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2 for species tree inference, but at least one order of magnitude slower than those two methods.</p>
  </sec>
  <sec>
    <title>2 Method</title>
    <sec>
      <title>2.1 Likelihood definition and computation</title>
      <p>Let <italic toggle="yes">S</italic> be the species tree, and <italic toggle="yes">A</italic> be an alignment of homologous genes, that is, a gene family alignment. The probability of observing <italic toggle="yes">A</italic> given <italic toggle="yes">S</italic> is obtained by summing over all possible rooted gene trees <italic toggle="yes">G</italic> for alignment <italic toggle="yes">A</italic>:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>(<xref rid="btae162-B8" ref-type="bibr">Felsenstein 1988</xref>, <xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>).</p>
      <p>AleRax approximates <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by using the ALE (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) algorithm, which takes as input a sample of gene trees for each gene family, ideally computed via a Bayesian inference tool such as Phylobayes (<xref rid="btae162-B12" ref-type="bibr">Lartillot <italic toggle="yes">et al.</italic> 2013</xref>) or MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>) prior to running AleRax. The gene trees in the samples can be rooted or unrooted. Instead of naïvely computing the sum <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, AleRax uses the sample of gene trees provided to estimate a nonzero probability for all gene tree topologies that can be “amalgamated” (<xref rid="btae162-B3" ref-type="bibr">David and Alm 2011</xref>) from clades present in the sample using conditional clade probabilities (CCPs) (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). This corresponds to the maximum entropy distribution given marginal split frequencies in the sample of gene trees provided as input (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). Using CCPs allows AleRax to exploit a joint dynamic programming recursion that efficiently and accurately approximates <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). An in-depth description of this algorithm is provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Importantly, unlike ALE, AleRax uses arbitrary-precision floating point values when necessary, allowing it to process datasets that cause ALE to fail due to numerical underflow. AleRax can also process multiple gene families in parallel given a sample of genes for each family allowing it to infer the species tree as well as more realistic DTL models, e.g. branch-wise DTL parameters on the species tree, by maximizing the likelihood of the species tree, which can be written as the product over all per-family alignment probabilities:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.2 Species tree inference</title>
      <p>AleRax searches for the rooted ML species tree. It implements the same tree search strategy as SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), which applies hill-climbing subtree prune and regraft (SPR) moves until it cannot find a move that yields a tree with a better likelihood. However, unlike SpeciesRax, which relies on a single gene tree per gene family, AleRax uses a sample of per family gene trees to integrate over gene tree uncertainty by approximating <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. AleRax recomputes the model parameters (described in the next subsection) after each round of SPR moves. The starting species tree can be generated at random, estimated with MiniNJ (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>) (a duplication-aware distance method), or specified by the user.</p>
    </sec>
    <sec>
      <title>2.3 Model parameter estimation</title>
      <p>In general, the reconciliation model used by AleRax, the so called UndatedDTL model (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>) can have three free parameters per gene family <italic toggle="yes">k</italic> and per species tree branch <italic toggle="yes">e</italic>: <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, representing the duplication, transfer, and loss probabilities, respectively. However, estimating such a large number of free parameters (proportional to the product of the number of species in <italic toggle="yes">S</italic> multiplied by the number of gene families) can lead to over-parameterization. Hence, AleRax implements three distinct approaches to parameter estimation that can be chosen by the user. In the <italic toggle="yes">global parameters</italic> mode, all families and all species share the same set of parameters <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mo>δ</mml:mo><mml:mo>,</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, resulting in only three free parameters. In the <italic toggle="yes">per-family parameters</italic> mode, AleRax optimizes a different set of parameters <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for each gene family <italic toggle="yes">k</italic>. This corresponds to 3<italic toggle="yes">K</italic> free parameters, where <italic toggle="yes">K</italic> is the number of gene families. In the <italic toggle="yes">per-species parameter</italic> mode, the user can provide a list of species groupings that share the same set of parameters. In this mode, the model has 3<italic toggle="yes">n</italic> free parameters, where <italic toggle="yes">n</italic> is the number of groupings defined. In each mode, AleRax optimizes the model parameter values with respect to the likelihood via gradient descent. Our experiments suggest that AleRax performs similarly in terms of gene tree and species tree accuracy under the different modes.</p>
    </sec>
    <sec>
      <title>2.4 Sampling reconciled gene trees</title>
      <p>AleRax samples, per gene family, <italic toggle="yes">r</italic> reconciled gene trees proportional to their joint likelihood using stochastic backtracking following the dynamic programming recursion (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) used to approximate <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. We describe the algorithm in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>. The number of gene trees <italic toggle="yes">r</italic> to sample is specified by the user. For each gene family, AleRax outputs the <italic toggle="yes">r</italic> reconciled gene trees, the rooted majority-rule consensus gene tree, and the number of gene events per species, averaged over all output samples for this specific gene family. The reconciliations are stored in RecPhyloXML format (<xref rid="btae162-B6" ref-type="bibr">Duchemin <italic toggle="yes">et al.</italic> 2018</xref>) and can be converted into SVG figures using Thirdkind (<xref rid="btae162-B17" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2022</xref>). AleRax also outputs the species pairs involved in horizontal gene transfers, sorted by the number of times those transfers have been sampled (per family and summed over all families). In addition, for each species, it returns the number of ancestral gene copies and the number of DTL events. We also provide scripts to extract lists of families that were involved in transfers between specific species pairs, or families that experienced a specific event for a given species (e.g., all families with a gene duplication in <italic toggle="yes">Arabidopsis thaliana</italic>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Here we only provide a summary of the experiments and their results. We describe them in detail in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>.</p>
    <sec>
      <title>3.1 Gene tree reconciliation</title>
      <p>We ran both ALE and AleRax on the simulated datasets used to benchmark SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>). As expected, ALE and AleRax perform analogously in terms of accuracy (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>). We also executed both tools on a real dataset derived from the HOGENOM (<xref rid="btae162-B16" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2009</xref>) database’s HOGENOM-CORE subdataset, which contains 666 representative genomes spanning the diversity of cellular life. ALE failed for 25 families (out of 12 408) because of numerical underflow. AleRax in contrast successfully processed all families. In terms of runtime, AleRax was on average an order of magnitude faster than ALE, both on simulated and empirical datasets (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btae162-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Results on simulated datasets for varying average gene sequence lengths (sites), with 100 gene families and 25 species. When inferring gene trees, the true species tree is assumed to be known.</p>
        </caption>
        <graphic xlink:href="btae162f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Species tree inference</title>
      <p>We investigated the impact of using gene tree distributions instead of single ML gene trees by comparing AleRax, SpeciesRax, and ASTRAL-Pro 2 on simulated datasets. We used the same benchmarks that were employed for assessing SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), that is, we varied different simulation parameters individually while keeping the rest fixed, and measured the distance between the true and the inferred species trees. We ran AleRax on gene tree distributions inferred with MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>). We found that, over all conditions tested, AleRax is on average 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2. For instance, <xref rid="btae162-F1" ref-type="fig">Fig. 1</xref> compares the accuracy of the different methods when varying the average gene sequence lengths. Our explanation is that using fixed gene tree estimates does not capture all the information contained in the gene sequences. Treating gene trees as latent variables allows AleRax to avoid this information loss, and thus to be more robust to phylogenetic uncertainty. When using gene tree distributions with 1000 gene trees per gene family, AleRax is from one to two orders of magnitude slower than SpeciesRax (<xref rid="btae162-F1" ref-type="fig">Fig. 1d</xref>).</p>
      <p>To investigate the performance of rooted species tree inference with AleRax on real data, we returned to an earlier phylogenetic analysis of the archaeal domain of life (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B4" ref-type="bibr">Davín <italic toggle="yes">et al.</italic> 2018</xref>). The Archaea constitute one of the two prokaryotic domains of life, but their early evolution and the position of the root remains poorly understood. Previous studies, including a 2017 analysis by some of us, have placed the root between the genome-reduced DPANN Archaea and the other lineages (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>). In the 2017 study, we used ALE to infer the optimal root position based on a fixed unrooted topology estimating using concatenation of a set of 45 vertically-evolving marker genes. This hybrid strategy was employed because ALE cannot search the space of rooted species trees. We performed AleRax, SpeciesRax, and ASTRAL-Pro-2 analyses on the set of 5379 gene families, using the same MCMC gene tree samples to represent gene tree uncertainty as in the original study in the case of AleRax. On a 40-cores machine, Astral-Pro 2 finished after 15 s, SpeciesRax after 167 s, and AleRax after 9215 s. AleRax inferred a rooted species tree closely similar to the original study and to other recent analyses (<xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>), with a root between DPANN Archaea and the rest, and recovering the monophyly of major archaeal groups including DPANN, TACK Archaea, and most of the Euryarchaeota (see <xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>), although two incomplete genomes (SAG I15 and Thaumarchaeota E09) were likely misplaced. The SpeciesRax tree was heterodox, recovering a mixture of TACK Archaea, Euryarchaeota and DPANN on both sides of the root (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). The unrooted species tree inferred by ASTRAL-Pro-2 was very similar to the topology of the AleRax tree (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). If current views about archaeal phylogeny are broadly correct, this analysis suggests that AleRax can be substantially more accurate than SpeciesRax when inferring the root and topology of species trees from real data, likely because of its ability to model gene tree uncertainty. The analysis also demonstrates that reconciliation methods can capture information about the root and topology of species trees, and that in the case of the Archaea this signal is congruent with that from traditional concatenation-based phylogenetics. In this case study, AleRax and ASTRAL-Pro-2 both recovered species trees that are consistent with current views. While ASTRAL-Pro-2 was much faster, the AleRax analysis provided an estimate of the root of the species tree, reconciliation scenarios for each gene family, and gene content reconstructions for each internal node of the tree. These comparative genomic outputs are an important part of the use case for AleRax and similar reconciliation tools, and can be used (for example) to propose hypotheses about ancestral gene repertoires and organismal characteristics, including metabolisms (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>).</p>
      <fig position="float" id="btae162-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Archaeal tree inferred with AleRax, with the four main groups: DPANN, Euryarchaeota, TACK, and Asgardarchaeota.</p>
        </caption>
        <graphic xlink:href="btae162f2" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion and future work</title>
    <p>AleRax is an efficient and user-friendly tool for species tree inference and gene tree-species tree reconciliation that can be applied to datasets from across the tree of life. It is particularly useful in biological applications where not only the species tree, but also the histories individual of gene families are of interest. We showed that AleRax is on par with ALE in terms of reconciled gene tree accuracy, while being one order of magnitude faster and more robust to numerical errors. Furthermore, it infers more accurate species trees than SpeciesRax and ASTRAL-Pro 2, because it can accommodate gene tree uncertainty. In the future, we plan to improve our model to accommodate DTL rate heterogeneity over species, incomplete lineage sorting, and horizontal gene transfer time constraints.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae162_Supplementary_Data</label>
      <media xlink:href="btae162_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>B.M. and A.S. are financially supported by the Klaus Tschira Foundation, by DFG grant STA 860/6–2, and by the European Union (EU) under Grant Agreement No 101087081 (Comp-Biodiv-GR). G.S. received funding from the European Research Council under the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 714774 and the grant GINOP-2.3.2.–15-2016–00057. This work was funded by the Gordon and Betty Moore Foundation through grant GBMF9741 to T.A.W. and G.S.</p>
    <p>
      <inline-graphic xlink:href="btae162ilf1.jpg"/>
    </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data are incorporated into the article and its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae162-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aouad</surname><given-names>M</given-names></string-name>, <string-name><surname>Flandrois</surname><given-names>J-P</given-names></string-name>, <string-name><surname>Jauffrit</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>A divide-and-conquer phylogenomic approach based on character supermatrices resolves early steps in the evolution of the archaea</article-title>. <source>BMC Ecol Evol</source><year>2022</year>;<volume>22</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34986784</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boussau</surname><given-names>B</given-names></string-name>, <string-name><surname>Szöllosi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Duret</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res</source><year>2013</year>;<volume>23</volume>:<fpage>323</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>David</surname><given-names>LA</given-names></string-name>, <string-name><surname>Alm</surname><given-names>EJ.</given-names></string-name></person-group><article-title>Rapid evolutionary innovation during an Archaean genetic expansion</article-title>. <source>Nature</source><year>2011</year>;<volume>469</volume>:<fpage>93</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21170026</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davín</surname><given-names>AA</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name></person-group><etal>et al</etal><article-title>Gene transfers can date the tree of life</article-title>. <source>Nat Ecol Evol</source><year>2018</year>;<volume>2</volume>:<fpage>904</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29610471</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dombrowski</surname><given-names>N</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Sun</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Undinarchaeota illuminate dpann phylogeny and the impact of gene transfer on archaeal evolution</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>3939</fpage>.<pub-id pub-id-type="pmid">32770105</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchemin</surname><given-names>W</given-names></string-name>, <string-name><surname>Gence</surname><given-names>G</given-names></string-name>, <string-name><surname>Arigon Chifolleau</surname><given-names>A-M</given-names></string-name></person-group><etal>et al</etal><article-title>RecPhyloXML: a format for reconciled gene trees</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>3646</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">29762653</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>D</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>Stag: species tree inference from all genes</article-title>. <source>bioRxiv</source><year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae162-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group><article-title>Phylogenies from molecular sequences: inference and reliability</article-title>. <source>Annu Rev Genet</source><year>1988</year>;<volume>22</volume>:<fpage>521</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">3071258</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haag</surname><given-names>J</given-names></string-name>, <string-name><surname>Höhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Bettisworth</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>From easy to hopeless—predicting the difficulty of phylogenetic analyses</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msac254</fpage>.<pub-id pub-id-type="pmid">36395091</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Höhna</surname><given-names>S</given-names></string-name>, <string-name><surname>Drummond</surname><given-names>AJ.</given-names></string-name></person-group><article-title>Guided tree topology proposals for bayesian phylogenetic inference</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">21828081</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larget</surname><given-names>B.</given-names></string-name></person-group><article-title>The estimation of tree posterior probabilities using conditional clade probability distributions</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>501</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">23479066</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname><given-names>N</given-names></string-name>, <string-name><surname>Rodrigue</surname><given-names>N</given-names></string-name>, <string-name><surname>Stubbs</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Phylobayes mpi: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>611</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molloy</surname><given-names>EK</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group><article-title>FastMulRFS: fast and accurate species tree estimation under generic gene duplication and loss models</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>i57</fpage>–<lpage>i65</lpage>.<pub-id pub-id-type="pmid">32657396</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Kozlov</surname><given-names>AM</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>GeneRax: a tool for species-tree-aware maximum likelihood-based gene family tree inference under gene duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2020</year>;<volume>37</volume>:<fpage>2763</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">32502238</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Schade</surname><given-names>P</given-names></string-name>, <string-name><surname>Lutteropp</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Speciesrax: a tool for maximum likelihood species tree inference from gene family trees under duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msab365</fpage>.<pub-id pub-id-type="pmid">35021210</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Arigon</surname><given-names>A-M</given-names></string-name>, <string-name><surname>Dufayard</surname><given-names>J-F</given-names></string-name></person-group><etal>et al</etal><article-title>Databases of homologous gene families for comparative genomics</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:<fpage>S3</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btae162-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Menet</surname><given-names>H</given-names></string-name>, <string-name><surname>Tricou</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Thirdkind: displaying phylogenetic encounters beyond 2-level reconciliation</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2350</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">35139153</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname><given-names>F</given-names></string-name>, <string-name><surname>Teslenko</surname><given-names>M</given-names></string-name>, <string-name><surname>van der Mark</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>MrBayes 3.2: efficient bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>539</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Boussau</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient exploration of the space of reconciled gene trees</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>901</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">23925510</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Daubin</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>The inference of gene trees with species trees</article-title>. <source>Syst Biol</source><year>2015</year>;<volume>64</volume>:<fpage>e42</fpage>–<lpage>e62</lpage>.<pub-id pub-id-type="pmid">25070970</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wehe</surname><given-names>A</given-names></string-name>, <string-name><surname>Bansal</surname><given-names>MS</given-names></string-name>, <string-name><surname>Burleigh</surname><given-names>JG</given-names></string-name></person-group><etal>et al</etal><article-title>DupTree: a program for large-scale phylogenetic analyses using gene tree parsimony</article-title>. <source>Bioinformatics</source><year>2008</year>;<volume>24</volume>:<fpage>1540</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">18474508</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Spang</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Integrative modeling of gene and genome evolution roots the archaeal tree of life</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2017</year>;<volume>114</volume>:<fpage>E4602</fpage>–<lpage>E4611</lpage>.<pub-id pub-id-type="pmid">28533395</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group><article-title>Astral-pro 2: ultrafast species tree reconstruction from multi-copy gene family trees</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>4949</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">36094339</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10990685</article-id>
    <article-id pub-id-type="pmid">38514421</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae162</article-id>
    <article-id pub-id-type="publisher-id">btae162</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AleRax: a tool for gene and species tree co-estimation and reconciliation under a probabilistic model of gene duplication, transfer, and loss</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6286-4419</contrib-id>
        <name>
          <surname>Morel</surname>
          <given-names>Benoit</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Tom A</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8 1TQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0353-0691</contrib-id>
        <name>
          <surname>Stamatakis</surname>
          <given-names>Alexandros</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
        <aff><institution>Institute of Computer Science, Biodiversity Computing Group</institution>, Heraklion GR-70013, <country country="GR">Greece</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Szöllősi</surname>
          <given-names>Gergely J</given-names>
        </name>
        <aff><institution>ELTE-MTA “Lendület”, Evolutionary Genomics Research Group</institution>, Budapest H-1117, <country country="HU">Hungary</country></aff>
        <aff><institution>Institute of Evolution, HUN-REN Centre for Ecological Research</institution>, Budapest H-1121, <country country="HU">Hungary</country></aff>
        <aff><institution>Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University</institution>, Okinawa 904-0495, <country country="JP">Japan</country></aff>
        <xref rid="btae162-cor1" ref-type="corresp"/>
        <!--Gergely.Szollosi@oist.jp-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae162-cor1">Corresponding author. Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University, 1919-1 Tancha, Onna, Kunigami District, Okinawa 904-0412, Japan. E-mail: <email>Gergely.Szollosi@oist.jp</email> (G.J.S.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-21">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae162</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>03</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae162.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genomes are a rich source of information on the pattern and process of evolution across biological scales. How best to make use of that information is an active area of research in phylogenetics. Ideally, phylogenetic methods should not only model substitutions along gene trees, which explain differences between homologous gene sequences, but also the processes that generate the gene trees themselves along a shared species tree. To conduct accurate inferences, one needs to account for uncertainty at both levels, that is, in gene trees estimated from inherently short sequences and in their diverse evolutionary histories along a shared species tree.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present AleRax, a software that can infer reconciled gene trees together with a shared species tree using a simple, yet powerful, probabilistic model of gene duplication, transfer, and loss. A key feature of AleRax is its ability to account for uncertainty in the gene tree and its reconciliation by using an efficient approximation to calculate the joint phylogenetic—reconciliation likelihood and sample reconciled gene trees accordingly. Simulations and analyses of empirical data show that AleRax is one order of magnitude faster than competing gene tree inference tools while attaining the same accuracy. It is consistently more robust than species tree inference methods such as SpeciesRax and ASTRAL-Pro 2 under gene tree uncertainty. Finally, AleRax can process multiple gene families in parallel thereby allowing users to compare competing phylogenetic hypotheses and estimate model parameters, such as duplication, transfer, and loss probabilities for genome-scale datasets with hundreds of taxa.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GNU GPL at <ext-link xlink:href="https://github.com/BenoitMorel/AleRax" ext-link-type="uri">https://github.com/BenoitMorel/AleRax</ext-link> and data are made available at <ext-link xlink:href="https://cme.h-its.org/exelixis/material/alerax_data.tar.gz" ext-link-type="uri">https://cme.h-its.org/exelixis/material/alerax_data.tar.gz</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Klaus Tschira Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100007316</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Simultaneously inferring gene trees and the species tree is challenging. Genomes contain abundant information about evolutionary history, but single gene sequences are often too short to reliably resolve gene trees (<xref rid="btae162-B9" ref-type="bibr">Haag <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, gene trees are not species trees, but each is the unique result of series of evolutionary events. Starting from an individual site in a genome up to the species level, a hierarchy of evolutionary processes generate genomic sequences, with each level of the hierarchy contributing to the phylogenetic signal that can induce differences between reconstructed gene trees (<xref rid="btae162-B20" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2015</xref>). Segregating mutations that cross speciation events (a process called incomplete lineage sorting) leave topological signatures in gene trees. Duplications, transfers, and losses of genes (DTL) lead to substantial differences in the size and phylogenetic distribution of families of homologous genes, and at the same time induce patent phylogenetic discord.</p>
    <p>While most species tree inference methods take single-copy genes as input that are assumed <italic toggle="yes">a priori</italic> to be orthologous (i.e. to have originated from a common ancestral gene solely through speciation), more recent methods are able to handle more general homologous gene families (i.e. genes that originated from a common ancestor through speciation, gene duplication and possibly transfer events) including multi-copy ones. DupTree (<xref rid="btae162-B21" ref-type="bibr">Wehe <italic toggle="yes">et al.</italic> 2008</xref>) searches for the species tree with the most parsimonious reconciliation cost, measured as the number of duplication events. STAG (<xref rid="btae162-B7" ref-type="bibr">Emms and Kelly 2018</xref>) infers a species tree by applying a distance method to each gene family that covers <italic toggle="yes">all</italic> species, and subsequently builds a consensus tree from all these distance-based trees. FastMulRFS (<xref rid="btae162-B13" ref-type="bibr">Molloy and Warnow 2020</xref>) extends the definition of the Robinson-Foulds (RF) distance to multi-copy gene trees and strives to minimize this distance between the species tree and all input gene trees. ASTRAL-Pro 2 (<xref rid="btae162-B23" ref-type="bibr">Zhang and Mirarab 2022</xref>) infers a species tree from multi-copy gene trees by maximizing a duplication-aware quartet score. We recently developed SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), a tool that models gene DTL events and that estimates a maximum likelihood (ML) rooted species tree under the so-called UndatedDTL model. However, all those methods only consider a single <italic toggle="yes">estimated</italic> gene tree per gene family as input, and are thus sensitive to gene tree uncertainty. Alternative methods such as Phyldog (<xref rid="btae162-B2" ref-type="bibr">Boussau <italic toggle="yes">et al.</italic> 2013</xref>) jointly estimate the species tree <italic toggle="yes">and</italic> the gene trees that evolved along it via speciation, duplication, and loss. However, Phyldog does not scale to large datasets, does not model gene transfer, and is less accurate than SpeciesRax and Astral-Pro on simulations, even in the absence of gene transfers (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>Another challenge is to infer a reconciled gene tree: that is, a gene tree together with a reconciliation, or series of DTL and speciation events that trace its evolution along the species tree. To this end, we previously developed GeneRax (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>), a probabilistic method that searches for the reconciled gene trees that maximize the joint likelihood, defined as the product of the phylogenetic likelihood (the probability of the multiple sequence alignment (MSA) given the gene tree) and the reconciliation likelihood (the probability of the gene tree given the species tree under UndatedDTL). However, GeneRax does not provide a confidence measure for the inferred gene trees. Amalgamated Likelihood Estimation (ALE) (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) is an alternative two-step approach that sums the joint likelihood over all reconciled gene trees. The probabilities of the gene trees are estimated based on the conditional clade probabilities of their constituent clades (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). Confidence in a particular DTL event can then be estimated by counting how frequently it appears in the different reconciled gene trees. However, ALE is not able to simultaneously process multiple gene families, or to infer the species tree.</p>
    <p>Here we present AleRax, a novel probabilistic method for phylogenetic tree inference that can perform both species tree inference <italic toggle="yes">and</italic> reconciled gene tree inference from a sample of gene trees. We first present the method and the key features of AleRax. Then, we present the results of our benchmarks: we found that AleRax is on par with ALE in terms of gene tree reconstruction accuracy, but an order of magnitude faster and robust to numerical underflow that sometimes causes ALE to fail. Based on simulations, AleRax is 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2 for species tree inference, but at least one order of magnitude slower than those two methods.</p>
  </sec>
  <sec>
    <title>2 Method</title>
    <sec>
      <title>2.1 Likelihood definition and computation</title>
      <p>Let <italic toggle="yes">S</italic> be the species tree, and <italic toggle="yes">A</italic> be an alignment of homologous genes, that is, a gene family alignment. The probability of observing <italic toggle="yes">A</italic> given <italic toggle="yes">S</italic> is obtained by summing over all possible rooted gene trees <italic toggle="yes">G</italic> for alignment <italic toggle="yes">A</italic>:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>(<xref rid="btae162-B8" ref-type="bibr">Felsenstein 1988</xref>, <xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>).</p>
      <p>AleRax approximates <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by using the ALE (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) algorithm, which takes as input a sample of gene trees for each gene family, ideally computed via a Bayesian inference tool such as Phylobayes (<xref rid="btae162-B12" ref-type="bibr">Lartillot <italic toggle="yes">et al.</italic> 2013</xref>) or MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>) prior to running AleRax. The gene trees in the samples can be rooted or unrooted. Instead of naïvely computing the sum <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>G</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, AleRax uses the sample of gene trees provided to estimate a nonzero probability for all gene tree topologies that can be “amalgamated” (<xref rid="btae162-B3" ref-type="bibr">David and Alm 2011</xref>) from clades present in the sample using conditional clade probabilities (CCPs) (<xref rid="btae162-B10" ref-type="bibr">Höhna and Drummond 2012</xref>, <xref rid="btae162-B11" ref-type="bibr">Larget 2013</xref>). This corresponds to the maximum entropy distribution given marginal split frequencies in the sample of gene trees provided as input (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). Using CCPs allows AleRax to exploit a joint dynamic programming recursion that efficiently and accurately approximates <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>). An in-depth description of this algorithm is provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Importantly, unlike ALE, AleRax uses arbitrary-precision floating point values when necessary, allowing it to process datasets that cause ALE to fail due to numerical underflow. AleRax can also process multiple gene families in parallel given a sample of genes for each family allowing it to infer the species tree as well as more realistic DTL models, e.g. branch-wise DTL parameters on the species tree, by maximizing the likelihood of the species tree, which can be written as the product over all per-family alignment probabilities:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.2 Species tree inference</title>
      <p>AleRax searches for the rooted ML species tree. It implements the same tree search strategy as SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), which applies hill-climbing subtree prune and regraft (SPR) moves until it cannot find a move that yields a tree with a better likelihood. However, unlike SpeciesRax, which relies on a single gene tree per gene family, AleRax uses a sample of per family gene trees to integrate over gene tree uncertainty by approximating <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. AleRax recomputes the model parameters (described in the next subsection) after each round of SPR moves. The starting species tree can be generated at random, estimated with MiniNJ (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>) (a duplication-aware distance method), or specified by the user.</p>
    </sec>
    <sec>
      <title>2.3 Model parameter estimation</title>
      <p>In general, the reconciliation model used by AleRax, the so called UndatedDTL model (<xref rid="btae162-B14" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2020</xref>) can have three free parameters per gene family <italic toggle="yes">k</italic> and per species tree branch <italic toggle="yes">e</italic>: <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, representing the duplication, transfer, and loss probabilities, respectively. However, estimating such a large number of free parameters (proportional to the product of the number of species in <italic toggle="yes">S</italic> multiplied by the number of gene families) can lead to over-parameterization. Hence, AleRax implements three distinct approaches to parameter estimation that can be chosen by the user. In the <italic toggle="yes">global parameters</italic> mode, all families and all species share the same set of parameters <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mo>δ</mml:mo><mml:mo>,</mml:mo><mml:mo>τ</mml:mo><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, resulting in only three free parameters. In the <italic toggle="yes">per-family parameters</italic> mode, AleRax optimizes a different set of parameters <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for each gene family <italic toggle="yes">k</italic>. This corresponds to 3<italic toggle="yes">K</italic> free parameters, where <italic toggle="yes">K</italic> is the number of gene families. In the <italic toggle="yes">per-species parameter</italic> mode, the user can provide a list of species groupings that share the same set of parameters. In this mode, the model has 3<italic toggle="yes">n</italic> free parameters, where <italic toggle="yes">n</italic> is the number of groupings defined. In each mode, AleRax optimizes the model parameter values with respect to the likelihood via gradient descent. Our experiments suggest that AleRax performs similarly in terms of gene tree and species tree accuracy under the different modes.</p>
    </sec>
    <sec>
      <title>2.4 Sampling reconciled gene trees</title>
      <p>AleRax samples, per gene family, <italic toggle="yes">r</italic> reconciled gene trees proportional to their joint likelihood using stochastic backtracking following the dynamic programming recursion (<xref rid="btae162-B19" ref-type="bibr">Szöllősi <italic toggle="yes">et al.</italic> 2013</xref>) used to approximate <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. We describe the algorithm in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>. The number of gene trees <italic toggle="yes">r</italic> to sample is specified by the user. For each gene family, AleRax outputs the <italic toggle="yes">r</italic> reconciled gene trees, the rooted majority-rule consensus gene tree, and the number of gene events per species, averaged over all output samples for this specific gene family. The reconciliations are stored in RecPhyloXML format (<xref rid="btae162-B6" ref-type="bibr">Duchemin <italic toggle="yes">et al.</italic> 2018</xref>) and can be converted into SVG figures using Thirdkind (<xref rid="btae162-B17" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2022</xref>). AleRax also outputs the species pairs involved in horizontal gene transfers, sorted by the number of times those transfers have been sampled (per family and summed over all families). In addition, for each species, it returns the number of ancestral gene copies and the number of DTL events. We also provide scripts to extract lists of families that were involved in transfers between specific species pairs, or families that experienced a specific event for a given species (e.g., all families with a gene duplication in <italic toggle="yes">Arabidopsis thaliana</italic>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Here we only provide a summary of the experiments and their results. We describe them in detail in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>.</p>
    <sec>
      <title>3.1 Gene tree reconciliation</title>
      <p>We ran both ALE and AleRax on the simulated datasets used to benchmark SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>). As expected, ALE and AleRax perform analogously in terms of accuracy (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>). We also executed both tools on a real dataset derived from the HOGENOM (<xref rid="btae162-B16" ref-type="bibr">Penel <italic toggle="yes">et al.</italic> 2009</xref>) database’s HOGENOM-CORE subdataset, which contains 666 representative genomes spanning the diversity of cellular life. ALE failed for 25 families (out of 12 408) because of numerical underflow. AleRax in contrast successfully processed all families. In terms of runtime, AleRax was on average an order of magnitude faster than ALE, both on simulated and empirical datasets (<xref rid="btae162-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btae162-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Results on simulated datasets for varying average gene sequence lengths (sites), with 100 gene families and 25 species. When inferring gene trees, the true species tree is assumed to be known.</p>
        </caption>
        <graphic xlink:href="btae162f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Species tree inference</title>
      <p>We investigated the impact of using gene tree distributions instead of single ML gene trees by comparing AleRax, SpeciesRax, and ASTRAL-Pro 2 on simulated datasets. We used the same benchmarks that were employed for assessing SpeciesRax (<xref rid="btae162-B15" ref-type="bibr">Morel <italic toggle="yes">et al.</italic> 2022</xref>), that is, we varied different simulation parameters individually while keeping the rest fixed, and measured the distance between the true and the inferred species trees. We ran AleRax on gene tree distributions inferred with MrBayes (<xref rid="btae162-B18" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic> 2012</xref>). We found that, over all conditions tested, AleRax is on average 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2. For instance, <xref rid="btae162-F1" ref-type="fig">Fig. 1</xref> compares the accuracy of the different methods when varying the average gene sequence lengths. Our explanation is that using fixed gene tree estimates does not capture all the information contained in the gene sequences. Treating gene trees as latent variables allows AleRax to avoid this information loss, and thus to be more robust to phylogenetic uncertainty. When using gene tree distributions with 1000 gene trees per gene family, AleRax is from one to two orders of magnitude slower than SpeciesRax (<xref rid="btae162-F1" ref-type="fig">Fig. 1d</xref>).</p>
      <p>To investigate the performance of rooted species tree inference with AleRax on real data, we returned to an earlier phylogenetic analysis of the archaeal domain of life (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B4" ref-type="bibr">Davín <italic toggle="yes">et al.</italic> 2018</xref>). The Archaea constitute one of the two prokaryotic domains of life, but their early evolution and the position of the root remains poorly understood. Previous studies, including a 2017 analysis by some of us, have placed the root between the genome-reduced DPANN Archaea and the other lineages (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>). In the 2017 study, we used ALE to infer the optimal root position based on a fixed unrooted topology estimating using concatenation of a set of 45 vertically-evolving marker genes. This hybrid strategy was employed because ALE cannot search the space of rooted species trees. We performed AleRax, SpeciesRax, and ASTRAL-Pro-2 analyses on the set of 5379 gene families, using the same MCMC gene tree samples to represent gene tree uncertainty as in the original study in the case of AleRax. On a 40-cores machine, Astral-Pro 2 finished after 15 s, SpeciesRax after 167 s, and AleRax after 9215 s. AleRax inferred a rooted species tree closely similar to the original study and to other recent analyses (<xref rid="btae162-B5" ref-type="bibr">Dombrowski <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae162-B1" ref-type="bibr">Aouad <italic toggle="yes">et al.</italic> 2022</xref>), with a root between DPANN Archaea and the rest, and recovering the monophyly of major archaeal groups including DPANN, TACK Archaea, and most of the Euryarchaeota (see <xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>), although two incomplete genomes (SAG I15 and Thaumarchaeota E09) were likely misplaced. The SpeciesRax tree was heterodox, recovering a mixture of TACK Archaea, Euryarchaeota and DPANN on both sides of the root (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). The unrooted species tree inferred by ASTRAL-Pro-2 was very similar to the topology of the AleRax tree (<xref rid="btae162-F2" ref-type="fig">Fig. 2</xref>). If current views about archaeal phylogeny are broadly correct, this analysis suggests that AleRax can be substantially more accurate than SpeciesRax when inferring the root and topology of species trees from real data, likely because of its ability to model gene tree uncertainty. The analysis also demonstrates that reconciliation methods can capture information about the root and topology of species trees, and that in the case of the Archaea this signal is congruent with that from traditional concatenation-based phylogenetics. In this case study, AleRax and ASTRAL-Pro-2 both recovered species trees that are consistent with current views. While ASTRAL-Pro-2 was much faster, the AleRax analysis provided an estimate of the root of the species tree, reconciliation scenarios for each gene family, and gene content reconstructions for each internal node of the tree. These comparative genomic outputs are an important part of the use case for AleRax and similar reconciliation tools, and can be used (for example) to propose hypotheses about ancestral gene repertoires and organismal characteristics, including metabolisms (<xref rid="btae162-B22" ref-type="bibr">Williams <italic toggle="yes">et al.</italic> 2017</xref>).</p>
      <fig position="float" id="btae162-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Archaeal tree inferred with AleRax, with the four main groups: DPANN, Euryarchaeota, TACK, and Asgardarchaeota.</p>
        </caption>
        <graphic xlink:href="btae162f2" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion and future work</title>
    <p>AleRax is an efficient and user-friendly tool for species tree inference and gene tree-species tree reconciliation that can be applied to datasets from across the tree of life. It is particularly useful in biological applications where not only the species tree, but also the histories individual of gene families are of interest. We showed that AleRax is on par with ALE in terms of reconciled gene tree accuracy, while being one order of magnitude faster and more robust to numerical errors. Furthermore, it infers more accurate species trees than SpeciesRax and ASTRAL-Pro 2, because it can accommodate gene tree uncertainty. In the future, we plan to improve our model to accommodate DTL rate heterogeneity over species, incomplete lineage sorting, and horizontal gene transfer time constraints.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae162_Supplementary_Data</label>
      <media xlink:href="btae162_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>B.M. and A.S. are financially supported by the Klaus Tschira Foundation, by DFG grant STA 860/6–2, and by the European Union (EU) under Grant Agreement No 101087081 (Comp-Biodiv-GR). G.S. received funding from the European Research Council under the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 714774 and the grant GINOP-2.3.2.–15-2016–00057. This work was funded by the Gordon and Betty Moore Foundation through grant GBMF9741 to T.A.W. and G.S.</p>
    <p>
      <inline-graphic xlink:href="btae162ilf1.jpg"/>
    </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data are incorporated into the article and its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae162-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aouad</surname><given-names>M</given-names></string-name>, <string-name><surname>Flandrois</surname><given-names>J-P</given-names></string-name>, <string-name><surname>Jauffrit</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>A divide-and-conquer phylogenomic approach based on character supermatrices resolves early steps in the evolution of the archaea</article-title>. <source>BMC Ecol Evol</source><year>2022</year>;<volume>22</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34986784</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boussau</surname><given-names>B</given-names></string-name>, <string-name><surname>Szöllosi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Duret</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res</source><year>2013</year>;<volume>23</volume>:<fpage>323</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>David</surname><given-names>LA</given-names></string-name>, <string-name><surname>Alm</surname><given-names>EJ.</given-names></string-name></person-group><article-title>Rapid evolutionary innovation during an Archaean genetic expansion</article-title>. <source>Nature</source><year>2011</year>;<volume>469</volume>:<fpage>93</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21170026</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davín</surname><given-names>AA</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name></person-group><etal>et al</etal><article-title>Gene transfers can date the tree of life</article-title>. <source>Nat Ecol Evol</source><year>2018</year>;<volume>2</volume>:<fpage>904</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29610471</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dombrowski</surname><given-names>N</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Sun</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Undinarchaeota illuminate dpann phylogeny and the impact of gene transfer on archaeal evolution</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>3939</fpage>.<pub-id pub-id-type="pmid">32770105</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchemin</surname><given-names>W</given-names></string-name>, <string-name><surname>Gence</surname><given-names>G</given-names></string-name>, <string-name><surname>Arigon Chifolleau</surname><given-names>A-M</given-names></string-name></person-group><etal>et al</etal><article-title>RecPhyloXML: a format for reconciled gene trees</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>3646</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">29762653</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>D</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group><article-title>Stag: species tree inference from all genes</article-title>. <source>bioRxiv</source><year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae162-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group><article-title>Phylogenies from molecular sequences: inference and reliability</article-title>. <source>Annu Rev Genet</source><year>1988</year>;<volume>22</volume>:<fpage>521</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">3071258</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haag</surname><given-names>J</given-names></string-name>, <string-name><surname>Höhler</surname><given-names>D</given-names></string-name>, <string-name><surname>Bettisworth</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>From easy to hopeless—predicting the difficulty of phylogenetic analyses</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msac254</fpage>.<pub-id pub-id-type="pmid">36395091</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Höhna</surname><given-names>S</given-names></string-name>, <string-name><surname>Drummond</surname><given-names>AJ.</given-names></string-name></person-group><article-title>Guided tree topology proposals for bayesian phylogenetic inference</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">21828081</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larget</surname><given-names>B.</given-names></string-name></person-group><article-title>The estimation of tree posterior probabilities using conditional clade probability distributions</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>501</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">23479066</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname><given-names>N</given-names></string-name>, <string-name><surname>Rodrigue</surname><given-names>N</given-names></string-name>, <string-name><surname>Stubbs</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Phylobayes mpi: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>611</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molloy</surname><given-names>EK</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group><article-title>FastMulRFS: fast and accurate species tree estimation under generic gene duplication and loss models</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>i57</fpage>–<lpage>i65</lpage>.<pub-id pub-id-type="pmid">32657396</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Kozlov</surname><given-names>AM</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>GeneRax: a tool for species-tree-aware maximum likelihood-based gene family tree inference under gene duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2020</year>;<volume>37</volume>:<fpage>2763</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">32502238</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B</given-names></string-name>, <string-name><surname>Schade</surname><given-names>P</given-names></string-name>, <string-name><surname>Lutteropp</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Speciesrax: a tool for maximum likelihood species tree inference from gene family trees under duplication, transfer, and loss</article-title>. <source>Mol Biol Evol</source><year>2022</year>;<volume>39</volume>:<fpage>msab365</fpage>.<pub-id pub-id-type="pmid">35021210</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Arigon</surname><given-names>A-M</given-names></string-name>, <string-name><surname>Dufayard</surname><given-names>J-F</given-names></string-name></person-group><etal>et al</etal><article-title>Databases of homologous gene families for comparative genomics</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:<fpage>S3</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btae162-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Penel</surname><given-names>S</given-names></string-name>, <string-name><surname>Menet</surname><given-names>H</given-names></string-name>, <string-name><surname>Tricou</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Thirdkind: displaying phylogenetic encounters beyond 2-level reconciliation</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2350</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">35139153</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname><given-names>F</given-names></string-name>, <string-name><surname>Teslenko</surname><given-names>M</given-names></string-name>, <string-name><surname>van der Mark</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>MrBayes 3.2: efficient bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Syst Biol</source><year>2012</year>;<volume>61</volume>:<fpage>539</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Boussau</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient exploration of the space of reconciled gene trees</article-title>. <source>Syst Biol</source><year>2013</year>;<volume>62</volume>:<fpage>901</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">23925510</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Tannier</surname><given-names>E</given-names></string-name>, <string-name><surname>Daubin</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>The inference of gene trees with species trees</article-title>. <source>Syst Biol</source><year>2015</year>;<volume>64</volume>:<fpage>e42</fpage>–<lpage>e62</lpage>.<pub-id pub-id-type="pmid">25070970</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wehe</surname><given-names>A</given-names></string-name>, <string-name><surname>Bansal</surname><given-names>MS</given-names></string-name>, <string-name><surname>Burleigh</surname><given-names>JG</given-names></string-name></person-group><etal>et al</etal><article-title>DupTree: a program for large-scale phylogenetic analyses using gene tree parsimony</article-title>. <source>Bioinformatics</source><year>2008</year>;<volume>24</volume>:<fpage>1540</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">18474508</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>TA</given-names></string-name>, <string-name><surname>Szöllősi</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Spang</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Integrative modeling of gene and genome evolution roots the archaeal tree of life</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2017</year>;<volume>114</volume>:<fpage>E4602</fpage>–<lpage>E4611</lpage>.<pub-id pub-id-type="pmid">28533395</pub-id></mixed-citation>
    </ref>
    <ref id="btae162-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group><article-title>Astral-pro 2: ultrafast species tree reconstruction from multi-copy gene family trees</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>4949</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">36094339</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
