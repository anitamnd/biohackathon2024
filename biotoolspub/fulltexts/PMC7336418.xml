<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7336418</article-id>
    <article-id pub-id-type="publisher-id">3634</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03634-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HPG-DHunter: an ultrafast, friendly tool for DMR detection and visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fernández</surname>
          <given-names>Lisardo</given-names>
        </name>
        <address>
          <email>Lisardo.Fernandez@uv.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez</surname>
          <given-names>Mariano</given-names>
        </name>
        <address>
          <email>Mariano.Perez@uv.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olanda</surname>
          <given-names>Ricardo</given-names>
        </name>
        <address>
          <email>Ricardo.Olanda@uv.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2932-0214</contrib-id>
        <name>
          <surname>Orduña</surname>
          <given-names>Juan M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marquez-Molins</surname>
          <given-names>Joan</given-names>
        </name>
        <address>
          <email>joanmarquez21@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5338.d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2173 938X</institution-id><institution>Departamento de Informática, Universidad de Valencia, </institution></institution-wrap>Avda. Universidad, s/n, Burjassot (Valencia), Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.507638.f</institution-id><institution>I2SysBio, CSIC-Universidad de Valencia, </institution></institution-wrap>Cat. Agustín Escardino, Paterna (Valencia), Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>287</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Software tools for analyzing DNA methylation do not provide graphical results which can be easily identified, but huge text files containing the alignment of the samples and their methylation status at a resolution of base pairs. There have been proposed different tools and methods for finding Differentially Methylated Regions (DMRs) among different samples, but the execution time required by these tools is large, and the visualization of their results is far from being interactive. Additionally, these methods show more accurate results when identifying simulated DM regions that are long and have small within-group variation, but they have low concordance when used with real datasets, probably due to the different approaches they use for DMR identification. Thus, a tool which automatically detects DMRs among different samples and interactively visualizes DMRs at different scales (from a bunch to ten of millions of DNA locations) can be the key for shortening the DNA methylation analysis process in many studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we propose a software tool based on the wavelet transform. This mathematical tool allows the fast automatic DMR detection by simple comparison of different signals at different resolution levels. Also, it allows an interactive visualization of the DMRs found at different resolution levels. The tool is publicly available at <ext-link ext-link-type="uri" xlink:href="https://grev-uv.github.io/">https://grev-uv.github.io/</ext-link>, and it is part of a complete suite of tools which allow to carry out the complete process of DNA alignment and methylation analysis, creation of methylation maps of the whole genome, and the detection and visualization of DMRs between different samples.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The validation of the developed software tool shows similar concordance with other well-known and extended tools when used with real and synthetic data. The batch mode of the tool is capable of automatically detecting the existing DMRs for half (twelve) of the human chromosomes between two sets of six samples (whose.csv files after the alignment and mapping procedures have an aggregated size of 108 Gigabytes) in around three hours and a half. When compared to other well-known tools, HPG-DHunter only requires around 15% of the execution time required by other tools for detecting the DMRs.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>High performance computing</kwd>
      <kwd>DNA methylation</kwd>
      <kwd>Wavelet transform</kwd>
      <kwd>GPU computing</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Bisulphite-treated DNA methylation analysis requires specific treatment of DNA that modifies its sequence, as well as software tools for its analysis. Bisulphite treatment converts unmethylated cytosines (Cs) into thymines (Ts), which gives rise to C-to-T changes in DNA sequence after sequencing, while leaving methylated cytosines (5mCs) unchanged. By aligning and comparing bisulphite sequencing reads to the genomic DNA sequence, it is possible to infer DNA methylation patterns at base pair-resolution ([<xref ref-type="bibr" rid="CR1">1</xref>]). Hydroxymethylated samples can also be obtained from different methods, the Ten-eleven translocation (TET) Assisted Bisulfite Sequencing (TAB-Seq) ([<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]), which produces Ts in methylated and unmethylated Cs and maintains as C the hydroxymethylated Cs (5hmC), and the oxidative bisulphate sequencing (oxBs-seq) ([<xref ref-type="bibr" rid="CR4">4</xref>]). Different software tools have been proposed for DNA methylation analysis like RRBSMAP ([<xref ref-type="bibr" rid="CR5">5</xref>]), the widely extended tool Bismark ([<xref ref-type="bibr" rid="CR6">6</xref>]), or the most recent tools HPG-Methyl ([<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]). These tools provide single-base information of the alignment and the methylation status of each input sequence (or read). However, all these software tools yield the results as text files which usually have sizes of tens of Gigabytes, and follow the Sequence Alignment/Map (SAM) format or the Binary Alignment Map (BAM) format. Other tools like HPG-HMapper ([<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]) uses the methylation information of each base for each read present in the BAM files to build a DNA methylation map which gives information about the methylation level for each base of the reference genome. This map is yielded as one csv file for each chromosome in the species. Biomedical researches then have to compare the methylation level information in these files at different scales (DNA segments, CpG islands or coding regions, DNA chromosomes, etc.) besides the base-pair resolution, comparing also the results coming from different samples. Thus, many different tools for processing, displaying the methylation results and discovering differentially methylated regions (DMRs) have been proposed ([<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]). However, most of these tools are based on statistical techniques, adding a high computational workload when applied to huge BAM or SAM files. As a result, the execution time required by these tools is large, adding an excessive delay from the moment of the sample extraction from the DNA sequencer until the moment when significant information is provided to the doctor or biomedical researcher. Also, the visualization of these data is far from being interactive. Another disadvantage of these tools is that many of them are essentially R scripts, which requires programming skills from the user. Finally, as some comparative study shows [<xref ref-type="bibr" rid="CR17">17</xref>], these methods show more accurate results when identifying simulated DM regions that are long and have small within-group variation, but they have low concordance, probably due to the different approaches they have used for DM identification. Thus, they yield very low concordance when used with real data.</p>
    <p>In a previous work, we proposed the building of a methylation signal and the implementation of its wavelet transform in the GPU for visualization purposes ([<xref ref-type="bibr" rid="CR18">18</xref>]). In this paper, we present HPG-DHunter, a user-friendly graphical tool not only for interactive visualization of methylation signals but also for automatic DMR detection, based on the information generated by the Discrete Wavelet Transform (DWT). This software tool can detect and display at different scales DMRs from different samples, and it is publicly available at <ext-link ext-link-type="uri" xlink:href="https://grev-uv.github.io/">https://grev-uv.github.io/</ext-link>. The tool is based on transforming the methylation (and/or hydroxymethylation) level information of each base in the reference genome into a methylation signal, and applying the Discrete Wavelet Transform to this signal in order to detect DMRs in the Transform space. DWT performs local averaging of the methylation signal at different resolution levels, like smoothing-based approaches do ([<xref ref-type="bibr" rid="CR16">16</xref>]). On the one hand, this averaging takes into account the biological variability present in the information gathered in the methylation maps. On the other hand, this local averaging yields a more accurate measurement of the methylation level for wider DNA segments. However, by using a dyadic decomposition of the DWT this strategy achieves a logarithmic reduction in the number of values used for comparing signals and detecting DMRs, compared to the ones used in other smoothing-based methods like [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]), in such a way that the computational workload required for detecting DMRs is reduced in orders of magnitude. The validation of the tool is a comparison study, carried out with a real dataset with known DMRs, which compares the results yielded with this tool to the ones yielded by other three widely used tools, namely BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>], DSS-Single [<xref ref-type="bibr" rid="CR14">14</xref>], and methylKit [<xref ref-type="bibr" rid="CR19">19</xref>]. This validation study with a real dataset shows that the proposed tool is as valid and effective as the other well-known tools.</p>
    <p>HPG-DHunter can efficiently detect and display DMRs for different thresholds of methylation rate, coverage and number of samples, since the use of GPUs allows the parallel processing of methylation signals and their interactive visualization at different scales. To the best of our knowledge, this tool is the first one that can automatically detect DMRs between samples in all the chromosomes for a given difference threshold. Moreover, it is the first tool that allows an interactive visualization of DMRs at different levels of detail. The performance evaluation results show that the batch mode of the tool is capable of detecting the DMRs in 12 chromosomes between two sets of six (human) samples (whose methylation maps have an aggregated size of 108 Gigabytes) in around three hours and a half. When compared with the other three software tools, HPG-DHunter only requires around 15% of the execution times required by any of them. These results show that the tool offers biomedical researchers a valuable tool for easily finding hyper or hypomethylation differences in any set of fastq files.</p>
    <p>HPG-DHunter is the third and last module of HPG-Msuite (<ext-link ext-link-type="uri" xlink:href="https://grev-uv.github.io/">https://grev-uv.github.io/</ext-link>), whose two first modules are HPG-Methyl ([<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]) and HPG-HMapper([<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]). This comprehensive suite carries out the whole process of methylation (and/or hydroxymethylation) analysis of fastq files coming from different samples, mapping the reads on the reference genome and building a methylation map, and detecting and visualizing DMRs between the different samples. In this way, we provide biomedical researchers with a complete solution for studying DNA hyper and hypomethylation of any species. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the pipeline workflow of the HPG-Msuite. The first module is HPG-Methyl ([<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]), which takes fastq files as input and produces bam or sam files with the methylation and alignment data. The second module is HPG-HMapper ([<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]), which takes the bam/sam files as input data and produces one csv file for each chromosome and strand. Finally, HPG-DHunter takes the csv files (one for each chromosome and strand) and builds a methylation signal showing the methylation level for each location in the chromosome. Moreover, it can load and compare the methylation maps coming from different samples and build different methylation signals, detecting and displaying the DMRs among them. The rest of the paper describes in detail the implementation of HPG-DHunter and its performance evaluation with real datasets.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow for the use of HPG-Msuite, from the fastq file to the DMR detection</p></caption><graphic xlink:href="12859_2020_3634_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>HPG-DHunter takes as input files the csv files (one for each chromosome and individual/sample to be analyzed), and it produces as output a csv file for each chromosome, containing the DMRs found between the selected individuals/samples. The workflow of our approach is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. This Figure shows that HPG-DHunter first read the files corresponding to the case and control samples (the user selects each file). Then, each methylation signal is built and the DMR detection is carried out by processing the methylation signal with the Haar Wavelet Transform (the DWT is applied to each signal). At this point, the tool provides a visualization interface which allows the visual analysis at different scales of any of the DMRs found, and the results of the DMR detection can be saved in -csv files.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Workflow for the use of HPG-DHunter</p></caption><graphic xlink:href="12859_2020_3634_Fig2_HTML" id="MO2"/></fig></p>
    <p>The building of the methylation signal and the application of the wavelet transform to that signal are described in a previous work [<xref ref-type="bibr" rid="CR18">18</xref>]. However, in order to make this paper self-contained, we also summarize here these steps in the two next subsections.</p>
    <sec id="Sec3">
      <title>Building the methylation signal</title>
      <p>The first step consists of reading the.csv files containing the mapped samples, and computing the methylation ratio of each DNA base. It must be noted that any alignment and/or mapping tool can be used to produce these.csv files, although we have used HPG-Methyl and HPG-Mapper for the alignment and mapping procedures, respectively.</p>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the information that should be available in the input csv files for each DNA location where methylation is detected (there should be a csv file for each chromosome and each sample). For each location in the chromosome where a methylated cytosine has been found, it counts the number of reads which have been found having a cytosine, methylated cytosine, hydroxymethylated cytosine or a base different from a cytosine aligned to that particular location. The values in column labeled as “C” shows the number of reads containing a non-methylated cytosine in that location. The values in the column labeled as “5mC” show the number of reads which have been found having a methylated cytosine. These values (the values in the column labeled as “5mC”) include the number of reads which have been found having a hydroxymethylated cytosine (column labeled as “5hmC”). It must be noted that the samples with a base different from a cytosine (values in the column labeled as “no C” in Fig. <xref rid="Fig3" ref-type="fig">3</xref>) should be ignored in the DMR search procedure ([<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]). We will have one file to be read per sample to be studied (usually there are several control patients and several case patients, but there can be also studies which analyzes different tissues from the same patient, or other cases). In the rest of the paper, we will assume that the study to be carried out focuses on a given chromosome (a given csv file) and different control and case patients.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Information present in the csv files</p></caption><graphic xlink:href="12859_2020_3634_Fig3_HTML" id="MO3"/></fig></p>
      <p>Different specific issues must be taken into account when trying to identify DMRs ([<xref ref-type="bibr" rid="CR15">15</xref>]). First, there exists a strong spatial correlation among methylated or hydroxymethylated CpG islands, thus in these regions there is no need for the same coverage levels as in other regions. Second, the coverage, sequencing depth, or number of reads aligned on each position, is very important to properly weight the variability of the analyzed samples. Finally, the heterogeneity in the methylation levels of different tissues, or even among cells of the same tissue, may lead to errors in the identification of DMRs.</p>
      <p>Taking into account these considerations, in our work we have defined the methylation level for each cytosine in the reference genome as the methylation ratio or percentage of methylated reads <italic>mratio</italic> for each position <italic>k</italic>, computed as:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ mratio_{k} \; = \; \frac{5mC_{k}}{C_{k}+5mC_{k}}  $$ \end{document}</tex-math><mml:math id="M2"><mml:mtext mathvariant="italic">mrati</mml:mtext><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:mo>=</mml:mo><mml:mspace width="2.77626pt"/><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3634_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where 5<italic>m</italic><italic>C</italic><sub><italic>k</italic></sub> is the number of reads containing a methylated cytosine which have been aligned onto that DNA position <italic>k</italic>, and <italic>C</italic><sub><italic>k</italic></sub> is the number of read containing non-methylated cytosines which have been aligned onto that position (as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In the same way, we have computed the hydroxymethylation ratio <italic>hmratio</italic> for each position <italic>k</italic> as:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ hmratio_{k} \; = \; \frac{5hmC_{k}}{C_{k}+5hmC_{k}}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mtext mathvariant="italic">hmrati</mml:mtext><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:mo>=</mml:mo><mml:mspace width="2.77626pt"/><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:mtext mathvariant="italic">hm</mml:mtext><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mtext mathvariant="italic">hm</mml:mtext><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3634_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where 5<italic>h</italic><italic>m</italic><italic>C</italic><sub><italic>k</italic></sub> is the number of reads containing a hydroxymethylated cytosine which have been aligned onto that DNA position <italic>k</italic>. One of the advantages of this approach based on ratio is that it takes into account the biological variability among the different samples processed through bisulphite sequencing. Nevertheless, due to the errors inherent to the bisulphite treatment, the files can contain samples not belonging to the target regions of the chemical sensors. Thus, we could find for example some reads in the csv file with a value of 2 in the “5mC” column and also a value of 2 in the “C” column, for a coverage ratio <italic>m</italic><italic>r</italic><italic>a</italic><italic>t</italic><italic>i</italic><italic>o</italic><sub><italic>k</italic></sub>=1/2. Since the same ratio would result for a target region with a value of 200 in both columns, we must establish a minimum coverage threshold for filtering the reads in the csv file. This coverage threshold should be established by the user through a selector knob available in the proposed tool.</p>
      <p>Once the methylation ratio has been computed, the methylation signal should be built. Although the same process can also be carried out for the hydroxymethylation signal, for the sake of clarity we are going to exclusively describe the computation of the methylation signal. Since a methylation signal <italic>X</italic> is estimated to follow a beta-binomial distribution ([<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]), we have computed each element <italic>x</italic>[<italic>k</italic>] of the methylation signal <italic>X</italic> as
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  x[\!k] \; = \; mratio_{k}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>x</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>]</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>=</mml:mo><mml:mspace width="2.77626pt"/><mml:mtext mathvariant="italic">mrati</mml:mtext><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2020_3634_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>It must be noted that <italic>x</italic>[<italic>k</italic>] ranges between 0 and 1.</p>
    </sec>
    <sec id="Sec4">
      <title>Wavelet transform of the methylation signal</title>
      <p>Once the methylation signal <italic>X</italic> is built, the Discrete Wavelet Transform is iteratively applied on the methylation signal, until the desired resolution level is reached. We have implemented a dyadic multiresolution decomposition of the signal by iteratively applying the following filtering algorithm:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  c_{j+1}[\!k] \; = \; \sum\limits_{l} h[\!2k-l] \: c_{j}[l]  $$ \end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>]</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>=</mml:mo><mml:mspace width="2.77626pt"/><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mi>h</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>]</mml:mo><mml:mspace width="2.22144pt"/><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>l</mml:mi><mml:mo>]</mml:mo></mml:math><graphic xlink:href="12859_2020_3634_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  d_{j+1}[\!k] \; = \; \sum\limits_{l} g[\!2k-l] \: c_{j}[l]  $$ \end{document}</tex-math>
            <mml:math id="M10">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>[</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mi>k</mml:mi>
              <mml:mo>]</mml:mo>
              <mml:mspace width="2.77626pt"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="2.77626pt"/>
              <mml:munder>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:mi>g</mml:mi>
              <mml:mo>[</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mn>2</mml:mn>
              <mml:mi>k</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mi>l</mml:mi>
              <mml:mo>]</mml:mo>
              <mml:mspace width="2.22144pt"/>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>[</mml:mo>
              <mml:mi>l</mml:mi>
              <mml:mo>]</mml:mo>
            </mml:math>
            <graphic xlink:href="12859_2020_3634_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>c</italic><sub><italic>j</italic></sub>[ <italic>k</italic>] and <italic>d</italic><sub><italic>j</italic></sub>[ <italic>k</italic>] are the scaling and detail coefficients at resolution <italic>j</italic>, respectively, <italic>g</italic> highpass decomposition filter of the wavelet transform, and <italic>h</italic> is the lowpass decomposition for the selected Discrete Wavelet Transform. It must be noted that Eqs. <xref rid="Equ4" ref-type="">4</xref> and <xref rid="Equ5" ref-type="">5</xref> provide the scaling coefficients <italic>c</italic>[<italic>k</italic>] and the detail coefficients <italic>d</italic>[ <italic>k</italic>] at <italic>j</italic>+1 level, starting in both cases from the scaling coefficients <italic>c</italic>[<italic>k</italic>] at <italic>j</italic> level. Both equations include a downsampling procedure. In particular, Eq. <xref rid="Equ4" ref-type="">4</xref> reduces the size of <italic>c</italic><sub><italic>j</italic>+1</sub>[ <italic>k</italic>] to half of the size it had in level <italic>j</italic>. Also, it must be noted that for <italic>j</italic>=0, <italic>c</italic><sub>0</sub>[ <italic>k</italic>]=<italic>x</italic>[ <italic>k</italic>].</p>
      <p>It must be noted that any orthogonal or bi-orthogonal wavelet base can be used for the implementation of <italic>h</italic> and <italic>g</italic> filters. Thus, the validation study (see the “<xref rid="Sec9" ref-type="sec">Tool validation</xref>” section) considers different filters, whose values are not shown here for the sake of shortness. As a representative example, we show here the filters implemented when the HPG-DHunter module uses the Haar Discrete Wavelet Transform. The reason is that this wavelet transform has a reduced compact support (<italic>h</italic> and <italic>g</italic> filters are of length equal to 2), which on the one hand results in short computation times and on the other hand allows an efficient and simple GPU implementation. Concretely, the <italic>g</italic> and <italic>h</italic> filters for the Haar Wavelet Transform are the following ones:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  g[l] \; = \; \left[-\sqrt{2}/2, \: \sqrt{2}/2\right]  $$ \end{document}</tex-math><mml:math id="M12"><mml:mi>g</mml:mi><mml:mo>[</mml:mo><mml:mi>l</mml:mi><mml:mo>]</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>=</mml:mo><mml:mspace width="2.77626pt"/><mml:mfenced close="]" open="["><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:msqrt><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3634_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ7">
          <label>7</label>
          <alternatives>
            <tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  h[l] \; = \; \left[ \sqrt{2}/2, \: \sqrt{2}/2\right]  $$ \end{document}</tex-math>
            <mml:math id="M14">
              <mml:mi>h</mml:mi>
              <mml:mo>[</mml:mo>
              <mml:mi>l</mml:mi>
              <mml:mo>]</mml:mo>
              <mml:mspace width="2.77626pt"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="2.77626pt"/>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msqrt>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2.22144pt"/>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msqrt>
                  <mml:mo>/</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="12859_2020_3634_Article_Equ7.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Starting from the original control and case signals, the different versions of the methylation signals (with different resolution levels) are built by iteratively applying the DWT to the current signals. As an illustrating example, Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows two methylation signals processed with the proposed approach, such as they are displayed by HPG-DHunter. The two colored lines correspond to the two methylation signals. The plots in the top part of this Figure show the original methylation signals built from a DNA segment of 1241 nucleotides (from position 47830931 to position 47832172), while the rest of the plots downwards (starting from the plot below the original signals) show the same methylation signals iteratively built in the second, fourth, sixth, eighth and tenth iterations of the Haar transform. All these plots show on the X-axis the location of each base in the chromosome which is being displayed (in this case we are using human samples). On the Y-axis, they show the <italic>c</italic><sub><italic>j</italic></sub>[ <italic>k</italic>] values.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Segments of 1241 DNA positions, coming from control and case methylation signals, displayed with different resolution levels. Each colored line corresponds to a methylation signal</p></caption><graphic xlink:href="12859_2020_3634_Fig4_HTML" id="MO4"/></fig></p>
      <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates the main advantage of this approach: each iteration reduces by one-half the number of different values in the signal, since they are computed as the average value of two signal values in the previous iteration. As a result, the signal has a lower resolution but the comparison of the signal with the signals coming from other samples adds a much lower computational workload, and it is easier to detect significantly different values. Thus, the signals in the bottom plot have only 5 different values (the 1241 DNA locations take are only 5 different methylation values).</p>
      <p>In order to build the methylation signal, enough memory space should be allocated for containing an array with as many elements as adjacent locations exists between the initial and final DNA location to be analyzed (multiplied by the number of samples to be analyzed). The elements of the array corresponding to locations with non-zero values are filled with the corresponding <inline-formula id="IEq1"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v^{0}_{j}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq1.gif"/></alternatives></inline-formula> values, and the whole array is copied to the GPU memory, where the next steps are carried out. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows an example of two methylation signals where the coverage threshold has been set to 1, while Fig. <xref rid="Fig6" ref-type="fig">6</xref> shows the resulting methylation signals coming from the same csv files when the coverage threshold is set to 50.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Example methylation signals for a coverage threshold of 1 as visualized in the tool interface. A lot of DMRs (8775) are found because the minimum coverage is used</p></caption><graphic xlink:href="12859_2020_3634_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Example methylation signals for a coverage threshold of 50 as visualized in the tool interface. A few (25) DMRs are found because all the locations not arriving to the minimum coverage are not considered</p></caption><graphic xlink:href="12859_2020_3634_Fig6_HTML" id="MO6"/></fig></p>
      <p>HPG-DHunter stores the methylation signals in the GPU memory to carry out the two main tasks: detection of DMRs and the visualization of the methylation signals. Each step of the wavelet transform decomposes the signal into two halves, the first one containing a low resolution version of the signal with half the number of points, an the second one containing the wavelet coefficients. Thus, after each iterative step of the wavelet transform, for DMR detection purposes we only keep in the GPU memory the first half of the signal. This half will become as the input signal for the next iterative step of the DWT. Therefore, once the original signal is transferred to the GPU memory, no additional GPU memory is required for performing the whole DWT iterative process.</p>
    </sec>
    <sec id="Sec5">
      <title>Interactive DMR detection</title>
      <p>The DMR detection is carried out by simply comparing the values of different transformed signals with the same level of transformation. A methylation threshold should be selected by the user (using the graphical interface described below) to determine if two or more different signals should be considered as differentially methylated. All the methylation signals are iteratively transformed until the selected transformation level is reached. Then, the DMR detection is carried out in three stages: the first one consists of computing the average methylation value of all the considered signals in each group (case and control samples) for each DNA position. The second step is to find the difference (in absolute values) between these methylation average values. If this difference exceeds the threshold selected by the user through the interface, then that position is marked as DM. Finally, the third step consists in grouping adjacent DM locations.</p>
      <p>Thus, the validation process for DMR detection consists of the following process: for each value <italic>x</italic><sub><italic>j</italic></sub>[<italic>k</italic>] (each value <italic>k</italic> of the signal in the <italic>j</italic>th transformation level), we check that (by default) at least 25% of the 2<sup><italic>j</italic></sup> values in the original methylation signal (the values <italic>x</italic><sub><italic>j</italic></sub>[<italic>k</italic>]⋯<italic>x</italic><sub><italic>j</italic></sub>[<italic>k</italic>+2<sup><italic>j</italic></sup>−1] which have contributed to the value <italic>k</italic> of the signal in the <italic>j</italic>th transformation level) have a coverage ratio higher than the coverage threshold set by the user. In turn, this default percentage of 25% can be tuned by the user. In positive case, that position <italic>x</italic><sub><italic>j</italic></sub>[ <italic>k</italic>] is kept marked as DM. Otherwise, it is not marked as DM. It must be noted that if this validation process was carried out in the building stage of the methylation signal (by filtering those <italic>x</italic><sub>0</sub>[ <italic>k</italic>] values lower than the coverage threshold) then many values of the methylation signal would have been changed to zero, significantly changing the signal at all the transformation levels. By applying the validation process after the DMR detection process, we guarantee that the methylation signal is faithfully computed with respect to the methylation values in the csv input files, and so it is the DMR detection process. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows an example of DMR identification and visualization with a coverage threshold of 50 reads.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Example of a DMR identification and visualization in the tool interface. The name of each input file is given a color corresponding to its signal representation, and the DMR range, including the gene name, is shown in the central window</p></caption><graphic xlink:href="12859_2020_3634_Fig7_HTML" id="MO7"/></fig></p>
      <p>It must be noted that in each transformation level each signal point represents the weighted methylation value of several DNA locations. The selection of the most appropriate transformation level to be used for detecting DMRs is left to the user criterion, who can easily repeat all the computations and visualization of the results by moving up and down the DWT level selector (see the “<xref rid="Sec6" ref-type="sec">DMR visualization</xref>” section). The selected level of wavelet transformation has an effect in the width of the DMRs detected, in such a way that 2 elevated at the selected transformation level will determine the minimum DMR length which can be detected in this level. Therefore, the user should select the level of DMR transformation based on the minimum DMR length which is being searched. The transformation level used in the results section has been the 5th level in the real dataset (and the 4th level in the case of the synthetic dataset) because we experimentally tried different levels for considered input dataset, and we found that this was the best level. Nevertheless, it must be noted that the same happens with the main parameters of the other considered tools, there is no a priori default value which yields the best results for all the input datasets. HPG-DHunter uses the csv files delivered by HPG.Mapper as input data. Thus, the sample size cannot affect the tool sensitivity, since the tool always builds a methylation signal for the whole genome. If the samples are greater, the methylation signal is built in a more robust manner (with more information about each DNA location). The sample size can only affect to the time required by aligners like Bismarck or HPG-Methyl.</p>
      <p>The tool interface allows, by clicking on any item of the list of DMRs found, to open the Ensemble web page (<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org">http://www.ensembl.org</ext-link>) in a navigator window and display the corresponding genes and other information in the reference genome for that location, in order to help biomedical researchers to identify the most significant DMRs for their study. Although the tool is configured for the human reference genome, it can be easily tailored to show the reference genome for other species.</p>
      <p>Once the DMRs have been identified in the selected samples, the results can be stored in a different CSV file for each chromosome. For each DMR found, this file shows two levels of details. The first one shows the initial and final position of the DMR, the most common names of the closest gene to that position, the distance between the DMR and this gene, and whether the methylation difference is in favor of the cases or the control samples (hyper/hypo). The second level of detail shows basic statistics for each of the analyzed samples. Each line starts with the name of the sample, the name of nucleotides affected in that DMR, the minimum, average and maximum coverage of reads, the number of reads detecting Cs, mC, hmC and other nucleotide different from C, as well as the minimum, average and maximum distance between locations with information. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows an example of an output csv file (also a.gif format file can be selected).
<fig id="Fig8"><label>Fig. 8</label><caption><p>Example csv output file</p></caption><graphic xlink:href="12859_2020_3634_Fig8_HTML" id="MO8"/></fig></p>
      <p>Therefore, the analysis procedure for detecting DMRs with HPG-DHunter is composed of the following steps:
<list list-type="order"><list-item><p>Selection of the samples (csv files) to be analyzed.</p></list-item><list-item><p>Selection of the minimum coverage threshold.</p></list-item><list-item><p>Selection of the transformation level. At this point, the tool can detect and display a list of DMRs.</p></list-item><list-item><p>Depending on the results, any of the previous parameters can be tuned, and the whole process could be repeated.</p></list-item></list></p>
    </sec>
    <sec id="Sec6">
      <title>DMR visualization</title>
      <p>After the DMR detection has been carried out, the results should be displayed in a comprehensive and clear way. HPG-DHunter allows the interactive visualization of methylation signals corresponding to any DNA segment at different levels of detail. In particular, those segments where DMRs have been previously detected by the tool. The visualization process uses the data generated by the DWT, and it is completely carried out in the GPU, as described in our previous work ([<xref ref-type="bibr" rid="CR18">18</xref>]).</p>
      <p>We have designed a graphical interface for HPG-DHunter which allows to carry out the whole process of DMR detection and visualization in an intuitive and friendly manner: it allows to select the sample files to be analyzed, the type of analysis to be performed (5mC or 5hmC), and the parameters of this analysis: the minimum coverage ratio the samples should have to be taken into account, the DWT level to be applied to the signals, and the DMR threshold. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows a snapshot of this graphical tool. The top part of the tool is devoted to graphically displaying one of the DMRs found, while the bottom part of the tool contains the controls to select the input files and analysis parameters, as well as a window for listing the DMRs found in text mode. On the bottom-left corner, it shows the buttons for selecting the type of analysis and the sample input files to be analyzed (each file path appears in a different color, the same one used in the top window for displaying its corresponding signal). Next to the input files box is the DMR results box, which lists the DMR(s) found and if the case group is hyper or hypo methylated. At the right of the results box there are the buttons for loading, analyzing (carrying out the DMR detection) and saving the DMR list found for a given analysis (it must be noted that different analysis with different DMR thresholds and DWT levels may be performed on the same sample files), as well as knobs and sliders for zoom-in and out, and interactively exploring the adjacent regions to the DMRs. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows an example of identification and visualization carried out by HPG-DHunter for a case of one control sample and one case sample, for a coverage threshold of 50 reads, a difference methylation threshold of 0.5, and a transformation level (DWT level selector) of 2. On top of the results window, we can see that with these parameters 8775 DMRs have been found.</p>
    </sec>
    <sec id="Sec7">
      <title>Batch DMR detection</title>
      <p>HPG-DHunter also allows the automatic DMR detection without user intervention, analyzing a selection of chromosomes (or all of them). That is, the tool can yield an output file like the one in Fig. <xref rid="Fig8" ref-type="fig">8</xref> for all the chromosomes for both a case and a control group, studying all the samples.</p>
      <p>Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the pipeline corresponding to the batch DMR detection procedure. Once the analysis parameters and input files are selected by the user, this procedure iterates over each one of the selected chromosomes. However, since the slowest task is the file read and the building of the methylation signal, the procedures creates as many threads as number of chromosomes (csv files) to be read. Then, the wavelet transform is computed (at the selected transform level) in the GPU. This process is carried out in a batch manner, processing file chunks which are adequate for the GPU memory size. As the GPU computing finishes, the resulting data of each iteration is stored in CPU memory, freeing GPU memory for a new batch file. The DMR detection takes place in the CPU as explained in the “<xref rid="Sec5" ref-type="sec">Interactive DMR detection</xref>” section. That is, grouping the samples in control and cases and filtering those differences between both groups which are greater than the selected threshold. The results are stored in output files and both GPU and CPU memory are freed up for processing the next chromosome.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Pipeline procedure for batch DMR detection</p></caption><graphic xlink:href="12859_2020_3634_Fig9_HTML" id="MO9"/></fig></p>
      <p>Thus, in the case of batch DMR detection the following procedure should be carried out:
<list list-type="order"><list-item><p>Selection of the samples (csv files) to be analyzed, grouped in <italic>case</italic> and <italic>control</italic>.</p></list-item><list-item><p>Selection of the type of methylation to be analyzed (mC or hmC).</p></list-item><list-item><p>Selection of the DNA thread to be used in the analysis (forward and/or reverse).</p></list-item><list-item><p>Selection of the minimum DMR threshold to be detected.</p></list-item><list-item><p>Selection of the transformation level on which DMRs will be detected.</p></list-item><list-item><p>Selection of the chromosomes to be analyzed. Analysis in batch mode.</p></list-item><list-item><p>Inspection of the DMRs found using the visualization interface.</p></list-item><list-item><p>Depending on the results, any of the previous parameters can be tuned, and the whole process could be repeated.</p></list-item></list></p>
      <p>In order to help the user in all these tasks, we have developed a visual interface with all these parameters implemented as knobs, sliders, buttons or selectors. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows a snapshot of this tool, at the exact moment when the DMR batch tool is processing 66% of the selected input files, for a dataset comprising six control input directories and six case input directories. In each directory there are as many files as the number of chromosomes considered for the study (a button allows to select to study all the chromosomes or only a subset (selecting each chromosome number)). The output path selects the output directory where the tool will store a file for each chromosome and study (5mC or 5hmC) containing the DMRs found (the same data which can be seen in the visualization tool and the associated output files, including the hyper/hypomethylation diagnosis and the closest gene).
<fig id="Fig10"><label>Fig. 10</label><caption><p>Example snapshot of the tool designed for batch DMR detection</p></caption><graphic xlink:href="12859_2020_3634_Fig10_HTML" id="MO10"/></fig></p>
      <p>However, the GPU memory size also restricts the number of output files to be displayed. Depending on the chromosome length, HPG-DHunter allows the displaying of a range from 2 to 10 (human) chromosomes. When used for DMR search in other species, the maximum number of chromosomes displayed may vary. Thus, a feasible way of studying DMRs is the previous batch analysis of the considered chromosomes and then the visualization of those areas of special interest from the output csv files. In this way, the tool can analyze the DMRs found in all the chromosomes, although it can simultaneously display the DMRs for only some of them.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="results">
    <title>Results</title>
    <sec id="Sec9">
      <title>Tool validation</title>
      <p>Some comparative studies [<xref ref-type="bibr" rid="CR17">17</xref>] show that the tools based on statistical techniques and validated with statistical significance studies like BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>] or DSS-Single [<xref ref-type="bibr" rid="CR14">14</xref>] show more accurate results when identifying simulated DM regions that are long and have small within-group variation, but they have low concordance, probably due to the different approaches they have used for DM identification. As a result, they provide very different results when used with real datasets, and usually there is no a clear set of “correct” DMRs in these datasets. Effectively, we first tested BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>], DSS-Single [<xref ref-type="bibr" rid="CR14">14</xref>], and methylKit [<xref ref-type="bibr" rid="CR19">19</xref>] with the same real datasets, but they yielded many different DMRs among them, without a clear set of DMRs to be detected in order to validate our tool.</p>
      <p>Thus, in order to validate the proposed tool, we have not performed a statistical significance study, as other tools like BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>] or DSS-Single [<xref ref-type="bibr" rid="CR14">14</xref>] do. Instead, we have used the NBCI’s Gene Expression Omnibus with reference GEO GSE 124610 dataset, coming from a study about the effects of ascorbic acid on the hydroxymethylation of carcinoma renal cells [<xref ref-type="bibr" rid="CR20">20</xref>]. The interest of this real dataset for our validation study is based on the known hydroxymethylation levels in the different samples, as well as the existence of some genes associated to suppressive effects of the cell tumoral action (that is, some specific DMRs should be detected in these genes). Thus, we can check if the detection and visualization of the hydroxymethylation levels at different scales correspond to the results shown in that work [<xref ref-type="bibr" rid="CR20">20</xref>]. We have focused on several genes in different chromosomes identified as very important by the referenced study [<xref ref-type="bibr" rid="CR20">20</xref>]. Also, we have tested the tools on a synthetic dataset.</p>
      <sec id="Sec10">
        <title>Selection of the wavelet transform</title>
        <p>For validation purposes, we have considered in our tool not only the Haar wavelet transform used in [<xref ref-type="bibr" rid="CR18">18</xref>], but other wavelet transforms: the Bi orthonormal 3.1, 3.3, and 3.5 transforms [<xref ref-type="bibr" rid="CR21">21</xref>], as well as the Spline wavelet transform [<xref ref-type="bibr" rid="CR22">22</xref>]. The idea is to test the tool with several different transforms, and select the one which detects all the known DMRs while detecting the less number of false positives.</p>
        <p>We have established fixed values for a set of parameters (regardless they are adequate or not from a biological point of view), and we have used them for all the considered wavelet transforms. The fixed values are: 6th level of wavelet transformation (windows containing 64 DNA positions), minimum coverage of 100 samples, DMR identification threshold of 0.25, and a ratio of 7% of positions with minimum coverage per window (4 positions with minimum coverage in each 64 position window).</p>
        <p>Table <xref rid="Tab1" ref-type="table">1</xref> shows if each of the considered transform has detected (x) or not (-) DMRs within the most important genes (NBPF1, AKT3, KMT2C, and DOCK8), where the reference study [<xref ref-type="bibr" rid="CR20">20</xref>] assumes that it should appear DMRs. Also, this table shows the total number of DMRs detected in chromosome 7. These results show that the Haar wavelet transform obtain the best results, since it detects the DMRs in the four genes. The Biorthogonal 3.1 and the Spline 2.2 transforms do not detect the DMRs in the AKT3 nor in the KMT2C genes. However, the Biorthogonal 3.1 detects almost double the number of DMRs detected by the Haar transform, suggesting that this wavelet transform detects a number of false positives. Thus, we have considered the Haar and the Spline 2.2 as the two best options.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>DMR detection in genes NBPF1, AKT3 (chrom. 1), KMT2C (chrom. 7), and DOCK8 (chrom. 9), as well as total number of DMRs detected</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">wavelet type</th><th align="left">NBPF1</th><th align="left">AKT3</th><th align="left">KMT2C</th><th align="left">DOCK8</th><th align="left">#DMRs</th></tr></thead><tbody><tr><td align="left">HAAR</td><td align="left">X</td><td align="left">X</td><td align="left">X</td><td align="left">X</td><td align="left">446</td></tr><tr><td align="left">BIOR 3.1</td><td align="left">X</td><td align="left">-</td><td align="left">-</td><td align="left">X</td><td align="left">805</td></tr><tr><td align="left">BIOR 3.3</td><td align="left">X</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">172</td></tr><tr><td align="left">BIOR 3.5</td><td align="left">X</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">291</td></tr><tr><td align="left">SPLINE 2.2</td><td align="left">X</td><td align="left">-</td><td align="left">-</td><td align="left">X</td><td align="left">107</td></tr></tbody></table></table-wrap></p>
        <p>Next, starting from the results shown in the first test we have setup a second detection test, using a wider set of genes described as important in the referenced study [<xref ref-type="bibr" rid="CR20">20</xref>] and testing exclusively the Haar and the Spline 2.2 wavelet transforms. This time we have decreased the DMR identification threshold to 0.1, in order to increase the number of DMRs detected. Table <xref rid="Tab2" ref-type="table">2</xref> shows the results for this test.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Second DMR identification test, using HAAR and SPLINE 2.2 wavelet transforms</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">chr</th><th align="left">gene</th><th align="left">haar</th><th align="left">spline</th><th align="left">#DMRs haar</th><th align="left">#DMRs spline</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">NBPF1</td><td align="left">X</td><td align="left">X</td><td align="left">2737</td><td align="left">617</td></tr><tr><td align="left">1</td><td align="left">AKT3</td><td align="left">X</td><td align="left">-</td><td align="left">2737</td><td align="left">617</td></tr><tr><td align="left">4</td><td align="left">CWH43</td><td align="left">X</td><td align="left">X</td><td align="left">2101</td><td align="left">956</td></tr><tr><td align="left">7</td><td align="left">KMT2C</td><td align="left">X</td><td align="left">-</td><td align="left">1695</td><td align="left">886</td></tr><tr><td align="left">8</td><td align="left">ZHX1</td><td align="left">-</td><td align="left">-</td><td align="left">1481</td><td align="left">732</td></tr><tr><td align="left">9</td><td align="left">DOCK8</td><td align="left">X</td><td align="left">X</td><td align="left">1028</td><td align="left">319</td></tr><tr><td align="left">10</td><td align="left">PRKG1</td><td align="left">X</td><td align="left">X</td><td align="left">1175</td><td align="left">561</td></tr><tr><td align="left">10</td><td align="left">MXI1</td><td align="left">-</td><td align="left">-</td><td align="left">1175</td><td align="left">561</td></tr><tr><td align="left">15</td><td align="left">SMAD6</td><td align="left">-</td><td align="left">X</td><td align="left">605</td><td align="left">308</td></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab2" ref-type="table">2</xref> shows that there are differences in the DMR detection for the tested genes, since the Haar transform detects DMRs in six of the nine genes, while the Spline 2.2 transform detects DMRs in five of the nine genes. Since we must select one wavelet transform to comparatively test our tool with other tools, we have selected the one which seems to provide the best results for these real data. Thus, we have used the Haar wavelet transform as the default wavelet used by HPG-DHunter for DMR detection.</p>
      </sec>
      <sec id="Sec11">
        <title>Comparison with other tools using a real dataset</title>
        <p>Next, we have performed a comparison study for detecting DMRs in the same real dataset [<xref ref-type="bibr" rid="CR20">20</xref>] using other three tools: BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>], DSS-Single [<xref ref-type="bibr" rid="CR14">14</xref>], and methylKit [<xref ref-type="bibr" rid="CR19">19</xref>]. Each of these tools include a number of parameters which can be tuned by the researcher, depending on the dataset to be used and the target of the research carried out. In order to make a fair comparison and an effective validation, we have followed two different approaches: first, we have tuned the main parameter for each tool (the one establishing the threshold difference between two samples to consider it as a DMR) until each tool has detected the DMRs in all the nine genes cited in the renal carcinoma study [<xref ref-type="bibr" rid="CR20">20</xref>]. Then, we have studied the DMRs found by each tool. Previously, the dataset was filtered to obtain a minimum coverage of 50 reads for all the samples. For the second comparative approach, we have tuned the main parameter value for each tool until it has led to the detection of a similar number of genes with detected DMRs in all the tools (hundreds).</p>
        <p>Concretely, for the first approach the BSmooth parameter <italic>Cutoff</italic> had to be varied from 4 to 0.005. For DSS-Single, the <italic>Threshold</italic> parameter had to be varied from 3 to 0.01. For methylKit, the <italic>Diff</italic> parameter ranged from 25 to 0.5, and the <italic>qvalue</italic> ranged from 0.5 to 0.01. Finally, the HPG-DHunter <italic>Threshold</italic> parameter ranged from 0.4 to 0.01, and the DWT levels used for this study were 6 and 5 (although the results shown here were the ones with the 6th. transformation level because they were better than the ones with the 5th transformation level). Table <xref rid="Tab3" ref-type="table">3</xref> shows the values for these parameters that had to be set in order for each tool to detect the known DMRs in each chromosome. The methylKit column shows both the Diff / qvalue pair of values set in each case. In order to show how far from its default values each tool has been tuned, the last three rows show the average value computed from the previous seven values, their standard deviation, and the default value used by the tool.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Parameter values set for finding the known DMRs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chrom.</th><th align="left">BSmooth</th><th align="left">DSS-Single</th><th align="left">methylKit</th><th align="left">HPG-DHunter</th></tr></thead><tbody><tr><td align="left">chr1</td><td align="left">1</td><td align="left">0,5</td><td align="left">25 / 0.01</td><td align="left">0.40</td></tr><tr><td align="left">chr4</td><td align="left">0,75</td><td align="left">1</td><td align="left">5 / 0.5</td><td align="left">0.25</td></tr><tr><td align="left">chr7</td><td align="left">4</td><td align="left">0,5</td><td align="left">15 / 0.01</td><td align="left">0.35</td></tr><tr><td align="left">chr8</td><td align="left">0,1</td><td align="left">0,5</td><td align="left">5 / 0.5</td><td align="left">0.07</td></tr><tr><td align="left">chr9</td><td align="left">1</td><td align="left">0,5</td><td align="left">15 / 0.01</td><td align="left">0.40</td></tr><tr><td align="left">chr10</td><td align="left">0.5</td><td align="left">1</td><td align="left">17 / 0.01</td><td align="left">0.40</td></tr><tr><td align="left">chr15</td><td align="left">0.1</td><td align="left">1</td><td align="left">3 / 0.4</td><td align="left">0.06</td></tr><tr><td align="left">Avg.</td><td align="left">1.06</td><td align="left">0.71</td><td align="left">12.14% / 0.24</td><td align="left">0.255</td></tr><tr><td align="left">Std. Dev</td><td align="left">1.35</td><td align="left">0.27</td><td align="left">8.07% / 0.25</td><td align="left">0.16</td></tr><tr><td align="left">Default</td><td align="left">2</td><td align="left">1.00E-05</td><td align="left">25% / 0.01</td><td align="left">0.25</td></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab3" ref-type="table">3</xref> show that the DMRs in chromosomes 8 and 15 are the most difficult ones to be detected, since all the tools require for these chromosomes the most extreme changes from the default values in order to detect them. Also, the last three rows show that HPG-DHunter and BSmooth have default values which fall within the interval [<italic>a</italic><italic>v</italic><italic>g</italic>±<italic>s</italic><italic>t</italic><italic>d</italic>.<italic>d</italic><italic>e</italic><italic>v</italic>], indicating that it has not been necessary to significantly change the default values in these tools to make them detect the known DMRs. However, both methylkit and DSS-Single have some parameters whose default value is far from the required value to make these tools detect the known DMRs. This issue makes more difficult for the user to properly tune these tools for detecting DMRs which are difficult to detect.</p>
        <p>Table <xref rid="Tab4" ref-type="table">4</xref> shows the results yielded by each of the considered tools in raw numbers, as well as some indicative percentages. The first row shows the total number of DMRs detected by each tool, denoted as A. The second row, denoted as B, shows the number of these DMRs which have been detected within the limits of a gene. The third row, denoted as C, shows the number of genes in which a DMR has been detected by each tool. The rest of the rows show, in terms of percentage, the ratios B/A and C/A, in order to measure the behavior of the tools.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Number of DMRs and different percentages of genes when the tools are tuned to detect DMRs in the known genes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">BSmooth</th><th align="left">DSS-Single</th><th align="left">methylKit</th><th align="left">HPG-DHunter</th></tr></thead><tbody><tr><td align="left">A-Total DMRs</td><td align="left">10717</td><td align="left">9022</td><td align="left">51074</td><td align="left">8595</td></tr><tr><td align="left">B-DMRs in genes</td><td align="left">5515</td><td align="left">4576</td><td align="left">18177</td><td align="left">3863</td></tr><tr><td align="left">C-genes with DMRs</td><td align="left">1594</td><td align="left">2245</td><td align="left">2422</td><td align="left">1886</td></tr><tr><td align="left">%DMRs in Genes(B/A)</td><td align="left">51.46</td><td align="left">50.72</td><td align="left">35.59</td><td align="left">44.94</td></tr><tr><td align="left">%Genes in DMRs tota(C/A)</td><td align="left">14.87</td><td align="left">24.88</td><td align="left">4.74</td><td align="left">21.94</td></tr><tr><td align="left">%Genes in (DMRs in gen)(C/B)</td><td align="left">28.90</td><td align="left">49.06</td><td align="left">13.32</td><td align="left">48.82</td></tr></tbody></table></table-wrap></p>
        <p>The first row of Table <xref rid="Tab4" ref-type="table">4</xref> shows that HPG-DHunter detects the lowest number of DMRs, but the numbers in the third row show that the number of genes in which DMRs have been found is not very different among the considered tools, suggesting that those DMRs found in other places can be false positives. It is worth mention that the number of genes in which HPG-DHunter has found DMRs is within the range of the other three tools. The percentages shown in the last rows show that again the percentages yielded by the proposed tool are also within the range yielded by the other tools. Finally, it should be highlighted that HPG-DHunter and DSS-Single obtain the best percentages (last two rows), with the important difference that, as shown in Table <xref rid="Tab3" ref-type="table">3</xref>, it is much more difficult to tune DSS-Single than HPG-DHunter to obtain these results.</p>
        <p>Next, we have studied the concordance of the considered tools. Table <xref rid="Tab5" ref-type="table">5</xref> shows the amount of identical genes where DMRs have been detected by some subsets of the considered tools, in order to measure if these tools detected the same DMRS or not. We have denoted each tool by the first letter of his name. Thus, <italic>B</italic> correspond to BSmooth, <italic>D</italic> denotes DSS-Single, <italic>M</italic> stands for methylKit, and <italic>H</italic> denotes HPG-DHunter. When any of these letter shows an overline, it means the complementary set. That is, the column labeled as B-D-M-<inline-formula id="IEq2"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {H}$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq2.gif"/></alternatives></inline-formula> shows the number of DMRs which have been detected by BSmooth, DSS-Single and methylKit and have not been detected by HPG-DHunter.
<table-wrap id="Tab5"><label>Table 5</label><caption><p>Number of matching genes with DMRs for different subsets of tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chrom.</th><th align="left">B-D-M-H</th><th align="left">B-D-M-<inline-formula id="IEq3"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {H}$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq3.gif"/></alternatives></inline-formula></th><th align="left">B-D-<inline-formula id="IEq4"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {M}$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="false"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq4.gif"/></alternatives></inline-formula>-H</th><th align="left">B-<inline-formula id="IEq5"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {D}$\end{document}</tex-math><mml:math id="M24"><mml:mover accent="false"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq5.gif"/></alternatives></inline-formula>-M-H</th><th align="left"><inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {B}$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="false"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq6.gif"/></alternatives></inline-formula>-D-M-H</th></tr></thead><tbody><tr><td align="left">chr1</td><td align="left">133</td><td align="left">42</td><td align="left">15</td><td align="left">21</td><td align="left">54</td></tr><tr><td align="left">chr4</td><td align="left">157</td><td align="left">38</td><td align="left">1</td><td align="left">1</td><td align="left">125</td></tr><tr><td align="left">chr7</td><td align="left">23</td><td align="left">10</td><td align="left">0</td><td align="left">5</td><td align="left">100</td></tr><tr><td align="left">chr8</td><td align="left">137</td><td align="left">5</td><td align="left">1</td><td align="left">137</td><td align="left">4</td></tr><tr><td align="left">chr9</td><td align="left">51</td><td align="left">27</td><td align="left">0</td><td align="left">14</td><td align="left">39</td></tr><tr><td align="left">chr10</td><td align="left">89</td><td align="left">69</td><td align="left">7</td><td align="left">2</td><td align="left">31</td></tr><tr><td align="left">chr15</td><td align="left">265</td><td align="left">19</td><td align="left">5</td><td align="left">9</td><td align="left">30</td></tr><tr><td align="left">TOTAL</td><td align="left">855</td><td align="left">210</td><td align="left">29</td><td align="left">189</td><td align="left">383</td></tr></tbody></table></table-wrap></p>
        <p>The mostleft column in Table <xref rid="Tab5" ref-type="table">5</xref> shows that all the four considered tools have identified 855 matching genes with DMRs. Comparing these numbers with the ones in the third row of Table <xref rid="Tab4" ref-type="table">4</xref>, it can be seen that the number of matching genes with DMRs found by all the tools is around 50% of the DMRs found by BSmooth (the one with the lowest number of genes with DMRs). That is, there is a very low concordance among the DMRs found by the different tools, as predicted in other studies [<xref ref-type="bibr" rid="CR17">17</xref>]. Also, assuming that the 855 matching genes in which all the four tools have detected DMRs are likely to be the correct DMRs, then the numbers in the third row of Table <xref rid="Tab4" ref-type="table">4</xref> indicate the number genes in which wrong DMRs or false positives have been detected (the higher number of genes with DMRs, the more false positives detected by each tool, since all of them exceed 855). In that row, the proposed tool detects the second lowest number of genes, validating the tool as a more accurate tool than methylKit or DSS-Single.</p>
        <p>The rest of the columns in Table <xref rid="Tab5" ref-type="table">5</xref> show the number of genes in which each tool has not detected DMRs and the other three tools have done it. When comparing these columns with the third row of Table <xref rid="Tab4" ref-type="table">4</xref> we can see that, although BSmooth detects 1594 genes with DMRs and HPG-Hunter detects 1886 genes, HPG-Hunter fails to detect only 210 “correct” genes, while BSmooth fails to detect 383 “correct” genes. That is, the proposed tool detects more false positives but misses less “correct” DMRs. It is worth mention that the column corresponding to methylKit shows the lowest number of genes, and the reason for this behavior can be the remarkable number of DMRs found by this tool, as shown in the first row of Table <xref rid="Tab4" ref-type="table">4</xref>. Since this tool detects five times more DMRs than the second one (detecting much more false positives), it detects DMRs in all the genes where the rest of tools also detects DMRs.</p>
        <p>The average length of the DMRs identified in each chromosome by all the methods in the paper, as well as the absolute methylation difference between the two groups samples, are shown in Table <xref rid="Tab6" ref-type="table">6</xref>. For each considered method, the column labeled as “Length” shows the average DMR length found in each chromosome, while the column labeled as “Diff.” shows the absolute methylation difference between the two groups of samples. The negative or positive numbers depend on which group shows the highest methylation. The DMR length distribution shows a very high variability not only among the considered chromosomes for a given tool, but also among the tools. For example, the average length of the DMRs found by DSS-Single in chromosome 8 is 361 nucleotides and 1222 nucleotides in chromosome 4. The average length of the DMRs found by BSmooth in these chromosome are 122 and 185 nucleotides, respectively, and the ones found by HPG-DHunter are 79 and 75, respectively. In this sense, HPG-DHunter shows the lowest variability among chromosomes. A case apart is Methylkit which, since it considers each nucleotide as a posible DMR and therefore all their DMRs have a length of 1 nucleotide (instead of a single DMR of three adjacent nucleotides, this tool yields 3 DMRs of length 1).
<table-wrap id="Tab6"><label>Table 6</label><caption><p>Average DMR lengths and absolute methylation differences between the group samples</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">BSmooth</th><th align="left" colspan="2">DSS-Single</th><th align="left" colspan="2">methylKit</th><th align="left" colspan="2">HPG-DHunter</th></tr><tr><th align="left">Chrom.</th><th align="left">Length</th><th align="left">Diff.</th><th align="left">Length</th><th align="left">Diff.</th><th align="left">Length</th><th align="left">Diff.</th><th align="left">Length</th><th align="left">Diff.</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">136</td><td align="left">12.90</td><td align="left">392</td><td align="left">-18.70</td><td align="left">1</td><td align="left">18387.35</td><td align="left">73</td><td align="left">-555.83</td></tr><tr><td align="left">4</td><td align="left">185</td><td align="left">1.02</td><td align="left">1222</td><td align="left">-8.02</td><td align="left">1</td><td align="left">35655.10</td><td align="left">75</td><td align="left">-437.74</td></tr><tr><td align="left">7</td><td align="left">79</td><td align="left">-2.79</td><td align="left">373</td><td align="left">-10.51</td><td align="left">1</td><td align="left">19936.31</td><td align="left">73</td><td align="left">-314.50</td></tr><tr><td align="left">8</td><td align="left">122</td><td align="left">12.47</td><td align="left">361</td><td align="left">-6.15</td><td align="left">1</td><td align="left">-2379.04</td><td align="left">79</td><td align="left">-355.87</td></tr><tr><td align="left">9</td><td align="left">78</td><td align="left">4.14</td><td align="left">368</td><td align="left">-5.69</td><td align="left">1</td><td align="left">27117.98</td><td align="left">75</td><td align="left">-242.54</td></tr><tr><td align="left">10</td><td align="left">111</td><td align="left">-0.08</td><td align="left">1064</td><td align="left">-6.60</td><td align="left">1</td><td align="left">21333.46</td><td align="left">72</td><td align="left">-265.63</td></tr><tr><td align="left">15</td><td align="left">72</td><td align="left">12.55</td><td align="left">820</td><td align="left">-7.26</td><td align="left">1</td><td align="left">25010.34</td><td align="left">81</td><td align="left">-285.62</td></tr></tbody></table></table-wrap></p>
        <p>For the second comparative approach (tuning the main parameter value for each tool until it has led to the detection of a similar number of genes with detected DMRs in all the tools), we finally used a value of 1.0 for the BSmooth <italic>Cutoff</italic> parameter. For DSS-Single, the <italic>Threshold</italic> parameter was 0.5. For methylKit, we used a <italic>Diff</italic> parameter of 25%, and a <italic>qvalue</italic> of 0.5. Finally, the HPG-DHunter <italic>Threshold</italic> parameter was 0.35. Table <xref rid="Tab7" ref-type="table">7</xref> shows the results yielded by each tool for this approach.
<table-wrap id="Tab7"><label>Table 7</label><caption><p>Number of DMRs and gene percentages found when all the tools yield similar number of genes with DMRs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">BSmooth</th><th align="left">DSS-Single</th><th align="left">methylKit</th><th align="left">HPG-DHunter</th></tr></thead><tbody><tr><td align="left">A-Total DMRs</td><td align="left">7006</td><td align="left">4552</td><td align="left">13181</td><td align="left">5374</td></tr><tr><td align="left">B-DMRs in genes</td><td align="left">3674</td><td align="left">2368</td><td align="left">6519</td><td align="left">2493</td></tr><tr><td align="left">C-genes with DMRs</td><td align="left">1229</td><td align="left">1536</td><td align="left">1539</td><td align="left">1605</td></tr><tr><td align="left">%DMRs in Genes(B/A)</td><td align="left">52.44</td><td align="left">52.02</td><td align="left">49.46</td><td align="left">46.39</td></tr><tr><td align="left">%Genes in DMRs total(C/A)</td><td align="left">17.54</td><td align="left">33.74</td><td align="left">11.68</td><td align="left">29.87</td></tr><tr><td align="left">%Genes in (DMRs in gen)(C/B)</td><td align="left">33.45</td><td align="left">64.86</td><td align="left">23.61</td><td align="left">64.38</td></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab7" ref-type="table">7</xref> shows that the tuning of each tool has achieved that the number of genes with DMRs are similar, ranging (in that order) from 1229 to 1605. For these numbers of genes with DMRs, HPG-DHunter detects the second lowest number of DMRs (first row), which indicates that this tool is as effective as the other ones (it detects a number of DMRs which is in the range of the rest of the tools).</p>
        <p>Next, Table <xref rid="Tab8" ref-type="table">8</xref> shows the number of genes in the considered chromosomes where different subsets of tools detected DMRs, similarly to Table <xref rid="Tab5" ref-type="table">5</xref>. The first row in Table <xref rid="Tab8" ref-type="table">8</xref> shows that the number of DMRs that are detected by all the tools is very low, compared to the number of DMRs detected separately (first row of Table <xref rid="Tab7" ref-type="table">7</xref>). Also, this table shows that the number of genes with DMRs “missed” by HPG-DHunter is within the range of the values yielded by the other tools.
<table-wrap id="Tab8"><label>Table 8</label><caption><p>Number of matching genes with DMRs for different subsets of tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tools</th><th align="left">chr1</th><th align="left">chr4</th><th align="left">chr7</th><th align="left">chr8</th><th align="left">chr9</th><th align="left">chr10</th><th align="left">chr15</th><th align="left">Total</th></tr></thead><tbody><tr><td align="left">B-D-M-H</td><td align="left">140</td><td align="left">68</td><td align="left">78</td><td align="left">50</td><td align="left">47</td><td align="left">51</td><td align="left">41</td><td align="left">475</td></tr><tr><td align="left">B-D-M-<inline-formula id="IEq7"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {H}$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq7.gif"/></alternatives></inline-formula></td><td align="left">35</td><td align="left">11</td><td align="left">21</td><td align="left">20</td><td align="left">16</td><td align="left">10</td><td align="left">16</td><td align="left">129</td></tr><tr><td align="left">B-D-<inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {M}$\end{document}</tex-math><mml:math id="M30"><mml:mover accent="false"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq8.gif"/></alternatives></inline-formula>-H</td><td align="left">19</td><td align="left">16</td><td align="left">17</td><td align="left">10</td><td align="left">11</td><td align="left">6</td><td align="left">10</td><td align="left">89</td></tr><tr><td align="left">B-<inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {D}$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="false"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq9.gif"/></alternatives></inline-formula>-M-H</td><td align="left">25</td><td align="left">17</td><td align="left">20</td><td align="left">14</td><td align="left">15</td><td align="left">20</td><td align="left">10</td><td align="left">121</td></tr><tr><td align="left"><inline-formula id="IEq10"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {B}$\end{document}</tex-math><mml:math id="M34"><mml:mover accent="false"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3634_Article_IEq10.gif"/></alternatives></inline-formula>-D-M-H</td><td align="left">67</td><td align="left">33</td><td align="left">32</td><td align="left">27</td><td align="left">29</td><td align="left">22</td><td align="left">35</td><td align="left">245</td></tr></tbody></table></table-wrap></p>
        <p>Finally, Table <xref rid="Tab9" ref-type="table">9</xref> shows the number of DMRs found in the genes which are know to have DMRs [<xref ref-type="bibr" rid="CR20">20</xref>]. The last row shows the number of these genes in which each tool has found DMRs (the number of non-zero values in that column).
<table-wrap id="Tab9"><label>Table 9</label><caption><p>Number of DMRs found in the genes which are known to have DMRs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">gene</th><th align="left">BSmooth</th><th align="left">DSS-Single</th><th align="left">methylKit</th><th align="left">HPG-DHunter</th></tr></thead><tbody><tr><td align="left">NBPF1</td><td align="left">4</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">AKT3</td><td align="left">1</td><td align="left">2</td><td align="left">4</td><td align="left">2</td></tr><tr><td align="left">CWH43</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">KMT2C</td><td align="left">3</td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left">ZHX1</td><td align="left">0</td><td align="left">1</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">DOCK8</td><td align="left">1</td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left">MXI1</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">3</td></tr><tr><td align="left">PRKG1</td><td align="left">0</td><td align="left">0</td><td align="left">5</td><td align="left">2</td></tr><tr><td align="left">SMAD6</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left"># of matches</td><td align="left">4</td><td align="left">5</td><td align="left">3</td><td align="left">6</td></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab9" ref-type="table">9</xref> indicates how effective is each tool for finding the known DMRs when they detect a similar number of DMRs, and it shows that the proposed tool is capable of detecting DMRs in the highest number of known genes. These results prove HPG-DHunter as a tool as valid and effective as the other three ones for DMR detection on real datasets.</p>
      </sec>
      <sec id="Sec12">
        <title>Comparison with other tools using a synthetic dataset</title>
        <p>Next, we have performed a comparison study for detecting DMRs in a synthetic dataset using the same tools. In order to generate the synthetic dataset, we have used WGBSSuite [<xref ref-type="bibr" rid="CR23">23</xref>], an stochastic generator developed to test and compare statistical methods, as the reference tools used in this evaluation, to generate differentially methylated base pairs. The first step for building a synthetic dataset is to analyze a real dataset to extract statistical information to parameterize WGBSSuite. We have generated a dataset with two groups and two samples each one, coming from chromosome 1 of the renal carcinoma study [<xref ref-type="bibr" rid="CR20">20</xref>]. Using these samples, WGBSSuite yielded the main statistical values shown in Table <xref rid="Tab10" ref-type="table">10</xref>. Using these data for configuring the generation of the synthetic dataset, WGBSSuite generated a new dataset containing two groups (samples) of one sample (replicate) each. We introduced as input data a differential methylation threshold value of 0.3 and ten thousand methylated locations, and for these input values the WGBSSuite analysis determined a DNA segment of around 18,300,000 base pairs with 4,394 differentially methylated locations.
<table-wrap id="Tab10"><label>Table 10</label><caption><p>Parameterization values yielded by WGBSSuite</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">Avg. diff. in methylation proportion</td><td align="left">0.3823</td></tr><tr><td align="left">Std. dev. in diff. in methylation proportion</td><td align="left">0.1242</td></tr><tr><td align="left">Max. diff. in methylation proportion</td><td align="left">0.8092</td></tr><tr><td align="left">Prob. of success in a methylated region</td><td align="left">0.917</td></tr><tr><td align="left">Prob. of success in a unmethylated region</td><td align="left">0.095</td></tr><tr><td align="left">Avg. coverage in a methylated region</td><td align="left">53</td></tr><tr><td align="left">Avg. coverage in an unmethylated region</td><td align="left">63</td></tr><tr><td align="left">Phase diff (difference between groups to validate DMR)</td><td align="left">0.3</td></tr></tbody></table></table-wrap></p>
        <p>In order to make a fair comparison in this case, we have tuned the main parameter for each tool (the one establishing the threshold difference between two samples to consider it as a DMR) using the similar values shown in Table <xref rid="Tab3" ref-type="table">3</xref>, the ones for which the reference tools obtained the best results for the real dataset.. In the case of HPG-DHunter, since the length of the DMRs this synthetic dataset can be of any length (including a single base pair), we tuned the tool for the DWT levels 2, 3, and 4, and finally was the 3rd transformation level the one which provided the best results for this tool. Also, the value of the threshold has been shifted to the range of 0.04-0.2. Changing the range of the values for the main parameter in the reference tools yielded, in general, worse results for these tools.</p>
        <p>Table <xref rid="Tab11" ref-type="table">11</xref> shows the number of true positive DMRs found by the considered tools when each of the main parameter values is used (we consider that a true positive DMR found by a tool is a DMR covering one or more of the positions marked as a differentially methylated base pair by WGBSSuite). For each tool, Table <xref rid="Tab11" ref-type="table">11</xref> shows two columns for each considered tool. The left one shows the main parameter value used in that tool, and the right column shows the number of positive DMRs for that parameter value.
<table-wrap id="Tab11"><label>Table 11</label><caption><p>True positives yielded by each tool for different parameter values and the synthetic dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">BSmooth</th><th align="left" colspan="2">DSSSingle</th><th align="left" colspan="2">methylKit</th><th align="left" colspan="2">HPG-DHunter</th></tr><tr><th align="left">Cutoff</th><th align="left">DMRs</th><th align="left">Thres</th><th align="left">DMRs</th><th align="left">Diff</th><th align="left">DMRs</th><th align="left">Thres</th><th align="left">DMRs</th></tr></thead><tbody><tr><td align="left">4</td><td align="left">0</td><td align="left">1e-5</td><td align="left">4</td><td align="left">25</td><td align="left">3212</td><td align="left">0..2</td><td align="left">146</td></tr><tr><td align="left">3</td><td align="left">0</td><td align="left">0.01</td><td align="left">564</td><td align="left">20</td><td align="left">3608</td><td align="left">0.15</td><td align="left">427</td></tr><tr><td align="left">2</td><td align="left">0</td><td align="left">0.05</td><td align="left">1544</td><td align="left">15</td><td align="left">3620</td><td align="left">0.1</td><td align="left">2369</td></tr><tr><td align="left">1</td><td align="left">61</td><td align="left">0.1</td><td align="left">1950</td><td align="left">10</td><td align="left">3620</td><td align="left">0.06</td><td align="left">3681</td></tr><tr><td align="left">0.75</td><td align="left">1465</td><td align="left">0.5</td><td align="left">3212</td><td align="left">5</td><td align="left">3620</td><td align="left">0.05</td><td align="left">3794</td></tr><tr><td align="left">0.5</td><td align="left">3396</td><td align="left">0.75</td><td align="left">3651</td><td align="left">3</td><td align="left">3620</td><td align="left">0.04</td><td align="left">3856</td></tr><tr><td align="left">0.25</td><td align="left">4128</td><td align="left">1</td><td align="left">4098</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">0.1</td><td align="left">4383</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab11" ref-type="table">11</xref> shows for all the tools a similar behavior to the one observed for a real dataset. All the tools except Methylkit need a significant variation of the main parameter from their default value in order to detect the greatest amount of true DMRs. One reason for this behavior can be the fact that WGBSSuite generates a single-base pattern and Methylkit is the only tool which internally works on a single-base basis.</p>
        <p>Nevertheless, in order to make a fair comparison we also need to know the ratio of true and false positives found by each tool to yield the results in Table <xref rid="Tab11" ref-type="table">11</xref>, as well as the ratio of the total differentially methylated base pairs in the synthetic dataset found by each tool. Table <xref rid="Tab12" ref-type="table">12</xref> shows these values for the considered tools for each number of true DMRs found by each tool (each value appearing in Table <xref rid="Tab11" ref-type="table">11</xref>). The hit rate is shown in the columns labeled as “Hit”, and the percentage of differentially methylated base pairs in the synthetic dataset found by each tool is shown in the columns labeled as “%”. We have computed the hit ratio as the ratio of the number of true DMRs found by each tool divided by the number of total DMRs found by that tool. Thus, the ratio of false positives would be one minus the hit rate.
<table-wrap id="Tab12"><label>Table 12</label><caption><p>Hit rate and percentage of DMRs in the synthetic dataset found by each tool for different parameter values</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="3">BSmooth</th><th align="left" colspan="3">DSSSingle</th><th align="left" colspan="3">methylKit</th><th align="left" colspan="3">HPG-DHunter</th></tr><tr><th align="left">DMRs</th><th align="left">Hit</th><th align="left">%</th><th align="left">DMRs</th><th align="left">Hit</th><th align="left">%</th><th align="left">DMRs</th><th align="left">Hit</th><th align="left">%</th><th align="left">DMRs</th><th align="left">Hit</th><th align="left">%</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">4</td><td align="left">1.0</td><td align="left">0.1</td><td align="left">3212</td><td align="left">1.000</td><td align="left">73.1</td><td align="left">146</td><td align="left">0.942</td><td align="left">3.3</td></tr><tr><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">564</td><td align="left">0.815</td><td align="left">12.8</td><td align="left">3608</td><td align="left">0.999</td><td align="left">82.1</td><td align="left">427</td><td align="left">0.936</td><td align="left">9.7</td></tr><tr><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">1544</td><td align="left">0.753</td><td align="left">35.1</td><td align="left">3620</td><td align="left">0.996</td><td align="left">82.4</td><td align="left">2369</td><td align="left">0.945</td><td align="left">53.9</td></tr><tr><td align="left">61</td><td align="left">0.61</td><td align="left">1.4</td><td align="left">1950</td><td align="left">0.728</td><td align="left">44.4</td><td align="left">3620</td><td align="left">0.996</td><td align="left">82.4</td><td align="left">3681</td><td align="left">0.934</td><td align="left">83.8</td></tr><tr><td align="left">1465</td><td align="left">0.552</td><td align="left">33.3</td><td align="left">3212</td><td align="left">0.599</td><td align="left">73.1</td><td align="left">3620</td><td align="left">0.996</td><td align="left">82.4</td><td align="left">3794</td><td align="left">0.924</td><td align="left">86.3</td></tr><tr><td align="left">3396</td><td align="left">0.501</td><td align="left">77.3</td><td align="left">3651</td><td align="left">0.523</td><td align="left">83.1</td><td align="left">3620</td><td align="left">0.996</td><td align="left">82.4</td><td align="left">3856</td><td align="left">0.885</td><td align="left">87.8</td></tr><tr><td align="left">4128</td><td align="left">0.478</td><td align="left">93.9</td><td align="left">4098</td><td align="left">0.441</td><td align="left">93.3</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">4383</td><td align="left">0.448</td><td align="left">99.7</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table></table-wrap></p>
        <p>Table <xref rid="Tab12" ref-type="table">12</xref> shows that BSmooth manages to detect almost all the differentially methylated base pairs in the synthetic dataset (99.7%) at the cost of detecting more the double of true DMRs (the 4383 true DMRs found are only 44.8% of the total DMRs found by the tool). Similar figures are yielded by DSS-Single, which manages to detect 4098 true DMRs (93.3% of the existing ones), but this number is only 44.1% of the total number of DMRs detected by this tool. That is, it detects more false than true positives. Methylkit shows a very different behavior. It shows a very high hit ratio for all the values of the Diff parameter, detecting a very low ratio of false positives. It also detect a high proportion of the existing DMRs in the dataset (82.4%). Finally, HPG-DHunter shows a high hit ratio for all the threshold values considered, although the percentage of DMRs in the dataset detected is low for high threshold values. Nevertheless, for low threshold values HPG-DHunter manages to find more true DMRs than Methylkit, with a slightly lower hit ratio. These results validate HPG-DHunter as a tool for DMR detection which has similar concordance with other well-known and extended tools when used with real and synthetic data.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Performance evaluation</title>
      <p>This section presents the performance evaluation (in terms of execution time) of the proposed tool when processing a real dataset consisting of samples coming from human patients. The data were provided by the INCLIVA Instituto Investigación Sanitaria del Hospital Clínico de Valencia (<ext-link ext-link-type="uri" xlink:href="https://www.incliva.es/">https://www.incliva.es/</ext-link>), for carrying out a medical study about the effects of DNA methylation in patients with Diabetes Mellitus2 (DM2). The DNA samples were extracted from four different patient groups, denoted as A, B, C and D. Group A denotes those patients who do not suffer from DM2 (control patients) and do not show resistance to insulin treatment. Group C denotes control patients (not suffering from DM2) who are resistant to insulin. Group B denotes those patients suffering from DM2 (case patients) who do not show resistance to insulin. Finally, group D denotes those patients suffering from DM2 and showing resistance to insulin. The purpose of the study is to find the DMRs among each possible pair of these groups. The dataset is composed of 96 fastq files, corresponding to six samples (six different individuals) per group. The data for each individual are stored in two fastq files (forward and reverse) for a (paired-end) methylation dataset. The aggregated size of all the fastq files coming from all the patients was 1 Terabyte.</p>
      <p>The hardware platform used in the performance evaluation consists of a computer based on the Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.20GHz processor, with 12 cores and 2 threads per core, and a 64 Gb RAM memory, as well as a GeForce GTX 1080 graphic card, with 2560 cores and 8 Gb GDDR5X RAM memory. The procedure steps implemented in the GPU have been carried out using the CUDA 10.1.105 library.</p>
      <p>The first pre-processing task consists of the alignment and methylation analysis of the fastq files, and it has been carried out using the HPG-Methyl tool ([<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]), producing as many.bam files as fastq files are in the dataset. The second pre-processing task has consisted of the building of a methylation map using HPG-HMapper ([<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]), yielding 48.csv files, two for each chromosome (since the samples were paired-end, we have one file for the forward and other one for the reverse strand) for each sample (patient). The first step for processing the samples has been the building of the methylation signal for each sample, as described in the Implementation Section. Following the instructions of the INCLIVA medical staff, we have computed the average signal of each group as the average value of the six signals in each group, in order to take into account the variability existing among patients and/or tissues. At this point, we have used the batch DMR detection tool for computing the DWT of the signals and finding DMRs between each two average signals coming from different groups.</p>
      <p>Table <xref rid="Tab13" ref-type="table">13</xref> shows the execution time required for computing the DWT of the signals (including the average signal) and the batch DMR detection between each possible pair of groups for each of the chromosomes shown in the mostleft column. The selection of these chromosomes was indicated by the INCLIVA staff as the most likely chromosomes to show DMRs. The total aggregated size of the csv files corresponding to these 12 chromosomes was 108.414 Mbytes, that is, around 108 Gigabytes of data. The last row shows the aggregated time (measured in minutes) required to find the DMRs in all these chromosomes. In this case, the input parameters were a DMR threshold of 0.35 and a DWT level of 6. Table <xref rid="Tab13" ref-type="table">13</xref> shows that, as it could be expected, no significant differences arise when we compare the different columns of the table, but there are some differences among the rows (chromosomes), due to their length. That is, the execution time is proportional to the chromosome length, but it is not affected by the shape and/or differences between the methylation signals. Also, this table shows that the total execution time required for computing the DWT and finding DMRs is around thirty five minutes for each pair of groups, for a total aggregated time of around three and a half hours for processing the 108 Gigabytes dataset.
<table-wrap id="Tab13"><label>Table 13</label><caption><p>Execution times (ms.) required for batch DMR detection among all the groups</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chrom.</th><th align="left">A-D</th><th align="left">A-B</th><th align="left">A-C</th><th align="left">B-C</th><th align="left">B-D</th><th align="left">C-D</th></tr></thead><tbody><tr><td align="left">22</td><td align="left">94399</td><td align="left">103456</td><td align="left">96638</td><td align="left">112233</td><td align="left">107983</td><td align="left">104961</td></tr><tr><td align="left">20</td><td align="left">103958</td><td align="left">111796</td><td align="left">104936</td><td align="left">120412</td><td align="left">115308</td><td align="left">115132</td></tr><tr><td align="left">17</td><td align="left">190331</td><td align="left">206827</td><td align="left">192663</td><td align="left">221405</td><td align="left">210298</td><td align="left">205949</td></tr><tr><td align="left">13</td><td align="left">74378</td><td align="left">78857</td><td align="left">75617</td><td align="left">79799</td><td align="left">80081</td><td align="left">77474</td></tr><tr><td align="left">12</td><td align="left">180999</td><td align="left">196676</td><td align="left">183465</td><td align="left">203209</td><td align="left">196508</td><td align="left">191967</td></tr><tr><td align="left">11</td><td align="left">214391</td><td align="left">231394</td><td align="left">215500</td><td align="left">245430</td><td align="left">236118</td><td align="left">231187</td></tr><tr><td align="left">9</td><td align="left">172293</td><td align="left">185016</td><td align="left">173362</td><td align="left">194221</td><td align="left">190247</td><td align="left">184382</td></tr><tr><td align="left">8</td><td align="left">148693</td><td align="left">157845</td><td align="left">151269</td><td align="left">162844</td><td align="left">159958</td><td align="left">154460</td></tr><tr><td align="left">7</td><td align="left">190588</td><td align="left">204318</td><td align="left">192951</td><td align="left">214982</td><td align="left">207414</td><td align="left">202518</td></tr><tr><td align="left">4</td><td align="left">154287</td><td align="left">162503</td><td align="left">155872</td><td align="left">165420</td><td align="left">159543</td><td align="left">158972</td></tr><tr><td align="left">3</td><td align="left">218035</td><td align="left">233437</td><td align="left">219794</td><td align="left">246532</td><td align="left">235429</td><td align="left">231717</td></tr><tr><td align="left">2</td><td align="left">270559</td><td align="left">289130</td><td align="left">274293</td><td align="left">302823</td><td align="left">292595</td><td align="left">284348</td></tr><tr><td align="left">Total (min.)</td><td align="left">33.55</td><td align="left">36.02</td><td align="left">33.94</td><td align="left">37.82</td><td align="left">36.52</td><td align="left">35.72</td></tr></tbody></table></table-wrap></p>
      <p>For comparison purposes, we have also executed methylKit [<xref ref-type="bibr" rid="CR19">19</xref>], BSmooth ([<xref ref-type="bibr" rid="CR11">11</xref>]) and DSS-Single ([<xref ref-type="bibr" rid="CR14">14</xref>]) on the same dataset. That is, we have executed these other tools using the.csv files yielded by HPG-HMapper as the input files. However, at this point, it is worth mention that methylKit performs a pre-processing step on the csv input data files, in order to adapt the data to the format required for this tool. In this pre-processing, methylKit filters those DNA locations where any of the samples do not reach the minimum coverage. As a result, the dataset actually used for DMR detection has a significantly smaller size than the input data files. On the contrary, HPG-DHunter performs the filtering based on coverage after reading the input data, when the methylation signal is built. Therefore, in order to make a fair comparison we have measured the required time for HPG-DHunter and methylKit since the instant when the csv files are started to be read until the instant when DMRs are yielded. In order to let BSmooth and DSS-Single take advantage from the pre-processing carried out by methylkit, we have used this pre-processed dataset as the input for both BSmooth and DSS-Single. Although we have compared the results for the same sample groups shown in Table <xref rid="Tab13" ref-type="table">13</xref>, we show here only the results corresponding to the A-D DMR search, for the sake of shortness. The results for the rest of the groups were very similar. This dataset (the csv files for groups A and D) has a size of 16.784 Mbytes, around 16 Gigabytes.</p>
      <p>Table <xref rid="Tab14" ref-type="table">14</xref> shows that HPG-DHunter only requires a small fraction of the execution time required by the other tools to detect the DMRs in all the considered chromosomes. Looking at the last row, we can see that the total time required by HPG-DHunter for all the considered chromosomes is around 15% of the time required by BSmooth, which is the tool with the second shortest execution time. These results validate the proposed tool as an efficient tool for batch DMR detection.
<table-wrap id="Tab14"><label>Table 14</label><caption><p>Execution times (milliseconds) required for DMR detection in different tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chrom.</th><th align="left">methylKit</th><th align="left">BSmooth</th><th align="left">DSS-Ssingle</th><th align="left">HPG-DHunter</th></tr></thead><tbody><tr><td align="left">22</td><td align="left">490603</td><td align="left">492606</td><td align="left">490508</td><td align="left">94399</td></tr><tr><td align="left">20</td><td align="left">643062</td><td align="left">642859</td><td align="left">670401</td><td align="left">103958</td></tr><tr><td align="left">17</td><td align="left">990127</td><td align="left">989304</td><td align="left">991321</td><td align="left">190331</td></tr><tr><td align="left">13</td><td align="left">726562</td><td align="left">725685</td><td align="left">724213</td><td align="left">74378</td></tr><tr><td align="left">12</td><td align="left">1229539</td><td align="left">1220503</td><td align="left">1221206</td><td align="left">180999</td></tr><tr><td align="left">11</td><td align="left">1279281</td><td align="left">1273718</td><td align="left">1274000</td><td align="left">214391</td></tr><tr><td align="left">9</td><td align="left">1164930</td><td align="left">1161675</td><td align="left">1173081</td><td align="left">172293</td></tr><tr><td align="left">8</td><td align="left">958367</td><td align="left">957953</td><td align="left">953994</td><td align="left">148693</td></tr><tr><td align="left">7</td><td align="left">1401475</td><td align="left">1394688</td><td align="left">1449790</td><td align="left">190588</td></tr><tr><td align="left">4</td><td align="left">1420670</td><td align="left">1402048</td><td align="left">1449776</td><td align="left">154287</td></tr><tr><td align="left">3</td><td align="left">1581448</td><td align="left">1574495</td><td align="left">1575470</td><td align="left">218035</td></tr><tr><td align="left">2</td><td align="left">2034938</td><td align="left">2017989</td><td align="left">2196166</td><td align="left">270559</td></tr><tr><td align="left">Total (min.)</td><td align="left">232.02</td><td align="left">230.89</td><td align="left">236.17</td><td align="left">33.55</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Conclusions and future work</title>
    <p>In this paper, we have proposed a new tool named HPG-DHunter, a software tool for detecting and visualizing DMR from different samples. The tool is based on transforming the methylation information existing in the CSV files into a methylation signal, and using the Wavelet transform to process this signal in such a way that the computational workload required for detecting DMRs is reduced in orders of magnitude in regard to other methods. HPG-DHunter can efficiently detect and display DMRs for different methylation thresholds, coverage and number of samples, since the use of the GPU allows the parallel processing of methylation signals and their interactive visualization at different scales.</p>
    <p>The validation study using real and synthetic data has shown, in a comparison study with other well-known and extended tools, the good balance between accuracy and sensibility of HPG-DHunter. The performance evaluation results shows that the batch mode of the tool is capable of automatically detecting the existing DMRs for half (twelve) of the human chromosomes between two sets of six samples (whose.csv files after the alignment and mapping procedures have an aggregated size of 108 Gigabytes) in around three hours and a half. When compared to other well-known tools, HPG-DHunter only requires around 15% of the execution time required by other tools for detecting the DMRs.</p>
    <p>These results show that the proposed tool offers biomedical researchers a valuable tool for easily finding hyper or hypomethylation differences in any set of fastq files.</p>
    <p>As a future work to be done, we plan to implement the proposed tool as an Internet-based service, in such a way the user uploads the fastq files, our server computes the DMRs in batch mode, and later the user can interactively visualize the results through a web interface. Also, we plan to add DMR visualization functionalities, including boxplot of methylation levels between groups in one or several DMRs, heatmap of DNA methylation levels of a list of DMRs, genes, pathways etc..</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p>Project name: HPG-Dhunter Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/grev-uv/hpg-dhunter">https://github.com/grev-uv/hpg-dhunter</ext-link>. Operating system: Linux Ubuntu 16.0 LTS or higher. Programming language: C. Other requirements: 64 bit Intel CPU compatible with SSE4.2, Nvidia driver (v384 or higher), CUDA API (v9 or higher). License: GNU GPLv3. Restrictions to use by non-academics: non applicable.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DMR</term>
        <def>
          <p>Differentially Methylated Region</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MP and JO planned the wavelet strategy and carried out the writing of the article. LF and RO implemented the tools and carried out the performance evaluation. JM provided some of the datasets, and helped in the validation of the tool. The authors hereby declare that they all have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by Spanish MCIU and EU ERDF programs under grant RTI2018-098156-B-C55. The funding body did not play any role in the design of the study, analysis, and interpretation of data nor in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code for the proposed tool HPG-Dhunter is publicly available from the Github repository at <ext-link ext-link-type="uri" xlink:href="https://grev-uv.github.io/">https://grev-uv.github.io/</ext-link>, together with the installation instructions and the system requirements.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laird</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>Principles and challenges of genome-wide dna methylation analysis</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>191</fpage>
        <lpage>203</lpage>
        <?supplied-pmid 20125086?>
        <pub-id pub-id-type="pmid">20125086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Szulwach</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C-X</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>TET-assisted bisulfite sequencing of 5-hydroxymethylcytosine</article-title>
        <source>Nat Protoc</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>2159</fpage>
        <lpage>70</lpage>
        <?supplied-pmid 23196972?>
        <pub-id pub-id-type="pmid">23196972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Szulwach</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C-X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <collab>Bing</collab>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Base-resolution analysis of 5-hydroxymethylcytosine in the mammalian genome</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <issue>6</issue>
        <fpage>1368</fpage>
        <lpage>80</lpage>
        <?supplied-pmid 22608086?>
        <pub-id pub-id-type="pmid">22608086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>Y-K</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>oxBS-MLE: an efficient method to estimate 5-methylcytosine and 5-hydroxymethylcytosine in paired bisulfite and oxidative bisulfite treated dna</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>23</issue>
        <fpage>3667</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 27522082?>
        <pub-id pub-id-type="pmid">27522082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>RRBSMAP: a fast, accurate and user-friendly alignment tool for reduced representation bisulfite sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>430</fpage>
        <lpage>2</lpage>
        <?supplied-pmid 22155871?>
        <pub-id pub-id-type="pmid">22155871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for bisulfite-seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1571</fpage>
        <lpage>2</lpage>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tárraga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orduña</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Duato</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A parallel and sensitive software tool for methylation analysis on multicore platforms</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3130</fpage>
        <?supplied-pmid 26069264?>
        <pub-id pub-id-type="pmid">26069264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olanda</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orduña</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Tárraga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A new parallel pipeline for DNA methylation analysis of long reads datasets</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>161</fpage>
        <?supplied-pmid 28274198?>
        <pub-id pub-id-type="pmid">28274198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>González</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orduña</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Chaves</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>García</surname>
            <given-names>A-B</given-names>
          </name>
        </person-group>
        <article-title>On the use of binary trees for dna hydroxymethylation analysis</article-title>
        <source>5th International Workshop on Parallelism in Bioinformatics, as Part of ICA3PP 2017</source>
        <year>2017</year>
        <publisher-loc>Heidelberg</publisher-loc>
        <publisher-name>Springer International Publishing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>González</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orduña</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Hpg-hmapper: A dna hydroxymethylation analysis tool</article-title>
        <source>Int J High Perform Comput Appl</source>
        <year>2019</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Bsmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>83</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>H-U</given-names>
          </name>
        </person-group>
        <article-title>Detection of significantly differentially methylated regions in targeted bisulfite sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>13</issue>
        <fpage>1647</fpage>
        <lpage>53</lpage>
        <?supplied-pmid 23658421?>
        <pub-id pub-id-type="pmid">23658421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Meong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goodell</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Moabs: model based analysis of bisulfite sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>38</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Conneely</surname>
            <given-names>KN</given-names>
          </name>
        </person-group>
        <article-title>Detection of differentially methylated regions from whole-genome bisulfite sequencing data without replicates</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>21</issue>
        <fpage>141</fpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mitrea</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A survey of the approaches for identifying differential methylation using bisulfite sequencing data</article-title>
        <source>Brief Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>5</issue>
        <fpage>737</fpage>
        <lpage>53</lpage>
        <?supplied-pmid 28334228?>
        <pub-id pub-id-type="pmid">28334228</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>Y-K</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>D-X</given-names>
          </name>
          <name>
            <surname>Hoyo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Differential methylation values in differential methylation analysis</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>7</issue>
        <fpage>1094</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 30184051?>
        <pub-id pub-id-type="pmid">30184051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparing five statistical methods of differential methylation identification using bisulfite sequencing data</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>173</fpage>
        <lpage>91</lpage>
        <?supplied-pmid 26910753?>
        <pub-id pub-id-type="pmid">26910753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orduña</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Visualization of dna methylation results through a gpu-based parallelization of the wavelet transform</article-title>
        <source>J Supercomput</source>
        <year>2019</year>
        <volume>75</volume>
        <fpage>1496</fpage>
        <lpage>509</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Bioconductor. methylKit: DNA methylation analysis from high-throughput bisulfite sequencing results. 2016. https://doi.org/10.18129/B9.bioc.methylKit. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/methylKit.html">https://bioconductor.org/packages/release/bioc/html/methylKit.html</ext-link>. Accessed 10 Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shenoy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bhagat</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cheville</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tischer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Machha</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gordon-Mitchel</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>L.F.</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gross</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ressigue</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Leibovich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Boorjian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steidl</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Pradhan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gartrel</surname>
            <given-names>l. B.</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pagliaro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rakheja</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Witzig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Ascorbic acid-induced tet activation mitigates adverse hydroxymethylcytosine loss in renal cell carcinoma</article-title>
        <source>J Clin Investig</source>
        <year>2019</year>
        <volume>129</volume>
        <issue>4</issue>
        <fpage>1612</fpage>
        <lpage>25</lpage>
        <?supplied-pmid 30702441?>
        <pub-id pub-id-type="pmid">30702441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">PyWavelets: Wavelet Biorthogonal 3.5 (bior3.5). 2019. <ext-link ext-link-type="uri" xlink:href="http://wavelets.pybytes.com/wavelet/bior3.5/">http://wavelets.pybytes.com/wavelet/bior3.5/</ext-link>. Accessed 5 Mar 2020.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katunin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>B-spline wavelet packets and their application in the multiresolution non-stationary signal processing</article-title>
        <source>Sci Probl Mach Oper and Maint</source>
        <year>2010</year>
        <volume>45</volume>
        <fpage>103</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rackham</surname>
            <given-names>OJL</given-names>
          </name>
          <name>
            <surname>Dellaportas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Petretto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bottolo</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Wgbssuite: simulating whole-genome bisulphite sequencing data and benchmarking differential dna methylation analysis tools</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2371</fpage>
        <lpage>3</lpage>
        <?supplied-pmid 25777524?>
        <pub-id pub-id-type="pmid">25777524</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
