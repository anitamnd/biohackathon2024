<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4058956</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu291</article-id>
    <article-id pub-id-type="publisher-id">btu291</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2014 Proceedings Papers Committee</subject>
        <subj-group subj-group-type="heading">
          <subject>Original Papers</subject>
          <subj-group subj-group-type="heading">
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AlignGraph: algorithm for secondary <italic>de novo</italic> genome assembly guided by closely related references</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bao</surname>
          <given-names>Ergude</given-names>
        </name>
        <xref ref-type="aff" rid="btu291-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="btu291-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Girke</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="btu291-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btu291-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btu291-AFF1"><sup>1</sup>Department of Computer Science and Engineering and <sup>2</sup>Department of Botany and Plant Sciences, University of California, Riverside, CA 92521, USA</aff>
    <author-notes>
      <corresp id="btu291-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>12</issue>
    <fpage>i319</fpage>
    <lpage>i328</lpage>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold><italic>De novo</italic> assemblies of genomes remain one of the most challenging applications in next-generation sequencing. Usually, their results are incomplete and fragmented into hundreds of contigs. Repeats in genomes and sequencing errors are the main reasons for these complications. With the rapidly growing number of sequenced genomes, it is now feasible to improve assemblies by guiding them with genomes from related species.</p>
      <p><bold>Results:</bold> Here we introduce AlignGraph, an algorithm for extending and joining <italic>de novo</italic>-assembled contigs or scaffolds guided by closely related reference genomes. It aligns paired-end (PE) reads and preassembled contigs or scaffolds to a close reference. From the obtained alignments, it builds a novel data structure, called the PE multipositional de Bruijn graph. The incorporated positional information from the alignments and PE reads allows us to extend the initial assemblies, while avoiding incorrect extensions and early terminations. In our performance tests, AlignGraph was able to substantially improve the contigs and scaffolds from several assemblers. For instance, 28.7–62.3% of the contigs of Arabidopsis thaliana and human could be extended, resulting in improvements of common assembly metrics, such as an increase of the N50 of the extendable contigs by 89.9–94.5% and 80.3–165.8%, respectively. In another test, AlignGraph was able to improve the assembly of a published genome (Arabidopsis strain Landsberg) by increasing the N50 of its extendable scaffolds by 86.6%. These results demonstrate AlignGraph’s efficiency in improving genome assemblies by taking advantage of closely related references.</p>
      <p><bold>Availability and implementation:</bold> The AlignGraph software can be downloaded for free from this site: <ext-link ext-link-type="uri" xlink:href="https://github.com/baoe/AlignGraph">https://github.com/baoe/AlignGraph</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>thomas.girke@ucr.edu</email>
      </p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Recent advances in next-generation sequencing (NGS) have made it possible to sequence new genomes at a fraction of the time and cost required only a few years ago. These improvements now allow experimental scientists to integrate genome sequencing approaches into their daily research. In the absence of a close reference genome, whole-genome shotgun NGS sequencing is the most common approach where a <italic>de novo</italic> assembly algorithm is used to join reads into longer continuous contigs and scaffolds. Most NGS <italic>de novo</italic> assemblers create a string or de Bruijn graph representing the connections among the reads and output the paths in the graph as assembled contigs. Examples of these algorithms include Edena (<xref rid="btu291-B11" ref-type="bibr">Hernandez <italic>et al.</italic>, 2008</xref>), Velvet (<xref rid="btu291-B38" ref-type="bibr">Zerbino and Birney, 2008</xref>), ABySS (<xref rid="btu291-B34" ref-type="bibr">Simpson <italic>et al.</italic>, 2009</xref>), ALLPATHS-LG (<xref rid="btu291-B9" ref-type="bibr">Gnerre <italic>et al.</italic>, 2011</xref>), SOAPdenovo (<xref rid="btu291-B18" ref-type="bibr">Li <italic>et al.</italic>, 2010</xref>; <xref rid="btu291-B20" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>), MaSuRCA (<xref rid="btu291-B39" ref-type="bibr">Zimin <italic>et al.</italic>, 2013</xref>), CABOG (<xref rid="btu291-B22" ref-type="bibr">Miller <italic>et al.</italic>, 2008</xref>), Euler-USR (<xref rid="btu291-B4" ref-type="bibr">Chaisson <italic>et al.</italic>, 2009</xref>) and IDBA (<xref rid="btu291-B24" ref-type="bibr">Peng <italic>et al.</italic>, 2010</xref>). This <italic>de novo</italic> assembly approach fundamentally differs from <italic>alignment-based resequencing</italic> approaches, where the NGS reads are not assembled but aligned against a similar reference genome using a variant tolerant short read aligner and structural variant detection algorithms (<xref rid="btu291-B23" ref-type="bibr">Ossowski <italic>et al.</italic>, 2008</xref>; <xref rid="btu291-B37" ref-type="bibr">Zeitouni <italic>et al.</italic>, 2010</xref>). Large parts of the sequence of the target genome can then be reconstructed from the mismatches, indels and rearrangements observed in the alignment results. <italic>De novo</italic> assemblies tend to be computationally more challenging than alignment-based approaches. Additional limitations include (i) the assembly results are often fragmented into large numbers of contigs, (ii) the genome covered by the assembled contigs/scaffolds is commonly incomplete and (iii) the frequency of falsely assembled contigs can be high because of chimeric joins. The most important reasons for these complications are usually sequencing errors, repeat sequences in the target genome, non-uniform sequencing depth and limited read length of NGS data. These error sources result in false-positive, incomplete and branched paths in the assembly graph, and thus greatly limit the lengths and completeness of the final contigs (<xref rid="btu291-B3" ref-type="bibr">Chaisson and Pevzner, 2008</xref>; <xref rid="btu291-B24" ref-type="bibr">Peng <italic>et al.</italic>, 2010</xref>; <xref rid="btu291-B38" ref-type="bibr">Zerbino and Birney, 2008</xref>). Combining both <italic>de novo</italic> assembly and alignment-based approaches presents a powerful alternative when a closely related reference genome sequence is available, but its genetic differences relative to the target genome are too pronounced to resolve them with an alignment approach alone (<xref rid="btu291-B26" ref-type="bibr">Phillippy <italic>et al.</italic>, 2008</xref>; <xref rid="btu291-B32" ref-type="bibr">Schatz <italic>et al.</italic>, 2013</xref>; <xref rid="btu291-B33" ref-type="bibr">Schneeberger <italic>et al.</italic>, 2011</xref>). In this case, one can first assemble the reads into contigs and then align them together with the reads to the reference. The much longer contigs facilitate the identification of complex rearrangements, whereas the read alignments are useful for detecting smaller variations in regions that are not covered by contigs. Because of the rapidly increasing number of reference genomes becoming available for most organism groups, this <italic>reference-assisted assembly approach</italic> will soon become the default option for many genome sequencing projects. Compared with <italic>de novo</italic> assemblies, reference-assisted assemblies have many advantages. First, the alignments of the contigs and reads against the close reference provide valuable proximity information that can be used to extend contigs with additional reads and to join contigs even if they overlap only by a few nucleotides. Second, the proximity information in the alignment can also be used to orient and order contigs along the reference to build a scaffold map of the entire assembly. Third, the alignment map can be used to evaluate the quality of contigs and pinpoint potential misassemblies.</p>
    <p>Previous studies on reference-assisted assemblies include the AMOScmp software (<xref rid="btu291-B27" ref-type="bibr">Pop <italic>et al.</italic>, 2004a</xref>), an add-on tool for the ARACHNE assembler (<xref rid="btu291-B8" ref-type="bibr">Gnerre <italic>et al.</italic>, 2009</xref>) and custom workflows largely based on existing assembly software (e.g. <xref rid="btu291-B33" ref-type="bibr">Schneeberger <italic>et al.</italic>, 2011</xref>). The first two were designed primarily for Sanger reads, whereas the latter has been used for NGS genome assembly. Downstream of the primary assembly, scaffolding algorithms, such as RACA (<xref rid="btu291-B15" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>), can be used to order and orient preassembled contigs to a connection map by incorporating additional sequence information from mate pair or PE reads and/or from closely related genomes (<xref rid="btu291-B2" ref-type="bibr">Boetzer <italic>et al.</italic>, 2011</xref>; <xref rid="btu291-B5" ref-type="bibr">Dayarian <italic>et al.</italic>, 2010</xref>; <xref rid="btu291-B7" ref-type="bibr">Gao <italic>et al.</italic>, 2011</xref>; <xref rid="btu291-B10" ref-type="bibr">Gritsenko <italic>et al.</italic>, 2012</xref>; <xref rid="btu291-B28" ref-type="bibr">Pop <italic>et al.</italic>, 2004b</xref>; <xref rid="btu291-B30" ref-type="bibr">Salmela <italic>et al.</italic>, 2011</xref>). The resulting scaffolds often contain gaps, which are unresolved sequence areas between the original contigs. Dedicated gap-filling algorithms can be used to partially fill these gaps (<xref rid="btu291-B1" ref-type="bibr">Boetzer and Pirovano, 2012</xref>; <xref rid="btu291-B20" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>; <xref rid="btu291-B35" ref-type="bibr">Tsai <italic>et al.</italic>, 2010</xref>). More recently, components of reference-based strategies have also been incorporated into some of the <italic>de novo</italic> assembly suites themselves such as the <italic>cheat</italic> mode option of ALLPATHS-LG (<xref rid="btu291-B9" ref-type="bibr">Gnerre <italic>et al.</italic>, 2011</xref>) and IDBA-hybrid (unpublished).</p>
    <p>This study proposes a novel algorithm, called AlignGraph, for improving the lengths and completeness of contigs or scaffolds by reassembling them with help provided by a reference genome of a closely related organism. In contrast to existing reference-assisted methods, AlignGraph is a <italic>secondary assembly algorithm</italic> that loads the alignment information of PE reads and preassembled contigs/scaffolds against the reference into a novel assembly graph, called the <italic>PE multi</italic><italic>positional de Bruijn graph</italic>, that we specifically designed for facilitating secondary assemblies. By traversing this graph, the contigs or scaffolds of the primary assembly can be extended and joined. AlignGraph differs from most scaffolding algorithms by extending contigs exclusively with resolved rather than unresolved bases (Ns) and by acting either upstream and/or downstream of them.</p>
    <p>AlignGraph’s functionalities are unique by solving several challenges in improving assembly results. As a de Bruijn graph-based method, it solves limitations typical for many heuristic extension methods that are often used in the <italic>de novo</italic> assembly area (<xref rid="btu291-B6" ref-type="bibr">Dohm <italic>et al.</italic>, 2007</xref>; <xref rid="btu291-B13" ref-type="bibr">Jeck <italic>et al.</italic>, 2007</xref>; <xref rid="btu291-B36" ref-type="bibr">Warren <italic>et al.</italic>, 2007</xref>). For instance, if there are multiple solutions for how to extend a contig, then finding the correct one can be challenging with most heuristic methods. Those ambiguous solutions, which correspond to branched paths in the de Bruijn graph, are usually caused by repetitive sequences in genomes and frequently lead to early terminations of the contig extension process. The de Bruijn graph method is often more efficient than heuristic methods in finding the correct solution here because the contextual information, required for resolving these ambiguities, is maintained in the graph (<xref rid="btu291-B3" ref-type="bibr">Chaisson and Pevzner, 2008</xref>; <xref rid="btu291-B38" ref-type="bibr">Zerbino and Birney, 2008</xref>). This issue is not as pronounced in assemblies with much longer Sanger reads, as those are more likely to span non-repetitive regions with repetitive regions in between (<xref rid="btu291-B8" ref-type="bibr">Gnerre <italic>et al.</italic>, 2009</xref>). Thus, it is particularly important to address this problem in assemblies with short reads. In comparison with the conventional de Bruijn graph, our PE multipositional de Bruijn graph has several additional advantages. First, many branched paths can be eliminated directly in the graph with the help of the additional PE read and alignment information. This simplifies the identification of correct paths. Second, many false-positive paths, caused by sequencing errors, can be eliminated by correcting erroneous reads with correct reads that align to the same position in the reference genome. Third, guided by the alignment information to the reference genome, the PE multipositional de Bruijn graph is less affected by regionally low read coverage that often gives rise to incomplete paths in the conventional de Bruijn graph. As a result, many incorrect extensions and early terminations can be avoided.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 AlignGraph algorithm</title>
      <p>This section describes the AlignGraph algorithm. Its workflow can be divided into the following three major steps. <xref ref-type="fig" rid="btu291-F1">Figure 1</xref>B illustrates these steps with an example.
<list list-type="roman-lower"><list-item><p><italic>Alignment maps</italic>. The PE reads are aligned against both the preassembled contigs and the close reference genome; the contigs are aligned against the reference.</p></list-item><list-item><p><italic>Contig reassembly</italic>. The alignment mapping results are used to construct a positional variant of the de Bruijn graph, called the <italic>PE multi</italic><italic>positional de Bruijn graph</italic>.</p></list-item><list-item><p><italic>Graph traversal</italic>. The resulting graph is edited and traversed to obtain extended contigs.</p></list-item></list>
Throughout the text, the source genome of the PE reads and the preassembled contigs is referred to as the <italic>target genome</italic>, whereas the genome of the closely related species for guiding the contig improvement steps is referred to as the <italic>reference genome</italic>. For simplicity, the following description of AlignGraph refers mostly to contigs, but it also applies to scaffolds containing a limited amount gaps.
<fig id="btu291-F1" position="float"><label>Fig. 1.</label><caption><p>Overview of the AlignGraph algorithm. The outline on the top (<bold>A</bold>) shows AlignGraph in the context of common genome assembly workflows, and the one on the bottom (<bold>B</bold>) illustrates its three main processing steps. (A) In Step 1, the PE reads from a target genome are assembled by a <italic>de novo</italic> assembler into contigs (here <inline-formula><mml:math id="n1"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>c</italic><sub>3</sub>). Subsequently (Step 2), the contigs can be extended (blue) and joined by AlignGraph (<italic>e</italic><sub>1</sub> and <italic>e</italic><sub>2</sub>). (B) The workflow of AlignGraph consists of three main steps. (i) The PE reads are aligned to the reference genome and to the contigs, and the contigs are also aligned to the reference genome. (ii) The PE multipositional de Bruijn graph is built from the alignment results, where the red and blue subpaths correspond to the aligned contigs and sequences from PE reads, respectively. (iii) The extended and/or joined contigs (here <italic>e</italic><sub>1</sub> and <italic>e</italic><sub>2</sub>) are generated by traversing the graph</p></caption><graphic xlink:href="btu291f1"/></fig></p>
      <sec>
        <title>Prerequisites</title>
        <p>Before the above steps, the user is expected to generate genomic PE reads for the target genome of interest and to assemble them with a <italic>de novo</italic> NGS genome assembler. Because most genome assemblers perform better with PE than single-end data, AlignGraph also depends on this sequence type. A major advantage of AlignGraph is its design to work with most genome assemblers, but the quality of the initial <italic>de novo</italic> assembled contigs is expected to impact the final results (see Section 3.2). For optimal results, it is also important to follow the recommendations of the chosen <italic>de novo</italic> assembler with respect to insert length of the sequencing library, minimum coverage of the target genome with PE reads and other recommendations. If scaffolds are inputted, it is usually beneficial to fill them with a gap-filling algorithm before processing them with AlignGraph (e.g. <xref rid="btu291-B1" ref-type="bibr">Boetzer and Pirovano, 2012</xref>). Another requirement for AlignGraph is the availability of a closely related reference genome sequence. Nearly complete reference genomes of high quality will yield the best results, but partially sequenced genomes can be used as well.</p>
      </sec>
      <sec>
        <title>(i) Alignment maps</title>
        <p>In the initial preprocessing step of AlignGraph, the PE reads, used for the <italic>de novo</italic> assembly in the <italic>Prerequisite</italic> section, are aligned to the contigs and to the reference genome, and the contigs are also aligned to the reference genome. Aligning the reads to the contigs simplifies their alignments to the reference by guiding them with the much longer contigs as backbone (see below). Generating reliable alignments among the PE reads and the contigs is relatively straightforward because both are from the same genetic background, thus requiring a low level of variant tolerance in the alignments. Aligning the contigs to the reference genome demands a higher level of variant tolerance. However, because of the relatively large length of the contigs, their alignments to the reference can also be generated reliably, as long as the evolutionary distance between the target and reference genome is not too large. The current implementation of AlignGraph uses Bowtie2 and BLAT for these two alignment steps, respectively (<xref rid="btu291-B14" ref-type="bibr">Kent, 2002</xref>; <xref rid="btu291-B16" ref-type="bibr">Langmead and Salzberg, 2012</xref>). In contrast to this, aligning the relatively short PE reads to the reference genome is a more challenging task owing to the difficulty of generating reliable short alignments containing larger numbers of mismatches and gaps. This problem does not apply to the reads aligning to the contigs because their alignment positions to the reference genome can be inferred from the more robust contig alignments. For the PE read to reference genome alignment, it is important to choose a highly variant tolerant short read aligner that is able to reliably align most of the short reads to their <italic>true</italic> source locations in the reference genome while minimizing the number of false-positive read placements. Clearly, the latter would negatively impact the precision performance of AlignGraph by leading to chimeric joins in the downstream contig extension steps. Although a wide range of short read aligners has been developed over the past years (<xref rid="btu291-B17" ref-type="bibr">Li and Homer, 2010</xref>), none of them has been specifically designed or optimized for aligning short reads against reference genomes with sequence differences more pronounced than those observed among genomes within the same species. To minimize the above challenges, we have chosen for this critical step the highly tunable Bowtie2 aligner with parameter settings that we optimized for aligning PE reads from a target genome to a reference genome sharing variable degrees of sequence similarity. The use of PE read alignments in this step is also important because the additional sequence information, provided by the second read in a PE, increases the specificity of the alignment process compared with single-end reads, and thus reduces the number of false read placements. To account for rearrangements among the two genomes, we use for the alignments of the PE reads against the reference genome more relaxed insert length variation settings than in the alignments against the contigs.</p>
      </sec>
      <sec>
        <title>(ii) Contig reassembly with PE multipositional de Bruijn graph</title>
        <p>The core functionality of AlignGraph is the extension of the contigs by reassembling them using the alignment results obtained in the previous step. To achieve this efficiently, we build from the alignment maps a variant of the de Bruijn graph, here called the <italic>PE multi</italic><italic>positional de Bruijn graph</italic>. This method combines the PE de Bruijn graph (<xref rid="btu291-B21" ref-type="bibr">Medvedev <italic>et al.</italic>, 2011</xref>) and the positional de Bruijn graph (<xref rid="btu291-B29" ref-type="bibr">Ronen <italic>et al.</italic>, 2012</xref>), where we incorporate both PE read information and alignment positions into the graph (<xref rid="btu291-B25" ref-type="bibr">Pevzner <italic>et al.</italic>, 2001</xref>). The former was designed to generate more complete contigs in <italic>de novo</italic> assemblies and the latter to correct contig errors in secondary assemblies. Our approach solves several problems in improving assembly results that we briefly discussed in Section 1 (see also <xref ref-type="table" rid="btu291-T1">Table 1</xref>). The following describes our modified de Bruijn graph in more details, where we first introduce important concepts of conventional de Bruijn graph-based assembly methods.
<table-wrap id="btu291-T1" position="float"><label>Table 1.</label><caption><p>Problems the PE multipositional de Bruijn graph solves in comparison with the conventional de Bruijn graph</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Problem</th><th rowspan="1" colspan="1">Consequence</th><th rowspan="1" colspan="1">Solution</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Repeat sequences</td><td rowspan="1" colspan="1">Branched paths</td><td rowspan="1" colspan="1">Distinguishes paths for repetitive regions by incorporating PE read and alignment position information</td></tr><tr><td rowspan="1" colspan="1">Sequencing errors</td><td rowspan="1" colspan="1">False-positive paths</td><td rowspan="1" colspan="1">Corrects paths from erroneous reads with correct reads aligned to the same position</td></tr><tr><td rowspan="1" colspan="1">Low sequencing depth</td><td rowspan="1" colspan="1">Incomplete paths</td><td rowspan="1" colspan="1">Builds paths from reads in low coverage areas supported by reference</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec>
        <title>Background</title>
        <p>The most widely used method for genome assemblies from short reads is the de Bruijn graph method (<xref rid="btu291-B25" ref-type="bibr">Pevzner <italic>et al.</italic>, 2001</xref>). A de Bruijn graph is a directed graph: two connected nodes represent <italic>k</italic> + 1 bases, where the first node represents the first <italic>k</italic> bases, and the second node the second <italic>k</italic> bases (called <italic>k-mer</italic>). To construct a de Bruijn graph, <inline-formula><mml:math id="n2"><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> connected nodes are constructed from each read of length <italic>l</italic>, and two nodes from different reads are joined if they share the same <italic>k</italic>-mers. In theory, the graph contains a walk representing the full sequence of the genome if traversed properly. However, this walk is hard to obtain in practice because of false-positive, incomplete and branched connections in the graph that are caused by errors in the reads and repeats in the genome. The false-positive and incomplete paths are due to false-positive <italic>k</italic>-mers with sequencing errors and missing <italic>k</italic>-mers from regions of low sequencing depth, respectively. The branched paths are caused by joins of <italic>k</italic>-mers from repetitive regions. Several variations of the de Bruijn graph have been proposed to solve these limitations, especially the branched paths, while preserving all of its genome information (<xref rid="btu291-B21" ref-type="bibr">Medvedev <italic>et al.</italic>, 2011</xref>; <xref rid="btu291-B24" ref-type="bibr">Peng <italic>et al.</italic>, 2010</xref>; <xref rid="btu291-B29" ref-type="bibr">Ronen <italic>et al.</italic>, 2012</xref>). The PE de Bruijn graph (<xref rid="btu291-B21" ref-type="bibr">Medvedev <italic>et al.</italic>, 2011</xref>) is built from PE reads, where each <italic>k</italic>-mer contains <italic>k</italic> bases from the left pair plus its corresponding <italic>k</italic> bases from the right pair. In contrast to this, the positional de Bruijn graph (<xref rid="btu291-B29" ref-type="bibr">Ronen <italic>et al.</italic>, 2012</xref>) incorporates read alignment information by including in each <italic>k</italic>-mer the <italic>k</italic> bases plus its alignment position. With the additional information assigned to the <italic>k</italic>-mers, <italic>k</italic>-mers from repetitive regions can often be distinguished, and thus the number of branches in the graph can be reduced. In addition, because the positional de Bruijn graph is built from read alignments, false-positive and incomplete paths can be largely avoided. We emphasize that the PE de Bruijn graph requires the left pair forward-strand read and the right pair reverse-strand read or vice versa, but it is difficult to know their orientation. This problem can be resolved if the PE de Bruijn graph is built from aligned reads, where their orientation can be obtained from the alignments.</p>
      </sec>
      <sec>
        <title>PE multipositional de Bruijn graph</title>
        <p>We derive the <italic>PE multi</italic><italic>positional de Bruijn graph</italic> as a combination of the PE de Bruijn graph and the positional de Bruijn graph. Each <italic>k</italic>-mer of the PE multipositional de Bruijn graph is composed of three left/right element pairs: the <italic>k</italic> bases of each the left and the right read pair (called <italic>left or right k bases</italic>), the alignment position of each the left and the right <italic>k</italic> bases to the contigs and the alignment position of each the left and the right <italic>k</italic> bases to the reference genome. Two <italic>k</italic>-mers can be joined if they have similar <italic>k</italic> bases and close alignment positions within the constraints defined in the formulas below. Formally, let <italic>s</italic> be the <italic>k</italic> bases from the left read pair and <inline-formula><mml:math id="n3"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> the corresponding <italic>k</italic> bases from the right read pair, then the <italic>k</italic>-mer of PE multipositional de Bruijn graph is a 6 tuple (<inline-formula><mml:math id="n4"><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="n5"><mml:mrow><mml:mi>c</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>), where <italic>c</italic> is the alignment position of <italic>s</italic> to the contigs, <italic>g</italic> is the alignment position of <italic>s</italic> to the reference genome, <inline-formula><mml:math id="n6"><mml:mrow><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is the alignment position of <inline-formula><mml:math id="n7"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> to the contigs and <inline-formula><mml:math id="n8"><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is the alignment position of <inline-formula><mml:math id="n9"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> to the reference genome. Two <italic>k</italic>-mers (<inline-formula><mml:math id="n10"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) and (<inline-formula><mml:math id="n11"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) can be joined if constrains <xref ref-type="disp-formula" rid="btu291-M1 btu291-M2 btu291-M3 btu291-M4 btu291-M5 btu291-M6">(1)–(6)</xref> are met:
<disp-formula id="btu291-M1"><label>(1)</label><mml:math id="n12"><mml:mrow><mml:mtext>mismatch</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="btu291-M2"><label>(2)</label><mml:math id="n13"><mml:mrow><mml:mtext>mismatch</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="btu291-M3"><label>(3)</label><mml:math id="n14"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mspace width=".3em"/><mml:mtext>or</mml:mtext><mml:mspace width=".3em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mspace width=".3em"/><mml:mtext>or</mml:mtext><mml:mspace width=".3em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula>
<disp-formula id="btu291-M4"><label>(4)</label><mml:math id="n15"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">ϵ</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="btu291-M5"><label>(5)</label><mml:math id="n16"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mspace width=".3em"/><mml:mtext>or</mml:mtext><mml:mspace width=".3em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mspace width=".3em"/><mml:mtext>or</mml:mtext><mml:mspace width=".3em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula>
<disp-formula id="btu291-M6"><label>(6)</label><mml:math id="n17"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:math></disp-formula>
where δ and ε are small numbers with the default values 5 and 25, respectively, and <italic>D</italic> is the variability of the insert length <italic>I</italic> of the PE reads. The variability <italic>D</italic> is equal to <inline-formula><mml:math id="n18"><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>I<sub>u</sub></italic> and <italic>I<sub>l</sub></italic> are the upper and lower limits of <italic>I</italic>, respectively. The variables in the above formulas are explained below.
<list list-type="simple"><list-item><p>δ: To join two <italic>k</italic>-mers and tolerate sequencing errors, we allow a small number of mismatches δ between <italic>s<sub>i</sub></italic> and <italic>s<sub>j</sub></italic> and between <inline-formula><mml:math id="n19"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n20"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="btu291-M1">(1)</xref> and <xref ref-type="disp-formula" rid="btu291-M2">(2)</xref>, respectively.</p></list-item><list-item><p>ε: We allow a small shift ε between each pair of alignment positions in <xref ref-type="disp-formula" rid="btu291-M3 btu291-M4 btu291-M5 btu291-M6">(3)–(6)</xref> because the same <italic>k</italic> bases <italic>s<sub>i</sub></italic> and <italic>s<sub>j</sub></italic> (or <inline-formula><mml:math id="n21"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n22"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) from different reads may align to different but close positions in the contigs or genome, as discussed in <xref rid="btu291-B29" ref-type="bibr">Ronen <italic>et al.</italic> (2012)</xref>.</p></list-item><list-item><p>2<italic>D</italic>: We allow a shift <inline-formula><mml:math id="n23"><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="n24"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n25"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>’s alignment positions to the contigs in <xref ref-type="disp-formula" rid="btu291-M5">(5)</xref> and to the reference genome in <xref ref-type="disp-formula" rid="btu291-M6">(6)</xref>. The maximum and minimum alignment distances between a read pair are <inline-formula><mml:math id="n26"><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n27"><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>, respectively, where <italic>l</italic> is the read length, assuming the same read length for both members in a pair. Thus, the maximum alignment distance of two right reads with left reads aligned at the same position is <inline-formula><mml:math id="n28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>. This distance is equal to the distance between any two <italic>k</italic>-mers from the same position in the right read pairs, so the maximum distance between <inline-formula><mml:math id="n29"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n30"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> will be <inline-formula><mml:math id="n31"><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>−1: <italic>s<sub>i</sub></italic> and <italic>s<sub>j</sub></italic> (or <inline-formula><mml:math id="n32"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n33"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) can be joined if one or both of them are aligned directly to the reference genome rather than guided by the <italic>de novo</italic> contigs. In those cases, we assign <italic>−</italic>1 as alignment position to the contigs. This is important because we allow contig extensions only if the alignable and unalignable bases to contigs can be joined.</p></list-item></list>
It is important to guarantee that each <italic>k</italic>-mer corresponding to an insertion of a read alignment has a position in the reference genome. To achieve this, we append the inserted <italic>k</italic>-mer to the end of the genome sequence. In our implementation of the PE multipositional de Bruijn graph, we first iteratively load sections of the reference genome into memory. Then we perform the following operation. We test for each <italic>k</italic>-mer in each aligned read at genome position <italic>g</italic>, whether there is already a <italic>k</italic>-mer at <italic>g</italic> and whether the new <italic>k</italic>-mer can be joined with it. If so then we join the two <italic>k</italic>-mers; otherwise, we attach the new <italic>k</italic>-mer to position <italic>g</italic>. The connection between two <italic>k</italic>-mers is recorded by using pointers, and the read coverage for each <italic>k</italic>-mer is stored along with it. <xref ref-type="fig" rid="btu291-F2">Figure 2</xref> illustrates the main advantages of the PE multipositional de Bruijn graph compared with the positional de Bruijn graph with several examples (see also <xref ref-type="table" rid="btu291-T1">Table 1</xref>). This includes the contig-guided PE read alignment against the reference genome resulting in a larger number of alignable reads, and thus a more complete de Bruijn graph (<xref ref-type="fig" rid="btu291-F2">Fig. 2</xref>B), as well as the reduction of branched paths in the graph by distinguishing reads from different repetitive regions (<xref ref-type="fig" rid="btu291-F2">Fig. 2</xref>C and D). For space reasons, the advantages over the conventional de Bruijn graph in reducing false-positive and incomplete paths are not shown. The PE multipositional de Bruijn graph can converge to the positional de Bruijn graph by relaxing the above constraints <xref ref-type="disp-formula" rid="btu291-M2">(2)</xref>, <xref ref-type="disp-formula" rid="btu291-M3">(3)</xref>, <xref ref-type="disp-formula" rid="btu291-M5">(5)</xref> and <xref ref-type="disp-formula" rid="btu291-M6">(6)</xref>. In our tests, the former shows usually an up to 5% better performance than the latter with respect to several sensitivity measures (see below for definitions). This improvement is considerable because the number of branches that are only resolvable by the PE multipositional de Bruijn graph is usually not large.
<fig id="btu291-F2" position="float"><label>Fig. 2.</label><caption><p>Advantages of the PE multipositional de Bruijn graph compared with the positional de Bruijn graph. In the target genome given on the top, <italic>A</italic> and <inline-formula><mml:math id="n34"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n35"><mml:mrow><mml:mi>C</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n36"><mml:mrow><mml:mi>E</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n37"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are repetitive regions. Each PE read of length 2 × 4 bp is sequenced with one pair from region <inline-formula><mml:math id="n38"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and the other from the corresponding position of region <inline-formula><mml:math id="n39"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mi>G</mml:mi><mml:mi>H</mml:mi><mml:mi>E</mml:mi><mml:mo>′</mml:mo><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (the pair from <inline-formula><mml:math id="n40"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mi>G</mml:mi><mml:mi>H</mml:mi><mml:mi>E</mml:mi><mml:mo>′</mml:mo><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is omitted for simplicity). In comparison with the target genome, the reference genome has a repeat-free region <italic>ABC</italic> similar to <inline-formula><mml:math id="n41"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and a region <inline-formula><mml:math id="n42"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mi>G</mml:mi><mml:mi>H</mml:mi><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> similar to <inline-formula><mml:math id="n43"><mml:mrow><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mi>G</mml:mi><mml:mi>H</mml:mi><mml:mi>E</mml:mi><mml:mo>′</mml:mo><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. The reads from region <inline-formula><mml:math id="n44"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are assembled with a <italic>de novo</italic> assembler into a contig starting from <inline-formula><mml:math id="n45"><mml:mrow><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, but regions <italic>A</italic> and <italic>B</italic> are not assembled because of low sequencing depth, repeats or other problems. When aligning the contig to the reference genome, the repetitive regions <italic>C</italic> and <inline-formula><mml:math id="n46"><mml:mrow><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are both aligned to <italic>C</italic> in the reference genome, and the insertion <italic>D</italic> is assigned to the end of the reference. In (<bold>A</bold>) reads are aligned directly to the reference genome to build the initial positional de Bruijn graph, and in (<bold>B–D</bold>) the reads are aligned to the preassembled contigs and then aligned to the reference to build first the extended positional de Bruijn graph and then the PE multipositional de Bruijn graph. (A) The initial positional de Bruijn graph is built here with 3-mers. Some reads cannot be aligned to the reference genome because of sequence differences in the target genome, as indicated here by 3-mers with −1 as alignment position. The repetitive regions <italic>A</italic> and <inline-formula><mml:math id="n47"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (or <italic>C</italic> and <inline-formula><mml:math id="n48"><mml:mrow><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) are collapsed into one path in red in the graph. (B) The initial positional de Bruijn graph is constructed with help from the read-to-contig alignment information. The read-to-reference genome alignment information yields a more complete positional de Bruijn graph, but the repetitive regions <italic>A</italic> and <inline-formula><mml:math id="n49"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (or <italic>C</italic> and <inline-formula><mml:math id="n50"><mml:mrow><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) are still collapsed resulting in branch points. (C) An extended positional de Bruijn graph is built by incorporating into each 3-mer the read alignment position to the contig. As a result of this operation, the repetitive regions <italic>C</italic> and <inline-formula><mml:math id="n51"><mml:mrow><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> can be distinguished into two paths, where the 3-mers have different alignment positions in the contig, but <italic>A</italic> and <inline-formula><mml:math id="n52"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are still collapsed. (D) The PE multipositional de Bruijn graph is constructed by incorporating into each 3-mer their PE read alignment positions to the reference genome (the right three bases and their alignment position to the contig is omitted here). With this information the repeats <italic>A</italic> and <inline-formula><mml:math id="n53"><mml:mrow><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> can be distinguished into two paths, as the 3-mers have different PE alignment positions in the reference genome. The final graph contains only one single path allowing to output an extended contig corresponding to the region <inline-formula><mml:math id="n54"><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in the target genome</p></caption><graphic xlink:href="btu291f2"/></fig></p>
      </sec>
      <sec>
        <title>(iii) Graph traversal returns extended contigs</title>
        <p>To remove errors, the de Bruijn graph needs to be edited before its traversal. The three major types of errors are tips, bubbles and erroneous connections (<xref rid="btu291-B3" ref-type="bibr">Chaisson and Pevzner, 2008</xref>; <xref rid="btu291-B24" ref-type="bibr">Peng <italic>et al.</italic>, 2010</xref>; <xref rid="btu291-B38" ref-type="bibr">Zerbino and Birney, 2008</xref>). Most of them are caused by errors in the reads. A tip is a short path with a dead end, whereas a bubble consists of two short paths sharing the same start and end nodes. Most of the tips and bubbles can be corrected by joining <italic>k</italic>-mers with <inline-formula><mml:math id="n55"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula> mismatches. The remaining errors can be removed by applying a coverage cut-off filter similar to the strategies used by most <italic>de novo</italic> assemblers. Because of the additional information encoded in the modified de Bruijn graph, one can use here a relatively small coverage threshold. After these error removal steps, the PE multipositional de Bruijn graph is traversed, using a breadth-first strategy, to generate the final contigs. Each traversal stops at a branch position and an extended contig is returned. After returning the extended contigs, the remaining unextended contigs (identical with initial <italic>de novo</italic> contigs) are provided to the user in a separate file. Finally, contigs with sufficient PE read connections and a path between them can be joined. Occasionally, those connections can be missed by the above filtering step because of too low read coverage in local areas of the connecting path.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Software implementation</title>
      <p>AlignGraph is implemented in C++ for Linux operating systems. Its required input includes the PE reads, the preassembled <italic>de novo</italic> contigs and the reference genome. Its output includes the extended contigs as well as the remaining non-extended contigs. AlignGraph runs the alignment steps with BLAT and Bowtie2 automatically, but both need to be installed on the system. AlignGraph’s run time is currently 23–57 min per million aligned reads. In the performance tests of this study, the memory usage was 36–50 GB, and it stays &lt;100 GB even for entire mammalian genomes. These requirements are more moderate than those of most <italic>de novo</italic> assemblers (<xref rid="btu291-B20" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>).</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 EVALUATION</title>
    <sec id="SEC3.1">
      <title>3.1 Experimental design</title>
      <sec>
        <title>Background</title>
        <p>To evaluate AlignGraph’s efficiency in improving genome assemblies, we performed a series of systematic performance tests. For this, we downloaded publicly available assemblies and/or assembled genomic PE read sets from organisms of variable genome complexity with seven widely used <italic>de novo</italic> assemblers, extended the resulting contigs with AlignGraph, and then evaluated the improvements with a set of standard metrics for comparing assembly results (<xref ref-type="table" rid="btu291-T2">Table 2</xref>). In these tests, it was important to choose the NGS read samples from organisms where the genome sequence of both the target genome and a close reference genome are known. This way one can evaluate the completeness and correctness of the results against a true result rather than one that is unknown or only partially known. To also assure the improvements obtained by AlignGraph are not simply the result of insufficient optimizations of the upstream <italic>de novo</italic> assembly, we included preassembled contig and scaffold sets that are widely accepted by the community as benchmark datasets for evaluating assembly software. Today’s requirements for assembling genomes from NGS were met by choosing read samples with ≥75 bp and PE read information. In total, we performed assembly tests on the following three sample sets.
<table-wrap id="btu291-T2" position="float"><label>Table 2.</label><caption><p>Performance evaluation of AlignGraph</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Upstream assembler</th><th rowspan="1" colspan="1">Contig set</th><th rowspan="1" colspan="1">N Contigs<sup>4</sup></th><th rowspan="1" colspan="1">N50<sup>5</sup></th><th rowspan="1" colspan="1">N covered bases<sup>6</sup></th><th rowspan="1" colspan="1">Average length<sup>7</sup></th><th rowspan="1" colspan="1">Maximum length<sup>8</sup></th><th rowspan="1" colspan="1">MPMB<sup>9</sup></th><th rowspan="1" colspan="1">Average identity<sup>10</sup> (%)</th></tr></thead><tbody align="left"><tr><td colspan="9" align="center" rowspan="1">(a) Contigs of <italic>A.thaliana</italic> genome</td></tr><tr><td rowspan="3" colspan="1">Velvet</td><td rowspan="1" colspan="1">All<sup>1</sup></td><td rowspan="1" colspan="1">30 037</td><td rowspan="1" colspan="1">3515</td><td rowspan="1" colspan="1">82 844 417</td><td rowspan="1" colspan="1">2668</td><td rowspan="1" colspan="1">27 792</td><td rowspan="1" colspan="1">22.2</td><td rowspan="1" colspan="1">95.2</td></tr><tr><td rowspan="1" colspan="1">Extendable<sup>2</sup></td><td rowspan="1" colspan="1">8615</td><td rowspan="1" colspan="1">4148</td><td rowspan="1" colspan="1">28 007 451</td><td rowspan="1" colspan="1">3262</td><td rowspan="1" colspan="1">27 398</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">97.6</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph<sup>3</sup></td><td rowspan="1" colspan="1">5751</td><td rowspan="1" colspan="1">7876</td><td rowspan="1" colspan="1">32 467 110</td><td rowspan="1" colspan="1">5521</td><td rowspan="1" colspan="1">49 768</td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">94.8</td></tr><tr><td rowspan="3" colspan="1">ABySS</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">30 972</td><td rowspan="1" colspan="1">2559</td><td rowspan="1" colspan="1">69 432 667</td><td rowspan="1" colspan="1">2206</td><td rowspan="1" colspan="1">29 760</td><td rowspan="1" colspan="1">13.4</td><td rowspan="1" colspan="1">97.2</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">11 693</td><td rowspan="1" colspan="1">2820</td><td rowspan="1" colspan="1">28 885 212</td><td rowspan="1" colspan="1">2454</td><td rowspan="1" colspan="1">16 343</td><td rowspan="1" colspan="1">0.5</td><td rowspan="1" colspan="1">98.7</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">8427</td><td rowspan="1" colspan="1">5484</td><td rowspan="1" colspan="1">35 859 786</td><td rowspan="1" colspan="1">4151</td><td rowspan="1" colspan="1">25 321</td><td rowspan="1" colspan="1">1.1</td><td rowspan="1" colspan="1">95.8</td></tr><tr><td colspan="9" align="center" rowspan="1">(b) Contigs of human chromosome 14</td></tr><tr><td rowspan="3" colspan="1">ALLPATHS-LG</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">4383</td><td rowspan="1" colspan="1">38 590</td><td rowspan="1" colspan="1">83 849 397</td><td rowspan="1" colspan="1">19 201</td><td rowspan="1" colspan="1">240 764</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">98.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">1674</td><td rowspan="1" colspan="1">39 851</td><td rowspan="1" colspan="1">35 746 095</td><td rowspan="1" colspan="1">20 806</td><td rowspan="1" colspan="1">200 495</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">98.9</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">785</td><td rowspan="1" colspan="1">71 847</td><td rowspan="1" colspan="1">36 441 001</td><td rowspan="1" colspan="1">45 358</td><td rowspan="1" colspan="1">305 880</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">97.5</td></tr><tr><td rowspan="3" colspan="1">ALLPATHS-LGc</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">3856</td><td rowspan="1" colspan="1">43 856</td><td rowspan="1" colspan="1">83 860 939</td><td rowspan="1" colspan="1">21 818</td><td rowspan="1" colspan="1">275 446</td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1">99.3</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">1296</td><td rowspan="1" colspan="1">45 719</td><td rowspan="1" colspan="1">31 457 201</td><td rowspan="1" colspan="1">24 346</td><td rowspan="1" colspan="1">275 446</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">99.5</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">608</td><td rowspan="1" colspan="1">86 613</td><td rowspan="1" colspan="1">34 614 465</td><td rowspan="1" colspan="1">54 406</td><td rowspan="1" colspan="1">294 615</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">96.9</td></tr><tr><td rowspan="3" colspan="1">SOAPdenovo</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">10 865</td><td rowspan="1" colspan="1">16 855</td><td rowspan="1" colspan="1">80 135 941</td><td rowspan="1" colspan="1">7623</td><td rowspan="1" colspan="1">147 494</td><td rowspan="1" colspan="1">5.9</td><td rowspan="1" colspan="1">94.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">5613</td><td rowspan="1" colspan="1">17 412</td><td rowspan="1" colspan="1">45 246 077</td><td rowspan="1" colspan="1">8223</td><td rowspan="1" colspan="1">141 981</td><td rowspan="1" colspan="1">0.9</td><td rowspan="1" colspan="1">96.4</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">3469</td><td rowspan="1" colspan="1">32 881</td><td rowspan="1" colspan="1">52 861 640</td><td rowspan="1" colspan="1">15 271</td><td rowspan="1" colspan="1">219 841</td><td rowspan="1" colspan="1">0.5</td><td rowspan="1" colspan="1">95.0</td></tr><tr><td rowspan="3" colspan="1">MaSuRCA</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">19 034</td><td rowspan="1" colspan="1">5767</td><td rowspan="1" colspan="1">75 497 302</td><td rowspan="1" colspan="1">3802</td><td rowspan="1" colspan="1">53 837</td><td rowspan="1" colspan="1">13.9</td><td rowspan="1" colspan="1">98.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">9241</td><td rowspan="1" colspan="1">6047</td><td rowspan="1" colspan="1">38 842 517</td><td rowspan="1" colspan="1">4199</td><td rowspan="1" colspan="1">51 249</td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1">99.2</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">5665</td><td rowspan="1" colspan="1">11 590</td><td rowspan="1" colspan="1">43 930 184</td><td rowspan="1" colspan="1">7666</td><td rowspan="1" colspan="1">66 758</td><td rowspan="1" colspan="1">0.4</td><td rowspan="1" colspan="1">98.1</td></tr><tr><td rowspan="3" colspan="1">CABOG</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">3118</td><td rowspan="1" colspan="1">46 523</td><td rowspan="1" colspan="1">84 989 190</td><td rowspan="1" colspan="1">27 401</td><td rowspan="1" colspan="1">296 888</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">97.3</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">1692</td><td rowspan="1" colspan="1">45 669</td><td rowspan="1" colspan="1">46 499 763</td><td rowspan="1" colspan="1">27 089</td><td rowspan="1" colspan="1">296 888</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">98.7</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">701</td><td rowspan="1" colspan="1">101 907</td><td rowspan="1" colspan="1">50 527 605</td><td rowspan="1" colspan="1">70 362</td><td rowspan="1" colspan="1">443 952</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">97.6</td></tr><tr><td rowspan="3" colspan="1">Bambus2</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">11 219</td><td rowspan="1" colspan="1">8378</td><td rowspan="1" colspan="1">64 011 072</td><td rowspan="1" colspan="1">5764</td><td rowspan="1" colspan="1">449 449</td><td rowspan="1" colspan="1">3.1</td><td rowspan="1" colspan="1">89.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">6995</td><td rowspan="1" colspan="1">7521</td><td rowspan="1" colspan="1">37 857 989</td><td rowspan="1" colspan="1">5439</td><td rowspan="1" colspan="1">62 798</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">97.6</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">2722</td><td rowspan="1" colspan="1">19 989</td><td rowspan="1" colspan="1">39 147 357</td><td rowspan="1" colspan="1">14 176</td><td rowspan="1" colspan="1">86 154</td><td rowspan="1" colspan="1">0.5</td><td rowspan="1" colspan="1">96.5</td></tr><tr><td colspan="9" align="center" rowspan="1">(c) Scaffolds of human chromosome 14</td></tr><tr><td rowspan="3" colspan="1">SOAPdenovo</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">3902</td><td rowspan="1" colspan="1">391 693</td><td rowspan="1" colspan="1">85 417 248</td><td rowspan="1" colspan="1">24 397</td><td rowspan="1" colspan="1">1 852 152</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1">82.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">901</td><td rowspan="1" colspan="1">387 309</td><td rowspan="1" colspan="1">40 296 035</td><td rowspan="1" colspan="1">47 526</td><td rowspan="1" colspan="1">1 019 659</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">84.5</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">767</td><td rowspan="1" colspan="1">544 209</td><td rowspan="1" colspan="1">47 823 279</td><td rowspan="1" colspan="1">63 525</td><td rowspan="1" colspan="1">2 246 638</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">81.0</td></tr><tr><td rowspan="3" colspan="1">MaSuRCA</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">721</td><td rowspan="1" colspan="1">580 822</td><td rowspan="1" colspan="1">65 433 305</td><td rowspan="1" colspan="1">63 876</td><td rowspan="1" colspan="1">2 943 966</td><td rowspan="1" colspan="1">1.3</td><td rowspan="1" colspan="1">57.2</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">101</td><td rowspan="1" colspan="1">289 703</td><td rowspan="1" colspan="1">5 554 781</td><td rowspan="1" colspan="1">52 820</td><td rowspan="1" colspan="1">1 516 804</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">81.9</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">78</td><td rowspan="1" colspan="1">316 946</td><td rowspan="1" colspan="1">6 986 224</td><td rowspan="1" colspan="1">86 552</td><td rowspan="1" colspan="1">1 573 741</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">83.4</td></tr><tr><td rowspan="3" colspan="1">CABOG</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">471</td><td rowspan="1" colspan="1">387 876</td><td rowspan="1" colspan="1">81 163 688</td><td rowspan="1" colspan="1">176 590</td><td rowspan="1" colspan="1">1 944 475</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">91.9</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">146</td><td rowspan="1" colspan="1">358 688</td><td rowspan="1" colspan="1">29 372 033</td><td rowspan="1" colspan="1">200 539</td><td rowspan="1" colspan="1">1 905 529</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">98.2</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">67</td><td rowspan="1" colspan="1">906 407</td><td rowspan="1" colspan="1">33 708 925</td><td rowspan="1" colspan="1">481 712</td><td rowspan="1" colspan="1">2 051 503</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">94.1</td></tr><tr><td rowspan="3" colspan="1">Bambus2</td><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">569</td><td rowspan="1" colspan="1">319 334</td><td rowspan="1" colspan="1">64 378 693</td><td rowspan="1" colspan="1">116 582</td><td rowspan="1" colspan="1">1 477 847</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">77.4</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">66</td><td rowspan="1" colspan="1">272 436</td><td rowspan="1" colspan="1">6 949 338</td><td rowspan="1" colspan="1">119 858</td><td rowspan="1" colspan="1">641 463</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">92.0</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">80</td><td rowspan="1" colspan="1">377 905</td><td rowspan="1" colspan="1">8 963 132</td><td rowspan="1" colspan="1">114 852</td><td rowspan="1" colspan="1">812 353</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">85.4</td></tr></tbody></table><table-wrap-foot><fn id="btu291-TF1"><p>(a) Genomic PE reads from <italic>A.thaliana</italic> were assembled with Velvet and ABySS. The resulting contigs were extended with AlignGraph using as reference the genome sequence from <italic>A.lyrata</italic>. (b–c) The subsequent panels contain assembly results for the human chromosome 14 sample from the GAGE project where the chimpanzee genome served as reference. (b) Contig assembly results are given for the <italic>de novo</italic> assemblers ALLPATHS-LG, ALLPATHS-LGc (in cheat mode), SOAPdenovo, MaSuRCA, CABOG and Bambus2. (c) Scaffolded assembly results are given for SOAPdenovo, MaSuRCA, CABOG and Bambus2. The results are organized row-wise as follows: the number of initial contigs obtained by each <italic>de novo</italic> assembler<sup>1</sup>, the ‘extendable' subset of the initial contigs that AlignGraph was able to improve<sup>2</sup>, and the extension results obtained with AlignGraph<sup>3</sup>. The additional columns give the number of contigs<sup>4</sup>, N50 values<sup>5</sup>, the number of covered bases<sup>6</sup>, the average<sup>7</sup>, and maximum<sup>8</sup> length of the contigs, the number of misassemblies per million base pairs (MPMB)<sup>9</sup>, and the average identity among the true contigs and the target genome<sup>10</sup>. More details on these performance criteria are provided in Section 3.1.5.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="SEC3.1.1">
        <title>3.1.1 Arabidopsis thaliana sample</title>
        <p>The first sample set was from the model organism <italic>A</italic><italic>rabidopsis thaliana</italic>, which is a flowering plant with a compact genome of 130 Mb in size. The PE read set chosen for this test is from a genomic Illumina NGS library with a read length of 2 × 75 bp. As <italic>de novo</italic> assemblers, we included in this test Velvet and ABySS, which we chose here as software representatives performing well on single library data and because of their good sensitivity and precision performance (<xref rid="btu291-B19" ref-type="bibr">Lin <italic>et al.</italic>, 2011</xref>). The VelvetOptimiser tool was used to optimize the parameter settings for the Velvet assembly. ABySS was run with the same <italic>k</italic>-mer length as Velvet, whereas the remaining parameters were set to their defaults. To extend the preassembled contigs with AlignGraph, we used the publicly available genome sequence from the related <italic>Arabidopsis lyrata</italic> species as reference [<xref ref-type="table" rid="btu291-T2">Table 2</xref>(a)]. The latter was chosen because it constitutes a more challenging reference genome for testing AlignGraph’s performance in improving genome assemblies than the references used in the other tests below. This is the case for the following reasons (<xref rid="btu291-B12" ref-type="bibr">Hu <italic>et al.</italic>, 2011</xref>): <italic>A.</italic><italic>lyrata</italic> and <italic>A.</italic><italic>thaliana</italic> diverged &gt;10 million years ago; their genomes differ by many regional rearrangements; the sequence similarity in the common regions of their genomes is only 80%; and the <italic>A.</italic><italic>lyrata</italic> genome sequence is still incomplete and fragmented into many scaffolds.</p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Human sample from Genome Assembly Gold-standard Evaluations</title>
        <p>The second sample set is from the community project GAGE (Genome Assembly Gold-standard Evaluations), from which we selected the sample for the human chromosome 14 (<xref rid="btu291-B31" ref-type="bibr">Salzberg <italic>et al.</italic>, 2012</xref>). Its Illumina sequences consist of PE reads with a length of 76–101 bp from three different libraries. We downloaded the preassembled contig sets provided by the GAGE project for the five assemblers that ranked highest in the benchmark tests by <xref rid="btu291-B31" ref-type="bibr">Salzberg <italic>et al.</italic> (2012)</xref> in assemblies from multiple genome libraries with variable insert lengths. Those included ALLPATHS-LG, SOAPdenovo, MaSuRCA, CABOG and Bambus2. As reference sequence for guiding AlignGraph, we used the chimpanzee genome. For ALLPATH-LG in its <italic>cheat</italic> mode, we reassembled the contigs ourselves because this assembler exhibits a better sensitivity and precision performance when providing a closely related reference genome. Here it was important to compare the performance of ALLPATHS-LG with AlignGraph when both are guided by the same reference genome.</p>
        <p>In addition to contigs, we evaluated AlignGraph’s performance in improving the scaffold sets provided by the GAGE project for the same human sample set. Before their reassembly with AlignGraph, we reduced the number of unresolved sequence regions (gaps filled with ambiguous N bases) in the scaffolds by applying the GapFiller algorithm, which is currently one of the most efficient gap-filling methods (<xref rid="btu291-B1" ref-type="bibr">Boetzer and Pirovano, 2012</xref>).</p>
        <p>To also evaluate the influence of the similarity shared among the reference and target genomes on AlignGraph’s performance, we included tests with four reference genomes of variable similarity to the human genome. The reference genomes chosen for this test were from gorilla, orangutan, gibbon and macaque. The genome sequence from gibbon was the only one that is still incomplete containing scaffolds rather than fully assembled chromosomes.</p>
      </sec>
      <sec id="SEC3.1.3">
        <title>3.1.3 Published genome</title>
        <p>In addition to the tests above, we were interested in evaluating to what extent AlignGraph can improve the genome sequence generated with another reference assisted assembly approach. For this test, we chose the published genome sequence from Landsberg <italic>erecta</italic> (L<italic>er</italic>-1; <xref rid="btu291-B33" ref-type="bibr">Schneeberger <italic>et al.</italic>, 2011</xref>). The latter is a strain of <italic>A.</italic><italic>thaliana</italic>, which is too diverged from the known references to resolve its genome sequence with a simple resequencing approach. Thus, <xref rid="btu291-B33" ref-type="bibr">Schneeberger <italic>et al.</italic> (2011)</xref> assembled its genome with a reference-assisted pipeline approach that included ALLPATHS-LG and several refinement steps.</p>
      </sec>
      <sec id="SEC3.1.4">
        <title>3.1.4 Data sources</title>
        <p>The genome sequences used in the above tests were downloaded from the following community sites: <italic>A.</italic><italic>thaliana</italic> from TAIR, <italic>A.</italic><italic>lyrata</italic> from JGI, Landsberg <italic>erecta</italic> from 1001 Genomes and human and other primates from Ensembl. From the GAGE site, we downloaded the PE read sets and the preassembled contigs and scaffolds for the human chromosome 14 sample (<xref rid="btu291-B31" ref-type="bibr">Salzberg <italic>et al.</italic>, 2012</xref>). The PE read sets from <italic>A.</italic><italic>thaliana</italic> and Landsberg <italic>erecta</italic> were downloaded from NCBI’s Sequence Read Archive and the 1001 Genome site, respectively. The <italic>A.</italic><italic>thaliana</italic> read set contained 32 million 2 × 75 bp PE reads (accession: SRR073127), the human read set contained 62 million 2 × 76–101 bp PE reads and the L<italic>er</italic>-1 read set contained 73 million 2 × 40–101 bp PE reads.</p>
      </sec>
      <sec id="SEC3.1.5">
        <title>3.1.5 Performance measurements</title>
        <p>Most of the performance measures used by this study are adapted from the GAGE project (<xref rid="btu291-B31" ref-type="bibr">Salzberg <italic>et al.</italic>, 2012</xref>). To evaluate the completeness of the contigs, we aligned them to the target genome with BLAT. If a contig could not be aligned as a single global alignment, it was split according to the local alignment results into the smallest possible number of subcontigs. The resulting contigs are called <italic>true contigs</italic>. The precision measures include the number of misassemblies per million base pairs (MPMB) and the average identity between contigs and target genome. Misassemblies caused by misjoin errors result in chimeric contigs. Their number can be calculated as the number of splits necessary to obtain the true contigs. Thus, MPMB <inline-formula><inline-graphic xlink:href="btu291i1.jpg"/></inline-formula>, where <italic>m</italic> is the numbers of misassemblies, and <italic>L</italic> is the cumulative length of the contigs. The average identity between true contigs and the target genome is calculated as <inline-formula><inline-graphic xlink:href="btu291i2.jpg"/></inline-formula> where <italic>t<sub>i</sub></italic> is the identity for contig <italic>i</italic>, and <italic>l<sub>i</sub></italic> is the length of contig <italic>i</italic> (0 &lt;<italic>i</italic>≤<italic>n</italic>). In this formula, the identity <italic>t<sub>i</sub></italic> of the true contigs <italic>i</italic> is calculated as the number of aligned bases over the length of the alignment. The sensitivity measures include the N50 value and the number of covered bases. The former is the contig size at 50% of the total number of contig bases, and the latter is the total number of genome bases covered by the contigs. Two additional measures are the average length and maximum length of the true contigs. In all tests, we considered only contigs with a length of at least 1000 bp but used the entire set (including the shorter ones) in AlignGraph’s extension steps.</p>
      </sec>
    </sec>
    <sec sec-type="results">
      <title>3.2 Results</title>
      <sec id="SEC3.2.1">
        <title>3.2.1 Extension of A.thaliana contigs</title>
        <p>The performance test results for the <italic>A.</italic><italic>thaliana</italic> dataset are given in <xref ref-type="table" rid="btu291-T2">Table 2</xref>(a). In comparison with the initial contig sets assembled by Velvet or ABySS, AlignGraph extends 28.7–37.8% of them when guided by the <italic>A.</italic><italic>lyrata</italic> genome as reference. The resulting set of extended contigs contains 27.9–33.2% less sequences because AlignGraph has joined many of the initial contigs. This leads to improvements of the N50, the number of covered bases, average contig length and maximum contig length for the extendable contig set by 89.9–94.5%, 15.9–24.1%, 69.3–69.2% and 54.9–81.6%, respectively. These improvements are accompanied only by minor increases of MPMB errors. The MPMB values of the extendable and extended contigs are usually much lower than for the complete set because of their pre-filtered nature that improves their quality. As expected the average identity also drops slightly (2.8–2.9%) because with increased length of the assembled sequences, internal sequence variations accumulate and complicate the alignment of the extended contigs against the target genome. A similar trend can be seen in the results below for the much longer scaffolds where the average identity is always lower for all of the tested assemblers [<xref ref-type="table" rid="btu291-T2">Table 2</xref>(c)]. For all three sample sets (Sections 3.2.1–3.2.4), the AlignGraph results contain a comparable number of sequence variations to the target genomes as the results of <italic>de novo</italic> assemblers (data not shown). This indicates a high sequence quality of the reassembled contigs.</p>
      </sec>
      <sec id="SEC3.2.2">
        <title>3.2.2 Extension of human contigs and scaffolds from GAGE</title>
        <p>The test results for the human chromosome 14 contigs are given in <xref ref-type="table" rid="btu291-T2">Table 2</xref>(b). Of the contigs assembled by ALLPATHS-LG, 38.2% can be extended and the extension result contains 53.1% less contigs because of the joins generated by AlignGraph. These improvements are more pronounced than in the above experiment with <italic>A.</italic><italic>lyrata</italic> as reference because the genomes of human and chimpanzee share a much higher sequence similarity than the genomes of <italic>A.</italic><italic>thaliana</italic> and <italic>A.</italic><italic>lyrata</italic>. The N50, the number of covered bases, average contig length and maximum contig length for the extendable contig set consistently improve by 80.3, 1.9, 118.0 and 52.6%, respectively. Similar results could be obtained with the other <italic>de novo</italic> assemblers SOAPdenovo, MaSuRCA, CABOG and Bambus2. After AlignGraph processing, their extendable contigs improved for the same four evaluation metrics by 88.8–165.8, 3.4–16.8, 82.6–160.6 and 30.3–54.8%, respectively. If ALLPATHS-LG is run in its cheat mode by guiding it with the same reference genome as AlignGraph, then both the sensitivity and precision measures of the ALLPATHS-LGc contigs improve compared with the assembly without a reference. Nevertheless, AlignGraph is still able to extend 33.6% of the ALLPATHS-LGc contigs, and the extension results contain 53.1% less contigs, whereas the four evaluation metrics improve by 89.4, 10.0, 123.5 and 7.0%, respectively. These improvements indicate that the reference-assisted approach used by AlignGraph is more efficient than the one from ALLPATHS-LG in its cheat mode at the contig assembly stage.</p>
        <p>AlignGraph’s performance results on the scaffolds from the same human chromosome 14 dataset are given in <xref ref-type="table" rid="btu291-T2">Table 2</xref>(c). The scaffold sets from SOAPdenovo, MaSuRCA, CABOG and Bambus2 contain much smaller numbers of sequences than their corresponding contig sets. Nevertheless, AlignGraph is able to extend 11.6–31.0% of them and improve the N50 value and the number of covered bases by 9.4–152.7 and 14.8–29.0%, respectively. The extension results for the scaffold set of Bambus2 contain a slightly larger number of sequences (14) than the extendable set. The reason for this is that many of them are short, and AlignGraph extends them often to scaffolds with a length above the 1000 bp requirement, thus increasing the number of reported scaffolds (see Section 3.1.5). This trend also explains the slightly lower average length of the extended scaffold set from Bambus2.</p>
      </sec>
      <sec id="SEC3.2.3">
        <title>3.2.3 Influence of similarity of reference genome</title>
        <p>To assess AlignGraph’s performance with reference genomes of variable similarity to the target genome, we post-processed the <italic>de novo</italic> assemblies of the human dataset with AlignGraph using as reference the genome sequences from five different primates. The columns in <xref ref-type="table" rid="btu291-T3">Table 3</xref> list these organisms according to their evolutionary distances to the human genome (increasing from left to right). To avoid confusions, exact sequence similarity values to the human genome are not provided because there are many possibilities to calculate them, which can lead to different results. As expected, the performance measures degrade with the evolutionary distance between the target and reference genomes. Although the first four reference genomes show respectable improvements, the macaque genome seems to be too diverged from human to achieve any major improvements. However, this performance drop is mainly due to the difficulty of aligning short reads to a highly diverged reference. Future improvements in NGS read length and alignment algorithms are likely to enhance AlignGraph’s performance in this regard.
<table-wrap id="btu291-T3" position="float"><label>Table 3.</label><caption><p>Performance with reference genomes of variable similarity</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Percentage of</th><th rowspan="1" colspan="1">Chimpanzee</th><th rowspan="1" colspan="1">Gorilla</th><th rowspan="1" colspan="1">Orangutan</th><th rowspan="1" colspan="1">Gibbon</th><th rowspan="1" colspan="1">Macaque</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Aligned reads<xref ref-type="table-fn" rid="btu291-TF4"><sup>a</sup></xref></td><td rowspan="1" colspan="1">94.5%</td><td rowspan="1" colspan="1">91.6%</td><td rowspan="1" colspan="1">88.9%</td><td rowspan="1" colspan="1">49.9%</td><td rowspan="1" colspan="1">24.9%</td></tr><tr><td rowspan="1" colspan="1">Extendable contigs<sup>b</sup></td><td rowspan="1" colspan="1">51.0%</td><td rowspan="1" colspan="1">36.4%</td><td rowspan="1" colspan="1">24.9%</td><td rowspan="1" colspan="1">6.7%</td><td rowspan="1" colspan="1">—</td></tr><tr><td rowspan="1" colspan="1">Improved N50<sup>c</sup></td><td rowspan="1" colspan="1">109.9%</td><td rowspan="1" colspan="1">84.0%</td><td rowspan="1" colspan="1">73.2%</td><td rowspan="1" colspan="1">65.3%</td><td rowspan="1" colspan="1">—</td></tr></tbody></table><table-wrap-foot><fn id="btu291-TF4"><p>The tests were performed on the human chromosome 14 sample where the listed primate genomes served as reference. The results include the percentage values of <sup>a</sup>alignable reads, <sup>b</sup>Extendable contigs relative to the initial set <sup>c</sup>Improvements of the N50 values relative to the extendable contigs. Because of space limitations, the latter two rows contain averaged percentage values for the five assemblers ALLPATHS-LG, SOAPdenovo, MaSuRCA, CABOG and Bambus2.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="SEC3.2.4">
        <title>3.2.4 Improvements to published genome</title>
        <p>The test results for the published Landsberg <italic>erecta</italic> genome are shown in <xref ref-type="table" rid="btu291-T4">Table 4</xref>. The initial scaffold set used in this test consisted of 1676 sequences. AlignGraph extended 27.6% of these scaffolds, whereas the extended set contains 20.3% fewer scaffolds. In addition, AlignGraph improves the N50 value, the number of covered bases, the average contig length and maximum length values for the extendable scaffolds by 86.6, 8.1, 35.7 and 8.1%, respectively. These improvements demonstrate AlignGraph’s usefulness in improving published genome sequences, even for those that have been carefully curated by their authors.
<table-wrap id="btu291-T4" position="float"><label>Table 4.</label><caption><p>Improvements to published genome</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Contig set</th><th rowspan="1" colspan="1">N contigs</th><th rowspan="1" colspan="1">N50</th><th rowspan="1" colspan="1">N total bases<xref ref-type="table-fn" rid="btu291-TF6"><sup>a</sup></xref></th><th rowspan="1" colspan="1">Average length</th><th rowspan="1" colspan="1">Maximum length</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">All</td><td rowspan="1" colspan="1">1676</td><td rowspan="1" colspan="1">341 653</td><td rowspan="1" colspan="1">112 578 343</td><td rowspan="1" colspan="1">67 170</td><td rowspan="1" colspan="1">2 930 180</td></tr><tr><td rowspan="1" colspan="1">Extendable</td><td rowspan="1" colspan="1">462</td><td rowspan="1" colspan="1">448 682</td><td rowspan="1" colspan="1">57 574 961</td><td rowspan="1" colspan="1">124 621</td><td rowspan="1" colspan="1">2 930 180</td></tr><tr><td rowspan="1" colspan="1">Extendable + AlignGraph</td><td rowspan="1" colspan="1">368</td><td rowspan="1" colspan="1">837 458</td><td rowspan="1" colspan="1">62 216 675</td><td rowspan="1" colspan="1">169 067</td><td rowspan="1" colspan="1">3 168 537</td></tr></tbody></table><table-wrap-foot><fn id="btu291-TF6"><p>The published scaffolds from Landsberg <italic>erecta</italic> were extended with AlignGraph using the <italic>A.thaliana</italic> genome as reference. The rows and columns are arranged the same way as in <xref ref-type="table" rid="btu291-T2">Table 2</xref>, but several columns are missing here because it is not possible to compute the corresponding performance measures in a meaningful manner without having access to a ‘true’ target genome sequence. <sup>a</sup>In addition, we report here the total number of bases in the contigs.</p></fn></table-wrap-foot></table-wrap></p>
        <p>In summary, the above performance tests demonstrate AlignGraph’s efficiency in improving the results of a variety of <italic>de novo</italic> assemblers and species with variable genome complexity by taking advantage of closely related reference genomes.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 CONCLUSIONS AND FUTURE WORK</title>
    <p>This study introduces a novel de Bruijn graph-based algorithm for improving <italic>de novo</italic> genome assemblies guided by sequence information from a closely related species. The chosen PE multipositional de Bruijn graph approach provides an elegant and efficient solution to this problem. Our performance results demonstrate that the implemented AlignGraph software is able to improve the results of a wide range of <italic>de novo</italic> assemblers for complex genomes even with relatively diverse and suboptimal guide sequences as reference. Moreover, our results demonstrate AlignGraph’s usefulness for improving unfinished genome assemblies. Another advantage is that AlignGraph can be used in combination with most existing <italic>de novo</italic> assemblers. In the future, we will expand AlignGraph in the following areas: (i) we will provide support for additional variant-aware alignment tools for both PE read and contig data, such as GSNAP and GMAP, respectively, (ii) <italic>de novo</italic> assembly functionality will be added to AlignGraph to further optimize assemblies at many stages of the reference-assisted workflow, (iii) utilities will be incorporated for detecting and resolving misassemblies either in the initial contigs or in the extensions and (iv) the processing of scaffolds with large gaps will be improved.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors acknowledge the support of the core facilities at the Institute for Integrative Genome Biology (IIGB) at University of California (UC), Riverside.</p>
    <p><italic>Funding</italic>: The <funding-source>USDA National Institute for Food and Agriculture</funding-source> (<award-id>NIFA-2010-65106-20675</award-id> to T.G.) and the <funding-source>National Science Foundation</funding-source> (<award-id>ABI-0957099</award-id> to T.G., <award-id>IOB-0420152</award-id> to T.G., <award-id>MCB-1021969</award-id> to T.G. and <award-id>DBI-1262107</award-id> to T.J.).</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu291-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boetzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pirovano</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Toward almost closed genomes with gapfiller</article-title>
        <source>Genome Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R56</fpage>
        <pub-id pub-id-type="pmid">22731987</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boetzer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scaffolding pre-assembled contigs using sspace</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>578</fpage>
        <lpage>579</lpage>
        <pub-id pub-id-type="pmid">21149342</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Short read fragment assembly of bacterial genomes</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>324</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="pmid">18083777</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> fragment assembly with short mate-paired reads: does the read length matter?</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>336</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="pmid">19056694</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dayarian</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sopra: scaffolding algorithm for paired reads via statistical optimization</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>345</fpage>
        <pub-id pub-id-type="pmid">20576136</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sharcgs, a fast and highly accurate short-read assembly algorithm for <italic>de novo</italic> genomic sequencing</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1697</fpage>
        <lpage>1706</lpage>
        <pub-id pub-id-type="pmid">17908823</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opera: reconstructing optimal genomic scaffolds with high-throughput paired-end sequences</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1681</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="pmid">21929371</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnerre</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assisted assembly: how to improve a <italic>de novo</italic> genome assembly by using related species</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R88</fpage>
        <pub-id pub-id-type="pmid">19712469</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnerre</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>1513</fpage>
        <lpage>1518</lpage>
        <pub-id pub-id-type="pmid">21187386</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gritsenko</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Grass: a generic algorithm for scaffolding next-generation sequencing assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1429</fpage>
        <lpage>1437</lpage>
        <pub-id pub-id-type="pmid">22492642</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernandez</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> bacterial genome sequencing: millions of very short reads assembled on a desktop computer</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>802</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="pmid">18332092</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>TT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The <italic>Arabidopsis lyrata</italic> genome sequence and the basis of rapid genome size change</article-title>
        <source>Nat. Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>476</fpage>
        <lpage>481</lpage>
        <pub-id pub-id-type="pmid">21478890</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeck</surname>
            <given-names>WR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extending assembly of short DNA sequences to handle error</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2942</fpage>
        <lpage>2944</lpage>
        <pub-id pub-id-type="pmid">17893086</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Blatthe blast-like alignment tool</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-assisted chromosome assembly</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>1785</fpage>
        <lpage>1790</lpage>
        <pub-id pub-id-type="pmid">23307812</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with bowtie 2</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A survey of sequence alignment algorithms for next-generation sequencing</article-title>
        <source>Brief. Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>473</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="pmid">20460430</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> assembly of human genomes with massively parallel short read sequencing</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>265</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="pmid">20019144</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative studies of <italic>de novo</italic> assembly tools for next-generation sequencing technologies</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2031</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="pmid">21636596</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Soapdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="pmid">23587118</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Paired de bruijn graphs: a novel approach for incorporating mate pair information into genome assemblers</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1625</fpage>
        <lpage>1634</lpage>
        <pub-id pub-id-type="pmid">21999285</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aggressive assembly of pyrosequencing reads with mates</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2818</fpage>
        <lpage>2824</lpage>
        <pub-id pub-id-type="pmid">18952627</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ossowski</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of natural strains of <italic>Arabidopsis thaliana</italic> with short reads</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>2024</fpage>
        <lpage>2033</lpage>
        <pub-id pub-id-type="pmid">18818371</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B24">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Idba–a practical iterative de bruijn graph <italic>de novo</italic> assembler</article-title>
        <source>Research in Computational Molecular Biology</source>
        <year>2010</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>426</fpage>
        <lpage>440</lpage>
      </element-citation>
    </ref>
    <ref id="btu291-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An eulerian path approach to dna fragment assembly</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>9748</fpage>
        <pub-id pub-id-type="pmid">11504945</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome assembly forensics: finding the elusive mis-assembly</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R55</fpage>
        <pub-id pub-id-type="pmid">18341692</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative genome assembly</article-title>
        <source>Brief. Bioinform.</source>
        <year>2004a</year>
        <volume>5</volume>
        <fpage>237</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="pmid">15383210</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hierarchical scaffolding with bambus</article-title>
        <source>Genome Res.</source>
        <year>2004b</year>
        <volume>14</volume>
        <fpage>149</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="pmid">14707177</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronen</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequel: improving the accuracy of genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>i188</fpage>
        <lpage>i196</lpage>
        <pub-id pub-id-type="pmid">22689760</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salmela</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast scaffolding with small independent mixed integer programs</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>3259</fpage>
        <lpage>3265</lpage>
        <pub-id pub-id-type="pmid">21998153</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gage: a critical evaluation of genome assemblies and assembly algorithms</article-title>
        <source>Genome Res.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>557</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="pmid">22147368</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hawkeye and AMOS: visualizing and assessing the quality of genome assemblies</article-title>
        <source>Brief. Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>213</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">22199379</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneeberger</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-guided assembly of four diverse <italic>Arabidopsis thaliana</italic> genomes</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>10249</fpage>
        <lpage>10254</lpage>
        <pub-id pub-id-type="pmid">21646520</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Abyss: a parallel assembler for short read sequence data</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1117</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsai</surname>
            <given-names>IJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Method improving draft assemblies by iterative mapping and assembly of short reads to eliminate gaps</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R41</fpage>
        <pub-id pub-id-type="pmid">20388197</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembling millions of short DNA sequences using ssake</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>500</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="pmid">17158514</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeitouni</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SVDetect: a tool to identify genomic structural variations from paired-end and mate-pair sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1895</fpage>
        <lpage>1896</lpage>
        <pub-id pub-id-type="pmid">20639544</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="btu291-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimin</surname>
            <given-names>AV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The masurca genome assembler</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2669</fpage>
        <lpage>2677</lpage>
        <pub-id pub-id-type="pmid">23990416</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
