<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD with MathML3 v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1-mathml3.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat Biotechnol?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9604648</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">20305</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Biotechnol</journal-id>
    <journal-title-group>
      <journal-title>Nature biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1087-0156</issn>
    <issn pub-type="epub">1546-1696</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9288987</article-id>
    <article-id pub-id-type="pmid">35177836</article-id>
    <article-id pub-id-type="doi">10.1038/s41587-022-01211-7</article-id>
    <article-id pub-id-type="manuscript">nihpa1769925</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A comparison of experimental assays and analytical methods for genome-wide identification of active enhancers</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yao</surname>
          <given-names>Li</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Jin</given-names>
        </name>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ozer</surname>
          <given-names>Abdullah</given-names>
        </name>
        <xref rid="A3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leung</surname>
          <given-names>Alden King-Yung</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lis</surname>
          <given-names>John T.</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A3" ref-type="aff">3</xref>
        <xref rid="CR1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Haiyuan</given-names>
        </name>
        <xref rid="A1" ref-type="aff">1</xref>
        <xref rid="A2" ref-type="aff">2</xref>
        <xref rid="CR1" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Computational Biology, Cornell University, Ithaca, NY 14853.</aff>
    <aff id="A2"><label>2</label>Weill Institute for Cell and Molecular Biology, Cornell University, Ithaca, NY 14853.</aff>
    <aff id="A3"><label>3</label>Department of Molecular Biology and Genetics, Cornell University, Ithaca, NY 14853.</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1">Author Contributions Statement</p>
        <p id="P2">Conceptualization: L.Y., J.T.L., and H.Y.; Methodology: L.Y.; Software: L.Y.; Formal analysis: L.Y.; Investigation: J.L.; Data curation: L.Y., J.L., and A.K.Y.L.; Writing – Original Draft: L.Y., and J. L.; Writing – Review &amp; Editing: J.L., A.O., J.T.L., and H.Y.; Visualization: L.Y., J.L., A.O., and H.Y.; Supervision: J.T.L., and H.Y.</p>
      </fn>
      <corresp id="CR1"><label>*</label>Correspondence to: <email>jonhlis@cornell.edu</email> (J.T.L) and <email>haiyuan.yu@cornell.edu</email> (H.Y.).</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>15</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>40</volume>
    <issue>7</issue>
    <fpage>1056</fpage>
    <lpage>1065</lpage>
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use: <uri xlink:href="https://www.springernature.com/gp/open-research/policies/accepted-manuscript-terms">https://www.springernature.com/gp/open-research/policies/accepted-manuscript-terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P3">Mounting evidence supports the idea that transcriptional patterns serve as more specific identifiers of active enhancers than histone marks; however, the optimal strategy to identify active enhancers both experimentally and computationally has not been determined. Here, we compared 13 genome-wide RNA sequencing assays in K562 cells and showed that the nuclear run-on followed by cap-selection assay (GRO/PRO-cap) has advantages in eRNA detection and active enhancer identification. We also introduced a tool, Peak Identifier for Nascent Transcript Starts (PINTS), to identify active promoters and enhancers genome-wide and pinpoint the precise location of the 5′ transcription start sites. Finally, we compiled a comprehensive enhancer candidate compendium based on the detected eRNA TSSs available in 120 cell and tissue types that can be accessed at <ext-link xlink:href="https://pints.yulab.org/" ext-link-type="uri">https://pints.yulab.org</ext-link>. With the knowledge of the best available assays and pipelines, this large-scale annotation of candidate enhancers will pave the way for selection and characterization of their functions in a time- and labor-efficient manner in the future.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p id="P4">Regulation of transcription is a synergetic process requiring both trans-regulatory factors, like transcription factors, and cis-regulatory elements, like promoters and enhancers. In contrast to promoters, which initiate transcription in their proximal regions to produce stable RNA products, enhancers regulate their target gene(s) distally. Certain epigenomic signatures (enrichment of H3K4me1 and H3K27ac, high chromatin accessibility, and CBP/p300 binding) are considered to be defining features of active enhancer loci<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref></sup>. However, studies also revealed that enhancers could themselves produce relatively short-lived divergent transcripts, called enhancer RNAs (eRNAs)<sup><xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R4" ref-type="bibr">4</xref></sup>. More recent studies further showed that distal divergent transcription events are more reliable marks for active enhancers than epigenomic signatures<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>. Recently we have proposed<sup><xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup> and later experimentally verified<sup><xref rid="R6" ref-type="bibr">6</xref></sup> the basic unit of active enhancers that are defined by the transcription start sites (TSSs) of the divergent eRNA transcription, and delimited by the promoter-proximal RNA polymerase II (Pol II) pause sites flanking these TSSs. Therefore, to identify active enhancers genome-wide, it is critical to detect eRNAs and their TSSs with high sensitivity and specificity.</p>
    <p id="P5">eRNAs are usually in extremely low abundance in cells due to their short half-lives. Therefore, conventional RNA-seq experiments capture eRNAs with very low efficiency<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. Recently, two categories of genome-wide RNA sequencing assays have been developed, focusing either on TSSs or on the actively-transcribing polymerase positions (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). We named 8 assays (GRO<sup><xref rid="R9" ref-type="bibr">9</xref></sup>/PRO-cap<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, CoPRO<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, Start-seq<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, CAGE<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, RAMPAGE<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, NET-CAGE<sup><xref rid="R14" ref-type="bibr">14</xref></sup>, csRNA-seq<sup><xref rid="R15" ref-type="bibr">15</xref></sup>, and STRIPE-seq<sup><xref rid="R16" ref-type="bibr">16</xref></sup>) from the former category as TSS-assays, because these assays enrich for active 5′ TSSs of promoters and enhancers (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). We also named 5 assays (GRO-seq<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, PRO-seq<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, mNET-seq<sup><xref rid="R18" ref-type="bibr">18</xref></sup>, Bru-seq<sup><xref rid="R19" ref-type="bibr">19</xref></sup>, and BruUV-seq<sup><xref rid="R20" ref-type="bibr">20</xref></sup>) from the latter category as Nascent Transcript-assays (NT-assays), because they are designed to trace the elongation or pause status of the polymerases and capture their products (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). To enrich for RNA populations of interests, these assays implement various experimental strategies, including nuclei/chromatin isolation<sup><xref rid="R8" ref-type="bibr">8</xref>–<xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R18" ref-type="bibr">18</xref></sup>, nuclear run-on<sup><xref rid="R8" ref-type="bibr">8</xref>–<xref rid="R10" ref-type="bibr">10</xref></sup> or metabolic labeling<sup><xref rid="R19" ref-type="bibr">19</xref>,<xref rid="R20" ref-type="bibr">20</xref></sup> with biotin or bromo-tagged nucleotides and affinity purification, Pol II immunoprecipitation<sup><xref rid="R18" ref-type="bibr">18</xref></sup>, size selection<sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>, and enzymatic elimination of non-capped RNAs<sup><xref rid="R8" ref-type="bibr">8</xref>–<xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>, or chemical tagging of capped RNAs<sup><xref rid="R12" ref-type="bibr">12</xref>–<xref rid="R14" ref-type="bibr">14</xref></sup>. We summarized key experimental steps of both TSS- and NT-assays in <xref rid="F1" ref-type="fig">Fig. 1b</xref>. In fact, the list of all assays compared here, plus total RNA-seq<sup><xref rid="R21" ref-type="bibr">21</xref>,<xref rid="R22" ref-type="bibr">22</xref></sup>, have all been used in some capacity to identify enhancer elements. However, considering that most of these assays are not specifically designed to capture eRNAs, caution should be taken when exploiting these assays and their data to identify active enhancers.</p>
    <p id="P6">Because these assays were initially designed for different purposes, various computational tools were developed for exploring and interpreting the raw experimental data—for example, Tfit<sup><xref rid="R23" ref-type="bibr">23</xref></sup>, dREG<sup><xref rid="R24" ref-type="bibr">24</xref>,<xref rid="R25" ref-type="bibr">25</xref></sup>, and dREG.HD<sup><xref rid="R26" ref-type="bibr">26</xref></sup> were developed to identify transcriptional regulatory elements (TREs) from some NT-assays, including GRO-seq and PRO-seq; FivePrime<sup><xref rid="R27" ref-type="bibr">27</xref></sup> (based on paraclu<sup><xref rid="R28" ref-type="bibr">28</xref></sup>), GROcapTSSHMM<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, and HOMER<sup><xref rid="R15" ref-type="bibr">15</xref></sup> were introduced for analyzing data from CAGE, GRO-cap, and csRNA-seq, respectively. While all these tools can potentially be used to identify eRNA transcription and active enhancers, there has not been a systematic evaluation and comparison of their performance with datasets generated by the aforementioned experimental assays.</p>
    <p id="P7">In this study, we systematically examined 13 experimental assays, including seven TSS-assays, five NT-assays, and total RNA-seq (as the outgroup), in terms of their sensitivity and specificity for capturing eRNAs. We also developed a computational tool, Peak Identifier for Nascent Transcript Starts (PINTS), which is designed to identify enhancer candidates from these assays. Moreover, by comparing PINTS with 8 other widely-used computational tools, we found that PINTS gave the highest overall performance pertaining to robustness, sensitivity, and specificity, especially when analyzing data from TSS-assays. Finally, we constructed a comprehensive enhancer candidate compendium for 120 cells and tissues using the robust and unified definition of active enhancers based on detected eRNA TSSs genome-wide<sup><xref rid="R5" ref-type="bibr">5</xref>–<xref rid="R7" ref-type="bibr">7</xref></sup>, and developed an online web server (<ext-link xlink:href="https://pints.yulab.org/" ext-link-type="uri">https://pints.yulab.org/</ext-link>) to navigate, prioritize, and analyze enhancers based on a wide range of genomic and epigenomic annotations. We expect our enhancer compendium will be a valuable resource to the research community for the effective selection of candidate enhancers for further functional characterization.</p>
  </sec>
  <sec id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>TSS-assays are more sensitive in eRNA detection</title>
      <p id="P8">To perform a quantitative comparison of eRNA detection sensitivity, we first normalized all libraries by downsampling them to the same sequencing depth as the library with the lowest depth (18.9 million mappable reads, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>). We then compared the assays’ sensitivity by examining their coverage in 803 (635 intergenic, 113 intronic, and 55 others) previously identified bona fide enhancers that were validated by CRISPR/Cas9-mediated deletion and CRISPRi in K562 cells<sup><xref rid="R29" ref-type="bibr">29</xref>–<xref rid="R37" ref-type="bibr">37</xref></sup> (“CRISPR-identified enhancer set”, <xref rid="S13" ref-type="sec">Methods</xref>, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>). With the same sequencing depth, GRO-cap ranks first in sensitivity: it covers 86.6% of CRISPR-identified enhancers (70.4% divergent: ≥ 5 reads detected from both strands and 16.2% unidirectional: ≥ 5 reads detected only on one strand; <xref rid="F2" ref-type="fig">Fig. 2a</xref> and top track in <xref rid="F7" ref-type="fig">Extended Data Fig. 1a</xref>). csRNA-seq comes in second place with 73.7% (47.3% divergent and 26.4% unidirectional) coverage of these validated enhancers (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="F7" ref-type="fig">Extended Data Fig. 1a</xref>). We re-evaluated the sensitivity of the 13 assays using another set of reference enhancers (previously validated by Massively Parallel Reporter Assay [MPRA]<sup><xref rid="R38" ref-type="bibr">38</xref>–<xref rid="R42" ref-type="bibr">42</xref></sup> and Self-Transcribing Active Regulatory Region Sequencing [STARR-seq]<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R43" ref-type="bibr">43</xref>–<xref rid="R45" ref-type="bibr">45</xref></sup>), and the results remain the same (<xref rid="F7" ref-type="fig">Extended Data Fig. 1a</xref>, bottom track). Furthermore, to test the robustness of our conclusion, we also evaluated assay sensitivity of 8 assays that have data available in another cell line, GM12878, using STARR-seq-identified enhancers as reference<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R46" ref-type="bibr">46</xref></sup>. As with K562 (<xref rid="F7" ref-type="fig">Extended Data Fig. 1a</xref>), GRO-cap is the most sensitive assay to detect active enhancers in GM12878 (<xref rid="F7" ref-type="fig">Extended Data Fig. 1b</xref>).</p>
      <p id="P9">We further evaluated the sensitivity of these assays by their ability to capture unstable transcripts. eRNAs are usually less stable than mRNAs and this is the case here seen by comparing decay rates of transcripts<sup><xref rid="R47" ref-type="bibr">47</xref></sup> from 514 CRISPR-identified enhancers to mRNAs (<italic toggle="yes">p</italic>-value from two-sided Mann-Whitney <italic toggle="yes">U</italic> test &lt; <inline-formula><mml:math id="M1" display="inline"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, rank-biserial correlation: 0.442). We then used as the cutoff between stable and unstable transcripts the 95th quantile of decay rates of mRNAs and surveyed the distribution of read counts captured in the two categories among all assays. Consistent with our conclusion above, GRO-cap has the smallest differences in read coverage between stable and unstable transcripts (Cohen’s <italic toggle="yes">d</italic>: −0.003, 95% CI: [−0.033, 0.023]), indicating assays using nuclear run-on followed by cap-selection have the greatest ability to enrich unstable transcripts, which is of particular importance for detecting eRNAs (<xref rid="F2" ref-type="fig">Fig. 2b</xref> and <xref rid="F7" ref-type="fig">Extended Data Fig. 1c</xref>). We evaluated the effects of technical artifacts, including strand specificity and mis-priming, and our results suggest all libraries have great strand specificity (average: 0.984, SD: 0.019, <xref rid="F8" ref-type="fig">Extended Data Fig. 2a</xref>~<xref rid="F8" ref-type="fig">c</xref>) and low internal priming rates (<xref rid="SD1" ref-type="supplementary-material">Supplementary Notes</xref>, <xref rid="F8" ref-type="fig">Extended Data Fig. 2d</xref>, and <xref rid="F8" ref-type="fig">e</xref>).</p>
    </sec>
    <sec id="S4">
      <title>Cap selection or Pol II pausing does not bias eRNA capture</title>
      <p id="P10">Assays enriching for capped RNAs showed an advantage in detecting eRNAs (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="F2" ref-type="fig">b</xref>). Because not all eRNAs are necessarily capped, we wanted to assess if the fraction of capped eRNAs influences these quantifications of eRNAs. To address this concern, we reanalyzed a previously published dataset<sup><xref rid="R6" ref-type="bibr">6</xref></sup>, where libraries were prepared with input RNAs pre-selected for different capping states (capped, uncapped, and unselected), and we assessed the abilities of the different libraries to detect CRISPR-identified enhancers. The difference among libraries prepared with three different inputs is minimal: there is a ~97% overlap between the library prepared with capped RNAs and that with unselected RNAs. Therefore, we consider the bias in enhancer detection as negligible when enriching for capped RNAs (<xref rid="F8" ref-type="fig">Extended Data Fig. 2f</xref>, <xref rid="F8" ref-type="fig">g</xref>, and <xref rid="SD1" ref-type="supplementary-material">Supplementary Notes</xref>).</p>
      <p id="P11">Another concern about run-on assays is whether paused polymerases can efficiently resume elongation. A previous study in Drosophila showed that sarkosyl treatment could unleash paused polymerases and allow for efficient elongation of the nascent RNAs that correlated with Pol II levels measured by ChIP-seq<sup><xref rid="R48" ref-type="bibr">48</xref></sup>. Here, we calculated the correlation coefficient of promoter reads detected by PRO-seq and POLR2A ChIP-exo<sup><xref rid="R49" ref-type="bibr">49</xref></sup> associated with paused Pol IIs in human K562 cells and found little difference, indicating paused Pol IIs elongate efficiently in run-on assays <xref rid="F8" ref-type="fig">(Extended Data Fig. 2h)</xref>.</p>
    </sec>
    <sec id="S5">
      <title>Gene body reads in NT-assays contribute to lower sensitivity</title>
      <p id="P12">For the two families of assays that we compared in this study, we noticed that TSS-assays are generally more sensitive in detecting eRNAs than NT-assays, even for assays that use very similar enrichment strategies (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). For instance, while both GRO-cap and PRO-seq employ similar nuclear run-on procedures, there is a 41.3% difference between their divergent coverage of the CRISPR-identified enhancer set (<xref rid="F2" ref-type="fig">Fig. 2a</xref>). When inspecting the genome-wide distribution of reads (<xref rid="F3" ref-type="fig">Fig. 3a</xref> and <xref rid="F9" ref-type="fig">Extended Data Fig. 3a</xref>), we noticed that NT-assays have significantly higher proportions of reads coming from gene body regions (mean of NT-assays: 65.6%, mean of TSS-assays: 13.0%, <italic toggle="yes">p</italic>-value from two-sided Mann-Whitney <italic toggle="yes">U</italic> test: 0.003), which is not surprising as they are designed to reveal all actively transcribing RNA polymerases, whereas TSS-assays are specifically designed to identify TSSs. Because eRNA transcription is, on average, much lower than that of genes<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, such a high portion of gene body reads in NT-assays dilute the signal from eRNAs and significantly lowers their sensitivity in detecting active enhancers. As shown in <xref rid="F3" ref-type="fig">Fig. 3b</xref>, NT-assays detect a substantial number of reads in the <italic toggle="yes">FAM89A</italic> gene body, whereas TSS-assays only have reads in the promoter regions of the <italic toggle="yes">FAM89A</italic> gene. As a result, almost all NT-assays (except PRO-seq) have no discernable signal at a distal enhancer locus near the <italic toggle="yes">FAM89A</italic> gene that was validated by CRISPRi<sup><xref rid="R34" ref-type="bibr">34</xref></sup> (<xref rid="F3" ref-type="fig">Fig. 3b</xref>). Another potential problem for NT-assays is that reads that are mapped to intergenic or intronic regions could be derived from either eRNAs, the unprocessed precursors of RNAs from other categories (e.g., pre-mRNAs), or read-through from an upstream transcription event (<xref rid="F9" ref-type="fig">Extended Data Fig. 3b</xref>), which further reduces their sensitivity for detecting eRNAs.</p>
      <p id="P13">Most of the RNA transcripts in living cells belong to the families of highly abundant RNAs, e.g., rRNAs and snRNAs. When capturing eRNAs with sequencing-based methods, a successful exclusion of RNAs of these high-abundance families from the sequencing libraries during the preparation process can greatly enhance the efficiency and sensitivity of eRNA identification. We compiled a comprehensive list of high-abundance RNAs in human cells by incorporating annotations from GENCODE<sup><xref rid="R50" ref-type="bibr">50</xref></sup>, RefSeq<sup><xref rid="R51" ref-type="bibr">51</xref></sup>, and RMSK<sup><xref rid="R52" ref-type="bibr">52</xref></sup>. Based on this list, an average of 7.12% of the mappable reads in each assay originated from rRNAs despite most of the assays employed strategies to reduce rRNA inclusion <xref rid="F9" ref-type="fig">(Extended Data Fig. 3c)</xref>. By simulating an rRNA-depleted BruUV-seq library, we found that complete depletion of rRNAs could contribute to a 1.76-fold boost in detecting eRNAs <xref rid="F9" ref-type="fig">(Extended Data Fig. 3d)</xref>.</p>
      <p id="P14">When the assay specifically enriches for short transcripts, like csRNA-seq, a relatively large proportion (31.5%) of the mappable reads were found to have originated from snRNAs <xref rid="F9" ref-type="fig">(Extended Data Fig. 3c)</xref>. Detection of such a disproportionally large fraction of snRNAs suggests potential contamination in the sequencing library from the splicing intermediates. To test the possibility, we calculated the signal densities at all the splice sites in the human genome according to GENCODE annotation (release 24, comprehensive version)<sup><xref rid="R50" ref-type="bibr">50</xref></sup>. As shown in <xref rid="F9" ref-type="fig">Extended Data Fig. 3e</xref>, csRNA-seq detects more signals at the splicing junctions than all the other assays.</p>
    </sec>
    <sec id="S6">
      <title>TSS-assays, especially GRO-cap, have higher specificity</title>
      <p id="P15">While genomic regions with detectable transcriptional events account for 75% of the human genome<sup><xref rid="R53" ref-type="bibr">53</xref></sup>, many of these events are considered to be spurious transcriptional noise<sup><xref rid="R54" ref-type="bibr">54</xref>,<xref rid="R55" ref-type="bibr">55</xref></sup> because of their extremely low transcript yields compared to mRNAs and of the intrinsic promiscuity of RNA Pol II under certain circumstances<sup><xref rid="R56" ref-type="bibr">56</xref></sup>. Therefore, it is critical to detect and differentiate the reads that originated from spurious transcription in these assays. To that end, we collected non-enhancer loci from eight MPRA<sup><xref rid="R38" ref-type="bibr">38</xref>–<xref rid="R42" ref-type="bibr">42</xref></sup> and STARR-seq<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R43" ref-type="bibr">43</xref>,<xref rid="R44" ref-type="bibr">44</xref></sup> studies and further removed elements overlapping with predicted Enhancer-Like Sequence (ELS) or Promoter-Like Sequence (PLS) from candidate cis-regulatory elements (cCRE) annotations<sup><xref rid="R57" ref-type="bibr">57</xref></sup> to generate a set of 7,097 loci (referred to as the “non-enhancer set”, <xref rid="S13" ref-type="sec">Methods</xref>, <xref rid="F10" ref-type="fig">Extended Data Fig. 4a</xref>, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref>). We observed that signal intensities in the CRISPR-identified enhancer set are often higher than that in the non-enhancer set (<xref rid="F3" ref-type="fig">Fig. 3c</xref> and <xref rid="F10" ref-type="fig">Extended Data Fig. 4b</xref>, all of them have <italic toggle="yes">p</italic>-values from two-sided Mann-Whitney <italic toggle="yes">U</italic> test &lt; <inline-formula><mml:math id="M2" display="inline"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>), with GRO-cap having the highest signal-to-noise ratio (64-fold enrichment, <xref rid="F3" ref-type="fig">Fig. 3c</xref>, <xref rid="F10" ref-type="fig">Extended Data Fig. 4b</xref> for K562 and <xref rid="F10" ref-type="fig">Extended Data Fig. 4c</xref> for GM12878).</p>
      <p id="P16">We also calculated the false discovery rate (FDR) for each assay based on the overlap of their reads with both the CRISPR-identified enhancer and non-enhancer sets. We found that TSS-assays generally have lower FDRs than NT-assays (TSS-assay mean: 0.232 <italic toggle="yes">vs.</italic> NT-assay mean: 0.544, <italic toggle="yes">p</italic>-value from two-sided Mann-Whitney <italic toggle="yes">U</italic> test: <inline-formula><mml:math id="M3" display="inline"><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref rid="F3" ref-type="fig">Fig. 3d</xref> and <xref rid="F10" ref-type="fig">Extended Data Fig. 4d</xref>), with assays enriching for capped and short RNAs having the lowest FDR (mean: 0.083, SD: 0.007).</p>
    </sec>
    <sec id="S7">
      <title>PINTS: Peak Identifier for Nascent Transcript Starts</title>
      <p id="P17">Two categories of tools are currently available to process data generated by RNA sequencing assays. Tools in the first category predict entire transcription units; they are primarily used for NT-assays and often use a set of cutoffs for fold-changes, e.g., HOMER (GRO-seq)<sup><xref rid="R58" ref-type="bibr">58</xref></sup> or Hidden Markov Models<sup><xref rid="R19" ref-type="bibr">19</xref>,<xref rid="R59" ref-type="bibr">59</xref></sup>, e.g., groHMM, to determine the start and end positions of transcription units <xref rid="F11" ref-type="fig">(Extended Data Fig. 5a)</xref>. Tools in the second category usually identify narrower regions for potential regulatory elements (mainly promoters and enhancers, often referred to as peak callers) and include GROcapTSSHMM<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, dREG<sup><xref rid="R24" ref-type="bibr">24</xref></sup>, Tfit<sup><xref rid="R23" ref-type="bibr">23</xref></sup>, dREG.HD<sup><xref rid="R26" ref-type="bibr">26</xref></sup>, TSScall<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, HOMER (csRNA-seq)<sup><xref rid="R15" ref-type="bibr">15</xref></sup>, and FivePrime<sup><xref rid="R27" ref-type="bibr">27</xref></sup> (based on Paraclu<sup><xref rid="R28" ref-type="bibr">28</xref></sup>). Based on previous studies, the peak of divergent TSSs, which is associated with eRNA transcription, is an effective mark for active enhancers<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>. Therefore, in this comparative study, we focused on the second category of computational tools.</p>
      <p id="P18">To achieve a higher resolution in identifying transcriptional regulatory elements, a common practice is to only look at the ends of the captured transcripts. Two critical issues emerge when evaluating the statistical significance of peaks (i.e., TSSs), especially for the TSS-assays. First, when only considering transcript ends, the fraction of zeros (no mapped reads per base pair) in the local background increases, which deflates read density in the local background and thus inflates the statistical significance of the candidate TSSs and results in false positives. Second, multiple TSSs can localize in close proximity in the genome and therefore inflate the estimation of read density in the local background, resulting in diminished statistical significance for all TSSs in that locus and leading to false negatives in TSS detection. To address these issues, we developed Peak Identifier for Nascent Transcript Starts (PINTS), which uses zero-inflated Poisson models to evaluate local read densities and employs interquartile range (IQR)-based refinement to ameliorate false negatives by conditionally masking candidate TSSs in the local background <xref rid="F11" ref-type="fig">(Extended Data Fig. 5b)</xref>. PINTS was inspired by MACS2<sup><xref rid="R60" ref-type="bibr">60</xref></sup> with modifications specifically implemented for identifying eRNA TSSs from genome-wide TSS-assays. After evaluating the significance of each TSS, PINTS defines TREs as divergent TSS pairs that are within 300 bp from each other, as suggested by previous studies<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup> (<xref rid="F11" ref-type="fig">Extended Data Fig. 5b</xref>, <xref rid="S13" ref-type="sec">Methods</xref>). We identify candidate enhancers as the distal TREs that are farther than 500 bp away from the known protein-coding gene TSSs<sup><xref rid="R6" ref-type="bibr">6</xref></sup>.</p>
    </sec>
    <sec id="S8">
      <title>Peak callers vary in resolution and computational needs</title>
      <p id="P19">Candidate enhancer loci identified by different algorithms should share the same features as CRISPR-identified enhancers with characteristic epigenomic marks (DHS, H3K27ac, H3K4me3, and H3K4me1) and transcription factor (CBP/p300, GATA1, and CTCF)-binding sites. Indeed, we found that candidate enhancers identified by most tools recapitulate these features of CRISPR-identified enhancers (<xref rid="F4" ref-type="fig">Fig. 4a</xref>, <xref rid="F4" ref-type="fig">b</xref>, and <xref rid="F12" ref-type="fig">Extended Data Fig. 6a</xref>). However, the patterns of epigenomic marks and TF-binding sites of candidate enhancers identified by MACS2<sup><xref rid="R60" ref-type="bibr">60</xref></sup>, a widely used peak caller for analyzing ChIP-seq data, are distinct from those of the CRISPR-identified enhancers, suggesting the default peak-shifting model of MACS2 may not be suitable for identifying eRNA TSSs of active enhancers (<xref rid="SD1" ref-type="supplementary-material">Supplementary Notes</xref> and <xref rid="F12" ref-type="fig">Extended Data Fig. 6b</xref>).</p>
      <p id="P20">We further surveyed the size distribution of these elements as an indication of peak-calling resolutions. We found that PINTS, GROcapTSSHMM, Tfit, and TSScall achieve higher resolution (average peak size of 185–300 bp) than other tools when analyzing TSS-assay data (<xref rid="F4" ref-type="fig">Fig. 4c</xref> and <xref rid="F12" ref-type="fig">Extended Data Fig. 6c</xref>). Notably, peaks called by dREG.HD and MACS2 range between 548–751 bp in size, whereas dREG, FivePrime, and HOMER peaks range between 381–460 bp.</p>
      <p id="P21">The amount of computational resources required by a peak caller greatly affects its general applicability. Here, we compared the total amount of CPU time and peak memory usage that each tool requires for identifying divergent elements from TSS-assays (<xref rid="F4" ref-type="fig">Fig. 4d</xref> and <xref rid="F4" ref-type="fig">e</xref>). Based on our calculation, it is feasible to run PINTS, MACS2, HOMER, GROcapTSSHMM, TSScall, and FivePrime on a typical personal computer.</p>
    </sec>
    <sec id="S9">
      <title>PINTS achieves high overall performance for TSS-assays</title>
      <p id="P22">A common task in functional studies of enhancers is to compare active enhancers across different conditions and diseases<sup><xref rid="R21" ref-type="bibr">21</xref>,<xref rid="R22" ref-type="bibr">22</xref></sup>, which requires the <italic toggle="yes">in silico</italic> enhancer-predicting tools to be robust against biological and experimental variances. To test the upper bound of robustness for the aforementioned tools, we performed peak calling using these tools on datasets from 12 assays by aligning each dataset to two commonly-used builds of the human reference genome: hg19 and hg38. Because there is no variation in the sequencing datasets themselves and the two reference genome builds are very similar<sup><xref rid="R61" ref-type="bibr">61</xref></sup> (<xref rid="F13" ref-type="fig">Extended Data Fig. 7a</xref>), we expect that the differences in peak calls using these two different genome builds should be minimal across all datasets. We found that by simply changing the reference genome builds, half of them have a Jaccard index smaller than 0.9 for at least one assay (<xref rid="F4" ref-type="fig">Fig. 4f</xref>). Furthermore, we noticed that Jaccard indices were even lower when we tried to evaluate robustness across real technical and biological replicates (average: 0.507, SD: 0.246), especially for TSScall and FivePrime, where their robustness is only 0.401 (SD: 0.104) and 0.384 (SD: 0.203), respectively (<xref rid="F13" ref-type="fig">Extended Data Fig. 7b</xref>). PINTS consistently have great robustness in both cases (average: 0.976, SD: 0.008 between genome builds, and average: 0.728, SD: 0.052 across replicates).</p>
      <p id="P23">To evaluate sensitivity and specificity, two key performance metrics, we merged the CRISPR-identified enhancer set with the promoter regions from GENCODE v24<sup><xref rid="R50" ref-type="bibr">50</xref></sup> as the positive set, and non-enhancer loci as the negative set (<xref rid="S13" ref-type="sec">Methods</xref>, <xref rid="F14" ref-type="fig">Extended Data Fig. 8a</xref>). We then evaluated each tool’s performance for all TSS-assay datasets (<xref rid="F4" ref-type="fig">Fig. 4g</xref>). The results show that PINTS achieves the best balance between sensitivity and specificity (PINTS mean AUC: 0.780, SD: 0.082; mean AUC for the second-best tool dREG: 0.652, SD: 0.109). Moreover, when we compared the performance of all available tools on sparsely sequenced libraries (with 18.9, 15, and 10 million mappable reads), PINTS still outperforms other tools (<xref rid="F14" ref-type="fig">Extended Data Fig. 8b</xref>~<xref rid="F14" ref-type="fig">d</xref>). When evaluating unique TREs identified by PINTS, we noticed enrichments in epigenomic marks (H3K27ac and H3K4me1, <xref rid="F15" ref-type="fig">Extended Data Fig. 9a</xref>) and motifs for both enhancer-activity-related and cell-type-specific transcription factors (<xref rid="F15" ref-type="fig">Extended Data Fig. 9b</xref>). For all of these computational tools, we summarize their key requirements, main characteristics, and applicability to different RNA sequencing assays in <xref rid="F16" ref-type="fig">Extended Data Fig. 10</xref>.</p>
    </sec>
    <sec id="S10">
      <title>An enhancer compendium for human cell and tissue types</title>
      <p id="P24">Previous studies have shown that, compared with histone marks, detecting enhancers by divergent eRNA TSSs has advantages in both resolution and specificity<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>. Introducing an eRNA-centric enhancer compendium, in addition to all the available enhancer datasets based on histone marks<sup><xref rid="R57" ref-type="bibr">57</xref>,<xref rid="R62" ref-type="bibr">62</xref></sup>, will be an invaluable resource to better understand gene regulation, to functionally annotate the non-coding genome, and to help prioritize non-coding variants across disease cohorts by their potential impact on enhancer activities<sup><xref rid="R63" ref-type="bibr">63</xref></sup>. Toward this goal, we applied PINTS to identify candidate enhancers using TSS-assay datasets (i.e., GRO/PRO-cap, CoPRO, csRNA-seq, NET-CAGE, RAMPAGE, CAGE, and STRIPE-seq) across 33 cell lines, 7 <italic toggle="yes">in vitro</italic> differentiated cells, 35 primary cells, and 45 tissue samples, including all available TSS-assay datasets through the ENCODE portal (<xref rid="F5" ref-type="fig">Fig. 5a</xref>). Such a comprehensive catalog of enhancers across a wide range of human cells and tissues analyzed by the same exact computational pipeline provides an excellent resource to perform meaningful comparative genomic analyses to study the dynamics of enhancers and gene regulation in general, which will help focus on true biological differences while minimizing technical variations. In addition, for 7 human cell lines (K562, GM12878, HepG2, HeLa-S3, MCF-7, H9, and HCT116), we applied all other available tools (FivePrime, HOMER, TSScall, dREG, dREG.HD, and Tfit) to identify candidate enhancers. We believe this unique resource of enhancers in 7 cell lines with multiple TSS-assay datasets analyzed by all available computational tools will greatly help further the studies of enhancers and their key architecture characteristics. All of these candidate enhancer calls are made publicly available through our web server (<ext-link xlink:href="https://pints.yulab.org/" ext-link-type="uri">https://pints.yulab.org</ext-link>) described in detail below. We will regularly update our enhancer compendium as new datasets, especially those in new cell lines or samples, and assays, become available.</p>
      <p id="P25">In human K562 cells where datasets are available from all TSS-assays, our results show that GRO-cap has by far the most number of distal TREs (19,006 identified by PINTS with 9,531 unique enhancer calls – not identified by any other assay); the second-best dataset, csRNA-seq, only has 14,375 enhancer calls with 5,048 unique (<xref rid="F5" ref-type="fig">Fig. 5b</xref>). This is not surprising given that GRO-cap has the best sensitivity in detecting eRNA transcription (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="F2" ref-type="fig">b</xref>) and this GRO-cap dataset has the third-highest read depth (<xref rid="F5" ref-type="fig">Fig. 5b</xref>). We selected three CRISPRi-validated enhancer-promoter pairs<sup><xref rid="R34" ref-type="bibr">34</xref></sup> to visualize these differences and showed the variety in signal abundances across different datasets (<xref rid="F5" ref-type="fig">Fig. 5c</xref>~<xref rid="F5" ref-type="fig">e</xref>). For example, the enhancer which regulates the <italic toggle="yes">JUND</italic> gene (<xref rid="F5" ref-type="fig">Fig. 5c</xref>) has decent accessibility and is supported by epigenomic marks, including H3K27ac and H3K4me1. As expected, all four TSS-assays can identify this enhancer. The expression levels of enhancers are not necessarily proportional to the levels of epigenomic marks, and for eRNAs whose expression levels are lower (e.g., the enhancer that regulates <italic toggle="yes">FTH1</italic> in <xref rid="F5" ref-type="fig">Fig. 5d</xref>), assays that are more effective in capturing unstable transcripts are more likely to recover them. Finally, for the enhancer regulating <italic toggle="yes">TMA16</italic>, signals from histone marks are quite minimal, but GRO-cap still captures clear signals of eRNA transcription at this locus and readily enables the identification of this enhancer (<xref rid="F5" ref-type="fig">Fig. 5e</xref>).</p>
    </sec>
    <sec id="S11">
      <title>PINTS web server for exploring and analyzing enhancers</title>
      <p id="P26">To make it easier for biologists to explore the tens of thousands of candidate enhancers in our compendium and to prioritize these enhancers for further studies, we constructed an online web server (<ext-link xlink:href="https://pints.yulab.org/" ext-link-type="uri">https://pints.yulab.org</ext-link>), where users can query any human genomic region of interest in a given biological sample to get a comprehensive list of candidate enhancers detected by any available TSS-assays in that sample using any of the 8 peak callers (PINTS, dREG, dREG.HD, FivePrime, GROcapTSSHMM, HOMER, Tfit, and TSScall). We also included detailed annotations for each candidate enhancer, including epigenetic features<sup><xref rid="R57" ref-type="bibr">57</xref></sup>, core promoter elements<sup><xref rid="R64" ref-type="bibr">64</xref></sup>, potential transcription factor binding sites<sup><xref rid="R65" ref-type="bibr">65</xref></sup>, and presence of population variants and ClinVar mutations<sup><xref rid="R66" ref-type="bibr">66</xref></sup> (<xref rid="F6" ref-type="fig">Fig. 6</xref>). Users can prioritize enhancers by requiring the joint presence of specific annotations. For the transcription factor binding site analysis, our web server will automatically integrate the information from available RNA-seq data to only include factors that are expressed in the selected sample.</p>
      <p id="P27">Furthermore, users can upload their own enhancer calls in a human cell line or tissue; our web server will automatically annotate all of their enhancer calls with the same pipeline as described above. We have integrated epigenomic features and RNA-seq data for 197 human-derived biosamples from the ENCODE project in our web server. For user-uploaded enhancer data in these samples, we automatically refine our annotations by only reporting binding sites of expressed transcription factors and associating each enhancer with epigenomic features specific to the corresponding sample.</p>
      <p id="P28">Users can explore all annotations of their selected enhancers via our integrated genome browser; alternatively, they can easily export all annotations in plain text format for downstream analyses.</p>
    </sec>
  </sec>
  <sec id="S12">
    <title>Discussion</title>
    <p id="P29">eRNAs are increasingly being recognized as a critical marker for active enhancers genome-wide<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>; however, the optimal strategy (both experimental assays and their analytical pipelines) to detect eRNAs and thus identify enhancer loci has not been critically evaluated. In this study, we systematically compared 13 <italic toggle="yes">in vivo</italic> genome-wide RNA sequencing assays in K562 cells and showed that TSS-assays are in general more sensitive than NT-assays to detect eRNAs, because signals will not be diluted by active transcription in gene bodies. One additional and critical advantage of the TSS-assays is that they reveal the precise location of eRNA TSSs, allowing for high-resolution detection and delimitation of enhancer loci genome-wide, as demonstrated in our recent work<sup><xref rid="R6" ref-type="bibr">6</xref></sup>. Overall, our results show that GRO/PRO-cap has the best overall performance in detecting active enhancers in terms of both sensitivity and specificity. Thus, for fresh cells and tissue specimens or samples with high RNA quality, we recommend GRO/PRO-cap based on our observations in this study. Because run-on cap assays require an enzymatically-active RNA polymerase and cap structure, other TSS-assays (e.g., FFPEcap-seq<sup><xref rid="R67" ref-type="bibr">67</xref></sup>) or some NT-assay<sup><xref rid="R18" ref-type="bibr">18</xref></sup> may perform better in samples where these requirements cannot be met, for example, for paraffin-embedded, formalin-fixed samples.</p>
    <p id="P30">We noticed that when using current computational tools to identify TREs from various RNA sequencing datasets, minor changes in sample processing could lead to more than 20% of changes in the final results, which brings the robustness of the peak calls into question. To address this issue, we introduced a computational tool, PINTS. Our benchmarks indicate that PINTS achieves the best balance among robustness, applicability, sensitivity, and specificity, especially for TSS-assays capable of detecting the precise location of eRNA TSSs.</p>
    <p id="P31">In this study, we used CRISPR/Cas9 and CRISPRi validated enhancers<sup><xref rid="R29" ref-type="bibr">29</xref>–<xref rid="R37" ref-type="bibr">37</xref></sup> as the positive reference set and MPRA/STARR-seq negative segments<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R38" ref-type="bibr">38</xref>–<xref rid="R44" ref-type="bibr">44</xref></sup> as non-enhancers. Although these two sets show quite different epigenomic profiles <xref rid="F10" ref-type="fig">(Extended Data Fig. 4a)</xref>, which indicates that our non-enhancer set is depleted of true enhancers, there might still be a few false negatives in the non-enhancer set. This is because, in the published MPRA/STARR-seq datasets, only a very small number of promoters were used to test all candidate elements, but some enhancers might not work with these promoters. Furthermore, some tested elements might be truncated due to synthesis limitations (<inline-formula><mml:math id="M4" display="inline"><mml:mo>&lt;</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula> bp) or random fragmentation of the genome. However, such cases are not expected to affect our relative ranking of different assays and thus will have minimal impact on our conclusions. We also note that the features defining enhancers and non-enhancers, both at structural and functional levels, are still a work in progress, and while it appears that the vast majority of active enhancers are transcribed, an accurate estimation of the fraction of enhancers that can initiate transcription is still unknown.</p>
    <p id="P32">Furthermore, we provide a detailed, comprehensive human enhancer compendium with a unified definition<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R7" ref-type="bibr">7</xref></sup> of enhancers based on the detected divergent pairs of eRNA TSSs. Such a robust, unified and comprehensive catalog of enhancers across 120 cell types and tissues is expected to shine a light on the mechanism of gene regulation and architectural details of enhancers in general. The precise definition of enhancer element boundaries afforded by TSS-assays like PRO/GRO-cap would alleviate potential concerns regarding whether full-length enhancer elements were selected and tested in follow-up functional studies, and thus improve coverage of elements by eliminating incomplete or ill-defined candidates. Such a well-defined catalog of enhancers also provides an invaluable resource for follow-up studies to better understand the similarities and key differences in gene regulation across various tissues and conditions, and to identify key enhancers whose malfunctions can lead to specific disorders.</p>
  </sec>
  <sec id="S13">
    <title>Methods</title>
    <sec id="S14">
      <title>Data preprocessing</title>
      <p id="P33">All datasets were managed and analyzed with BioQueue<sup><xref rid="R68" ref-type="bibr">68</xref></sup> (accession numbers for these datasets are available in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>). Raw reads were preprocessed with fastp<sup><xref rid="R69" ref-type="bibr">69</xref></sup> for adapter trimming. Only reads longer than 14 bp were kept for downstream analyses. All processed reads from RNA assays were aligned using STAR<sup><xref rid="R70" ref-type="bibr">70</xref></sup> to primary assemblies of human reference genome hg38 (GCF_000001305.15) together with rDNA (U13369.1) with parameters as --outSAMattributes All --outSAMmultNmax 1 --outFilterMultimapNmax 50. For studies using Drosophila cells, or other specific samples as spike-ins, Drosophila reference genome (dm6), or the corresponding reference sequences used in the original studies were incorporated into the index (details available in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>). To measure the robustness of peak prediction, we also mapped reads to primary assemblies of human reference genome hg19 (from UCSC, sequences from alternative loci/haplotypes were removed the same way as for hg38). Reads from DNA assays were aligned and processed using bwa<sup><xref rid="R71" ref-type="bibr">71</xref></sup> and samtools<sup><xref rid="R72" ref-type="bibr">72</xref></sup> with default parameters.</p>
    </sec>
    <sec id="S15">
      <title>Determining read coverage among reference regions</title>
      <p id="P34">Sequencing reads of replicates for the same assay were merged together and downsampled to the same sequencing depth (the same number of mappable reads) three times using picard with parameter STRATEGY = Chained. These downsampled data were then converted to bed files to calculate the fraction of overlap between the sequencing reads and the reference regions in a strand-specific manner.</p>
    </sec>
    <sec id="S16">
      <title>Classifying the transcription units as stable and unstable units with TT-seq</title>
      <p id="P35">Transcript annotations derived from TT-seq (GSE75792<sup><xref rid="R47" ref-type="bibr">47</xref></sup>) were downloaded from the GEO database. Transcription units with NA values were discarded. The 95th quantile of estimated decay rates for mRNAs was used as the cutoff between the unstable (above the cutoff) and stable (below the cutoff) transcription units.</p>
    </sec>
    <sec id="S17">
      <title>Characterizing the genome-wide distribution of reads</title>
      <p id="P36">The entire genome was classified into four categories based on the annotations in GENCODE (ver 24)<sup><xref rid="R50" ref-type="bibr">50</xref></sup>: exonic and intronic regions were defined as in GENCODE, except that any region with overlapping intronic and exonic annotation was considered as exonic; the 500-bp regions flanking annotated transcription start sites of protein-coding transcripts were annotated as promoters; all other regions were considered as intergenic. Sequencing reads of various assays were assigned to the categories of promoters, introns, exons, or intergenic regions (in the exact order) if they were aligned to the corresponding annotated regions in the genome.</p>
    </sec>
    <sec id="S18">
      <title>Identifying sequencing reads from splicing intermediates</title>
      <p id="P37">The exact or approximate positions of transcript termini were inferred from the read ends, and the abundance of their corresponding transcripts was normalized as RPM for this analysis. A list of annotated splice junctions and their 200 bp flanking regions in the human genome was compiled based on GENCODE v24<sup><xref rid="R50" ref-type="bibr">50</xref></sup>. For each assay, we iterated through this list and recorded normalized read counts at each position. In <xref rid="F9" ref-type="fig">Extended Data Fig. 3e</xref>, both the average of signals and the 95% confidence interval (estimated by bootstrap) of the averages were reported.</p>
    </sec>
    <sec id="S19">
      <title>Compiling the reference sets</title>
      <p id="P38">The experimentally quantified enhancer activity of various DNA elements was collected from previous studies (enhancers: 938 from CRISPR<sup><xref rid="R31" ref-type="bibr">31</xref></sup> or CRISPRi<sup><xref rid="R29" ref-type="bibr">29</xref>,<xref rid="R30" ref-type="bibr">30</xref>,<xref rid="R32" ref-type="bibr">32</xref>–<xref rid="R37" ref-type="bibr">37</xref></sup>; non-enhancers: 20,941 from STARR-seq<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R43" ref-type="bibr">43</xref>,<xref rid="R44" ref-type="bibr">44</xref></sup> and 17,462 from MPRA<sup><xref rid="R38" ref-type="bibr">38</xref>–<xref rid="R42" ref-type="bibr">42</xref></sup>). Overlapping elements within the same category were merged until the resulting elements overlap with elements in the other category. Non-enhancer loci were excluded in the final set if they 1) were shorter than 250 bp; 2) overlapped with PLS or ELS predicted by cCRE<sup><xref rid="R57" ref-type="bibr">57</xref></sup>, or 3) overlapped with possible promoters (1kb regions flanking TSSs in GENCODE). When selecting MPRA<sup><xref rid="R38" ref-type="bibr">38</xref>–<xref rid="R42" ref-type="bibr">42</xref></sup> and STARR-seq<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R43" ref-type="bibr">43</xref>–<xref rid="R45" ref-type="bibr">45</xref></sup> identified enhancers in K562, we required the supporting data from at least two independent studies to ameliorate the inclusion of false-positive enhancers resulting from orientation bias (STARR-seq) or promoter activity (MPRA). For GM12878, to ameliorate false positives caused by orientation bias, only orientation-independent enhancer calls from HiDRA were used<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R46" ref-type="bibr">46</xref></sup>.</p>
    </sec>
    <sec id="S20">
      <title>Calculating FDRs for assays</title>
      <p id="P39">multiBamSummary<sup><xref rid="R73" ref-type="bibr">73</xref></sup> was used to generate tables of read counts across the genome in 500-bp bins. For each assay, the bins were ranked by counts in them, and the top <italic toggle="yes">n</italic> bins were considered as true signals from the assay (four cutoffs were tested: 5,000, 10,000, 20,000, and 100,000, <xref rid="F10" ref-type="fig">Extended Data Fig. 4d</xref>). If a bin overlapped with a locus in the CRISPR-identified enhancer set, then the bin was considered as a true positive (TP); if a bin overlapped with a locus in the non-enhancer set, it was considered as a false positive (FP). The false discovery rates were calculated as:
<disp-formula id="FD1"><mml:math id="M5" display="block"><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
    </sec>
    <sec id="S21">
      <title>PINTS</title>
      <p id="P40">Briefly, read ends are separated based on their mapping directions on the reference genome (forward or reverse), and the read counts are binned into 100-bp windows. Adjacent windows with reads available are merged to avoid splitting potential TRE elements. Within each window, the algorithm first finds peak seeds using a prominence-based approach. Then with a maximum-scoring pairing strategy<sup><xref rid="R28" ref-type="bibr">28</xref></sup>, the nearby seeds will be merged together as peak candidates if the density after merging meets the following condition:
<disp-formula id="FD2"><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>α</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p id="P41">The default value for <inline-formula><mml:math id="M7" display="inline"><mml:mi>α</mml:mi></mml:math></inline-formula> is 1, and PINTS’ resolution can be further fine-tuned by incorporating reference annotations. For example, when the transcript annotation is available, PINTS will try to avoid the overlap of peak candidates with more than one transcript.</p>
      <p id="P42">Next, to address the increased sparsity of signals when only the read ends are taken into account, the Expectation-Maximization algorithm is used to fit zero-inflated Poisson (ZIP) models to both peak candidates and their neighborhood regions (<inline-formula><mml:math id="M8" display="inline"><mml:mi mathvariant="normal">λ</mml:mi></mml:math></inline-formula> for read density, <inline-formula><mml:math id="M9" display="inline"><mml:mi mathvariant="normal">π</mml:mi></mml:math></inline-formula> for the proportion of zeros that are not coming from a Poisson process), the probability mass function of these models has the following form:
<disp-formula id="FD3"><mml:math id="M10" display="block"><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>π</mml:mi><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula></p>
      <p id="P43">Assume an unobservable latent random variable <inline-formula><mml:math id="M11" display="inline"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, for a window <inline-formula><mml:math id="M12" display="inline"><mml:mi>X</mml:mi></mml:math></inline-formula> of <inline-formula><mml:math id="M13" display="inline"><mml:mi>I</mml:mi></mml:math></inline-formula> observations, the complete log-likelihood is proportional to:
<disp-formula id="FD4"><mml:math id="M14" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p id="P44">In E-step at the <inline-formula><mml:math id="M15" display="inline"><mml:mo>(</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>th iteration, <inline-formula><mml:math id="M16" display="inline"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is estimated by its conditional expectation:
<disp-formula id="FD5"><mml:math id="M17" display="block"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula></p>
      <p id="P45">In M-step, given <inline-formula><mml:math id="M18" display="inline"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:math></inline-formula> the estimations of <inline-formula><mml:math id="M19" display="inline"><mml:mi mathvariant="normal">π</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M20" display="inline"><mml:mi mathvariant="normal">λ</mml:mi></mml:math></inline-formula> are updated as follows:
<disp-formula id="FD6"><mml:math id="M21" display="block"><mml:mfrac linethickness="0pt"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
      <p id="P46">An interquartile range (IQR)-based refinement is applied before fitting ZIP models to the neighborhood regions. In this case, if certain peak candidates in a local environment are considered as outliers by IQR (their densities are above <inline-formula><mml:math id="M22" display="inline"><mml:mi mathvariant="normal">Q</mml:mi><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mn>1.5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mi mathvariant="normal">Q</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="M23" display="inline"><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">Q</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Q</mml:mi><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Q</mml:mi><mml:mn>1</mml:mn></mml:math></inline-formula>), these candidates will be masked. For libraries with low sequencing depth, instead of simultaneously masking all outlier peak candidates in the local background, PINTS masks one peak candidate at a time and calculates the resulting peak density in the local background. The process will be reiterated until PINTS either identifies the outlier candidates or reports the non-existence of such outliers. The estimated densities are then used to determine the statistically significant peaks, which are further categorized into divergent peak pairs (peaks on opposite strands and within 300 bp) and unidirectional peaks.</p>
      <p id="P47">For enhancer-like elements that do not pass the statistical cutoff of PINTS but have significant enhancer-related epigenomic marks, PINTS will offer an option to include these elements in the output where they will be labeled as “Marginal” and their corresponding epigenomic marks. To use this feature, the user needs to add --epig-annotation &lt;biosample&gt; when running PINTS.</p>
      <p id="P48">PINTS depends on open-source Python packages including numpy<sup><xref rid="R74" ref-type="bibr">74</xref></sup>, scipy<sup><xref rid="R75" ref-type="bibr">75</xref></sup>, pandas, statsmodels<sup><xref rid="R76" ref-type="bibr">76</xref></sup>, pybedtools<sup><xref rid="R77" ref-type="bibr">77</xref></sup>, pyBigWig, pysam, and biopython<sup><xref rid="R78" ref-type="bibr">78</xref></sup>.</p>
    </sec>
    <sec id="S22">
      <title>Generating peak calls with existing tools</title>
      <p id="P49">Peak calls for different assays were made using default parameters for other existing peak callers with the following exceptions. For MACS2, --keep-dup all was set so that reads mapped to the same loci would be kept. For FivePrime, parameters <inline-formula><mml:math id="M24" display="inline"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="M25" display="inline"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were optimized according to the sequencing depth of corresponding libraries, and both divergent TSS calls and enhancer calls were combined as the final output. All tools were allowed to create up to 16 threads/subprocesses if they allow multithreading or parallel computing. For peak callers that do not primarily identify divergent peaks, unidirectional peaks were paired as long as they were within 300 bp and on opposite strands. Maximum memory usage and CPU time (sum of all threads) were monitored with the help from BioQueue<sup><xref rid="R68" ref-type="bibr">68</xref></sup>. UCSC Genome Browser command line tools (bedToBigBed, bigBedToBed, bigWigToBedGraph, bedGraphToBigWig, and bigWigMerge) and bedtools<sup><xref rid="R79" ref-type="bibr">79</xref></sup> were used for the conversion of file formats. All peak calls were generated on machines with Intel Xeon Gold 6152 CPU @ 2.10 GHz with 88 cores, 1006 GB of RAM running CentOS 7.6.1810.</p>
    </sec>
    <sec id="S23">
      <title>Evaluating the systematic biases of different peak calling methods</title>
      <p id="P50">For each assay, divergent elements were identified using all applicable peak callers, including PINTS. To accommodate the size difference in these elements as well as elements in the CRISPR-identified enhancer set, a 1,000-bp region centered around the midpoint of each element was used to evaluate the performance of different methods.</p>
    </sec>
    <sec id="S24">
      <title>Evaluating the upper bound of peak caller robustness</title>
      <p id="P51">Sequencing reads were aligned to another popular reference genome sequence, hg19, and divergent elements were identified accordingly with different peak callers. Peak calls generated from both genome releases were cross lifted using UCSC’s liftover and the average between the two Jaccard indices was considered as the upper bound robustness (UBR):
<disp-formula id="FD7"><mml:math id="M26" display="block"><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>38</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>37</mml:mn><mml:mo>→</mml:mo><mml:mn>38</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>38</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>37</mml:mn><mml:mo>→</mml:mo><mml:mn>38</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>37</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>38</mml:mn><mml:mo>→</mml:mo><mml:mn>37</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>37</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mtext>Peaks</mml:mtext></mml:mrow><mml:mrow><mml:mn>38</mml:mn><mml:mo>→</mml:mo><mml:mn>37</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec id="S25">
      <title>ROC</title>
      <p id="P52">For each assay, any element from the CRISPR-identified and non-enhancer set was filtered out if there were no sequencing reads aligned to both strands of the element. The positive set was composed of an equal number of randomly sampled promoters (1kb regions flanking TSSs in GENCODE v24) from expressed genes and the filtered enhancers. The negative set was composed of the filtered non-enhancers. ROCs were generated by calculating the number of divergent elements overlapping with the positive and negative sets under different cutoffs of scores: <italic toggle="yes">p</italic>-values of peaks for PINTS and MACS2, FDRs for TSScall, output SVR scores for dREG, likelihood ratio scores for Tfit, and peak scores for HOMER (findcsRNATSS.pl and findPeak -style TSS). For dREG.HD, GROcapTSSHMM, FivePrime, and HOMER (GRO-seq), since there are either no scores or multiple scores returned in the final output, the sensitivity and specificity were evaluated and reported with their default parameters.</p>
    </sec>
    <sec id="S26">
      <title>PINTS web server</title>
      <p id="P53">The PINTS web server is powered by the Django web framework. dbSNP v153<sup><xref rid="R80" ref-type="bibr">80</xref></sup> was used for annotating mutations among TREs; JASPAR 2020<sup><xref rid="R65" ref-type="bibr">65</xref></sup> was employed for annotating transcription factor registries, and only TFs expressed in the corresponding biosample (based on RNA-seq data from ENCODE) were included (see <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref> for list of datasets used and accession information). cCRE v254<sup><xref rid="R57" ref-type="bibr">57</xref></sup> was used for epigenomic annotation. Core promoter elements were annotated using the following strategy: for each major TSS (+1), the portal annotated the elements as having an initiator or an initiator-like element when the sequence of −3~+3 matches BBCABW; or the sequence of +1~+2 matches YR, respectively. The TATA box (−32~−21) and DPR elements (+17~+35) were identified using the previously published SVR model<sup><xref rid="R64" ref-type="bibr">64</xref></sup>.</p>
    </sec>
    <sec sec-type="data-availability" id="S27">
      <title>Data availability</title>
      <p id="P54">Processed TRE calls are publicly accessible via our web portal (<ext-link xlink:href="https://pints.yulab.org/" ext-link-type="uri">https://pints.yulab.org</ext-link>). Data that support the findings of this study are available within the paper and its <xref rid="SD1" ref-type="supplementary-material">supplementary information files</xref>. All sequencing data analyzed in this study were retrieved from public databases (NCBI GEO and ENCODE portal); lists of accessions are available in <xref rid="SD2" ref-type="supplementary-material">Supplementary Tables 1</xref> and <xref rid="SD2" ref-type="supplementary-material">4</xref>.</p>
    </sec>
    <sec id="S28">
      <title>Code availability</title>
      <p id="P55">The source code of PINTS is publicly available at <ext-link xlink:href="https://github.com/hyulab/PINTS" ext-link-type="uri">https://github.com/hyulab/PINTS</ext-link>; scripts and pipelines used to generate results that are reported in this study can be retrieved from <ext-link xlink:href="https://github.com/hyulab/PINTS_analysis" ext-link-type="uri">https://github.com/hyulab/PINTS_analysis</ext-link>.</p>
    </sec>
    <sec id="S29">
      <title>Reporting Summary</title>
      <p id="P56">Further information on research design is available in the Nature Research Reporting Summary linked to this article</p>
    </sec>
  </sec>
  <sec sec-type="extended-data" id="S30">
    <title>Extended Data</title>
    <fig position="anchor" id="F7">
      <label>Extended Data Fig. 1</label>
      <caption>
        <title>An extended evaluation of eRNA detection sensitivity of different assays.</title>
        <p id="P57"><bold>a</bold> and <bold>c</bold> are the extended versions for <xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="F2" ref-type="fig">b</xref>, respectively. <bold>a</bold> and <bold>b</bold> show the capability of different assays to capture previously identified enhancers. The color of stacked bars indicates the detection of eRNAs originated from either one or both strands of the enhancer loci. The transparency level shows the number of reads for an enhancer locus to be considered as covered. The top track in <bold>a</bold> is derived from the CRISPR or CRISPRi based reference set (<inline-formula><mml:math id="M27" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>803</mml:mn></mml:math></inline-formula>), the bottom track is derived from consensus loci validated by STARR-seq and MPRA (<inline-formula><mml:math id="M28" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>550</mml:mn></mml:math></inline-formula>). <bold>b,</bold> Sensitivity evaluated in the other cell line, GM12878, with orientation-independent enhancers identified from previous studies (<inline-formula><mml:math id="M29" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3,544</mml:mn></mml:math></inline-formula>)<sup><xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R46" ref-type="bibr">46</xref></sup>. <bold>c</bold>, Differences in read coverage among stable (<inline-formula><mml:math id="M30" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>13,861</mml:mn></mml:math></inline-formula>) and unstable (<inline-formula><mml:math id="M31" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6,380</mml:mn></mml:math></inline-formula>) transcripts. The error bars in the top track show the extrema of effect sizes (<inline-formula><mml:math id="M32" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5,000</mml:mn></mml:math></inline-formula>). The center dots, box limits, and whiskers in the bottom track of <bold>c</bold> denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0007" position="float"/>
    </fig>
    <fig position="anchor" id="F8">
      <label>Extended Data Fig. 2</label>
      <caption>
        <title>Effect of technical artifacts on eRNA capture.</title>
        <p id="P58"><bold>a</bold>, A new strategy for evaluating strand specificity without the interference from promoter-upstream transcripts (PROMPTs)<sup><xref rid="R81" ref-type="bibr">81</xref></sup>. Red and blue colors indicate reads’ mapping direction; the highlighted (yellow) region indicates a previously validated<sup><xref rid="R82" ref-type="bibr">82</xref></sup> PROMPT. Only the first exon in green was used for evaluation. <bold>b</bold>, Strand specificities of three stranded and unstranded RNA-seq libraries with our strategy. The <italic toggle="yes">p</italic>-value was estimated by a two-sided <italic toggle="yes">t</italic> test; <bold>c</bold>, Strand specificity for all libraries evaluated with our strategy. Values and error bars represent the mean and SD. <inline-formula><mml:math id="M33" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> (GRO-cap, CoPRO, csRNA-seq, PRO-seq, GRO-seq, mNET-seq), <inline-formula><mml:math id="M34" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula> (STRIPE-seq), <inline-formula><mml:math id="M35" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> (CAGE and RAMPAGE), <inline-formula><mml:math id="M36" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:math></inline-formula> (BruUV-seq, total RNA-seq), <inline-formula><mml:math id="M37" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula> (Bru-seq). <bold>d</bold>, Distribution of 3-mers at flush end sites<sup><xref rid="R83" ref-type="bibr">83</xref></sup> for RIP-seq and TGIRT-seq. The dashed red lines stand for the frequency of RT3-mers (sequence identical to the last three nts for the RT primer [for RIP-seq] or the 3′ adapter [for TGIRT-seq]) in the genome. <bold>e</bold>, Log odds ratios (LORs) of observed RT3-mer at flushing end sites versus in the genome (top) and internal priming rates (bottom) of assays when the internal priming could be detected from the sequencing data. <bold>f,</bold> The overlap between enhancers in the RppH library (Capped+Uncapped as “C+U”) that are also covered in the Capped library (C). The <italic toggle="yes">x</italic>-axis shows the minimum number of reads required for an enhancer locus to be considered as covered. <bold>g,</bold> Difference of log-transformed read counts between the capped (C) and RppH (C+U) libraries. The effect size was measured by Cohen’s <italic toggle="yes">d</italic>. In the box plot, the center dots, box limits, and whiskers denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively. <bold>h,</bold> Pearson’s <italic toggle="yes">r</italic> of log-transformed reads from promoters of expressed transcripts (TPM &gt; 5) was quantified using PRO-seq and POLR2A ChIP-exo. <inline-formula><mml:math id="M38" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4,747</mml:mn></mml:math></inline-formula> (low), <inline-formula><mml:math id="M39" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>9,058</mml:mn></mml:math></inline-formula> (medium), and <inline-formula><mml:math id="M40" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2,470</mml:mn></mml:math></inline-formula> (high).</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0008" position="float"/>
    </fig>
    <fig position="anchor" id="F9">
      <label>Extended Data Fig. 3</label>
      <caption>
        <title>Analyses of factors affecting assays’ sensitivity in detecting eRNAs.</title>
        <p id="P59"><bold>a</bold> is the extended version for <xref rid="F3" ref-type="fig">Fig. 3a</xref>. <bold>b</bold>, An example shows that divergent transcripts detected by NT-assays can originate from two overlapping genes (<italic toggle="yes">MMP23B</italic> and <italic toggle="yes">SLC35E2B</italic>) instead of from a regulatory element. Sequencing reads were RPM-normalized. <bold>c,</bold> Proportion of mappable reads from different assays originated from various abundant RNA families. <bold>d</bold>, Effects of rRNA depletion in eRNA enrichment. For each category, three downsampled libraries were included. BruUV-seq libraries from a previously published study<sup><xref rid="R84" ref-type="bibr">84</xref></sup> were used for this analysis. The <italic toggle="yes">p</italic>-value for rRNA percentage was calculated by two proportions <italic toggle="yes">z</italic> test (two-sided, <italic toggle="yes">p</italic>-value: 0); the <italic toggle="yes">p</italic>-value for true enhancer coverage was calculated by McNemar’s test (two-sided, <italic toggle="yes">p</italic>-value: <inline-formula><mml:math id="M41" display="inline"><mml:mn>2.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>). Values and error bars represent the mean and SD. <bold>e</bold>, The distribution of sequencing reads (in RPM) around GENCODE-annotated splicing junction sites. The shaded area indicates the 95% confidence interval of mean values estimated via bootstrap.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0009" position="float"/>
    </fig>
    <fig position="anchor" id="F10">
      <label>Extended Data Fig. 4</label>
      <caption>
        <title>Extended evaluations of assays’ specificity.</title>
        <p id="P60"><bold>a</bold>, Epigenomic and transcription factor binding profiles for the enhancer and non-enhancer sets. For H3K27ac and CTCF, the profiles are presented as fold-changes over control; for DHS, the profile is shown as normalized sequencing depth. Solid lines represent mean densities, and shades depict the 95% confidence interval of mean values estimated via bootstrap. KE: known enhancers; NE: non-enhancers. <bold>b</bold> Signal-to-noise ratios evaluated in K562. <inline-formula><mml:math id="M42" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>803</mml:mn></mml:math></inline-formula> for known enhancers, <inline-formula><mml:math id="M43" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6,777</mml:mn></mml:math></inline-formula> for non-enhancers. <bold>c,</bold> Signal-to-noise ratios evaluated in GM12878. <inline-formula><mml:math id="M44" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3,544</mml:mn></mml:math></inline-formula> (Known enhancers), and <inline-formula><mml:math id="M45" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>153,809</mml:mn></mml:math></inline-formula> (Non-enhancers). For <bold>b</bold> and <bold>c</bold>, 10,000 bootstrapped samples were used for calculating the fold enrichment (FE). The center dots, box limits, and whiskers in <bold>b</bold> and <bold>c</bold> denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively. <bold>d</bold>, False discovery rates estimated by the overlap between the top 5,000, 10,000, 20,000, and 100,000 genomic bins and the true and non-enhancer sets. Downsampled libraries were used (<inline-formula><mml:math id="M46" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula>); values and error bars represent the mean and SD.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0010" position="float"/>
    </fig>
    <fig position="anchor" id="F11">
      <label>Extended Data Fig. 5</label>
      <caption>
        <title>Assessments of transcript unit prediction and schematic illustration of PINTS.</title>
        <p id="P61"><bold>a,</bold> The consistencies vary greatly between transcription units annotated in GENCODE (Annot.) and those predicted by different tools<sup><xref rid="R58" ref-type="bibr">58</xref>,<xref rid="R59" ref-type="bibr">59</xref>,<xref rid="R85" ref-type="bibr">85</xref></sup> (Pred.). Lines in the violin plot indicate the 25th, 50th, and 75th quartiles, respectively. <bold>b,</bold> Schematic plot of PINTS. <bold>i,</bold> Improvement of TSS identification resolution by focusing only on read ends and using zero-inflated Poisson (ZIP) models to fit local background to address the significantly increased sparsity of signals. The thin grey lines indicate sequencing reads with the 5′ ends highlighted in red. <bold>ii</bold>, The existence of other potential true peaks (pink) elevates the estimation of read density in the local background. <bold>iii</bold>, A schematic plot shows how IQR-ZIP works. The blue box shows the read density distribution of the local background; the purple dot shows the density of the peak to be tested; the pink dot shows the density of a potential true peak close to the peak to be tested, whose read density is a clear outlier and thus excluded from local background estimation.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0011" position="float"/>
    </fig>
    <fig position="anchor" id="F12">
      <label>Extended Data Fig. 6</label>
      <caption>
        <title>Profiles of peak calls generated by different peak callers for various assays.</title>
        <p id="P62"><bold>a</bold>, Aggregated profiles of epigenomic marks, transcription binding sites, and chromatin accessibility in true enhancer regions and distal TREs identified by different peak callers for TSS- and NT-assays. The shaded area indicates the 95% confidence interval of mean values estimated via bootstrap; <bold>b</bold>, An example demonstrating why MACS2 is not suitable for identifying TREs. <bold>c</bold>, Distribution of element sizes identified from 12 assays by all applicable peak callers. In the box plot, the center lines, box limits, and whiskers denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively; points show observations that are not in the range of quartiles <inline-formula><mml:math id="M47" display="inline"><mml:mo>±</mml:mo><mml:mn>1.5</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. A table of sample sizes is available in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 5</xref>.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0012" position="float"/>
    </fig>
    <fig position="anchor" id="F13">
      <label>Extended Data Fig. 7</label>
      <caption>
        <title>Extended analyses on the robustness of element predictions.</title>
        <p id="P63"><bold>a</bold>, A previous study showed that the sequences between hg19 and hg38 are very similar as hg38 has 0.09% more ungapped non-centromeric sequences than hg19, only 0.17% of ungapped hg19 sequences are not in hg38<sup><xref rid="R61" ref-type="bibr">61</xref></sup>. Here we show the distribution of sequencing reads in the genome. The read counts of each assay were summarized against their frequency in a log scale with hg19 as blue lines and hg38 as orange lines. The <italic toggle="yes">p</italic>-values were calculated by two-sided Student’s <italic toggle="yes">t</italic> tests. <bold>b</bold>, Robustness (Jaccard index) of different peak callers when applying them to experimental data with technical and biological replicates. Correlations between alignments (Sample cor.) were calculated as Pearson’s <italic toggle="yes">r</italic> of log-transformed read counts among genomic bins (500 bp).</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0013" position="float"/>
    </fig>
    <fig position="anchor" id="F14">
      <label>Extended Data Fig. 8</label>
      <caption>
        <title>Performance evaluation of peak callers under different sequencing depths.</title>
        <p id="P64"><bold>a</bold>, Epigenomic patterns of the true positive (enhancers, promoters) and true negative (non-enhancers) sets used for ROC calculation for peak calling from GRO-cap. <bold>b~d</bold>, Sensitivity and specificity of different peak callers when analyzing TSS-libraries (<italic toggle="yes">n</italic>=7) downsampled to 18.9 (<bold>b</bold>), 15 (<bold>c</bold>), and 10 (<bold>d</bold>) million mappable reads. The corresponding shaded areas show the 95% confidence interval of the means (via bootstrap). For tools where ROCs cannot be calculated, solid dots represent their performance with default parameters. Values and error bars show mean and SD.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0014" position="float"/>
    </fig>
    <fig position="anchor" id="F15">
      <label>Extended Data Fig. 9</label>
      <caption>
        <title>Profiles of unique distal elements identified by different tools.</title>
        <p id="P65"><bold>a,</bold> Comparison of the epigenomic signals (fold change over control) in elements uniquely identified by PINTS and other tools. <bold>b,</bold> Enrichment (measured as log odds ratios) of TF-binding motifs in PINTS unique TREs compared to other tools. The circles indicate the corresponding <italic toggle="yes">p</italic>-values (<inline-formula><mml:math id="M48" display="inline"><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, two-sided <italic toggle="yes">z</italic> tests), and the error bars indicate the 90% confidence interval.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0015" position="float"/>
    </fig>
    <fig position="anchor" id="F16">
      <label>Extended Data Fig. 10</label>
      <caption>
        <title>A summary of the computational tools compared in this study.</title>
        <p id="P66">The features of different algorithms are summarized and grouped by their roles in the peak calling procedure (colored blocks). Features utilized by each tool to call peaks from nascent transcript sequencing data are indicated.</p>
      </caption>
      <graphic xlink:href="nihms-1769925-f0016" position="float"/>
    </fig>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material id="SD1" position="float" content-type="local-data">
      <label>Supplementary Information</label>
      <media xlink:href="NIHMS1769925-supplement-Supplementary_Information.pdf" id="d64e2769" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD2" position="float" content-type="local-data">
      <label>Supplementary Tables</label>
      <media xlink:href="NIHMS1769925-supplement-Supplementary_Tables.xlsx" id="d64e2772" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD3" position="float" content-type="local-data">
      <label>Source Data for Figure 2</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Figure_2.xlsx" id="d64e2775" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD4" position="float" content-type="local-data">
      <label>Source Data for Figure 3</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Figure_3.xlsx" id="d64e2778" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD5" position="float" content-type="local-data">
      <label>Source Data for Figure 4</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Figure_4.xlsx" id="d64e2781" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD6" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 1</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__1.xlsx" id="d64e2784" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD7" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 2</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__2.xlsx" id="d64e2787" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD8" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 3</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__3.xlsx" id="d64e2790" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD9" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 4</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__4.xlsx" id="d64e2793" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD10" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 5</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__5.xlsx" id="d64e2796" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD11" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 7</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__7.xlsx" id="d64e2800" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD12" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 8</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__8.xlsx" id="d64e2803" position="anchor"/>
    </supplementary-material>
    <supplementary-material id="SD13" position="float" content-type="local-data">
      <label>Source Data for Extended Data Fig. 9</label>
      <media xlink:href="NIHMS1769925-supplement-Source_Data_for_Extended_Data_Fig__9.xlsx" id="d64e2806" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S31">
    <title>Acknowledgments</title>
    <p id="P67">Computation was performed on a cluster administered by the Biotechnology Resource Center at Cornell University. We thank members of the Yu and Lis laboratories and the ENCODE Consortium (specifically Ali Mortazavi, Mats Ljungman, and Jill E. Moore) for helpful discussions and guidance; Hongya Zhu for her suggestions on concept visualization. This work was supported by grants from the National Institutes of Health (UM1HG009393 to J.T.L. and H.Y.; R01DK115398, R01DK127778, and R01HD082568 to H.Y.). L.Y. was supported by the Cornell Presidential Life Sciences Fellowship.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P68">Competing Interests Statement</p>
      <p id="P69">Authors declare no competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><name><surname>Heintzman</surname><given-names>ND</given-names></name><etal/><article-title>Distinct and predictive chromatin signatures of transcriptional promoters and enhancers in the human genome</article-title>. <source>Nat. Genet</source><volume>39</volume>, <fpage>311</fpage>–<lpage>318</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17277777</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><name><surname>Calo</surname><given-names>E</given-names></name>. &amp; <name><surname>Wysocka</surname><given-names>J</given-names></name>. <article-title>Modification of enhancer chromatin: what, how, and why?</article-title>
<source>Mol. Cell</source>
<volume>49</volume>, <fpage>825</fpage>–<lpage>837</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23473601</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>T-K</given-names></name><etal/><article-title>Widespread transcription at neuronal activity-regulated enhancers</article-title>. <source>Nature</source><volume>465</volume>, <fpage>182</fpage>–<lpage>187</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20393465</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><name><surname>Descostes</surname><given-names>N</given-names></name>. <etal/><article-title>Tyrosine phosphorylation of RNA polymerase II CTD is associated with antisense promoter transcription and active enhancers in mammalian cells</article-title>. <source>Elife</source><volume>3</volume>, e02105 (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="R5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><name><surname>Andersson</surname><given-names>R</given-names></name>. <etal/><article-title>An atlas of active enhancers across human cell types and tissues</article-title>. <source>Nature</source><volume>507</volume>, <fpage>455</fpage>–<lpage>461</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24670763</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><name><surname>Tippens</surname><given-names>ND</given-names></name><etal/><article-title>Transcription imparts architecture, function and logic to enhancer units</article-title>. <source>Nat. Genet</source><volume>52</volume>, <fpage>1067</fpage>–<lpage>1075</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32958950</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><name><surname>Core</surname><given-names>LJ</given-names></name><etal/><article-title>Analysis of nascent RNA identifies a unified architecture of initiation regions at mammalian promoters and enhancers</article-title>. <source>Nat. Genet</source><volume>46</volume>, <fpage>1311</fpage>–<lpage>1320</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25383968</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><name><surname>Tome</surname><given-names>JM</given-names></name>, <name><surname>Tippens</surname><given-names>ND</given-names></name> &amp; <name><surname>Lis</surname><given-names>JT</given-names></name>
<article-title>Single-molecule nascent RNA sequencing identifies regulatory domain architecture at promoters and enhancers</article-title>. <source>Nat. Genet</source>
<volume>50</volume>, <fpage>1533</fpage>–<lpage>1541</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30349116</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><name><surname>Kruesi</surname><given-names>WS</given-names></name>, <name><surname>Core</surname><given-names>LJ</given-names></name>, <name><surname>Waters</surname><given-names>CT</given-names></name>, <name><surname>Lis</surname><given-names>JT</given-names></name> &amp; <name><surname>Meyer</surname><given-names>BJ</given-names></name>
<article-title>Condensin controls recruitment of RNA polymerase II to achieve nematode X-chromosome dosage compensation</article-title>. <source>Elife</source>
<volume>2</volume>, e00808 (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="R10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><name><surname>Kwak</surname><given-names>H</given-names></name>, <name><surname>Fuda</surname><given-names>NJ</given-names></name>, <name><surname>Core</surname><given-names>LJ</given-names></name> &amp; <name><surname>Lis</surname><given-names>JT</given-names></name>
<article-title>Precise maps of RNA polymerase reveal how promoters direct initiation and pausing</article-title>. <source>Science</source>
<volume>339</volume>, <fpage>950</fpage>–<lpage>953</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23430654</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><name><surname>Henriques</surname><given-names>T</given-names></name>. <etal/><article-title>Widespread transcriptional pausing and elongation control at enhancers</article-title>. <source>Genes Dev</source>. <volume>32</volume>, <fpage>26</fpage>–<lpage>41</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29378787</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><name><surname>Kodzius</surname><given-names>R</given-names></name>. <etal/><article-title>CAGE: cap analysis of gene expression</article-title>. <source>Nat. Methods</source><volume>3</volume>, <fpage>211</fpage>–<lpage>222</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16489339</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><name><surname>Batut</surname><given-names>P</given-names></name>, <name><surname>Dobin</surname><given-names>A</given-names></name>, <name><surname>Plessy</surname><given-names>C</given-names></name>, <name><surname>Carninci</surname><given-names>P</given-names></name>. &amp; <name><surname>Gingeras</surname><given-names>TR</given-names></name>
<article-title>High-fidelity promoter profiling reveals widespread alternative promoter usage and transposon-driven developmental gene expression</article-title>. <source>Genome Res</source>. <volume>23</volume>, <fpage>169</fpage>–<lpage>180</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">22936248</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><name><surname>Hirabayashi</surname><given-names>S</given-names></name>. <etal/><article-title>NET-CAGE characterizes the dynamics and topology of human transcribed cis-regulatory elements</article-title>. <source>Nat. Genet</source><volume>51</volume>, <fpage>1369</fpage>–<lpage>1379</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31477927</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><name><surname>Duttke</surname><given-names>SH</given-names></name>, <name><surname>Chang</surname><given-names>MW</given-names></name>, <name><surname>Heinz</surname><given-names>S</given-names></name>. &amp; <name><surname>Benner</surname><given-names>C</given-names></name>. <article-title>Identification and dynamic quantification of regulatory elements using total RNA</article-title>. <source>Genome Res</source>. <volume>29</volume>, <fpage>1836</fpage>–<lpage>1846</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31649059</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><name><surname>Policastro</surname><given-names>RA</given-names></name>, <name><surname>Raborn</surname><given-names>RT</given-names></name>, <name><surname>Brendel</surname><given-names>VP</given-names></name> &amp; <name><surname>Zentner</surname><given-names>GE</given-names></name>
<article-title>Simple and efficient profiling of transcription initiation and transcript levels with STRIPE-seq</article-title>. <source>Genome Res</source>. <volume>30</volume>, <fpage>910</fpage>–<lpage>923</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32660958</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><name><surname>Core</surname><given-names>LJ</given-names></name>, <name><surname>Waterfall</surname><given-names>JJ</given-names></name> &amp; <name><surname>Lis</surname><given-names>JT</given-names></name>
<article-title>Nascent RNA sequencing reveals widespread pausing and divergent initiation at human promoters</article-title>. <source>Science</source>
<volume>322</volume>, <fpage>1845</fpage>–<lpage>1848</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">19056941</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><name><surname>Nojima</surname><given-names>T</given-names></name>. <etal/><article-title>Mammalian NET-Seq Reveals Genome-wide Nascent Transcription Coupled to RNA Processing</article-title>. <source>Cell</source><volume>161</volume>, <fpage>526</fpage>–<lpage>540</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25910207</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><name><surname>Paulsen</surname><given-names>MT</given-names></name><etal/><article-title>Coordinated regulation of synthesis and stability of RNA during the acute TNF-induced proinflammatory response</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source><volume>110</volume>, <fpage>2240</fpage>–<lpage>2245</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23345452</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><name><surname>Magnuson</surname><given-names>B</given-names></name>. <etal/><article-title>Identifying transcription start sites and active enhancer elements using BruUV-seq</article-title>. <source>Sci. Rep</source><volume>5</volume>, <fpage>17978</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26656874</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>H</given-names></name>. <etal/><article-title>A Pan-Cancer Analysis of Enhancer Expression in Nearly 9000 Patient Samples</article-title>. <source>Cell</source><volume>173</volume>, <fpage>386</fpage>–<lpage>399</lpage>.e12 (<year>2018</year>).<pub-id pub-id-type="pmid">29625054</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>. <etal/><article-title>Transcriptional landscape and clinical utility of enhancer RNAs for eRNA-targeted therapy in cancer</article-title>. <source>Nat. Commun</source><volume>10</volume>, <fpage>4562</fpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31594934</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><name><surname>Azofeifa</surname><given-names>JG</given-names></name> &amp; <name><surname>Dowell</surname><given-names>RD</given-names></name>
<article-title>A generative model for the behavior of RNA polymerase</article-title>. <source>Bioinformatics</source>
<volume>33</volume>, <fpage>227</fpage>–<lpage>234</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">27663494</pub-id></mixed-citation>
    </ref>
    <ref id="R24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><name><surname>Danko</surname><given-names>CG</given-names></name><etal/><article-title>Identification of active transcriptional regulatory elements from GRO-seq data</article-title>. <source>Nat. Methods</source><volume>12</volume>, <fpage>433</fpage>–<lpage>438</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25799441</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Chu</surname><given-names>T</given-names></name>, <name><surname>Choate</surname><given-names>LA</given-names></name> &amp; <name><surname>Danko</surname><given-names>CG</given-names></name>
<article-title>Identification of regulatory elements from nascent transcription using dREG</article-title>. <source>Genome Res</source>. <volume>29</volume>, <fpage>293</fpage>–<lpage>303</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30573452</pub-id></mixed-citation>
    </ref>
    <ref id="R26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><name><surname>Chu</surname><given-names>T</given-names></name>. <etal/><article-title>Chromatin run-on and sequencing maps the transcriptional regulatory landscape of glioblastoma multiforme</article-title>. <source>Nat. Genet</source><volume>50</volume>, <fpage>1553</fpage>–<lpage>1564</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30349114</pub-id></mixed-citation>
    </ref>
    <ref id="R27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><name><surname>Adiconis</surname><given-names>X</given-names></name>. <etal/><article-title>Comprehensive comparative analysis of 5’-end RNA-sequencing methods</article-title>. <source>Nat. Methods</source><volume>15</volume>, <fpage>505</fpage>–<lpage>511</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29867192</pub-id></mixed-citation>
    </ref>
    <ref id="R28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><name><surname>Frith</surname><given-names>MC</given-names></name><etal/><article-title>A code for transcription initiation in mammalian genomes</article-title>. <source>Genome Res</source>. <volume>18</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18032727</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><name><surname>Thakore</surname><given-names>PI</given-names></name><etal/><article-title>Highly specific epigenome editing by CRISPR-Cas9 repressors for silencing of distal regulatory elements</article-title>. <source>Nat. Methods</source><volume>12</volume>, <fpage>1143</fpage>–<lpage>1149</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26501517</pub-id></mixed-citation>
    </ref>
    <ref id="R30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><name><surname>Fulco</surname><given-names>CP</given-names></name><etal/><article-title>Systematic mapping of functional enhancer-promoter connections with CRISPR interference</article-title>. <source>Science</source><volume>354</volume>, <fpage>769</fpage>–<lpage>773</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27708057</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><name><surname>Wakabayashi</surname><given-names>A</given-names></name>. <etal/><article-title>Insight into GATA1 transcriptional activity through interrogation of cis elements disrupted in human erythroid disorders</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source><volume>113</volume>, <fpage>4434</fpage>–<lpage>4439</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27044088</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><name><surname>Klann</surname><given-names>TS</given-names></name><etal/><article-title>CRISPR-Cas9 epigenome editing enables high-throughput screening for functional regulatory elements in the human genome</article-title>. <source>Nat. Biotechnol</source><volume>35</volume>, <fpage>561</fpage>–<lpage>568</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28369033</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>S</given-names></name>, <name><surname>Duan</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Zhou</surname><given-names>P</given-names></name>. &amp; <name><surname>Hon</surname><given-names>GC</given-names></name>
<article-title>Multiplexed Engineering and Analysis of Combinatorial Enhancer Activity in Single Cells</article-title>. <source>Mol. Cell</source>
<volume>66</volume>, <fpage>285</fpage>–<lpage>299</lpage>.e5 (<year>2017</year>).<pub-id pub-id-type="pmid">28416141</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><name><surname>Gasperini</surname><given-names>M</given-names></name>. <etal/><article-title>A Genome-wide Framework for Mapping Gene Regulation via Cellular Genetic Screens</article-title>. <source>Cell</source><volume>176</volume>, <fpage>377</fpage>–<lpage>390</lpage>.e19 (<year>2019</year>).<pub-id pub-id-type="pmid">30612741</pub-id></mixed-citation>
    </ref>
    <ref id="R35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><name><surname>Fulco</surname><given-names>CP</given-names></name><etal/><article-title>Activity-by-contact model of enhancer-promoter regulation from thousands of CRISPR perturbations</article-title>. <source>Nat. Genet</source><volume>51</volume>, <fpage>1664</fpage>–<lpage>1669</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31784727</pub-id></mixed-citation>
    </ref>
    <ref id="R36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>S</given-names></name>, <name><surname>Armendariz</surname><given-names>D</given-names></name>, <name><surname>Zhou</surname><given-names>P</given-names></name>, <name><surname>Duan</surname><given-names>J</given-names></name>. &amp; <name><surname>Hon</surname><given-names>GC</given-names></name>
<article-title>Global Analysis of Enhancer Targets Reveals Convergent Enhancer-Driven Regulatory Modules</article-title>. <source>Cell Rep</source>. <volume>29</volume>, <fpage>2570</fpage>–<lpage>2578</lpage>.e5 (<year>2019</year>).<pub-id pub-id-type="pmid">31775028</pub-id></mixed-citation>
    </ref>
    <ref id="R37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><name><surname>Schraivogel</surname><given-names>D</given-names></name>. <etal/><article-title>Targeted Perturb-seq enables genome-scale genetic screens in single cells</article-title>. <source>Nat. Methods</source><volume>17</volume>, <fpage>629</fpage>–<lpage>635</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32483332</pub-id></mixed-citation>
    </ref>
    <ref id="R38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><name><surname>Kheradpour</surname><given-names>P</given-names></name>. <etal/><article-title>Systematic dissection of regulatory motifs in 2000 predicted human enhancers using a massively parallel reporter assay</article-title>. <source>Genome Res</source>. <volume>23</volume>, <fpage>800</fpage>–<lpage>811</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23512712</pub-id></mixed-citation>
    </ref>
    <ref id="R39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><name><surname>Kwasnieski</surname><given-names>JC</given-names></name>, <name><surname>Fiore</surname><given-names>C</given-names></name>, <name><surname>Chaudhari</surname><given-names>HG</given-names></name> &amp; <name><surname>Cohen</surname><given-names>BA</given-names></name>
<article-title>High-throughput functional testing of ENCODE segmentation predictions</article-title>. <source>Genome Res</source>. <volume>24</volume>, <fpage>1595</fpage>–<lpage>1602</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25035418</pub-id></mixed-citation>
    </ref>
    <ref id="R40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><name><surname>Ulirsch</surname><given-names>JC</given-names></name><etal/><article-title>Systematic Functional Dissection of Common Genetic Variation Affecting Red Blood Cell Traits</article-title>. <source>Cell</source><volume>165</volume>, <fpage>1530</fpage>–<lpage>1545</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27259154</pub-id></mixed-citation>
    </ref>
    <ref id="R41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><name><surname>Ernst</surname><given-names>J</given-names></name>. <etal/><article-title>Genome-scale high-resolution mapping of activating and repressive nucleotides in regulatory regions</article-title>. <source>Nat. Biotechnol</source><volume>34</volume>, <fpage>1180</fpage>–<lpage>1190</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27701403</pub-id></mixed-citation>
    </ref>
    <ref id="R42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><name><surname>Maricque</surname><given-names>BB</given-names></name>, <name><surname>Chaudhari</surname><given-names>HG</given-names></name> &amp; <name><surname>Cohen</surname><given-names>BA</given-names></name>
<article-title>A massively parallel reporter assay dissects the influence of chromatin structure on cis-regulatory activity</article-title>. <source>Nat. Biotechnol</source> (<year>2018</year>) doi:<pub-id pub-id-type="doi">10.1038/nbt.4285</pub-id>.</mixed-citation>
    </ref>
    <ref id="R43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><name><surname>Rathert</surname><given-names>P</given-names></name>. <etal/><article-title>Transcriptional plasticity promotes primary and acquired resistance to BET inhibition</article-title>. <source>Nature</source><volume>525</volume>, <fpage>543</fpage>–<lpage>547</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26367798</pub-id></mixed-citation>
    </ref>
    <ref id="R44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><name><surname>Dao</surname><given-names>LTM</given-names></name><etal/><article-title>Genome-wide characterization of mammalian promoters with distal enhancer functions</article-title>. <source>Nat. Genet</source><volume>49</volume>, <fpage>1073</fpage>–<lpage>1081</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28581502</pub-id></mixed-citation>
    </ref>
    <ref id="R45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>D</given-names></name>. <etal/><article-title>STARRPeaker: uniform processing and accurate identification of STARR-seq active regions</article-title>. <source>Genome Biol</source>. <volume>21</volume>, <fpage>298</fpage> (<year>2020</year>).<pub-id pub-id-type="pmid">33292397</pub-id></mixed-citation>
    </ref>
    <ref id="R46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>. <etal/><article-title>High-resolution genome-wide functional dissection of transcriptional regulatory regions and nucleotides in human</article-title>. <source>Nat. Commun</source><volume>9</volume>, <fpage>5380</fpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30568279</pub-id></mixed-citation>
    </ref>
    <ref id="R47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><name><surname>Schwalb</surname><given-names>B</given-names></name>. <etal/><article-title>TT-seq maps the human transient transcriptome</article-title>. <source>Science</source><volume>352</volume>, <fpage>1225</fpage>–<lpage>1228</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27257258</pub-id></mixed-citation>
    </ref>
    <ref id="R48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><name><surname>Core</surname><given-names>LJ</given-names></name><etal/><article-title>Defining the status of RNA polymerase at promoters</article-title>. <source>Cell Rep</source>. <volume>2</volume>, <fpage>1025</fpage>–<lpage>1035</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23062713</pub-id></mixed-citation>
    </ref>
    <ref id="R49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><name><surname>Mchaourab</surname><given-names>ZF</given-names></name>, <name><surname>Perreault</surname><given-names>AA</given-names></name> &amp; <name><surname>Venters</surname><given-names>BJ</given-names></name>
<article-title>ChIP-seq and ChIP-exo profiling of Pol II, H2A.Z, and H3K4me3 in human K562 cells</article-title>. <source>Sci Data</source>
<volume>5</volume>, <fpage>180030</fpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29509191</pub-id></mixed-citation>
    </ref>
    <ref id="R50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><name><surname>Harrow</surname><given-names>J</given-names></name>. <etal/><article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>. <source>Genome Res</source>. <volume>22</volume>, <fpage>1760</fpage>–<lpage>1774</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22955987</pub-id></mixed-citation>
    </ref>
    <ref id="R51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><name><surname>O’Leary</surname><given-names>NA</given-names></name><etal/><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>. <source>Nucleic Acids Res</source>. <volume>44</volume>, <fpage>D733</fpage>–<lpage>45</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">26553804</pub-id></mixed-citation>
    </ref>
    <ref id="R52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>. <article-title>Repbase update: a database and an electronic journal of repetitive elements</article-title>. <source>Trends Genet</source>. <volume>16</volume>, <fpage>418</fpage>–<lpage>420</lpage> (<year>2000</year>).<pub-id pub-id-type="pmid">10973072</pub-id></mixed-citation>
    </ref>
    <ref id="R53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><name><surname>Djebali</surname><given-names>S</given-names></name>. <etal/><article-title>Landscape of transcription in human cells</article-title>. <source>Nature</source><volume>489</volume>, <fpage>101</fpage>–<lpage>108</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22955620</pub-id></mixed-citation>
    </ref>
    <ref id="R54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><name><surname>Field</surname><given-names>A</given-names></name>. &amp; <name><surname>Adelman</surname><given-names>K</given-names></name>. <article-title>Evaluating Enhancer Function and Transcription</article-title>. <source>Annu. Rev. Biochem</source>
<volume>89</volume>, <fpage>213</fpage>–<lpage>234</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32197056</pub-id></mixed-citation>
    </ref>
    <ref id="R55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><name><surname>Andersson</surname><given-names>R</given-names></name>. &amp; <name><surname>Sandelin</surname><given-names>A</given-names></name>. <article-title>Determinants of enhancer and promoter activities of regulatory elements</article-title>. <source>Nat. Rev. Genet</source>
<volume>21</volume>, <fpage>71</fpage>–<lpage>87</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">31605096</pub-id></mixed-citation>
    </ref>
    <ref id="R56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><name><surname>Palazzo</surname><given-names>AF</given-names></name> &amp; <name><surname>Koonin</surname><given-names>EV</given-names></name>
<article-title>Functional Long Non-coding RNAs Evolve from Junk Transcripts</article-title>. <source>Cell</source>
<volume>183</volume>, <fpage>1151</fpage>–<lpage>1161</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">33068526</pub-id></mixed-citation>
    </ref>
    <ref id="R57">
      <label>57.</label>
      <mixed-citation publication-type="journal">ENCODE Project Consortium <etal/>
<article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>. <source>Nature</source>
<volume>583</volume>, <fpage>699</fpage>–<lpage>710</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32728249</pub-id></mixed-citation>
    </ref>
    <ref id="R58">
      <label>58.</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>D</given-names></name>. <etal/><article-title>Reprogramming transcription by distinct classes of enhancers functionally defined by eRNA</article-title>. <source>Nature</source><volume>474</volume>, <fpage>390</fpage>–<lpage>394</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21572438</pub-id></mixed-citation>
    </ref>
    <ref id="R59">
      <label>59.</label>
      <mixed-citation publication-type="journal"><name><surname>Chae</surname><given-names>M</given-names></name>, <name><surname>Danko</surname><given-names>CG</given-names></name> &amp; <name><surname>Kraus</surname><given-names>WL</given-names></name>
<article-title>groHMM: a computational tool for identifying unannotated and cell type-specific transcription units from global run-on sequencing data</article-title>. <source>BMC Bioinformatics</source>
<volume>16</volume>, <fpage>222</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26173492</pub-id></mixed-citation>
    </ref>
    <ref id="R60">
      <label>60.</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>. <etal/><article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>. <volume>9</volume>, <fpage>R137</fpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="R61">
      <label>61.</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>VA</given-names></name><etal/><article-title>Evaluation of GRCh38 and de novo haploid genome assemblies demonstrates the enduring quality of the reference assembly</article-title>. <source>Genome Res</source>. <volume>27</volume>, <fpage>849</fpage>–<lpage>864</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28396521</pub-id></mixed-citation>
    </ref>
    <ref id="R62">
      <label>62.</label>
      <mixed-citation publication-type="journal"><collab>Roadmap Epigenomics Consortium</collab><etal/><article-title>Integrative analysis of 111 reference human epigenomes</article-title>. <source>Nature</source><volume>518</volume>, <fpage>317</fpage>–<lpage>330</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25693563</pub-id></mixed-citation>
    </ref>
    <ref id="R63">
      <label>63.</label>
      <mixed-citation publication-type="journal"><name><surname>Pennacchio</surname><given-names>LA</given-names></name>, <name><surname>Bickmore</surname><given-names>W</given-names></name>, <name><surname>Dean</surname><given-names>A</given-names></name>, <name><surname>Nobrega</surname><given-names>MA</given-names></name> &amp; <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>Enhancers: five essential questions</article-title>. <source>Nat. Rev. Genet</source>
<volume>14</volume>, <fpage>288</fpage>–<lpage>295</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23503198</pub-id></mixed-citation>
    </ref>
    <ref id="R64">
      <label>64.</label>
      <mixed-citation publication-type="journal"><name><surname>Vo Ngoc</surname><given-names>L</given-names></name>, <name><surname>Huang</surname><given-names>CY</given-names></name>, <name><surname>Cassidy</surname><given-names>CJ</given-names></name>, <name><surname>Medrano</surname><given-names>C</given-names></name>. &amp; <name><surname>Kadonaga</surname><given-names>JT</given-names></name>
<article-title>Identification of the human DPR core promoter element using machine learning</article-title>. <source>Nature</source>
<volume>585</volume>, <fpage>459</fpage>–<lpage>463</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32908305</pub-id></mixed-citation>
    </ref>
    <ref id="R65">
      <label>65.</label>
      <mixed-citation publication-type="journal"><name><surname>Fornes</surname><given-names>O</given-names></name>. <etal/><article-title>JASPAR 2020: update of the open-access database of transcription factor binding profiles</article-title>. <source>Nucleic Acids Res</source>. <volume>48</volume>, <fpage>D87</fpage>–<lpage>D92</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">31701148</pub-id></mixed-citation>
    </ref>
    <ref id="R66">
      <label>66.</label>
      <mixed-citation publication-type="journal"><name><surname>Landrum</surname><given-names>MJ</given-names></name><etal/><article-title>ClinVar: improvements to accessing data</article-title>. <source>Nucleic Acids Res</source>. <volume>48</volume>, <fpage>D835</fpage>–<lpage>D844</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">31777943</pub-id></mixed-citation>
    </ref>
    <ref id="R67">
      <label>67.</label>
      <mixed-citation publication-type="journal"><name><surname>Vahrenkamp</surname><given-names>JM</given-names></name><etal/><article-title>FFPEcap-seq: a method for sequencing capped RNAs in formalin-fixed paraffin-embedded samples</article-title>. <source>Genome Res</source>. <volume>29</volume>, <fpage>1826</fpage>–<lpage>1835</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31649055</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <ref-list>
    <title>Methods References</title>
    <ref id="R68">
      <label>68.</label>
      <mixed-citation publication-type="journal"><name><surname>Yao</surname><given-names>L</given-names></name>, <name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Song</surname><given-names>Y</given-names></name>. &amp; <name><surname>Sui</surname><given-names>G</given-names></name>. <article-title>BioQueue: a novel pipeline framework to accelerate bioinformatics analysis</article-title>. <source>Bioinformatics</source>
<volume>33</volume>, <fpage>3286</fpage>–<lpage>3288</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28633441</pub-id></mixed-citation>
    </ref>
    <ref id="R69">
      <label>69.</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>. &amp; <name><surname>Gu</surname><given-names>J</given-names></name>. <article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor</article-title>. <source>Bioinformatics</source>
<volume>34</volume>, <fpage>i884</fpage>–<lpage>i890</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30423086</pub-id></mixed-citation>
    </ref>
    <ref id="R70">
      <label>70.</label>
      <mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>A</given-names></name>. <etal/><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="R71">
      <label>71.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>. &amp; <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="R72">
      <label>72.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>. <etal/><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source><volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="R73">
      <label>73.</label>
      <mixed-citation publication-type="journal"><name><surname>Ramírez</surname><given-names>F</given-names></name>. <etal/><article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>. <volume>44</volume>, <fpage>W160</fpage>–<lpage>5</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
    <ref id="R74">
      <label>74.</label>
      <mixed-citation publication-type="journal"><name><surname>Harris</surname><given-names>CR</given-names></name><etal/><article-title>Array programming with NumPy</article-title>. <source>Nature</source><volume>585</volume>, <fpage>357</fpage>–<lpage>362</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="R75">
      <label>75.</label>
      <mixed-citation publication-type="journal"><name><surname>Virtanen</surname><given-names>P</given-names></name>. <etal/><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat. Methods</source><volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="R76">
      <label>76.</label>
      <mixed-citation publication-type="confproc"><name><surname>Seabold</surname><given-names>S</given-names></name>. &amp; <name><surname>Perktold</surname><given-names>J</given-names></name>. <source>Statsmodels: Econometric and Statistical Modeling with Python</source>. <conf-name>Proceedings of the 9th Python in Science Conference</conf-name> (<year>2010</year>) doi:<pub-id pub-id-type="doi">10.25080/majora-92bf1922-011</pub-id>.</mixed-citation>
    </ref>
    <ref id="R77">
      <label>77.</label>
      <mixed-citation publication-type="journal"><name><surname>Dale</surname><given-names>RK</given-names></name>, <name><surname>Pedersen</surname><given-names>BS</given-names></name> &amp; <name><surname>Quinlan</surname><given-names>AR</given-names></name>
<article-title>Pybedtools: a flexible Python library for manipulating genomic datasets and annotations</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>3423</fpage>–<lpage>3424</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21949271</pub-id></mixed-citation>
    </ref>
    <ref id="R78">
      <label>78.</label>
      <mixed-citation publication-type="journal"><name><surname>Cock</surname><given-names>PJA</given-names></name><etal/><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source> vol. <volume>25</volume>
<fpage>1422</fpage>–<lpage>1423</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="R79">
      <label>79.</label>
      <mixed-citation publication-type="journal"><name><surname>Quinlan</surname><given-names>AR</given-names></name> &amp; <name><surname>Hall</surname><given-names>IM</given-names></name>
<article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>
<volume>26</volume>, <fpage>841</fpage>–<lpage>842</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="R80">
      <label>80.</label>
      <mixed-citation publication-type="journal"><name><surname>Sherry</surname><given-names>ST</given-names></name><etal/><article-title>dbSNP: the NCBI database of genetic variation</article-title>. <source>Nucleic Acids Res</source>. <volume>29</volume>, <fpage>308</fpage>–<lpage>311</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11125122</pub-id></mixed-citation>
    </ref>
    <ref id="R81">
      <label>81.</label>
      <mixed-citation publication-type="journal"><name><surname>Preker</surname><given-names>P</given-names></name>. <etal/><article-title>RNA exosome depletion reveals transcription upstream of active human promoters</article-title>. <source>Science</source><volume>322</volume>, <fpage>1851</fpage>–<lpage>1854</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">19056938</pub-id></mixed-citation>
    </ref>
    <ref id="R82">
      <label>82.</label>
      <mixed-citation publication-type="journal"><name><surname>van Arensbergen</surname><given-names>J</given-names></name>. <etal/><article-title>Genome-wide mapping of autonomous promoter activity in human cells</article-title>. <source>Nat. Biotechnol</source><volume>35</volume>, <fpage>145</fpage>–<lpage>153</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28024146</pub-id></mixed-citation>
    </ref>
    <ref id="R83">
      <label>83.</label>
      <mixed-citation publication-type="journal"><name><surname>Shivram</surname><given-names>H</given-names></name>. &amp; <name><surname>Iyer</surname><given-names>VR</given-names></name>
<article-title>Identification and removal of sequencing artifacts produced by mispriming during reverse transcription in multiple RNA-seq technologies</article-title>. <source>RNA</source>
<volume>24</volume>, <fpage>1266</fpage>–<lpage>1274</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29950518</pub-id></mixed-citation>
    </ref>
    <ref id="R84">
      <label>84.</label>
      <mixed-citation publication-type="journal"><name><surname>Bedi</surname><given-names>K</given-names></name>, <name><surname>Paulsen</surname><given-names>MT</given-names></name>, <name><surname>Wilson</surname><given-names>TE</given-names></name> &amp; <name><surname>Ljungman</surname><given-names>M</given-names></name>. <article-title>Characterization of novel primary miRNA transcription units in human cells using Bru-seq nascent RNA sequencing</article-title>. <source>NAR Genom Bioinform</source>
<volume>2</volume>, lqz014 (<year>2020</year>).</mixed-citation>
    </ref>
    <ref id="R85">
      <label>85.</label>
      <mixed-citation publication-type="journal"><name><surname>Zacher</surname><given-names>B</given-names></name>. <etal/><article-title>Accurate Promoter and Enhancer Identification in 127 ENCODE and Roadmap Epigenomics Cell Types and Tissues by GenoSTAN</article-title>. <source>PLoS One</source><volume>12</volume>, <fpage>e0169249</fpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28056037</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="F1">
    <label>Fig. 1.</label>
    <caption>
      <title>Comparison of currently available assays for detecting eRNAs.</title>
      <p id="P70"><bold>a</bold>, Schematics of enhancer and promoter/gene transcription by RNA Pol II (left panel) and characteristic profiles of TSS- and NT-assays (right panel, light-blue shaded area). Black lines represent genomic DNA; nascent RNAs are purple curved lines with 5′ and 3′ ends colored blue and red, respectively, with gray spheres as caps and yellow ovals indicate RNA Pol IIs. Arrows indicate the direction of sequencing reads, TSS-assay in blue, and NT-assay in red. Representative read density profiles are colored accordingly in blue and red for TSS- and NT-assays, respectively. TSS: transcription start site; CPS: cleavage polyadenylation site; TTS: transcription termination site. <bold>b</bold>, Enrichment strategies used by different TSS- and NT-assays. TEX: terminator exonuclease. A detailed description is available in <xref rid="SD1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0001" position="float"/>
  </fig>
  <fig position="float" id="F2">
    <label>Fig. 2.</label>
    <caption>
      <title>Evaluation of assay sensitivity in eRNA detection.</title>
      <p id="P71"><bold>a</bold>, The capability of different assays to capture validated enhancers (CRISPR-identified enhancer set). All libraries were downsampled to the same sequencing depth. “Unidirectional” and “divergent” indicate the detection of eRNAs originated from either one or both strands of the enhancer loci, respectively. <bold>b</bold>, Differences in read coverage among stable (<inline-formula><mml:math id="M49" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>13,861</mml:mn></mml:math></inline-formula>) and unstable (<inline-formula><mml:math id="M50" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6,380</mml:mn></mml:math></inline-formula>) transcripts. GRO-cap has the highest coverage of both stable and unstable transcripts and the least preference toward stable transcripts. Preferences (effect sizes) were evaluated as Cohen’s <italic toggle="yes">d</italic> via bootstrap (<inline-formula><mml:math id="M51" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5,000</mml:mn></mml:math></inline-formula>). In the box plot, the center dots, box limits, and whiskers denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively.</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0002" position="float"/>
  </fig>
  <fig position="float" id="F3">
    <label>Fig. 3.</label>
    <caption>
      <title>Characterization of factors affecting assay sensitivity and evaluation of assay specificity in eRNA detection.</title>
      <p id="P72"><bold>a</bold>, Genome-wide distribution of sequencing reads originated from intergenic regions, introns, exons, and promoters detected by different assays. <bold>b</bold>, A genome browser snapshot of a gene (<italic toggle="yes">FAM89A</italic>) and its enhancer (highlighted in yellow), demonstrating the different patterns of signals captured by TSS- (enriched in the promoter and enhancer regions) <italic toggle="yes">vs.</italic> NT- (enriched in the promoter and gene body regions) assays. Signals are normalized by reads per million (RPM). <bold>c</bold>, Specificity in detecting eRNAs. Top track: differences of read coverage among CRISPR-identified enhancer (<inline-formula><mml:math id="M52" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>803</mml:mn></mml:math></inline-formula>) and non-enhancer (<inline-formula><mml:math id="M53" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6,777</mml:mn></mml:math></inline-formula>) loci, a pseudo-count (1) was added to each locus, and the coverage was log-transformed. Bottom track: signal-to-noise ratios depicted in forms of fold enrichment (FE), the results are based on bootstrapped samples (<inline-formula><mml:math id="M54" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10,000</mml:mn></mml:math></inline-formula>), median statistics are used to calculate the fold changes. In the box plot, the center dots, box limits, and whiskers denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively. <bold>d</bold>, False discovery rates (FDRs) estimated by the overlap between the top 20,000 genomic bins and the reference (803 CRISPR-identified and 6,777 non-enhancer) loci. Downsampled libraries were used (<inline-formula><mml:math id="M55" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula>); values and error bars represent the mean and SD.</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0003" position="float"/>
  </fig>
  <fig position="float" id="F4">
    <label>Fig. 4.</label>
    <caption>
      <title>PINTS achieves the best balance among resolution, robustness, sensitivity, specificity, and computational resources required.</title>
      <p id="P73"><bold>a</bold> and <bold>b</bold>, Profiles of GATA1 binding sites and H3K27ac pattern in CRISPR-identified enhancer regions and distal TREs identified by different peak callers. <bold>c</bold>, Distribution of element sizes identified by different tools. Sample size from the top to the bottom: 38,703, 9,546, 19,886, 51,128, 56,300, 17,152, 54,002, 40,042, 35,998. In the box plot, the center lines, box limits, and whiskers denote the median, upper and lower quartiles, and 1.5× interquartile range, respectively. Points show observations that are not in the 1.5× interquartile range. <bold>d</bold>, CPU time consumed by peak callers to identify elements from various TSS-assay libraries. The average CPU time labeled inside each bar is in the unit of hours (<inline-formula><mml:math id="M56" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula>). The <italic toggle="yes">x</italic>-axis is in <inline-formula><mml:math id="M57" display="inline"><mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> scale. <bold>e</bold>, Maximum memory usage during peak calling from TSS-assay libraries. The average maximum usage labeled inside or on top of each bar is in the unit of gigabytes (<inline-formula><mml:math id="M58" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula>). For <bold>d</bold> and <bold>e</bold>, values and error bars represent the mean and SD. <bold>f</bold>, Robustness of peak calls made by different tools. Libraries were mapped to both hg19 and hg38, and robustness was measured as the Jaccard index between calls from hg19 and hg38 (lifted over). Cells colored in gray indicate either that the tool cannot be applied to the corresponding assays or that one or more required datasets are not available. <bold>g</bold>, Aggregated ROC curves for each peak caller on all TSS-assay datasets (<inline-formula><mml:math id="M59" display="inline"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:math></inline-formula>). The solid lines represent the mean values; the corresponding shaded areas show the 95% confidence interval of the means (via bootstrap). For tools where ROCs cannot be calculated, solid dots represent their performance with default parameters. Values and error bars show the mean and SD.</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0004" position="float"/>
  </fig>
  <fig position="float" id="F5">
    <label>Fig. 5.</label>
    <caption>
      <title>A comprehensive human enhancer compendium.</title>
      <p id="P74"><bold>a</bold>, Summaries of all distal elements identified from different assays with PINTS in 7 cell lines (top) and 131 datasets generated by different assays across 120 biosamples included in our enhancer compendium (bottom). Differentiated cells stand for <italic toggle="yes">in vitro</italic> differentiated cells. <bold>b</bold>, The number of distal elements identified by PINTS from different assays in K562. The dark colors indicate the proportion of shared elements identified from at least one other assay; light colors indicate elements unique to the corresponding assay. The number of mappable reads for each assay is listed in the parentheses. <bold>c</bold>, A known enhancer locus where most of these assays captured signals on both strands. <bold>d</bold>, A known enhancer locus where only GRO-cap and csRNA-seq captured detectable signals. <bold>e</bold>, A known enhancer locus where only GRO-cap captures clear signals. Signal tracks in <bold>c</bold>, <bold>d</bold>, and <bold>e</bold> were normalized by their sequencing depths (RPM).</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0005" position="float"/>
  </fig>
  <fig position="float" id="F6">
    <label>Fig. 6.</label>
    <caption>
      <title>Interactive PINTS web server.</title>
      <p id="P75">The server is composed of three modules: a catalog database containing our human enhancer compendium across 120 biosamples, an interactive user interface, and analytical engines. When the user provides genomic loci of their interest as search queries, previously annotated information related to the loci will be retrieved from the catalog database. The user can further refine the search results by a series of filters, including the supporting assays, callers, the presence of mutations, transcription factor binding sites, core promoter elements, and epigenomic marks. On the other hand, if the user chooses to upload peak calls generated from their data, the analytical engines will analyze the uploads to provide the same types of annotations as those in the catalog database.</p>
    </caption>
    <graphic xlink:href="nihms-1769925-f0006" position="float"/>
  </fig>
</floats-group>
