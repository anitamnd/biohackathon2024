<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10161648</article-id>
    <article-id pub-id-type="publisher-id">225</article-id>
    <article-id pub-id-type="doi">10.1186/s13015-023-00225-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pangenomic genotyping with the marker array</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mun</surname>
          <given-names>Taher</given-names>
        </name>
        <address>
          <email>tmun1@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vaddadi</surname>
          <given-names>Naga Sai Kavya</given-names>
        </name>
        <address>
          <email>kvaddad1@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Langmead</surname>
          <given-names>Ben</given-names>
        </name>
        <address>
          <email>langmea@cs.jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>2</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We present a new method and software tool called rowbowt that applies a pangenome index to the problem of inferring genotypes from short-read sequencing data. The method uses a novel indexing structure called the marker array. Using the marker array, we can genotype variants with respect from large panels like the 1000 Genomes Project while reducing the reference bias that results when aligning to a single linear reference. rowbowt can infer accurate genotypes in less time and memory compared to existing graph-based methods. The method is implemented in the open source software tool rowbowt available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alshai/rowbowt">https://github.com/alshai/rowbowt</ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sequence alignment</kwd>
      <kwd>Indexing</kwd>
      <kwd>Genotyping</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG011392</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM139602</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Directorate for Biological Sciences</institution>
        </funding-source>
        <award-id>2029552</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Given DNA sequencing reads from a donor individual, genotyping is the task of determining which alleles the individual has at polymorphic sites. Genotyping from sequencing data, sometimes using low-coverage sequencing data together with genotype imputation, is a common task in human genetics [<xref ref-type="bibr" rid="CR1">1</xref>] and agriculture [<xref ref-type="bibr" rid="CR2">2</xref>]. In contrast to variant calling, genotyping is performed with respect to a catalog of known polymorphic sites. For instance, genotyping of a human can be performed with respect to the 1000 Genomes Project call set, which catalogs positions, alleles and allele frequencies for tens of millions of sites [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">Many existing genotypers start by aligning reads to a single linear reference genome, e.g. the human GRCh38 reference [<xref ref-type="bibr" rid="CR4">4</xref>]. Because this reference is simply one example of an individual’s genome, genotyping is subject to reference bias, the tendency to make mistakes in places where the donor differs genetically from the reference. This was shown in studies of archaic hominids [<xref ref-type="bibr" rid="CR5">5</xref>], HLA genotypes [<xref ref-type="bibr" rid="CR6">6</xref>] and structural variants [<xref ref-type="bibr" rid="CR7">7</xref>]. A similar bias exists for methods that extract polymorphic sites along with genomic context, and search for these sequences in the reads [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. In particular, the bias remains if the flanking sequences are extracted from the reference and so contain only reference alleles.</p>
    <p id="Par4">Reference bias can be reduced by using a <italic>pangenome</italic> reference instead of a single linear reference. A pangenome can take various forms; it can be (a) a generating graph for combinations of alleles, (b) a small collection of linear references indexed separately, or (c) a larger collection of linear reference indexed together in a compressed way. Pangenome graphs (option a) and small collections of linear references (option b) have been studied in recent literature [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par5">Two existing methods that use pangenome graphs are BayesTyper [<xref ref-type="bibr" rid="CR15">15</xref>] and PanGenie [<xref ref-type="bibr" rid="CR16">16</xref>]. BayesTyper works by matching <italic>k</italic>-mers extracted from the input reads to <italic>k</italic>-mers stored in a de Bruijn graph representing known polymorphisms and their surrounding contexts. After tallying this evidence, BayesTyper calls genotypes based on a generative model. PanGenie uses a graph built from haplotypes, collapsed so that variants become bubbles. PanGenie then scans the reads and tallies <italic>k</italic>-mers that appear in the graph. It then makes genotype calls based on the tallies of how often read <italic>k</italic>-mers match to <italic>k</italic>-mers along the alternate paths that make up the distinct REF and ALT alleles.</p>
    <p id="Par6">Variant graphs like the ones used by BayesTyper and PanGenie are effective for genotyping, but have drawbacks when the goal is to reduce reference bias. First, haplotype information might be removed when adding variants to the graph, or might be included in the graph but not considered during the read mapping process. This can cause graph-based tools to consider many extraneous haplotype paths through the graph during genotyping, increasing running time. Second, variant graphs can grow exponentially—in terms of the number of paths through the graph—as variants are added, leading to a rapid increase in resource usage and likelihood of ambiguous alignments.</p>
    <p id="Par7">We sought a way to reduce reference bias by indexing and querying many linear references at once while keeping index size and query time low. Such an approach can take full advantage of linkage disequilibrium information in the panel, allowing no recombination events except those occurring in the panel. This avoids mapping ambiguity from spurious recombination events between polymorphic sites [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par8">We propose a new structure called the <italic>marker array</italic> that replaces the suffix-array-sample component of the <italic>r</italic>-index with a structure tailored to the problem of collecting genotype evidence. Here we describe the marker array structure in detail. We compare its space usage and query time to those of the standard <italic>r</italic>-index and explore how accurately both structures are able to capture markers from a sequencing dataset. Finally, we benchmark it using real whole-genome human sequencing data and compare it to the BayesTyper and PanGenie genotyping tools in terms of both genotyping accuracy and computational efficiency. We do this for variants genomewide and for variants in genes that are medically relevant.</p>
  </sec>
  <sec id="Sec2">
    <title>Background</title>
    <sec id="Sec3">
      <title><italic>r</italic>-index</title>
      <p id="Par9">The <italic>r</italic>-index [<xref ref-type="bibr" rid="CR17">17</xref>] is a compressed repeat-aware text index that scales with the non-redundant content of a sequence collection. It uses <italic>O</italic>(<italic>r</italic>) space where <italic>r</italic> is the number of same-character <italic>runs</italic> in the Burrows-Wheeler Transform (BWT) of the input text. Past work shows that the <italic>r</italic>-index can efficiently index collections of long-read-derived human genome assemblies [<xref ref-type="bibr" rid="CR18">18</xref>] as well as large collections of bacterial genomes [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par10">While the main contribution of the <italic>r</italic>-index was its strategy for storing and using a sample of the suffix array [<xref ref-type="bibr" rid="CR17">17</xref>], even this sample is large in practice. We propose a new <italic>marker array</italic> structure that replaces the suffix array while retaining its ability to deduce when a read-to-pangenome match provides evidence for a particular allele at a polymorphic site. The design of the marker array flows from three observations. First, we can save space by storing auxiliary information about polymorphic sites (“markers”) only at the sites themselves. There are often far fewer sites harboring polymorphism than there are BWT runs. Second, pangenome suffixes starting with the same allele tend to group together in the suffix array, which can be exploited to compress the marker array structure. Third, while a suffix array entry is an offset into the pangenome requiring <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq1.gif"/></alternatives></inline-formula> bits, a marker need only distinguish markers and alleles, and so requires just <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log M)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq2.gif"/></alternatives></inline-formula> bits where M is the number of polymorphic sites.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Methods</title>
    <sec id="Sec5">
      <title>Preliminaries</title>
      <p id="Par11">Consider a string <italic>S</italic> of length <italic>n</italic> from ordered alphabet <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">Σ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq3.gif"/></alternatives></inline-formula>, with operator <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\prec$$\end{document}</tex-math><mml:math id="M8"><mml:mo>≺</mml:mo></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq4.gif"/></alternatives></inline-formula> denoting lexicographical order. Assume <italic>S</italic>’s last character is lexicographically less than the others. Let <italic>F</italic> be an array of <italic>S</italic>’s characters sorted lexicographically by the suffixes starting at those characters, and let <italic>L</italic> be an array of <italic>S</italic>’s characters sorted lexicographically by the suffixes starting immediately after them. The list <italic>L</italic> is the Burrows-Wheeler Transform [<xref ref-type="bibr" rid="CR20">20</xref>] of <italic>S</italic>, abbreviated <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="sans-serif">BWT</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
      <p id="Par12">The <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="sans-serif">BWT</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq6.gif"/></alternatives></inline-formula> can function as an <italic>index</italic> of <italic>S</italic> [<xref ref-type="bibr" rid="CR21">21</xref>]. Given a pattern <italic>P</italic> of length <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m &lt; n$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq7.gif"/></alternatives></inline-formula>, we seek the number and location of all occurrences of <italic>P</italic> in <italic>S</italic>. If we know the range <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}(S) [i..j]$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq8.gif"/></alternatives></inline-formula> occupied by characters immediately preceding occurrences of a pattern <italic>Q</italic> in <italic>S</italic>, we can compute the range <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}(S) [i'..j']$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq9.gif"/></alternatives></inline-formula> containing characters immediately preceding occurrences of <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c Q$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="italic">cQ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq10.gif"/></alternatives></inline-formula> in <italic>S</italic>, for any character <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c \in \Sigma$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq11.gif"/></alternatives></inline-formula>, since<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i'= \,&amp; {} |\{h:\,S [h] \prec c\}| + |\{h:\,\text{BWT}(S) [h] = c, h &lt; i\}|.\end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≺</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>BWT</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} j'= \,&amp; {} |\{h:\,S [h] \prec c\}| + |\{h:\,\text{BWT}(S) [h] = c, h \le j\}| - 1. \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≺</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>BWT</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>The FM Index is a collection of data structures for executing such queries efficiently. It consists of an array <italic>C</italic> storing <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\{h\,:\,S [h] \prec c\}|$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mspace width="0.166667em"/><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≺</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq12.gif"/></alternatives></inline-formula> for each character <italic>c</italic>, plus a rank data structure for <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}(S)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq13.gif"/></alternatives></inline-formula>, e.g. a wavelet tree, that can quickly tally the occurrences of a character <italic>c</italic> up to a position of <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="sans-serif">BWT</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq14.gif"/></alternatives></inline-formula>. To locate the offsets of occurrences of <italic>P</italic> in <italic>S</italic>, the FM-index can additionally include some form of <italic>S</italic>’s suffix array. The suffix array <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq15.gif"/></alternatives></inline-formula> is an array parallel to <italic>F</italic> containing the offsets of the characters in <italic>F</italic>. To save space, the FM-index typically keeps only a sample of <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq16.gif"/></alternatives></inline-formula>, e.g. a subset spaced regularly across <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq17.gif"/></alternatives></inline-formula> or across <italic>S</italic>.</p>
      <p id="Par13">Let <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T = \{T_0, T_1, \dots , T_n\}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq18.gif"/></alternatives></inline-formula> be a collection of <italic>n</italic> similar texts where <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq19.gif"/></alternatives></inline-formula> is the <italic>reference sequence</italic>, and <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_1, \dots , T_n$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq20.gif"/></alternatives></inline-formula> are <italic>alternative sequences</italic>. In the scenarios studied here, a <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq21.gif"/></alternatives></inline-formula> represents a human haplotype sequence, with all chromosomes concatenated, and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq22.gif"/></alternatives></inline-formula> represents the GRCh38 primary assembly of the human genome. Each <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq23.gif"/></alternatives></inline-formula> with <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i &gt; 0$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq24.gif"/></alternatives></inline-formula> is an alternate haplotype taken either from the 1000 Genomes project call set [<xref ref-type="bibr" rid="CR3">3</xref>] or from the HGSVC project [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], each with chromosomes concatenated in the same order as <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq25.gif"/></alternatives></inline-formula>’s. We use the terms “haplotype” and “genome” interchangeably here.</p>
      <p id="Par14">We assume that all the <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq26.gif"/></alternatives></inline-formula>’s are interrelated through a multiple alignment, e.g. as provided in a Variant Call Format (VCF) file. The multiple alignment is a matrix with genomes in rows and columns representing genomic offsets. The elements are either bases or gaps. We call a column consisting of identical bases and lacking any gaps a <italic>uniform</italic> column. Any other column is a <italic>polymorphic</italic> column. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates a multiply-aligned collection of haplotypes and the concatenated text <italic>T</italic>.</p>
    </sec>
    <sec id="Sec6">
      <title>Marker array</title>
      <p id="Par15">Let the “marker array” <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq27.gif"/></alternatives></inline-formula> be an array parallel to the concatenated sequence <italic>T</italic> marking positions that fall in a polymorphic column in the multiple alignment. Each element of <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq28.gif"/></alternatives></inline-formula> is a tuple recording the offset <italic>i</italic> with respect to <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq29.gif"/></alternatives></inline-formula> where the polymorphism begins, as well as the edit operation describing how the sequence differs from the reference at this locus. Distinct edit operations are given distinct integer identifiers, which are decoded using a separate table <italic>E</italic>. Identifier 0 is the null operation, denoting that the reference allele appears without edits. For example, say <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E=\{1: X \rightarrow C\}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq30.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X \rightarrow C$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>X</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq31.gif"/></alternatives></inline-formula> denotes a substitution that replaces the reference base with C. Then a marker array record <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m = (500, 0)$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq32.gif"/></alternatives></inline-formula> marks a locus with no edit with respect to reference position <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0[500]$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq33.gif"/></alternatives></inline-formula>. A record <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m' = (500, 1)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq34.gif"/></alternatives></inline-formula> denotes that a substitution changes that base at <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0[500]$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq35.gif"/></alternatives></inline-formula> to a <italic>C</italic>. An example is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (bottom left).</p>
      <p id="Par16">Consecutive substitutions are collapsed into a single edit in the <italic>E</italic> table. Insertions and deletions (“indels” for short) are treated somewhat differently; the offset carrying the “mark” is the one just preceding the indel (just to its left) in the multiple alignment. Importantly, the mark covers exactly one position in the genome, even if the insertion/deletion spans many bases. The marked position must come to the left of the indel to ensure that suffixes starting at the marked position include the allele itself. In the multiple alignment in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (top left), for example, a deletion with respect to R occurs in the fourth-from-left column, but the marked position is in the third-from-left column.</p>
      <p id="Par17">The marker array <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq36.gif"/></alternatives></inline-formula> is a permutation of <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq37.gif"/></alternatives></inline-formula> such that marks appear in suffix-rank order:</p>
      <sec id="d32e1405">
        <title>Definition 1</title>
        <p id="Par18">The <italic>marker array</italic>
<inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq38.gif"/></alternatives></inline-formula> is the mapping such that <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}[i] = \mathrm{\textsf{M}}[\mathrm{\textsf{SA}}[i]]$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="sans-serif">SA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
        <p>Thanks to suffix-rank order, identical <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}[i]$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq40.gif"/></alternatives></inline-formula>’s are often grouped into runs in <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq41.gif"/></alternatives></inline-formula>, as seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (right).<fig id="Fig1"><label>Fig. 1</label><caption><p>Top left: A multiple alignment for a collection of alternate haplotypes (H1–H9), and a reference sequence (R). Marked bases are in bold and alternate alleles are colored. Middle left: The text <italic>T</italic>, formed by concatenating rows of the multiple alignment (eliding gaps). Bottom left: The edit table <italic>E</italic>, with alternate-allele coloring. Right: A partial illustration of the marker array in relation to <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq42.gif"/></alternatives></inline-formula>, the relevant suffixes themselves (truncated to fit), and the <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{BWT}}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="sans-serif">BWT</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq43.gif"/></alternatives></inline-formula>. Colors and bolding highlight where marked bases and alternate alleles end up in the suffixes</p></caption><graphic xlink:href="13015_2023_225_Fig1_HTML" id="MO3"/></fig></p>
        <p>A <italic>marker query</italic> for pattern string <italic>q</italic> returns all <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \in \mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq44.gif"/></alternatives></inline-formula> overlapped by an occurrence of <italic>q</italic> in <italic>T</italic>. We can begin to answer this query using backward search (Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>) with <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=q$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq45.gif"/></alternatives></inline-formula>, giving the maximal <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq46.gif"/></alternatives></inline-formula> range [<italic>i</italic>..<italic>j</italic>] such that <italic>q</italic> is a prefix of the suffixes in the range. Having computed [<italic>i</italic>..<italic>j</italic>], we know that <inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\mathrm{\textsf{MA}}[i],..., \mathrm{\textsf{MA}}[j]\}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="sans-serif">MA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">MA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq47.gif"/></alternatives></inline-formula> contain markers overlapped by <italic>q</italic>’s leftmost character. To recover the markers overlapped by the rest of <italic>q</italic>’s characters, two approaches can be considered, detailed in the following subsections. The <italic>FL</italic> approach recovers the overlapped markers in a straightforward way but uses <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(|q| \cdot \mathrm{\textsf{occ}})$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="sans-serif">occ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq48.gif"/></alternatives></inline-formula> time, where <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{occ}}$$\end{document}</tex-math><mml:math id="M102"><mml:mi mathvariant="sans-serif">occ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq49.gif"/></alternatives></inline-formula> is the number of times <italic>q</italic> occurs in <italic>T</italic>. The heuristic backward-search approach requires only <italic>O</italic>(|<italic>q</italic>|) time but is not fully sensitive, i.e. it can miss some overlaps.</p>
      </sec>
      <sec id="Sec7">
        <title><italic>FL</italic> approach</title>
        <p id="Par21">Say [<italic>i</italic>..<italic>j</italic>] is the maximal <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M104"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq50.gif"/></alternatives></inline-formula> range such that all rows have <italic>q</italic> as a prefix. We can perform a sequence of FL steps, starting from each row <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in [i..j]$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq51.gif"/></alternatives></inline-formula>. An FL step is the inverse of an LF step. That is, if we write an LF mapping step in terms of a rank query<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i'=\, &amp; {} |\{h:\,S [h] \prec c\}| + \mathrm{\textsf{BWT}}.\text {rank}_{\mathrm{\textsf{BWT}}[i]}(i), \end{aligned}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow/><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≺</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>rank</mml:mtext><mml:mrow><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq52"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S.\text {rank}_c(i)$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>S</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>rank</mml:mtext><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq52.gif"/></alternatives></inline-formula> denotes the number of occurrences of <italic>c</italic> in <italic>S</italic> up to but not including offset <italic>i</italic>, then an FL step inverts this using a select query<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} i=\,&amp; {} \mathrm{\textsf{BWT}}.\text {select}_{F[i']}(i' - |\{h:\,S [h] \prec F[i']\}|), \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="sans-serif">BWT</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>select</mml:mtext><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≺</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S.\text {select}_c(i)$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>S</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>select</mml:mtext><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq53.gif"/></alternatives></inline-formula> returns the offset of the <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i+1^{\text {th}}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mtext>th</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq54.gif"/></alternatives></inline-formula> occurrence of <italic>c</italic> in <italic>S</italic>, i.e. the <italic>c</italic> of rank <italic>i</italic>. Whereas LF takes a leftward step with respect to <italic>T</italic>, FL takes a rightward step.</p>
        <p id="Par22">By starting in each row <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in [i..j]$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq55.gif"/></alternatives></inline-formula> and performing a sequence of <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q|-1$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq56.gif"/></alternatives></inline-formula> FL steps for each, we can visit each offset of <italic>T</italic> overlapped by an occurrence of <italic>q</italic>. Checking <inline-formula id="IEq57"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}[k]$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq57.gif"/></alternatives></inline-formula> at each step, where <italic>k</italic> is the current row, tells us which marker is overlapped, if any. This is slow in practice, both because it requires <inline-formula id="IEq58"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(|q| (j - i + 1))$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq58.gif"/></alternatives></inline-formula> FL steps in total, and because each step requires a select query, which is more costly in practice than a rank query.</p>
      </sec>
      <sec id="Sec8">
        <title>Heuristic backward-search approach with smearing</title>
        <p id="Par23">Say we perform a backward search starting with the rightmost character of <italic>q</italic>. At each step we are considering a range [<italic>i</italic>..<italic>j</italic>] of <inline-formula id="IEq59"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{SA}}$$\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="sans-serif">SA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq59.gif"/></alternatives></inline-formula> having a suffix of <italic>q</italic> as a prefix. Using <italic>i</italic> and <italic>j</italic>, we can query <inline-formula id="IEq60"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}[i..j]$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq60.gif"/></alternatives></inline-formula>. However, this tells us instances where a <italic>suffix</italic> of <italic>q</italic> overlaps a marker, whereas our goal is to find where the <italic>whole</italic> query <italic>q</italic> overlaps a marker. If we report overlaps involving trivially short suffixes of <italic>q</italic>, many would be false positives. We propose to allow but reduce the number of such false positives by augmenting <inline-formula id="IEq61"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M130"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq61.gif"/></alternatives></inline-formula>:</p>
        <sec id="d32e2219">
          <title>Definition 2</title>
          <p id="Par24">The <italic>augmented marker array</italic>
<inline-formula id="IEq62"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M132"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq62.gif"/></alternatives></inline-formula> is a multimap such that <inline-formula id="IEq63"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w[i] = [\mathrm{\textsf{M}}[\mathrm{\textsf{SA}}[i]], \mathrm{\textsf{M}}[\mathrm{\textsf{SA}}[i]+1],..., \mathrm{\textsf{M}}[\mathrm{\textsf{SA}}[i]+w]]$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="sans-serif">SA</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="sans-serif">SA</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="sans-serif">M</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="sans-serif">SA</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq63.gif"/></alternatives></inline-formula></p>
          <p>That is, <inline-formula id="IEq64"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w[i]$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq64.gif"/></alternatives></inline-formula> is a (possibly empty) list containing markers overlapping any of the positions <inline-formula id="IEq65"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T[i..i+w]$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq65.gif"/></alternatives></inline-formula>. We call this a “smeared” marker array, since the marks are extended (smeared) to the left by <italic>w</italic> additional positions. Note that a length-<italic>w</italic> extension can overlap one or more other marked variants to the left. For this reason, <inline-formula id="IEq66"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq66.gif"/></alternatives></inline-formula> must be a multimap, i.e. it might associate up to <italic>w</italic> markers with a given position.</p>
          <p>Using <inline-formula id="IEq67"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M142"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq67.gif"/></alternatives></inline-formula>, we adjust the backward-search strategy so that instead of querying <inline-formula id="IEq68"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M144"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq68.gif"/></alternatives></inline-formula> at each step, we query <inline-formula id="IEq69"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M146"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq69.gif"/></alternatives></inline-formula> every <italic>w</italic> steps. If <italic>w</italic> is large enough—e.g. longer than the length at which we see random-chance matches—we can avoid many false positives. More space is required to represent <inline-formula id="IEq70"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq70.gif"/></alternatives></inline-formula> compared to <inline-formula id="IEq71"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M150"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq71.gif"/></alternatives></inline-formula> since it is less sparse. However, we expect <inline-formula id="IEq72"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M152"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq72.gif"/></alternatives></inline-formula> to remain run-length compressible for the same reason that <inline-formula id="IEq73"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M154"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq73.gif"/></alternatives></inline-formula> is.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Genotyping a read</title>
      <p id="Par27">Given a sequencing read, we would like to extract as much genotype information as possible while minimizing computational cost and false-positive genotype evidence. Here we give a heuristic algorithm (Algorithm 1) that handles entire sequencing reads, querying <inline-formula id="IEq74"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M156"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq74.gif"/></alternatives></inline-formula> during the backward-search process as proposed in the previous section. The algorithm proceeds right to left through the read, growing the match by one character if possible. When we can no longer grow the match (i.e. the range [<italic>i</italic>..<italic>j</italic>] becomes empty), we reset the range to the all-inclusive range <inline-formula id="IEq75"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0..|T|-1]$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq75.gif"/></alternatives></inline-formula> and restart the matching process at the next character. We use the term “extension” to refer to a consecutive sequence of steps that successfully extend a match. Note that this is a heuristic algorithm that does not exhaustively find all half-MEMs between the read and the index, as the MONI algorithm does [<xref ref-type="bibr" rid="CR24">24</xref>].<graphic position="anchor" xlink:href="13015_2023_225_Figa_HTML" id="MO6"/></p>
      <p id="Par28">As discussed above, the algorithm only checks the marker array every <italic>w</italic> steps (line 14). As an additional filter, the algorithm only performs a marker-array query when the current suffix-array range size is no larger than the number of haplotypes in the index (<inline-formula id="IEq76"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_h$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq76.gif"/></alternatives></inline-formula>). A range exceeding that size indicates that we are seeing more than one distinct match in at least one haplotype, meaning that the evidence is ambiguous.</p>
      <p id="Par29">The algorithm tallies evidence as it goes (line 18), but might later choose to ignore that evidence if certain conditions are not satisfied (lines 10 and 27). For example, if the evidence has a conflict—i.e. one match indicates a reference allele at a site but another match found during the same extension finds an alternate allele at that site—then all the evidence is discarded for that extension. Similarly, evidence from an extension is discarded if the tallied sites span multiple chromosomes. Finally, evidence from extensions failing to match at least 80 bp of the read (adjustable with --min-seed-length option) is discarded.</p>
      <p id="Par30">We employ other heuristics to minimize mapping time not shown in Algorithm 1. For instance, we avoid wasted effort spent querying the wrong read strand. Specifically: rowbowt randomly selects an initial strand of the read to investigate: forward or reverse complement. If an extension from this strand meets the minimum seed-length threshold (80 by default), then the other strand is not considered and analysis of the read is complete. Otherwise, rowbowt then goes on to examine the opposite strand of the read.</p>
    </sec>
    <sec id="Sec10">
      <title>Sparse marker encoding</title>
      <p id="Par31">We encode the sparse arrays <inline-formula id="IEq77"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M162"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq77.gif"/></alternatives></inline-formula>, <inline-formula id="IEq78"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq78.gif"/></alternatives></inline-formula> and <inline-formula id="IEq79"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq79.gif"/></alternatives></inline-formula> in the following way. Say that array <italic>A</italic> consists of empty and non-empty elements. We consider <italic>A</italic>’s non-empty elements as falling into one of <italic>x</italic> maximal runs of identical (and non-empty) elements. Our sparse encoding for <italic>A</italic> consists of three structures. <italic>S</italic> is a length-|<italic>A</italic>| bit vector with 1s at the positions where a run of identical entries in <italic>A</italic> begins, and 0s elsewhere. <italic>E</italic> is a similar bit vector marking the last position of each of the <italic>x</italic> runs. (This variable <italic>E</italic> is distinct from the <italic>E</italic> table defined above in “Marker Array.”) To find whether an element <italic>A</italic>[<italic>i</italic>] is non-empty, we can ask whether we are between two such marks; that is, <italic>A</italic>[<italic>i</italic>] is non-empty if and only if <inline-formula id="IEq80"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S.\text {rank}_1(i+1) &gt; E.\text {rank}_1(i)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>S</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>rank</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>rank</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq80.gif"/></alternatives></inline-formula>.</p>
      <p id="Par32"><italic>X</italic> is a length-<italic>x</italic> array containing the element that is repeated in each of <italic>A</italic>’s non-empty runs, in the order they appear in <italic>A</italic>. If <italic>A</italic>[<italic>i</italic>] is not empty, the element appearing there is given by <inline-formula id="IEq81"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X[E.\text {rank}_1(i)]$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>X</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mtext>rank</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq81.gif"/></alternatives></inline-formula>.</p>
      <p id="Par33">When encoding <inline-formula id="IEq82"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq82.gif"/></alternatives></inline-formula> or <inline-formula id="IEq83"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq83.gif"/></alternatives></inline-formula>, the elements of <italic>X</italic> are simply tuples. A complication exists for <inline-formula id="IEq84"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M176"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq84.gif"/></alternatives></inline-formula>, since elements are lists of up to <italic>w</italic> tuples. In this case, we keep an additional bit-vector <italic>B</italic> of size |<italic>X</italic>| where 1s denote left-hand boundaries in <italic>X</italic> that correspond to runs in <italic>A</italic>. <italic>E</italic> and <italic>B</italic> can be used together to access an element in <italic>A</italic> (Algorithm 2).<graphic position="anchor" xlink:href="13015_2023_225_Figb_HTML" id="MO7"/></p>
    </sec>
    <sec id="Sec11">
      <title>Extracting markers from VCF</title>
      <p id="Par34">A Variant Calling Format (VCF) [<xref ref-type="bibr" rid="CR25">25</xref>] file is used to encode a collection of haplotypes with the variants arranged in order according to a reference genome. In the case of human and other diploid genomes, haplotypes are grouped as pairs. We refer to such a collection of haplotypes as a “panel” and a single haplotype as a “panelist.” An VCF entry encodes a variant as a tuple consisting of a chromosome, offset, the allele found in the reference, the alternate allele found in one or more panelists, and a sequence of flags indicating whether each panelist has the reference or alternate version. We start from a VCF file to determine how to populate the marker arrays <inline-formula id="IEq85"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq85.gif"/></alternatives></inline-formula>, <inline-formula id="IEq86"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M180"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq86.gif"/></alternatives></inline-formula> and/or <inline-formula id="IEq87"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq87.gif"/></alternatives></inline-formula>, as well as the edit array <italic>E</italic>.</p>
      <p id="Par35">A single element of <inline-formula id="IEq88"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M184"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq88.gif"/></alternatives></inline-formula> is a tuple (<italic>r</italic>, <italic>e</italic>), where <italic>r</italic> is an offset in <inline-formula id="IEq89"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq89.gif"/></alternatives></inline-formula> and <italic>e</italic> is the edit operation describing how the sequence differs from the reference. As a practical matter, we represent these tuples in a different way that more closely resembles the corresponding VCF records. Specifically, a marker is encoded in a 64-bit word divided into three fields. First, a 12 bit field identifies the chromosome containing the marker. The chromosome ordering is given at the beginning of the VCF file in the “header” section. For example, if “chr1” is the first chromosome in the header, then this chromosome is encoded as 0x000 (using hexadecimal), and if “chr2” is the second chromosome, it is encoded as 0x001. Second is a 54 bit field encoding the marker’s offset within the chromosome. Third is a 4-bit field storing which version of the variant is present, with 0 indicating the reference allele, 1 indicating the 1st alternate allele, 2 the second alternate allele, etc. This 64-bit representation allows for compact storage of markers and easier random access to the marker array.</p>
    </sec>
    <sec id="Sec12">
      <title>Diploid genotyping</title>
      <p id="Par36">In a diploid genome, it is possible for both alleles to occur, i.e. for the genotype to be heterozygous. We use an existing approach [<xref ref-type="bibr" rid="CR26">26</xref>] to compute genotype likelihoods considering all possible diploid genotypes: homozygous reference (2 reference alleles), homozygous alternate (2 alternate alleles), or heterozygous (1 reference, 1 alternate). Let <inline-formula id="IEq90"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g \in \{0,1,2\}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq90.gif"/></alternatives></inline-formula> denote the number of reference-allele copies at the marked site; e.g. <inline-formula id="IEq91"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=1$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq91.gif"/></alternatives></inline-formula> corresponds to a heterozygous site and <inline-formula id="IEq92"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=2$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq92.gif"/></alternatives></inline-formula> to a homozygous reference site. Let <italic>l</italic> be the number of times the reference allele was observed in the reads overlapping a particular marked site and let <italic>k</italic> be the count of all alleles (reference or alternate) observed. Let <inline-formula id="IEq93"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon$$\end{document}</tex-math><mml:math id="M194"><mml:mi>ϵ</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq93.gif"/></alternatives></inline-formula> be the sequencing error rate. We calculate the genotype likelihood as follows, adopting equation 2 of [<xref ref-type="bibr" rid="CR26">26</xref>] while setting the ploidy to 2 and adopting a global rather than a per-base error rate:<disp-formula id="Equ5"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(g) = \frac{1}{2}^k [(2-g)\epsilon + g(1-\epsilon )]^k [(2-g)(1-\epsilon ) + g\epsilon ]^{k-l}.$$\end{document}</tex-math><mml:math id="M196" display="block"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>To choose the most likely genotype <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{max}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq94.gif"/></alternatives></inline-formula>, we compute:<disp-formula id="Equ6"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{max} = \text {argmax}_{g \in \{0, 1, 2\}}L(g).$$\end{document}</tex-math><mml:math id="M200" display="block"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmax</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>By default, rowbowt uses <inline-formula id="IEq95"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon =0.01$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq95.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec13">
      <title>Implementation details</title>
      <p id="Par37">The code for constructing the marker array is implemented in the pfbwt-f spoftware package, with repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/alshai/pfbwt-f">https://github.com/alshai/pfbwt-f</ext-link>. This repository also contains an efficient implementation of the prefix-free-parse BWT construction algorithm [<xref ref-type="bibr" rid="CR18">18</xref>]. This software is written in C++17, uses the open-source MIT license, and builds on the Succinct Data Structure Library (SDSL) v3.0 [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p id="Par38">For querying the marker array, we use the rowbowt implementation at <ext-link ext-link-type="uri" xlink:href="https://github.com/alshai/rowbowt">https://github.com/alshai/rowbowt</ext-link>. This repository contains the open source C++17 implementation of rowbowt, distributed under the MIT license. It is also a library, containing algorithms for building and querying indexes containing various structures discussed here, including the run-sampled suffix array, marker array, and others.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Results</title>
    <p id="Par39">We evaluated the efficiency and accuracy of our marker-array method for compiling genotype evidence. We first generated multiple series of rowbowt indexes covering various settings for three parameters: the window size <italic>w</italic> for the smeared marker array <inline-formula id="IEq96"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq96.gif"/></alternatives></inline-formula>, the number of haplotypes indexed, and the minimum allele frequency for marked alleles. The rowbowt index consisted of three components: the run-length encoded BWT, the run-sampled suffix array, and the marker array. While we built the sampled suffix array for these experiments, the standard marker-array-based method in rowbowt does not require this array.</p>
    <p id="Par40">We generated indexes for collections of 200, 400, 800, or 1000 human chromosome-21 haplotypes from the 1000 Genomes Phase 3 reference panel [<xref ref-type="bibr" rid="CR3">3</xref>] based on the <italic>GRCh</italic>37 reference. We generated two sets of indexes: one where the marker array marks all polymorphic sites regardless of frequency (denoted “<inline-formula id="IEq97"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq97.gif"/></alternatives></inline-formula>”), and another where the marker array marks only those sites where the less common allele occurs in greater than <inline-formula id="IEq98"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\%$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq98.gif"/></alternatives></inline-formula> of haplotypes, i.e. has allele frequency over 1% (denoted “<inline-formula id="IEq99"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq99.gif"/></alternatives></inline-formula>”). In all cases, the marker array window size <italic>w</italic> was set to 19. Each haplotype collection was drawn from a random subset of 500 individuals from the 1000 Genomes Phase 3 panel. The <inline-formula id="IEq100"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq100.gif"/></alternatives></inline-formula> panel of 500 haplotypes contained 1, 097, 388 polymorphic sites. The <inline-formula id="IEq101"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq101.gif"/></alternatives></inline-formula> panel of the same haplotypes contained 193, 438 polymorphic sites with allele frequency over 1%. We also included the GRCh37 reference sequence, consisting of all reference alleles, in each collection, corresponding to the reference sequence called <inline-formula id="IEq102"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_0$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq102.gif"/></alternatives></inline-formula> above.</p>
    <p id="Par41">We generated a series of indexes with window size <inline-formula id="IEq103"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w \in \{13,15,17,19,21,23,25\}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>19</mml:mn><mml:mo>,</mml:mo><mml:mn>21</mml:mn><mml:mo>,</mml:mo><mml:mn>23</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq103.gif"/></alternatives></inline-formula>. We generated two such series: one with no minimum allele frequency (<inline-formula id="IEq104"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq104.gif"/></alternatives></inline-formula>) and another with a 1% minimum frequency (<inline-formula id="IEq105"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq105.gif"/></alternatives></inline-formula>). Each index was over the same set of 100 haplotypes.</p>
    <sec id="Sec15">
      <title>Index size</title>
      <p id="Par42">We measured the size of the three main components of the rowbowt index: the augmented marker array, the run-length encoded BWT (RLE BWT) [<xref ref-type="bibr" rid="CR28">28</xref>] and the run-sampled suffix array (“<italic>r</italic>-index SA”) [<xref ref-type="bibr" rid="CR17">17</xref>]. Figure <xref rid="Fig2" ref-type="fig">2</xref> plots this measurement for collections of 200, 400, 800 and 1000 haplotypes for both <inline-formula id="IEq106"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq106.gif"/></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq107.gif"/></alternatives></inline-formula>. All grow linearly with the number haplotypes grows, as expected. For <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq108.gif"/></alternatives></inline-formula>, the augmented marker array is consistently larger than the run-sampled suffix array (“<italic>r</italic>-index SA”). For <inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq109.gif"/></alternatives></inline-formula>, the augmented marker array is much smaller, approaching the size of the RLE BWT. The <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq110.gif"/></alternatives></inline-formula> array is larger because it contains polymorphic sites with infrequent alleles; about 85% of the marked sites in the <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq111.gif"/></alternatives></inline-formula> array have allele frequency under 1%. Further, rare alleles are less likely to form long runs in the augmented marker array, negatively affecting run-length compression.</p>
      <p id="Par43">In the right portion of Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the RLE BWT and <italic>r</italic>-index SA have constant size because the <italic>w</italic> parameter does not affect those data structures. In the left portion of Fig. <xref rid="Fig2" ref-type="fig">2</xref>, showing size as a function of number of haplotypes, the augmented marker array is almost always larger than the <italic>r</italic>-index SA for <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq112.gif"/></alternatives></inline-formula> as opposed to <inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq113.gif"/></alternatives></inline-formula>, except at <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=13$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq114.gif"/></alternatives></inline-formula>. The slope of the array size is smaller for <inline-formula id="IEq115"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq115.gif"/></alternatives></inline-formula> than for <inline-formula id="IEq116"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq116.gif"/></alternatives></inline-formula>.</p>
      <p id="Par44">Overall, both the value of <italic>w</italic> and the number of haplotypes in the index cause the augmented marker array to increase in size, but the inclusion of rare alleles (<inline-formula id="IEq117"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt; 1\%$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq117.gif"/></alternatives></inline-formula> allele frequency) has the largest effect on its size.<fig id="Fig2"><label>Fig. 2</label><caption><p>Left: Size of rowbowt data structures as a function of the number of haplotypes indexed, and with <inline-formula id="IEq118"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=19$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>19</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq118.gif"/></alternatives></inline-formula>. “Marker array” refers to the augmented marker array, <inline-formula id="IEq119"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M250"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq119.gif"/></alternatives></inline-formula>. Right: Size of rowbowt data structures as a function of the “smearing” window size <italic>w</italic>, with number of haplotypes fixed at 100. Separate results are shown for when there is no minimum allowed allele frequency (<inline-formula id="IEq120"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq120.gif"/></alternatives></inline-formula>) and when the minimum frequency is 1% (<inline-formula id="IEq121"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq121.gif"/></alternatives></inline-formula>)</p></caption><graphic xlink:href="13015_2023_225_Fig2_HTML" id="MO10"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Query time</title>
      <p id="Par45">We next measured query time for the augmented marker array strategy versus the locate-query strategy which uses the run-sampled suffix array. 150 bp simulated reads of 25x coverage were generated for one haplotype of HG01498, an individual that is part of the 1000-Genomes panel, but which we excluded from all our indexes. We simulated reads using Mason 2 mason_simulator [<xref ref-type="bibr" rid="CR29">29</xref>] with default options.</p>
      <p id="Par46">In the case of the marker-array strategy, we measured the time required to analyze the reads using the algorithm described above in “Genotyping a read.” In the case of the locate-query strategy, the <inline-formula id="IEq122"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M256"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq122.gif"/></alternatives></inline-formula> query was replaced with a two-step process that first performed a locate query with respect to the run-sampled suffix array, then performed a lookup in the <inline-formula id="IEq123"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M258"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq123.gif"/></alternatives></inline-formula> array. To enable this mode, we further augmented the <italic>r</italic>-index with a representation of <inline-formula id="IEq124"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M260"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq124.gif"/></alternatives></inline-formula> using the sparse encoding described above. To emphasize: the rowbowt strategy does not require the run-sampled suffix array or the <inline-formula id="IEq125"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M262"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq125.gif"/></alternatives></inline-formula> array; the <inline-formula id="IEq126"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M264"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq126.gif"/></alternatives></inline-formula> effectively replaces them both.</p>
      <p id="Par47">We repeatedly sampled 10,000 simulated reads and recorded the mean query time over 10 trials. As seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref> the augmented marker-array method (labeled “marker”) was consistently faster than locate method. This was true for all allele frequencies and window sizes tested. We found that the effect of <italic>w</italic> and allele-frequency cutoff was more pronounced with the larger reference panel <inline-formula id="IEq127"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq127.gif"/></alternatives></inline-formula>. For the smaller panel (<inline-formula id="IEq128"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq128.gif"/></alternatives></inline-formula>), query time was mostly invariant to both window size and allele frequency.<fig id="Fig3"><label>Fig. 3</label><caption><p>Mean time over 10 trials of aligning 10,000 simulated reads from HG01498 against the augmented marker array (marker) and the <italic>r</italic>-index suffix array (locate). Experiments are repeated for marker collections including all alleles (<inline-formula id="IEq129"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF &gt; 0$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq129.gif"/></alternatives></inline-formula>) and for alleles having frequency at least 1% (<inline-formula id="IEq130"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF &gt; 0.01$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq130.gif"/></alternatives></inline-formula>). Left: The experiment is repeated for various window sizes <italic>w</italic>, and for 100 haplotypes. Right: The experiment is repeated for different numbers of indexed haplotypes, with <inline-formula id="IEq131"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=19$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>19</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq131.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="13015_2023_225_Fig3_HTML" id="MO11"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Genotyping accuracy</title>
      <p id="Par48">We next measured the accuracy of the genotype information gathered using the augmented marker array. We simulated sequencing reads from one haplotype of HG01498 to an average depth of 25-fold coverage. Individual HG01498 was excluded from the indexes. As our “truth” set for evaluation, we use the variant calls in the 1000 Genomes project callset for the same haplotype we simulated from. For simplicity, this experiment treats the genome as haploid. Experiments in the next section will account for the diploid nature of human genomes.</p>
      <p id="Par49">A single marked site can have conflicting evidence, due, for instance, to mismapped reads or sequencing errors. For this evaluation, we make calls simply by finding the frequently observed allele at the site. We ignore any instances of alleles other than the ones noted in the VCF file as the reference and alternate alleles. If the reference and alternate alleles have equal evidence, the reference allele is called.</p>
      <p id="Par50">We calculate precision and recall according to the following formulas. Here, the positive class consists of marked sites that truly have the alternate allele, while the negative class consists of marked sites that truly have the reference allele. We measure:<disp-formula id="Equ7"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Precision} = \frac{\text {TP}s}{\text {TP}s+\text {FP}s} \,\,\,\,\,\,\,\, \text {Recall} = \frac{\text {TP}s}{\text {TP}s + \text {FN}s},$$\end{document}</tex-math><mml:math id="M276" display="block"><mml:mrow><mml:mtext>Precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TP</mml:mtext><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>TP</mml:mtext><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>Recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TP</mml:mtext><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>TP</mml:mtext><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2023_225_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where TP stands for True Positive, FN stands for False Negative, etc.</p>
      <p id="Par51">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows precision and recall with respect to the number of haplotypes in the index and the minimum allele frequency of the haplotype collection. We observed that the <inline-formula id="IEq132"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq132.gif"/></alternatives></inline-formula> indexes generally had better precision compared to the <inline-formula id="IEq133"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq133.gif"/></alternatives></inline-formula> indexes, though at the expense of recall. Precision and recall generally improve with the addition of more haplotypes to the index. The augmented marker array has similar recall to the locate procedure across all haplotype sizes at the loss of precision. When rare variants are removed from the index (<inline-formula id="IEq134"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AF&gt;0.01$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>A</mml:mi><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq134.gif"/></alternatives></inline-formula>), the gap in precision between the marker array and the locate procedure lessens. This mild (less than 0.1%) loss of precision is expected since algorithm described above in “Genotyping reads” is still prone to some false positives in the earlier part of the extension process.<fig id="Fig4"><label>Fig. 4</label><caption><p>Precision (left) and recall (right) of the calls made when querying 25x simulated reads from HG01498 against the augmented marker array (marker) and the <italic>r</italic>-index (locate). Stratified by minimum allowed allele frequency (AF) in the index</p></caption><graphic xlink:href="13015_2023_225_Fig4_HTML" id="MO13"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Diploid genotyping assessment</title>
      <p id="Par52">To assess diploid genotyping accuracy, we used data from the Human Genome Structural Variation Consortium (HGSVC) [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. The HGSVC called both simple and complex genetic variants across a panel of 64 human genomes. Calls were made with respect to the GRCh38 primary assembly [<xref ref-type="bibr" rid="CR4">4</xref>]. For input reads, we subsampled reads from a 30-fold average coverage PCR-free read set provided by the 1000 Genomes Project [<xref ref-type="bibr" rid="CR3">3</xref>] (accession SRR622457). To create more challenging scenarios for the genotypers, we randomly subsampled the read sets to make smaller datasets of 0.01, 0.05, 0.1, 0.5, 1, 2 and 5-fold average coverage.</p>
      <p id="Par53">We assessed four genotyping methods. The first (bowtie2+bcftools) used Bowtie 2 [<xref ref-type="bibr" rid="CR30">30</xref>] v2.4.2 to align reads to a standard linear reference genome, then used BCFtools v1.13 to call variants (i.e. genotypes) at the marked sites [<xref ref-type="bibr" rid="CR26">26</xref>]. The second method used the graph-based genotyper BayesTyper v1.5. The third was PanGenie [<xref ref-type="bibr" rid="CR16">16</xref>], a pangenome-based genotyper for short reads. PanGenie calls genotypes for variants that are represented in its index as bubbles in a pangenome. PanGenie represents known haplotypes as paths through the graph, accounting for these paths during the genotyping process. PanGenie takes directed acyclic pangenome graph as input, represented as a VCF file containing phased genotypes for many samples. PanGenie further requires that the VCF have non-overlapping variants. We generated a compliant input VCF using a workflow provided by the PanGenie project<xref ref-type="fn" rid="Fn1">1</xref> We used the “high-gq” quality filter also used in the PanGenie study: genotype quality (GQ) <inline-formula id="IEq135"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 200$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq135.gif"/></alternatives></inline-formula>. The fourth method assessed was rowbowt.</p>
      <p id="Par55">Prior to applying BayesTyper, we built a BayesTyper-compatible VCF file containing all relevant variants from the HGSVC haplotype panel. For rowbowt, we created a rowbowt index from the genomes in the HGSVC haplotype panel. In both cases we excluded NA12878’s haplotypes from the panel prior to building the index.</p>
      <p id="Par56">When evaluating, we stratified variants by complexity: the “SNV” category includes single-nucleotide substitutions, “Indel” includes indels no more than 50bp long, and “SV” includes insertion or deletions longer than 50bp, and “All” includes all variant types. More complex structural variants like inversions and chromosomal rearrangements are ignored.</p>
      <p id="Par57">We analyzed the accuracy of rowbowt ’s diploid genotypes in two ways. First we considered allele-by-allele precision and recall, considering the alternate (ALT) allele calls to be the positive class. Specifically, every diploid genotype called by a method is considered as a pair of individual allele calls. If a given allele call is an alternate (ALT) allele and there is at least one ALT allele present in the true diploid genotype at that site, it counts as a true positive (TP). If the given allele is a reference allele (REF) and there is at least one REF allele in the true diploid genotype, this is a true negative (TN). If the given allele is an ALT but the true genotype is homozygous REF, we count it as a false positive (FP). Finally, if the given allele is REF but the true genotype is homozygous ALT, this is a a false negative (FN).</p>
      <p id="Par58">Second, we considered precision and recall with respect to sites that were either truly heterozygous or called heterozygous. If a heterozygous call made by a method is truly heterozygous, this was counted as a true positive (TP). False positives, false negatives, and true negatives are defined accordingly.</p>
      <p id="Par59">As seen in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, rowbowt ’s ALT and HET precision were generally the highest of all the methods across all variant categories, though BayesTyper sometimes achieved higher ALT/HET precision for indels in the higher-coverage datasets and PanGenie had the highest HET precision for SNVs and Indels for some coverages. At the highest coverage level examined (5-fold), PanGenie also achieved similar ALT precision to rowbowt on SNVs and Indels. rowbowt dominates on precision of SV calls, and also exhibits the best recall for ALTs at higher coverage. PanGenie exhibits slightly higher recall for HET SVs.</p>
      <p id="Par60">Figure <xref rid="Fig6" ref-type="fig">6</xref> compares the methods on their F1 measure. rowbowt achieved the highest F1 scores for ALT and HET SNBs. For HET SNV variants, rowbowt had the highest F1 score of 0.71, while for ALT SNV variants, the F1 was 0.95. In the case of Indel variants, rowbowt produced the highest F1 score of 0.81 for the ALT class and tied with PanGenie for the HET class, with an aggregate score of 0.48. Fr SVs, rowbowt had the highest F1 score of 0.55 in the ALT class and a comparable score of 0.21 in the HET class, just below PanGenie ’s score of 0.23.<fig id="Fig5"><label>Fig. 5</label><caption><p>Precision and recall for the four tested genotyping methods, both at the level of individual alleles (ALT precision/recall) and at the level of heterozygous variants (HET precision/recall). Note that the bowtie2+bcftools approach is generally unable to align reads across variants in the “SV” category, leading to low precision and recall</p></caption><graphic xlink:href="13015_2023_225_Fig5_HTML" id="MO14"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Diploid genotyping assessment on medically relevant genes</title>
      <p id="Par61">We obtained a list of medically relevant autosomal genes, collected from medical gene databases by the Genome in a Bottle (GiaB) project [<xref ref-type="bibr" rid="CR31">31</xref>]. Among the 5,026 genes included are the major MHC Class I genes (HLA-A, HLA-B, HLA-C), MHC Class II genes (HLA-DP, HLA-DQ, HLA-DR) and KIR genes. A complete list including coordinates can be found at the CMRG GitHub repo [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p id="Par62">As seen in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, rowbowt ’s performance relative to the other methods is very similar for these genes compared to the full set of genes assessed in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. As seen in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, rowbowt generally outperformed other methods on F1 score for medically relevant genes. For HET SNV variants, rowbowt achieved the highest F1 score of 0.72, while for ALT SNV variants, the F1 score was 0.96. In the case of Indel variants, rowbowt was the leader with an F1 score of 0.82 for the ALT class, and tied with PanGenie with a score of 0.47 for the HET class. As for SVs, rowbowt had the highest F1 score of 0.56 in the ALT class, and a comparable score of 0.19 in the HET class, closely following PanGenie ’s score of 0.22.<fig id="Fig6"><label>Fig. 6</label><caption><p>F1 scores across variant types and tools. Computed genomewide (top) and over only those variants in medically relevant autosomal genes (bottom)</p></caption><graphic xlink:href="13015_2023_225_Fig6_HTML" id="MO15"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Precision and recall presented as in Fig. <xref rid="Fig5" ref-type="fig">5</xref> but filtered to only the medically relevant autosomal genes, collected from medical gene databases by the Genome in a Bottle (GiaB) project</p></caption><graphic xlink:href="13015_2023_225_Fig7_HTML" id="MO16"/></fig></p>
    </sec>
    <sec id="Sec20">
      <title>Computational performance</title>
      <p id="Par63">We compared the time and memory usage of each genotyping method, dividing the computations performed by each method into a few distinct categories. For each phase, we measured both the wall-clock time elapsed and maximum memory (“maximum resident set”) used. Both were measured with the Snakemake tool’s benchmark directive [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <p id="Par64">We categorized and benchmarked three distinct types of computation. For bowtie2+bcftools, we defined the “Alignment” step as the process of using bowtie2 to align reads to the linear reference genome. For rowbowt, we defined the “Alignment” step as the process of using the rb_markers command to genotype the reads using the algorithm described in Methods. For the alignment-free methods PanGenie and BayesTyper, we use the term “Pre-genotyping” for the initial phase that includes <italic>k</italic>-mer counting and other index building procedures. In the case of BayesTyper, this specifically consists of (a) using the KMC3 software [<xref ref-type="bibr" rid="CR34">34</xref>] to count <italic>k</italic>-mers in the input reads, (b) using the bayestyper makeBloom command to convert <italic>k</italic>-mer counts to Bloom filters for each sample, and (c) using the bayestyper cluster command to identify variant clusters. In the case of PanGenie, “Pre-genotyping” consists of: (a) reading input files, (b) <italic>k</italic>-mer counting, (c) path selection, (c) determining unique <italic>k</italic>-mers. Also for PanGenie, the initial input VCF file must be preprocessed into a new VCF file containing additional fields, accounting for about 1 h of computation, not included in our measurements.</p>
      <p id="Par65">16 threads were used during the Alignment phase for bowtie2+bcftools, rowbowt and PanGenie, while 32 threads were used for BayesTyper.</p>
      <p id="Par66">For bowtie2+bcftools, we define the Genotyping step as the process of using bcftools call to call variants from the BAM file output by bowtie2. For rowbowt We define the Genotyping phase as the process of running the vc_from_markers.py script on the output from rb_markers. For BayesTyper, we define the genotyping step as the process of running the bayesTyper genotype command. PanGenie was run by providing 16 threads. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows the time-taken and peak memory footprint for each method and on defined phases.</p>
      <p id="Par67">The Genotype phases for both bowtie2+bcftools and rowbowt do not support multi-threading, so a single thread was used. For the BayesTyper and Pangenome Genotype phases, we used 16 threads.</p>
      <p id="Par68">Figure <xref rid="Fig8" ref-type="fig">8</xref> shows the time taken and peak memory footprint for each method and each category. We observed that rowbowt was consistently faster than the other methods in the Genotyping phase, sometimes by a large margin. We also observed that while rowbowt has a higher memory footprint compared to the bowtie2+bcftools method, it uses substantially less memory than BayesTyper and PanGenie, the other pangenome-based methods. PanGenie has a particularly high (&gt;100 gigabyte) memory footprint in both the Pre-genotyping and Genotyping steps.<fig id="Fig8"><label>Fig. 8</label><caption><p>Wall clock time and peak memory footprint for each phase of the genotyping workflow for four methods tested</p></caption><graphic xlink:href="13015_2023_225_Fig8_HTML" id="MO17"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Discussion</title>
    <p id="Par69">We proposed a family of novel marker array structures, <inline-formula id="IEq136"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{M}}$$\end{document}</tex-math><mml:math id="M286"><mml:mi mathvariant="sans-serif">M</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq136.gif"/></alternatives></inline-formula>, <inline-formula id="IEq137"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M288"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^w$$\end{document}</tex-math><mml:math id="M290"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq138.gif"/></alternatives></inline-formula> that, together with a pangenome index like the <italic>r</italic>-index, allow for rapid and memory-efficient genotyping with respect to large pan-genome references. The augmented marker array is smaller and faster to query than the run-sampled suffix array — the usual way to establish where matches fall when querying a run-length compressed index — especially when we limit the set of markers to just alleles at frequency 1% or higher. We further showed that the augmented marker array can replace the sampled suffix array in simple genotyping experiments with moderate sacrifice of precision, and that a marker array based genotyping method outperforms the graph-based BayesTyper method.</p>
    <p id="Par70">Pan-genome indexes allow for rapid analysis of reads while reducing reference bias. The indexes used in our experiments consisted of many (up to 65) haplotypes, with none having a higher priority over the others, except in the sense that results were expressed in terms of the standard reference. Our approach preserves all linkage disequilibrium information. This is in contrast to some graph-indexing approaches, which might consider all possible combinations of nearby alleles to be “valid,” even if most combinations never co-occur in nature.</p>
    <p id="Par71">While we examined only simple structural variants in the form of insertions and deletions longer than 50 bp, the genotyping method is readily extensible to more complex differences as well. Indeed, as long as we can mark the base or bases just to the left of the variant, we can mark any variant in a way that we can later genotype.</p>
    <p id="Par72">Our method will mark only a single base that is to the left of the boundary (“breakpoint”) of a variant. This is true whether the variant is large (i.e. is a large insertion or deletion) or small (i.e. an SNV). We choose to mark the base to the left of the boundary rather than the right because suffixes starting from the base to the right will be unaffected by the REF and ALT alleles; therefore, matches spanning that position do not necessarily carry evidence for a particular allele. That said, an alternative approach would be to consider “suffixes” extending in either direction—either left-to-right or right-to-left—by additionally indexing the reverse of the reference sequences. If both forward and reverse versions of the index are available, our method can be made more robust by combining the evidence obtained from matches spanning both the left and right boundaries of the polymorphic variant. In the future, it will be important to measure whether the increase in index size and genotyping memory footprint can justify this refinement.</p>
    <p id="Par73">We also note that our strategy marks only a single left-flank base position per variant, even in the case of an insertion or deletion where the alleles span different numbers of bases. For instance, for an insertion where the REF allele is A and the ALT allele is AGG. If we were instead to mark both the left-flank base (A in this example) and every base within the insertion (the two Gs in the ALT allele), we are vulnerable to a bias resulting from the fact that there are more opportunities to observe a match overlapping the longer allele than the shorter one. Without any correction, this artificially inflates the evidence from the longer allele. That said, it should be possible to correct for the bias, e.g. by penalizing the evidence from the longer allele in a length-weighted fashion. In the future, it will be important to investigate whether this enhanced marking strategy yields an overall improvement in genotyping accuracy.</p>
    <p id="Par74">Since this work first appeared, other groups have pursued related ideas. In particular, we note that the new MARIA index is capable list all the distinct columns of the multiple alignment overlapped by a match in the <italic>r</italic>-index [<xref ref-type="bibr" rid="CR35">35</xref>]. Further, that study defines a quantity called <inline-formula id="IEq139"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'$$\end{document}</tex-math><mml:math id="M292"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq139.gif"/></alternatives></inline-formula> that captures something similar to the number of distinct runs we expected to find in the <inline-formula id="IEq140"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}$$\end{document}</tex-math><mml:math id="M294"><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq140.gif"/></alternatives></inline-formula> or <inline-formula id="IEq141"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\textsf{MA}}^{w}$$\end{document}</tex-math><mml:math id="M296"><mml:msup><mml:mrow><mml:mi mathvariant="sans-serif">MA</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq141.gif"/></alternatives></inline-formula> arrays. In the future it will be important to directly relate <inline-formula id="IEq142"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'$$\end{document}</tex-math><mml:math id="M298"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq142.gif"/></alternatives></inline-formula> to the quantities discussed here and to compare the advantages and disadvantages of our genotyping-centric approach to the more general approach of MARIA.</p>
    <p id="Par75">The rowbowt method can lead to future methods that use information about genotypes to build a personalized reference genome, containing exactly the genotyped alleles. Alignment to a personalized reference have been shown previously to be the best way to reduce reference bias, even more effective than the best pangenome methods [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR13">13</xref>].</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par54">The workflow can be found in the pipelines/run-from-callset subdirectory of the PanGenie repository.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Massimiliano Rossi and Travis Gagie for many helpful discussions. We thank Margaret Gagie for her careful editing.Part of this research project was conducted using computational resources at the Maryland Advanced Research Computing Center (MARCC).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>TM and BL conceived the method. TM wrote the Rowbowt software tool. TM, NGKV and BL designed and ran the experiments. TM, NGKV and BL wrote and revised the manuscript. All authors reviewed the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>N.S.K.V., T.M. and B.L. were supported by NIH grants R01HG011392 and R35GM139602 to BL. T.M. and B.L. were also supported by NSF DBI Grant 2029552.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>rowbowt is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alshai/rowbowt">https://github.com/alshai/rowbowt</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par80">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Kucka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flanagan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cunniff</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>YF</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Rapid genotype imputation from sequence with reference panels</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <issue>7</issue>
        <fpage>1104</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00877-0</pub-id>
        <?supplied-pmid 34083788?>
        <pub-id pub-id-type="pmid">34083788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Chandnani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shuang</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>Application of genotyping by sequencing technology to a variety of crop breeding programs</article-title>
        <source>Plant Sci</source>
        <year>2016</year>
        <volume>242</volume>
        <fpage>14</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.plantsci.2015.04.016</pub-id>
        <?supplied-pmid 26566821?>
        <pub-id pub-id-type="pmid">26566821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
        <?supplied-pmid 26432245?>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Graves-Lindsay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bouk</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Kitts</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Thibaud-Nissen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Albracht</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of GRCh38 and de novo haploid genome assemblies demonstrates the enduring quality of the reference assembly</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>849</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213611.116</pub-id>
        <?supplied-pmid 28396521?>
        <pub-id pub-id-type="pmid">28396521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Günther</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nettelblad</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The presence and impact of reference bias on population genomic studies of prehistoric human populations</article-title>
        <source>PLoS Genet</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>1008302</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1008302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brandt</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Aguiar</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Bitarello</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Nunes</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goudet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Mapping bias overestimates reference allele frequencies at the HLA genes in the 1000 genomes project phase I data</article-title>
        <source>G3 (Bethesda)</source>
        <year>2015</year>
        <volume>5</volume>
        <issue>5</issue>
        <fpage>931</fpage>
        <lpage>941</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.114.015784</pub-id>
        <?supplied-pmid 25787242?>
        <pub-id pub-id-type="pmid">25787242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherman</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Forman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rafaels</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boorgula</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Chavan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vergara</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ortega</surname>
            <given-names>VE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of a pan-genome from deep sequencing of 910 humans of African descent</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <issue>1</issue>
        <fpage>30</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0273-y</pub-id>
        <?supplied-pmid 30455414?>
        <pub-id pub-id-type="pmid">30455414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bernardini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALVA: genotyping by mapping-free ALlele detection of known VAriants</article-title>
        <source>iScience</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>20</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2019.07.011</pub-id>
        <?supplied-pmid 31352182?>
        <pub-id pub-id-type="pmid">31352182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shajii</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yorukoglu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>William Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Fast genotyping of known SNPs through approximate k-mer matching</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>538</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>FORGe: prioritizing variants for graph genomes</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>220</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1595-x</pub-id>
        <?supplied-pmid 30558649?>
        <pub-id pub-id-type="pmid">30558649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dolzhenko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Petrovski</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kirsche</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Eberle</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Paragraph: a graph-based structural variant genotyper for short-read sequence data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>291</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1909-7</pub-id>
        <?supplied-pmid 31856913?>
        <pub-id pub-id-type="pmid">31856913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sirén</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Garg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Markello</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Variation graph toolkit improves read mapping by representing genetic variation in the reference</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>9</issue>
        <fpage>875</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4227</pub-id>
        <?supplied-pmid 30125266?>
        <pub-id pub-id-type="pmid">30125266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Solomon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mun</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Reference flow: reducing reference bias using multiple population genomes</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02229-3</pub-id>
        <?supplied-pmid 33397413?>
        <pub-id pub-id-type="pmid">33397413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>n</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Monlong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Markello</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sibbesen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blackwell</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Ratan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Rich</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Rotter</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Pangenomics enables genotyping of known structural variants in 5202 diverse genomes</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>374</volume>
        <issue>6574</issue>
        <fpage>8871</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abg8871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sibbesen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Maretty</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Accurate genotyping across variant classes and lengths using variant graphs</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>7</issue>
        <fpage>1054</fpage>
        <lpage>1059</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0145-5</pub-id>
        <?supplied-pmid 29915429?>
        <pub-id pub-id-type="pmid">29915429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Audano</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Houwaart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>
        <source>Nat Genet</source>
        <year>2022</year>
        <volume>54</volume>
        <issue>4</issue>
        <fpage>518</fpage>
        <lpage>525</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01043-w</pub-id>
        <?supplied-pmid 35410384?>
        <pub-id pub-id-type="pmid">35410384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Gagie T, Navarro G, Prezza N. Optimal-Time Text Indexing in BWT-runs Bounded Space. In: Proceedings of the 29th Annual Symposium on Discrete Algorithms (SODA), pp. 1459–1477; 2018.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhnle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mun</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Efficient construction of a complete index for pan-genomics read alignment</article-title>
        <source>J Comput Biol</source>
        <year>2020</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>500</fpage>
        <lpage>513</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2019.0309</pub-id>
        <?supplied-pmid 32181684?>
        <pub-id pub-id-type="pmid">32181684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahmed</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kovaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Pan-genomic matching statistics for targeted nanopore sequencing</article-title>
        <source>iScience</source>
        <year>2021</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>102696</fpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2021.102696</pub-id>
        <?supplied-pmid 34195571?>
        <pub-id pub-id-type="pmid">34195571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Burrows M, Wheeler DJ. A block sorting lossless data compression algorithm. Technical Report 124, Digital Equipment Corporation 1994.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Ferragina P, Manzini G. Opportunistic data structures with applications. In: Proceedings of the 41st Annual Symposium on Foundations of Computer Science (FOCS), pp. 390–398; 2000.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJP</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malhotra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>OL</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1784</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08148-z</pub-id>
        <?supplied-pmid 30992455?>
        <pub-id pub-id-type="pmid">30992455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Audano</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Rodriguez-Martin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bonder</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sulovari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Serra Mari</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved diverse human genomes and integrated analysis of structural variation</article-title>
        <source>Science.</source>
        <year>2021</year>
        <volume>372</volume>
        <fpage>6537</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abf7117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rossi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oliva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gagie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Boucher</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MONI: a pangenomic index for finding maximal exact matches</article-title>
        <source>J Comput Biol</source>
        <year>2022</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>169</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2021.0290</pub-id>
        <?supplied-pmid 35041495?>
        <pub-id pub-id-type="pmid">35041495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lunter</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>15</issue>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id>
        <?supplied-pmid 21653522?>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>21</issue>
        <fpage>2987</fpage>
        <lpage>2993</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id>
        <?supplied-pmid 21903627?>
        <pub-id pub-id-type="pmid">21903627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Gog S, Beller T, Moffat A, Petri M. From theory to practice: Plug and play with succinct data structures. In: 13th International Symposium on Experimental Algorithms, (SEA 2014), pp. 326–337; 2014.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Belazzougui D, Cunial F, Gagie T, Prezza N, Raffinot M. Flexible indexing of repetitive collections. In: Kari J, Manea F, Petre I., editors. Unveiling dynamics and complexity. vol. 10307, pp. 162–174. Springer, Cham; 2017. Series Title: Lecture Notes in Computer Science.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dadi</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Ehrhardt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauswedell</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mehringer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rahn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pockrandt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Siragusa</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Urgese</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weese</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The SeqAn C++ template library for efficient sequence analysis: A resource for programmers</article-title>
        <source>J Biotechnol</source>
        <year>2017</year>
        <volume>261</volume>
        <fpage>157</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiotec.2017.07.017</pub-id>
        <?supplied-pmid 28888961?>
        <pub-id pub-id-type="pmid">28888961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Wagner J, Olson ND, Harris L, McDaniel J, Cheng H, Fungtammasan A, Hwang Y-C, Gupta R, Wenger AM, Rowell WJ, et al. Towards a comprehensive variation benchmark for challenging medically-relevant autosomal genes. 2021.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">NIST: Medically Relevant Genes. [Online]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/usnistgov/cmrg-benchmarkset-manuscript/tree/master/data/gene_coords/unsorted/GRCh38_mrg_full_gene.bed">https://github.com/usnistgov/cmrg-benchmarkset-manuscript/tree/master/data/gene_coords/unsorted/GRCh38_mrg_full_gene.bed</ext-link>. Accessed 19 Mar 2023.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mölder</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Letcher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Twardziok</surname>
            <given-names>SO</given-names>
          </name>
          <name>
            <surname>Kanitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holtgrewe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Sustainable data analysis with Snakemake</article-title>
        <source>F1000 Res</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.29032.2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dlugosz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KMC 3: counting and manipulating k-mer statistics</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>17</issue>
        <fpage>2759</fpage>
        <lpage>2761</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx304</pub-id>
        <?supplied-pmid 28472236?>
        <pub-id pub-id-type="pmid">28472236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Goga A, Baláž A, Petescia A, Gagie T. MARIA: multiple-alignment <inline-formula id="IEq143"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M300"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13015_2023_225_Article_IEq143.gif"/></alternatives></inline-formula>-index with aggregation. 2022. arXiv 2209.09218.</mixed-citation>
    </ref>
  </ref-list>
</back>
