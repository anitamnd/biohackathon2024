<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8097682</article-id>
    <article-id pub-id-type="pmid">32866237</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa733</article-id>
    <article-id pub-id-type="publisher-id">btaa733</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CONCUR: quick and robust calculation of codon usage from ribosome profiling data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Frye</surname>
          <given-names>Michaela</given-names>
        </name>
        <aff><institution>Cell Biology and Tumor Biology, German Cancer Research Center (DKFZ)</institution>, 69120 Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bornelöv</surname>
          <given-names>Susanne</given-names>
        </name>
        <xref rid="btaa733-cor1" ref-type="corresp"/>
        <aff><institution>Wellcome – MRC Cambridge Stem Cell Institute, University of Cambridge</institution>, Cambridge CB2 0AW, <country country="GB">UK</country></aff>
        <!--smb208@cam.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gorodkin</surname>
          <given-names>Jan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa733-cor1">To whom correspondence should be addressed. <email>smb208@cam.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-31">
      <day>31</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>5</issue>
    <fpage>717</fpage>
    <lpage>719</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa733.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>CONCUR is a standalone tool for codon usage analysis in ribosome profiling experiments. CONCUR uses the aligned reads in BAM format to estimate codon counts at the ribosome E-, P- and A-sites and at flanking positions.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>CONCUR is written in Perl and is freely available at <ext-link xlink:href="https://github.com/susbo/concur" ext-link-type="uri">https://github.com/susbo/concur</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Cancer Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000289</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>C10701/A15181</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000265</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>WT-MRC Cambridge Stem Cell Institute</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Ribosome profiling (Ribo-seq) relies on mRNA sequencing to measure protein translation. Because mRNAs located within a ribosome are protected from nuclease digestion, they can be captured and sequenced to reveal a snapshot of active translation (<xref rid="btaa733-B2" ref-type="bibr">Ingolia <italic toggle="yes">et al.</italic>, 2009</xref>). Ribo-seq can be used to study protein synthesis, translational dynamics and decoding. During translation elongation, the ribosome moves three nucleotides (nts) at a time when shifting from one codon to the next, thereby giving a characteristic 3-nt periodicity to the data. This periodicity enables the computational mapping of ribosomes at single-codon resolution.</p>
    <p>Importantly, the more time the ribosome spends at a given codon, the more likely that codon it is to be captured and sequenced. By calculating and comparing codon counts across different samples, differences in codon–anticodon pairing and amino acid incorporation can be identified.</p>
    <p>However, challenges arise from batch effects due to different experimental approaches, resulting in differently sized ribosome-protected mRNA fragments. Finding the correct reading frame and estimating codon frequencies is currently a time-consuming task and many steps have to be resolved manually. To streamline this process, we have developed CONCUR, a standalone tool for fast and efficient codon usage estimation. The only required input is a BAM file with aligned reads. CONCUR currently supports human, mouse, yeast and rat data but additional genomes can easily be installed.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Although most Ribo-seq data show 3-nt periodicity, the reading frame differs between experiments and read lengths. CONCUR calculates the reading frame periodicity for each read length and estimates the shift required for the ribosome P-site to be located at the same position in each read. The read lengths with the strongest periodicity are selected and shifted before calculating the overall codon usage.</p>
    <sec>
      <title>2.1 Initial read shift estimation</title>
      <p>Reads, which are 20–50nts in length, are included in the analysis, with the typical read length being around 28nts. Aligned reads that intersect annotated exons are identified and their 5′ reading frame is calculated. Reads mapping to the mitochondria are excluded. Reads mapping within 100nts of a start codon are extracted and used to identify the relative shift of each read length and frame. During translation, the ribosome stalls with the start codon positioned in its P-site. Protecting approximately 12nts upstream of its P-site from RNase digestion, this creates a distinctive peak upstream of the translation initiation site (TIS). However, the location of the peak differs slightly for each read length and must therefore be estimated from the data.</p>
      <p>To find the optimal offset, we count the number of 5′ ends mapping to each position around the expected peak 12nts upstream of the TIS. Each read length and frame are treated separately and the best shift, <italic toggle="yes">i</italic>, is estimated as
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mrow><mml:mi>argmax</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:munder><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>9</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>9</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>9</mml:mn></mml:mfrac><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">c<sub>i</sub></italic> is the number of 5′ ends mapping to position -12+<italic toggle="yes">i</italic>. Only positions defining a local counts maxima, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, are considered.</p>
      <p>To avoid inconclusive data, only read lengths and shifts where <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and with at least 1000 reads near the TIS are used in the following analysis. Those constrains are necessary to exclude read lengths causing noise. Lengths around 27–33nts are typically selected in this step and multiple frames are often informative.</p>
    </sec>
    <sec>
      <title>2.2 Validation and final selection of read shifts</title>
      <p>The selected read lengths and frames are used to calculate codon usage at the E-, P- and A-sites as well as three flanking positions in each direction. If all shifts were successfully predicted, the calculated codon frequencies at the P- and A-site should—regardless of their read length and frame—only be similar to frequencies at the same site. In addition, all other sites should show codon frequencies similar to each other and to the transcriptome-wide codon distribution. A similar strategy to select the offsets is used by RUST (<xref rid="btaa733-B5" ref-type="bibr">O’Connor <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <sec>
        <title>2.2.1 Correlation to transcriptome-wise counts</title>
        <p>To confirm that the predicted codon counts at the P- and A-sites both differ from the transcriptome-wide distribution, we defined a <italic toggle="yes">read set</italic>, <italic toggle="yes">R<sub>lf</sub></italic>, as all reads of a specific length, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and frame, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Codon counts for read set <italic toggle="yes">R<sub>lf</sub></italic> at site <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> are represented as <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. The read sets were scored based on how they correlated to the transcriptome-wide codon distribution. The mean correlation at the P- and A-sites is compared to the -2, -1, E, +1 and +2 sites:
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the correlation between the codon counts <italic toggle="yes">C</italic> and the transcriptome-wide background distribution, <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p>If the P- and A-sites had higher mean correlation than the flanking positions, i.e. if <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the read set was discarded. The read set with the highest score was identified as the best read set, and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> refer to the codon counts for that read set at positions P and A, respectively.</p>
      </sec>
      <sec>
        <title>2.2.2 Correlation to the best read sets</title>
        <p>Next, each read set was evaluated based on how well it agreed with the best read sets at the P- and A-sites. A read set was kept only if <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> had the highest correlation to the P-site in the tested read set, and similarly, if <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> has the highest correlation to the A-site of the tested read set:
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mrow><mml:mi>argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mrow/></mml:munderover><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mrow><mml:mi>argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mrow/></mml:munderover><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext>best</mml:mtext></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      </sec>
      <sec>
        <title>2.2.3 Removal of outliers</title>
        <p>Finally, to verify that none of the selected read sets have very different codon counts at the P- or A-site, we defined a rank-based score, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for each site <italic toggle="yes">s</italic> as:
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mtext>rank</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mtext>rank</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the rank of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> among all possible <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>—with the highest correlation giving the lowest rank (1)—and <italic toggle="yes">n</italic> is the number of read sets from site <italic toggle="yes">s</italic>. Intuitively, this score reflects how many of the most correlated sets of codon counts that derive from the expected site. A read set <italic toggle="yes">R<sub>lf</sub></italic> is kept if its scores at the P- and A-sites are at least half that of the highest score, i.e. if <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Finally, codon usage was calculated using only reads from read sets that passed all three filters.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Usage examples on real data</title>
      <p>CONCUR was used to replicate the results of two published studies. The first study by <xref rid="btaa733-B4" ref-type="bibr">Nedialkova <italic toggle="yes">et al.</italic> (2015)</xref> examined yeast in which a tRNA anticodon modification was disrupted, resulting in slower translation at cognate codons <italic toggle="yes">in vivo</italic>. The second study by <xref rid="btaa733-B1" ref-type="bibr">Bornelöv <italic toggle="yes">et al.</italic> (2019)</xref> characterized codon usage changes during differentiation of human pluripotent stem cells. Ribo-seq data were downloaded and pre-processed and CONCUR was run on the resulting BAM files. For the tested datasets, CONCUR reproduced the published results or was able to detect a stronger effect. See<xref rid="btaa733-F1" ref-type="fig">Figure 1</xref> for an example. More details and results are available in Supplementary Section S1 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>, including some run-time examples.
</p>
      <fig position="float" id="btaa733-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Codon enrichments in yeast lacking the <italic toggle="yes">ncs2</italic> gene compared to wild-type controls at the ribosome A-site during stress (30-min diamide treatment). The three codons that require a modified tRNA are highlighted. The stop codon enrichment suggests an additional effect on translational termination. Values shown are log2-transformed</p>
        </caption>
        <graphic xlink:href="btaa733f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Differences to existing tools</title>
      <p>To our knowledge, CONCUR is the first tool dedicated to codon usage estimation. However, some existing tools and pipelines are capable of P-site offset calculation and/or codon usage estimation. An overview of existing tools and key features and differences are provided in Supplementary Sections S2.1 and S2.2 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
      <p>In contrast to the other tools, CONCUR can handle multiple frames for the same read length. This approach has previously only been used by Ribodeblur, an offset estimation tool developed specifically for yeast (<xref rid="btaa733-B6" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2017</xref>). Inclusion of multiple frames and the extensive filters and validation steps in CONCUR provided more consistent results on the test data compared with several existing tools. This is discussed further in Supplementary Sections S2.2 and S2.3 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We present CONCUR, a tool aimed to simplify and standardize codon usage analysis. CONCUR has been extensively tested on in-house and publicly available datasets. The only required input is a BAM file with alignments to a reference genome, making the process very quick and robust.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Cancer Research UK [C10701/A15181] and a core support grant from the Wellcome Trust and Medical Research Council to the WT-MRC Cambridge Stem Cell Institute.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa733_Supplementary_Data</label>
      <media xlink:href="btaa733_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa733-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bornelöv</surname>
 <given-names>S.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Codon usage optimization in pluripotent embryonic stem cells</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>119</fpage>.<pub-id pub-id-type="pmid">31174582</pub-id></mixed-citation>
    </ref>
    <ref id="btaa733-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ingolia</surname>
 <given-names>N.T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title>. <source>Science</source>, <volume>324</volume>, <fpage>218</fpage>–<lpage>223</lpage>.<pub-id pub-id-type="pmid">19213877</pub-id></mixed-citation>
    </ref>
    <ref id="btaa733-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ingolia</surname>
 <given-names>N.T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Ribosome profiling of mouse embryonic stem cells reveals the complexity and dynamics of mammalian proteomes</article-title>. <source>Cell</source>, <volume>147</volume>, <fpage>789</fpage>–<lpage>802</lpage>.<pub-id pub-id-type="pmid">22056041</pub-id></mixed-citation>
    </ref>
    <ref id="btaa733-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nedialkova</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Optimization of codon translation rates via tRNA modification maintains proteome integrity</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1606</fpage>–<lpage>1618</lpage>.<pub-id pub-id-type="pmid">26052047</pub-id></mixed-citation>
    </ref>
    <ref id="btaa733-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Connor</surname>
 <given-names>P.B.F.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Comparative survey of the relative impact of mRNA features on local ribosome profiling read density</article-title>. <source>Nat. Commun</source>., <volume>7</volume>, <fpage>12915</fpage>.<pub-id pub-id-type="pmid">27698342</pub-id></mixed-citation>
    </ref>
    <ref id="btaa733-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Accurate recovery of ribosome positions reveals slow translation of wobble-pairing codons in yeast</article-title>. <source>J. Comput. Biol</source>., <volume>24</volume>, <fpage>6</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
