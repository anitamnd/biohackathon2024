<?properties open_access?>
<?subarticle pcbi.1007722.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7217484</article-id>
    <article-id pub-id-type="pmid">32352965</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-02103</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007722</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Material Properties</subject>
            <subj-group>
              <subject>Solubility</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biophysics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Neural Networks</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neural Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Support Vector Machines</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Extraction Techniques</subject>
          <subj-group>
            <subject>Protein Extraction</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Mutagenesis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Insight into the protein solubility driving forces with neural attention</article-title>
      <alt-title alt-title-type="running-head">Insight into protein solubility with neural attention</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1157-1899</contrib-id>
        <name>
          <surname>Raimondi</surname>
          <given-names>Daniele</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Orlando</surname>
          <given-names>Gabriele</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fariselli</surname>
          <given-names>Piero</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4647-6560</contrib-id>
        <name>
          <surname>Moreau</surname>
          <given-names>Yves</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>ESAT-STADIUS, KU Leuven, Leuven, Belgium</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>SWITCH Lab, KU Leuven, Leuven, Belgium</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Università di Torino, Torino, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alexov</surname>
          <given-names>Emil</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Clemson University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>yves.moreau@kuleuven.be</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>4</issue>
    <elocation-id>e1007722</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Raimondi et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Raimondi et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007722.pdf"/>
    <abstract>
      <p>Protein solubility is a key aspect for many biotechnological, biomedical and industrial processes, such as the production of active proteins and antibodies. In addition, understanding the molecular determinants of the solubility of proteins may be crucial to shed light on the molecular mechanisms of diseases caused by aggregation processes such as amyloidosis. Here we present SKADE, a novel Neural Network protein solubility predictor and we show how it can provide novel insight into the protein solubility mechanisms, thanks to its neural attention architecture. First, we show that SKADE positively compares with state of the art tools while using just the protein sequence as input. Then, thanks to the neural attention mechanism, we use SKADE to investigate the patterns learned during training and we analyse its decision process. We use this peculiarity to show that, while the attention profiles do not correlate with obvious sequence aspects such as biophysical properties of the aminoacids, they suggest that N- and C-termini are the most relevant regions for solubility prediction and are predictive for complex emergent properties such as aggregation-prone regions involved in beta-amyloidosis and contact density. Moreover, SKADE is able to identify mutations that increase or decrease the overall solubility of the protein, allowing it to be used to perform large scale in-silico mutagenesis of proteins in order to maximize their solubility.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>The solubility of proteins is a crucial biophysical aspect when it comes to understanding many human diseases and to improve the industrial processes for protein production. Due to its relevance, computational methods have been devised in order to study and possibly optimize the solubility of proteins. In this work we apply a deep-learning technique, called <italic>neural attention</italic> to predict protein solubility while “opening” the model itself to interpretability, even though Machine Learning models are usually considered <italic>black boxes</italic>. Thank to the attention mechanism, we show that i) our model implicitly learns complex patterns related to emergent, protein folding-related, aspects such as to recognize <italic>β</italic>-amyloidosis regions and that ii) the N-and C-termini are the regions with the highes signal fro solubility prediction. When it comes to enhancing the solubility of proteins, we, for the first time, propose to investigate the synergistic effects of tandem mutations instead of “single” mutations, suggesting that this could minimize the number of required proposed mutations.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1157-1899</contrib-id>
          <name>
            <surname>Raimondi</surname>
            <given-names>Daniele</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>DR is founded by a FWO post-doctoral fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="3"/>
      <page-count count="15"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-05-12</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are publicly available from the respective papers. The code described in this study is available at: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/eddiewrc/skade/src">https://bitbucket.org/eddiewrc/skade/src</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are publicly available from the respective papers. The code described in this study is available at: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/eddiewrc/skade/src">https://bitbucket.org/eddiewrc/skade/src</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Proteins have evolved within the different cellular environments to improve or preserve their functions, maintaining at the same time a degree of hydrophobicity necessary to proper fold, and enough solubility to prevent protein precipitation. Solubility is then a fundamental ingredient that must be properly balanced to maintain the protein functions and not aggregating [<xref rid="pcbi.1007722.ref001" ref-type="bibr">1</xref>]. Protein solubility is also an essential aspect in diagnostic and therapeutic applications [<xref rid="pcbi.1007722.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007722.ref003" ref-type="bibr">3</xref>], as well as being a critical requirement for protein homeostasis [<xref rid="pcbi.1007722.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1007722.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007722.ref005" ref-type="bibr">5</xref>]. Solubility deficit can hamper protein-based drug development, generating insoluble protein precipitates that can be toxic and may elicit an immune response in patients [<xref rid="pcbi.1007722.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1007722.ref007" ref-type="bibr">7</xref>]. Protein aggregation is considered an hallmark of more than forty human diseases, that span from neurodegenerative illness, to cancer and to metabolic disorders such as diabetes [<xref rid="pcbi.1007722.ref008" ref-type="bibr">8</xref>].</p>
    <p>Since the soluble expression of proteins is crucial for protein production [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>] for both pharmacological and research goals [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>], in-silico bioinformatics models have been developed to predict i) the solubility of proteins [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1007722.ref013" ref-type="bibr">13</xref>] or ii) the solubility change upon mutation [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1007722.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1007722.ref015" ref-type="bibr">15</xref>], in order to, respectively, i) select the most likely soluble proteins [<xref rid="pcbi.1007722.ref012" ref-type="bibr">12</xref>] and ii) run in-silico mutagenesis to increase the solubility of existent proteins [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>].</p>
    <p>The methods developed so far in both categories use various Machine Learning (ML) approaches, such as Neural Networks (NN) [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>], Gradient Boosting Machines [<xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>], Support Vector Machines (SVM) [<xref rid="pcbi.1007722.ref013" ref-type="bibr">13</xref>], Logistic Regression [<xref rid="pcbi.1007722.ref012" ref-type="bibr">12</xref>] or simpler statistical methods [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>]. Most of these approaches compute predictions starting from just the proteins sequence, with the exception of CamSol, which uses PDB structures [<xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>]. Among the sequence-based features used, the most common are: i) biophysical propensity scales values (e.g. hydrophobicity, charge), ii) various forms of k-mers frequencies (such as mono, bi- or tri-peptides occurrences), iii) predictions from other methods (e.g. disorder, Secondary Structure, Relative Solvent Accessibility or aggregation predictors) and iv) <italic>global</italic> features such as sequence length and the fraction of residues exposed to the solvent.</p>
    <p>A common issue that the methods predicting the solubility of proteins had to face is the fact that the input protein sequences may have very different lengths, and indeed building ML models able to work with protein sequences is a common task in structural bioinformatics. From the ML standpoint, this task is not trivial because the variable length of proteins poses some issues to conventional ML methods, such SVM or Random Forests. This problem is usually addressed by using sliding window techniques to predict each residue independently [<xref rid="pcbi.1007722.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1007722.ref017" ref-type="bibr">17</xref>], but different solutions are needed when a single prediction must be associated to an entire protein sequence [<xref rid="pcbi.1007722.ref013" ref-type="bibr">13</xref>, <xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1007722.ref018" ref-type="bibr">18</xref>], since the information content of an entire sequence needs to be <italic>shrunk</italic> into a single predictive scalar value.</p>
    <p>Neural Networks (NN) are flexible models that can elegantly address this issue. The classical approaches consist in building a pyramid-like architecture [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>] that takes the protein sequence as input and reduces it to a fixed size through subsequent abstraction layers, ending with a feed-forward sub-network that yields the final scalar prediction.</p>
    <p>Here we propose a novel solution to this issue, which has been inspired by the neural attention mechanisms developed for Natural Language Processing and machine translation [<xref rid="pcbi.1007722.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1007722.ref020" ref-type="bibr">20</xref>]. Our model is called SKADE and uses a neural attention-like architecture to elegantly process the information contained in protein sequences towards the prediction of their solubility. By comparing it with state of the art methods we show that it has competitive performances while requiring as inputs just the protein sequence.</p>
    <p>Additionally, the use of neural attention allows our model to be <italic>interpreted</italic>, showing that the learned patterns correlate with complex sequence aspects such as the presence of aggregating regions or the protein contact density, while it does not correlate with more trivial aspects such as biophysical propensity scales or solvent accessibility.</p>
    <p>We also show that, even if it has not been specifically trained for the task, SKADE can distinguish between mutations that increase or decrease the proteins’ solubility. This, coupled with the fact that it can generate hundreds of predictions per second, makes it ideal to perform in-silico optimization of protein solubility. To show its potential in this sense, we performed a complete in-silico mutagenesis of the UPF0235 protein MTH_637, computing both the effect of all the possible single mutations and all possible pairs of <italic>tandem</italic> mutations (&gt; 2 × 10<sup>6</sup> pairs). This allowed us to investigate the possible effects of <italic>synergistic</italic> interactions between mutations, indicating that, in certain regions of the proteins, the implementation of pairs of mutations could have a larger effect that the sum of the effects of independent mutations. Finally, we show that the predicted synergistic effects have a significant correlation with the average contact distances between residues, extracted from the protein PDB structure, suggesting that SKADE is able to catch a glimpse of complex emergent properties such as the contact density.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Datasets</title>
      <p>To train and test our model, we used the protein solubility datasets adopted in [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>]. Using the same training/testing data and procedure allowed us to compare the performances of SKADE with the most recently published methods. The training set contains 28972 soluble and 40448 insoluble proteins that have been annotated with the pepcDB [<xref rid="pcbi.1007722.ref021" ref-type="bibr">21</xref>] “soluble” (or subsequent stages) annotations in [<xref rid="pcbi.1007722.ref012" ref-type="bibr">12</xref>]. The test dataset contains 1000 soluble and 1001 insoluble proteins, and has been compiled by [<xref rid="pcbi.1007722.ref022" ref-type="bibr">22</xref>].</p>
      <p>To validate the ability of SKADE to distinguish between variants increasing or decreasing the overall solubility of the protein, we adopted the dataset used in CamSol [<xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>], which contains 142 variants known to increase or decrease the solubility of 42 proteins.</p>
    </sec>
    <sec id="sec004">
      <title>Neural attention for protein sequences</title>
      <p>SKADE is a NN model which consists in two sub-networks: the predictor network <italic>P</italic> and the attention network <italic>A</italic>.</p>
      <p>The NN takes as input just a the target proteins sequences, without using evolutionary information or other kinds of annotations. As a first step, each residue in the input sequence is translated into a trainable 20-dimensional embedding encoding the 20 possible amino acids. The embedded sequences are then sorted and padded, in order to maximize the efficiency of the NN computations on GPUs.</p>
      <p>Both <italic>A</italic> and <italic>P</italic> are constituted by 2 layers of bidirectional Gated Recurrent Unit (GRU) [<xref rid="pcbi.1007722.ref023" ref-type="bibr">23</xref>] networks with 20 hidden dimensions. The GRU network runs on the input sequences, outputting 20 dimensional vector for each residue. Since the GRU is bidirectional, for each protein it provides two 20 × <italic>L</italic> tensors as output, where L is the length of the sequence. The two tensors obtained from the forward and backward pass of the bidirectional GRU are concatenated into a 40 × <italic>L</italic> and further processed by a linear layer that produces a single scalar value for each residue, obtaining a 1 × <italic>L</italic> tensor for each protein.</p>
      <p>At this point the <italic>A</italic> and <italic>P</italic> network differ: the last layer of the predictor <italic>P</italic> has a LeakyReLU activation while the attention network A has a SoftMax activation that is globally applied over the entire 1 × <italic>L</italic> tensor T, ensuring that <inline-formula id="pcbi.1007722.e001"><alternatives><graphic xlink:href="pcbi.1007722.e001.jpg" id="pcbi.1007722.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      <p>To obtain the final prediction, for each protein the scalar product <italic>a</italic><sup><italic>T</italic></sup>
<italic>p</italic> between the 1 × <italic>L</italic> tensors <italic>a</italic> and <italic>p</italic>, respectively obtained from the <italic>P</italic> and <italic>A</italic> sub-networks is computed, allowing the SoftMax-ed attention vector <italic>a</italic> to <italic>select</italic> the position on the vector <italic>p</italic> that should be given highest relevance for the final prediction. The resulting value is passed through a Sigmoid activation, constraining the final output of SKADE withing the 0-1 range.</p>
      <p>Conceptually, the predictor network P should assign different solubility-related values to each residue in the protein, considering also the local sequence context. In parallel, the attention network <italic>A</italic> should learn on which protein regions its attention should be focused.</p>
      <p>The final model has 25462 trainable parameters, uses a batch size of 1001 with an initial learning rate of 0.01. We used the Adam optimizer with a L2 regularization equal to 10<sup>−6</sup> and it is trained for 50 epochs. The model has been implemented in Pytorch version 1.0.1 [<xref rid="pcbi.1007722.ref024" ref-type="bibr">24</xref>]. The code is freely available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/eddiewrc/skade/src">https://bitbucket.org/eddiewrc/skade/src</ext-link>.</p>
    </sec>
    <sec id="sec005">
      <title>Validation procedure and performance evaluation</title>
      <p>In order to compare our results with [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>], we reproduced their validation procedure. We trained our model on the 69420 proteins in the trainset and we tested it on the 2001 proteins in the test set from [<xref rid="pcbi.1007722.ref022" ref-type="bibr">22</xref>]. We used the widely adopted Sensitivity (Sen), Specificity (Spe), Precision (Pre), Accuracy (Acc), Matthews Correlation Coefficient (MCC), Area Under the ROC curve AUC and Area Under the Precision Recall Curve (AUPRC) metrices to evaluate the predictions. The Balanced Accuracy (BAC) is computed as the arithmetic mean of Sen and Spe.</p>
      <p>To assess the ability of SKADE to distinguish between variants increasing or decreasing the solubility of proteins, we followed the procedure used in SODA [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec006">
    <title>Results</title>
    <sec id="sec007">
      <title>SKADE predicts protein solubility from just the protein amino acid sequence</title>
      <p>The most recently developed tools for the protein solubility prediction [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>] use various kinds of features. These can be divided into sequence related features (e.g. k-mers and their frequencies of occurrence, biophysical propensity scales sequence descriptions), global features (e.g. sequence length, molecular weight, fraction of residues with certain biophysical properties) and structural features, such as secondary structure assignments (SS) and Relative Solvent Accessibility (RSA) [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>].</p>
      <p>During the development of SKADE we chose to use only the protein sequences as inputs because the addition of any other kind of features would pose certain restrictions to our model. For example, in [<xref rid="pcbi.1007722.ref025" ref-type="bibr">25</xref>] it has been shown that, although extremely valuable, the use of Multiple Sequence Alignments (MSAs) as features could bias predictors towards more studied proteins (e.g. proteins for which many homologous sequences are known). Another recent study we conducted [<xref rid="pcbi.1007722.ref026" ref-type="bibr">26</xref>] showed that the use of biophysical propensity scales coupled with sophisticate ML method could be just a discrete and intrinsically limited way to find an optimized embedding description of the amino acids in the proteins, and using entirely random scales could give extremely similar results [<xref rid="pcbi.1007722.ref026" ref-type="bibr">26</xref>]. Finally, our rationale to avoid the use of global features is that, since the solubility of a protein is a crucial step for its expression and large scale manufacture, we envision SKADE as a tool for the in-silico optimization of protein solubility, and thus we deemed global features such as the protein length, the molecular weight and the absolute charge as not suitable for our framework, since they are not characteristics on which we want to act directly while perform the optimization.</p>
      <p><xref ref-type="supplementary-material" rid="pcbi.1007722.s008">S6 Fig</xref> shows a PCA of the learned embeddings, and <xref ref-type="supplementary-material" rid="pcbi.1007722.s002">S2 Text</xref> contains their actual 20-dimensional values.</p>
    </sec>
    <sec id="sec008">
      <title>SKADE positively compares with state of the art predictors</title>
      <p>We trained and tested SKADE following the same procedure adopted in [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007722.ref011" ref-type="bibr">11</xref>], which are two of the most recently developed solubility predictors. This allowed us to compare SKADE with the most relevant state of the art methods, extending the benchmark initially proposed in [<xref rid="pcbi.1007722.ref022" ref-type="bibr">22</xref>]. This procedure involved a training set containing 69420 proteins and a test set of 2001 proteins. The results obtained by SKADE and the comparison with other methods is shown in <xref rid="pcbi.1007722.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="pcbi.1007722.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Table showing the comparison between SKADE and the state of the art tools benchmarked in [<xref rid="pcbi.1007722.ref022" ref-type="bibr">22</xref>].</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007722.t001g" xlink:href="pcbi.1007722.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Methods</th>
                <th align="right" rowspan="1" colspan="1">Sen</th>
                <th align="right" rowspan="1" colspan="1">Spe</th>
                <th align="right" rowspan="1" colspan="1">Pre</th>
                <th align="right" rowspan="1" colspan="1">Acc</th>
                <th align="right" rowspan="1" colspan="1">MCC</th>
                <th align="right" rowspan="1" colspan="1">AUC</th>
                <th align="right" rowspan="1" colspan="1">AUPRC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SKADE</td>
                <td align="right" rowspan="1" colspan="1">66</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>81</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>78</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">73</td>
                <td align="right" rowspan="1" colspan="1">47</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>82</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>82</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PaRSnIP</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>76</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">72</td>
                <td align="right" rowspan="1" colspan="1">70</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>74</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>48</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>82</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">80</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepSol S1</td>
                <td align="right" rowspan="1" colspan="1">75</td>
                <td align="right" rowspan="1" colspan="1">71</td>
                <td align="right" rowspan="1" colspan="1">69</td>
                <td align="right" rowspan="1" colspan="1">73</td>
                <td align="right" rowspan="1" colspan="1">46</td>
                <td align="right" rowspan="1" colspan="1">81</td>
                <td align="right" rowspan="1" colspan="1">81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PROSO II</td>
                <td align="right" rowspan="1" colspan="1">67</td>
                <td align="right" rowspan="1" colspan="1">68</td>
                <td align="right" rowspan="1" colspan="1">69</td>
                <td align="right" rowspan="1" colspan="1">64</td>
                <td align="right" rowspan="1" colspan="1">34</td>
                <td align="right" rowspan="1" colspan="1">74</td>
                <td align="right" rowspan="1" colspan="1">71</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CCSOL</td>
                <td align="right" rowspan="1" colspan="1">54</td>
                <td align="right" rowspan="1" colspan="1">54</td>
                <td align="right" rowspan="1" colspan="1">51</td>
                <td align="right" rowspan="1" colspan="1">54</td>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="right" rowspan="1" colspan="1">-</td>
                <td align="right" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SOLPRO</td>
                <td align="right" rowspan="1" colspan="1">62</td>
                <td align="right" rowspan="1" colspan="1">58</td>
                <td align="right" rowspan="1" colspan="1">51</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">20</td>
                <td align="right" rowspan="1" colspan="1">-</td>
                <td align="right" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PROSO</td>
                <td align="right" rowspan="1" colspan="1">58</td>
                <td align="right" rowspan="1" colspan="1">57</td>
                <td align="right" rowspan="1" colspan="1">54</td>
                <td align="right" rowspan="1" colspan="1">58</td>
                <td align="right" rowspan="1" colspan="1">16</td>
                <td align="right" rowspan="1" colspan="1">-</td>
                <td align="right" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RPSP</td>
                <td align="right" rowspan="1" colspan="1">52</td>
                <td align="right" rowspan="1" colspan="1">51</td>
                <td align="right" rowspan="1" colspan="1">44</td>
                <td align="right" rowspan="1" colspan="1">52</td>
                <td align="right" rowspan="1" colspan="1">3</td>
                <td align="right" rowspan="1" colspan="1">-</td>
                <td align="right" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCM</td>
                <td align="right" rowspan="1" colspan="1">65</td>
                <td align="right" rowspan="1" colspan="1">57</td>
                <td align="right" rowspan="1" colspan="1">42</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">21</td>
                <td align="right" rowspan="1" colspan="1">-</td>
                <td align="right" rowspan="1" colspan="1">-</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>From DeepSol [<xref rid="pcbi.1007722.ref010" ref-type="bibr">10</xref>] we reported the performance of their S1 model, which is the DeepSol version that uses only protein sequence information. PaRSnIP and all the other method, on the other hand, use any kind of features, some of which include information related to Secondary Structures, Relative Solvent Accessibility and other biophysical aspects. Notwithstanding this limitation, <xref rid="pcbi.1007722.t001" ref-type="table">Table 1</xref> shows that SKADE has the best AUPRC and the best AUC, on par with PaRSnIP.</p>
    </sec>
    <sec id="sec009">
      <title>The role of attention</title>
      <p>As shown in <xref ref-type="fig" rid="pcbi.1007722.g001">Fig 1</xref>, SKADE’s NN is divided into two sub-networks. The sub-network A is used to compute the per-residues SoftMax-ed attention values <italic>a</italic> while the sub-network P is used to compute the per-residue predictions <italic>p</italic>. The final solubility prediction for each protein is obtained as <italic>σ</italic>(<italic>a</italic><sup><italic>T</italic></sup>
<italic>p</italic>), where <italic>σ</italic> is a Sigmoid activation. This value is thus a linear combination between <italic>p</italic> and <italic>a</italic>, and the <italic>A</italic> networks is responsible to assign the coefficients that are used to weight the per-residues predictions proposed by <italic>P</italic>. This is analogous to a bias-less Logistic Regression in which the weights are dynamically <italic>predicted</italic> for each sample instead of being learned once for all, and it allows SKADE to work with input sequences with arbitrary length, making it suitable to bioinformatics applications.</p>
      <fig id="pcbi.1007722.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Figure showing the structure of the NN.</title>
          <p>The protein sequence is translated into a 20 dimensional embedding and then passed to the predictor network P (left) and the attention network A (right). Each of these subnetworks contain 2 layers of bi-directional GRU network, followed by a feed-forward. The predictor ends with a LeakyReLU activation, while the attention network has a SoftMax activation. Finally, the 1 × <italic>L</italic> outputs of the two networks are reduced to a predictive, probability-like, scalar value by a dot product operation, followed by a SIgmoid activation.</p>
        </caption>
        <graphic xlink:href="pcbi.1007722.g001"/>
      </fig>
      <p>Moreover, since <inline-formula id="pcbi.1007722.e002"><alternatives><graphic xlink:href="pcbi.1007722.e002.jpg" id="pcbi.1007722.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with <italic>σ</italic> monotonically increasing, residues <italic>i</italic> with a positive value of <italic>a</italic><sub><italic>i</italic></sub> × <italic>p</italic><sub><italic>i</italic></sub> steer the prediction towards the class 1 (soluble), while residues with negative values are actually “voting” for the class 0. This means that these per-residue values can be considered as the <italic>solubility profile</italic> of the protein (see <xref ref-type="supplementary-material" rid="pcbi.1007722.s005">S3</xref>–<xref ref-type="supplementary-material" rid="pcbi.1007722.s007">S5</xref> Figs for the attention and prediction profiles of the proteins Q8TC59, Q9HBE1 and P25984).</p>
      <p>In order to analyse the behavior of SKADE and to investigate the learned patterns of attention, we tried to correlate the per-residue attention and solubility profiles to known biophysical properties, such as hydrophobicity, polarity, charge, volume and the propensities of the residues being in <italic>α</italic>-helical or <italic>β</italic>-sheet conformation, but no correlation with these values has been detected (see Table A1 in <xref ref-type="supplementary-material" rid="pcbi.1007722.s001">S1 Text</xref>), indicating that the A and P networks behavior cannot be directly associated with trivial sequence properties. We also tested the correlation of the profiles against in-house Relative Solvent Accessibility (RSA) predictions, obtaining a Pearson correlation of <italic>r</italic> = 0.0237.</p>
    </sec>
    <sec id="sec010">
      <title>SKADE solubility profiles detect aggregation patches</title>
      <p>We then tested the predictive power of SKADE’s solubility profiles on the AMYL dataset [<xref rid="pcbi.1007722.ref027" ref-type="bibr">27</xref>], which contains 34 amyloidogenic proteins whose aggregating regions have been used in [<xref rid="pcbi.1007722.ref028" ref-type="bibr">28</xref>] to benchmark the performances of per-residue in-silico aggregation predictors. The AMYL dataset contains annotations indicating the involvement of each residue in <italic>β</italic>-amyloidosis aggregation, for a total of 7732 residues, 2599 of which are responsible for aggregation.</p>
      <p>SKADE’s solubility profiles show an interesting signal towards the prediction of aggregating regions in these proteins. The profiles have an AUC of 65 even though SKADE has not been trained on the proteins in the AMYL dataset nor on the <italic>β</italic>-amyloidosis aggregation task at any point. To better contextualize the magnitude of this signal, in <xref rid="pcbi.1007722.t002" ref-type="table">Table 2</xref> we compared the performance of SKADE’s solubility profiles with state of the art tools that have been specifically developed to predict aggregation. We can see that even though the solubility profiles of SKADE are a byproduct of the neural attention model and have been obtained in a completely unsupervised way with respect to the task at hand, SKADE provides quite competitive performance when it comes to identifying aggregating regions in proteins.</p>
      <table-wrap id="pcbi.1007722.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of the performance of SKADE with state of the art aggregation predictors on the amyl33 dataset [<xref rid="pcbi.1007722.ref027" ref-type="bibr">27</xref>].</title>
          <p>Results are reported from [<xref rid="pcbi.1007722.ref028" ref-type="bibr">28</xref>].</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007722.t002g" xlink:href="pcbi.1007722.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="center" rowspan="1" colspan="1">Sen</th>
                <th align="center" rowspan="1" colspan="1">Spe</th>
                <th align="center" rowspan="1" colspan="1">BAC</th>
                <th align="center" rowspan="1" colspan="1">MCC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">AgMata</td>
                <td align="center" rowspan="1" colspan="1">43</td>
                <td align="center" rowspan="1" colspan="1">84</td>
                <td align="center" rowspan="1" colspan="1">66</td>
                <td align="center" rowspan="1" colspan="1">25</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PASTA 2 (85 specificity)</td>
                <td align="center" rowspan="1" colspan="1">41</td>
                <td align="center" rowspan="1" colspan="1">85</td>
                <td align="center" rowspan="1" colspan="1">63</td>
                <td align="center" rowspan="1" colspan="1">24</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PASTA 2 (90 specificity)</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="center" rowspan="1" colspan="1">90</td>
                <td align="center" rowspan="1" colspan="1">60</td>
                <td align="center" rowspan="1" colspan="1">22</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">AMYLPRED2</td>
                <td align="center" rowspan="1" colspan="1">39</td>
                <td align="center" rowspan="1" colspan="1">84</td>
                <td align="center" rowspan="1" colspan="1">62</td>
                <td align="center" rowspan="1" colspan="1">22</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>SKADE</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">55</td>
                <td align="center" rowspan="1" colspan="1">71</td>
                <td align="center" rowspan="1" colspan="1">63</td>
                <td align="center" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MetAmyl</td>
                <td align="center" rowspan="1" colspan="1">52</td>
                <td align="center" rowspan="1" colspan="1">71</td>
                <td align="center" rowspan="1" colspan="1">62</td>
                <td align="center" rowspan="1" colspan="1">17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Tango</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">96</td>
                <td align="center" rowspan="1" colspan="1">55</td>
                <td align="center" rowspan="1" colspan="1">14</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Aggrescan</td>
                <td align="center" rowspan="1" colspan="1">35</td>
                <td align="center" rowspan="1" colspan="1">79</td>
                <td align="center" rowspan="1" colspan="1">57</td>
                <td align="center" rowspan="1" colspan="1">13</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">FishAmyloid</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">94</td>
                <td align="center" rowspan="1" colspan="1">54</td>
                <td align="center" rowspan="1" colspan="1">10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">FoldAmyloid</td>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">87</td>
                <td align="center" rowspan="1" colspan="1">54</td>
                <td align="center" rowspan="1" colspan="1">8</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We can thus conclude that, although the neural attention profiles do not show correlation with trivial biophysical aspects of the protein sequence, the <italic>a</italic><sub><italic>i</italic></sub> × <italic>p</italic><sub><italic>i</italic></sub> per-residue solubility profiles that are responsible for the final prediction show an interesting correlation with a complex and still only partially understood behavior such as <italic>β</italic>-amyloidosis aggregation of proteins.</p>
    </sec>
    <sec id="sec011">
      <title>The N- and C-termini are the most relevant regions for the protein solubility prediction</title>
      <p>Further analysing the data extracted from the neural attention used in SKADE, in <xref ref-type="fig" rid="pcbi.1007722.g002">Fig 2</xref>, we show the mean and median values of attention <italic>a</italic> (red) and prediction <italic>p</italic> (blue) in function of the relative position of the residues in the sequence. <xref ref-type="supplementary-material" rid="pcbi.1007722.s003">S1 Fig</xref> shows the distributions of the <italic>a</italic><sub><italic>i</italic></sub> × <italic>p</italic><sub><italic>i</italic></sub> per-residues solubility profile value, where <italic>i</italic> is the residue position in each sequence. From both figures it clearly appears that SKADE focuses its attention to the N- and C-termini of the proteins, indicating that they contain signal for the prediction of the protein solubility. To investigate whether this behavior is an artifact of the recurrent modules in our NN, we tested SKADE on the 2001 sequences in the test set, but first removing the initial and final 20% of residues from each of them. The obtained AUC is very close to random (0.55), indicating that the beginning and the end of the sequences might indeed carry an important signal for the prediction of the protein solubility. On the contrary, when we test SKADE on the 2001 sequences in the test set after removing the central residues (located in the relative sequence positions between the 20th and 80th percentiles), the performances are very similar to normal (0.81 of AUC).</p>
      <fig id="pcbi.1007722.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Plot showing the mean (solid red) and median (light red) attention values, compared with the mean (solid blue) and median (light blue) prediction values, in function of the position in the sequence.</title>
          <p>On average, SKADE assigns higher values to positions close to the N- and C-termini.</p>
        </caption>
        <graphic xlink:href="pcbi.1007722.g002"/>
      </fig>
      <p>To further ensure that this behavior is due to the signal carried by the N- and C-termini regions and not an artifact of SKADE’s architecture, we repeated the same experiments by using the DeepSol S1 webserver to predict the 2001 proteins in the test set after removing i) the initial and final 20% of residues from each sequence, and ii) the central portion of each protein (from the 20th to the 80th percentile). Similarly to the results obtained with SKADE, DeepSolS1 produces almost random predictions when the N- and C-termini are removed from the input sequences (AUC = 0.53), and exactly normal predictions when the central part of the protein is removed (AUC = 0.81). This shows that also DeepSol S1, which is based on a completely different architecture from SKADE, implicitly exploits the information contained in the extremities of the sequences to perform its prediction.</p>
      <p>We also searched in literature whether the relevance of N- and C-termini was already established, and although we did not find exhaustive studies analysing this behavior, a number of papers investigated specific cases. For example, it has been shown that mutating the N-terminus of the mitochondrial aminoacyl-tRNA synthetases [<xref rid="pcbi.1007722.ref029" ref-type="bibr">29</xref>], sperm whale myoglobin [<xref rid="pcbi.1007722.ref030" ref-type="bibr">30</xref>] and hen egg-white lysozyme [<xref rid="pcbi.1007722.ref031" ref-type="bibr">31</xref>] enhances their expression and solubility.</p>
    </sec>
    <sec id="sec012">
      <title>Unsupervised prediction of solubility change upon mutation</title>
      <p>One of the possible applications of protein solubility predictors is the in-silico optimization of protein sequences to enhance their solubility, for example by selecting the smallest possible set of variants able to increase the solubility of the sequence while minimizing the structural and functional alterations to the original protein.</p>
      <p>To do so, it is necessary that the prediction methods are able to distinguish between variants that increase or decrease the overall solubility of the sequence. Unfortunately, very little experimental data is available in this sense, and in particular, to the best of our knowledge, no data concerning the effect of multiple mutations or insertions/deletions on the solubility of proteins is available.</p>
      <p>To evaluate the ability of SKADE to identify mutations increasing or decreasing protein solubility, we used the CamSol [<xref rid="pcbi.1007722.ref014" ref-type="bibr">14</xref>] dataset, which contains 56 experimentally validated mutations. <xref ref-type="supplementary-material" rid="pcbi.1007722.s009">S7 Fig</xref> shows the distribution of the variants in CamSol on the corresponding protein sequences.</p>
      <p>Since SKADE is designed to take the whole target protein sequence as input, to evaluate the solubility change upon mutation we predicted both the wildtype and the mutated target sequence, computing the difference in predicted solubility between the wildtype (<italic>WT</italic><sub><italic>s</italic></sub>) and the mutant (<italic>MUT</italic><sub><italic>s</italic></sub>) as Δ<italic>S</italic> = <italic>MUT</italic><sub><italic>s</italic></sub> − <italic>WT</italic><sub><italic>s</italic></sub>.</p>
      <p>In <xref rid="pcbi.1007722.t003" ref-type="table">Table 3</xref> we used the CamSol dataset to compare the performance of SKADE with methods designed for the task of predicting the effect of mutations on the protein solubility. To do so we reproduced the benchmark performed in SODA [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>], where 4 existing predictors have been tested. SKADE correctly identifies 69% of the mutations increasing solubility and 100% of the mutations decreasing it, with an AUC of 82 and an AUPRC of 99%.</p>
      <table-wrap id="pcbi.1007722.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Table showing the comparison of the unsupervised predictions of SKADE on the CamSol dataset of mutations.</title>
          <p>Results have been preported form [<xref rid="pcbi.1007722.ref009" ref-type="bibr">9</xref>].</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007722.t003g" xlink:href="pcbi.1007722.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Methods</th>
                <th align="right" rowspan="1" colspan="1">Accuracy</th>
                <th align="right" rowspan="1" colspan="1">Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SODA</td>
                <td align="right" rowspan="1" colspan="1">100.0</td>
                <td align="right" rowspan="1" colspan="1">56/56</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CamSol</td>
                <td align="right" rowspan="1" colspan="1">96</td>
                <td align="right" rowspan="1" colspan="1">54/56</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SKADE</td>
                <td align="right" rowspan="1" colspan="1">71</td>
                <td align="right" rowspan="1" colspan="1">40/56</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SolPro</td>
                <td align="right" rowspan="1" colspan="1">71</td>
                <td align="right" rowspan="1" colspan="1">40/56</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PROSO II</td>
                <td align="right" rowspan="1" colspan="1">57</td>
                <td align="right" rowspan="1" colspan="1">32/56</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>An important consideration is that while methods such as SODA (see <xref rid="pcbi.1007722.t003" ref-type="table">Table 3</xref>) have been specifically designed and trained to discriminate mutations increasing or decreasing the solubility, SKADE faces this task in a completely unsupervised way, since it has been trained to predict the solubility of entire protein sequences.</p>
    </sec>
    <sec id="sec013">
      <title>In-silico mutational screening and analysis of the synergistic effects of mutations</title>
      <p>SKADE is a NN and thus it can be easily run in parallel on GPUs, computing predictions for hundreds or thousands of sequences per second. This can be used to compute in-silico mutational screening of proteins, as shown in <xref ref-type="fig" rid="pcbi.1007722.g003">Fig 3</xref> for UPF0235 protein MTH_637 (Uniprot ID: O26734), which is present in the test dataset [<xref rid="pcbi.1007722.ref022" ref-type="bibr">22</xref>]. The protein is annotated as soluble in the dataset, and SKADE predicts it correctly (score of 0.733). We implemented each possible mutation in O26734 and we computed the the change in solubility Δ<italic>S</italic> = <italic>MUT</italic><sub><italic>s</italic></sub> − <italic>WT</italic><sub><italic>s</italic></sub>, meaning that positive Δ<italic>S</italic> (shown in red) indicate that the mutation increases the solubility of the protein, while negative Δ<italic>S</italic> values (in blue) decrease it. <xref ref-type="fig" rid="pcbi.1007722.g003">Fig 3</xref> shows that, since the predicted solubility of O26734 is already very high, most of the mutations have the effect of decreasing the predicted solubility. In particular, there are few regions with very high effect, such as the residues from 1 to 25, from 49 to 51 and close to the C-terminal. Among the possible mutations, it appears that most of the mutations of a wildtype residue into a Met are predicted to heavily decrease the solubility. We listed the mutations with the larges Δ<italic>S</italic> in <xref ref-type="supplementary-material" rid="pcbi.1007722.s001">S1 Text</xref>.</p>
      <fig id="pcbi.1007722.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>In-silico mutational screening of UPF0235 protein MTH_637 (O26734), showing the effect on the solubility of the protein of every possible mutation.</title>
          <p>The change in solubility is computed as Δ<italic>S</italic> = <italic>MUT</italic><sub><italic>s</italic></sub> − <italic>WT</italic><sub><italic>s</italic></sub>, meaning that positive Δ<italic>S</italic> (shown in red) indicate that the mutation increases the solubility of the protein, while negative Δ<italic>S</italic> values (in blue) decrease it.</p>
        </caption>
        <graphic xlink:href="pcbi.1007722.g003"/>
      </fig>
      <p>An aspect that it is not usually considered when performing classical in-silico mutational screenings is the difference between the effects of two mutations <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub> when they are considered independently or in combination (i.e. both implemented at the same time), thus investigating the possible <italic>synergistic</italic> effects of mutations. This screening of pairs of mutations is usually not doable due to the extremely high number of possibilities that needs to be tested, but SKADE is fast enough to allow also the exhaustive analysis of the effects combinations of variants. As an example, we ran this experiment on the protein O26734, which is 103 residues long, and we tested the solubility changes Δ<italic>S</italic><sub><italic>i</italic>,<italic>j</italic></sub> due to all the possible pairs of variants <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub>, for a total of (103 × 20 × 102 × 20)/2 = 2101200 mutations. We then computed the change in solubility due to two independent mutations <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub> from <xref ref-type="fig" rid="pcbi.1007722.g003">Fig 3</xref> as Δ<italic>S</italic><sub><italic>single</italic></sub> = Δ<italic>S</italic><sub><italic>i</italic></sub> + Δ<italic>S</italic><sub><italic>j</italic></sub>, and the change in solubility obtained when both <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub> are implemented in the sequence Δ<italic>S</italic><sub><italic>pair</italic></sub> = Δ<italic>S</italic><sub><italic>i</italic>,<italic>j</italic></sub> = (<italic>MUT</italic><sub><italic>i</italic>,<italic>j</italic></sub>−<italic>WT</italic>). We then computed the synergistic versus individual effects as Δ<italic>E</italic> = Δ<italic>S</italic><sub><italic>single</italic></sub> − Δ<italic>S</italic><sub><italic>pair</italic></sub> for each pair of variants <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub>.</p>
      <p>In <xref ref-type="fig" rid="pcbi.1007722.g004">Fig 4</xref> we averaged the Δ<italic>E</italic> for each position of O26734, indicating on which pairs of sequence positions the synergistic effects have a stronger effect than two independent variants, averaged over all the possible mutations that could be implemented in those positions. <xref ref-type="fig" rid="pcbi.1007722.g004">Fig 4</xref> shows that SKADE’s model predicts that most of the positions in O26734 are more likely affected by synergistic effects of mutations in distant parts of the sequence, with respect to two single mutations acting independently. This might indicate that the most effective way to optimize proteins’ solubility could involve the study of the synergistic effects of mutations, instead of implementing variants whose effect on solubility has been assessed in isolation.</p>
      <fig id="pcbi.1007722.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Heatmap showing the average single versus synergistic effects Δ<italic>E</italic> = Δ<italic>S</italic><sub><italic>single</italic></sub> − Δ<italic>S</italic><sub><italic>pair</italic></sub> on each position of the O26734 protein.</title>
          <p>Negative (blue) values indicate that synergistic effects are stronger, while positive (red) values indicate that the effect of independent mutations is higher.</p>
        </caption>
        <graphic xlink:href="pcbi.1007722.g004"/>
      </fig>
      <p>In <xref ref-type="supplementary-material" rid="pcbi.1007722.s004">S2 Fig</xref> we show the mean predicted synergistic effects, averaged over the possible pairs of amino acids mutations. Residues such as A, N, P, W, Y and I are on average less prone to show synergistic effects, while C, D, Q, M and V are, on average, involved in stronger synergistic effects. Interestingly, among these residues, Cs appears to experience little influence from mutations of Qs, and Hs are generaly not influenced by mutations of Ps and Rs.</p>
      <p>In <xref ref-type="fig" rid="pcbi.1007722.g005">Fig 5</xref> we analysed the mean synergistic effects on the protein O26734 in function of the sequence separation |<italic>i</italic> − <italic>j</italic>| between pairs of mutated residues at positions <italic>i</italic>, <italic>j</italic>. We see that residues which are very close (1 ≤ |<italic>i</italic> − <italic>j</italic>| ≤ 10) or very distant (90 ≤ |<italic>i</italic> − <italic>j</italic>| ≤ 100) tend to experience the highest synergistic effects (blue lines). In order to find an explanation to this behavior, we compared the magnitude of the synergistic effects with the distribution of the actual 3D distances between residues extracted from the 1JRM pdb structure. As shown in <xref ref-type="fig" rid="pcbi.1007722.g005">Fig 5</xref>, we noticed that a certain correlation exists between the magnitude of the synergistic effects and the mean contact distance between residues (red lines). The Pearson correlation between the mean predicted synergy and mean Angstrom distance between the residues’ C-<italic>β</italic> atoms is <italic>r</italic> = 0.29 (p-value = 0.003) and the Spearman’s correlation is <italic>r</italic> = 0.36 (p-value = 0.0002). This shows that the attention-based architecture on which SKADE is built is indeed able to catch a glimpse of more complex structural aspects of proteins, such as the distribution of contacts. <xref ref-type="supplementary-material" rid="pcbi.1007722.s010">S8 Fig</xref> shows a scatter plot version of the same data.</p>
      <fig id="pcbi.1007722.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007722.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Plot showing the correlation between the average spatial distance between residues at a certain sequence separation |<italic>i</italic> − <italic>j</italic>| (red) with the magnitude of the synergistic effects between tandem mutations at the same positions <italic>i</italic>, <italic>j</italic> (blue).</title>
          <p>Solid colors indicate the mean, while light colors indicate the median values.</p>
        </caption>
        <graphic xlink:href="pcbi.1007722.g005"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Discussion</title>
    <p>In this study we propose a novel Neural Network (NN) architecture for the prediction of the solubility of protein sequences, and we exploit its attention-based interpretability to investigate the molecular forces driving protein solubility. This model, called SKADE, is based on a neural attention mechanism inspired from machine translation tasks and takes as input only the target protein sequence. SKADE’s performance positively compares with state of the art solubility predictors, and the neural attention architecture offers some opportunities for the interpretation of the predictions, in a first step towards <italic>opening</italic> the Machine Learning (ML) <italic>black-box</italic>.</p>
    <p>In this study, we indeed analyzed the attention profiles learned by the model during training to investigate whether they showed a significant correlation with biophysical properties of proteins that may relate to the solubility of the chain. Interestingly, we did not find any correlation with trivial biophysical characteristics of amino acids, such as described in biophysical propensity scales, but we showed that the <italic>solubility profiles</italic> extracted from the model can be used as an unsupervised predictor for aggregation-prone regions in proteins. This suggests that the attention-like mechanism in SKADE is indeed learning non-trivial biophysical emergent characteristics of the protein sequences and that uses them as building blocks to compute the final solubility prediction.</p>
    <p>From the analysis of the attention profiles it also appears that the portions of the protein that carry the strongest signal when it comes to predict the protein solubility are the ones closer to the N- and C-termini, more specifically the first and last 20% of residues of the sequences.</p>
    <p>Protein solubiliity predictors are generally used to determine which minimal set of mutations could increase the overall solubility of the protein, thus facilitating its expression and production. In our analysis we also show that, although SKADE has not been trained for the task, the model can distinguish between mutations that increase or decrease the protein solubility, and that our model can thus be used to perform in-silico mutational screening with the goal of optimizing the solubility of proteins by selecting an optimal set of mutations.</p>
    <p>When solubility predictors are used to screen mutations to increase protein solubility, only <italic>single</italic> mutations are usually analysed, because the number of possible pairs (or triplets, quadruplets) of mutations grows exponentially. One of the advantages of SKADE is that its NN implementation can be heavily parallelized on GPU, and thus an unprecedented amount of predictions can be computed in very short time. SKADE can thus compute the in-silico mutational screening of pairs or triplets of mutations in minutes, thus including the possible synergistic effects of multiple mutations in this analysis. To show an example of this, we predicted all the possible pairs of mutations on the fairly short protein O26734, and we compared the solubility changes due to couples of independent mutations with respect to pairs of <italic>tandem</italic> mutations. From this analysis it appears that many regions of O26734 are predicted to be affected by synergistic interactions between mutations, and we thus hypothesize that modelling the synergistic effects of mutations may provide an optimal way towards the optimization of proteins with respect to specific biophysical desiderata.</p>
    <p>Finally, while analysing the distribution of the magnitude of the synergistic effects with respect to the sequence separation, we noticed that the synergies predicted by SKADE from the O26734 protein sequence have a significant correlation with the average contact distance between residues, extracted from the corresponding PDB sequence. SKADE is thus able to catch a glimpse of a complex emergent aspect of protein sequences, such as their contact density, from the sequence alone.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec015">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s001">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary information.</title>
        <p>PDF file containing additional analyses.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s002">
      <label>S2 Text</label>
      <caption>
        <title>Supplementary information.</title>
        <p>CSV file containing the aminoacid embedding values.</p>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s002.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s003">
      <label>S1 Fig</label>
      <caption>
        <title>Plot showing the distributions of the a i × p i values over the protein sequence.</title>
        <p>We grouped these values by using their relative position in their respective sequence. Although the distributions are quite similar, the variance is generally higher at the be- ginning and at the end of the sequences, indicating that the NN might find stronger signal in these regions.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s004">
      <label>S2 Fig</label>
      <caption>
        <title>Plot showing the average synergistic effect of pairs of mutations averaged over the type of mutated aminoacid.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s004.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s005">
      <label>S3 Fig</label>
      <caption>
        <title>Plot showing the attention and prediction profiles of protein Q8TC59.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s005.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s006">
      <label>S4 Fig</label>
      <caption>
        <title>Plot showing the attention and prediction profiles of protein Q9HBE1.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s006.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s007">
      <label>S5 Fig</label>
      <caption>
        <title>Plot showing the attention and prediction profiles of protein P25984.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s007.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s008">
      <label>S6 Fig</label>
      <caption>
        <title>Plot showing the 2 principal components of a PCA computed over the 20 dimensional embeddings learned by SKADE.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s008.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s009">
      <label>S7 Fig</label>
      <caption>
        <title>Plot distributions of the mutations on the sequences in the CAMSOL dataset.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s009.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s010">
      <label>S8 Fig</label>
      <caption>
        <title>Plot showing the correlation between the mean spatial distance (in Angstroms) and the average synergistic effects of pairs of residues at the same sequence separation in the O26734 protein.</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1007722.s010.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>DR is grateful to A. L. Mascagni for the constructive discussion and to A. Reynolds for the inspiration.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007722.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ciryam</surname><given-names>P</given-names></name>, <name><surname>Tartaglia</surname><given-names>GG</given-names></name>, <name><surname>Morimoto</surname><given-names>RI</given-names></name>, <name><surname>Dobson</surname><given-names>CM</given-names></name>, <name><surname>Vendruscolo</surname><given-names>M</given-names></name>. <article-title>Widespread aggregation and neurodegenerative diseases are associated with supersaturated proteins</article-title>. <source>Cell reports</source>. <year>2013</year>;<volume>5</volume>(<issue>3</issue>):<fpage>781</fpage>–<lpage>790</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2013.09.043</pub-id><?supplied-pmid 24183671?><pub-id pub-id-type="pmid">24183671</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>CC</given-names></name>, <name><surname>Perchiacca</surname><given-names>JM</given-names></name>, <name><surname>Tessier</surname><given-names>PM</given-names></name>. <article-title>Toward aggregation-resistant antibodies by design</article-title>. <source>Trends in biotechnology</source>. <year>2013</year>;<volume>31</volume>(<issue>11</issue>):<fpage>612</fpage>–<lpage>620</lpage>. <pub-id pub-id-type="doi">10.1016/j.tibtech.2013.07.002</pub-id><?supplied-pmid 23932102?><pub-id pub-id-type="pmid">23932102</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Perchiacca</surname><given-names>JM</given-names></name>, <name><surname>Tessier</surname><given-names>PM</given-names></name>. <article-title>Engineering aggregation-resistant antibodies</article-title>. <source>Annual review of chemical and biomolecular engineering</source>. <year>2012</year>;<volume>3</volume>:<fpage>263</fpage>–<lpage>286</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-chembioeng-062011-081052</pub-id><?supplied-pmid 22468604?><pub-id pub-id-type="pmid">22468604</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Balch</surname><given-names>WE</given-names></name>, <name><surname>Morimoto</surname><given-names>RI</given-names></name>, <name><surname>Dillin</surname><given-names>A</given-names></name>, <name><surname>Kelly</surname><given-names>JW</given-names></name>. <article-title>Adapting proteostasis for disease intervention</article-title>. <source>science</source>. <year>2008</year>;<volume>319</volume>(<issue>5865</issue>):<fpage>916</fpage>–<lpage>919</lpage>. <pub-id pub-id-type="doi">10.1126/science.1141448</pub-id><?supplied-pmid 18276881?><pub-id pub-id-type="pmid">18276881</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kundra</surname><given-names>R</given-names></name>, <name><surname>Ciryam</surname><given-names>P</given-names></name>, <name><surname>Morimoto</surname><given-names>RI</given-names></name>, <name><surname>Dobson</surname><given-names>CM</given-names></name>, <name><surname>Vendruscolo</surname><given-names>M</given-names></name>. <article-title>Protein homeostasis of a metastable subproteome associated with Alzheimer’s disease</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2017</year>;<volume>114</volume>(<issue>28</issue>):<fpage>E5703</fpage>–<lpage>E5711</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1618417114</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Manning</surname><given-names>MC</given-names></name>, <name><surname>Chou</surname><given-names>DK</given-names></name>, <name><surname>Murphy</surname><given-names>BM</given-names></name>, <name><surname>Payne</surname><given-names>RW</given-names></name>, <name><surname>Katayama</surname><given-names>DS</given-names></name>. <article-title>Stability of protein pharmaceuticals: an update</article-title>. <source>Pharmaceutical research</source>. <year>2010</year>;<volume>27</volume>(<issue>4</issue>):<fpage>544</fpage>–<lpage>575</lpage>. <pub-id pub-id-type="doi">10.1007/s11095-009-0045-6</pub-id><?supplied-pmid 20143256?><pub-id pub-id-type="pmid">20143256</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Bye</surname><given-names>JW</given-names></name>, <name><surname>Platts</surname><given-names>L</given-names></name>, <name><surname>Falconer</surname><given-names>RJ</given-names></name>. <article-title>Biopharmaceutical liquid formulation: a review of the science of protein stability and solubility in aqueous environments</article-title>. <source>Biotechnology letters</source>. <year>2014</year>;<volume>36</volume>(<issue>5</issue>):<fpage>869</fpage>–<lpage>875</lpage>. <pub-id pub-id-type="doi">10.1007/s10529-013-1445-6</pub-id><?supplied-pmid 24557073?><pub-id pub-id-type="pmid">24557073</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Chiti</surname><given-names>F</given-names></name>, <name><surname>Dobson</surname><given-names>CM</given-names></name>. <article-title>Protein misfolding, amyloid formation, and human disease: a summary of progress over the last decade</article-title>. <source>Annual review of biochemistry</source>. <year>2017</year>;<volume>86</volume>:<fpage>27</fpage>–<lpage>68</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-biochem-061516-045115</pub-id><?supplied-pmid 28498720?><pub-id pub-id-type="pmid">28498720</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Paladin</surname><given-names>L</given-names></name>, <name><surname>Piovesan</surname><given-names>D</given-names></name>, <name><surname>Tosatto</surname><given-names>SC</given-names></name>. <article-title>SODA: prediction of protein solubility from disorder and aggregation propensity</article-title>. <source>Nucleic acids research</source>. <year>2017</year>;<volume>45</volume>(<issue>W1</issue>):<fpage>W236</fpage>–<lpage>W240</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx412</pub-id><?supplied-pmid 28505312?><pub-id pub-id-type="pmid">28505312</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Khurana</surname><given-names>S</given-names></name>, <name><surname>Rawi</surname><given-names>R</given-names></name>, <name><surname>Kunji</surname><given-names>K</given-names></name>, <name><surname>Chuang</surname><given-names>GY</given-names></name>, <name><surname>Bensmail</surname><given-names>H</given-names></name>, <name><surname>Mall</surname><given-names>R</given-names></name>. <article-title>DeepSol: a deep learning framework for sequence-based protein solubility prediction</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>15</issue>):<fpage>2605</fpage>–<lpage>2613</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty166</pub-id><?supplied-pmid 29554211?><pub-id pub-id-type="pmid">29554211</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Rawi</surname><given-names>R</given-names></name>, <name><surname>Mall</surname><given-names>R</given-names></name>, <name><surname>Kunji</surname><given-names>K</given-names></name>, <name><surname>Shen</surname><given-names>CH</given-names></name>, <name><surname>Kwong</surname><given-names>PD</given-names></name>, <name><surname>Chuang</surname><given-names>GY</given-names></name>. <article-title>PaRSnIP: sequence-based protein solubility prediction using gradient boosting machine</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>34</volume>(<issue>7</issue>):<fpage>1092</fpage>–<lpage>1098</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Smialowski</surname><given-names>P</given-names></name>, <name><surname>Doose</surname><given-names>G</given-names></name>, <name><surname>Torkler</surname><given-names>P</given-names></name>, <name><surname>Kaufmann</surname><given-names>S</given-names></name>, <name><surname>Frishman</surname><given-names>D</given-names></name>. <article-title>PROSO II–a new method for protein solubility prediction</article-title>. <source>The FEBS journal</source>. <year>2012</year>;<volume>279</volume>(<issue>12</issue>):<fpage>2192</fpage>–<lpage>2200</lpage>. <pub-id pub-id-type="doi">10.1111/j.1742-4658.2012.08603.x</pub-id><?supplied-pmid 22536855?><pub-id pub-id-type="pmid">22536855</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Agostini</surname><given-names>F</given-names></name>, <name><surname>Cirillo</surname><given-names>D</given-names></name>, <name><surname>Livi</surname><given-names>CM</given-names></name>, <name><surname>Delli Ponti</surname><given-names>R</given-names></name>, <name><surname>Tartaglia</surname><given-names>GG</given-names></name>. <article-title>cc SOL omics: A webserver for solubility prediction of endogenous and heterologous expression in Escherichia coli</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>20</issue>):<fpage>2975</fpage>–<lpage>2977</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu420</pub-id><?supplied-pmid 24990610?><pub-id pub-id-type="pmid">24990610</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sormanni</surname><given-names>P</given-names></name>, <name><surname>Aprile</surname><given-names>FA</given-names></name>, <name><surname>Vendruscolo</surname><given-names>M</given-names></name>. <article-title>The CamSol method of rational design of protein mutants with enhanced solubility</article-title>. <source>Journal of molecular biology</source>. <year>2015</year>;<volume>427</volume>(<issue>2</issue>):<fpage>478</fpage>–<lpage>490</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2014.09.026</pub-id><?supplied-pmid 25451785?><pub-id pub-id-type="pmid">25451785</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Magnan</surname><given-names>CN</given-names></name>, <name><surname>Randall</surname><given-names>A</given-names></name>, <name><surname>Baldi</surname><given-names>P</given-names></name>. <article-title>SOLpro: accurate sequence-based prediction of protein solubility</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>17</issue>):<fpage>2200</fpage>–<lpage>2207</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp386</pub-id><?supplied-pmid 19549632?><pub-id pub-id-type="pmid">19549632</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Buchan</surname><given-names>DW</given-names></name>, <name><surname>Minneci</surname><given-names>F</given-names></name>, <name><surname>Nugent</surname><given-names>TC</given-names></name>, <name><surname>Bryson</surname><given-names>K</given-names></name>, <name><surname>Jones</surname><given-names>DT</given-names></name>. <article-title>Scalable web services for the PSIPRED Protein Analysis Workbench</article-title>. <source>Nucleic acids research</source>. <year>2013</year>;<volume>41</volume>(<issue>W1</issue>):<fpage>W349</fpage>–<lpage>W357</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt381</pub-id><?supplied-pmid 23748958?><pub-id pub-id-type="pmid">23748958</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Raimondi</surname><given-names>D</given-names></name>, <name><surname>Orlando</surname><given-names>G</given-names></name>, <name><surname>Pancsa</surname><given-names>R</given-names></name>, <name><surname>Khan</surname><given-names>T</given-names></name>, <name><surname>Vranken</surname><given-names>WF</given-names></name>. <article-title>Exploring the sequence-based prediction of folding initiation sites in proteins</article-title>. <source>Scientific reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>8826</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-08366-3</pub-id><?supplied-pmid 28821744?><pub-id pub-id-type="pmid">28821744</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Raimondi</surname><given-names>D</given-names></name>, <name><surname>Orlando</surname><given-names>G</given-names></name>, <name><surname>Moreau</surname><given-names>Y</given-names></name>, <name><surname>Vranken</surname><given-names>WF</given-names></name>. <article-title>Ultra-fast global homology detection with Discrete Cosine Transform and Dynamic Time Warping</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>1</volume>:<fpage>8</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Rush AM, Chopra S, Weston J. A neural attention model for abstractive sentence summarization. arXiv preprint arXiv:150900685. 2015;.</mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Vaswani</surname><given-names>A</given-names></name>, <name><surname>Shazeer</surname><given-names>N</given-names></name>, <name><surname>Parmar</surname><given-names>N</given-names></name>, <name><surname>Uszkoreit</surname><given-names>J</given-names></name>, <name><surname>Jones</surname><given-names>L</given-names></name>, <name><surname>Gomez</surname><given-names>AN</given-names></name>, <etal>et al</etal><article-title>Attention is all you need</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2017</year> p. <fpage>5998</fpage>–<lpage>6008</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Berman</surname><given-names>HM</given-names></name>, <name><surname>Westbrook</surname><given-names>JD</given-names></name>, <name><surname>Gabanyi</surname><given-names>MJ</given-names></name>, <name><surname>Tao</surname><given-names>W</given-names></name>, <name><surname>Shah</surname><given-names>R</given-names></name>, <name><surname>Kouranov</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>The protein structure initiative structural genomics knowledgebase</article-title>. <source>Nucleic acids research</source>. <year>2008</year>;<volume>37</volume>(<issue>suppl_1</issue>):<fpage>D365</fpage>–<lpage>D368</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkn790</pub-id><?supplied-pmid 19010965?><pub-id pub-id-type="pmid">19010965</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Chang</surname><given-names>CCH</given-names></name>, <name><surname>Song</surname><given-names>J</given-names></name>, <name><surname>Tey</surname><given-names>BT</given-names></name>, <name><surname>Ramanan</surname><given-names>RN</given-names></name>. <article-title>Bioinformatics approaches for improved recombinant protein production in Escherichia coli: protein solubility prediction</article-title>. <source>Briefings in bioinformatics</source>. <year>2013</year>;<volume>15</volume>(<issue>6</issue>):<fpage>953</fpage>–<lpage>962</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbt057</pub-id><?supplied-pmid 23926206?><pub-id pub-id-type="pmid">23926206</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Cho K, Van Merriënboer B, Gulcehre C, Bahdanau D, Bougares F, Schwenk H, et al. Learning phrase representations using RNN encoder-decoder for statistical machine translation. arXiv preprint arXiv:14061078. 2014;.</mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Paszke</surname><given-names>A</given-names></name>, <name><surname>Gross</surname><given-names>S</given-names></name>, <name><surname>Chintala</surname><given-names>S</given-names></name>, <name><surname>Chanan</surname><given-names>G</given-names></name>, <name><surname>Yang</surname><given-names>E</given-names></name>, <name><surname>DeVito</surname><given-names>Z</given-names></name>, <etal>et al</etal><source>Automatic differentiation in PyTorch</source>. <year>2017</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Orlando</surname><given-names>G</given-names></name>, <name><surname>Raimondi</surname><given-names>D</given-names></name>, <name><surname>Vranken</surname><given-names>W</given-names></name>. <article-title>Observation selection bias in contact prediction and its implications for structural bioinformatics</article-title>. <source>Scientific Reports</source>. <year>2016</year>;<volume>6</volume><pub-id pub-id-type="doi">10.1038/srep36679</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Raimondi</surname><given-names>D</given-names></name>, <name><surname>Orlando</surname><given-names>G</given-names></name>, <name><surname>Vranken</surname><given-names>WF</given-names></name>, <name><surname>Moreau</surname><given-names>Y</given-names></name>. <article-title>Exploring the limitations of biophysical propensity scales coupled with machine learning for protein sequence analysis</article-title>. <source>Scientific Reports</source>. <year>2019</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <pub-id pub-id-type="doi">10.1038/s41598-019-53324-w</pub-id><pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Tsolis</surname><given-names>AC</given-names></name>, <name><surname>Papandreou</surname><given-names>NC</given-names></name>, <name><surname>Iconomidou</surname><given-names>VA</given-names></name>, <name><surname>Hamodrakas</surname><given-names>SJ</given-names></name>. <article-title>A consensus method for the prediction of ‘aggregation-prone’peptides in globular proteins</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>1</issue>):<fpage>e54175</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0054175</pub-id><?supplied-pmid 23326595?><pub-id pub-id-type="pmid">23326595</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Walsh</surname><given-names>I</given-names></name>, <name><surname>Seno</surname><given-names>F</given-names></name>, <name><surname>Tosatto</surname><given-names>SC</given-names></name>, <name><surname>Trovato</surname><given-names>A</given-names></name>. <article-title>PASTA 2.0: an improved server for protein aggregation prediction</article-title>. <source>Nucleic acids research</source>. <year>2014</year>;<volume>42</volume>(<issue>W1</issue>):<fpage>W301</fpage>–<lpage>W307</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku399</pub-id><?supplied-pmid 24848016?><pub-id pub-id-type="pmid">24848016</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gaudry</surname><given-names>A</given-names></name>, <name><surname>Lorber</surname><given-names>B</given-names></name>, <name><surname>Neuenfeldt</surname><given-names>A</given-names></name>, <name><surname>Sauter</surname><given-names>C</given-names></name>, <name><surname>Florentz</surname><given-names>C</given-names></name>, <name><surname>Sissler</surname><given-names>M</given-names></name>. <article-title>Re-designed N-terminus enhances expression, solubility and crystallizability of mitochondrial protein</article-title>. <source>Protein Engineering, Design &amp; Selection</source>. <year>2012</year>;<volume>25</volume>(<issue>9</issue>):<fpage>473</fpage>–<lpage>481</lpage>. <pub-id pub-id-type="doi">10.1093/protein/gzs046</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Ribeiro</surname><given-names>EA</given-names></name>, <name><surname>Ramos</surname><given-names>CH</given-names></name>. <article-title>Circular permutation and deletion studies of myoglobin indicate that the correct position of its N-terminus is required for native stability and solubility but not for native-like heme binding and folding</article-title>. <source>Biochemistry</source>. <year>2005</year>;<volume>44</volume>(<issue>12</issue>):<fpage>4699</fpage>–<lpage>4709</lpage>. <pub-id pub-id-type="doi">10.1021/bi047908c</pub-id><?supplied-pmid 15779896?><pub-id pub-id-type="pmid">15779896</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007722.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mine</surname><given-names>S</given-names></name>, <name><surname>Ueda</surname><given-names>T</given-names></name>, <name><surname>Hashimoto</surname><given-names>Y</given-names></name>, <name><surname>Imoto</surname><given-names>T</given-names></name>. <article-title>Improvement of the refolding yield and solubility of hen egg-white lysozyme by altering the Met residue attached to its N-terminus to Ser</article-title>. <source>Protein engineering</source>. <year>1997</year>;<volume>10</volume>(<issue>11</issue>):<fpage>1333</fpage>–<lpage>1338</lpage>. <pub-id pub-id-type="doi">10.1093/protein/10.11.1333</pub-id><?supplied-pmid 9514123?><pub-id pub-id-type="pmid">9514123</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007722.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007722.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nussinov</surname>
          <given-names>Ruth</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alexov</surname>
          <given-names>Emil</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Nussinov, Alexov</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Nussinov, Alexov</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007722" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">7 Jan 2020</named-content>
    </p>
    <p>Dear Dr Raimondi,</p>
    <p>Thank you very much for submitting your manuscript 'Insight into the protein solubility driving forces with neural attention' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Emil Alexov</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Ruth Nussinov</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This is an interesting manuscript in the burgeoning field of protein solubility prediction. It is based on machine learning models, and produces results in line with other available methods. The authors describe their use of ML methods as novel in the field and this may be the case, I am afraid that I am not expert in ML methods. What I regard as novel are a couple of observations made in the manuscript, and that is where I would like to see more work carried out to clarify the results.</p>
    <p>First, a statement is made to the effect that the predictions / model are not based on the commonly used biophysical properties (of amino acids). But, I do not see how this can be asserted if amino acids themselves are central to the prediction scheme - as I see it, sequence is the input to the training algorithm.</p>
    <p>Second, and of the most interest to me, is the observation that N-t and C-t seem to possess (Fig. 2) more or less all the predictive power. I would not be surprised to find a tendency towards greater predictive power, but a flat line (Fig. 2) over the central 70% of the sequence I find amazing. Is it possible that the method is learning sequences (i.e. homology) and that this is best expressed at NT and CT when sequences of variable lengths are mapped to percentiles?</p>
    <p>My own speculation is probably wrong, but I feel that the authors need more work here. e.g. What happens if the standard bioinformatics methods for reducing to non-redundant training set is used?</p>
    <p>In the data reported for SKADE analysis of the CAMSOL mutation set, are all the mutations that affect solubility in the NT and CT regions - as might be expected given the results of Fig. 2?</p>
    <p>Similarly, the synergistic mutations in later figures, are they also in NT and CT regions?</p>
    <p>Reviewer #2: The paper presents a novel computational approach to predicting protein and peptide solubility from amino acid sequence alone SKADE. The model behind the method is a Recurrent Neural Network with soft self-attention and dot-product score function, built using Gated Recurrent Units. It is implemented in Python using Pytorch framework and supplies a pre-trained network for immediate applications.</p>
    <p>SKADE is a great example of a neural network design without explicit feature engineering. The resulting model is comparable in performance or outperforming (depending on metrics) state of the art methods such as PaRSnIP and DeepSol that rely on knowledge-based and engineered features. The distributions of weights and scores along protein sequences suggest that N- and C-termini are most important determinants of protein and peptide solubility.</p>
    <p>In addition, SKADE is able to identify mutations that increase or decrease the overall solubility of the protein, making it a useful and fast method for scanning mutagenesis, not limited to single mutations. Testing the effects of protein truncation on solubility is also possible with SKADE.</p>
    <p>Major:</p>
    <p>1. Although the model provides per-residue attention values and scores, interpretability of the methods remains limited. The only conclusion is that N- and C- termini are more important, but that is about it. Besides, these are the output layers of the network, what is inside is still a “black box” in terms of interpretability, I suggest deemphasizing this point in abstract and conclusions. The lack of correlations with biophysical properties contradicts this conclusion.</p>
    <p>2. It is quite surprising to see that there is no correlation of attention and solubility profiles to any physico-chemical and/or structural properties of amino acids. Particularly, because these features work quite well in other solubility prediction methods. I think Table 1 in supporting information files does not comprehensively cover the biophysical features, for instance aggregation propensity, SASA. Besides, it is not clear how the correlations were calculated. Could the lack of correlation be related to scalability of attention/profile with sequence length? I.e. values of a short protein could be incomparable to values of a large protein.</p>
    <p>3. According to neural network architecture it seems that the Embedding for converting 20 amino acid categories into a 20-dimensional tensor acts simply as a One Hot encoder. If there is any actual embedding that is learnt during training could you visualize the resulting amino acid similarities? Otherwise I suggest renaming embedding to encoding.</p>
    <p>4. Python 2.7 is not acceptable by any means. This Python branch reached end of life on January 1 2020, is no longer supported. Moreover, is currently being removed from many computer systems for security concerns because it is unsupported. See <ext-link ext-link-type="uri" xlink:href="https://devguide.python.org/#status-of-python-branches">https://devguide.python.org/#status-of-python-branches</ext-link> . It looks like there should not be any reasons not to update the code to Python 3.</p>
    <p>5. Please format code according to PEP8 <ext-link ext-link-type="uri" xlink:href="https://www.python.org/dev/peps/pep-0008/">https://www.python.org/dev/peps/pep-0008/</ext-link> Automatic conversion with autopep8 --aggressive could be used, for instance. Note that there is a lot of imported but unused modules, variables, and other issues that a lint program could fix, please also run pylint to get rid of the software issues.</p>
    <p>Minor:</p>
    <p>1. There is an imbalance between soluble and insoluble classes, since you have not used weighted sampling. To what extent do you think this imbalance affected the results? I suspect this could be the reason behind performance gap with respect to positive/negative class prediction separating SKADE and PaRSnIP.</p>
    <p>2. The details of model convergence should be provided in supporting information. I could see that tensorboard was used in the program, so it should be possible to include those plots.</p>
    <p>3. Line 98, why i&lt;0 ?</p>
    <p>4. Line 298: According to uniprot the protein should be 104, not 103 residues long <ext-link ext-link-type="uri" xlink:href="https://www.uniprot.org/uniprot/O26734">https://www.uniprot.org/uniprot/O26734</ext-link></p>
    <p>5. The equation in line 300 is not clear, were the pairs of mutations generated including two mutations on the same position? Shouldn’t it be something like 104x19x19x103/2?</p>
    <p>6. Current Pytorch v 1.3.1, version was 1.0.1 used in the paper. Model needs to be recalculated</p>
    <p>7. Please submit the model to <ext-link ext-link-type="uri" xlink:href="http://kipoi.org">kipoi.org</ext-link> repository, that would make it much easier to run it</p>
    <p>8. Peptide N- and C-termini are effectively charged residues in terms of their physico-chemical characteristics affecting solubility, i.e. Ala is hydrophobic, but will have a charge on the N-termini. However, it is not treated/encoded in any way different than any other amino acid. Was the reasoning behind it to an unbiased representation in the model or something else?</p>
    <p>9. What is BAC in table 2?</p>
    <p>10. Line 65, correlation is reported as AUC, which is not convenient</p>
    <p>11. Line 319: “my” &gt; “by”</p>
    <p>12. In my opinion it is better to show dependence of synergetic effect on spatial distance directly as a scatter plot to emphasize on the correlation, particularly in proximity</p>
    <p>13. In Figure 3 according to heatmap the first WT residue in O26734 should be V (the only white shaded residue), however this is not the case. What gives?</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Yes: Alexander Goncearenco</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007722.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007722.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007722" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">27 Jan 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007722.s011">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">answersReviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007722.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007722.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007722.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nussinov</surname>
          <given-names>Ruth</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alexov</surname>
          <given-names>Emil</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Nussinov, Alexov</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Nussinov, Alexov</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007722" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Feb 2020</named-content>
    </p>
    <p>Dear Dr. Raimondi,</p>
    <p>We are pleased to inform you that your manuscript 'Insight into the protein solubility driving forces with neural attention' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch within two working days with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Emil Alexov</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Ruth Nussinov</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: The authors responded to all my questions.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: Yes: Alexander Goncearenco</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007722.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007722.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nussinov</surname>
          <given-names>Ruth</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alexov</surname>
          <given-names>Emil</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Nussinov, Alexov</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Nussinov, Alexov</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007722" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Apr 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-02103R1 </p>
    <p>Insight into the protein solubility driving forces with neural attention</p>
    <p>Dear Dr Raimondi,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
