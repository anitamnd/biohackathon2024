<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825747</article-id>
    <article-id pub-id-type="pmid">36515467</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac805</article-id>
    <article-id pub-id-type="publisher-id">btac805</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Benchmarking and integration of methods for deconvoluting spatial transcriptomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Lulu</given-names>
        </name>
        <aff><institution>School of Mathematics, Sun Yat-sen University</institution>, Guangzhou 510275, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3399-7260</contrib-id>
        <name>
          <surname>Sun</surname>
          <given-names>Xiaoqiang</given-names>
        </name>
        <xref rid="btac805-cor1" ref-type="corresp"/>
        <aff><institution>School of Mathematics, Sun Yat-sen University</institution>, Guangzhou 510275, <country country="CN">China</country></aff>
        <!--sunxq6@mail.sysu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac805-cor1">To whom correspondence should be addressed. <email>sunxq6@mail.sysu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-14">
      <day>14</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac805</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>12</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac805.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The rapid development of spatial transcriptomics (ST) approaches has provided new insights into understanding tissue architecture and function. However, the gene expressions measured at a spot may contain contributions from multiple cells due to the low-resolution of current ST technologies. Although many computational methods have been developed to disentangle discrete cell types from spatial mixtures, the community lacks a thorough evaluation of the performance of those deconvolution methods.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present a comprehensive benchmarking of 14 deconvolution methods on four datasets. Furthermore, we investigate the robustness of different methods to sequencing depth, spot size and the choice of normalization. Moreover, we propose a new ensemble learning-based deconvolution method (EnDecon) by integrating multiple individual methods for more accurate deconvolution. The major new findings include: (i) cell2loction, RCTD and spatialDWLS are more accurate than other ST deconvolution methods, based on the evaluation of three metrics: RMSE, PCC and JSD; (ii) cell2location and spatialDWLS are more robust to the variation of sequencing depth than RCTD; (iii) the accuracy of the existing methods tends to decrease as the spot size becomes smaller; (iv) most deconvolution methods perform best when they normalize ST data using the method described in their original papers; and (v) the integrative method, EnDecon, could achieve more accurate ST deconvolution. Our study provides valuable information and guideline for practically applying ST deconvolution tools and developing new and more effective methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The benchmarking pipeline is available at <ext-link xlink:href="https://github.com/SunXQlab/ST-deconvoulution" ext-link-type="uri">https://github.com/SunXQlab/ST-deconvoulution</ext-link>. An R package for EnDecon is available at <ext-link xlink:href="https://github.com/SunXQlab/EnDecon" ext-link-type="uri">https://github.com/SunXQlab/EnDecon</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>62273364</award-id>
        <award-id>11931019</award-id>
        <award-id>11871070</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The emergence of spatial transcriptomics (ST) has brought new opportunities for studying spatial heterogeneity of tissue architecture (<xref rid="btac805-B24" ref-type="bibr">Rao <italic toggle="yes">et al.</italic>, 2021</xref>) and cellular interaction (<xref rid="btac805-B14" ref-type="bibr">Larsson <italic toggle="yes">et al.</italic>, 2021</xref>). However, a major limitation of current ST technologies [e.g. Spatial Transcriptomics (<xref rid="btac805-B22" ref-type="bibr">Patrik <italic toggle="yes">et al.</italic>, 2016</xref>), 10× Visium (<xref rid="btac805-B11" ref-type="bibr">Genomics, 2019</xref>) and Slide-seq (<xref rid="btac805-B27" ref-type="bibr">Stickels <italic toggle="yes">et al.</italic>, 2021</xref>)] is that the measured gene expressions at one capture location (i.e. spot or grid) are from a mixture of multiple cells. This disadvantage hinders accurate quantification of spatial cellular distribution and downstream analysis.</p>
    <p>To address the above issues of ST data, various computational methods have been developed to decompose spatial mixtures of each ST spot into individual cell types with the aid of single-cell RNA-seq (scRNA-seq) data (<xref rid="btac805-B16" ref-type="bibr">Longo <italic toggle="yes">et al.</italic>, 2021</xref>). For example, enrichment-based methods [e.g. Seurat (<xref rid="btac805-B28" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) and MIA (<xref rid="btac805-B20" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>)] calculate the importance score or probability of the presence of different cell types in each spot. While other deconvolution methods aim to infer the proportion of cell types at each spatial location by employing linear regression models [e.g. SPOTlight (<xref rid="btac805-B10" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic>, 2021</xref>), spatialDWLS (<xref rid="btac805-B8" ref-type="bibr">Dong and Yuan, 2021</xref>)], probabilistic models [e.g. RCTD (<xref rid="btac805-B5" ref-type="bibr">Cable <italic toggle="yes">et al.</italic>, 2022</xref>), cell2location (<xref rid="btac805-B13" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic>, 2020</xref>)] or deep learning methods [e.g. DSTG (<xref rid="btac805-B26" ref-type="bibr">Song and Su, 2021</xref>)]. Additionally, a few reference-free methods [e.g. STdeconvolve (<xref rid="btac805-B18" ref-type="bibr">Miller <italic toggle="yes">et al.</italic>, 2022</xref>)] that deconvolve ST data without the aid of scRNA-seq data, have also been proposed.</p>
    <p>Given the rapid development of these computational methods for ST deconvolution, it is important to quantitatively assess their performance and robustness for better applications. Recently, <xref rid="btac805-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2022)</xref> evaluated the performance of several integration methods for predicting the spatial distribution of undetected transcripts and deconvoluting cell types. However, they only evaluated the impact of expression sparsity and normalization on the methods for predicting transcript distribution, but did not assess the impact of these factors on cell type deconvolution methods. Moreover, their study did not include all available state-of-the-art deconvolution methods for benchmarking. Therefore, a thorough evaluation of those deconvolution methods is still lacking.</p>
    <p>Here, we present a comprehensive evaluation of the performance of 14 deconvolution methods on four datasets, including three synthetic ST datasets with known single-cell compositions and a human heart ST dataset. We quantitatively evaluate the accuracy of these methods by calculating the root-mean-square error (RMSE), Pearson correlation coefficient (PCC) and Jensen-Shannon divergence (JSD) between the predicted cell type compositions and the known compositions. Furthermore, we assess the stability of these deconvolution methods to the variation in sequencing depth, spot size and normalization choice. We also compare the computational resources consumed by different deconvolution methods. Moreover, we propose an ensemble learning-based deconvolution method, EnDecon, by aggregating different methods for more accurate deconvolution of ST data.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of ST deconvolution methods</title>
      <p>The existing ST deconvolution methods are (in alphabetical order) cell2location, DestVI, DSTG, Giotto/Hypergeometric, Giotto/PAGE, Giotto/rank, MIA, RCTD, Seurat, spatialDecon, spatialDWLS, SPOTlight, STdeconvolve, stereoscope, STRIDE and Tangram. These methods can be mainly divided into four categories: enrichment scoring method, regression model-based deconvolution, probabilistic model-based deconvolution and deep learning model-based deconvolution. Enrichment-based methods [e.g. Seurat (<xref rid="btac805-B28" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), Giotto-PAGE/rank/Hypergeometirc (<xref rid="btac805-B9" ref-type="bibr">Dries <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac805-B12" ref-type="bibr">Kim and Volsky, 2005</xref>) and MIA (<xref rid="btac805-B20" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>)] usually infer the probability of the presence of each cell type in the spot based on an enrichment score of a gene set (e.g. cell-type-specific marker genes identified from scRNA-seq data). The other three categories of methods directly infer the proportions of different cell types within each spot. Toward that, regression model-based deconvolution methods [e.g. SPOTlight (<xref rid="btac805-B10" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic>, 2021</xref>), spatialDWLS (<xref rid="btac805-B8" ref-type="bibr">Dong and Yuan, 2021</xref>; <xref rid="btac805-B30" ref-type="bibr">Tsoucas <italic toggle="yes">et al.</italic>, 2019</xref>) and spatialDecon (<xref rid="btac805-B7" ref-type="bibr">Danaher <italic toggle="yes">et al.</italic>, 2022</xref>)] assume that a spot profile is a linear combination of cell-type-specific expression profile and cell type proportions. Alternatively, probabilistic model-based deconvolution methods [e.g. RCTD (<xref rid="btac805-B5" ref-type="bibr">Cable <italic toggle="yes">et al.</italic>, 2022</xref>), cell2location (<xref rid="btac805-B13" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic>, 2020</xref>), stereoscope (<xref rid="btac805-B2" ref-type="bibr">Andersson <italic toggle="yes">et al.</italic>, 2020</xref>), DestVI (<xref rid="btac805-B17" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2022</xref>) and STdeconvolve (<xref rid="btac805-B18" ref-type="bibr">Miller <italic toggle="yes">et al.</italic>, 2022</xref>)] are to fit a probability distribution based on a statistical model, which assumes that the spatial gene expression follows a distribution, such as the Poisson distribution (<xref rid="btac805-B5" ref-type="bibr">Cable <italic toggle="yes">et al.</italic>, 2022</xref>) or negative binomial distribution (<xref rid="btac805-B2" ref-type="bibr">Andersson <italic toggle="yes">et al.</italic>, 2020</xref>). In addition, deep learning model-based methods [e.g. DSTG (<xref rid="btac805-B26" ref-type="bibr">Song and Su, 2021</xref>) and Tangram (<xref rid="btac805-B4" ref-type="bibr">Biancalani <italic toggle="yes">et al.</italic>, 2021</xref>)] deconvolute ST spots by borrowing information from scRNA-seq data. The principles and characteristics of these methods are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S1</xref>.</p>
      <p>Notably, MIA does not release its code, and DSTG cannot output cell type information for comparison with the ground truth, so we benchmark the other 14 methods in this study.</p>
    </sec>
    <sec>
      <title>2.2 Dataset collection and preprocessing</title>
      <p><italic toggle="yes">Mouse embryo ST data</italic>. It is a single-cell resolution ST data generated by sci-Space technology (Sanjay R. <xref rid="btac805-B25" ref-type="bibr">Srivatsan <italic toggle="yes">et al.</italic>, 2021</xref>), including 14 mouse embryo sections at different developmental stages. In this study, we selected the ST data coming from the 14th completely developed mouse embryo section for benchmarking, which contains 18 cell types and 17 301 cells with 52 535 genes per cell.</p>
      <p><italic toggle="yes">MPOA ST data</italic>. It is a single-cell resolution spatial expression dataset generated by applying the multiplex error-robust fluorescence in situ hybridization (MERFISH) technology to the mouse medial preoptic area (MPOA) (<xref rid="btac805-B19" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic>, 2018</xref>). We referred to the steps in STdeconvolve (<xref rid="btac805-B18" ref-type="bibr">Miller <italic toggle="yes">et al.</italic>, 2022</xref>) for the processing procedure of this dataset. The processed data consists of 9 cell types and 59 651 cells with 135 genes per cell.</p>
      <p><italic toggle="yes">Mouse brain scRNA-seq and ST data</italic>. The scRNA-seq data were sequenced by Smart-seq2 technology (<xref rid="btac805-B29" ref-type="bibr">Tasic <italic toggle="yes">et al.</italic>, 2016</xref>), including 4785 cells with 34 617 genes per cell. All cells were annotated into 15 clusters. The ST data of the mouse brain were obtained from 10X <xref rid="btac805-B11" ref-type="bibr">Genomics (2019)</xref>. In this study, we selected the frontal cortex region for benchmarking, which consists of 1075 spots with each spot containing 31 053 genes.</p>
      <p><italic toggle="yes">Human developing heart scRNA-seq and ST data</italic>. The ST data of the human heart at three developmental stages [4.5–6, 6.5 and 9 post-conception weeks (PCW)] was obtained using Spatial Transcriptomics technology (<xref rid="btac805-B3" ref-type="bibr">Asp <italic toggle="yes">et al.</italic>, 2019</xref>). In this study, we selected the ST data at 6.5 PCW for deconvolution, which contains 1515 spots with 38 855 genes per spot. A set of scRNA-seq data generated in the same study was used as a reference for ST cell type annotation. The scRNA-seq data contains 15 clusters and 3777 cells in total, with 10 538 genes per cell.</p>
      <p>We summarized the information of the above datasets in <xref rid="btac805-T1" ref-type="table">Table 1</xref>. The following steps were performed for pre-processing these datasets: (i) removing genes (rows) with row sum 0; (ii) filtering genes expressed in less than 5% of the cells or spots; (iii) retaining the cell types with at least 25 cells. Of note, since the MPOA ST dataset only has 135 genes, the step (i) was not performed for this dataset.</p>
      <table-wrap position="float" id="btac805-T1">
        <label>Table 1.</label>
        <caption>
          <p>The information of the collected datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tissue</th>
              <th rowspan="1" colspan="1">Technology</th>
              <th rowspan="1" colspan="1">Resolution</th>
              <th rowspan="1" colspan="1">Spot/cell number</th>
              <th rowspan="1" colspan="1">Gene number</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Mouse embryo</td>
              <td rowspan="1" colspan="1">sci-Space</td>
              <td rowspan="1" colspan="1">Single cell</td>
              <td rowspan="1" colspan="1">17 301</td>
              <td rowspan="1" colspan="1">52 535</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MPOA</td>
              <td rowspan="1" colspan="1">MERFISH</td>
              <td rowspan="1" colspan="1">Single cell</td>
              <td rowspan="1" colspan="1">59 651</td>
              <td rowspan="1" colspan="1">135</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Mouse brain</td>
              <td rowspan="1" colspan="1">Smart-seq2</td>
              <td rowspan="1" colspan="1">Single cell</td>
              <td rowspan="1" colspan="1">4785</td>
              <td rowspan="1" colspan="1">34 617</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10X Genomics</td>
              <td rowspan="1" colspan="1">Spot</td>
              <td rowspan="1" colspan="1">1075</td>
              <td rowspan="1" colspan="1">31 053</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">GemCode</td>
              <td rowspan="1" colspan="1">Single cell</td>
              <td rowspan="1" colspan="1">3777</td>
              <td rowspan="1" colspan="1">10 538</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">developing heart</td>
              <td rowspan="1" colspan="1">ST</td>
              <td rowspan="1" colspan="1">Spot</td>
              <td rowspan="1" colspan="1">1515</td>
              <td rowspan="1" colspan="1">38 855</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>2.3 Generation of synthetic ST datasets for benchmarking</title>
      <p>To benchmark different deconvolution methods, we employed different strategies for single-cell ST data and scRNA-seq data to synthesize multi-cells-per-spot datasets with known cell type compositions.</p>
      <p>The mouse embryo ST dataset sequenced by sci-Space technology is at single-cell resolution for gene expression. However, the sci-Space technology uses spatially gridded barcodes to sequence tissue, so multiple cells within the same space grid are labeled with the same coordinate. Therefore, we treated a space grid as a simulated spot and aggregated the expression profiles of all cells in the grid to represent the expression profile of a simulated spot. The final synthetic ST dataset included 1393 spots with 52 535 genes per spot. We used the resulting cell type propositions of each spot as the ground truth.</p>
      <p>For the MPOA ST data, we defined a square with a size <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> (∼100 µm in diameter), which was viewed as a spot-like region. The transcriptome profile of each simulated spot was simulated as the sum of expression profiles of all cells located in the region, and the coordinate of the simulated spot was set as the location of the starting cell (i.e. the upper left cell) in a square region. The final simulated spatial dataset contained 3072 regular spots with 135 genes per spot. The percentage of cell types in each spot was calculated as the ground truth.</p>
      <p>For the mouse brain tissue, we first mapped the scRNA-seq dataset to the spatial locations of the paired ST dataset using the CellTrek tool (<xref rid="btac805-B32" ref-type="bibr">Wei <italic toggle="yes">et al.</italic>, 2022</xref>), resulting in a simulated single-cell resolution ST data. The synthetic spatial data had not only the scRNA-seq-like gene expression but also spatial location information. We then defined a square with a size of<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mn>150</mml:mn><mml:mo>×</mml:mo><mml:mn>150</mml:mn></mml:math></inline-formula> (∼100 µm in diameter) and treated it as a simulated spot. The gene expressions of multiple cells in a square were aggregated to represent the spot-level expression profiles, and the location of the starting cell in the square was defined as the coordinate of the spot. Finally, the synthetic ST dataset contained 739 spots in total and each spot had 34 617 genes. We used the original cell-type label of each cell to calculate the percentage of cell types in each spot and viewed it as the ground truth.</p>
      <p>The resulting three synthetic ST datasets are referred to as the embryo (sci-Space) dataset, MPOA (MERFISH) dataset and mouse brain (mapped sc-ST) dataset, respectively, in the following text, and <xref rid="btac805-T2" ref-type="table">Table 2</xref> summarizes important statistics of these three datasets.</p>
      <table-wrap position="float" id="btac805-T2">
        <label>Table 2.</label>
        <caption>
          <p>The information of the synthetic datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Spot number</th>
              <th rowspan="1" colspan="1">Gene number</th>
              <th rowspan="1" colspan="1">Cluster number</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">embryo (sci-Space)</td>
              <td rowspan="1" colspan="1">1393</td>
              <td rowspan="1" colspan="1">52 535</td>
              <td rowspan="1" colspan="1">18</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MPOA (MERFISH)</td>
              <td rowspan="1" colspan="1">3072</td>
              <td rowspan="1" colspan="1">135</td>
              <td rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">mouse brain (mapped sc-ST)</td>
              <td rowspan="1" colspan="1">739</td>
              <td rowspan="1" colspan="1">34 617</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Furthermore, to investigate the impact of different sequencing depths, spot sizes and data normalization choices on the performance of deconvolution methods, we synthesize datasets with different sequencing depths or different spot sizes and processed the above three ST datasets using different data normalization methods. See details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Texts S2–S4</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Implementation of deconvolution methods</title>
      <p>We followed the instructions provided on the website of each tool to implement deconvolution. The details of the implementation of the existing 14 deconvolution methods are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S5</xref>.</p>
    </sec>
    <sec>
      <title>2.5 Evaluation metrics</title>
      <p>We used RMSE, PCC and JSD (see details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S6</xref>) to evaluate the performance of different deconvolution methods by using the known cell type proportions in the three synthetic ST datasets as the ground truth.</p>
    </sec>
    <sec>
      <title>2.6 Integrating deconvolution methods</title>
      <p>After benchmarking different deconvolution methods, we developed an ensemble learning-based deconvolution method (EnDecon) for ST data by drawing on strengths from existing methods. Notably, to ensure the efficiency of EnDecon, we integrated three top-performing methods into a linear weighted model as follows,
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> represent the cell type proportions derived from the top three individual methods, respectively, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the corresponding weights.</p>
      <p>The weights in the above model were trained using 10-fold cross-validation method. Specifically, we divided the embryo (sci-Space) dataset and mouse brain (mapped sc-ST) dataset into 10-folds, respectively. For each dataset, we took turns choosing 9-folds out of 10-folds as the training set to estimate the coefficients (i.e. <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) and using the remaining 1-fold of the two datasets as the testing sets for calculating RMSE, PCC and JSD. We conducted the above 10-fold cross-validation 10 times and took the average of the estimated values of each coefficient as the final weight for each of the three individual methods in the EnDecon. Furthermore, we validated the performance of the trained EnDecon model on the independent MOPA (MERFISH) dataset.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Benchmarking framework</title>
      <p>To test the performance of 14 deconvolution methods, we designed a benchmarking workflow as shown in <xref rid="btac805-F1" ref-type="fig">Figure 1</xref>. Briefly, we first collected both single-cell resolution ST data and scRNA-seq data to synthesize the low-resolution ST datasets with known cell type compositions (see details in Section 2.3). We then assessed the accuracy of each method by calculating RMSE, PCC and JSD between the predicted cell type compositions and the ground truth based on the above synthetic ST datasets. We next examined the impact of sequencing depth, spot size and normalization choice on the deconvolution results and assessed the time and space complexities of different methods. Furthermore, we developed an ensemble model by integrating the top three deconvolution methods ranked according to the benchmarking results with a linear weighted model. We adopted the <italic toggle="yes">k</italic>-fold cross-validation method to train the weights in the ensemble model and further tested and compared its performance using independent validation dataset.</p>
      <fig position="float" id="btac805-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Schematic diagram of the benchmarking workflow to compare the performance of the 14 methods for deconvoluting ST data. Firstly, we adopted two strategies to build benchmark datasets based on single-cell resolution ST and scRNA-seq datasets. Next, we evaluated the prediction accuracy of the 14 deconvolution methods using three metrics (RMSE, PCC and JSD) and assessed the impact of different factors (sequencing depth, spot size and ST normalization choice) on deconvolution results. Furthermore, we developed an ensemble method by weighting and integrating the top 3 individual methods. Lastly, we adopted ISS data and ISH data to further evaluate the performance of all methods</p>
        </caption>
        <graphic xlink:href="btac805f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Performance evaluation of 14 deconvolution methods</title>
      <p>Based on the three synthetic datasets, we evaluated the performance of each method in the following three aspects: (i) prediction accuracy in terms of cell type proportion deconvolution, evaluated using the metrics including RMSE, PCC and JSD; (ii) stability of the method with respect to the sequencing depth, spot size and normalization choice of the ST data; (iii) usability of the tool in terms of running time and memory. Overall, we found that cell2location has the best performance, followed by RCTD and spatialDWLS (<xref rid="btac805-F2" ref-type="fig">Fig. 2a and b</xref>). Below we described the benchmarking results in more detail.</p>
      <fig position="float" id="btac805-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Summary of benchmarking results for the 14 deconvolution methods. (<bold>a</bold>) The names of two types of methods (i.e. enrichment-based methods and deconvolution-based methods) are respectively ordered by their performances. (<bold>b</bold>) The overall ranking of the 14 methods. (<bold>c</bold>) Accuracy of different methods across three metrics and three synthetic datasets. (<bold>d</bold>) Stability of each deconvolution method with respect to sequencing depth, spot size and normalization. To evaluate the robustness of different methods to sequencing depth, for each method, we calculated the variance of the aggregated score at different sequencing depths (<xref rid="sup1" ref-type="supplementary-material">Supplementary Text S6</xref>). ‘Not applicable’ indicates that certain deconvolution method does not support performing normalization of ST data. (<bold>e</bold>) Usability assessment in terms of running time and memory</p>
        </caption>
        <graphic xlink:href="btac805f2" position="float"/>
      </fig>
      <p><bold>Accuracy.</bold> We compared the accuracy of different deconvolution methods across metrics and datasets. We found that the accuracy of each of the 14 methods was generally quite stable across the three metrics, but the accuracy of some methods (i.e. stereoscope, STdeconvolve and Giotto/rank) varied depending on datasets (<xref rid="btac805-F2" ref-type="fig">Fig. 2c</xref>).</p>
      <p>Specifically, we compared the values of RMSE, PCC and JSD of 14 methods across the three synthetic datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We found that cell2location, RCTD and spatialDWLS outperformed the other methods. For instance, on the mouse brain (mapped sc-ST) dataset, the RMSE values of cell2location (0.0373), RCTD (0.0407) and spatialDWLS (0.0461) were lower than those of other methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1a</xref>). Consistently, the PCC values of cell2location (0.9837), RCTD (0.9807) and spatialDWLS (0.9748) were higher than those of other methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2b</xref>). Moreover, the median JSD values of cell2location, RCTD and spatialDWLS were 0.0143, 0.0120 and 0.0188, respectively, which were lower than the median JSD values of other methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2c</xref>). In addition, comparing RMSE or PCC per cell type on the three synthetic ST datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>) consistently demonstrated that cell2location, RCTD and spatialDWLS have smaller RMSE or PCC values for individual cell types.</p>
      <p>To evaluate the performance of the deconvolution methods more intuitively, we reconstructed the spatial cell type distribution maps for the synthetic ST datasets of the mouse embryo, MPOA (one certain section) and mouse brain tissues according to the deconvolution proportions and compared them with the gold standard. For the embryo (sci-Space) dataset, cell2location, RCTD and spatialDWLS well reconstructed the layered structure and accurately deconvoluted ST spots (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Specifically, these three methods correctly mapped the main cell type in the cortex region, neuron, to the top and right limbic layers, and mapped the Erythroid Lineage and Hepatocytes cell types mainly to the middle layer, i.e. the liver area in the mouse embryo (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3a</xref>). The spatial patterns of these cell types were consistent with those in the gold standard (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3b</xref>). In contrast, the cell types predicted by SPOTlight in the overall embryo region were mostly Schwann cells or Radial glia cells, which was not comparable to the gold standard. Besides, the spatial deconvolution of DestVI and Giotto/rank failed to reveal spatial heterogeneity of the tissue. For the MPOA (MERFISH) dataset, the spatial locations of the Ependymal cells predicted by cell2location, RCTD and spatialDWLS were in the middle of this section, highly consistent with those of the gold standard (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
      <p>Furthermore, to assess the predicted spatial cell type distribution of all methods within the mouse brain cortex structure, we used the expression pattern of the known cell-type marker gene in the ISH image data from the Allen Mouse Brain Atlas as the gold standard. In this study, we used Rasgrf2, Plcxd2 and Cplx3 as the marker genes for three cortex cell types, L2/3, L4 and L6b, respectively, as reported by Zeisel <italic toggle="yes">et al.</italic> (<xref rid="btac805-B1" ref-type="bibr">Amit Zeisel <italic toggle="yes">et al.</italic>, 2015</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5–S7</xref>). The proportions of these three cell types estimated by cell2location, RCTD and spatialDWLS were highly consistent with the corresponding marker gene expressions in the ISH images (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5–S7</xref>). Specifically, the L2/3 subcluster was mapped to the lateral border of the cortex at larger proportions, and L4–L6b subclusters were predicted to line up along the stretched area descending toward the center. The spatial organization of these cell types agreed with the strictly layered structure of the cortex. However, the spatial locations of L2/3 and L4 predicted by spatialDecon and SPOTlight were distributed throughout the cortex region.</p>
      <p><bold>Stability.</bold> To test the stability of each method, we investigated the impact of different sequencing depths, spot sizes and normalizations on the deconvolution results of each method (<xref rid="btac805-F2" ref-type="fig">Fig. 2d</xref>).</p>
      <p>Firstly, most methods were rather robust to the variation of sequencing depth, while RCTD, spatialDecon and stereoscope were more sensitive to changes in sequencing depth (<xref rid="btac805-F2" ref-type="fig">Fig. 2d</xref>). Specifically, on the mouse brain (mapped sc-ST) dataset, RCTD and stereoscope only performed well when the sequencing depth was low, while spatialDecon became gradually worse when the sequencing depth decreased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). In general, cell2location and spatialDWLS had the best performance under different sequencing depths.</p>
      <p>Secondly, the performance of all methods except Tangram and Seurat tended to become worse when the spot size decreased from 150 to 25 µm (<xref rid="btac805-F2" ref-type="fig">Fig. 2d</xref>). Of note, Seurat outperformed all the other methods on the MPOA (MERFISH) dataset at spot size = 25 µm, and was no longer the best at larger spot sizes. Furthermore, the performance of STdeconvolve was better than that of DestVI on the mouse brain (mapped sc-ST) dataset with spot size = 25 µm, whereas this observation no longer held when spot size became larger (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Overall, cell2location, RCTD and spatialDWLS still maintained good performance when spot sizes varied.</p>
      <p>Thirdly, the performance of deconvolution methods varied widely concerning different normalization methods, suggesting that there was no ‘one size fits all’ normalization approach that works for all deconvolution methods (<xref rid="btac805-F2" ref-type="fig">Fig. 2b</xref>). Particularly, Giotto/Hypergeometric, Giotto/PAGE, Giotto/rank and spatialDWLS performed best on the embryo (sci-Space) and mouse brain (mapped sc-ST) datasets when employing the ‘normalizeGiotto’ method described in their respective original publications. SPOTlight, STRIDE and Tangram showed the best performance when using ‘unit variance’ to normalize the spatial gene expression matrix (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>).</p>
      <p><bold>Usability.</bold> We tested the running time and memory usage of the 14 deconvolution methods on the same platform (2.7 GHz, 39 424 KB L3 Cache, 112 CPU cores).</p>
      <p>Regarding running time, we observed that Tangram had the shortest running time on three datasets, and Giotto/Hypergeometric, Giotto/PAGE, Giotto/rank, RCTD, Seurat and spatialDWLS ran less than six minutes, while stereoscope ran more than two hours. Notably, for the three methods (i.e. cell2location, RCTD and spatialDWLS) with better performance, the running time of cell2location was nearly 100 times that of RCTD or spatialDWLS (<xref rid="btac805-F2" ref-type="fig">Fig. 2e</xref>).</p>
      <p>Regarding memory usage, we found that stereoscope had the highest RAM requirement, while Tangram had the lowest RAM requirement (<xref rid="btac805-F2" ref-type="fig">Fig. 2e</xref>). Giotto/Hypergeometric, Giotto/PAGE, Giotto/rank and spatialDWLS had the same memory usage since the functions used by these four methods belong to the same package. Particularly, RCTD had the least memory usage among the top-ranked three methods (i.e. cell2location, RCTD and spatialDWLS).</p>
      <p>In short, Tangram was the most efficient, while stereoscope was the least efficient. RCTD not only performed well among the 14 methods in terms of inferring cell type proportions for a given spot but also had higher efficiency.</p>
    </sec>
    <sec>
      <title>3.3 Integration for an ensemble model</title>
      <p>To test whether an ensemble of the existing methods could improve the accuracy of the ST deconvolution, we compared the performance of EnDecon with cell2location, RCTD and spatialDWLS on testing and validation sets. The cross-validation results (<xref rid="btac805-F3" ref-type="fig">Fig. 3</xref>) showed that the ensemble model achieved significant performance improvement on testing sets of the embryo (sci-Space) and mouse brain (mapped sc-ST) datasets in terms of RMSE, PCC and JSD. Moreover, EnDecon outperformed the three individual methods on the independent validation set [i.e. MOPA (MERFISH) dataset] (<xref rid="btac805-T3" ref-type="table">Table 3</xref>) concerning all three metrics.</p>
      <fig position="float" id="btac805-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>The performance of the EnDecon model on testing sets of the embryo (sci-Space) dataset (<bold>a</bold>) and mouse brain (mapped sc-ST) dataset (<bold>b</bold>). Ten times 10-fold cross-validation was performed. Accuracy metrics (i.e. RMSE, PCC and JSD) of EnDecon were compared to the other three individual methods (i.e. cell2location, RCTD and spatialDWLS). Wilcoxon rank sum test (one-tailed) <italic toggle="yes">P</italic>-value was calculated to assess the statistical significance of the difference</p>
        </caption>
        <graphic xlink:href="btac805f3" position="float"/>
      </fig>
      <table-wrap position="float" id="btac805-T3">
        <label>Table 3.</label>
        <caption>
          <p>Comparing the performance of the EnDecon model with each of the top three methods on the independent validation dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">RMSE</th>
              <th rowspan="1" colspan="1">PCC</th>
              <th rowspan="1" colspan="1">JSD</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="2" colspan="1">MPOA</td>
              <td rowspan="1" colspan="1">cell2location</td>
              <td rowspan="1" colspan="1">0.0682</td>
              <td rowspan="1" colspan="1">0.9346</td>
              <td rowspan="1" colspan="1">0.0631</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RCTD</td>
              <td rowspan="1" colspan="1">0.0740</td>
              <td rowspan="1" colspan="1">0.9149</td>
              <td rowspan="1" colspan="1">0.0562</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">(MERFISH)</td>
              <td rowspan="1" colspan="1">spatialDWLS</td>
              <td rowspan="1" colspan="1">0.0718</td>
              <td rowspan="1" colspan="1">0.9289</td>
              <td rowspan="1" colspan="1">0.0569</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>EnDecon</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.0544</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.9515</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.0484</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The boldface values indicate that the proposed method, EnDecon, outperformed other methods.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Furthermore, we depicted the spatial distributions on the three synthetic datasets using the cell type proportions predicted by EnDecon and compared them with the corresponding gold standard (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). We found a high degree of consistency between EnDecon’s predicted spatial distributions of cell type abundance and the gold standard on both the embryo (sci-Space) dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11a</xref>) and the MPOA (MERFISH) dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11b</xref>). For the mouse brain (mapped sc-ST) dataset, it was clear that the estimated cell type proportions by EnDecon agree with the corresponding marker gene expression in the ISH images (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11c</xref>).</p>
      <p>Finally, we compared the computational resources consumed by EnDecon and 14 other individual methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). We observed that the computational efficiency of EnDeon was comparable to that of cell2location and better than that of stereoscope. Taking the mouse brain (mapped sc-ST) dataset as an example, EnDecon ran a little bit slower than cell2location (i.e. nearly eight minutes slower) and EnDecon required less memory than spatialDWLS.</p>
    </sec>
    <sec>
      <title>3.4 Application of different methods on real ST datasets</title>
      <p>To verify the performance of different deconvolution methods on real ST data, we applied them to study the spatial organization of the human developing heart ST dataset. A recent study provides a spatiotemporal atlas of the human developing heart (4.5–5, 6.5 and 9 PCW) by integrating scRNA-seq, ST and ISS data (<xref rid="btac805-B3" ref-type="bibr">Asp <italic toggle="yes">et al.</italic>, 2019</xref>). We performed cell type deconvolution on the ST data of samples at 6.5 PCW using 15 deconvolution methods (<xref rid="btac805-F4" ref-type="fig">Fig. 4a</xref>) and used the ISS cell type map in the original study (<xref rid="btac805-B3" ref-type="bibr">Asp <italic toggle="yes">et al.</italic>, 2019</xref>) as the gold standard (<xref rid="btac805-F4" ref-type="fig">Fig. 4b</xref>).</p>
      <fig position="float" id="btac805-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Application of different deconvolution methods on the human developing heart dataset. (<bold>a</bold>) The spatial distributions of cell type proportion predicted by 15 deconvolution methods in sample 4 at 6.5 PCW. Each pie represents the cell type proportions in each spot in the ST slide, and colors represent different cell types. (<bold>b</bold>) The spatial cell type map generated by integrating ISS and scRNA-seq data in the original study</p>
        </caption>
        <graphic xlink:href="btac805f4" position="float"/>
      </fig>
      <p>Using sample 4 at 6.5 PCW as an example, it is shown that the spatial locations of all cell types inferred by cell2location, RCTD, spatialDWLS, stereoscope and EnDecon well reconstructed the hierarchical structure of the human heart (<xref rid="btac805-F4" ref-type="fig">Fig. 4a</xref>). Specifically, as expected, these methods mapped Ventricular and Atrial cardiomyocytes to the lower and upper ventricles. Also, Smooth muscle cells were correctly predicted to localize in the outflow tract, consistent with the spatial location of the corresponding cell types in the ISS cell type map (<xref rid="btac805-F4" ref-type="fig">Fig. 4b</xref>). Of note, although Seurat estimated the clearest cell-type spatial structure, only a partial domain of cell types could be enriched. In fact, the ISS cell type map showed that the lower ventricle was mainly composed of Ventricular cardiomyocytes and Myoa2-enriched cardiomyocytes cell types, whereas Seurat inferred only the former in the lower ventricle. As such, the cell type deconvolution inferred by Seurat seems less favorable than that of cell2location, RCTD, spatialDWLS, EnDecon or even stereoscope.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The emerging ST technologies provide new insights into spatial heterogeneity in cellular abundance and gene expression. However, the resolutions of most of the current ST data are not guaranteed to be single-cell. Therefore, it is necessary to quantify cell type abundance for individual spots in the ST data. Although many computational methods have been developed to address this challenge, their performances have not been comprehensively evaluated. In this study, we benchmarked 14 state-of-the-art methods for ST deconvolution in terms of accuracy, stability and usability. We further developed an ensemble model that significantly improved the deconvolution accuracy.</p>
    <p>Based on the benchmarking results, we provide a practical guideline for researchers to choose suitable tools to analyze their ST datasets (<xref rid="btac805-F5" ref-type="fig">Fig. 5</xref>). The performance of a deconvolution method heavily depends on whether it requires reference data, its deconvolution strategy (e.g. enrichment or deconvolution), and its modeling approach (e.g. linear regression model, probabilistic model). Therefore, we categorize them according to the above three factors, and for each category, our evaluation suggests an optimal choice, as shown in <xref rid="btac805-F5" ref-type="fig">Figure 5</xref>.</p>
    <fig position="float" id="btac805-F5">
      <label>Fig. 5.</label>
      <caption>
        <p>Practical guidelines for method users. As the performance of a method mainly depends on whether a reference is needed, the strategy is adopted and the mathematical model used, we, therefore, provide a set of practical guidelines combining the accuracy, stability and user-friendliness of the method. The methods on the right are ranked according to their performance on a specific (set of) deconvolution method. Further to the right, the accuracy, stability, usability scores (+: ≥0.9; ±: ≥0.6; –: &lt;0.6) and operating platform are displayed in order. The grey square denotes that the corresponding method fails to evaluate</p>
      </caption>
      <graphic xlink:href="btac805f5" position="float"/>
    </fig>
    <p>Among all the 14 deconvolution methods, only STdeconvolve is reference-free while it performed not well. The other methods requiring scRNA-seq data as a reference can be categorized into enrichment-based methods and deconvolution-based methods. Among the enrichment-based methods, Seurat had the best performance, followed by Giotto/Hypergeometric, Giotto/PAGE and Giotto/rank. Of note, we did not evaluate MIA because the authors did not disclose executable code in the original publication (<xref rid="btac805-B20" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>). Particularly, the enrichment results of Seurat can be directly used as cell type proportions for subsequent analysis. In contrast, the enrichment scores estimated by the three methods included in the Giotto package (i.e. Hypergeometric, PAGE and rank) represent the importance of different cell types at each spot, which are required to be normalized to get ultimate cell type proportions.</p>
    <p>Regarding the deconvolution-based methods, cell2location and RCTD performed best among all probabilistic model-based deconvolution methods. However, the usability of cell2location was worse than that of RCTD. Among regression model-based deconvolution methods, spatialDWLS was superior to spatialDecon and SPOTlight in terms of accuracy, stability and usability. Technically, spatialDWLS first uses enrichment analysis to identify the cell type at each spot and then applies a regression model to infer the proportion of the selected cell type, and these steps are performed on subclusters of ST data. This might explain why spatialDWLS outperforms other methods. Regarding deep learning model-based methods, Tangram had high efficiency and acceptable accuracy. Moreover, Tangram can predict the spatial distribution of undetected transcripts. Besides, DSTG was omitted for benchmarking since its deconvoluted result had no annotation information and could not be compared with the ground truth. Currently, only a few deep learning model-based deconvolution tools have been developed. We anticipate that deep learning methods have the potential to further improve the accuracy and stability of ST deconvolution with high computational efficiency.</p>
    <p>To improve the deconvolution accuracy, we proposed an ensemble learning-based method to estimate cell type proportions for ST spots. By integrating the top three deconvolution methods using a linear weighted model, EnDecon achieved a significant improvement in deconvolution accuracy. Notably, EnDecon assigns a larger weight to a better method and meanwhile combines strengths from the three individual methods. Thus, EnDecon can naturally maintain a good performance under different settings (e.g. sequencing depth, spot size and normalization) and thus has better stability than the other individual methods. Therefore, EnDecon provides an alternative and more effective method for ST deconvolution.</p>
    <p>In future studies, new methods could be developed for ST deconvolution by considering the constraint of adjacent spots. More specifically, for the ST data, we can consider synthesizing the adjacent spots into new spots containing more cells, which satisfies the linear constraint that the proportion of cell types in the simulated big spot is equal to the weighted sum of the proportion of cell types in the respective small spots. This constraint can increase the number of samples for deconvolution inference and achieve self-supervised learning. Currently, existing deconvolution methods do not consider this constraint, which may explain the observation that smaller spot sizes tend to have larger RMSE values in our study. New deconvolution methods incorporating this constraint may address the issue and are anticipated to improve deconvolution performance.</p>
    <p>Another limitation of the current existing ST deconvolution methods is that most of them only infer cell type proportions but do not estimate cell-type-specific (CTS) gene expression at each spot, which is equally important for ST data analysis. For bulk RNA-seq data, many methods have been developed for CTS genes expression inference, such as TCA (<xref rid="btac805-B23" ref-type="bibr">Rahmani <italic toggle="yes">et al.</italic>, 2019</xref>), CIBERSORTx (<xref rid="btac805-B21" ref-type="bibr">Newman <italic toggle="yes">et al.</italic>, 2019</xref>), bMIND (<xref rid="btac805-B31" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2021</xref>) and swCAM (<xref rid="btac805-B6" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2022</xref>). However, for the ST data, only RCTD can infer the CTS gene expression at each spot. RCTD calculates CTS gene expression under the assumption that random effects of gene expression are shared across all cell types, which may lead to inaccurate estimation. Therefore, new methods are necessary and valuable to be developed for inferring CTS gene expression from ST data in the future.</p>
    <p>In conclusion, this study performs a comprehensive comparison of available ST deconvolution methods for decomposing the cell type composition of spatial mixtures. The major new findings in this study are as follows: (i) cell2loction, RCTD and spatialDWLS are more accurate than other ST deconvolution methods, based on the evaluation of RMSE, PCC and JSD; (ii) cell2location and spatialDWLS are more robust to the variation of sequencing depth than RCTD; (iii) the accuracy of the existing methods tends to decrease as the spot size becomes smaller; (iv) most deconvolution methods only perform well when they normalize ST data using the method described in their original publications; and (v) the ensemble learning-based deconvolution method, EnDecon, achieves more accurate deconvolution of the ST data. The results provide valuable information and guideline for analyzing spatial transcriptome data and developing new deconvolution methods.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac805_Supplementary_Data</label>
      <media xlink:href="btac805_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge members in the Sun lab at SYSU for valuable discussion.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Natural Science Foundation of China [62273364, 11931019 and 11871070], the National Key R&amp;D Program of China [2021YFF1200903] and the Guangdong Basic and Applied Basic Research Foundation [2020B151502120].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data used in this study are publicly available. The embryo (sci-Space) dataset was downloaded from the Gene Expression Omnibus database under GSE166692; the MPOA (MERFISH) dataset was downloaded from <ext-link xlink:href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.8t8s248/" ext-link-type="uri">https://datadryad.org/stash/dataset/doi:10.5061/dryad.8t8s248/</ext-link>; the mouse brain ST data were download from <ext-link xlink:href="https://www.dropbox.com/s/azjysbt7lbpmbew/brain_st_cortex.rds?dl=0" ext-link-type="uri">https://www.dropbox.com/s/azjysbt7lbpmbew/brain_st_cortex.rds?dl=0</ext-link> and the paired scRNA-seq data were downloaded from <ext-link xlink:href="https://www.dropbox.com/s/ruseq3necn176c7/brain_sc.rds?dl=0" ext-link-type="uri">https://www.dropbox.com/s/ruseq3necn176c7/brain_sc.rds?dl=0</ext-link>; the human developing heart ST and scRNA-seq data were downloaded from <ext-link xlink:href="https://data.mendeley.com/datasets/mbvhhf8m62/2" ext-link-type="uri">https://data.mendeley.com/datasets/mbvhhf8m62/2</ext-link>. For further validation, the ISS data were obtained from <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.10058048.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.10058048.v1</ext-link> and the ISH image data were downloaded from <ext-link xlink:href="https://mouse.brain-map.org/" ext-link-type="uri">https://mouse.brain-map.org/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac805-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amit Zeisel</surname><given-names>A.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Cell types in the mouse cortex and hippocampus revealed by scRNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title>. <source>Commun. Biol</source>., <volume>3</volume>, <fpage>565</fpage>.<pub-id pub-id-type="pmid">33037292</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asp</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>. <source>Cell</source>, <volume>179</volume>, <fpage>1647</fpage>–<lpage>1660.e19</lpage>.<pub-id pub-id-type="pmid">31835037</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biancalani</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Deep learning and alignment of spatially resolved single-cell transcriptomes with tangram</article-title>. <source>Nat. Methods</source>, <volume>18</volume>, <fpage>1352</fpage>–<lpage>1362</lpage>.<pub-id pub-id-type="pmid">34711971</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat. Biotechnol</source>., <volume>40</volume>, <fpage>517</fpage>–<lpage>526</lpage>.<pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>swCAM: estimation of subtype-specific expressions in individual samples with unsupervised sample-wise deconvolution</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>1403</fpage>–<lpage>1410</lpage>.<pub-id pub-id-type="pmid">34904628</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danaher</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Advances in mixed cell deconvolution enable quantification of cell types in spatial transcriptomic data</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>385</fpage>.<pub-id pub-id-type="pmid">35046414</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname><given-names>R.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>G.C.</given-names></string-name></person-group> (<year>2021</year>) <article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>145</fpage>.<pub-id pub-id-type="pmid">33971932</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dries</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>78</fpage>.<pub-id pub-id-type="pmid">33685491</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua-Bayes</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>e50</fpage>.<pub-id pub-id-type="pmid">33544846</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>10X Genomics</surname><given-names>. </given-names></string-name></person-group> (<year>2019</year>) Inside Visium spatial capture technology. <ext-link xlink:href="https://pages.10xgenomics.com/rs/446-PBO-704/images/10x_BR060_Inside_Visium_Spatial_Technology.pdf" ext-link-type="uri">https://pages.10xgenomics.com/rs/446-PBO-704/images/10x_BR060_Inside_Visium_Spatial_Technology.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac805-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S.Y.</given-names></string-name>, <string-name><surname>Volsky</surname><given-names>D.J.</given-names></string-name></person-group> (<year>2005</year>) <article-title>PAGE: parametric analysis of gene set enrichment</article-title>. <source>BMC Bioinformatics</source>, <volume>6</volume>, <fpage>144</fpage>.<pub-id pub-id-type="pmid">15941488</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) Comprehensive mapping of tissue cell architecture via integrated single cell and spatial transcriptomics. <italic toggle="yes">bioRxiv</italic> 2020.11.15.378125. <pub-id pub-id-type="doi">10.1101/2020.11.15.378125</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac805-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Spatially resolved transcriptomics adds a new dimension to genomics</article-title>. <source>Nat. Methods</source>, <volume>18</volume>, <fpage>15</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">33408402</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Benchmarking spatial and single-cell transcriptomics integration methods for transcript distribution prediction and cell type deconvolution</article-title>. <source>Nat. Methods</source>, <volume>19</volume>, <fpage>662</fpage>–<lpage>670</lpage>.<pub-id pub-id-type="pmid">35577954</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Longo</surname><given-names>S.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Integrating single-cell and spatial transcriptomics to elucidate intercellular tissue dynamics</article-title>. <source>Nat. Rev. Genet</source>., <volume>22</volume>, <fpage>627</fpage>–<lpage>644</lpage>.<pub-id pub-id-type="pmid">34145435</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) Multi-resolution deconvolution of spatial transcriptomics data reveals continuous patterns of inflammation. <italic toggle="yes">Nat. Biotechnol.</italic>, <bold>40</bold>, <fpage>1360</fpage>–<lpage>1369</lpage>.</mixed-citation>
    </ref>
    <ref id="btac805-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>B.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Reference-free cell type deconvolution of multi-cellular pixel-resolution spatially resolved transcriptomics data</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>2339</fpage>.<pub-id pub-id-type="pmid">35487922</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>J.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</article-title>. <source>Science</source>, <volume>362</volume>, <fpage>eaau5324</fpage>.<pub-id pub-id-type="pmid">30385464</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat. Biotechnol</source>., <volume>38</volume>, <fpage>333</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Newman</surname><given-names>A.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>773</fpage>–<lpage>782</lpage>.<pub-id pub-id-type="pmid">31061481</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patrik</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>, <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahmani</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Cell-type-specific resolution epigenetics without the need for cell sorting or single-cell biology</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>3417</fpage>.<pub-id pub-id-type="pmid">31366909</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Exploring tissue architecture using spatial transcriptomics</article-title>. <source>Nature</source>, <volume>596</volume>, <fpage>211</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">34381231</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivatsan</surname><given-names>S.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Embryo-scale, single-cell spatial transcriptomics</article-title>. <source>Science</source>, <volume>373</volume>, <fpage>111</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">34210887</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Su</surname><given-names>J.</given-names></string-name></person-group> (<year>2021</year>) <article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title>. <source>Brief. Bioinform</source>., <volume>22</volume>, <fpage>bbaa414</fpage>.<pub-id pub-id-type="pmid">33480403</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stickels</surname><given-names>R.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with slide-seqV2</article-title>. <source>Nat. Biotechnol</source>., <volume>39</volume>, <fpage>313</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">33288904</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902.e1821</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tasic</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat. Neurosci</source>., <volume>19</volume>, <fpage>335</fpage>–<lpage>346</lpage>.<pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsoucas</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Accurate estimation of cell-type composition from gene expression data</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>2975</fpage>.<pub-id pub-id-type="pmid">31278265</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Bayesian estimation of cell type-specific gene expression with prior derived from single-cell data</article-title>. <source>Genome Res</source>., <volume>31</volume>, <fpage>1807</fpage>–<lpage>1818</lpage>.<pub-id pub-id-type="pmid">33837133</pub-id></mixed-citation>
    </ref>
    <ref id="btac805-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Spatial charting of single-cell transcriptomes in tissues</article-title>. <source>Nat. Biotechnol</source>., <volume>40</volume>, <fpage>1190</fpage>–<lpage>1199</lpage>.<pub-id pub-id-type="pmid">35314812</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
