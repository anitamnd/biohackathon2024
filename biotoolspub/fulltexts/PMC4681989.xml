<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4681989</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv522</article-id>
    <article-id pub-id-type="publisher-id">btv522</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Hammock: a hidden Markov model-based peptide clustering algorithm to identify protein-interaction consensus motifs in large datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Krejci</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="btv522-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hupp</surname>
          <given-names>Ted R.</given-names>
        </name>
        <xref ref-type="aff" rid="btv522-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lexa</surname>
          <given-names>Matej</given-names>
        </name>
        <xref ref-type="aff" rid="btv522-AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vojtesek</surname>
          <given-names>Borivoj</given-names>
        </name>
        <xref ref-type="aff" rid="btv522-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Muller</surname>
          <given-names>Petr</given-names>
        </name>
        <xref ref-type="aff" rid="btv522-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv522-COR1">*</xref>
      </contrib>
      <aff id="btv522-AFF1"><sup>1</sup>RECAMO, Masaryk Memorial Cancer Institute, Zluty kopec 7, 65653, Brno, Czech Republic,</aff>
      <aff id="btv522-AFF2"><sup>2</sup>University of Edinburgh, Institute of Genetics and Molecular Medicine, Cancer Research Centre, Edinburgh EH4 2XR, UK and</aff>
      <aff id="btv522-AFF3"><sup>3</sup>Faculty of Informatics, Masaryk University, Botanicka 68a, 60200 Brno, Czech Republic</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv522-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN100">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>05</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>1</issue>
    <fpage>9</fpage>
    <lpage>16</lpage>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>8</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>8</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Proteins often recognize their interaction partners on the basis of short linear motifs located in disordered regions on proteins’ surface. Experimental techniques that study such motifs use short peptides to mimic the structural properties of interacting proteins. Continued development of these methods allows for large-scale screening, resulting in vast amounts of peptide sequences, potentially containing information on multiple protein-protein interactions. Processing of such datasets is a complex but essential task for large-scale studies investigating protein-protein interactions.</p>
      <p><bold>Results:</bold> The software tool presented in this article is able to rapidly identify multiple clusters of sequences carrying shared specificity motifs in massive datasets from various sources and generate multiple sequence alignments of identified clusters. The method was applied on a previously published smaller dataset containing distinct classes of ligands for SH3 domains, as well as on a new, an order of magnitude larger dataset containing epitopes for several monoclonal antibodies. The software successfully identified clusters of sequences mimicking epitopes of antibody targets, as well as secondary clusters revealing that the antibodies accept some deviations from original epitope sequences. Another test indicates that processing of even much larger datasets is computationally feasible.</p>
      <p><bold>Availability and implementation:</bold> Hammock is published under GNU GPL v. 3 license and is freely available as a standalone program (from <ext-link ext-link-type="uri" xlink:href="http://www.recamo.cz/en/software/hammock-cluster-peptides/">http://www.recamo.cz/en/software/hammock-cluster-peptides/</ext-link>) or as a tool for the Galaxy toolbox (from <ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/hammock/hammock">https://toolshed.g2.bx.psu.edu/view/hammock/hammock</ext-link>). The source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/hammock-dev/hammock/releases">https://github.com/hammock-dev/hammock/releases</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>muller@mou.cz</email>
      </p>
      <p><bold>Supplementary</bold><bold>information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Molecular interactions between proteins occur ubiquitously in cells and play central roles in most biological processes. These interactions are often mediated by short linear motifs located in disordered regions on the surface of one of the interacting partners (<xref rid="btv522-B8" ref-type="bibr">Dinkel <italic>et</italic>
<italic>al.</italic>, 2013</xref>). The functional and evolutionary importance of this kind of interaction is substantial (<xref rid="btv522-B15" ref-type="bibr">Kim <italic>et</italic>
<italic>al.</italic>, 2014</xref>). To investigate linear motif-mediated binding interactions, several experimental methods utilize short peptides to mimic structural properties of interacting proteins. Libraries containing very large numbers of such short peptide sequences can be generated easily and used to discover interaction preferences of proteins. These methods include phage display (<xref rid="btv522-B5" ref-type="bibr">Bratkovič, 2009</xref>) or other display-based methods, as well as technologies utilizing peptide microarrays (<xref rid="btv522-B13" ref-type="bibr">Halperin <italic>et</italic>
<italic>al.</italic>, 2010</xref>; <xref rid="btv522-B17" ref-type="bibr">Legutki <italic>et</italic><italic> al.</italic>, 2010</xref>; <xref rid="btv522-B26" ref-type="bibr">Stiffler <italic>et </italic><italic>al.</italic>, 2007</xref>).</p>
    <p>Such high-throughput methods are capable of generating huge amounts of data. The identification of true binding motifs within large datasets is a challenging task for several reasons. First, binding motifs are typically short and weak (<xref rid="btv522-B3" ref-type="bibr">Andreatta <italic>et</italic>
<italic>al.</italic>, 2012</xref>), second, experimental origin of the data imposes the possibility of fair level of noise and most remarkably, multiple binding motifs are often contained within the data. The occurrence of more than one motif may be caused by true poly-specificity of the target, as well as by experimental imperfections. In the case of phage display, two main issues may occur. The first problematic phenomenon is nonspecific adsorption of phages to surfaces that were used to immobilize target proteins, and the second issue is caused by differences in phages’ propagation capabilities—phages may be selected on the basis of their growth capacity, rather than their binding affinity to the target (<xref rid="btv522-B7" ref-type="bibr">Derda <italic>et al.</italic>, 2011</xref>; <xref rid="btv522-B14" ref-type="bibr">Huang <italic>et</italic>
<italic>al.</italic>, 2011</xref>).</p>
    <p>With low-cost high-throughput methods, such as Next-Generation sequencing of phage display libraries, it is possible to obtain up to millions of unique peptide sequences (<xref rid="btv522-B19" ref-type="bibr">Matochko <italic>et</italic>
<italic>al.</italic>, 2012</xref>). It is therefore reasonable to think of even more complicated experiments, aiming to discover multiple binding specificities of protein complexes or even whole mixtures of proteins at once. Such an experimental setup would mean an even greater number of true motifs to be identified and, generally, much more data to be processed, demanding not only better sensitivity but also adequate computational efficiency of methods employed.</p>
    <p>Significant effort has already been put into the development of software methods for peptide data processing. Part of these tools aim to process problem-specific data, e.g. to predict binding targets of MHC molecules. These approaches utilize various techniques, including hidden Markov models (HMMs, <xref rid="btv522-B22" ref-type="bibr">Noguchi <italic>et</italic>
<italic>al.</italic>, 2002</xref>), Gibbs sampling (<xref rid="btv522-B21" ref-type="bibr">Nielsen <italic>et</italic>
<italic>al.</italic>, 2004</xref>) and artificial neural networks (<xref rid="btv522-B20" ref-type="bibr">Nielsen and Lund, 2009</xref>). It has been shown that domains interacting with short peptides are often poly-specific, which leads to correlations between residue positions of recognized motifs (<xref rid="btv522-B10" ref-type="bibr">Gfeller <italic>et</italic>
<italic>al.</italic>, 2011</xref>). Therefore, even for a single recognition domain, it is necessary to capture these correlations, which can be done either directly, with the use of, e.g. artificial neural networks (<xref rid="btv522-B2" ref-type="bibr">Andreatta <italic>et</italic>
<italic>al.</italic>, 2011</xref>), or indirectly, by describing one motif with correlated positions by several motifs with uncorrelated positions (<xref rid="btv522-B10" ref-type="bibr">Gfeller <italic>et</italic>
<italic>al.</italic>, 2011</xref>). The second approach is implemented in tools using multiple position-weight matrices (also known as position-specific scoring matrices) to represent multiple specificity profiles obtained by various techniques, e.g. mixture model optimization (<xref rid="btv522-B16" ref-type="bibr">Kim <italic>et</italic>
<italic>al.</italic>, 2011</xref>) or Gibbs sampling (<xref rid="btv522-B3" ref-type="bibr">Andreatta <italic>et</italic>
<italic>al.</italic>, 2012</xref>). These tools try to be versatile and allow for peptide data from any biological source to be processed, but may require some prior data knowledge, such as the number of clusters to identify.</p>
    <p>Although tools mentioned above perform well on smaller datasets of up to thousands of sequences, they have not been designed to process datasets orders of magnitude larger. In this article, we address this issue by introducing Hammock, a novel software tool for peptide sequence clustering. Hammock uses profile HMMs for precise computational representation of sequence motifs and is based on the idea of progressive cluster growth. The three key properties of this approach are (i) the ability to process very large datasets, (ii) the ability to identify multiple distinct motifs within one dataset and (iii) versatility, as no limits are put on the origin of the data, and no prior data knowledge is required.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>Hammock performs several clustering steps to identify clusters of sequences sharing a motif and generate a multiple sequence alignment of each cluster. As noise often occurs, the result also contains a set of (unaligned) sequences not belonging to any cluster. Hammock utilizes HMMs to efficiently represent whole clusters of sequences at once and makes use of modern multicore processors, as all steps are parallelized.</p>
    <p>The algorithm is based on the idea of progressive cluster growth. At first, small clusters of highly similar sequences are identified, while sequences not belonging to any cluster form a set called the sequence pool. Next, two alternating steps are performed iteratively: the cluster extension step, in which sequences from the pool are inserted into clusters, and the cluster merging step, in which whole clusters are compared and merged. As the extension and merging steps are repeated, sequence-cluster and cluster-cluster similarity requirements are gradually relaxed. This leads to progressive motif discovery. At the beginning, sequence differences within a cluster are minor, and most positions are highly conserved. Later, when more sequences are added, less conserved positions emerge and sequences carrying appropriate residues on conserved positions, but possibly different residues on other positions, are allowed to join the cluster. The idea of progressive cluster growth is similar to principles used in tools aiming to identify distantly related sequences in a database, such as PSI-BLAST (<xref rid="btv522-B1" ref-type="bibr">Altschul, 1997</xref>) and jackhmmer from the Hmmer package (<xref rid="btv522-B9" ref-type="bibr">Finn <italic>et</italic>
<italic>al.</italic>, 2011</xref>). The key differences between these tools and Hammock are (i) Hammock starts the iterative procedure from multiple clusters, so it performs multiple database (the sequence pool) searches in parallel; (ii) Hammock starts the iterative procedure from clusters of sequences, not from a single sequence and (iii) Hammock performs the merging step. <xref ref-type="fig" rid="btv522-F1">Figure 1</xref> shows the workflow of the algorithm.
<fig id="btv522-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Hammock algorithm workflow. After the extraction of unique sequences, Hammock uses fast greedy clustering algorithm to identify initial cluster cores. The extension step adds more sequences into clusters and the merging step merges several clusters into one. The extension and merging steps are alternated several times with similarity requirements gradually relaxed. After the last merging step, resulting clusters and sequences not belonging to any cluster are reported</p></caption><graphic xlink:href="btv522f1p"/></fig></p>
    <sec>
      <title>2.1 Steps of the algorithm</title>
      <sec>
        <title>2.1.1 Pre-processing</title>
        <p>Input data may contain multiplicities; therefore, a set of unique sequences is generated first. However, the number of times each unique sequence occurred is preserved and forms part of the final output. Moreover, Hammock supports the concept of sequence labels. Each occurrence of a sequence may optionally have a label associated, so that the information on how many times each unique sequence occurred with each label is available. The motivation for sequence labels is to offer the possibility of structuring datasets. A label may, e.g. constitute one selection or amplification round of a phage display experiment, in which phages were sequenced in several phases of the experiment.</p>
      </sec>
      <sec>
        <title>2.1.2 Initial greedy clustering</title>
        <p>Initial clustering step identifies rather small groups of very similar sequences. To reduce computational complexity, a greedy incremental algorithm is employed. The approach is similar to algorithms used in tools for database complexity reduction (<xref rid="btv522-B18" ref-type="bibr">Li <italic>et</italic>
<italic>al.</italic>, 2001</xref>). Sequences are first sorted by some criteria (copy number, alphabetic or random) and the first sequence becomes the representative of the first cluster. Starting from the second sequence, each sequence is compared to all current representatives. It then joins the cluster containing the most similar representative, if this similarity reaches a pre-defined threshold. Otherwise, it becomes the representative of a new cluster. To compute a similarity score, limited alignment without inner gaps and with limited maximal number of trailing gaps is performed. A substitution matrix is used to compute alignment scores.</p>
      </sec>
      <sec>
        <title>2.1.3 Cluster selection and alignment</title>
        <p>Initial clustering results in a number of rather small clusters. Only a portion of this set is used in the next steps and the decision which clusters to use is based on their size. Remaining clusters are not treated as clusters any more and from this point on, sequences contained in them form the sequence pool.</p>
        <p>Multiple sequence alignments of all selected clusters are generated using limited alignments produced by greedy clustering.</p>
      </sec>
      <sec>
        <title>2.1.4 Cluster extension</title>
        <p>In this step, each cluster is represented with a profile HMM, which is then used to search the sequence pool for similar sequences and any sequences identified are added into an appropriate cluster.</p>
        <p>Hmmer (<xref rid="btv522-B9" ref-type="bibr">Finn <italic>et</italic>
<italic>al.</italic>, 2011</xref>) is used for both HMM construction (<italic>hmmbuild</italic> routine) and sequence search (<italic>hmmsearch</italic> routine). Local alignments are performed. Inserted sequences must be added into multiple sequence alignments. Clustal Omega (<xref rid="btv522-B23" ref-type="bibr">Sievers <italic>et</italic>
<italic>al.</italic>, 2011</xref>) is used for this purpose. To increase resulting MSA quality, sequences are aligned to complete MSA one by one, starting from the sequence with the highest similarity score.</p>
      </sec>
      <sec>
        <title>2.1.5 Cluster merging</title>
        <p>As the initial greedy clustering step is quite restrictive, some clusters may be very similar to each other. During the merging step, groups of similar clusters are identified and merged into one larger cluster. Local HMM-HMM alignment routine provided by HH-suite (<xref rid="btv522-B24" ref-type="bibr">Soding, 2004</xref>) is used to measure cluster-cluster similarity.</p>
        <p>The cluster merging step is a bottom-up hierarchical clustering process, where clusters are progressively merged. Starting from a set of clusters <italic>S</italic>, clustering scheme works as follows:</p>
        <p>First, all versus all comparisons are performed. Cluster pairs having score above a pre-defined threshold are inserted into a list <italic>Q.</italic> Iterative process then starts—cluster pair <inline-formula><mml:math id="MM1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with the highest score is removed from <italic>Q</italic>, along with any other pairs containing <italic>C<sub>k</sub></italic> or <italic>C<sub>l</sub>.</italic>
<italic>C<sub>k</sub></italic> and <italic>C<sub>l</sub></italic> are removed from <italic>S</italic> and merged into a new cluster <italic>C<sub>n</sub></italic>, which is inserted into <italic>S.</italic>
<italic>C<sub>n</sub></italic> is compared with all the other clusters in <italic>S</italic> and any resulting pairs having the score above the threshold are inserted into <italic>Q.</italic> This process is repeated until there are no cluster pairs in <italic>Q.</italic></p>
        <p>The hierarchic clustering algorithm runs in <inline-formula><mml:math id="MM2"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and guarantees optimal results by merging only the most similar cluster pair in every step. It also ensures that no cluster pair with similarity score above the threshold is left unmerged.</p>
      </sec>
      <sec>
        <title>2.1.6 Cluster merging heuristic speedup</title>
        <p>A heuristic approach may be applied to speed the merging step up. The idea lies in pre-identification of groups of potentially similar clusters. The cluster merging algorithm is then applied only within these groups.</p>
        <p>To identify such groups, the algorithm re-uses the information computed in the previous cluster extension step. For every cluster, a set of (distantly) similar sequences satisfying a separate, pre-defined similarity threshold is computed. If the sets of sequences distantly similar to clusters <italic>A</italic> and <italic>B</italic> have non-empty overlap, <italic>A</italic> and <italic>B</italic> are marked as <italic>directly similar.</italic> The transitive closure of <italic>direct similarity</italic> relation is called <italic>indirect similarity</italic>, i.e. clusters <italic>X</italic> and <italic>Y</italic> are <italic>indirectly similar</italic>, if there are some clusters <inline-formula><mml:math id="MM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mn>...</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> such that <italic>X</italic> is <italic>directly similar</italic> to <italic>L</italic><sub>1</sub>, <italic>L</italic><sub>1</sub> is <italic>directly similar</italic> to <italic>L</italic><sub>2</sub> etc. and <italic>L<sub>m</sub></italic> is <italic>directly similar</italic> to <italic>Y.</italic> A group of potentially similar clusters is then defined as such group where every cluster is <italic>indirectly similar</italic> to each other.</p>
        <p>The cluster merging algorithm is performed within each group of potentially similar clusters. Although resulting time complexity stays the same, time requirements are typically reduced for two reasons: First, some groups of potentially similar clusters may contain one cluster only, for which no comparisons will be performed. Second, as the merging routine runs in quadratic time, the computation benefits from the division into subgroups. On the other hand, this approach no longer guarantees optimal results and may lead to less clusters being merged, compared with the full cluster merging routine.</p>
      </sec>
      <sec>
        <title>2.1.7 Iterating the extension and merging steps</title>
        <p>The extension and merging steps are repeated (three times by default). As the heuristic merging speedup may lead to less clusters being merged, complete cluster merging procedure is performed in the last round, when there are less clusters and therefore time requirements are reduced.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Cluster diversity control</title>
      <p>In every step, HMM match states are by default defined as alignment columns having less than 5% gaps and minimal information content of 1.2. For clusters not to become too diverse, a minimal number of HMM match states (4 by default) is maintained. The total number of positions and the number of inner gaps in clusters’ multiple sequence alignments are also limited. If two clusters are about to be merged or a sequence is about to be inserted into a cluster, but the resulting cluster would not satisfy these constraints, the insertion or merging is not performed. These checks assure that no cluster can become overly diverse in any step.</p>
    </sec>
    <sec>
      <title>2.3 Implementation</title>
      <p>Hammock is implemented on the Java platform. External programs (Clustal Omega, Hmmer, HH-suite) are compiled separately and called from within the Java code as external processes.</p>
    </sec>
    <sec>
      <title>2.4 Galaxy implementation</title>
      <p>To offer a GUI and server functionality, a XML wrapper was created to allow Hammock to be used as a tool in the Galaxy toolbox (<xref rid="btv522-B11" ref-type="bibr">Giardine, 2005</xref>; <xref rid="btv522-B12" ref-type="bibr">Goecks <italic>et</italic>
<italic>al.</italic>, 2010</xref>). The wrapper also ensures easy installation by automatically downloading all external components from online sources.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Hammock was used to process two datasets of different sizes and complexities. Another collection of large, both real and simulated datasets was utilized to investigate computation time requirements. To maintain consistency, we present results obtained by runs with default parameters. To visualize multiple sequence alignments of resulting clusters, we use sequence logos generated by WebLogo 3.4 (<xref rid="btv522-B6" ref-type="bibr">Crooks, 2004</xref>) throughout the article. Only alignment columns containing less than 50% gaps are shown.</p>
    <sec>
      <title>3.1 Human SH3 domain</title>
      <p>This rather small dataset comprises 2457 sequences from a phage display experiment, and it was previously used in two studies aiming for the development of peptide clustering and multiple specificity identification tools (<xref rid="btv522-B3" ref-type="bibr">Andreatta <italic>et</italic>
<italic>al.</italic>, 2012</xref>; <xref rid="btv522-B16" ref-type="bibr">Kim <italic>et</italic>
<italic>al.</italic>, 2011</xref>). It contains sequences binding to Src SH3 domain, which is known to possess binding specificities of both class I SH3 domains (motif [R/K]xxPxxP) and class II SH3 domains (motif PxxPx[R/K]). Apart from sequences carrying these motifs, the dataset also contains noise.</p>
      <p>Hammock successfully identified two clusters, each consisting of sequences carrying a binding motif corresponding to canonical motif of one SH3 domain class. With default parameters, these are the only clusters reported in final results. Class I cluster contains 1738 sequences, class II cluster 415 sequences and 304 sequences were not assigned to any cluster. Sequence logos of these clusters are shown in <xref ref-type="fig" rid="btv522-F2">Figure 2</xref>.
<fig id="btv522-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Sequence logos of resulting clusters carrying the SH3 domain binding motifs. Cluster carrying class I motif (top) contains 1738 sequences, and cluster carrying class II motif (bottom) contains 415 sequences</p></caption><graphic xlink:href="btv522f2p"/></fig></p>
    </sec>
    <sec>
      <title>3.2 Monoclonal antibodies</title>
      <p>To investigate the tool’s performance on a more complex dataset, a phage display experiment examining three monocolonal antibodies (CHIP 3.1, EEV1‐2.1 and DO.1) was performed. Three rounds of selection and two rounds of amplification were performed, and phages were sequenced after each round of selection or amplification using Illumina HiSeq instrument. In total, 74 041 unique sequences were obtained. The total sequence copy number was 389 873. Sequences were divided into 15 groups (three selection and two amplification groups for each of three antibodies). See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Section S2</ext-link> for experimental design details.</p>
      <p>The motivation for sequencing after each round of selection or amplification lies in the effort to detect experimental artifacts and understand the whole process of the phage display experiment. It was shown that some phages may evince nonspecific binding to surfaces used for immobilization of target molecules, while others may possess exceptional ability to amplify in bacteria. These two categories of phages are then present in the data, regardless of their actual binding affinity to target molecules. In terms of sums of sequence copy numbers, clusters consisting of sequences binding non-specifically should be significantly increased in size in selection rounds for all antibodies. Clusters housing sequences of phages with exceptional amplification ability should be increased in size in all amplification rounds. On the contrary, cluster diversity (i.e. the number of unique sequences within a cluster) is expected to decrease gradually, as each round of both selection and amplification eliminates several non-binding or non-amplifying clones.</p>
      <p>The dataset was clustered using Hammock with default parameters, which resulted in 74 clusters, together containing 14 421 (19.5% of the dataset) unique sequences with the copy number sum of 316 119 (81.1% of the dataset). There are 14 clusters containing each at least 1% of the dataset’s copy number sum and these together contain 81.9% of all sequences contained in clusters. A heatmap visualizing the sums of copy numbers of sequences in each category for each of 14 largest clusters is shown in <xref ref-type="fig" rid="btv522-F3">Figure 3</xref>. For detailed information on all 74 clusters, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Table S1</ext-link>.
<fig id="btv522-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>A heatmap of sequence occurrences in all categories for 14 of the largest clusters. Each row represents a category profile corresponding to one cluster (cluster ids are listed on the right side) and each column represents one category. There are 15 categories—three antibodies, for each antibody three selection rounds (S1, S2 and S3) and two amplification rounds (A1, A2). The heatmap is normalized for category. A row dendrogram is generated on the basis of row correlation [the distance between rows <italic>v</italic><sub>1</sub> and <italic>v</italic><sub>2</sub> is <inline-formula><mml:math id="MM4"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>cor</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>], where cor is the Pearson correlation coefficient). Four major groups of category profiles [(a), (b), (c) and (d)] are highlighted</p></caption><graphic xlink:href="btv522f3p"/></fig></p>
      <p>The heatmap shows four major groups of cluster category profiles. Three groups evince the behavior expected for true binders to a single antibody—majority of sequences occur in categories corresponding to a single antibody, and relative cluster sizes are significantly increased in selection rounds. Each of these groups contains one large cluster and several smaller secondary clusters. According to the heatmap, cluster 4 should contain sequences binding to CHIP 3.1, cluster 21 binders to EEV1‐2.1 and cluster 2 binders to DO.1. On the contrary, the fourth group containing large cluster 1 and four smaller clusters evince the behavior expected for sequences with exceptional ability to multiply—large amounts of sequences appear in categories corresponding to all antibodies and cluster size is significantly increased in amplification rounds. Sequence logos of the major cluster and one secondary cluster (the closest one according to row correlation) for each of four groups are shown in <xref ref-type="fig" rid="btv522-F4">Figure 4</xref>.
<fig id="btv522-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Sequence logos of clusters from four groups of category profiles. For each group, the largest cluster and the cluster closest to it (in terms of category profile correlation) are displayed. Based on expected behavior, group (<bold>a</bold>) corresponds to sequences binding to DO.1, group (<bold>b</bold>) to sequences binding to CHIP 3.1, group (<bold>c</bold>) to sequences with exceptional ability to multiply and group (<bold>d</bold>) to sequences binding to EEV1‐2.1</p></caption><graphic xlink:href="btv522f4p"/></fig></p>
      <p>Sequence logos of clusters 2, 4 and 21 show strong sequence similarity to regions of actual targets of examined antibodies (listed in <xref ref-type="table" rid="btv522-T1">Table 1</xref>). This fact confirms that these clusters contain sequences actually binding the antibodies and so that the motifs correspond to antibody epitopes. In the case of DO.1, independent studies are available, confirming that cluster 2 carries the actual sequence of the epitope (<xref rid="btv522-B25" ref-type="bibr">Stephen <italic>et al.</italic>, 1995</xref>; <xref rid="btv522-B27" ref-type="bibr">Vojtesek <italic>et</italic>
<italic>al.</italic>, 1992</xref>). Moreover, secondary clusters 10, 6 and 40 possess similar motifs, which means that these clusters contain sequences that mimic the same epitope. Sequence differences between the main and secondary clusters suggest that the antibodies are able to tolerate small deviations from the epitope sequences of their actual targets. Clusters having category profiles with lower correlation to main clusters 2, 4 and 21 also evince lower levels of sequence similarity. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Table S2</ext-link> for complete matrix of correlations and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Figure S1</ext-link> for complete list of sequence logos of the 14 largest clusters.
<table-wrap id="btv522-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Epitopes corresponding to cluster sequence logos</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Group</th><th rowspan="1" colspan="1">Antibody</th><th rowspan="1" colspan="1">Target protein</th><th rowspan="1" colspan="1">Epitope location</th><th rowspan="1" colspan="1">Epitope seq.</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">(a)</td><td rowspan="1" colspan="1">DO-1</td><td rowspan="1" colspan="1">p53</td><td rowspan="1" colspan="1">20–25</td><td rowspan="1" colspan="1">SDLWKL</td></tr><tr><td rowspan="1" colspan="1">(b)</td><td rowspan="1" colspan="1">CHIP 3.1</td><td rowspan="1" colspan="1">CHIP</td><td rowspan="1" colspan="1">265–273</td><td rowspan="1" colspan="1">GHFDPVTRS</td></tr><tr><td rowspan="1" colspan="1">(d)</td><td rowspan="1" colspan="1">EEV1‐2.1</td><td rowspan="1" colspan="1">HSP90-alpha</td><td rowspan="1" colspan="1">535–541</td><td rowspan="1" colspan="1">KEFEGKT</td></tr></tbody></table><table-wrap-foot><fn id="btv522-TF1"><p>Locations and sequences of putative epitopes for each antibody are listed. The locations are stated in amino acid counts from the N-terminus. Sequence logos of corresponding clusters carry strong sequence similarity to these regions of the original antibody targets.</p></fn></table-wrap-foot></table-wrap></p>
      <p>The sequence logo of cluster 1 shows no significant sequence similarity to the target of any antibody. It mainly consists of a single sequence ALWPPNLHAWVP, which occurs in 56 758 copies and therefore occupies 92% of cluster 1. It constitutes 14.5% of the whole dataset, and it is the most popular sequence of all, which confirms that this sequence has exceptional ability to multiply. Clusters having a high correlation of category profiles to the profile of cluster 1 possess no significant sequence similarity to cluster 1. This fact suggests that exceptional ability to multiply is not based on one sequence motif and even completely different sequences may evince this kind of behavior.</p>
      <p>The diversity of the clusters (i.e. the number of unique sequences within a cluster) is the highest in the first selection rounds. For a majority of clusters, the differences between the numbers of unique sequences in the first selection rounds between different antibodies are minor, which indicates that the efficiency of the first round of selection was rather low. Cluster diversity generally decreases in later selection rounds, as expected. Amplification rounds always cause a big drop in cluster diversity, while in some cases, the diversity is slightly increased by the subsequent selection round. This observation is in agreement with the assumption of significant differences in phage propagation capabilities. After the amplification round, several over-amplified clones fill most of the sequencing capacity, while less popular clones become undetectable at given sequencing depth. The subsequent selection round substantially decreases the number of copies of over-amplified clones and thus allows for the detection of less frequent clones, if still present. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Figure S2</ext-link> for the heatmap of diversity of the 14 largest clusters.</p>
      <p>The sequence composition of almost all of the clusters follows the power law pattern - there are a few sequences with very high copy number and many sequences with low copy number. This pattern is also evident within the dataset as a whole. This finding is in agreement with previous findings of <xref rid="btv522-B7" ref-type="bibr">Derda <italic>et</italic>
<italic>al.</italic> (2011)</xref> and <xref rid="btv522-B19" ref-type="bibr">Matochko <italic>et</italic>
<italic>al.</italic> (2012)</xref>, who state that the distribution of sequence copy numbers in phage display experiments is far from linear.</p>
      <p>The category profiles of sequences within some clusters are not totally homogenous, which suggests that such clusters contain some noise. For example, in some cases, a sequence evincing the behavior expected for phages with exceptional ability to multiply is contained within a cluster the overall category profile of which falls into the category of true binders. This suggests that the sequence similarity of such sequence to the rest of the cluster is rather random and is not connected with any similarity in binding preferences. As these cases are quite rare, such low level of noise does not significantly affect the overall properties of the identified clusters. If more noise of this kind appears in some dataset, we suggest the user to use stricter parameters for cluster merging and extension.</p>
    </sec>
    <sec>
      <title>3.3 Comparison with existing tools</title>
      <p>To compare Hammock with the two tools mentioned before (MUSI and the Gibbs sampling tool), both the datasets were processed by all of the tools on the same high-end desktop computer (AMD-FX 9370 8-core CPU, 4.4 GHz, 32GB RAM, Linux Mint 17).</p>
      <p>As the measure of clustering quality, we use the Kullback–Leibler divergence (KLD) as defined in <xref rid="btv522-B3" ref-type="bibr">Andreatta <italic>et</italic>
<italic>al.</italic> (2012)</xref>. We state KLD calculated over both match states as defined in Hammock and over all MSA positions. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Section S1</ext-link> for precise definition and formulas used.</p>
      <p>For the SH3 dataset, the results of all runs were fairly consistent. All the tools identified the two clusters representing class I and class II domain motifs, sequence logos of corresponding clusters are very similar. Hammock removed the most sequences from dataset (304), while achieving the highest KLD.</p>
      <p>For the antibodies dataset, the Hammock parameters were left at default values (which means to search for up to 250 clusters), MUSI was set to search for up to 100 clusters (−m 100 option) and the Gibbs sampling tool was run three times, set to use the trash cluster and to start from 2, 10 and 100 clusters, respectively.</p>
      <p>Here, the differences in run times and results were substantial. While Hammock finishes in under 3 min, both the other tools need hours to finish, with the Gibbs sampling tool only being able to finish within 72 h when starting from 100 clusters. The differences in the quality of clustering results were also large. MUSI failed to report any useful information, as it puts all the 74 041 sequences in one extremely diverse cluster. The Gibbs sampling tool reported 100 clusters, but the overall KLD of this system was low compared with the result reported by Hammock, which was therefore superior in both the quality of the results and run time.</p>
      <p>Hammock removes more sequences from the result than the other tools. While this is not so significant for the (relatively clean) SH3 dataset, in case of the (very noisy) antibodies dataset, the difference is huge. Therefore, it is reasonable to think of using Hammock as a de-noising tool, i.e. to process a dataset with Hammock and use the results as an input for another tool. This approach was tested on both datasets. In case of the SH3 dataset, pre-filtering improves the quality of the results of both the tools, but neither of them achieves the KLD of Hammock alone. For the antibodies dataset, MUSI still fails to provide meaningful results and places all the sequences into one cluster, but the quality of the results obtained by the Gibbs sampling tool is competitive to Hammock and when the number of clusters reported by Hammock (74) is used as initial number of clusters for the Gibbs sampling tool, the KLD of the result is even slightly higher. This suggests that in some cases, Hammock may be used to remove noise and estimate optimal number of clusters prior to the use of some other, resource-heavy algorithm. The results of all the runs are summarized in <xref ref-type="table" rid="btv522-T2">Table 2</xref>.
<table-wrap id="btv522-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>A summary of the results obtained by running Hammock, MUSI and the Gibbs sampling tool on the SH3 and the antibodies datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Dataset</th><th rowspan="1" colspan="1">Sequences</th><th rowspan="1" colspan="1">Tool</th><th rowspan="1" colspan="1">Params</th><th rowspan="1" colspan="1">Time</th><th rowspan="1" colspan="1">No. of clusters</th><th rowspan="1" colspan="1">No. of sequences</th><th rowspan="1" colspan="1">KLD match</th><th rowspan="1" colspan="1">KLD all</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">SH3</td><td rowspan="1" colspan="1">2457</td><td rowspan="1" colspan="1">Hammock</td><td rowspan="1" colspan="1">-t 8</td><td rowspan="1" colspan="1">17 s</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2153</td><td rowspan="1" colspan="1">28.165</td><td rowspan="1" colspan="1">24.858</td></tr><tr><td rowspan="1" colspan="1">SH3</td><td rowspan="1" colspan="1">2457</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-trash</td><td rowspan="1" colspan="1">39 min 3 s</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2450</td><td rowspan="1" colspan="1">25.151</td><td rowspan="1" colspan="1">22.369</td></tr><tr><td rowspan="1" colspan="1">SH3</td><td rowspan="1" colspan="1">2457</td><td rowspan="1" colspan="1">MUSI</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">17 s</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2456</td><td rowspan="1" colspan="1">20.96</td><td rowspan="1" colspan="1">19.89</td></tr><tr><td rowspan="1" colspan="1">Antibodies</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">Hammock</td><td rowspan="1" colspan="1">-t 8</td><td rowspan="1" colspan="1">2 min 35 s</td><td rowspan="1" colspan="1">74</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">17.897</td><td rowspan="1" colspan="1">17.635</td></tr><tr><td rowspan="1" colspan="1">Antibodies</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-trash</td><td rowspan="1" colspan="1">&gt;72 h</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td></tr><tr><td rowspan="1" colspan="1">Antibodies</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-trash -g 10</td><td rowspan="1" colspan="1">&gt;72 h</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td></tr><tr><td rowspan="1" colspan="1">Antibodies</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-trash -g 100</td><td rowspan="1" colspan="1">14 h 13 min 53 s</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">74 040</td><td rowspan="1" colspan="1">12.622</td><td rowspan="1" colspan="1">11.335</td></tr><tr><td rowspan="1" colspan="1">Antibodies</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">MUSI</td><td rowspan="1" colspan="1">-m 100</td><td rowspan="1" colspan="1">8 h 20 min 1 s</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">74 041</td><td rowspan="1" colspan="1">0.0</td><td rowspan="1" colspan="1">3.22</td></tr><tr><td rowspan="1" colspan="1">SH3 filtered</td><td rowspan="1" colspan="1">2153</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">27 min 36 s</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2153</td><td rowspan="1" colspan="1">26.865</td><td rowspan="1" colspan="1">23.94</td></tr><tr><td rowspan="1" colspan="1">SH3 filtered</td><td rowspan="1" colspan="1">2153</td><td rowspan="1" colspan="1">MUSI</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">25 s</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2152</td><td rowspan="1" colspan="1">23.57</td><td rowspan="1" colspan="1">23.25</td></tr><tr><td rowspan="1" colspan="1">Antibodies filtered</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&gt;72 h</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">—</td></tr><tr><td rowspan="1" colspan="1">Antibodies filtered</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-g 10</td><td rowspan="1" colspan="1">4 h 19 min 27 s</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">10.47</td><td rowspan="1" colspan="1">12.215</td></tr><tr><td rowspan="1" colspan="1">Antibodies filtered</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-g 100</td><td rowspan="1" colspan="1">21 min 6 s</td><td rowspan="1" colspan="1">89</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">18.863</td><td rowspan="1" colspan="1">17.427</td></tr><tr><td rowspan="1" colspan="1">Antibodies filtered</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">Gibbs</td><td rowspan="1" colspan="1">-g 74</td><td rowspan="1" colspan="1">30 min 45 s</td><td rowspan="1" colspan="1">68</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">18.78</td><td rowspan="1" colspan="1">17.81</td></tr><tr><td rowspan="1" colspan="1">Antibodies filtered</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">MUSI</td><td rowspan="1" colspan="1">-m 100</td><td rowspan="1" colspan="1">2 min 25 s</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">14 421</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">2.97</td></tr></tbody></table><table-wrap-foot><fn id="btv522-TF2"><p>Runs of MUSI and the Gibbs sampling tool on these two datasets pre-filtered by Hammock are also stated. Columns are (from the left): dataset name, the number of unique sequences in the dataset, tool name, additional tool parameters, run time, number of clusters in the result, number of unique sequences in the result, KLD calculated over MSA columns defined as match stated by Hammock and KLD calculated over all MSA columns.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>3.4 Performance testing</title>
      <p>Two large peptide datasets were used to test Hammock’s time requirements. Both come from phage display experiments and contain sequences 12 amino acids long. The first is a pseudorandom dataset generated from the monoclonal antibodies dataset mentioned earlier. It contains both original sequences and sequences in which random amino acid substitutions were introduced, with respect to overall amino acid frequencies. The second dataset comes from the work of <xref rid="btv522-B19" ref-type="bibr">Matochko <italic>et</italic>
<italic>al.</italic> (2012)</xref>.</p>
      <p>Random subsets of various sizes up to 10<sup>6</sup> unique sequences were sampled from both datasets and processed by Hammock. The same desktop computer as in previous section was used. All parameters were left at default values except for cluster core selection after greedy clustering. Five percent of largest clusters were selected for further clustering in every dataset (the default is 2.5% with the maximum of 250 clusters).</p>
      <p>Run times are shown in <xref ref-type="fig" rid="btv522-F5">Figure 5</xref>. Times are fairly data dependent, run times for pseudorandom dataset are shorter. We assume that this is caused by the lack of real motifs and therefore lower complexity of this dataset.
<fig id="btv522-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Run times of random subsets of two test datasets. Subsets of up to 10<sup>6</sup> unique sequences were randomly selected from one dataset containing real phage display data and one pseudorandom dataset. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv522/-/DC1">Supplementary Table S3</ext-link> for numeric values of data points displayed in this figure</p></caption><graphic xlink:href="btv522f5p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented Hammock—a software tool for short peptide sequence clustering. The tool is able to cluster large amounts of data containing noise and to produce multiple sequence alignments of resulting clusters. The main motivation to create Hammock was to provide the ability of processing datasets originating from large-scale screening of combinatorial peptide libraries, such as phage display. Nevertheless, the tool is universal and no limits are put on the origin or format of processed data (Hammock accepts input in three formats including fasta) and no prior data knowledge, such as the number of clusters to identify, is needed. Therefore, Hammock is applicable for a range of other data sources, such as variable regions of lymphocyte receptors or viral proteins. It accepts virtually any set of peptide sequences as input.</p>
    <p>We performed a pilot large-scale phage display experiment which shows the way future experiments based on combinatorial peptide libraries could take. We demonstrated that Hammock is capable of processing data originating from such an experiment and provide valuable biological insights, even when the data contain noise. We also demonstrated Hammock’s time requirements on datasets of various sizes.</p>
    <p>Compared with existing tools, Hammock is much faster and can process datasets orders of magnitude larger, while it achieves the best quality of clustering results. Another difference is that with default parameters, Hammock may remove many sequences from the result, if they do not fit any cluster well. This feature is beneficial in the case of large and noisy datasets and can be utilized by using Hammock as a de-noising tool. On the other hand, in the case of small and clean datasets containing subtle sequence motifs only, this behavior may not be desired. It can be changed by parameter tuning, but we estimate that for such cases, some of more computationally intensive methods, such as Gibbs sampling, may be more suitable.</p>
    <p>There are a number of parameters allowing the user to influence clustering results. In this article, Hammock was shown to perform well with default parameters, but parameter tuning will often be desirable to accommodate the diverse nature of input data and the diverse spectrum of biological questions that require answering. If a strong motif and less noise is present in the dataset, or coarse-grained clustering is desired, cluster merging and extension thresholds should be lowered. If a large number of small and specialized clusters is needed, thresholds should be increased.</p>
    <p>Hammock comes as a standalone program, as well as a tool for the Galaxy toolbox. Galaxy provides a GUI, server functionalities and also an online storage called the Galaxy tool shed (<xref rid="btv522-B4" ref-type="bibr">Blankenberg <italic>et</italic>
<italic>al.</italic>, 2014</xref>), which allows any Galaxy server administrator or local instance user to install Hammock with all its dependencies just by virtually one click. The Galaxy implementation makes Hammock more user-friendly and allows for broad community of non-expert users to use it easily.</p>
    <p>In conclusion, Hammock satisfies the need for extremely large peptide datasets to be processed and thus allows for novel types of experiments based on data from various sources to be performed. The user-friendly Galaxy implementation gives the possibility to use this tool to a broad spectrum of potential users.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_1_9__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv522_supplementary.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to Dr Nikos Darzentas and Vojtech Bystry for inspiration. Access to computing and storage facilities owned by parties and projects contributing to the National Grid Infrastructure MetaCentrum, provided under the program ‘Projects of Large Infrastructure for Research, Development, and Innovations’ (LM2010005), is greatly appreciated.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by MEYS-NPS1-LO1413 and MH CZ-DRO (<funding-source>MMCI</funding-source>, <award-id>00209805</award-id>) and by GACR P206/12/G151 [to B.V. and P.M.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv522-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.</given-names></name></person-group> (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source>, <volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andreatta</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>NNAlign: a web-based prediction method allowing non-expert end-user discovery of sequence motifs in quantitative peptide data</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e26781</fpage>.<pub-id pub-id-type="pmid">22073191</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andreatta</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Simultaneous alignment and clustering of peptide data using a Gibbs sampling approach</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>8</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">23097419</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankenberg</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Dissemination of scientific software with galaxy ToolShed</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>403</fpage>.<pub-id pub-id-type="pmid">25001293</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bratkovič</surname><given-names>T.</given-names></name></person-group> (<year>2009</year>) <article-title>Progress in phage display: evolution of the technique and its applications</article-title>. <source>Cell. Mol. Life Sci.</source>, <volume>67</volume>, <fpage>749</fpage>–<lpage>767</lpage>.<pub-id pub-id-type="pmid">20196239</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crooks</surname><given-names>G.E.</given-names></name></person-group> (<year>2004</year>) <article-title>WebLogo: a sequence logo generator</article-title>. <source>Genome Res.</source>, <volume>14</volume>, <fpage>1188</fpage>–<lpage>1190</lpage>.<pub-id pub-id-type="pmid">15173120</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derda</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Diversity of phage-displayed libraries of peptides during panning and amplification</article-title>. <source>Molecules</source>, <volume>16</volume>, <fpage>1776</fpage>–<lpage>1803</lpage>.<pub-id pub-id-type="pmid">21339712</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dinkel</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>The eukaryotic linear motif resource ELM: 10 years and counting</article-title>. <source>Nucleic Acids Res.</source>, <volume>42</volume>, <fpage>D259</fpage>–<lpage>D266</lpage>.<pub-id pub-id-type="pmid">24214962</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finn</surname><given-names>R.D.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>HMMER web server: interactive sequence similarity searching</article-title>. <source>Nucleic Acids Res.</source>, <volume>39</volume>(<issue>suppl</issue>), <fpage>W29</fpage>–<lpage>W37</lpage>.<pub-id pub-id-type="pmid">21593126</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gfeller</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>The multiple-specificity landscape of modular peptide recognition domains</article-title>. <source>Mol. Syst. Biol.</source>, <volume>7</volume>, <fpage>484</fpage>.<pub-id pub-id-type="pmid">21525870</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giardine</surname><given-names>B.</given-names></name></person-group> (<year>2005</year>) <article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title>. <source>Genome Res.</source>, <volume>15</volume>, <fpage>1451</fpage>–<lpage>1455</lpage>.<pub-id pub-id-type="pmid">16169926</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goecks</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R86</fpage>.<pub-id pub-id-type="pmid">20738864</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halperin</surname><given-names>R.F.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Exploring antibody recognition of sequence space through random-sequence peptide microarrays</article-title>. <source>Mol. Cell. Proteomics</source>, <volume>10</volume>, <comment>M110.000786</comment>.</mixed-citation>
    </ref>
    <ref id="btv522-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Bioinformatics resources and tools for phage display</article-title>. <source>Molecules</source>, <volume>16</volume>, <fpage>694</fpage>–<lpage>709</lpage>.<pub-id pub-id-type="pmid">21245805</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Linear motif-mediated interactions have contributed to the evolution of modularity in complex protein interaction networks</article-title>. <source>PLoS Comput. Biol.</source>, <volume>10</volume>, <fpage>e1003881</fpage>.<pub-id pub-id-type="pmid">25299147</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>MUSI: an integrated system for identifying multiple specificity from very large peptide or nucleic acid data sets</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e47</fpage>.<pub-id pub-id-type="pmid">22210894</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Legutki</surname><given-names>J.B.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>A general method for characterization of humoral immunity induced by a vaccine or infection</article-title>. <source>Vaccine</source>, <volume>28</volume>, <fpage>4529</fpage>–<lpage>4537</lpage>.<pub-id pub-id-type="pmid">20450869</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2001</year>) <article-title>Clustering of highly homologous sequences to reduce the size of large protein databases</article-title>. <source>Bioinformatics</source>, <volume>17</volume>, <fpage>282</fpage>–<lpage>283</lpage>.<pub-id pub-id-type="pmid">11294794</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matochko</surname><given-names>W.L.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Deep sequencing analysis of phage libraries using illumina platform</article-title>. <source>Methods</source>, <volume>58</volume>, <fpage>47</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">22819855</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>M.</given-names></name><name><surname>Lund</surname><given-names>O.</given-names></name></person-group> (<year>2009</year>) <article-title>NN-align. an artificial neural network-based alignment algorithm for MHC class II peptide binding prediction</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>296</fpage>.<pub-id pub-id-type="pmid">19765293</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>Improved prediction of MHC class i and class II epitopes using a novel Gibbs sampling approach</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>1388</fpage>–<lpage>1397</lpage>.<pub-id pub-id-type="pmid">14962912</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noguchi</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>Hidden Markov model-based prediction of antigenic peptides that interact with MHC class II molecules</article-title>. <source>J. Biosci. Bioeng.</source>, <volume>94</volume>, <fpage>264</fpage>–<lpage>270</lpage>.<pub-id pub-id-type="pmid">16233301</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sievers</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using clustal omega</article-title>. <source>Mol. Syst. Biol.</source>, <volume>7</volume>, <fpage>539</fpage>.<pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soding</surname><given-names>J.</given-names></name></person-group> (<year>2004</year>) <article-title>Protein homology detection by HMM-HMM comparison</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>951</fpage>–<lpage>960</lpage>.<pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephen</surname><given-names>C.W.</given-names></name><etal/></person-group> (<year>1995</year>) <article-title>Characterisation of epitopes on human p53 using phage-displayed peptide libraries: insights into antibody-peptide interactions</article-title>. <source>J. Mol. Biol.</source>, <volume>248</volume>, <fpage>58</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">7537340</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stiffler</surname><given-names>M.A.</given-names></name><etal/></person-group> (<year>2007</year>) <article-title>PDZ domain binding selectivity is optimized across the mouse proteome</article-title>. <source>Science</source>, <volume>317</volume>, <fpage>364</fpage>–<lpage>369</lpage>.<pub-id pub-id-type="pmid">17641200</pub-id></mixed-citation>
    </ref>
    <ref id="btv522-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vojtesek</surname><given-names>B.</given-names></name><etal/></person-group> (<year>1992</year>) <article-title>An immunochemical analysis of the human nuclear phosphoprotein p53</article-title>. <source>J. Immunol. Methods</source>, <volume>151</volume>, <fpage>237</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">1378473</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
