<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6933643</article-id>
    <article-id pub-id-type="publisher-id">3301</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3301-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LEMON: a method to construct the local strains at horizontal gene transfer sites in gut metagenomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Chen</given-names>
        </name>
        <address>
          <email>lic_zju@hotmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Yiqi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Shuaicheng</given-names>
        </name>
        <address>
          <email>shuaicli@cityu.edu.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1792 6846</institution-id><institution-id institution-id-type="GRID">grid.35030.35</institution-id><institution>Department of Computer Science, City University of Hong Kong, </institution></institution-wrap>Kowloon, Hong Kong SAR, HongKong, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 23</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. Supplement Editors were not responsible for the review of papers they had authored. No other competing interests were declared.</issue-sponsor>
    <elocation-id>702</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Horizontal Gene Transfer (HGT) refers to the transfer of genetic materials between organisms through mechanisms other than parent-offspring inheritance. HGTs may affect human health through a large number of microorganisms, especially the gut microbiomes which the human body harbors. The transferred segments may lead to complicated local genome structural variations. Details of the local genome structure can elucidate the effects of the HGTs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this work, we propose a graph-based method to reconstruct the local strains from the gut metagenomics data at the HGT sites. The method is implemented in a package named LEMON. The simulated results indicate that the method can identify transferred segments accurately on reference sequences of the microbiome. Simulation results illustrate that LEMON could recover local strains with complicated structure variation. Furthermore, the gene fusion points detected in real data near HGT breakpoints validate the accuracy of LEMON. Some strains reconstructed by LEMON have a replication time profile with lower standard error, which demonstrates HGT events recovered by LEMON is reliable.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Through LEMON we could reconstruct the sequence structure of bacteria, which harbors HGT events. This helps us to study gene flow among different microbial species.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>HGT</kwd>
      <kwd>Local strain</kwd>
      <kwd>Gut metagenomics</kwd>
      <kwd>Graph</kwd>
    </kwd-group>
    <conference xlink:href="https://www.abacbs.org/conference2019/about">
      <conf-name>Joint 30th International Conference on Genome Informatics (GIW) &amp; Australian Bioinformatics and Computational Biology Society (ABACBS) Annual Conference</conf-name>
      <conf-loc>Sydney, Australia</conf-loc>
      <conf-date>9-11 December 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Horizontal Gene Transfer [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] is the movement of genetic materials between organisms other than by the vertical transmission of DNA from parent to offspring [<xref ref-type="bibr" rid="CR3">3</xref>]. HGTs allow different species to share genomic fragments. Abundant evidence from genomic data now supports that HGT plays an important role in evolution. They are a prevalent and pervasive phenomenon in prokaryotes and are an important source of genomic innovation in bacteria. They are also often observed in unicellular eukaryotes. Recent research suggests that on average 81% of prokaryotes genes have been involved in HGT at some point in their history [<xref ref-type="bibr" rid="CR4">4</xref>]. Their occurrences in multicellular eukaryotes are rare. However, several significant HGTs are still observed between bacteria and multicellular eukaryotes. Some are even common in specific environments. For example, we have observed HGTs from bacteria to fungi, from bacteria to the coffee borer beetle [<xref ref-type="bibr" rid="CR5">5</xref>], as well as from virus, bacteria, and fungi to animals [<xref ref-type="bibr" rid="CR6">6</xref>]. These recent discoveries have reshaped our understanding of evolutionary mechanisms.</p>
    <p>HGTs may affect human health through a large number of human microbiota [<xref ref-type="bibr" rid="CR7">7</xref>], including bacteria, fungi, archaea, and virus. They widely spread on human biofluids and tissues, such as skin, lung, mouth. They are often associated with a range of human diseases and health conditions, from diabetes, colorectal cancer, to autism. The Human Microbiome Project [<xref ref-type="bibr" rid="CR8">8</xref>] was launched in 2008 to study and understand the human microbiota. Some functions of the human microbiome, including antibiotic resistance and adaption to nutrients [<xref ref-type="bibr" rid="CR9">9</xref>], are susceptible to HGT events. Mediated by phage, HGT in S.aureus occurs 1000 times more often than was thought, which greatly accelerates S.aureus to evolve resistance to antibiotics [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p>It is necessary to understand HGTs better. However, our current research is mainly focused on inferring ancient (lineage) HGTs from genomic sequences [<xref ref-type="bibr" rid="CR11">11</xref>]. While the inference result is seriously affected by complex external factors [<xref ref-type="bibr" rid="CR12">12</xref>]. For example, during the process of evolution, the transferred genome segments had been subjected to loss, mutation and duplication [<xref ref-type="bibr" rid="CR13">13</xref>]. The inserted genes may also change the expression and functions of the gene around the insertion sites, resulting in very complicated structural variations [<xref ref-type="bibr" rid="CR14">14</xref>], and temper with the receptor genome’s stabilities [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. These possibilities complicate our detection of the HGTs. Better results can be achieved if we can anticipate these changes and correct for their effects. Recent efforts in human microbiomes provide us with such an opportunity.</p>
    <p>LEMON(<ext-link ext-link-type="uri" xlink:href="https://github.com/lichen2018/LEMON">https://github.com/lichen2018/LEMON</ext-link>) takes use of existing shotgun NGS datasets to detect HGT breakpoints, identify the transferred segments, and reconstruct the local strain, which has complicated structure variation.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p>HGT events result in the integration of DNA segments from one species to another species, which will generate local strains containing DNA segments from different species. Figure <xref rid="Fig1" ref-type="fig">1</xref>. illustrates the workflow of LEMON.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of reconstructing HGT strains from pair-ends shotgun reads. Firstly, we map paired-end shotgun reads against reference genomes using Burrows Wheeler Aligner (BWA). Then, we select junction reads, whose two sides are mapped to two different references, from the set of mapped reads. Thirdly, by treating junction reads as points on a two-dimensional plane, we apply Density-Based Spatial Clustering of Applications with Noise (DBSCAN) to find candidate HGT breakpoints. Fourthly, we utilize split reads to get the exact positions of HGT breakpoints. Fifthly, according to the detected breakpoints, we could split references into segments, which are linked by junction reads. The coverage of each segment is calculated according to the number of mapped reads on it. Sixthly, we utilize the linked segments to construct a connected graph. By inserting dummy edges, we make the graph fully connected. Seventhly, we balance the coverage of each segment. Finally, we traverse the graph to find local strains. Each local strain should start from the first segment of one receptor and end with the last segment of the same receptor</p></caption><graphic xlink:href="12859_2019_3301_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>References</title>
      <p>Only the assembly results from multiple time-point metagenomics data of one individual can be used to discover the HGT events that exactly occurred between these time points. However, these samples are insufficient in published data, and this method cannot evaluate the difference in HGT events between different samples. To solve this problem, we construct a <italic>reference set</italic><italic>S</italic>. We collected all of the bacterial genomes from the National Center for Biotechnology Information (NCBI) [<xref ref-type="bibr" rid="CR18">18</xref>]. We selected one genome for each taxonomy as a representative genome to reduce the interference from homologous regions based on (1) the genome was annotated as reference or representative by NCBI; (2) or the one has minimal scaffolds number and highest completeness with contamination &lt;10% in The Genome Taxonomy Database (GTDB) taxonomy evaluation results for 109,419 bacterial genomes[<xref ref-type="bibr" rid="CR19">19</xref>]. The reference set contains 16,093 species with 1,246,881 scaffolds. Given a shotgun genomic read dataset <italic>R</italic>, we utilize BWA[<xref ref-type="bibr" rid="CR20">20</xref>] to align reads against the references to identify the set of donors and receptors involved. These references with adequately covered segments are then retained. We denote the set of donors and receptors as <italic>D</italic> and <italic>H</italic> respectively.</p>
    </sec>
    <sec id="Sec4">
      <title>Breakpoints and segments</title>
      <p>The donor segments and receptor segments interweave in a local strain, separated by HGT <italic>breakpoints</italic>. We need to identify the breakpoints and segments involved in the local strains from <italic>D</italic> and <italic>H</italic>. The data are heterogeneous. According to studies on virus integration [<xref ref-type="bibr" rid="CR21">21</xref>] and studies on gut metagenomics, breakpoints are surrounded by mutations such as Single Nucleotide Variation (SNV), Copy Number Variation (CNV), short indels and inversions [<xref ref-type="bibr" rid="CR22">22</xref>]. Hence we detect the breakpoints as follows.</p>
      <p>First, we map paired-end shotgun reads to reference genomes using BWA, here all references are indexed together to generate Burrows–Wheeler Transform (BWT) indexes. If the two sides of a paired-end read are mapped to two different references, we call such a pair a junction pair, such as junction pairs <italic>A</italic> and <italic>B</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. The mapped positions of each junction pair give us two breakpoint candidates on the respective references. The two mapped positions of each junction pair can be treated as its coordinates on a two-dimensional plane. For example, <italic>B</italic><sub><italic>x</italic></sub> and <italic>B</italic><sub><italic>y</italic></sub> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b are mapped positions of junction pair <italic>B</italic> on reference <italic>X</italic> and <italic>Y</italic> respectively. Then pair <italic>B</italic> can be transformed to the point <italic>B</italic><sup>′</sup> with coordinates (<italic>B</italic><sub><italic>x</italic></sub>,<italic>B</italic><sub><italic>y</italic></sub>) in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c. All junction pairs mapped to the same two references are transformed to points in a coordinate system with their mapped positions as coordinates. We then apply the clustering algorithm DBSCAN [<xref ref-type="bibr" rid="CR23">23</xref>] using Euclidean distance to cluster the breakpoint pair candidates. A cluster that is supported by at least one junction pair is further subjected to analysis to determine the exact positions of its breakpoints. Next, we identify the split reads which support a cluster. A read is split if it can be partitioned into two parts, with each part mapped to a different reference; we say it <italic>supports</italic> a cluster if the mapped positions belong to the cluster. Each cluster contains multiple breakpoint pair candidates.
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Some paired-end reads cross HGT breakpoints <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>. <bold>b</bold> The two sides of one junction pair are mapped to two different references. <italic>B</italic><sub><italic>x</italic></sub> and <italic>B</italic><sub><italic>y</italic></sub> are mapped positions of junction pair <italic>B</italic> on reference <italic>X</italic> and <italic>Y</italic> respectively. <bold>c</bold> Furthermore, all junction pairs mapped to the same two references are transformed to points in a coordinate system with their mapped positions as coordinates, e.g. junction pairs A and B are transformed to points <italic>A</italic><sup>′</sup>(<italic>A</italic><sub><italic>x</italic></sub>,<italic>A</italic><sub><italic>y</italic></sub>) and <italic>B</italic><sup>′</sup>(<italic>B</italic><sub><italic>x</italic></sub>,<italic>B</italic><sub><italic>y</italic></sub>). <bold>d</bold> We apply DBSCAN using Euclidean distance to cluster the breakpoint pair candidates, such as <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. The maximum diameter of the cluster circle is the insert size of pair-end reads</p></caption><graphic xlink:href="12859_2019_3301_Fig2_HTML" id="MO2"/></fig></p>
      <p>To find the exact positions, we use a scoring scheme to rank the candidate positions. The candidate with the highest score is reported as the final breakpoint pair position. The scoring scheme evaluates the split reads that support the cluster. Suppose that there are two references involved in the cluster, <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub>. Given a candidate genomic positions pair <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> which belongs to <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub>, respectively, we identify the split reads aligned to <italic>R</italic><sub>1</sub> where the alignment terminated at position <italic>p</italic><sub>1</sub>. Denote the portions of such a split read <italic>s</italic> mapped to <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub> as <italic>e</italic><sub>1</sub>(<italic>s</italic>) and <italic>e</italic><sub>2</sub>(<italic>s</italic>), respectively. Then, the score is defined according to the alignment qualities of <italic>e</italic><sub>2</sub>(<italic>s</italic>) against <italic>R</italic><sub>2</sub> nearby <italic>p</italic><sub>2</sub>. The alignment quality <italic>q</italic><sub><italic>s</italic></sub> of <italic>e</italic><sub>2</sub>(<italic>s</italic>) is calculated as <italic>m</italic>/<italic>l</italic>, where <italic>m</italic> is the number of matched positions and should be at least 15 bps, <italic>l</italic> is the length of <italic>e</italic><sub>2</sub>(<italic>s</italic>). The quality score of <italic>p</italic><sub>2</sub> is calculated as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$1-\sum _{s}\log (1-q_{s})$\end{document}</tex-math><mml:math id="M2"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq1.gif"/></alternatives></inline-formula> of the alignment qualities of the split read which supports the respective cluster. Similarly we calculate the score for <italic>p</italic><sub>1</sub>. The candidate with the highest score is reported as the final breakpoint pair positions of the cluster.</p>
      <p>Each breakpoint involves two segments. Denote the segment pair as <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\langle u^{x_{u}}, v^{x_{v}}\rangle $\end{document}</tex-math><mml:math id="M4"><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq2.gif"/></alternatives></inline-formula>, and <italic>x</italic><sub><italic>u</italic></sub>,<italic>x</italic><sub><italic>v</italic></sub>∈{+,−} where + and − respectively indicates the positive and negative strands, and <italic>u</italic>,<italic>v</italic>∈<italic>V</italic>. We call such a pair a <italic>connected pair</italic>. A connected pair is directed; that is, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\langle v^{x_{v}}, u^{x_{u}}\rangle \ne \langle u^{x_{u}},v^{x_{v}}\rangle $\end{document}</tex-math><mml:math id="M6"><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>〉</mml:mo><mml:mo>≠</mml:mo><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq3.gif"/></alternatives></inline-formula>. Denote the set of connected pairs as <italic>E</italic>, the copy number of <italic>e</italic>∈<italic>E</italic> as <italic>c</italic>(<italic>e</italic>) w.r.t. <italic>R</italic>. It is easy to see that the segments and connected pairs specify a graph <italic>G</italic> as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
    </sec>
    <sec id="Sec5">
      <title>Local strains</title>
      <p>Assume that there are <italic>k</italic> HGT events captured in <italic>G</italic>. Since each HGT event results in one local strain, there are <italic>k</italic> local strains to be constructed according to <italic>G</italic>. The first and last segments of each local strain are from the same receptor. Without loss of generality let all the first segments and the last segments of the local strains at the integration sites be denoted <italic>B</italic>={<italic>b</italic><sub>1</sub>,...,<italic>b</italic><sub><italic>k</italic></sub>}, and <italic>T</italic>={<italic>t</italic><sub>1</sub>,...,<italic>t</italic><sub><italic>k</italic></sub>}, respectively. Denote all the other segments involved in the HGTs as <italic>V</italic>={<italic>v</italic><sub>1</sub>,...,<italic>v</italic><sub><italic>n</italic></sub>} (excluding <italic>B</italic> and <italic>T</italic>). Next, we estimate the number of copies (copy number) of each segment <italic>v</italic> within <italic>R</italic>, and denote it as <italic>c</italic>(<italic>v</italic>), where <italic>v</italic>∈<italic>B</italic>∪<italic>T</italic>∪<italic>V</italic>. Factors such as species coverage are incorporated into the copy number estimation. For example, if segment <italic>v</italic><sub><italic>i</italic></sub> is belong to a receptor <italic>r</italic>, the coverage of <italic>v</italic><sub><italic>i</italic></sub> is <italic>c</italic><italic>o</italic><italic>v</italic>(<italic>v</italic><sub><italic>i</italic></sub>) and the average coverage of <italic>r</italic> is <italic>c</italic><italic>o</italic><italic>v</italic>(<italic>r</italic>), then the initial copy number of <italic>v</italic><sub><italic>i</italic></sub> is estimated as <italic>c</italic>(<italic>v</italic><sub><italic>i</italic></sub>)=<italic>c</italic><italic>o</italic><italic>v</italic>(<italic>v</italic><sub><italic>i</italic></sub>)/<italic>c</italic><italic>o</italic><italic>v</italic>(<italic>r</italic>).</p>
      <p>Our task is to identify the <italic>k</italic> local strains captured in <italic>G</italic>. <italic>B</italic> and <italic>T</italic> can be identified with the input data. We assume that the copy numbers of the first segment and the last segment are the same for each strain, that is, <italic>c</italic>(<italic>b</italic><sub><italic>i</italic></sub>)=<italic>c</italic>(<italic>t</italic><sub><italic>i</italic></sub>), without loss of generality.</p>
    </sec>
    <sec id="Sec6">
      <title>Connectivity</title>
      <p>We formulate the problem as a Eulerian circuit problem to find the <italic>k</italic> local strains.</p>
      <p>First, we insert dummy edges to transform the solution into a circuit. Without loss of generality, we assume <italic>c</italic>(<italic>b</italic><sub><italic>i</italic></sub>)=<italic>c</italic>(<italic>t</italic><sub><italic>i</italic></sub>),1≤<italic>i</italic>≤<italic>k</italic>. We insert a dummy edge <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle t_{i}^{+}, b_{i}^{+}\rangle $\end{document}</tex-math><mml:math id="M8"><mml:mo>〈</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq4.gif"/></alternatives></inline-formula> with the copy number <italic>c</italic>(<italic>b</italic><sub><italic>i</italic></sub>)−1,1≤<italic>i</italic>≤<italic>k</italic>. The edges <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle t_{i}^{+}, b_{i+1}^{+}\rangle, 1\le i\le k-1$\end{document}</tex-math><mml:math id="M10"><mml:mo>〈</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>〉</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq5.gif"/></alternatives></inline-formula>, and edge <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\langle t_{k}^{+}, b_{1}^{+}\rangle $\end{document}</tex-math><mml:math id="M12"><mml:mo>〈</mml:mo><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq6.gif"/></alternatives></inline-formula> are inserted with copy number 1.</p>
      <p>Second, we insert edges and nodes to ensure connectivity. In the ideal case, for each vertex <italic>v</italic>∈<italic>V</italic>, there should be a path that starts from a source node in <italic>S</italic>, passes through <italic>v</italic>, and ends up at some target in <italic>T</italic>. However, due to sequencing errors, edges or nodes can be missing or spuriously introduced. If no target and source can reach a node <italic>v</italic>, we remove <italic>v</italic> and its adjacent edges from <italic>G</italic>. If a path exists from some vertex <italic>s</italic> to <italic>v</italic>, but no path exists from <italic>v</italic> to a target <italic>t</italic>, we insert vertices and edges to form a path from <italic>v</italic> to <italic>t</italic>. The inserted edge candidates are taken from the reference sets <italic>D</italic> and <italic>S</italic>. If <italic>v</italic> belongs to the same reference as <italic>t</italic>, this would suffice to reconstruct the path. Otherwise, we add edges that connect <italic>v</italic> and some nodes on the reference of <italic>t</italic>. In both situations, we use the minimum number of edges required. All the introduced edges and vertex are assigned a copy number of 1.</p>
    </sec>
    <sec id="Sec7">
      <title>Balancing the graph</title>
      <p>Denote the set of inbound edges of <italic>u</italic> as <italic>i</italic><italic>n</italic>(<italic>u</italic>) and the outbound edges of <italic>u</italic> as <italic>o</italic><italic>u</italic><italic>t</italic>(<italic>u</italic>). That is, <italic>i</italic><italic>n</italic>(<italic>u</italic>)={<italic>u</italic>|(<italic>v</italic><sup><italic>x</italic></sup>,<italic>u</italic><sup>+</sup>),(<italic>u</italic><sup>−</sup>,<italic>u</italic><sup><italic>x</italic></sup>)∈<italic>E</italic>,<italic>x</italic>∈{+,−}},<italic>o</italic><italic>u</italic><italic>t</italic>(<italic>u</italic>)={<italic>u</italic>|(<italic>v</italic><sup><italic>x</italic></sup>,<italic>u</italic><sup>−</sup>),(<italic>u</italic><sup>+</sup>,<italic>v</italic><sup><italic>x</italic></sup>)∈<italic>E</italic>,<italic>x</italic>∈{+,−}}. The <italic>in-copy</italic> and and <italic>out-copy</italic> of a vertex <italic>v</italic> are defined as <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c_{in}(u)=\sum _{e\in in(u)} c(e)$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">in</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">in</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c_{out}(u)=\sum _{e\in out(u)} c(e)$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">out</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="italic">out</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq8.gif"/></alternatives></inline-formula>. In the ideal case, we should have <italic>c</italic><sub><italic>in</italic></sub>(<italic>u</italic>)=<italic>c</italic>(<italic>u</italic>)=<italic>c</italic><sub><italic>out</italic></sub>(<italic>u</italic>), but this may be broken due to experimental and sequencing errors.</p>
      <p>We propose an integer linear programming (ILP) approach to optimize the degree balance property. First, assign each segment <italic>u</italic> (respectively <italic>μ</italic>) to a target copy number <italic>t</italic>(<italic>u</italic>) (respectively <italic>t</italic>(<italic>μ</italic>)) according to Eq. <xref rid="Equ1" ref-type="">1c</xref> (respectively <xref rid="Equ1" ref-type="">1d</xref>), to satisfy the degree balance property (Eq. <xref rid="Equ1" ref-type="">1b</xref>). Then, the following program minimizes the disagreement between the assignment copy number and the target copy number (Eq. <xref rid="Equ1" ref-type="">1a</xref>).
<disp-formula id="Equ1"><label>1a</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{minimize} \quad &amp; \sum_{u}\epsilon_{u}+\sum_{\mu}\epsilon_{\mu} &amp;  \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>minimize</mml:mtext><mml:mspace width="1em"/></mml:mtd><mml:mtd class="align-2"><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3301_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{subject to} \quad &amp; c_{in}(u)=c(u), c_{out}(u)=c(u), \end{array} $$ \end{document}</tex-math>
            <mml:math id="M20">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext>subject to</mml:mtext>
                    <mml:mspace width="1em"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">in</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">out</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ2">
          <label>1b</label>
          <alternatives>
            <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;\forall u\in S\cup V\cup T  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M22">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>∀</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>S</mml:mi>
                    <mml:mo>∪</mml:mo>
                    <mml:mi>V</mml:mi>
                    <mml:mo>∪</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ3">
          <label>1c</label>
          <alternatives>
            <tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp; -\epsilon_{u} \le c(u)-t(u)\le\epsilon_{u},\\ &amp;\forall u\in S\cup V\cup T  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M24">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>≤</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>≤</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>∀</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>S</mml:mi>
                    <mml:mo>∪</mml:mo>
                    <mml:mi>V</mml:mi>
                    <mml:mo>∪</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equ3.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ4">
          <label>1d</label>
          <alternatives>
            <tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp; -\epsilon_{\mu} \le c(\mu)-t(\mu)\le\epsilon_{\mu}, &amp;\forall \mu\in\! J  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M26">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>≤</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>≤</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>∀</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>J</mml:mi>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ5">
          <label>1e</label>
          <alternatives>
            <tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp; \epsilon_{v}, \epsilon_{\mu}\in R^{+} &amp;  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M28">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>v</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∈</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ6">
          <label>1f</label>
          <alternatives>
            <tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp; t(u), t(\mu)\in\mathcal{I}, t(u)\ge 1, t(\mu)\ge 1 &amp;  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M30">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>∈</mml:mo>
                    <mml:mi mathvariant="script">I</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3301_Article_Equ6.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
    </sec>
    <sec id="Sec8">
      <title>Finding Eulerian circuit</title>
      <p>It can be shown that a Eulerian circuit to the graph constructed as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> gives a solution to our local strain reconstruction problem. However, the problem may yield multiple solutions. Each local strain should start from the first segment of one receptor and end with the last segment of the same receptor as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Each reconstructed strain may contain several HGT events. Let the number of HGT events that contributes to the local strains <italic>i</italic> be denoted as <italic>h</italic><sub><italic>i</italic></sub>. We choose a solution in which each reconstructed strain <italic>i</italic> has <italic>h</italic><sub><italic>i</italic></sub> as large as possible.</p>
    </sec>
    <sec id="Sec9">
      <title>Evaluation metrics</title>
      <p>To evaluate the performance of LEMON, we construct true local strains containing transferred segments and use LEMON to recover them. We propose two metrics Reconstruction Accuracy and Detection Rate to measure results.</p>
      <p>We denote the true local strains as <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{ H_{i}\right \}_{i=1}^{n}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq9.gif"/></alternatives></inline-formula>, where <italic>n</italic> is the number of receptors, and each true local strain {<italic>H</italic><sub><italic>i</italic></sub>} consists of <italic>m</italic><sub><italic>i</italic></sub> segments, that is, <inline-formula id="IEq10"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{i}=\left \{ s_{j}^{H_{i}}\right \}_{j=1}^{m_{i}}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq10.gif"/></alternatives></inline-formula>. We take the simulated reads as input of LEMON and construct reconstructed local strains <inline-formula id="IEq11"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{ H_{i}\right \}_{i=1}^{n}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq11.gif"/></alternatives></inline-formula>, where <italic>h</italic><sub><italic>i</italic></sub> is the reconstructed local strain which has the same receptor of <italic>H</italic><sub><italic>i</italic></sub>; if <italic>H</italic><sub><italic>i</italic></sub> doesn’t have <italic>h</italic><sub><italic>i</italic></sub> in the result, we set <italic>h</italic><sub><italic>i</italic></sub>=<italic>∅</italic>. The segments in <italic>h</italic><sub><italic>i</italic></sub> are denoted <inline-formula id="IEq12"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{j}^{h_{i}}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq12.gif"/></alternatives></inline-formula>, that is, <inline-formula id="IEq13"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$h_{i}= \left \{ s_{j}^{h_{i}}\right \}_{j=1}^{l_{i}}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq13.gif"/></alternatives></inline-formula>. We apply Smith-Waterman algorithm to measure the similarity between segment sequences of <italic>H</italic><sub><italic>i</italic></sub> and <italic>h</italic><sub><italic>i</italic></sub>. <inline-formula id="IEq14"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\forall s_{j}^{h_{i}}\in h_{i}$\end{document}</tex-math><mml:math id="M42"><mml:mo>∀</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\forall s_{j}^{H_{i}} \in H_{i}$\end{document}</tex-math><mml:math id="M44"><mml:mo>∀</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq15.gif"/></alternatives></inline-formula>, we consider <inline-formula id="IEq16"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{j}^{h_{i}}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{j}^{h_{i}}$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq17.gif"/></alternatives></inline-formula> to be matched if and only if the breakpoint pair positions of <inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{j}^{h_{i}}$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq18.gif"/></alternatives></inline-formula> are both located within 20 bp around the breakpoint pair positions of <inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{j}^{h_{i}}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq19.gif"/></alternatives></inline-formula>. In our experiments, the parameters <italic>m</italic><italic>a</italic><italic>t</italic><italic>c</italic><italic>h</italic>_<italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic> and <italic>m</italic><italic>i</italic><italic>s</italic><italic>m</italic><italic>a</italic><italic>t</italic><italic>c</italic><italic>h</italic>_<italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic> of Smith-Waterman algorithm are set as 1 and -1, respectively.</p>
      <p>The reconstruction accuracy <italic>R</italic><italic>A</italic><sub><italic>i</italic></sub> of <italic>h</italic><sub><italic>i</italic></sub> is defined in formula (<xref rid="Equ2" ref-type="">2</xref>),
<disp-formula id="Equ7"><label>2</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ RA_{i}= \left\{\begin{array}{cc} \frac{SW(h_{i},H_{i})}{m_{i}*match\_score}, &amp; \text{\(h_{i} \neq \emptyset\)}\\ 0, &amp; \text{\(h_{i}=\emptyset\)}. \\ \end{array}\right.   $$ \end{document}</tex-math><mml:math id="M54"><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">SW</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">match</mml:mtext><mml:mo>_</mml:mo><mml:mtext mathvariant="italic">score</mml:mtext></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mi>∅</mml:mi><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>∅</mml:mi><mml:mtext/><mml:mi>.</mml:mi></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3301_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <italic>S</italic><italic>W</italic>(<italic>h</italic><sub><italic>i</italic></sub>,<italic>H</italic><sub><italic>i</italic></sub>) is the alignment score of <italic>h</italic><sub><italic>i</italic></sub> and <italic>H</italic><sub><italic>i</italic></sub>, while <italic>m</italic><sub><italic>i</italic></sub> is the number of segments in <italic>H</italic><sub><italic>i</italic></sub>. When all segments are matched in <italic>h</italic><sub><italic>i</italic></sub> and <italic>H</italic><sub><italic>i</italic></sub>, which means all transferred segments are recovered. So <italic>S</italic><italic>W</italic>(<italic>h</italic><sub><italic>i</italic></sub>,<italic>H</italic><sub><italic>i</italic></sub>) is equal to <italic>m</italic><sub><italic>i</italic></sub>∗<italic>m</italic><italic>a</italic><italic>t</italic><italic>c</italic><italic>h</italic>_<italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic>, that is <italic>R</italic><italic>A</italic><sub><italic>i</italic></sub>=1.</p>
      <p>We set the number of repetitions <italic>N</italic> as 8 and define the mean value of reconstruction accuracy <inline-formula id="IEq20"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {RA}$\end{document}</tex-math><mml:math id="M56"><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic">RA</mml:mtext></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3301_Article_IEq20.gif"/></alternatives></inline-formula> as follows,
<disp-formula id="Equ8"><label>3</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \bar{RA} = \frac{1}{N}\sum_{k=1}^{N} \frac{\sum_{i=1}^{N}RA_{ik}}{n_{k}}  $$ \end{document}</tex-math><mml:math id="M58"><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic">RA</mml:mtext></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_3301_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><italic>n</italic><sub><italic>k</italic></sub> denotes the number of non-empty <italic>h</italic><sub><italic>i</italic></sub> in the <italic>j</italic>-th repetitions.</p>
      <p>An acceptable detection of one transferred segment should have its breakpoint pair located within 20 bp [<xref ref-type="bibr" rid="CR24">24</xref>] of the true breakpoint pair as mentioned in “<xref rid="Sec4" ref-type="sec">Breakpoints and segments</xref>” section. The <italic>Detection Rate</italic> is defined as the rate of the number of acceptable recovered transferred segments and the number of all transferred segments. The average detection rate is the average of 8 repetitions for each test.</p>
    </sec>
    <sec id="Sec10">
      <title>Software parameter setting</title>
      <p>Most third-party tools used in this article are set default parameters, including BWA, LUMPY [<xref ref-type="bibr" rid="CR25">25</xref>], iRep [<xref ref-type="bibr" rid="CR26">26</xref>], and STAR-Fusion [<xref ref-type="bibr" rid="CR27">27</xref>]. The parameters of DBSCAN are <italic>eps</italic>, which is the maximum radius of one cluster, and <italic>m</italic><italic>i</italic><italic>n</italic><sub><italic>sample</italic></sub>, which is the minimum number of points in one cluster. In our paper, <italic>eps</italic> is set as the average insert size. <italic>m</italic><italic>i</italic><italic>n</italic><sub><italic>sample</italic></sub> is set as 1.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>HGT events detection in simulated human gut microbiomes</title>
      <p>To simulate human gut microbiome with different complexity as mentioned in “<xref rid="Sec5" ref-type="sec">Local strains</xref>” section, we constructed 5 simulated microbiomes containing 160, 320, 640, 1280, 2560 species, respectively. For each simulated microbiome, 5 different amounts (20, 40, 60, 80, 100) of HGT events were generated. For each HGT event, we randomly selected two reference sequences as the receptor and donor respectively. On the donor, we randomly selected one 10k bp sequence region as a transferred segment and inserted it to a randomly selected insertion position on the receptor. In this simulation, each HGT event contained one transferred segment. We denoted the new receptor sequence containing transferred segments as the true local strain. All true local strains were used to generated 20X paired-end reads with WGSIM [<xref ref-type="bibr" rid="CR28">28</xref>] as an input of LEMON. Eight repetitions were performed for every test.</p>
      <p>In order to prove the performance of LEMON, we compared its performance with another popular breakpoint detection-based structural variant discovery software LUMPY.</p>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> illustrates a Comparison of Reconstruction Accuracy and Detection Rate between LEMON and LUMPY under different simulated conditions. The red dot in each boxplot denotes the mean value. As we can see, most mean values of Reconstruction Accuracy and Detection Rate achieved by LEMON are higher than those achieved by LUMPY, which demonstrates that LEMON can reconstruct more accurate strains and detect more transferred segments than LUMPY.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of Reconstruction Accuracy and Detection Rate between LEMON and LUMPY under different simulated conditions. The red dot in each boxplot is the mean value. Most mean values of Reconstruction accuracy and Detection rate achieved by LEMON are higher than those achieved by LUMPY</p></caption><graphic xlink:href="12859_2019_3301_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>HGT breakpoints detection</title>
      <p>In order to evaluate the performance of LEMON in HGT breakpoints detection as mentioned in “<xref rid="Sec4" ref-type="sec">Breakpoints and segments</xref>” section, we applied it to local strains with different coverage and compared the performance with LUMPY. HGT events with random receptors, donors and breakpoints were generated in 100 randomly selected microbials, resulting in 60 local strains with 4260 HGT breakpoints. The HGT breakpoint is the insertion position of donor segments such as <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. The paired-end reads generated from these local strains with 10 different values (2X, 5X, 10X, 15X, 20X, 30X, 40X, 50X, 60X, and 70X) of depth were input of LEMON and LUMPY. The performance is measured in terms of Sensitivity and False Discovery Rate (FDR) in breakpoints detection, and the bearing bias is 20 bp. If the distance between the detected breakpoint position and the true position is larger than 20 bp, we treat this detected position as one false detected position. Then if the distance is less than 20 bp, the detected position is treated as one true detected position. Therefore, FDR is the rate of false discovered positions among all discovered breakpoint positions. Sensitivity is the rate of true detected positions among all true breakpoint positions. LEMON has higher sensitivity and lower FDR than LUMPY across different coverage levels as illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. At low coverage level, e.g. 2X and 5X coverage, LEMON can detect 22.39% and 51.19% of all HGT breakpoints, whereas LUMPY can detect 6.86% and 31.12% of all HGT breakpoints. At a higher coverage level, LEMON remains slightly better than LUMPY. For example, from 10X to 70X coverage, the detection sensitivity of LEMON ranges from 79.03 to 94.79%, whereas the detection sensitivity of LUMPY ranges from 70.06 to 93.47%. LEMON has lower FDR than LUMPY across different coverage levels, for example, at 2X, the FDR of LEMON is 0.002, while the FDR of LUMPY is 0.016. At 70X, the FDR of LEMON and LUMPY are 0.0034 and 0.010 respectively. Therefore, LEMON can detect more accurate breakpoints than LUMPY.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Sensitivity and FDR comparison between ours and LUMPY. At low coverage level, LEMON is more sensitive than LUMPY. At higher coverage level, LEMON remains slightly better than LUMPY. LEMON has lower FDR than LUMPY across different coverage levels</p></caption><graphic xlink:href="12859_2019_3301_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>HGT strains reconstruction with complicated HGT event structure</title>
      <p>In this simulation, we set the number of species s to 2560 and the number of HGT events to 100. In order to simulate a complicated HGT event structure, we changed the number of transferred segments in each HGT event from 1 to 5. Simulated paired-end reads were generated from true local strains by using WGSIM at 5X, 10X, 20X, and 30X coverage. 4 repetitions were performed.</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the Comparison of Reconstruction Accuracy between LEMON and LUMPY under different coverage and number of transferred segments in one HGT event. We use <italic>Δ</italic><sub><italic>RA</italic></sub>=<italic>R</italic><italic>A</italic><sub><italic>LEMON</italic></sub>−<italic>R</italic><italic>A</italic><sub><italic>LUMPY</italic></sub> to measure the performance difference between LEMON and LUMPY. If <italic>Δ</italic><sub><italic>RA</italic></sub> is positive, LEMON achieves a higher <italic>RA</italic> than LUMPY. As we can see from Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, all <italic>Δ</italic><sub><italic>RA</italic></sub> are positive and <italic>Δ</italic><sub><italic>RA</italic></sub> decreases as coverage increases. Figure <xref rid="Fig5" ref-type="fig">5</xref>b demonstrates that under different complexity of HGT event, <italic>R</italic><italic>A</italic><sub><italic>LEMON</italic></sub> is better than <italic>R</italic><italic>A</italic><sub><italic>LUMPY</italic></sub>. Figure <xref rid="Fig5" ref-type="fig">5</xref>c gives an example of one HGT event containing a different number of transferred segments. Figure <xref rid="Fig5" ref-type="fig">5</xref>d and e demonstrate that LEMON has better performance than LUMPY across different levels of coverage, especially at low coverage levels, such as 5X and 10X.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of Reconstruction Accuracy between LEMON and LUMPY under different levels of coverage and number of transferred segments in one HGT event. <bold>a</bold> All <italic>Δ</italic><sub><italic>RA</italic></sub> are positive and <italic>Δ</italic><sub><italic>RA</italic></sub> decreases as coverage increases. <bold>b</bold> demonstrates that under different complexity of the HGT event, <italic>R</italic><italic>A</italic><sub><italic>LEMON</italic></sub> is better than <italic>R</italic><italic>A</italic><sub><italic>LUMPY</italic></sub>. <bold>c</bold> gives an example of one HGT event containing the different number of transferred segments. <bold>d</bold> compares Reconstruction Accuracy across different levels of coverage. <bold>e</bold> demonstrates that at different coverage level, LEMON has higher RA than LUMPY under different complexity of HGT event</p></caption><graphic xlink:href="12859_2019_3301_Fig5_HTML" id="MO5"/></fig></p>
      <p>In Fig. <xref rid="Fig6" ref-type="fig">6</xref>, we compare local strains reconstructed by LEMON and LUMPY at 5X and 10X coverage levels. The true local strain contains two HGT events A and B. Each HGT event has five transferred segments. +/- in each segment represents the forward/reverse direction of the segment. At 5X, LEMON detects one transferred segment Green -D6 and the RA is 0.6087, while LUMPY fails to detect anyone transferred segment and the RA is 0.5238. At 30X, LEMON detects all transferred segment and the RA is 1.0, which means LEMON has reconstructed the same structure as the true local strain, while LUMPY fails to detect Red +D1 and the RA is 0.9565. Therefore, LEMON could detect more transferred segments than LUMPY and reconstruct more accurate strains across different coverage levels.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparison of local strains reconstructed by LEMON and LUMPY at 5X and 30X coverage levels. The true local strain contains two HGT events A and B. Each HGT event has five transferred segments. +/- denotes the orientation of the segment. At 5X, LEMON detects one transferred segment Green -D6, while LUMPY fails to detect anyone transferred segment. At 30X, LEMON detects all transferred segment and has reconstructed the same structure as the true local strain, while LUMPY fails to detect Red +D1</p></caption><graphic xlink:href="12859_2019_3301_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Highly complex HGT structures do exist in real metagenomic data</title>
      <p>We applied LEMON on a recently released metagenomic dataset [<xref ref-type="bibr" rid="CR29">29</xref>] to reconstruct local strains containing HGT events. Some reconstructed local strains have complex HGT events, such as the reconstructed local strain of NZ_DS990133.1 in sample F-5 as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Reconstructed local strain of NZ_DS990133.1 in F-5. NZ_DS990133.1 is the receptor. NZ_GG703855.1, NZ_GG703852.1, and NZ_GG703854.1 are donors. Numbers above the receptor denote insertion positions. Numbers above donor denote the start/end positions of segments. +/- denotes the orientation</p></caption><graphic xlink:href="12859_2019_3301_Fig7_HTML" id="MO7"/></fig></p>
      <p>As we can see from Fig. <xref rid="Fig8" ref-type="fig">8</xref>, segments from one donor are not always inserted into the receptor as a whole. Sometimes they are inserted into the receptor together with segments from other donors. For example. Segments D1-D2-D3 and D2-D3-D4 from NZ_GG703855.1 are inserted at the position of 181,680 bp and 431,930 bp on NZ_DS990133.1 respectively. The D2-D3-D4 from NZ_GG703855.1 together with D7 from NZ_GG703852.1 is inserted at the position of 433,142bp on the receptor. And the D8 from NZ_GG703852.1 together with D9 from NZ_GG703854.1 is reverse inserted at the position of 450,728bp on the receptor, which demonstrates the complexity of HGT events.
<fig id="Fig8"><label>Fig. 8</label><caption><p>The change of Standard Error at the origin and terminus of replication before and after HGT reconstructions. Standard error has scaled with log10. Boxplots are scaled standard error distribution at origin and terminus. Red boxes represent results calculated based on the original reference of receptor containing no HGT event and blue boxes represent results calculated based on the reconstructed reference of receptor containing HGT events. Grey lines denote some reconstructed local strains have much lower Standard Error</p></caption><graphic xlink:href="12859_2019_3301_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Local strains reconstructed by LEMON can assist replication timing profile restoring</title>
      <p>We used iRep to estimate the replication timing profile of each bacterium in metagenomics data [<xref ref-type="bibr" rid="CR29">29</xref>]. iRep utilizes linear regression to evaluate the coverage distribution across the genome to determine the PTR (peak-to-trough ratio), which is the ratio between the coverage at the origin and terminus of replication. However, due to the limitations of the reference sequence and the low sequencing depth of most species, we typically got very few replication timing profiles in a single metagenomics sample.</p>
      <p>We applied iRep to evaluate two coverage distributions for each receptor. The first coverage distribution is evaluated based on the original reference of the receptor containing no HGT event. The second coverage distribution is evaluated based on the reconstructed reference of the receptor containing HGT events. According to the two coverage distributions, we estimated two replication timing profiles(including PTR value, predicted origin, and terminus position) for each receptor. Since iRep utilizes the regression method to estimate replication timing profiles, we use Standard Error to measure the accuracy of the estimated replication timing profiles. Figure <xref rid="Fig8" ref-type="fig">8</xref> demonstrates the change of Standard Error at the origin and terminus of replication before and after reconstructions, some reconstructed local strains have much lower Standard Error, which means that LEMON help to reconstruct strains containing HGT events with more accurate restoring replication timing profile.</p>
    </sec>
    <sec id="Sec17">
      <title>Verifying HGT breakpoints with gene fusion breakpoints detected from metatranscriptome data</title>
      <p>In order to verify the HGT breakpoints detected by LEMON, we analyzed the IBD (Inflammatory Bowel Disease) data set published by HMP (Human Microbiome Project) [<xref ref-type="bibr" rid="CR30">30</xref>]. In addition to metagenomic sequencing data, some samples in this data set have corresponding metatranscriptome sequencing data. The HGT breakpoints on DNA should cause some gene fusions in RNA. We used STAR-Fusion, the current state-of-the-art tool in gene fusion detection, on the metatranscriptome data to obtain gene fusion results. These results were compared with the breakpoint results in the corresponding metagenomic data obtained by LEMON and LUMPY. Three HGT breakpoints that have close gene fusions results within 200 bp were found among 17 pairs of metagenomics and metatranscriptome data as illustrated in Table <xref rid="Tab1" ref-type="table">1</xref>. HGT breakpoints detected by LEMON and LUMPY have different shift distances away from fusion points detected by STAR-Fusion. This may validate that some gene fusions in bacterial chromosomes are caused by HGT.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Statistic table of HGT breakpoints type in strain results of eight samples</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Sample</th><th align="left">Total</th><th align="left">Non-coding</th><th align="left">Candidate gene</th><th align="left">Candidate gene</th></tr><tr><th align="left"/><th align="left">breakpoints</th><th align="left">breakpoints</th><th align="left">fusion points</th><th align="left">fusion points ratio</th></tr></thead><tbody><tr><td align="left">F-5</td><td align="left">1024</td><td align="left">227</td><td align="left">228</td><td align="left">22.3%</td></tr><tr><td align="left">F-6</td><td align="left">390</td><td align="left">248</td><td align="left">18</td><td align="left">4.6%</td></tr><tr><td align="left">F-7</td><td align="left">437</td><td align="left">261</td><td align="left">24</td><td align="left">5.5%</td></tr><tr><td align="left">F-8</td><td align="left">575</td><td align="left">322</td><td align="left">28</td><td align="left">4.9%</td></tr><tr><td align="left">F-9</td><td align="left">230</td><td align="left">157</td><td align="left">11</td><td align="left">4.8%</td></tr><tr><td align="left">F-12</td><td align="left">459</td><td align="left">326</td><td align="left">11</td><td align="left">2.4%</td></tr><tr><td align="left">F-14</td><td align="left">364</td><td align="left">243</td><td align="left">14</td><td align="left">3.8%</td></tr><tr><td align="left">F-15</td><td align="left">377</td><td align="left">230</td><td align="left">19</td><td align="left">5.0%</td></tr></tbody></table></table-wrap></p>
      <p>The reads supporting the breakpoint, NZ_DS981501.1:4185-NZ_CP015401.2:963348, are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The shift distance between the HGT breakpoint and the breakpoint obtained by STAR-Fusion is 10 bps. The shift sequence regions on the two reference sequences, such as TAATGGTTAG and TAATGGTTCA in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, are almost the same.</p>
      <p>We identify 3 main reasons for discrepancies between STAR-Fusion-detected gene fusion breakpoints and our HGT breakpoints:</p>
      <p>1) The results of STAR-fusion are based on STAR aligner, while our algorithm is based on BWA. STAR aligner and BWA employ different alignment algorithm, giving rise to different breakpoints results;</p>
      <p>2) Limited sequencing data. The amount of metagennomics sequencing data in the IBD data set is around 5G per sample, and the amount of metatranscriptome data is 2G per sample. This is insufficient for the statistical significance required for finding all the breakpoints;</p>
      <p>3) Based on our statistics in Table <xref rid="Tab2" ref-type="table">2</xref>, most of HGT breakpoints occur in the non-coding region.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Detail on the breakpoints of three gene fusion results which have close HGT breakpoints (HGT breakpoints located in 200 bp upstream or downstream around gene fusion points)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Sample</th><th align="left">H4009C2</th><th align="left">C3003C3</th><th align="left">C3003C3</th></tr></thead><tbody><tr><td align="center" colspan="2">Upstream</td><td align="left">NZ_GG703852.1</td><td align="left">NZ_ACEP01000119.1</td><td align="left">NZ_DS981501.1</td></tr><tr><td align="center" colspan="2">Downstream</td><td align="left">NZ_JRNC01000070.1</td><td align="left">NZ_ACEP01000074.1</td><td align="left">NZ_CP015401.2</td></tr><tr><td align="left">Upstream breakpoint</td><td align="left">HGT</td><td align="left">751372</td><td align="left">25274</td><td align="left">4185</td></tr><tr><td align="left"/><td align="left">LUMPY</td><td align="left">751114</td><td align="left">25275</td><td align="left">4220</td></tr><tr><td align="left"/><td align="left">STAR-Fusion</td><td align="left">751131</td><td align="left">25282</td><td align="left">4195</td></tr><tr><td align="left">Downstream breakpoint</td><td align="left">HGT</td><td align="left">199</td><td align="left">27544</td><td align="left">963348</td></tr><tr><td align="left"/><td align="left">LUMPY</td><td align="left">127</td><td align="left">27558</td><td align="left">963349</td></tr><tr><td align="left"/><td align="left">STAR-Fusion</td><td align="left">223</td><td align="left">27588</td><td align="left">963357</td></tr><tr><td align="center" colspan="2">Upstream gene name</td><td align="left">NZ_GG703852.1_gene2906</td><td align="left">NZ_ACEP01000074.1_gene1544</td><td align="left">NZ_DS981501.1_gene822</td></tr><tr><td align="center" colspan="2">Downstream gene name</td><td align="left">NZ_JRNC01000070.1_gene2118</td><td align="left">NZ_ACEP01000119.1_gene553</td><td align="left">NZ_CP015401.2_gene767</td></tr></tbody></table></table-wrap></p>
      <p>In summary, it is reasonable to find only 3 matching breakpoints in 17 pairs of data.</p>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Conclusions and discussion</title>
    <p>In this paper we present LEMON, a novel HGT discovery software that can detect HGT events and reconstruct strains containing multiple HGT events with complicated structural variation.</p>
    <p>Using LEMON to reconstruct the sequence structure of bacteria allows us to study the metagenomics problem from the sequence level, thus no longer subjected to the comparison of abundance. For example, since HGT is the fundamental mechanism for the spread of antibiotic resistance in bacteria, by utilizing LEMON we could detect transferred Antibiotic Resistance Genes (ARG)[<xref ref-type="bibr" rid="CR31">31</xref>], determine the corresponding donors and receptors, and reconstruct strains of receptors, which harbor the transferred ARG. Therefore, we could get a better understanding of the transfer mechanism of ARG among bacteria.</p>
    <p>However, as the amount of sequencing data is generally insufficient for current metagenomics analysis, challenges remain in identifying the HGTs sensitively and accurately. This results in several shortcomings in LEMON. First, LEMON remains weak in finding HGT between the sequences that do not exist in the reference genome. Second, because we only consider the reads of unique mapping, the HGT on the repeat region cannot be identified.</p>
    <p>At present, our reference set only contains the genome of bacteria. However, human gut microbiome also contains other microorganisms such as fungi and viruses. Therefore, a reference library that contains sequences of bacterial, viral and fungal more completely would be highly desirable for HGT analysis of the microbiome.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional material</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3301_MOESM1_ESM.png">
            <label>Additional file 1</label>
            <caption>
              <p>Detailed reads mapping result at HGT breakpoints NZ_DS981501.1:4185 - NZ_CP015401.2:963348. Top-left is upstream genome; top-right is downstream genome. STAR-Fusion determined genes around gene fusion points are annotated with border bar. Red lines represent breakpoints detected from metagenomics data with HGT algorithm. Blue lines represent breakpoints detected from metatranscriptome data with STAR-Fusion. In red rectangle, top sequence with base name is local strain constructed with HGT breakpoints information, and other color bars are metagenomics reads support breakpoints. In blue rectangle, top sequence with base name is local strain constructed with gene fusion breakpoints, other color bars are metatranscriptome reads support those breakpoints.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ARG</term>
        <def>
          <p>Antibiotic resistance genes</p>
        </def>
      </def-item>
      <def-item>
        <term>BWA</term>
        <def>
          <p>Burrows wheeler aligner</p>
        </def>
      </def-item>
      <def-item>
        <term>BWT</term>
        <def>
          <p>Burrows–wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p>Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>DBSCAN</term>
        <def>
          <p>Density-based spatial clustering of applications with noise</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GTDB</term>
        <def>
          <p>Genome taxonomy database</p>
        </def>
      </def-item>
      <def-item>
        <term>HGT</term>
        <def>
          <p>Horizontal gene transfer</p>
        </def>
      </def-item>
      <def-item>
        <term>HMP</term>
        <def>
          <p>Human microbiome project</p>
        </def>
      </def-item>
      <def-item>
        <term>IBD</term>
        <def>
          <p>Inflammatory bowel disease</p>
        </def>
      </def-item>
      <def-item>
        <term>ILP</term>
        <def>
          <p>Integer linear programming</p>
        </def>
      </def-item>
      <def-item>
        <term>iRep</term>
        <def>
          <p>Index of replication</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p>National center for biotechnology information</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>PTR</term>
        <def>
          <p>peak and trough of replication</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p>Single nucleotide variation</p>
        </def>
      </def-item>
      <def-item>
        <term>WGSIM</term>
        <def>
          <p>Whole-genome sequencing read simulator</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3301-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d29e3748">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics Volume 20 Supplement 23, 2019: Proceedings of the Joint International GIW &amp; ABACBS-2019 Conference: bioinformatics</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-23">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-23</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <sec id="FPar1">
      <title>Authors’ contributions</title>
      <p>SL conceived the project. SL and CL designed the algorithm. CL implemented the algorithm. CL and YJ performed the analyses. CL, YJ and SL evaluated the results, and wrote the manuscript. All authors reviewed the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Authors’ information</title>
      <p>Department of Computer Science, City University of Hong Kong, Kowloon, Hong Kong SAR</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The work is supported by City University of Hong Kong(Project 7004886). Publication costs are funded by City University of Hong Kong(Project 7004886). The funding body did not play any role in the design of the study and collection, analysis, interpretation of data, and manuscript writing.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The real metagenomics dataset for local strains recontruction was deposited to Sequence Read Archive (Bioproject: PRJNA393237). IBD dataset was published by HMP and available on the Sequence Read Archive (BioProject: PRJNA389280)</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ochman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Groisman</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>405</volume>
        <issue>6784</issue>
        <fpage>299</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1038/35012500</pub-id>
        <pub-id pub-id-type="pmid">10830951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Sieber</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Hotopp</surname>
            <given-names>JCD</given-names>
          </name>
        </person-group>
        <article-title>A review of bacteria-animal lateral gene transfer may inform our understanding of diseases like cancer</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>1003877</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1003877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keeling</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Horizontal gene transfer in eukaryotic evolution</article-title>
        <source>Nature Rev Genet</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>605</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2386</pub-id>
        <pub-id pub-id-type="pmid">18591983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dagan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Artzy-Randrup</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Modular networks and cumulative impact of lateral transfer in prokaryote genome evolution</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2008</year>
        <volume>105</volume>
        <issue>29</issue>
        <fpage>10039</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0800679105</pub-id>
        <pub-id pub-id-type="pmid">18632554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Acuna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Padilla</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Florez-Ramos</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Rubio</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Benavides</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-J</given-names>
          </name>
          <name>
            <surname>Yeats</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Rose</surname>
            <given-names>JKC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive horizontal transfer of a bacterial gene to an invasive insect pest of coffee</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>11</issue>
        <fpage>4197</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1121190109</pub-id>
        <pub-id pub-id-type="pmid">22371593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hotopp</surname>
            <given-names>JCD</given-names>
          </name>
        </person-group>
        <article-title>Horizontal gene transfer between bacteria and animals</article-title>
        <source>Trends Genet</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>157</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2011.01.005</pub-id>
        <pub-id pub-id-type="pmid">21334091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome: at the interface of health and disease</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>260</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3182</pub-id>
        <pub-id pub-id-type="pmid">22411464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fraser-Liggett</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome project: Exploring the microbial part of ourselves in a changing world</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <issue>7164</issue>
        <fpage>804</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06244</pub-id>
        <pub-id pub-id-type="pmid">17943116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGowan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fulthorpe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Evidence for interspecies gene transfer in the evolution of 2,4-dichlorophenoxyacetic acid degraders</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1998</year>
        <volume>64</volume>
        <issue>10</issue>
        <fpage>4089</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.64.10.4089-4092.1998</pub-id>
        <pub-id pub-id-type="pmid">9758850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quiles-Puchalt</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>YN</given-names>
          </name>
          <name>
            <surname>Bacigalupe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fillol-Salom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chee</surname>
            <given-names>MSJ</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Penadés</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Genome hypermobility by lateral transduction</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6411</issue>
        <fpage>207</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aat5867</pub-id>
        <pub-id pub-id-type="pmid">30309949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fournier</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Horizontal gene transfer from extinct and extant lineages: biological innovation and the coral of life</article-title>
        <source>Philo Trans Royal Soc B: Biol Sci</source>
        <year>2009</year>
        <volume>364</volume>
        <issue>1527</issue>
        <fpage>2229</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2009.0033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Husnik</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McCutcheon</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Functional horizontal gene transfer from bacteria to eukaryotes</article-title>
        <source>Nature Rev Microbiol</source>
        <year>2017</year>
        <volume>16</volume>
        <issue>2</issue>
        <fpage>67</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2017.137</pub-id>
        <pub-id pub-id-type="pmid">29176581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Periwal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Scaria</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Insights into structural variations and genome rearrangements in prokaryotic genomes</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu600</pub-id>
        <pub-id pub-id-type="pmid">25189783</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Salem</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Sen</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Huff</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Kirkness</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Jorde</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Mobile elements create structural variation: Analysis of a complete human genome</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>1516</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.091827.109</pub-id>
        <pub-id pub-id-type="pmid">19439515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akagi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Broutian</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Padilla-Nash</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rocco</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Teknos</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wangsa</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ried</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Symer</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Gillison</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of HPV integration in human cancers reveals recurrent, focal genomic instability</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>2</issue>
        <fpage>185</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.164806.113</pub-id>
        <pub-id pub-id-type="pmid">24201445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide profiling of HPV integration in cervical cancer identifies clustered genomic hot spots and a potential microhomology-mediated integration mechanism</article-title>
        <source>Nature Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>2</issue>
        <fpage>158</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3178</pub-id>
        <pub-id pub-id-type="pmid">25581428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parfenov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedamallu</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Danilova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bristow</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hadjipanayis</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Wilkerson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Protopopov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Seth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pantazi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Santoso</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Mahadeshwar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ojesina</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Issaeva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yarbrough</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Grandis</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>El-Naggar</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of HPV and host genome interactions in primary head and neck cancers</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>43</issue>
        <fpage>15544</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1416074111</pub-id>
        <pub-id pub-id-type="pmid">25313082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Agarwala</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bolton</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Canese</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Connor</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fiorini</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Funk</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hefferon</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kimchi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kitts</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lathrop</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Marchler-Bauer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Schoch</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Database resources of the national center for biotechnology information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>23</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Waite</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Skarshewski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>996</fpage>
        <lpage>1004</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id>
        <pub-id pub-id-type="pmid">30148503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read alignment with burrows–wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>589</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Fenner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greenoak</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Coffin</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Role of endogenous retroviruses as mutagens: The hairless mutation of mice</article-title>
        <source>Cell</source>
        <year>1988</year>
        <volume>54</volume>
        <issue>3</issue>
        <fpage>383</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/0092-8674(88)90201-2</pub-id>
        <pub-id pub-id-type="pmid">2840205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobinsky</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bartscht</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mack</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Influence of tn917 insertion on transcription of the icaADBC operon in six biofilm-negative transposon mutants of staphylococcus epidermidis</article-title>
        <source>Plasmid</source>
        <year>2002</year>
        <volume>47</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1006/plas.2001.1554</pub-id>
        <pub-id pub-id-type="pmid">11798281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Ester M, Kriegel H-P, Sander J, Xu X. A density-based algorithm for discovering clusters a density-based algorithm for discovering clusters in large spatial databases with noise. In: Proceedings of the Second International Conference on Knowledge Discovery and Data Mining. KDD’96. AAAI Press: 1996. p. 226–31. <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=3001460.3001507">http://dl.acm.org/citation.cfm?id=3001460.3001507</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Abyzov A, Li S, Kim DR, Mohiyuddin M, Stütz AM, Parrish NF, Mu XJ, Clark W, Chen K, Hurles M, Korbel JO, Lam HYK, Lee C, Gerstein MB. Analysis of deletion breakpoints from 1, 092 humans reveals details of mutation mechanisms. Nat Commun. 2015; 6(1). 10.1038/ncomms8256.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Layer</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>LUMPY: a probabilistic framework for structural variant discovery</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>84</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-6-r84</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Olm</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Measurement of bacterial replication rates in microbial communities</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>1256</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3704</pub-id>
        <pub-id pub-id-type="pmid">27819664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Haas BJ, Dobin A, Stransky N, Li B, Yang X, Tickle T, Bankapur A, Ganote C, Doak TG, Pochet N, Sun J, Wu CJ, Gingeras TR, Regev A. STAR-fusion: Fast and accurate fusion transcript detection from RNA-seq. 2017. 10.1101/120295.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>and</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Hong Liu SLDBSSZHPYRWYLFCJPHPHSYXLCQZFGJWGTKNMaozhenHan. Longitudinal study evinced enterotype-dependent elastic patterns of human gut microbiome. Accepted. 2019.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Franzosa</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Lloyd-Price</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McIver</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Schwager</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Ananthakrishnan</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barron</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sauk</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Denson</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Kugathasan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McGovern</surname>
            <given-names>DPB</given-names>
          </name>
          <name>
            <surname>Vlamakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dynamics of metatranscription in the inflammatory bowel disease gut microbiome</article-title>
        <source>Nature Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>337</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-017-0089-z</pub-id>
        <pub-id pub-id-type="pmid">29311644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">van Hoek AHAM, Mevius D, Guerra B, Mullany P, Roberts AP, Aarts HJM. Acquired antibiotic resistance genes: An overview. Front Microbiol. 2011; 2. 10.3389/fmicb.2011.00203.</mixed-citation>
    </ref>
  </ref-list>
</back>
