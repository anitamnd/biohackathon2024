<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8250143</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2021.680569</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>lme4GS: An R-Package for Genomic Selection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Caamal-Pat</surname>
          <given-names>Diana</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1269491/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez-Rodríguez</surname>
          <given-names>Paulino</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/410433/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crossa</surname>
          <given-names>José</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c002">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/50360/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Velasco-Cruz</surname>
          <given-names>Ciro</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez-Elizalde</surname>
          <given-names>Sergio</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1322592/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vázquez-Peña</surname>
          <given-names>Mario</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Socioeconomics, Statistics, and Informatics, Colegio de Postgraduados</institution>, <addr-line>Texcoco</addr-line>, <country>Mexico</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Biometrics and Statistics Unit, International Maize and Wheat Improvement Center (CIMMYT)</institution>, <addr-line>Texcoco</addr-line>, <country>Mexico</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Irrigation, Universidad Autónoma Chapingo</institution>, <addr-line>Texcoco</addr-line>, <country>Mexico</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Waseem Hussain, International Rice Research Institute (IRRI), Philippines</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Jiabo Wang, Southwest Minzu University, China; Alexandre Bureau, Laval University, Canada</p>
      </fn>
      <corresp id="c001">*Correspondence: Paulino Pérez-Rodríguez, <email>perpdgo@gmail.com</email></corresp>
      <corresp id="c002">José Crossa, <email>jcrossa@cgiar.org</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Statistical Genetics and Methodology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>680569</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Caamal-Pat, Pérez-Rodríguez, Crossa, Velasco-Cruz, Pérez-Elizalde and Vázquez-Peña.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Caamal-Pat, Pérez-Rodríguez, Crossa, Velasco-Cruz, Pérez-Elizalde and Vázquez-Peña</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Genomic selection (GS) is a technology used for genetic improvement, and it has many advantages over phenotype-based selection. There are several statistical models that adequately approach the statistical challenges in GS, such as in linear mixed models (LMMs). An active area of research is the development of software for fitting LMMs mainly used to make genome-based predictions. The lme4 is the standard package for fitting linear and generalized LMMs in the R-package, but its use for genetic analysis is limited because it does not allow the correlation between individuals or groups of individuals to be defined. This article describes the new lme4GS package for R, which is focused on fitting LMMs with covariance structures defined by the user, bandwidth selection, and genomic prediction. The new package is focused on genomic prediction of the models used in GS and can fit LMMs using different variance–covariance matrices. Several examples of GS models are presented using this package as well as the analysis using real data.</p>
    </abstract>
    <kwd-group>
      <kwd>genomic selection</kwd>
      <kwd>genomic prediction</kwd>
      <kwd>linear mixed model</kwd>
      <kwd>lme4</kwd>
      <kwd>kernel</kwd>
    </kwd-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="2"/>
      <equation-count count="11"/>
      <ref-count count="28"/>
      <page-count count="12"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>With the new, low-cost, high-throughput genotyping technologies of the last decade, a breeding selection paradigm called genomic selection (GS) has emerged (<xref rid="B15" ref-type="bibr">Meuwissen et al., 2001</xref>). GS combines molecular and phenotypic data to obtain the genomic estimated breeding values (GEBVs) of individuals that have been genotyped but not phenotyped (<xref rid="B3" ref-type="bibr">Bernardo and Yu, 2007</xref>; <xref rid="B8" ref-type="bibr">de los Campos et al., 2009</xref>; <xref rid="B12" ref-type="bibr">Hayes et al., 2009</xref>; <xref rid="B24" ref-type="bibr">VanRaden et al., 2009</xref>; <xref rid="B5" ref-type="bibr">Crossa et al., 2010</xref>). The main advantages of GS over family-based selection in breeding are that it reduces the cost per cycle and the time required for variety development. However, several factors could impact the accuracy of prediction; they occur at different levels and are influenced by several genetic, environmental, and statistical factors.</p>
    <p>Complications arise in GS when determining (i) the size and diversity of the training population, (ii) the relationship between the training and testing sets, (iii) genetic complexity, and (iv) the heritability of the traits to be predicted. Challenges in GS are related to the high dimensionality of marker data, where, the number of markers is much larger than the number of observations, the multi-collinearity among markers, the cryptic interaction between markers, the complexity of the trait, sample size, correlation among markers, and the ever-present genotype × environment interaction. These complexities require parametric and semi-parametric statistical models, especially mixed models, Bayesian estimations, and, recently, deep machine learning methods that can deal appropriately with the usually large datasets (<xref rid="B6" ref-type="bibr">Crossa et al., 2017</xref>). This has led to computational challenges due to the data size and statistical challenges that include model fitting and parameter optimization. Therefore, the development of complete and simple computer packages to estimate the GEBV of the individuals to be selected under these complex scenarios is crucial for an efficient application of GS.</p>
    <p>The first R software (<xref rid="B22" ref-type="bibr">R Core Team, 2021</xref>) developed for genome-based prediction was presented by <xref rid="B8" ref-type="bibr">de los Campos et al. (2009)</xref>. Shortly afterward, <xref rid="B19" ref-type="bibr">Pérez et al. (2010)</xref> formally described the Bayesian linear regression (BLR) that allows fitting high-dimensional linear regression models including dense molecular markers, pedigree information, and several other covariates other than markers. The BLR R-package described by <xref rid="B19" ref-type="bibr">Pérez et al. (2010)</xref> allows including not only markers but also pedigree data jointly. Furthermore, <xref rid="B19" ref-type="bibr">Pérez et al. (2010)</xref> explained the challenges that arise when evaluating genomic-enabled prediction accuracy through random cross-validation (CV), as well as how to select the best choice of hyperparameters for the Bayesian models.</p>
    <p>Linear mixed models play a fundamental role in GS and genomic-enabled predictions. This kind of models is widely used for predictions, although other models, such as nonlinear models, neural networks, and other machine learning models, could be used for this purpose. The standard linear mixed model of the form <bold>y</bold> = <bold>X</bold>β + <bold>Zu</bold> + <bold>e</bold>, where, <bold>y</bold> is a response vector of dimension <italic>n</italic> × 1; <bold>X</bold> and <bold>Z</bold> are the design matrices for the fixed (β) and genotypic random (<bold>u</bold>) effects, respectively; and two variance components are estimated <inline-formula><mml:math id="INEQ7"><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">K</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <bold>K</bold> being a known semidefinite variance–covariance matrix and <inline-formula><mml:math id="INEQ9"><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> In the context of GS, <bold>K</bold> could be the additive relationship matrix derived from the coefficient of co-ancestry (numerator relationship matrix <bold>A</bold>), or it could be the genomic relationship matrix obtained from markers (<bold>G</bold>). As shown below, there are several alternative ways of expressing the incidence matrix <bold>Z</bold> and the vector of random effects <bold>u</bold> when using the numerical relationship matrix (<bold>A</bold>). Bayesian versions of linear regression models have been extensively developed, and their companion software largely distributed and used for research and extended to more complicated cases, for example, the introduction of genotype × environment interaction incorporating pedigree and environmental covariables (<xref rid="B13" ref-type="bibr">Jarquín et al., 2014</xref>).</p>
    <p><xref rid="B9" ref-type="bibr">Endelman (2011)</xref> developed the rrBLUP R-package, which is able to fit the basic linear mixed model with two variance components (<inline-formula><mml:math id="INEQ16"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mrow><mml:mtext>u</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ17"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mrow><mml:mtext>e</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>) described before with the maximum likelihood or restricted maximum likelihood (REML) methods. As an extra facility, the rrBLUP computes the Gaussian kernel and the exponential kernel that usually account for small cryptic epistatic effects among the markers. The rrBLUP has a CV algorithm to measure the prediction accuracy of the models and shows rapid solutions of the mixed model equations for moderate-to-intermediate data sizes. More specialized computer software, such as the synbreed of <xref rid="B26" ref-type="bibr">Wimmer et al. (2012)</xref> and GEMMA of <xref rid="B27" ref-type="bibr">Zhou and Stephens (2012)</xref>, were later developed.</p>
    <p>Although the previously mentioned genomic software programs solve important genomic prediction problems (e.g., prediction in training and testing sets, CV, and estimation of variance parameters), they are separate software pieces without a unified statistical and computing framework. So from the user’s perspective, having a single package implementing all the models to be fitted will save data preparation time and data analysis time. Thus, <xref rid="B18" ref-type="bibr">Pérez and de los Campos (2014)</xref> extended the original BLR R-package developed by <xref rid="B19" ref-type="bibr">Pérez et al. (2010)</xref> to a more general R-package, the Bayesian generalized linear regression (BGLR) that offers users a great variety of genomic models and methods in a unified computing software for data analysis. The BGLR is available at CRAN. The BGLR package includes several Bayesian regression models, including parametric variable selection and shrinkage methods, and semi-parametric procedures [Bayesian reproducing kernel Hilbert space (RKHS) regressions]. Many non-genomic applications are implemented as well, and response traits can be continuous or categorical (binary or ordinal). The Bayesian algorithm is based on a Gibbs sampler with scalar updates implemented in efficient routines written in C programming language. Furthermore, the BGLR is the main machinery for adapting other more complex genomic models, for example, the complex phenomenon of genotype × environment interaction including pedigree and environmental covariables (<xref rid="B13" ref-type="bibr">Jarquín et al., 2014</xref>). The BGLR is also used for assessing the marker effect × environment interaction of <xref rid="B14" ref-type="bibr">Lopez-Cruz et al. (2015)</xref> and for fitting Bayesian ridge regression and the Bayes B, as shown by <xref rid="B6" ref-type="bibr">Crossa et al. (2017)</xref>, or for using the threshold model for ordinal data as did <xref rid="B16" ref-type="bibr">Montesinos-López et al. (2016)</xref>, and for running all the Bayesian alphabet models.</p>
    <p>Although linear mixed models are important tools for fitting GS models, <xref rid="B4" ref-type="bibr">Covarrubias-Pazaran (2016)</xref> mentioned like that current GS software includes only one random effect; and therefore, using genomic prediction for more complicated situations hybrid prediction using additive, dominance, and epistatic effects is not possible under the available models. The authors proposed likelihood-based software for fitting mixed models with multiple random effects that allow the user to specify the variance–covariance structure of random effects. <xref rid="B4" ref-type="bibr">Covarrubias-Pazaran (2016)</xref> presented an R-package called sommer for genomic prediction with three algorithms for estimating variance components: average information, expectation–maximization, and efficient mixed model association. Results from sommer were comparable with those of other software, and sommer was faster than its Bayesian counterparts.</p>
    <p>The development of software for fitting linear mixed models is an active area of research. The use of pedigree and genomic-enabled prediction linear mixed models is crucial for advancing the application of genomic-assisted breeding. The lme4 package (<xref rid="B2" ref-type="bibr">Bates et al., 2015</xref>) for R (<xref rid="B22" ref-type="bibr">R Core Team, 2021</xref>) has efficient functions for analyzing linear mixed models and generalized linear mixed models (GLMMs). Some of the main features of lme4 are that (i) it is efficient for large dataset problems; (ii) it handles any number of grouping factors, nested or cross-classified; and (iii) it can use a combination of sparse and dense matrix representations to facilitate the processing of large datasets at high computational speed.</p>
    <p>However, the use of lme4 for genetic analysis has been limited because it does not allow using the correlation between individuals or groups of individuals. When individual lines or animals are related, the marginal likelihood must allow using this covariance between relatives. <xref rid="B25" ref-type="bibr">Vazquez et al. (2010)</xref> developed a package called pedigreemm that uses the lme4 but allows for correlations between levels of random effects, such as those due to genetic relationships between relatives expressed as pedigree relationships. The methodology of <xref rid="B25" ref-type="bibr">Vazquez et al. (2010)</xref> uses the numerator relationship matrix <bold>A</bold> (a positive-definite matrix) and subjects it to the Cholesky decomposition, where, the Cholesky factor (<bold>L</bold>) can be obtained from the pedigree information.</p>
    <p>Based on the above considerations and some limitations in terms of the computing efficiency of some existing genomic-enabled prediction models, in this research, we describe the new lme4GS R-Package that is based on the lme4 software of <xref rid="B2" ref-type="bibr">Bates et al. (2015)</xref> that is available in CRAN. The lme4GS is focused on genomic-based prediction of GS and can fit mixed models with several different variance–covariance matrices. The lme4GS introduces fixed and random effects, and associated variance–covariance matrices, from which matrices for fixed and random effects (<bold>X</bold>, <bold>Z</bold><sub>1</sub>, …, <bold>Z</bold><sub>q</sub>, respectively) are obtained. The original variance–covariance matrices are introduced and transformed by using the Cholesky factorization or the eigenvalue decomposition of variance–covariance matrices and later used for defining the objective function (deviance function). Once the objective function has been defined, the optimization module optimizes the objective function and provides REML estimates of the parameters of interest.</p>
  </sec>
  <sec sec-type="materials|methods" id="S2">
    <title>Materials and Methods</title>
    <p>Consider the linear mixed model:</p>
    <disp-formula id="S2.E1">
      <label>(1)</label>
      <mml:math id="M1">
        <mml:mrow>
          <mml:mrow>
            <mml:mtext mathvariant="bold">y</mml:mtext>
            <mml:mo rspace="5.8pt">=</mml:mo>
            <mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="bold">X</mml:mtext>
                <mml:mi mathvariant="normal">β</mml:mi>
              </mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mtext mathvariant="bold">Zu</mml:mtext>
              <mml:mo>+</mml:mo>
              <mml:mtext mathvariant="bold">e</mml:mtext>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>where, <bold>y</bold> is a response vector of dimensions <italic>n</italic> × 1, <bold>X</bold> is a matrix of fixed effects of dimensions <italic>n</italic> × <italic>p</italic>, β is a vector of fixed effects of dimensions <italic>p</italic> × 1, <bold>Z</bold> is an incidence matrix of dimensions <italic>n</italic> × <italic>r</italic>, and <bold>u</bold> is a vector of random effects. We assume <inline-formula><mml:math id="INEQ29"><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">K</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ30"><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <bold>K</bold> a known variance–covariance matrix, and <inline-formula><mml:math id="INEQ32"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ33"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> are variance parameters associated with <bold>u</bold> and <bold>e</bold>, respectively; furthermore, we assume that <bold>u</bold> and <bold>e</bold> are independently distributed. In the case of GS, the variance–covariance matrix can be derived from markers or from pedigree.</p>
    <p>The linear mixed model (1) can be rewritten as;</p>
    <disp-formula id="S2.E2">
      <label>(2)</label>
      <mml:math id="M2">
        <mml:mrow>
          <mml:mrow>
            <mml:mtext mathvariant="bold">y</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="bold">X</mml:mtext>
                <mml:mi mathvariant="normal">β</mml:mi>
              </mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mtext mathvariant="bold">Z</mml:mtext>
                  <mml:mo>*</mml:mo>
                </mml:msup>
                <mml:msup>
                  <mml:mtext mathvariant="bold">u</mml:mtext>
                  <mml:mo>*</mml:mo>
                </mml:msup>
              </mml:mrow>
              <mml:mo>+</mml:mo>
              <mml:mtext mathvariant="bold">e</mml:mtext>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>where, <bold>Z</bold>* = <bold>ZL</bold>, with <bold>L</bold> obtained from the Cholesky factorization of <bold>K</bold>; alternatively, <bold>Z</bold>* = <bold>ZΓΛ</bold><sup>1/2</sup> with <bold>Γ</bold> and <bold>Λ</bold> the matrices of eigenvectors and eigenvalues, respectively, obtained from the eigenvalue decomposition of <bold>K</bold>, and <inline-formula><mml:math id="INEQ45"><mml:mrow><mml:msup><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>*</mml:mo></mml:msup><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that <bold>Z</bold>*<bold>u</bold>* has the same distribution as <bold>Zu</bold>; that is, <inline-formula><mml:math id="INEQ48"><mml:mrow><mml:mrow><mml:msup><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mpadded width="+3.3pt"><mml:msup><mml:mo rspace="0pt">=</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mpadded><mml:mtext mathvariant="bold">Zu</mml:mtext></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>MN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mtext mathvariant="bold">ZKZ</mml:mtext><mml:mpadded lspace="3.3pt" width="+3.3pt"><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:mpadded></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
    <sec id="S2.SS1">
      <title>Best Linear Unbiased Predictions</title>
      <p>Once mixed model (2) is fitted, the conditional means of the random effects can be obtained, that is, <inline-formula><mml:math id="INEQ49"><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. The best linear unbiased predictions (BLUPs) for <bold>u</bold>* are obtained as follows: <inline-formula><mml:math id="INEQ51"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mmultiscripts><mml:mtext mathvariant="bold">Z</mml:mtext><mml:none/><mml:mo>*</mml:mo><mml:none/><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:mmultiscripts><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi/><mml:mo>*</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>-</mml:mo><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext><mml:mover accent="true"><mml:mi mathvariant="normal">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where, <inline-formula><mml:math id="INEQ52"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo>*</mml:mo></mml:msup><mml:mmultiscripts><mml:mtext mathvariant="bold">Z</mml:mtext><mml:none/><mml:mo>*</mml:mo><mml:none/><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:mmultiscripts></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="INEQ53"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo rspace="7.5pt">,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ54"><mml:mover accent="true"><mml:mi mathvariant="normal">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> REML estimates of variance parameters and vector of fixed effects, respectively. The conditional means of random effects for the model in equation (1) are obtained as follows: <inline-formula><mml:math id="INEQ55"><mml:mrow><mml:mpadded width="+3.3pt"><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mrow><mml:mtext mathvariant="bold">L</mml:mtext><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> if the Cholesky factorization is used, or alternatively, <inline-formula><mml:math id="INEQ56"><mml:mrow><mml:mpadded width="+3.3pt"><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi><mml:msup><mml:mi mathvariant="bold">Λ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mover accent="true"><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> if the eigenvalue is used.</p>
    </sec>
    <sec id="S2.SS2">
      <title>Prediction of New Observations</title>
      <p>The main goal of GS is to predict new observations (phenotypic values) or simply obtain the BLUPs for random effects not present in the observed data but drawn from the same population as <bold>u</bold> and <bold>e</bold> (<xref rid="B11" ref-type="bibr">Gilmour et al., 2004</xref>). Assume that the random vector <bold>u</bold> and matrix <bold>K</bold> are partitioned as follows:</p>
      <disp-formula id="S2.Ex1">
        <mml:math id="M3">
          <mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="bold">u</mml:mtext>
                <mml:mo rspace="5.8pt">=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mtable displaystyle="true" rowspacing="0pt">
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">u</mml:mtext>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">u</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>,</mml:mo>
              <mml:mrow>
                <mml:mtext mathvariant="bold">K</mml:mtext>
                <mml:mo rspace="5.8pt">=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">K</mml:mtext>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">K</mml:mtext>
                          <mml:mn>12</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">K</mml:mtext>
                          <mml:mn>21</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mtext mathvariant="bold">K</mml:mtext>
                          <mml:mn>22</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>the BLUPs for <bold>u</bold><sub>2</sub> are obtained as:</p>
      <disp-formula id="S2.E3">
        <label>(3)</label>
        <mml:math id="M4">
          <mml:mrow>
            <mml:mi>E</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:msub>
                <mml:mtext mathvariant="bold">u</mml:mtext>
                <mml:mn>2</mml:mn>
              </mml:msub>
              <mml:mo>|</mml:mo>
              <mml:msub>
                <mml:mtext mathvariant="bold">y</mml:mtext>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo rspace="5.8pt">)</mml:mo>
            </mml:mrow>
            <mml:mo rspace="5.8pt">=</mml:mo>
            <mml:msub>
              <mml:mtext mathvariant="bold">K</mml:mtext>
              <mml:mn>21</mml:mn>
            </mml:msub>
            <mml:msubsup>
              <mml:mtext mathvariant="bold">K</mml:mtext>
              <mml:mn>11</mml:mn>
              <mml:mrow>
                <mml:mo>-</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:msub>
              <mml:mtext mathvariant="bold">u</mml:mtext>
              <mml:mn>1</mml:mn>
            </mml:msub>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>In a more general case, model (1) can be extended to include more random effects, that is:</p>
      <disp-formula id="S2.E4">
        <label>(4)</label>
        <mml:math id="M5">
          <mml:mrow>
            <mml:mrow>
              <mml:mtext mathvariant="bold">y</mml:mtext>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="bold">X</mml:mtext>
                  <mml:mi mathvariant="normal">β</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo>
                    <mml:mrow>
                      <mml:mpadded width="+3.3pt">
                        <mml:mi>j</mml:mi>
                      </mml:mpadded>
                      <mml:mo rspace="5.8pt">=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>q</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mtext mathvariant="bold">Z</mml:mtext>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mtext mathvariant="bold">u</mml:mtext>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mtext mathvariant="bold">e</mml:mtext>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, <bold>Z</bold><sub><italic>j</italic></sub> is a design matrix of random effects, and <bold>u</bold><sub><italic>j</italic></sub> is a vector of random effects, <italic>j</italic> = 1, …, <italic>q</italic>, where, <italic>q</italic> corresponds to the number of random terms included in the model. We assume that <inline-formula><mml:math id="INEQ65"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mtext mathvariant="bold">K</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is independently distributed. Note that model (1) is a special case of model (4) obtained by setting <inline-formula><mml:math id="INEQ66"><mml:mrow><mml:mrow><mml:mpadded width="+3.3pt"><mml:mi>q</mml:mi></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo rspace="5.8pt">=</mml:mo><mml:msub><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext><mml:mo rspace="5.8pt">=</mml:mo><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo rspace="5.8pt">=</mml:mo><mml:msub><mml:mtext mathvariant="bold">K</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo rspace="7.5pt">,</mml:mo><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Based on the same computational strategy used to rewrite model (1) as the model in (2), model (4) can be rewritten as:</p>
      <disp-formula id="S2.E5">
        <label>(5)</label>
        <mml:math id="M6">
          <mml:mrow>
            <mml:mrow>
              <mml:mtext mathvariant="bold">y</mml:mtext>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="bold">X</mml:mtext>
                  <mml:mi mathvariant="normal">β</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo>
                    <mml:mrow>
                      <mml:mpadded width="+3.3pt">
                        <mml:mi>j</mml:mi>
                      </mml:mpadded>
                      <mml:mo rspace="5.8pt">=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>q</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mtext mathvariant="bold">Z</mml:mtext>
                      <mml:mi>j</mml:mi>
                      <mml:mo>*</mml:mo>
                    </mml:msubsup>
                    <mml:msubsup>
                      <mml:mi>u</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mo>*</mml:mo>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mtext mathvariant="bold">e</mml:mtext>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec id="S2.SS3">
      <title>Implementation</title>
      <p>The lme4GS package is an extension of the lme4 R-package (<xref rid="B2" ref-type="bibr">Bates et al., 2015</xref>); lme4GS development was inspired by existing R-packages, pedigreemm (<xref rid="B25" ref-type="bibr">Vazquez et al., 2010</xref>) and lme4qtl (<xref rid="B28" ref-type="bibr">Ziyatdinov et al., 2018</xref>), which are focused on quantitative trait locus (QTL) mapping association and linkage studies, whereas, lme4GS is focused on the problem of prediction in GS (<xref rid="B15" ref-type="bibr">Meuwissen et al., 2001</xref>) with GBLUP-type models, although the models can be applied in other research areas. lme4GS uses the computational engine provided by the well-tested and widely used lme4 package to fit mixed models with a variance–covariance matrix provided by the user. lme4GS can be considered a generalization of existing package rrBLUP (<xref rid="B9" ref-type="bibr">Endelman, 2011</xref>) because it is able to fit model (4), whereas, rrBLUP is able to fit model (1). The package also implements some of the models in the sommer package of <xref rid="B4" ref-type="bibr">Covarrubias-Pazaran (2016)</xref>. lme4GS uses the high-level modular structure of lmer (formula module, objective function module, optimization module, and output module) to fit the models with variance–covariance matrices provided by the user. The formula module allows the specification of fixed and random effects and associated variance–covariance matrices, from which matrices for fixed and random effects (<bold>X</bold>, <bold>Z</bold><sub>1</sub>, …, <bold>Z</bold><sub><italic>q</italic></sub>, respectively) are obtained. After that, the variance–covariance matrices are introduced by computing transformed incidence matrices (<inline-formula><mml:math id="INEQ69"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mpadded width="+3.3pt"><mml:mi>j</mml:mi></mml:mpadded></mml:mrow><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) using the Cholesky or eigenvalue decomposition of variance–covariance matrices provided by the user, which are taken as inputs to define the objective function (deviance function). Once the objective function has been defined, the optimization module is used to optimize the objective function and provide REML estimates of the parameters of interest. Finally, the output module is used to provide an output that can be interpreted by the end user. We developed three main R functions:</p>
      <list list-type="simple">
        <list-item>
          <label>•</label>
          <p><bold>lmerUvcov:</bold> Fits a linear mixed model with a variance–covariance matrix provided by the user. This function takes as input a formula to specify the response <bold>y</bold>, the fixed effects (fixed) and the random effects (random), a data.frame, and a list (Uvcov) to specify the variance–covariance matrix for random effects. Once the model is fitted, the routine returns an object of class merMod for which many methods are available in R for further processing (e.g., summary, print, predict, and VarCorr).</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p><bold>ranefUvcov:</bold> Extracts the conditional means of random effects. This function takes as input an object returned by the lmerUvcov function. If the ranef function in the lme4 package is used taking as input the object provided by the lmerUvcov function, it will extract the conditional means for the random effects in model (6); the conditional means for random effects in model (5) are obtained as explained in the BLUPs section. The ranef function in lme4 is overwritten with ranefUvcov, so the user can call either of these two routines and obtain the same results.</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p><bold>ranefUvcovNew:</bold> Obtains BLUPs for new levels of random effects with user-specified variance–covariance matrices. The function takes as input an object provided by the lmerUvcov function and a two-level list with variance–covariance matrices that contains information of the genotype identifiers (GIDs) to be predicted and those that were included when fitting the model. The BLUPs are obtained using partitions similar to those used to derive equation (4).</p>
        </list-item>
      </list>
      <p>The software is available in the github repository<sup><xref ref-type="fn" rid="footnote1">1</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="S3">
    <title>Examples</title>
    <p>In this section, we illustrate the use of the R-package lme4GS with several examples using sample data included in the package. In our examples, we consider only the prediction of random effects and the estimation of variance parameters, although the package is also able to estimate fixed effects.</p>
    <sec id="S3.SS1">
      <title>Example 1: Genome-Wide Prediction Using Markers and Pedigree</title>
      <p>In this example, we analyze a set of 599 wheat lines developed by the CIMMYT Global Wheat Breeding Program. The dataset has been analyzed several times in the literature (e.g., <xref rid="B8" ref-type="bibr">de los Campos et al., 2009</xref>; <xref rid="B5" ref-type="bibr">Crossa et al., 2010</xref>; <xref rid="B19" ref-type="bibr">Pérez et al., 2010</xref>). The dataset includes grain yield information, a pedigree, and 1,477 markers generated by Triticarte Pty., Ltd. (Canberra, Australia<sup><xref ref-type="fn" rid="footnote2">2</xref></sup>). Here, we present the raw phenotypic data, including the replicates in each environment and the pedigree information, in order to show how to use R tools to obtain the additive relationship matrix that is later used as input for fitting the models. The dataset is loaded into the R environment with the commands shown in <xref ref-type="boxed-text" rid="boxenv-star-1">Box 1</xref>.</p>
      <boxed-text id="boxenv-star-1" position="float">
        <caption>
          <title>Box 1. Loading wheat data.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b001.jpg"/>
        </p>
      </boxed-text>
      <p>Once the commands are executed, the following objects are available:</p>
      <list list-type="simple">
        <list-item>
          <label>•</label>
          <p>wheat.Pheno: A data.frame with four columns: Env for environments, Rep for replicates, GID for genotype identifiers, and Yield for grain yield.</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>wheat.Pedigree: A data.frame with three columns: gpid1 and gpid2, which correspond to the GID of parents 1 and 2, respectively, and progeny, which correspond to the GIDs of progeny.</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>wheat.X: A matrix of dimensions 599 × 1,279, which corresponds to Diversity Array Technology (DArT) markers coded as 0 and 1.</p>
        </list-item>
      </list>
      <p>A linear model to predict grain yield in one of the environments using markers and pedigree is given by:</p>
      <disp-formula id="S3.E6">
        <label>(6)</label>
        <mml:math id="M7">
          <mml:mrow>
            <mml:mrow>
              <mml:mtext mathvariant="bold">y</mml:mtext>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:mn mathvariant="bold">1</mml:mn>
                  <mml:mi mathvariant="normal">μ</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mtext mathvariant="bold">e</mml:mtext>
              </mml:mrow>
            </mml:mrow>
            <mml:mo rspace="7.5pt">,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, <bold>y</bold> is the response vector in one environment, <bold>1</bold> is a vector of ones, μ is an intercept, <inline-formula><mml:math id="INEQ72"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">G</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <bold>G</bold> = <bold>WW</bold>′/<italic>p</italic> (see <xref rid="B14" ref-type="bibr">Lopez-Cruz et al., 2015</xref>) is a genomic relationship matrix, <bold>W</bold> is the matrix of markers centered and standardized, <italic>p</italic> is the number of markers, <inline-formula><mml:math id="INEQ75"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a variance parameter associated with markers, <inline-formula><mml:math id="INEQ76"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">A</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <bold>A</bold> is an additive relationship matrix derived from pedigree, <inline-formula><mml:math id="INEQ78"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is its associated variance parameter, <bold>Z</bold><sub>1</sub>, <bold>Z</bold><sub>2</sub> are matrices that connect phenotypes with genotypes, and <bold>e</bold> is a random term distributed as in model (1). The additive relationship matrix <bold>A</bold> can be easily computed in R using the pedigreemm package (<xref rid="B25" ref-type="bibr">Vazquez et al., 2010</xref>); the corresponding Cholesky decomposition can be computed very efficiently, and the package is able to store the result as a sparse matrix. The code in <xref ref-type="boxed-text" rid="boxenv-star-2">Box 2</xref> computes the <bold>A</bold> and <bold>G</bold> matrices and then fits the mixed model using the lmerUvcov function. After that, it extracts the BLUPs using the ranefUvcov function.</p>
      <p>The model fitting time is about 81 s on a computer with a 2.8-GHz Intel Core i7 processor. After the model is fitted, the summary function can be used to show some of the results. The estimates of variance parameters are <inline-formula><mml:math id="INEQ84"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.2218</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="INEQ85"><mml:mrow><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.2113</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ86"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.0349</mml:mn></mml:mrow></mml:math></inline-formula> (see <xref ref-type="boxed-text" rid="boxenv-star-3">Box 3</xref>). The functions predict, residuals, etc., that are routinely used after fitting the model with the lmer function; they can also be used with the resulting object.</p>
      <boxed-text id="boxenv-star-2" position="float">
        <caption>
          <title>Box 2. Computing A and G matrices.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b002.jpg"/>
        </p>
      </boxed-text>
      <boxed-text id="boxenv-star-3" position="float">
        <caption>
          <title>Box 3. Partial output from <xref ref-type="boxed-text" rid="boxenv-star-2">Box 2</xref>.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b003.jpg"/>
        </p>
      </boxed-text>
    </sec>
    <sec id="S3.SS2">
      <title>Example 2: Training and Testing Sets</title>
      <p>In this example, we mimic the GS problem faced by breeders; we evaluate the predictive ability of model (6) by CV, which requires randomly partitioning the data into two disjoint sets, assigning 80% of the lines to the training set and the remaining 20% to the testing set. The code in <xref ref-type="boxed-text" rid="boxenv-star-4a">Box 4A</xref> partitions the data into the training and testing sets and defines two vectors, y_trn and y_tst, with the phenotypic values of both sets. Next, it creates a list object with the random effects for the linear mixed model. The linear mixed model is fitted using the training set of the data, with the lmerUvcov function. In the next step, we define a list of random effects including the variance–covariance matrices <bold>G</bold> and <bold>A</bold> and the GIDs of the lines to be predicted; the row and column names of the covariance matrices correspond to the GIDs. The ranefUvcovNew function is used for prediction and provides a list of BLUPs for each of the random terms as a result. Finally, the predictions for individuals in the testing set are obtained by simply adding up the intercepts to the BLUPs. Observed and predicted values are stored in a data.frame with three columns: GID, y (observed phenotypic values), and yHat (predicted phenotypic values) used for graphical displays. <xref ref-type="fig" rid="F1">Figure 1</xref> shows a scatter plot with observed and predicted phenotypic values in both the training and testing sets. Pearson’s correlation coefficient between the observed and predicted values is 0.5638, and the mean squared error (MSE) is 0.2581.</p>
      <boxed-text id="boxenv-star-4a" position="float">
        <caption>
          <title>Box 4A. Single training and testing partition.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b004.jpg"/>
        </p>
      </boxed-text>
      <fig id="F1" position="float">
        <label>FIGURE 1</label>
        <caption>
          <p>Observed vs. predicted phenotypic values in the training and testing sets.</p>
        </caption>
        <graphic xlink:href="fgene-12-680569-g001"/>
      </fig>
      <p><xref ref-type="boxed-text" rid="boxenv-star-4b">Box 4B</xref> shows the R code to perform a five-fold CV that is widely used to study prediction accuracy (e.g., <xref rid="B5" ref-type="bibr">Crossa et al., 2010</xref>). We randomly divided the data into five disjoint sets based on the GID, {<italic>S</italic><sub>1</sub>, …, <italic>S</italic><sub>5</sub>}. Each set is used to measure prediction accuracy. With the use of these sets, the data are divided into the training and testing populations; for example, the data in {<italic>S</italic><sub>2</sub>, …, <italic>S</italic><sub>5</sub>} are the training data, and <italic>S</italic><sub>1</sub> are the testing data. The model is fitted using the training data, then phenotypes for <italic>S</italic><sub>1</sub> are predicted, and prediction accuracy is measured. The same exercise can be carried out taking <italic>S<sub>f</sub></italic> as the testing data, <italic>f</italic> = 2, …, 5. <xref rid="T1" ref-type="table">Table 1</xref> shows the results of CV, column 1 corresponds to fold, column 2 shows Pearson’s correlation coefficient between observed and predicted values for individuals in the training set, column 3 corresponds to the MSE in the training set, and columns 4 and 5 show the correlations and MSE for individuals in the testing set. The average correlation in the training set is 0.9768, whereas, the correlation in the testing set is 0.5192. The average MSE in the training set is 0.0187, and that in the testing set is 0.2897. The results are as expected: the correlation in the training set is higher than in the testing set, and the MSE is higher in the testing set than in the training set.</p>
      <boxed-text id="boxenv-star-4b" position="float">
        <caption>
          <title>Box 4B. Cross-validation.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b005.jpg"/>
        </p>
      </boxed-text>
      <table-wrap id="T1" position="float">
        <label>TABLE 1</label>
        <caption>
          <p>Results from five-fold cross-validation.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Fold</td>
              <td valign="top" align="center" colspan="2" rowspan="1">Training<hr/></td>
              <td valign="top" align="center" colspan="2" rowspan="1">Testing<hr/></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>r</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">MSE</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>r</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">MSE</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9752</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0201</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5290</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2778</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9775</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0181</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5680</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2729</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9755</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0197</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5096</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3035</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9786</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0173</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.4179</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.3280</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9775</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0182</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5714</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2663</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">avg</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9769</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0187</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.5192</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2897</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sd</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0015</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0012</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0624</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0256</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <attrib>
            <italic>MSE, mean squared error.</italic>
          </attrib>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="S3.SS3">
      <title>Example 3: Hybrid Prediction</title>
      <p>The prediction of hybrid performance is very important in agricultural breeding programs. <xref rid="B23" ref-type="bibr">Technow et al. (2014)</xref> and <xref rid="B1" ref-type="bibr">Acosta-Pech et al. (2017)</xref> employed G-BLUP type models to predict the performance of maize hybrids. The linear model used to that end is given by:</p>
      <disp-formula id="S3.E7">
        <label>(7)</label>
        <mml:math id="M8">
          <mml:mrow>
            <mml:mrow>
              <mml:mtext mathvariant="bold">y</mml:mtext>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:mn mathvariant="bold">1</mml:mn>
                  <mml:mi mathvariant="normal">μ</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:mtext mathvariant="bold">W</mml:mtext>
                  <mml:mi mathvariant="normal">θ</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>3</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>3</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mtext mathvariant="bold">e</mml:mtext>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, <bold>y</bold> is the response vector; <bold>1</bold> is a vector of ones; μ is an intercept; <bold>W</bold> is the design matrix for environments; θ is the vector of environmental effects (fixed); <bold>Z</bold><sub>1</sub>, <bold>Z</bold><sub>2</sub>, and <bold>Z</bold><sub>3</sub> are incidence matrices for paternal, maternal, and hybrids, respectively; <bold>u</bold><sub>1</sub> and <bold>u</bold><sub>2</sub> are vectors of general combining abilities for parental and maternal lines, respectively; <inline-formula><mml:math id="INEQ99"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mtext mathvariant="bold">K</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="INEQ100"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mtext mathvariant="bold">K</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with <bold>K</bold><sub>1</sub> and <bold>K</bold><sub>2</sub> relationship matrices for paternal and maternal lines <inline-formula><mml:math id="INEQ103"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="INEQ104"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> associated variance parameters, <inline-formula><mml:math id="INEQ105"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>3</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mtext mathvariant="bold">K</mml:mtext><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <bold>K</bold><sub>3</sub> = <bold>K</bold><sub>1</sub>⊗<bold>K</bold><sub>2</sub>, <inline-formula><mml:math id="INEQ107"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> variance parameter associated with hybrids, and <inline-formula><mml:math id="INEQ108"><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that model (7) can be rewritten as <bold>y</bold> = <bold>X</bold>β + <bold>Z</bold><sub>1</sub><bold>u</bold><sub>1</sub> + <bold>Z</bold><sub>2</sub><bold>u</bold><sub>2</sub> + <bold>Z</bold><sub>3</sub><bold>u</bold><sub>3</sub> + <bold>e</bold>, where, <bold>X</bold> = [<bold>1W</bold>] and β = (μ,θ′)′, which corresponds to model (4) discussed before. To exemplify how to fit this model in the lme4GS package, we used the DT_cornHybrids dataset included in the R-package sommer (<xref rid="B4" ref-type="bibr">Covarrubias-Pazaran, 2016</xref>), and we included a copy of the original data in the package (cornHybrids). The dataset contains phenotypic data for grain yield and plant height for 100 out of 400 possible crosses that originated from 40 inbred lines belonging to two heterotic groups, with 20 lines in each. Only 100 hybrids were evaluated in four locations, and then the problem was to estimate their general combining abilities and specific combining abilities and to predict the performance of untested hybrids at each location. The dataset can be loaded in R using the commands shown in <xref ref-type="boxed-text" rid="boxenv-star-5">Box 5</xref>:</p>
      <boxed-text id="boxenv-star-5" position="float">
        <caption>
          <title>Box 5. Loading maize data.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b006.jpg"/>
        </p>
      </boxed-text>
      <p>The dataset contains the following R objects:</p>
      <list list-type="simple">
        <list-item>
          <label>•</label>
          <p>maize.Pheno: A data.frame with six columns: Location, GCA1 (Parent 1), GCA2 (Parent 2), SCA (hybrid), Yield, and PlantHeight. Records with missing values in the last two columns correspond to hybrids (identified with the Parent 1:Parent 2 label) that were not evaluated in the field and that we need to predict.</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>maize.G: A matrix with relationships between individuals for parents of both heterotic groups (<bold>K</bold><sub>1</sub> and <bold>K</bold><sub>2</sub>). The matrix was computed using 511 single-nucleotide polymorphisms (SNPs) using the A.mat function included in the rrBLUP package (<xref rid="B9" ref-type="bibr">Endelman, 2011</xref>). The row names and column names of this matrix correspond to the GIDs for Parent 1 and Parent 2.</p>
        </list-item>
      </list>
      <p>The code in <xref ref-type="boxed-text" rid="boxenv-star-6">Box 6</xref> computes matrices <bold>K</bold><sub>1</sub>, <bold>K</bold><sub>2</sub>, and <bold>K</bold><sub>3</sub> in model (7) and fits the model using the lmerUvcov function using only observed phenotypic values for plant height.</p>
      <boxed-text id="boxenv-star-6" position="float">
        <caption>
          <title>Box 6. Fitting model for hybrid prediction.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b007.jpg"/>
        </p>
      </boxed-text>
      <p>The model fitting takes about 1 s to complete on a computer with a 2.8-GHz Intel Core i7 processor. Once the model is fitted, the summary function can be used to display some relevant information. The summary output is displayed in <xref ref-type="boxed-text" rid="boxenv-star-7">Box 7</xref>, which shows estimates for general combining ability, and specific combining ability and the variance parameter associated with residuals, <inline-formula><mml:math id="INEQ116"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.016385</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="INEQ117"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.000841</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="INEQ118"><mml:mrow><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.002047</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="INEQ119"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="normal">σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.001182</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <boxed-text id="boxenv-star-7" position="float">
        <caption>
          <title>Box 7. Output from <xref ref-type="boxed-text" rid="boxenv-star-6">Box 6</xref>.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b008.jpg"/>
        </p>
      </boxed-text>
      <p>The expected hybrid performance of individuals not evaluated in field can be obtained by combining the outputs from the ranefUvcov and ranefUvcovNew functions. <xref ref-type="boxed-text" rid="boxenv-star-8">Box 8</xref> shows the instructions to compute the BLUPs for the specific combining ability of hybrids. The ranefUVcov function is called internally in ranefUvcovNew. <xref ref-type="boxed-text" rid="boxenv-star-8">Box 8</xref> also shows how to extract variance parameters using the VarCorr function and then compute heritability using the results. Following <xref rid="B4" ref-type="bibr">Covarrubias-Pazaran (2016)</xref>, <inline-formula><mml:math id="INEQ120"><mml:mrow><mml:mpadded width="+3.3pt"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which leads to an estimated heritability of 0.70.</p>
      <boxed-text id="boxenv-star-8" position="float">
        <caption>
          <title>Box 8. Predicting hybrid’s performance.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b009.jpg"/>
        </p>
      </boxed-text>
    </sec>
    <sec id="S3.SS4">
      <title>Example 4: Selection of the Bandwidth Parameter With a Gaussian Kernel</title>
      <p><xref rid="B10" ref-type="bibr">Gianola et al. (2006)</xref> introduced the Gaussian kernel into quantitative genetics with the idea of capturing the total genetic effects in the problem of genomic prediction. The Gaussian kernel is defined as (e.g., <xref rid="B17" ref-type="bibr">Morota and Gianola, 2014; Pérez and de los Campos</xref>, <xref rid="B18" ref-type="bibr">2014</xref>)</p>
      <disp-formula id="S3.E8">
        <label>(8)</label>
        <mml:math id="M9">
          <mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="bold">K</mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.8pt">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mi>exp</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">θ</mml:mi>
                      <mml:mfrac>
                        <mml:msubsup>
                          <mml:mi>d</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                        <mml:mi>m</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mtext>exp</mml:mtext>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">θ</mml:mi>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mo largeop="true" symmetric="true">∑</mml:mo>
                            <mml:mrow>
                              <mml:mpadded width="+3.3pt">
                                <mml:mi>k</mml:mi>
                              </mml:mpadded>
                              <mml:mo rspace="5.8pt">=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>m</mml:mi>
                          </mml:msubsup>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>x</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>-</mml:mo>
                                <mml:msub>
                                  <mml:mi>x</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, θ is a positive bandwidth parameter; <italic>d</italic><sub><italic>ij</italic></sub> is the Euclidean distance; and <bold>x</bold><sub><italic>ik</italic></sub> (<italic>i</italic>, <italic>j</italic> = 1, …, <italic>n</italic>, <italic>k</italic> = 1, …, <italic>m</italic>) is the marker genotype code for individual <italic>i</italic> at marker <italic>k</italic>, and <italic>m</italic> is the number of markers. The bandwidth parameter may be chosen by CV, REML, or maximum likelihood or with Bayesian methods. The Gaussian kernel has been used by many authors for genomic prediction (e.g., <xref rid="B7" ref-type="bibr">de los Campos et al., 2010</xref>; <xref rid="B9" ref-type="bibr">Endelman, 2011</xref>; <xref rid="B20" ref-type="bibr">Pérez-Elizalde et al., 2015</xref>). The selection of the bandwidth is not an easy problem due to high computational cost; <xref rid="B7" ref-type="bibr">de los Campos et al. (2010)</xref> and <xref rid="B9" ref-type="bibr">Endelman (2011)</xref> proposed evaluating the performance of the model, which includes the Gaussian kernel over a grid of values of θ. Given that θ &gt; 0, if we set ρ = exp(−θ), then ρ ∈ (0,1), so we can define a grid of values for ρ and then, using these values, set the values for θ, that is, θ = −log ρ, so that equation (8) can be rewritten as <inline-formula><mml:math id="INEQ126"><mml:mrow><mml:mrow><mml:mtext mathvariant="bold">K</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mo rspace="5.8pt">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="5.8pt">=</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Another kernel that is also used in genomic prediction is the exponential kernel (e.g., <xref rid="B21" ref-type="bibr">Piepho, 2009</xref>; <xref rid="B9" ref-type="bibr">Endelman, 2011</xref>):</p>
      <disp-formula id="S3.E9">
        <label>(9)</label>
        <mml:math id="M10">
          <mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="bold">K</mml:mtext>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">x</mml:mtext>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo rspace="5.8pt">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mi>exp</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">θ</mml:mi>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>/</mml:mo>
                      <mml:msqrt>
                        <mml:mi>m</mml:mi>
                      </mml:msqrt>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, all the terms have been described previously. Similar to the case of the Gaussian kernel, the model can be reparametrized in terms of parameter ρ ∈ (0, 1).</p>
      <p>We developed the function theta_optim that fits model (5) when one of the random terms (<bold>u</bold><sub><italic>j</italic></sub>, <italic>j</italic> = 1, …, <italic>q</italic>) includes as the variance–covariance matrix a Gaussian or exponential kernel. This function takes as input the same objects as the lmerUvcov function and a list (kernel) containing (i) a matrix with distances <inline-formula><mml:math id="INEQ129"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mpadded width="+3.3pt"><mml:mi>j</mml:mi></mml:mpadded></mml:mrow><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> or the marker matrix ({<italic>x</italic><sub><italic>ij</italic></sub>}, <italic>i</italic> = 1, …, <italic>n</italic>, <italic>j</italic> = 1, …, <italic>m</italic>), (ii) the kernel type (either “gaussian” or “exponential”), and (iii) a sequence of values for θ; the IDs for the individuals are taken directly from the row names of matrices that provide the distances or the markers. If the sequence of values for θ is not provided, then it is generated automatically. The software then fits the mixed model in (5) using the lmerUvcov function for each of the distinct values of θ. The value of θ that maximizes the log-likelihood is chosen as the optimum. The function returns a list with the following elements: a vector of values of the log-likelihood, the maximum value of the log-likelihood, the values of θ used for fitting the model, the optimum value of θ, the fitted model, and the kernel computed with the optimum value of θ.</p>
      <p>In the following example, we show how to predict grain yield using a relationship matrix derived from a Gaussian or exponential kernel and a relationship matrix derived from a pedigree. A linear model to predict grain yield for environment one is analogous to model (1):</p>
      <disp-formula id="S3.E10">
        <label>(10)</label>
        <mml:math id="M11">
          <mml:mrow>
            <mml:mrow>
              <mml:mtext mathvariant="bold">y</mml:mtext>
              <mml:mo rspace="5.8pt">=</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:mn mathvariant="bold">1</mml:mn>
                  <mml:mi mathvariant="normal">μ</mml:mi>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">Z</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mtext mathvariant="bold">u</mml:mtext>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mtext mathvariant="bold">e</mml:mtext>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where, <bold>y</bold> is the grain yield; <bold>1</bold> is a vector of ones; μ is an intercept, <inline-formula><mml:math id="INEQ133"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">K</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <bold>K</bold> a kernel, which can be either Gaussian or exponential, and <inline-formula><mml:math id="INEQ135"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a variance parameter associated with markers; <inline-formula><mml:math id="INEQ136"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">u</mml:mtext><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mtext mathvariant="bold">A</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where, <bold>A</bold> is an additive relationship matrix derived from pedigree, and <inline-formula><mml:math id="INEQ138"><mml:msubsup><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> its associated variance parameter; <bold>Z</bold><sub>1</sub>, <bold>Z</bold><sub>2</sub> are matrices that connect phenotypes with genotypes; and <bold>e</bold> is a random term distributed as in model (1).</p>
      <p>The code in <xref ref-type="boxed-text" rid="boxenv-star-9">Box 9</xref> is used to fit model (10) for Gaussian and exponential kernels. <xref ref-type="fig" rid="F2">Figure 2</xref> shows the profile of the log-likelihood for different θ values. For the Gaussian kernel, the maximum of the log-likelihood is equal to -513.0865, attained at <inline-formula><mml:math id="INEQ141"><mml:mrow><mml:mpadded width="+3.3pt"><mml:mover accent="true"><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>1.1779</mml:mn></mml:mrow></mml:math></inline-formula>, whereas, for the exponential kernel, the maximum of the log-likelihood is equal to -511.585, attained at <inline-formula><mml:math id="INEQ142"><mml:mrow><mml:mpadded width="+3.3pt"><mml:mover accent="true"><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mpadded><mml:mo rspace="5.8pt">=</mml:mo><mml:mn>0.4107</mml:mn></mml:mrow></mml:math></inline-formula>. The code in <xref ref-type="boxed-text" rid="boxenv-star-10">Box 10</xref> shows how to summarize parameter estimates for the fitted model with the optimum value of the bandwidths from, where, estimates of the variance parameters can be obtained. The model fitting time is about 1,608 s for the model with Gaussian kernel and 1,701 s for the model with exponential kernel using the same processor described before. Note that the selection of bandwidth parameter is a very computer intensive task, but several authors (e.g., <xref rid="B9" ref-type="bibr">Endelman, 2011</xref>; <xref rid="B20" ref-type="bibr">Pérez-Elizalde et al., 2015</xref>) have reported that the prediction accuracy with nonadditive kernels is higher than the prediction accuracy of ridge regression (or equivalently GBLUP).</p>
      <boxed-text id="boxenv-star-9" position="float">
        <caption>
          <title>Box 9. Gaussian and exponential kernel.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b010.jpg"/>
        </p>
      </boxed-text>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p>The values of the bandwidth parameter vs. the log-likelihood. <bold>(A)</bold> Gaussian kernel. <bold>(B)</bold> Exponential kernel.</p>
        </caption>
        <graphic xlink:href="fgene-12-680569-g002"/>
      </fig>
      <boxed-text id="boxenv-star-10" position="float">
        <caption>
          <title>Box 10. Summary of fitted models.</title>
        </caption>
        <p>
          <inline-graphic xlink:href="fgene-12-680569-b011.jpg"/>
        </p>
      </boxed-text>
    </sec>
    <sec id="S3.SS5">
      <title>Computational Times and Comparison With Other Software</title>
      <p>We fitted models (6) and (7) in sommer (<xref rid="B4" ref-type="bibr">Covarrubias-Pazaran, 2016</xref>) and BGLR (<xref rid="B18" ref-type="bibr">Pérez and de los Campos, 2014</xref>). In the case of BGLR, the number of iterations for the Gibbs sampler was set to 30,000. We were unable to fit the models in rrBLUP (<xref rid="B9" ref-type="bibr">Endelman, 2011</xref>) because it is not possible to include more than one covariance matrix in the software; that is also the reason that we were unable to fit model (10) with this software. The predictions from the different software programs were about the same. Here, we present a small comparison of running times for model (6) fitted in <xref ref-type="boxed-text" rid="boxenv-star-2">Box 2</xref>, model (7) fitted in <xref ref-type="boxed-text" rid="boxenv-star-6">Box 6</xref>, and model (10) fitted in <xref ref-type="boxed-text" rid="boxenv-star-9">Box 9</xref> with Gaussian and exponential kernels. <xref rid="B4" ref-type="bibr">Covarrubias-Pazaran (2016)</xref> also included a benchmark of sommer against other packages. Models were fitted using a 2.8-GHz Intel Core i7 processor in R-4.0.5 (<xref rid="B22" ref-type="bibr">R Core Team, 2021</xref>). <xref rid="T2" ref-type="table">Table 2</xref> presents the resulting time (in seconds) it takes to fit the different models. Some entries in the <xref rid="T2" ref-type="table">Table 2</xref> are empty because the corresponding models cannot be fitted in the corresponding software package. From this <xref rid="T2" ref-type="table">Table 2</xref>, we conclude that sommer is the fastest software, followed by lme4GS and BGLR.</p>
      <table-wrap id="T2" position="float">
        <label>TABLE 2</label>
        <caption>
          <p>Time comparison (seconds) among different software for models fitted in the work.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Software</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Version</td>
              <td valign="top" align="center" colspan="4" rowspan="1">Examples<hr/></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Model (6)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Model (7)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Model (10) Gaussian</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Model (10) exponential</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lme4GS</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">81.5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1,608.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1,701.1</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">BGLR 0.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">143.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">20.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sommer 4.1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4.1.3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">46.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec id="S4">
    <title>Conclusion</title>
    <p>We developed an R software package that can be used to fit mixed models with user-defined covariance structures for random effects. The software was developed with applications of GS in mind, mainly for applications in plant breeding with small to moderately sized datasets. However, given the omnipresence of mixed models, the package can be used in other research areas. The software fits the model using well-known and widely tested computational routines available in the lme4 package. The software provides a user-friendly and intuitive interface that allows users to fit a wide variety of classic linear mixed models.</p>
  </sec>
  <sec sec-type="data-availability" id="S5">
    <title>Data Availability Statement</title>
    <p>Publicly available datasets were analyzed in this study. This data can be found here: <ext-link ext-link-type="uri" xlink:href="https://github.com/perpdgo/lme4GS">https://github.com/perpdgo/lme4GS</ext-link>.</p>
  </sec>
  <sec id="S6">
    <title>Author Contributions</title>
    <p>DC-P, PP-R, and JC conceived the work and wrote the manuscript. DC-P and PP-R wrote the software. CV-C, SP-E, and MV-P assisted in drafting the manuscript, discussed the analysis, and provided useful comments. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> Open-access fees were received from the Bill and Melinda Gates Foundation. We acknowledge the financial support provided by the Bill and Melinda Gates Foundation [INV-003439 BMGF/FCDO Accelerating Genetic Gains in Maize and Wheat for Improved Livelihoods (AG2MW)] as well as USAID projects [Amend. No. 9 MTO 069033, USAID-CIMMYT Wheat/AGGMW, AGG-Maize Supplementary Project, AGG (Stress Tolerant Maize for Africa)]. We are also thankful for the financial support provided by the Foundations for Research Levy on Agricultural Products (FFJ) and the Agricultural Agreement Research Fund (JA) in Norway through NFR grant 267806 as well as the CIMMYT CRP (wheat and maize).</p>
    </fn>
  </fn-group>
  <ack>
    <p>We thank all scientists, field workers, and lab assistants from the National Programs and CIMMYT who collected the data used in this study.</p>
  </ack>
  <fn-group>
    <fn id="footnote1">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/perpdgo/lme4GS">https://github.com/perpdgo/lme4GS</ext-link>
      </p>
    </fn>
    <fn id="footnote2">
      <label>2</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.diversityarrays.com">https://www.diversityarrays.com</ext-link>
      </p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acosta-Pech</surname><given-names>R.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Teyssèdre</surname><given-names>S.</given-names></name><name><surname>Claustres</surname><given-names>B.</given-names></name><name><surname>Pérez-Elizalde</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Genomic models with genotype x environment interaction for predicting hybrid performance: an application in maize hybrids.</article-title>
<source><italic>Theoretical and Applied Genetics</italic></source>
<volume>130</volume>
<fpage>1431</fpage>–<lpage>1440</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-017-2898-0</pub-id>
<?supplied-pmid 28401254?><pub-id pub-id-type="pmid">28401254</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bates</surname><given-names>D.</given-names></name><name><surname>Mächler</surname><given-names>M.</given-names></name><name><surname>Bolker</surname><given-names>B. M.</given-names></name><name><surname>Walker</surname><given-names>S. C.</given-names></name></person-group> (<year>2015</year>). <article-title>Fitting linear mixed-effects models using lme4.</article-title>
<source><italic>Journal of Statistical Software</italic></source>
<volume>67</volume>
<fpage>1</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernardo</surname><given-names>R.</given-names></name><name><surname>Yu</surname><given-names>J.</given-names></name></person-group> (<year>2007</year>). <article-title>Prospects for genome wide selection for quantitative traits in maize.</article-title>
<source><italic>Crop Science</italic></source>
<volume>47</volume>
<fpage>1082</fpage>–<lpage>1090</lpage>. <pub-id pub-id-type="doi">10.2135/cropsci2006.11.0690</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covarrubias-Pazaran</surname><given-names>G.</given-names></name></person-group> (<year>2016</year>). <article-title>Genome-assisted prediction of quantitative traits using the R package sommer.</article-title>
<source><italic>PloS one</italic></source>
<volume>11</volume>:<issue>6</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0156744</pub-id>
<?supplied-pmid 27271781?><pub-id pub-id-type="pmid">27271781</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Pérez</surname><given-names>P.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Burgueño</surname><given-names>J.</given-names></name><name><surname>Araus</surname><given-names>J. L.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Prediction of genetic values of quantitative traits in plant breeding using pedigree and molecular markers.</article-title>
<source><italic>Genetics</italic></source>
<volume>186</volume>
<fpage>713</fpage>–<lpage>724</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.110.118521</pub-id>
<?supplied-pmid 20813882?><pub-id pub-id-type="pmid">20813882</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Pérez-Rodríguez</surname><given-names>P.</given-names></name><name><surname>Cuevas</surname><given-names>J.</given-names></name><name><surname>Montesinos-López</surname><given-names>O.</given-names></name><name><surname>Jarquín</surname><given-names>D.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Genomic selection in plant breeding: methods, models, and perspectives.</article-title>
<source><italic>Trends in plant science</italic></source>
<volume>22</volume>
<fpage>961</fpage>–<lpage>975</lpage>. <pub-id pub-id-type="doi">10.1016/j.tplants.2017.08.011</pub-id>
<?supplied-pmid 28965742?><pub-id pub-id-type="pmid">28965742</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Rosa</surname><given-names>G. J.</given-names></name><name><surname>Weigel</surname><given-names>K. A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>). <article-title>Semi-parametric genomic-enabled prediction of genetic values using reproducing kernel Hilbert spaces methods.</article-title>
<source><italic>Genetics Research</italic></source>
<volume>92</volume>
<fpage>295</fpage>–<lpage>308</lpage>. <pub-id pub-id-type="doi">10.1017/S0016672310000285</pub-id>
<?supplied-pmid 20943010?><pub-id pub-id-type="pmid">20943010</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Naya</surname><given-names>H.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Legarra</surname><given-names>A.</given-names></name><name><surname>Manfredi</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Predicting quantitative traits with regression models for dense molecular markers and pedigree.</article-title>
<source><italic>Genetics</italic></source>
<volume>182</volume>
<fpage>375</fpage>–<lpage>385</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.109.101501</pub-id>
<?supplied-pmid 19293140?><pub-id pub-id-type="pmid">19293140</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Endelman</surname><given-names>J. B.</given-names></name></person-group> (<year>2011</year>). <article-title>Ridge regression and other kernels for genomic selection with R package rrBLUP.</article-title>
<source><italic>The Plant Genome</italic></source>
<volume>4</volume>
<fpage>250</fpage>–<lpage>255</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2011.08.0024</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Fernando</surname><given-names>R. L.</given-names></name><name><surname>Stella</surname><given-names>A.</given-names></name></person-group> (<year>2006</year>). <article-title>Genomic-assisted prediction of genetic value with semiparametric procedures.</article-title>
<source><italic>Genetics</italic></source>
<volume>173</volume>
<fpage>1761</fpage>–<lpage>1776</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.105.049510</pub-id>
<?supplied-pmid 16648593?><pub-id pub-id-type="pmid">16648593</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilmour</surname><given-names>A.</given-names></name><name><surname>Cullis</surname><given-names>B.</given-names></name><name><surname>Welham</surname><given-names>S.</given-names></name><name><surname>Gogel</surname><given-names>B.</given-names></name><name><surname>Thompson</surname><given-names>R.</given-names></name></person-group> (<year>2004</year>). <article-title>An efficient computing strategy for prediction in mixed linear models.</article-title>
<source><italic>Computational statistics &amp; data analysis</italic></source>
<volume>44</volume>
<fpage>571</fpage>–<lpage>586</lpage>. <pub-id pub-id-type="doi">10.1016/S0167-9473(02)00258-X</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>B. J.</given-names></name><name><surname>Bowman</surname><given-names>P. J.</given-names></name><name><surname>Chamberlain</surname><given-names>A. J.</given-names></name><name><surname>Goddard</surname><given-names>M. E.</given-names></name></person-group> (<year>2009</year>). <article-title>Invited review: Genomic selection in dairy cattle: Progress and challenges.</article-title>
<source><italic>Journal of dairy science</italic></source>
<volume>92</volume>
<fpage>433</fpage>–<lpage>443</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2008-1646</pub-id>
<?supplied-pmid 19164653?><pub-id pub-id-type="pmid">19164653</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarquín</surname><given-names>D.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Lacaze</surname><given-names>X.</given-names></name><name><surname>Du Cheyron</surname><given-names>P.</given-names></name><name><surname>Daucourt</surname><given-names>J.</given-names></name><name><surname>Lorgeou</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>A reaction norm model for genomic selection using high-dimensional genomic and environmental data.</article-title>
<source><italic>Theoretical and applied genetics</italic></source>
<volume>127</volume>
<fpage>595</fpage>–<lpage>607</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-013-2243-1</pub-id>
<?supplied-pmid 24337101?><pub-id pub-id-type="pmid">24337101</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez-Cruz</surname><given-names>M.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Bonnett</surname><given-names>D.</given-names></name><name><surname>Dreisigacker</surname><given-names>S.</given-names></name><name><surname>Poland</surname><given-names>J.</given-names></name><name><surname>Jannink</surname><given-names>J. L.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Increased prediction accuracy in wheat breeding trials using a marker× environment interaction genomic selection model.</article-title>
<source><italic>G3: Genes, Genomes, Genetics</italic></source>
<volume>5</volume>
<fpage>569</fpage>–<lpage>582</lpage>. <pub-id pub-id-type="doi">10.1534/g3.114.016097</pub-id>
<?supplied-pmid 25660166?><pub-id pub-id-type="pmid">25660166</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meuwissen</surname><given-names>T. H.</given-names></name><name><surname>Hayes</surname><given-names>B. J.</given-names></name><name><surname>Goddard</surname><given-names>M. E.</given-names></name></person-group> (<year>2001</year>). <article-title>Prediction of total genetic value using genome-wide dense marker maps.</article-title>
<source><italic>Genetics</italic></source>
<volume>157</volume>
<fpage>1819</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Toledo</surname><given-names>F. H.</given-names></name><name><surname>Pérez-Hernández</surname><given-names>O.</given-names></name><name><surname>Eskridge</surname><given-names>K. M.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>A genomic Bayesian multi-trait and multi-environment model.</article-title>
<source><italic>G3: Genes, Genomes, Genetics</italic></source>
<volume>6</volume>
<fpage>2725</fpage>–<lpage>2744</lpage>. <pub-id pub-id-type="doi">10.1534/g3.116.032359</pub-id>
<?supplied-pmid 27342738?><pub-id pub-id-type="pmid">27342738</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morota</surname><given-names>G.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name></person-group> (<year>2014</year>). <article-title>Kernel-based whole-genome prediction of complex traits: a review.</article-title>
<source><italic>Frontiers in genetics</italic></source>
<volume>5</volume>:<issue>363</issue>. <pub-id pub-id-type="doi">10.3389/fgene.2014.00363</pub-id>
<?supplied-pmid 25360145?><pub-id pub-id-type="pmid">25360145</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>P.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name></person-group> (<year>2014</year>). <article-title>Genome-wide regression and prediction with the BGLR statistical package.</article-title>
<source><italic>Genetics</italic></source>
<volume>198</volume>
<fpage>483</fpage>–<lpage>495</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.164442</pub-id>
<?supplied-pmid 25009151?><pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>P.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name></person-group> (<year>2010</year>). <article-title>Genomic-enabled prediction based on molecular markers and pedigree using the Bayesian linear regression package in R.</article-title>
<source><italic>The plant genome</italic></source>
<volume>3</volume>
<fpage>106</fpage>–<lpage>116</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2010.04.0005</pub-id>
<?supplied-pmid 21566722?><pub-id pub-id-type="pmid">21566722</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez-Elizalde</surname><given-names>S.</given-names></name><name><surname>Cuevas</surname><given-names>J.</given-names></name><name><surname>Pérez-Rodríguez</surname><given-names>P.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name></person-group> (<year>2015</year>). <article-title>Selection of the bandwidth parameter in a Bayesian kernel regression model for genomic-enabled prediction.</article-title>
<source><italic>Journal of agricultural, biological, and environmental statistics</italic></source>
<volume>20</volume>
<fpage>512</fpage>–<lpage>532</lpage>. <pub-id pub-id-type="doi">10.1007/s13253-015-0229-y</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piepho</surname><given-names>H. P.</given-names></name></person-group> (<year>2009</year>). <article-title>Ridge regression and extensions for genomewide selection in maize.</article-title>
<source><italic>Crop Sci.</italic></source>
<volume>49</volume>
<fpage>1165</fpage>–<lpage>1176</lpage>. <pub-id pub-id-type="doi">10.2135/cropsci2008.10.0595</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2021</year>). <source><italic>R: A Language and Environment for Statistical Computing.</italic></source>
<publisher-loc>Vienna</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Technow</surname><given-names>F.</given-names></name><name><surname>Schrag</surname><given-names>T. A.</given-names></name><name><surname>Schipprack</surname><given-names>W.</given-names></name><name><surname>Bauer</surname><given-names>E.</given-names></name><name><surname>Simianer</surname><given-names>H.</given-names></name><name><surname>Melchinger</surname><given-names>A. E.</given-names></name></person-group> (<year>2014</year>). <article-title>Genome properties and prospects of genomic prediction of hybrid performance in a breeding program of maize.</article-title>
<source><italic>Genetics</italic></source>
<volume>197</volume>
<fpage>1343</fpage>–<lpage>1355</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.165860</pub-id>
<?supplied-pmid 24850820?><pub-id pub-id-type="pmid">24850820</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanRaden</surname><given-names>P. M.</given-names></name><name><surname>Van Tassell</surname><given-names>C. P.</given-names></name><name><surname>Wiggans</surname><given-names>G. R.</given-names></name><name><surname>Sonstegard</surname><given-names>T. S.</given-names></name><name><surname>Schnabel</surname><given-names>R. D.</given-names></name><name><surname>Taylor</surname><given-names>J. F.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Invited review: Reliability of genomic predictions for North American Holstein bulls.</article-title>
<source><italic>Journal of dairy science</italic></source>
<volume>92</volume>
<fpage>16</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2008-1514</pub-id>
<?supplied-pmid 19109259?><pub-id pub-id-type="pmid">19109259</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vazquez</surname><given-names>A. I.</given-names></name><name><surname>Bates</surname><given-names>D. M.</given-names></name><name><surname>Rosa</surname><given-names>G. J. M.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Weigel</surname><given-names>K. A.</given-names></name></person-group> (<year>2010</year>). <article-title>an R package for fitting generalized linear mixed models in animal breeding.</article-title>
<source><italic>Journal of animal science</italic></source>
<volume>88</volume>
<fpage>497</fpage>–<lpage>504</lpage>. <pub-id pub-id-type="doi">10.2527/jas.2009-1952</pub-id>
<?supplied-pmid 19820058?><pub-id pub-id-type="pmid">19820058</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wimmer</surname><given-names>V.</given-names></name><name><surname>Albrecht</surname><given-names>T.</given-names></name><name><surname>Auinger</surname><given-names>H. J.</given-names></name><name><surname>Schön</surname><given-names>C. C.</given-names></name></person-group> (<year>2012</year>). <article-title>synbreed: a framework for the analysis of genomic prediction data using R.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>28</volume>
<fpage>2086</fpage>–<lpage>2087</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts335</pub-id>
<?supplied-pmid 22689388?><pub-id pub-id-type="pmid">22689388</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>X.</given-names></name><name><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>). <article-title>Genome-wide efficient mixed-model analysis for association studies.</article-title>
<source><italic>Nature genetics</italic></source>
<volume>44</volume>
<fpage>821</fpage>–<lpage>824</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2310</pub-id>
<?supplied-pmid 22706312?><pub-id pub-id-type="pmid">22706312</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziyatdinov</surname><given-names>A.</given-names></name><name><surname>Vázquez-Santiago</surname><given-names>M.</given-names></name><name><surname>Brunel</surname><given-names>H.</given-names></name><name><surname>Martinez-Perez</surname><given-names>A.</given-names></name><name><surname>Aschard</surname><given-names>H.</given-names></name><name><surname>Soria</surname><given-names>J. M.</given-names></name></person-group> (<year>2018</year>). <article-title>lme4qtl: linear mixed models with flexible covariance structure for genetic studies of related individuals.</article-title>
<source><italic>BMC bioinformatics</italic></source>
<volume>19</volume>:<issue>68</issue>. <pub-id pub-id-type="doi">10.1186/s12859-018-2057-x</pub-id>
<?supplied-pmid 29486711?><pub-id pub-id-type="pmid">29486711</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <glossary>
    <title>Abbreviations</title>
    <def-list id="DL1">
      <def-item>
        <term>BGLR</term>
        <def>
          <p>Bayesian generalized linear regression</p>
        </def>
      </def-item>
      <def-item>
        <term>BLR</term>
        <def>
          <p>Bayesian linear regression</p>
        </def>
      </def-item>
      <def-item>
        <term>BLUP</term>
        <def>
          <p>best linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>GEBV</term>
        <def>
          <p>genomic estimated breeding value</p>
        </def>
      </def-item>
      <def-item>
        <term>GLMM</term>
        <def>
          <p>generalized linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>GS</term>
        <def>
          <p>genomic selection</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p>linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>REML</term>
        <def>
          <p>restricted maximum likelihood.</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
</back>
