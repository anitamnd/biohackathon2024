<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6792083</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz191</article-id>
    <article-id pub-id-type="publisher-id">btz191</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>onlineFDR: an R package to control the false discovery rate for growing data repositories</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6207-0416</contrib-id>
        <name>
          <surname>Robertson</surname>
          <given-names>David S</given-names>
        </name>
        <xref ref-type="aff" rid="btz191-aff1">1</xref>
        <xref ref-type="corresp" rid="btz191-cor1"/>
        <!--<email>david.robertson@mrc-bsu.cam.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wildenhain</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="btz191-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Javanmard</surname>
          <given-names>Adel</given-names>
        </name>
        <xref ref-type="aff" rid="btz191-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Karp</surname>
          <given-names>Natasha A</given-names>
        </name>
        <xref ref-type="aff" rid="btz191-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz191-aff1"><label>1</label><institution>MRC Biostatistics Unit, University of Cambridge</institution>, Cambridge, UK</aff>
    <aff id="btz191-aff2"><label>2</label><institution>Quantitative Biology, Discovery Sciences, IMED Biotech Unit</institution>, AstraZeneca, Cambridge, UK</aff>
    <aff id="btz191-aff3"><label>3</label><institution>Department of Data Sciences and Operations, University of Southern California</institution>, Los Angeles, CA, USA</aff>
    <author-notes>
      <corresp id="btz191-cor1">To whom correspondence should be addressed. <email>david.robertson@mrc-bsu.cam.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-03-14">
      <day>14</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>20</issue>
    <fpage>4196</fpage>
    <lpage>4199</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz191.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>In many areas of biological research, hypotheses are tested in a sequential manner, without having access to future <italic>P</italic>-values or even the number of hypotheses to be tested. A key setting where this online hypothesis testing occurs is in the context of publicly available data repositories, where the family of hypotheses to be tested is continually growing as new data is accumulated over time. Recently, Javanmard and Montanari proposed the first procedures that control the FDR for online hypothesis testing. We present an R package, onlineFDR, which implements these procedures and provides wrapper functions to apply them to a historic dataset or a growing data repository.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package is freely available through Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/onlineFDR">http://www.bioconductor.org/packages/onlineFDR</ext-link>).</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000265</named-content>
        </funding-source>
        <award-id>MC_UU_00002/6</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Biometrika Trust</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Outlier Research in Business</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">USC Marshall School of Business</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Google Faculty Research</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NSF-CAREER</named-content>
        </funding-source>
        <award-id>1844481</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">AstraZeneca</named-content>
          <named-content content-type="funder-identifier">10.13039/100004325</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Multiple hypothesis testing is a common feature of genome bioinformatics and computational biology, and appropriately correcting for this multiplicity is crucial when it comes to making statistical inference from the data. Indeed, uncorrected hypothesis testing has been highlighted as one of the contributing factors to the reproducibility crisis in scientific research (<xref rid="btz191-B4" ref-type="bibr">Ioannidis, 2005</xref>). The false discovery rate (FDR), which was introduced by <xref rid="btz191-B1" ref-type="bibr">Benjamini and Hochberg (1995)</xref>, has become the error criterion of choice for large-scale multiple hypothesis testing. The FDR is defined as the expected proportion of the discoveries (i.e. rejections) made that are false. To control the FDR, procedures (such as the well-known Benjamini–Hochberg procedure) have been developed which require that all the <italic>P</italic>-values are available to be tested at once.</p>
    <p>However, modern data analysis often has a further complexity in that hypotheses are tested sequentially, with the family of hypotheses continually growing due to the temporal accumulation of data. This introduces the challenge of <italic>online</italic> hypothesis testing, where at each step the investigator must decide whether to reject the current null hypothesis without knowing the future <italic>P</italic>-values or even the total number of hypotheses to be tested, but only knowing the historic decisions to date.</p>
    <p>This setting occurs in the context of publicly available data repositories, which are becoming increasingly common and important for biological research. Currently, multiple testing in growing data repositories is managed by using a fixed conservative threshold or through the recalculation of significance as new hypotheses are tested. However, the fixed threshold approach fails to adapt to the data, while the recalculation approach can lead to the decisions for an individual hypothesis changing over time.</p>
    <p>The online FDR concept is based around hypothesis testing and decisions being made in a sequential manner, with the aim being to control the FDR across the family of hypothesis tests considered. In some biological databases, the family of hypotheses is clearly defined, and a centralized analysis pipeline has been constructed upon which the online FDR method can be implemented. For examples, see the application datasets used in this manuscript. In contrast, in other databases independent research groups may carry out multiple hypothesis testing and generate distinct families of hypothesis tests, and so overall FDR control is not necessarily appropriate.</p>
    <p><xref rid="btz191-B5" ref-type="bibr">Javanmard and Montanari (2015</xref>, <xref rid="btz191-B6" ref-type="bibr">2018</xref>) recently proposed the first procedures that control the FDR for online hypothesis testing, which were the basis for further procedures by <xref rid="btz191-B8" ref-type="bibr">Ramdas <italic>et al.</italic> (2017)</xref>. The R package onlineFDR, available through Bioconductor, implements these procedures and provides wrapper functions to apply them to a historic dataset or a growing data repository.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Consider a series of null hypotheses <italic>H</italic><sub>1</sub>, <italic>H</italic><sub>2</sub>, <italic>H</italic><sub>3</sub>, <italic>…</italic> with corresponding <italic>P</italic>-values (<italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>, <italic>p</italic><sub>3</sub>,<italic> …</italic>). A testing procedure provides a sequence of adjusted significance thresholds <italic>α<sub>i,</sub></italic>with corresponding decision rules
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd/><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:mtext>reject</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd/><mml:mtd><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    <p>A distinction needs to be made between methods appropriate for independent versus dependent <italic>P</italic>-values. As a brief practical example, suppose <italic>p</italic><sub>1</sub> corresponds to testing the null hypothesis <italic>H</italic><sub>1</sub> that genotype <italic>X</italic> has no association with lean mass, using data <italic>Y</italic> collected on a group of mice. If <italic>p</italic><sub>2</sub> corresponds to testing the null hypothesis <italic>H</italic><sub>2</sub> that genotype <italic>X</italic> has no association with fat mass using the same data <italic>Y</italic>, then <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> would be dependent due to the association between lean and fat mass for the same mice. However, if instead we tested <italic>H</italic><sub>2</sub> using new data <italic>Y’</italic> from a different group of mice, or replaced genotype <italic>X</italic> with an unassociated genotype <italic>X’</italic>, then <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> would be independent.</p>
    <p>In the setting of a growing data repository, the online methods have the following baseline assumptions:
<list list-type="order"><list-item><p>There is a family of hypothesis tests for which FDR control is required.</p></list-item><list-item><p>The hypothesis tests are performed sequentially in time.</p></list-item><list-item><p>The <italic>P</italic>-values are all valid and finalized (i.e. will not be changed at a later stage).</p></list-item><list-item><p>All of the <italic>P</italic>-values are analysed, and not just the statistically significant <italic>P</italic>-values. An exception is if an orthogonal filter is applied to reduce the dataset size; see <xref rid="btz191-B3" ref-type="bibr">Bourgon <italic>et al.</italic> (2010)</xref>.</p></list-item><list-item><p>[For methods requiring independent <italic>P</italic>-values] A different hypothesis is being tested at each step.</p></list-item><list-item><p>[For methods requiring independent <italic>P</italic>-values] If the <italic>P</italic>-values come in batches, the ordering within a batch should be random or ordered using independent information.</p></list-item></list></p>
    <p>We now give a high-level overview of the online FDR methods implemented in the package, with full details given in the package vignette (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/devel/bioc/vignettes/onlineFDR/inst/doc/onlineFDR-vignette.html">https://www.bioconductor.org/packages/devel/bioc/vignettes/onlineFDR/inst/doc/onlineFDR-vignette.html</ext-link>).</p>
    <p><italic>LOND</italic> stands for ‘significance Levels based On Number of Discoveries’, and provably controls the FDR for independent <italic>P</italic>-values. The values of the adjusted significance thresholds <italic>α<sub>i</sub></italic> are directly related to the number of discoveries (i.e. rejections) made in the first <italic>i</italic> hypotheses tested. The higher the number of discoveries, the larger the adjusted significance thresholds will be. LOND can be modified to guarantee control FDR under dependent <italic>P</italic>-values, although this can come at the expense of a substantial loss in power.</p>
    <p><italic>LORD</italic> stands for ‘significance Levels based On Recent Discovery’, and also controls the FDR for independent <italic>P</italic>-values. The LORD procedures are examples of generalized alpha-investing rules, and hence have an intuitive interpretation: the procedure starts with an error budget, or alpha-wealth, and there is a price to pay each time a hypothesis is tested. When a new discovery is made, some alpha-wealth is earned back (i.e. there is a ‘return’ on the alpha-wealth invested). The adjusted significance thresholds <italic>α<sub>i</sub></italic> for LORD procedures thus depend on the alpha-wealth and the times of previous discoveries.</p>
    <p><xref rid="btz191-B6" ref-type="bibr">Javanmard and Montanari (2018)</xref> presented three versions of LORD, where LORD 1 and 2 provably control the FDR for independent <italic>P</italic>-values, with this only shown empirically for LORD 3. LORD 1 always has smaller significance thresholds (and hence a lower power) than both LORD 2 and LORD 3. The authors also presented an adjusted version of LORD that is valid for dependent <italic>P</italic>-values, but this can lead to a large loss in power. Finally, <xref rid="btz191-B8" ref-type="bibr">Ramdas <italic>et al.</italic> (2017)</xref> presented a modified version of LORD 2, called LORD++, which always has at least as large significance thresholds (and hence will have an equal or higher power).</p>
    <p><italic>Bonferroni-like procedure</italic>: This controls the FDR for a stream of <italic>P</italic>-values using a Bonferroni-like test. Given a target significance level α, the adjusted significance thresholds are chosen as <italic>α<sub>i</sub></italic> = <italic>αγ<sub>i</sub></italic>, where <italic>γ<sub>i</sub></italic> is a sequence of non-negative numbers that sum to one. This procedure is also valid for dependent <italic>P</italic>-values. Note that for independent <italic>P</italic>-values, the equivalent LOND procedure will always have an equal or higher power.</p>
  </sec>
  <sec>
    <title>3 Application examples</title>
    <p>In practice, using the onlineFDR package on a data repository with a growing family of hypotheses involves the following steps:
<list list-type="order"><list-item><p>A dataset is passed to an onlineFDR wrapper function.</p></list-item><list-item><p>For each hypothesis test, the adjusted significance threshold <italic>α<sub>i</sub></italic> is calculated.</p></list-item><list-item><p>Using the <italic>P</italic>-values provided and the adjusted significance threshold <italic>α<sub>i</sub></italic>, an indicator of discoveries <italic>R<sub>i</sub></italic> is calculated.</p></list-item><list-item><p>As the dataset grows, the new larger dataset is passed to the wrapper function, and then <italic>α<sub>i</sub></italic> and <italic>R<sub>i</sub></italic> are calculated for the new hypothesis tests (with the previous results remaining the same).</p></list-item></list></p>
    <p>In the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, we apply the procedures to simulated data where the number of false discoveries is a known quantity. This analysis demonstrates that the empirical FDR is correctly controlled over time. We have also applied the procedures to two real-life data repositories (all data and code are available as a Zenodo repository at <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.1343578">https://doi.org/10.5281/zenodo.1343578</ext-link>).</p>
    <p>The first is from the International Mouse Phenotyping Consortium (IMPC). As described in <xref rid="btz191-B7" ref-type="bibr">Karp <italic>et al.</italic> (2017)</xref>, the IMPC coordinates a large study to functionally annotate every protein coding gene by exploring the impact of the gene knockout on the resulting phenotype for up to 234 traits of interest. Data are uploaded to a public database where phenodeviants are identified using a fixed significance threshold (<italic>P </italic>&lt;<italic> </italic>0.0001). The dataset and resulting family of hypotheses constantly grow as new knockouts are studied. As part of their analysis, Karp <italic>et al.</italic> tested both the role of genotype and the role of sex as a modifier of genotype effect. Hence, the analysis resulted in two sets of <italic>P</italic>-values, one for testing genotype effects and the other for testing sexual dimorphism.</p>
    <p>The second dataset, described by <xref rid="btz191-B10" ref-type="bibr">Wildenhain <italic>et al.</italic> (2016)</xref>, contains phenotypic growth data for 240 diverse yeast gene deletion strains grown in the presence of about 5500 unique compounds. This collection has been generated to investigate how small molecule chemical-genetic fingerprints could be used to predict synergistic chemical–chemical combinations that induce lethal phenotypes. Significant phenotypic responses are identified as those with an absolute z-score greater than 4 (or equivalently, <italic>P </italic>&lt;<italic> </italic>0.000032).</p>
    <p>Visually, we can compare the different procedures by visualizing the adjusted significance thresholds over time (<xref ref-type="fig" rid="btz191-F1">Fig. 1</xref>).
</p>
    <fig id="btz191-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Adjusted significance thresholds on the log10 scale. Applied to genotype effect data from the IMPC dataset, at a FDR level of 5%. (<bold>a</bold>) LORD 3, (<bold>b</bold>) LORD++, (<bold>c</bold>) LOND and (<bold>d</bold>) Bonferroni-like</p>
      </caption>
      <graphic xlink:href="btz191f1"/>
    </fig>
    <p>We see that for LOND, the adjusted significance thresholds fall away quickly and then remain roughly constant at a very low level. The Bonferroni-like procedure continues to monotonically decrease towards zero and will always have lower significance thresholds than LOND. In contrast, the LORD procedures recover relatively high adjusted significance thresholds when discoveries are made. Visually this can be seen in <xref ref-type="fig" rid="btz191-F1">Figure 1a and b</xref> as the adjusted significance thresholds that are elevated due to recent discoveries. This explains why the LORD procedures will typically have a higher power than LOND, which in turn has a higher power than the Bonferroni-like procedures.</p>
    <p><xref rid="btz191-T1" ref-type="table">Table 1</xref> gives the number of discoveries made by the proposed procedures when applied to the two datasets. As benchmark comparisons, we used the fixed thresholds currently used by the associated databases and the Benjamini and Hochberg (BH) procedure [as well as the adjusted BH that is valid for arbitrary dependencies between <italic>P</italic>-values; see <xref rid="btz191-B2" ref-type="bibr">Benjamini and Yekutieli (2001)</xref>]. The BH procedure is an offline procedure (i.e. requiring all <italic>P</italic>-values to be available at once), and so in practice could not be applied to a growing data repository, but we include it as a ‘gold-standard’ comparison. The fixed thresholds do not provably control the FDR or adapt to the data over time.
</p>
    <table-wrap id="btz191-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Number of discoveries made by the online FDR procedures (and benchmark comparisons) for the IMPC and yeast datasets, at a FDR level of 5%</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Genotype</th>
            <th align="center" rowspan="1" colspan="1">SD</th>
            <th align="left" rowspan="1" colspan="1">Yeast</th>
            <th align="left" rowspan="1" colspan="1">Method details</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="2" colspan="1">Fixed</td>
            <td rowspan="2" colspan="1">4158</td>
            <td rowspan="2" colspan="1">969</td>
            <td rowspan="2" colspan="1">41 767</td>
            <td rowspan="1" colspan="1">IMPC &lt; 0.0001</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yeast &lt; 0.000032</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BH</td>
            <td rowspan="1" colspan="1">12 907</td>
            <td rowspan="1" colspan="1">2084</td>
            <td rowspan="1" colspan="1">55 982</td>
            <td rowspan="1" colspan="1">Benjamini and Hochberg</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LORD 3</td>
            <td rowspan="1" colspan="1">9685</td>
            <td rowspan="1" colspan="1">1343</td>
            <td rowspan="1" colspan="1">53 766</td>
            <td rowspan="1" colspan="1">Based on recent discoveries</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LORD++</td>
            <td rowspan="1" colspan="1">8517</td>
            <td rowspan="1" colspan="1">1193</td>
            <td rowspan="1" colspan="1">52 352</td>
            <td rowspan="1" colspan="1">Modified version of LORD 2</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LORD 2</td>
            <td rowspan="1" colspan="1">8049</td>
            <td rowspan="1" colspan="1">1088</td>
            <td rowspan="1" colspan="1">51 864</td>
            <td rowspan="1" colspan="1">Based on recent discoveries</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LOND</td>
            <td rowspan="1" colspan="1">2905</td>
            <td rowspan="1" colspan="1">206</td>
            <td rowspan="1" colspan="1">44 418</td>
            <td rowspan="1" colspan="1">Based on number of discoveries</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BH (dep)</td>
            <td rowspan="1" colspan="1">4078</td>
            <td rowspan="1" colspan="1">315</td>
            <td rowspan="1" colspan="1">46 486</td>
            <td rowspan="1" colspan="1">BH for arbitrary dependence</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LOND (dep)</td>
            <td rowspan="1" colspan="1">1475</td>
            <td rowspan="1" colspan="1">76</td>
            <td rowspan="1" colspan="1">40 325</td>
            <td rowspan="1" colspan="1">LOND for dependent <italic>P</italic>-values</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">LORD (dep)</td>
            <td rowspan="1" colspan="1">780</td>
            <td rowspan="1" colspan="1">25</td>
            <td rowspan="1" colspan="1">36 833</td>
            <td rowspan="1" colspan="1">LORD for dependent <italic>P</italic>-values</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Bonferroni</td>
            <td rowspan="1" colspan="1">795</td>
            <td rowspan="1" colspan="1">60</td>
            <td rowspan="1" colspan="1">34 363</td>
            <td rowspan="1" colspan="1">Bonferroni-like procedure</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>N</italic>
            </td>
            <td align="center" rowspan="1" colspan="1">172 328</td>
            <td align="center" rowspan="1" colspan="1">172 328</td>
            <td align="center" rowspan="1" colspan="1">417 026</td>
            <td rowspan="1" colspan="1"/>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p>SD, sexual dimorphism; dep, dependent; <italic>N</italic>, total number of <italic>P</italic>-values.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>We see that the LORD procedures make more discoveries than the fixed thresholds and (for LORD 2 and LORD++) are recommended as they provably control the FDR. LORD also makes substantially more discoveries than LOND, as seen in <xref ref-type="fig" rid="btz191-F1">Figure 1</xref> above for the IMPC data for example. While LOND makes fewer discoveries than the fixed threshold for the IMPC data, the latter procedure does not guarantee control of the FDR. For the yeast data, the LORD procedures even achieved a similar number of discoveries (93–96%) as the offline BH procedure. Some loss in power is expected when controlling the FDR in an online manner compared to offline procedures. In general, the power of the LORD and LOND procedures tends to increase with the fraction of non-null hypotheses. In the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, we also compare the <italic>sets</italic> of discoveries for the genotype effect data from the IMPC dataset.</p>
    <p>Meanwhile, the Bonferroni-like procedure has a relatively low number of discoveries, particularly for the yeast dataset. There is a large drop in the number of discoveries for both LORD and LOND when using methods for dependent <italic>P</italic>-values. The relative power of these procedures compared with the Bonferroni-like one depends on the number of hypothesis tests carried out and on the proportion of true nulls in the dataset; see Robertson and Wason (2018). Further research is required to characterize which dependencies (if any) inflate the FDR when using the LORD and LOND procedures designed for independent <italic>P</italic>-values.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>onlineFDR is an accessible and easy to use R package that controls the FDR for online hypothesis testing. This new tool is particularly useful in allowing bioinformaticians to control for multiplicity in growing data repositories by controlling the FDR across a family of hypotheses. Implementation of this formal framework to manage multiple testing is a substantial improvement over the <italic>ad hoc</italic> methods implemented to date and will help enable robust statistical analyses.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz191_Supplementary_Data</label>
      <media xlink:href="btz191_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank the IMPC team (via Jeremy Mason and Hamed Haseli Mashhadi) for help in preparing the IMPC dataset and for useful discussions during the development of the R package. The authors would also like to thank the anonymous reviewers for their comments and suggestions, which greatly improved the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Medical Research Council [grant code MC_UU_00002/6] and the Biometrika Trust to D.S.R; Outlier Research in Business (iORB) grant from the USC Marshall School of Business (2018) and a Google Faculty Research award (2016) to A.J NSF-CAREER [award #1844481].</p>
      <p><italic>Conflict of Interest</italic>: N.A.K. and J.W. are employees of AstraZeneca.</p>
    </sec>
  </ack>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="btz191-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>) 
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btz191-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Yekutieli</surname><given-names>D.</given-names></name></person-group> (<year>2001</year>) 
<article-title>The control of the false discovery rate in multiple testing under dependency</article-title>. <source>Ann. Stat</source>., <volume>29</volume>, <fpage>1165</fpage>–<lpage>1188</lpage>.</mixed-citation>
    </ref>
    <ref id="btz191-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bourgon</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Independent filtering increases detection power for high-throughput experiments</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>9546</fpage>–<lpage>9551</lpage>.<pub-id pub-id-type="pmid">20460310</pub-id></mixed-citation>
    </ref>
    <ref id="btz191-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ioannidis</surname><given-names>J.P.A.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Why most published research findings are false</article-title>. <source>PLoS Med</source>., <volume>2</volume>, <fpage>e124.</fpage><pub-id pub-id-type="pmid">16060722</pub-id></mixed-citation>
    </ref>
    <ref id="btz191-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Javanmard</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Montanari</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>) On online control of false discovery rate. arXiv, 1502.06197.</mixed-citation>
    </ref>
    <ref id="btz191-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Javanmard</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Montanari</surname><given-names>A.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Online rules for control of false discovery rate and false discovery exceedance</article-title>. <source>Ann. Stat</source>., <volume>46</volume>, <fpage>526</fpage>–<lpage>554</lpage>.</mixed-citation>
    </ref>
    <ref id="btz191-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Karp</surname><given-names>N.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Prevalence of sexual dimorphism in mammalian phenotypic traits</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15475</fpage>.<pub-id pub-id-type="pmid">28650954</pub-id></mixed-citation>
    </ref>
    <ref id="btz191-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ramdas</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Online control of the false discovery rate with decaying memory</article-title>. <source>Adv. Neural Inf. Proc. Syst</source>., <volume>30</volume>, <fpage>5650</fpage>–<lpage>5659</lpage>.</mixed-citation>
    </ref>
    <ref id="btz191-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Robertson</surname><given-names>D.S.</given-names></name>, <name name-style="western"><surname>Wason</surname><given-names>J.M.S.</given-names></name></person-group> (<year>2018</year>) Online control of the false discovery rate in biomedical research. arXiv: 1809.07292.</mixed-citation>
    </ref>
    <ref id="btz191-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wildenhain</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Systematic chemical-genetic and chemical-chemical interaction datasets for prediction of compound synergism</article-title>. <source>Sci. Data</source>, <volume>3</volume>, <fpage>160095.</fpage><pub-id pub-id-type="pmid">27874849</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
