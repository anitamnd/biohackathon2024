<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11017561</article-id>
    <article-id pub-id-type="publisher-id">839</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-024-00839-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PermuteDDS: a permutable feature fusion network for drug-drug synergy prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Xinwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Junqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shui</surname>
          <given-names>Youyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Mengdie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoyan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Che</surname>
          <given-names>Kai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Junjie</given-names>
        </name>
        <address>
          <email>junjie2021@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yun</given-names>
        </name>
        <address>
          <email>liuyun@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Medical Informatics, School of Biomedical Engineering and Informatics, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>The Second Clinical Medical School, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Institute of Medical Informatics and Management, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Information, </institution><institution>the First Affiliated Hospital, Nanjing Medical University, </institution></institution-wrap>No. 300 Guang Zhou Road, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01yqg2h08</institution-id><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>Faculty of Computing, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>No. 92 West Da Zhi St, Harbin, 150001 Heilongjiang China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.424071.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 1755 1589</institution-id><institution>Xi’an Aeronautics Computing Technique Research Institute, AVIC, </institution></institution-wrap>No. 156, TaiBai Nroth Road, Xi’an, 710068 Shanxi China </aff>
      <aff id="Aff7"><label>7</label>Aviation Key Laboratory of Science and Technology on Airborne and Missleborne Computer, Xi’an, 710065 Shanxi China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>41</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Motivation</title>
        <p id="Par1">Drug combination therapies have shown promise in clinical cancer treatments. However, it is hard to experimentally identify all drug combinations for synergistic interaction even with high-throughput screening due to the vast space of potential combinations. Although a number of computational methods for drug synergy prediction have proven successful in narrowing down this space, fusing drug pairs and cell line features effectively still lacks study, hindering current algorithms from understanding the complex interaction between drugs and cell lines.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, named PermuteDDS. PermuteDDS takes multiple representations of drugs and cell lines as input and employs a permutable fusion mechanism to combine drug and cell line features. In experiments, PermuteDDS exhibits state-of-the-art performance on two benchmark data sets. Additionally, the results on independent test set grouped by different tissues reveal that PermuteDDS has good generalization performance. We believed that PermuteDDS is an effective and valuable tool for identifying synergistic drug combinations. It is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link>.</p>
      </sec>
      <sec>
        <title>Scientific contribution</title>
        <p id="Par3">First, this paper proposes a permutable feature fusion network for predicting drug synergy termed PermuteDDS, which extract diverse information from multiple drug representations and cell line representations. Second, the permutable fusion mechanism combine the drug and cell line features by integrating information of different channels, enabling the utilization of complex relationships between drugs and cell lines. Third, comparative and ablation experiments provide evidence of the efficacy of PermuteDDS in predicting drug-drug synergy.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-024-00839-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Drug combination</kwd>
      <kwd>Permutable feature fusion</kwd>
      <kwd>Synergistic effect</kwd>
      <kwd>Cancer</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271174</award-id>
        <award-id>No.62202373</award-id>
        <award-id>No.62102191</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Xiaoyan</given-names>
          </name>
          <name>
            <surname>Che</surname>
            <given-names>Kai</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Junjie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department</institution>
        </funding-source>
        <award-id>no.BE2020721</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"</institution>
        </funding-source>
        <award-id>TC210804V</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021</institution>
        </funding-source>
        <award-id>no. [2021]92</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Key Project of Smart Jiangsu in 2020</institution>
        </funding-source>
        <award-id>no. [2021]1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service</institution>
        </funding-source>
        <award-id>no. [2020]1460</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par23">Single-agent targeted therapies have been widely utilized in clinical cancer treatments. However, the clinical efficacy of monotherapy remains limited due to the biological complexity of tumors and the presence of pre-existing or acquired drug resistance mechanisms [<xref ref-type="bibr" rid="CR1">1</xref>]. In contrast, combination therapies involving the simultaneous administration of multiple drugs have shown promising results in cancer treatment [<xref ref-type="bibr" rid="CR2">2</xref>]. Compared to monotherapy, combination therapies have the potential to enhance treatment efficacy, reduce the dose-limiting toxicity associated with single agents, and overcome drug resistance [<xref ref-type="bibr" rid="CR3">3</xref>]. Despite the potential benefits, it is important to note that not all drug combinations exhibit synergistic effects, and some combinations may even result in antagonistic interactions [<xref ref-type="bibr" rid="CR4">4</xref>]. Therefore, it is essential to accurately determine the interaction between drug combinations to specific diseases.</p>
    <p id="Par24">Traditionally, the discovery of drug combinations heavily relied on clinical trials, posing challenges in terms of time consumption and cost-effectiveness due to the extensive number of potential drug combinations [<xref ref-type="bibr" rid="CR5">5</xref>]. An alternative method is high-throughput screening (HTS), which enables automated testing of chemical and biological compounds against specific biological targets [<xref ref-type="bibr" rid="CR6">6</xref>]. HTS techniques have significantly reduced the time required for identifying potential drug combinations. However, it is important to note that HTS has limitations in revealing the in vivo action modes of drug molecules [<xref ref-type="bibr" rid="CR7">7</xref>]. Moreover, the substantial increase in the number of available drugs has rendered it impractical to comprehensively test the entire combinatorial space using HTS [<xref ref-type="bibr" rid="CR8">8</xref>]. The sheer magnitude of potential drug combinations poses a challenge in terms of feasibility and resource utilization.</p>
    <p id="Par25">Computational methods, particularly machine learning models, have emerged as powerful tools for exploring the vast synergistic space of drug combinations [<xref ref-type="bibr" rid="CR9">9</xref>]. These machine learning-based models can be broadly categorized into two types: classical machine learning and deep learning. Classical machine learning models, such as random forest [<xref ref-type="bibr" rid="CR10">10</xref>], support vector machine (SVM) [<xref ref-type="bibr" rid="CR11">11</xref>], extreme gradient boosting (XGBoost) [<xref ref-type="bibr" rid="CR12">12</xref>], have been widely utilized in drug synergy prediction. These models leverage genomic information from cancer cells, physiochemical properties of drugs, and drug-cell interaction data to predict drug synergy [<xref ref-type="bibr" rid="CR13">13</xref>]. For instance, Jeon et al. [<xref ref-type="bibr" rid="CR14">14</xref>] employed random forest and SVM algorithms to predict the synergistic effects of anticancer drug combinations by incorporating monotherapy response and synthetic lethality information. However, this approach heavily relies on the given dataset, and the model may struggle to accurately predict the features of drug combinations without prior knowledge. Another study by He et al. [<xref ref-type="bibr" rid="CR15">15</xref>] proposed an XGBoost-based model that predicts the selective synergistic effects of cancer by utilizing distinct single compound sensitivity curves between patient cells and healthy controls. This approach aimed to minimize potential toxicity associated with drug combinations.</p>
    <p id="Par26">Recently, deep learning has gained increasing popularity in drug development and discovery. Compare to classical machine learning methods, deep learning algorithms have better generalization performance, making it efficient in handling large drug combination datasets. Deep learning-based methods typically frame the challenge of drug synergy prediction as a regression task, aiming to predict the quantitative synergy scores. These methods can be categorized into three groups: fingerprint-based methods, SMILE-based methods and graph-based methods. Fingerprint-based methods take molecular fingerprint (also called descriptor) as input. Preuer et al. [<xref ref-type="bibr" rid="CR9">9</xref>] proposed DeepSynergy, a feedforward neural network-based deep learning model for drug synergy score prediction that employs molecular fingerprints and gene expression as inputs. The performance of DeepSynergy demonstrated significant improvement over classical machine learning models. Kuru et al. [<xref ref-type="bibr" rid="CR16">16</xref>] developed a MatchMaker model for predicting synergistic drug combinations using chemical descriptors generated by ChemoPy [<xref ref-type="bibr" rid="CR17">17</xref>] and the expression profiles of landmark genes as input. Lin et al. [<xref ref-type="bibr" rid="CR18">18</xref>] amalgamated molecular fingerprint information with drug induced gene expression profiles to capture drug cell responses to reveal the mechanisms of biological synergistic effects, and using deep forests as feature learning models. Hosseini et al. [<xref ref-type="bibr" rid="CR19">19</xref>] proposed CCSynergy, used a feed forward network to obtain the fusion feature of drug fingerprints and mutiple cell line representations for durg syergy prediction. SMILE-based methods select simplified molecular-input line-entry system (SMILES) [<xref ref-type="bibr" rid="CR20">20</xref>] as drug representations. Kim et al. [<xref ref-type="bibr" rid="CR21">21</xref>] utilized a muti-head attention mechanism and convolutional neural networks (CNN) to encode drug SMILES. Graph-based methods that extract features from molecular graphs have the potential to capture structural information about the molecules [<xref ref-type="bibr" rid="CR22">22</xref>]. Wang et al. [<xref ref-type="bibr" rid="CR23">23</xref>] proposed DeepDDS, a model that utilizes a graph convolutional network (GCN) and attention mechanism to compute drug embedding vectors, which are integrated with cell line gene expression data to predict drug synergy. Liu et al. [<xref ref-type="bibr" rid="CR24">24</xref>] proposed HypergraphSynergy, a method employing hypergraph representation learning to predict anti-cancer drug synergy by considering drugs and cell lines as nodes and representing drug pair-cell line triplets as hyperedges.</p>
    <p id="Par27">The previously mentioned deep learning-based methods have exhibited impressive performance in predicting drug synergy, yet there is still room for further improvement. One limitation is that these methods typically only use single type drug representation, thereby failing to provide a comprehensive description of drugs. Moreover, most of these methods simply fuse drug and cell line features through simple operations such as concatenation or addition, neglecting dynamic synergies between drug pairs and cell lines.</p>
    <p id="Par28">In light of the limitations associated with existing approaches for predicting drug synergy, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, namely PermuteDDS. Our method addresses the challenge of limited representation types by considering multiple representations of drugs and cell lines. We employed the one-dimensional CNN to learn and extract high-latent features from these representations. Then, we designed a permutable fusion mechanism to combine the drug and cell line features, allowing us to capture the complex relationships between drug combinations and cell lines. Finally, we conducted experiments on two benchmark datasets, and the results compared to state-of-the-art methods indicated that PermuteDDS is an effective model for drug synergy prediction. In summary, the contributions of our work are as follows:<list list-type="bullet"><list-item><p id="Par29">We propose PermuteDDS, a deep learning model for drug-drug synergy prediction with multiple input representations.</p></list-item><list-item><p id="Par30">Our major contribution lies in the application of the permutable fusion mechanism to represent the interactions between drug combinations and cell lines.</p></list-item><list-item><p id="Par31">We conduct comprehensive experiments to demonstrate the effectiveness of our proposed model. We present ablations and analysis to gain a deeper understanding of the model’s behavior.</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Data description</title>
      <p id="Par32">We collected Drug-Drug Synergy (DDS) data, molecular structures of drugs, the expression profiles and mutation information of cell lines from various public databases as below.<list list-type="bullet"><list-item><p id="Par33"><bold>Drug-Drug Synergy datasets.</bold> The Drug-Drug Synergy (DDS) data were obtained from two released large-scale oncology screening datasets, namely O’Neil [<xref ref-type="bibr" rid="CR25">25</xref>] and NCI-ALMANAC [<xref ref-type="bibr" rid="CR26">26</xref>]. The O’Neil dataset contains 22 737 samples estimated by Loewe synergy score [<xref ref-type="bibr" rid="CR27">27</xref>] consisting of two chemicals and a cell line, covering 38 unique drugs and 39 diverse caner cell lines. The NCI-ALMANAC dataset comprises 304 549 samples evaluated by the ComboScores of pairwise combinations of 104 FDA-approved anticancer drugs against a panel of 60 well-characterized human tumor cell lines.</p></list-item><list-item><p id="Par34"><bold>Drug synergy scores.</bold> The Loewe synergy score incorporates the concepts of sham combination and dose equivalence. Let <italic>A</italic> and <italic>B</italic> denote two drugs, and <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_A$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_B$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq3.gif"/></alternatives></inline-formula> represent their respective doses. The drug synergy score can then be computed as follows [<xref ref-type="bibr" rid="CR27">27</xref>]: <disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{Loewe}=\frac{R_{\min }+R_{\max }\left( \frac{x_A+x_B}{m}\right) ^\lambda }{1+\left( \frac{x_A+x_B}{m}\right) ^\lambda } \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{Loewe}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq4.gif"/></alternatives></inline-formula> is a continuous value, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq6.gif"/></alternatives></inline-formula> represents the maximum and minimum drug response, respectively. <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M14"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq7.gif"/></alternatives></inline-formula> is the shape parameter and <italic>m</italic> is the dose that produce midpoint between <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq9.gif"/></alternatives></inline-formula>. The determination of combination benefit, denoted as ‘ComboScore’ [<xref ref-type="bibr" rid="CR26">26</xref>], relies on a modification of Bliss independence [<xref ref-type="bibr" rid="CR28">28</xref>]. Let <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}^{A_p B_q}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq10.gif"/></alternatives></inline-formula> represent the growth fraction for the <italic>i</italic>-th cell line exposed to the <italic>p</italic>-th concentration of drug A and the <italic>q</italic>-th concentration of drug B. Similarly, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_i^{A_p B_q}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq11.gif"/></alternatives></inline-formula> denote the expected growth fraction for the combination. The final continuous combination score <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ComboScore}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq12.gif"/></alternatives></inline-formula> for the cell line and the drug combination can then be computed as the sum of the differences between expected and observed growth fractions: <disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ComboScore}=\sum _{p, q} Y_i^{A_p B_q}-Z_i^{A_p B_q} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par35"><bold>Molecular structures of drugs.</bold> The SMILES of the drugs were obtained from PubChem database [<xref ref-type="bibr" rid="CR29">29</xref>], based on which the chemical and structure information of a drug can be converted to fingerprints with RDKit [<xref ref-type="bibr" rid="CR30">30</xref>] and MAP4 project.<xref ref-type="fn" rid="Fn1">1</xref></p></list-item><list-item><p id="Par37"><bold>Gene expression and gene mutation of cell lines.</bold> The gene expression and gene mutation of cell lines were obtained from Genomics of Drug Sensitivity in Cancer (GDSC) database,<xref ref-type="fn" rid="Fn2">2</xref>. where 1000 human cancer cell lines were characterised and screened [<xref ref-type="bibr" rid="CR31">31</xref>]. To enhance the representation of cell lines, we identified significant genes by referencing The Library of Integrated Network-Based Cellular Signatures (LINCS) project [<xref ref-type="bibr" rid="CR32">32</xref>]. The LINCS project offers a meticulously curated set of approximately 1000 genes, known as the ‘landmark gene set’, which captures 80% of the information from Connectivity Map data [<xref ref-type="bibr" rid="CR33">33</xref>]. We selected genes that intersected between GDSC gene expression profiles and the landmark set, as well as gene mutation profiles. Finally, 899 genes were chosen for expression profiles, and 968 genes were selected for mutation profiles.</p></list-item></list>We preprocessed the two dataset by eliminating the drugs lacking SMILES and the cell lines devoid of gene expressions or gene mutations. The resulting refined O’Neil dataset comprised 18 950 samples with Loewe synergy scores across 38 drugs and 39 cell lines, while the processed NCI-AlMANAC dataset consisted of 74 139 instances with NCI ComboScores (a Bliss independence modification) across 87 drugs and 55 cell lines.</p>
    </sec>
    <sec id="Sec4">
      <title>Molecular fingerprints</title>
      <p id="Par39">Molecular fingerprints (also referred to as descriptors) is a prevalent method of drug representation. Within this approach, each molecule is encoded as a binary string that delineate the presence or absence of specific substructure fragments or properties within the molecule. A value of 0 corresponds to absence of the particular feature, while a value of 1 denotes its existence. Moreover, the fingerprints exhibit uniqueness; specifically, one molecule possesses one sequence for a particular fingerprints type, yet it can have numerous diverse fingerprints types [<xref ref-type="bibr" rid="CR22">22</xref>]. The three different kinds of fingerprints employed in this article are described below.<list list-type="bullet"><list-item><p id="Par40"><bold>Hashed topological-torsion (HashTT)</bold> is a kind of topological fingerprints [<xref ref-type="bibr" rid="CR34">34</xref>]. The fragments employed in HashTT fingerprints are linear sequence comprising four consecutively bonded non-hydrogen atoms. The label for each fragment is determined based on its atomic type, the number of non-hydrogen branches attached to it, and its number of 7r electrons of each atom. These labels then undergo a hashing process to generate the HashTT fingerprints.</p></list-item><list-item><p id="Par41"><bold>MinHashed atom-pair fingerprint up to a diameter of four bonds (MAP4)</bold> [<xref ref-type="bibr" rid="CR35">35</xref>] is a novel fingerprint that integrates both substructure fingerprints and atom-pair fingerprints. Given a molecule SMILE sentence, the circular substructures with radii of r = 1 and r = 2 bonds around individual atoms within an atom-pair configuration are encoded as two pairs of SMILES. Each pair is subsequently combined with the topological distance separating the central atoms. These atom-pair molecular shingles undergo a hashing process, and the resulting set of hashes is subjected to the MinHashed technique, which lead to the creation of the MAP4 fingerprint.</p></list-item><list-item><p id="Par42"><bold>Molecular ACCess System (MACCS)</bold> [<xref ref-type="bibr" rid="CR36">36</xref>] keys are one of the most commonly used structural fingerprints. In this fingerprint, one molecule is encoded as a 166-bit binary string, where each bit corresponds to a predefined structural fragment (e.g. 3-element ring).</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>The overview of the PermuteDDS framework</p></caption><graphic xlink:href="13321_2024_839_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Overview of PermuteDDS</title>
      <p id="Par43">PermuteDDS is an end-to-end framework for predicting drug combinations, presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Specifically, Fig. <xref rid="Fig1" ref-type="fig">1</xref>(A) illustrates the pipeline implemented by PermuteDDS to derive the synergy scores. Our framework contains three subnetworks called Fingerprint Specific Networks (FSNs), all of which share the same architecture shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(B). Each FSN takes a drug pair of a certain fingerprint and a cell line pair including its gene expression and gene mutation profiles as inputs. Then, the CNNs are used to extract drug and cell line features, and the Permute-MLP module (Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C)) is proposed to obtain the fusion synergy feature, which is the output of FSN. The three FSNs output three distinct synergy features, each of which is propagated through a specific prediction module to generate a synergy score. The final outputs of PermuteDDS is the average of the synergy scores predicted by these prediction modules.</p>
    </sec>
    <sec id="Sec6">
      <title>Fingerprint specific subnetwork (FSN)</title>
      <p id="Par44">Given a drug fingerprint pair and a cell line pair as inputs, the FSN encompasses three essential processes, including drug features extraction, cell line features extraction and feature fusion, which integrates the extracted drug and cell line features. The output of FSN is a synergy feature. A comprehensive overview of these processes is provided below.<fig id="Fig2"><label>Fig. 2</label><caption><p>The architecture of the three-layer Conv1D</p></caption><graphic xlink:href="13321_2024_839_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par45"><bold>Drug features</bold>   To extract the drug fingerprint features, we used the one-dimensional convolutional neural network (Conv1D), where 1D array-like kernel convolves along a single dimension and identify the patterns from fingerprint information. Here, we considered three different fingerprints include Hashtt(<italic>t</italic>), MAP4(<italic>p</italic>) and MACCS(<italic>s</italic>). We conducted a three-layer Conv1D model, as illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. An input fingerprint sequence is represented as <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_d\in {\mathbb {R}}^{L\times 1}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq13.gif"/></alternatives></inline-formula> in which <italic>L</italic> denotes the length, 1 denotes the dimension and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d \in \{t, p, s\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq14.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+j}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq15.gif"/></alternatives></inline-formula> refer to the concatenation of tokens <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_i, {\textbf{X}}_{i+1},..., {\textbf{X}}_{i+j}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq16.gif"/></alternatives></inline-formula> in the sequence, a feature <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq17.gif"/></alternatives></inline-formula> can be generated from the window of tokens <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq18.gif"/></alternatives></inline-formula> by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} z_i=\textrm{GELU}\left( {\textbf{W}}_k \cdot {\textbf{X}}_{i: i+h-1}+b_k\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{GELU}$$\end{document}</tex-math><mml:math id="M42"><mml:mtext>GELU</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq19.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR37">37</xref>] is an activation function, <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_k\in {\mathbb {R}}^{h\times 1 \times k}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq20.gif"/></alternatives></inline-formula> is a <italic>k</italic>-channel (here is 8) filter applied to a window of <italic>h</italic> token, <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_k\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq21.gif"/></alternatives></inline-formula> is a bias term and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq22.gif"/></alternatives></inline-formula> is a feature generated from the window of tokens <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq23.gif"/></alternatives></inline-formula>. Then, the filter is applied to each possible window of tokens to produce a feature map<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{z}} = \textrm{Concat}(z_1, z_2,..., z_L), \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>=</mml:mo><mml:mtext>Concat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Concat$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq24.gif"/></alternatives></inline-formula> refers to the concatenation process and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{z}}\in {\mathbb {R}}^{L\times k}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq25.gif"/></alternatives></inline-formula>. Subsequently, we conducted similar operations as above with different filter channels (16 and 32 respectively) in the next layers and then got an output <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {z'}\in {\mathbb {R}}^{L\times k'}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq26.gif"/></alternatives></inline-formula> in which <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k'}$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq27.gif"/></alternatives></inline-formula> denote the output channel (here is 32) of the third layer. To obtained the final drug features with expected dimension <italic>D</italic>, we conducted a projection process as follow:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{Z}}_d = {\textbf{W}}_d \cdot \textrm{Flatten}(\mathbf {z'}) + b_d, \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Flatten$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq28.gif"/></alternatives></inline-formula> refers to the flattening process, <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_d\in {\mathbb {R}}^{Lk'\times D}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq29.gif"/></alternatives></inline-formula> is the weight matrix, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_d$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq30.gif"/></alternatives></inline-formula> is the bias term and <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_d\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq31.gif"/></alternatives></inline-formula> is the output drug features. Then, given a drug pair (<italic>i</italic>, <italic>j</italic>), the pairwise features can be represented as <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\textbf{Z}}_{di}, {\textbf{Z}}_{dj})$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq32.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{di}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{dj}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq34.gif"/></alternatives></inline-formula>.</p>
      <p id="Par46"><bold>Cell line features</bold>   To derive cell line features, we employed two distinct three-layer CNNs individually for gene expression (<italic>e</italic>) and gene mutation (<italic>m</italic>) data. Consistent with the fingerprint sequence, an initial gene expression sequence can be represented as <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_{e}\in {\mathbb {R}}^{l\times 1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq35.gif"/></alternatives></inline-formula> in which <italic>l</italic> denotes the number of selected genes and 1 is the dimension. We then conducted the same operations described in the Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>, <xref rid="Equ4" ref-type="disp-formula">4</xref> and <xref rid="Equ5" ref-type="disp-formula">5</xref> to obtained the gene expression features <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{e}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq36.gif"/></alternatives></inline-formula> with <italic>D</italic> represents the output dimension, which aligns with the dimension of drug features. Similarly, the extracted gene mutation features are represented as <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{m}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq37.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47"><bold>Feature fusion</bold>   Recent works [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] have demonstrated the superior performance of Multilayer Perceptron (MLP) in feature fusion tasks. Motivated by these findings, we conducted a MLP-based method to extract fusion feature of drug fingerprints and cell lines. Given a triplet of drug pairs and cell line, a feature <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{H}}_d \in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq38.gif"/></alternatives></inline-formula> is constructed by<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{H}}_d = \textrm{Stack}({\textbf{Z}}_{di}, {\textbf{Z}}_{dj}, {\textbf{Z}}_{e}, {\textbf{Z}}_{m}). \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Stack</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>N</italic> corresponds to the value 4, reflecting the number of features utilized in the stacking process. We then employed two Permute-MLP blocks taken the feature <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq39.gif"/></alternatives></inline-formula> as input. A diagrammatic illustration of the Permute-MLP block is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C). First, we conducted a MLP unit along the <italic>D</italic>-channel, which can be formulated as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{\textbf{H}}_d={\textbf{H}}_d+\textrm{LN}(\textrm{Swish}({\textbf{H}}_d{\textbf{W}}_{dD}^1){\textbf{W}}_{dD}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq40"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Swish}$$\end{document}</tex-math><mml:math id="M92"><mml:mtext>Swish</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq40.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR40">40</xref>] is an activation function, <inline-formula id="IEq41"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{LN}$$\end{document}</tex-math><mml:math id="M94"><mml:mtext>LN</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq41.gif"/></alternatives></inline-formula> refers to LayerNorm [<xref ref-type="bibr" rid="CR41">41</xref>], <inline-formula id="IEq42"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dD}^1, {\textbf{W}}_{dD}^2\in {\mathbb {R}}^{D\times D}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq42.gif"/></alternatives></inline-formula> are the weight matrices and <inline-formula id="IEq43"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq43.gif"/></alternatives></inline-formula>. Then, we perform a <inline-formula id="IEq44"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\text{- }D$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>N</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq44.gif"/></alternatives></inline-formula> permutation operation with respect to <inline-formula id="IEq45"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq45.gif"/></alternatives></inline-formula>, yielding <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq46.gif"/></alternatives></inline-formula>, which is serve as the input to the next MLP unit along the <italic>N</italic>-channel. This process can be described as<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \overline{\textbf{H}}_d = \widehat{\textbf{H}}_d^{\top }+\textrm{LN}(\textrm{Swish}(\widehat{\textbf{H}}^{\top }_d{\textbf{W}}_{dN}^1){\textbf{W}}_{dN}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^1\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^2\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq49.gif"/></alternatives></inline-formula>. To recover the original dimensional information to <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq50.gif"/></alternatives></inline-formula>, we only need to perform a <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\text{- }N$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>D</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq51.gif"/></alternatives></inline-formula> permutation operation on <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq52.gif"/></alternatives></inline-formula>, outputting <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msubsup><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq53.gif"/></alternatives></inline-formula>, which is the input to the next Permute-MLP block. Similarly, we conducted the same operations as above in the second block and obtained a fusion feature <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq54.gif"/></alternatives></inline-formula>. Furthermore, we conducted projection process to obtain the final synergy feature<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{M}}_d=\textrm{GELU}(\textrm{Flatten}(\widetilde{\textbf{H}}_d){\textbf{W}}_{dproj}^1){\textbf{W}}_{dproj}^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^1\in {\mathbb {R}}^{ND\times \widehat{D}}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq55.gif"/></alternatives></inline-formula> with hidden size <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{D}$$\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq56.gif"/></alternatives></inline-formula>, <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^2\in {\mathbb {R}}^{\widehat{D}\times \widetilde{D}}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq57.gif"/></alternatives></inline-formula> with the output dimension <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{D}$$\end{document}</tex-math><mml:math id="M132"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq58.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_d\in {\mathbb {R}}^{\widetilde{D}}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq59.gif"/></alternatives></inline-formula> is the output of <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_d$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq60.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec7">
      <title>Predicting the synergistic effect</title>
      <p id="Par48">The objective of drug synergy prediction is to derive a synergy score for a given drug pair and cell line trio. The process outlined above results in the generation of three distinct synergy features, denoted as <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_t$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_p$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_s$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq63.gif"/></alternatives></inline-formula>, through the utilization of the respective modules <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_t$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_p$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq65.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_s$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq66.gif"/></alternatives></inline-formula>. Each of the generated features was then propagated to a specific prediction module, which consisted of two linear transformations with a GELU activation in between, and output a synergy score <inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_d\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq67.gif"/></alternatives></inline-formula>. In other words, we got three different synergy scores denoted as <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_t$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq68.gif"/></alternatives></inline-formula>, <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_p$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_s$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq70.gif"/></alternatives></inline-formula>. Given a drug-drug-cell line trio, the final predicted synergy score <inline-formula id="IEq71"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}$$\end{document}</tex-math><mml:math id="M158"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq71.gif"/></alternatives></inline-formula> can be calculated as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{y}} = \frac{1}{3}({\hat{y}}_t+{\hat{y}}_p+{\hat{y}}_s) \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Then, the mean square error (MSE) is adopted as the loss function to train the model, which is defined as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}_{MSE} = \frac{1}{n} \sum _{i=1}^n\left( y_i-{\hat{y}}_i\right) ^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">MSE</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> represents the number of training set and <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq72.gif"/></alternatives></inline-formula> is the real score of a given trio.</p>
    </sec>
    <sec id="Sec8">
      <title>Experimental setup</title>
      <sec id="Sec9">
        <title>Data split strategies</title>
        <p id="Par49">We first randomly selected 90% samples from each dataset to conduct a 5-fold cross-validation strategy. To benchmark the performance of graph-fp under different situations, we considered three different strategies shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>:<list list-type="bullet"><list-item><p id="Par50"><bold>Random-split</bold>. The training samples were randomly partitioned into five equal folds. Four of these folds were utilized as the training set, while the remaining one was designated as the test set.</p></list-item><list-item><p id="Par51"><bold>Leave-cell-out</bold>. The cell line set was randomly partitioned into five equal folds. Samples containing the cell lines in four of these folds were used as the training set, while the remaining samples were assigned to the test set. This ensured that the test set contained only cell lines that were not included in the training set.</p></list-item><list-item><p id="Par52"><bold>Leave-combination-out</bold>. The set of drug combinations was randomly partitioned into five equal folds. Samples containing the drug combinations in four of these folds were used as the training set, while the remaining samples were used as the test set, ensuring that the test set only contained unseen drug combinations that were not present in the training set.</p></list-item></list><fig id="Fig3"><label>Fig. 3</label><caption><p>Three different data split strategies. The white parts are used as training and validation data. The grey parts indicate testing data</p></caption><graphic xlink:href="13321_2024_839_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par53">Furthermore, to verify the generalization ability of our method, we used the remaining 10% samples as the independent test set. The models were first trained and evaluated on the cross validation set, and then tested on the independent test set.</p>
      </sec>
      <sec id="Sec10">
        <title>Baselines</title>
        <p id="Par54">To evaluate the performance of our model, we compared it with several competitive deep learning methods.<list list-type="bullet"><list-item><p id="Par55"><bold>HypergraphSynergy</bold> [<xref ref-type="bibr" rid="CR24">24</xref>] employed Hypergraph Neural Networks (HGNN) to predict drug synergy with hypergraphs as input. In this method, drugs and cell lines are represented as nodes, while synergistic drug-drug-cell line triplets are represented as hyperedges. We reproduced the results of HypergraphSynergy and obtained the remaining results as reported in the HypergraphSynergy paper.</p></list-item><list-item><p id="Par56"><bold>DeepSynergy</bold> [<xref ref-type="bibr" rid="CR9">9</xref>] takes molecular chemistry and cell line gene expression as input and used a feed forward neural network to predict synergy scores.</p></list-item><list-item><p id="Par57"><bold>DTF</bold> [<xref ref-type="bibr" rid="CR42">42</xref>] utilized a tensor factorization to decompose drug synergy matrix and the results of the tensor decomposition are used as features to train the DNN model for drug synergy prediction.</p></list-item><list-item><p id="Par58"><bold>CombFM</bold> [<xref ref-type="bibr" rid="CR43">43</xref>] used a higher-order factorization machine to predict synergy scores with a higher-order tensor as input which is compiled by drugs, drug concentrations and cell lines.</p></list-item><list-item><p id="Par59"><bold>Celebi’s method</bold> [<xref ref-type="bibr" rid="CR44">44</xref>] integrate drug synergy features with multiple biological and chemical properties’ features and employed an XG-Boost model to predict synergy scores.</p></list-item></list></p>
      </sec>
      <sec id="Sec11">
        <title>Evaluation metrics</title>
        <p id="Par60">We regarded the drug synergy prediction as a regression task, which objective is to predict the quantitative synergy scores of drug combinations. The regression results were evaluated by three metrics: the root man squared error (RMSE), the coefficient of determination (<inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq73.gif"/></alternatives></inline-formula>) and Pearson’s Correlation Coefficient (PCC). These evaluation metrics are calculated as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{RMSE}= &amp; {} \sqrt{\frac{\sum \limits _{i=1}^n\left( y_t^i-y_p^i\right) ^2}{n}} \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{R}^2= &amp; {} 1-\frac{\textrm{RMSE}^2}{{\text {Var}}\left( y_t^i\right) },\quad \textrm{ where } {\text {Var}}\left( y_t\right) =\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mtext>RMSE</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mtext>Var</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>where Var</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{PCC}= &amp; {} \frac{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) \left( y_p^i-\bar{y}_p\right) }{\sqrt{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2} \sqrt{\sum \limits _{i=1}^n\left( y_p^i-\bar{y}_p\right) ^2}} \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>PCC</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>In the equations, <inline-formula id="IEq74"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_t$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_p$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq75.gif"/></alternatives></inline-formula> denotes the true synergy scores and predicted synergy scores, respectively. <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_t$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_p$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq77.gif"/></alternatives></inline-formula> represent the mean value of the true synergy scores and predicted synergy scores, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results</title>
    <sec id="Sec13">
      <title>Performance comparison on cross validation</title>
      <p id="Par61">The 5-fold cross validation results of PermuteDDS and other competitive methods on O’Neil dataset are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. It can be easily seen that our PermuteDDS surpassed all baselines by a large margin on the random split task, e.g. 9.4% relative <inline-formula id="IEq78"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq78.gif"/></alternatives></inline-formula> increase compared to the previous state-of-art method. Compared with random split task, leave-cell-out and leave-combination-out are more challenging, which test the performance of prediction models on unseen drug combinations/cell lines. On these two tasks, the performance of all methods decreased significantly compared to random split task. PermuteDDS performed slightly worse than HypergraphSynergy on the leave-cell-out task. This may be attributed to the fact that HypergraphSynergy utilized an auxiliary task that involved reconstructing cell line and drug similarity networks, which can enhance the robustness of the model on leave-cell-out task. However, this auxiliary task took all drugs and cell lines as input, resulting in the presence of unknown combinations and cell lines solely within the prediction module. Despite these considerations, the performance gap between our method and HypergraphSynergy remains quite small. As for the leave-combination-out task, PermuteDDS achieved the best results, with 19.3% relative <inline-formula id="IEq79"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq79.gif"/></alternatives></inline-formula> increase and 8.1% relative PCC increase compared to HypergraphSynergy. These results highlight the superior predictive capabilities of PermuteDDS in accurately estimating drug synergy.</p>
      <p id="Par62">Table <xref rid="Tab2" ref-type="table">2</xref> shows that the performance of the models is comparatively lower on the NCI-ALMANAC dataset in comparison to the O’Neil dataset. This observation could be attributed to the fact that the NCI-ALMANAC dataset encompasses a wider range of drugs and cell lines, thereby increasing the complexity of prediction. However, PermuteDDS still achieved better performance in most cases. Regarding the random split task, PermuteDDS demonstrated superior performance compared to other state-of-the-art approaches. It achieved a RMSE of 43.053, a <inline-formula id="IEq80"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M186"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq80.gif"/></alternatives></inline-formula> of 0.527 and a PCC of 0.726. However, similar to the results on the O’Neil dataset, our method only achieved competitive results compared to other methods. However, in the leave-combination-out task, PermuteDDS outperformed all other baseline methods by a large margin, achieving the lowest RMSE of 51.58, the highest <inline-formula id="IEq81"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq81.gif"/></alternatives></inline-formula> of 0.318 and the highest PCC of 0.569.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison on the O’Neil dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq82"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq82.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq83"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq83.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq84.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>13</bold>.<bold>721</bold></td><td align="left"><bold>0</bold>.<bold>641</bold></td><td align="left"><bold>0</bold>.<bold>801</bold></td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left"><bold>16</bold>.<bold>152</bold></td><td align="left"><bold>0</bold>.<bold>501</bold></td><td align="left"><bold>0</bold>.<bold>709</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">14.727</td><td align="left">0.586</td><td align="left">0.775</td><td align="left"><bold>19</bold>.<bold>537</bold></td><td align="left"><bold>0</bold>.<bold>252</bold></td><td align="left">0.533</td><td align="left">17.346</td><td align="left">0.420</td><td align="left">0.656</td></tr><tr><td align="left">DeepSynergy</td><td align="left">14.87</td><td align="left">0.584</td><td align="left">0.765</td><td align="left">23.890</td><td align="left">0.195</td><td align="left">0.426</td><td align="left">17.28</td><td align="left">0.433</td><td align="left">0.663</td></tr><tr><td align="left">ComboFM</td><td align="left">16.86</td><td align="left">0.451</td><td align="left">0.702</td><td align="left">20.820</td><td align="left">0.142</td><td align="left">0.396</td><td align="left">18.62</td><td align="left">0.376</td><td align="left">0.635</td></tr><tr><td align="left">DTF</td><td align="left">14.73</td><td align="left">0.594</td><td align="left">0.775</td><td align="left">21.110</td><td align="left">0.132</td><td align="left"><bold>0</bold>.<bold>535</bold></td><td align="left">17.37</td><td align="left">0.429</td><td align="left">0.671</td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.34</td><td align="left">0.5</td><td align="left">0.708</td><td align="left">20.6</td><td align="left">0.179</td><td align="left">0.473</td><td align="left">19.1</td><td align="left">0.309</td><td align="left">0.572</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison on the NCI-ALMANAC dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq85.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq86.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq87.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>43</bold>.<bold>053</bold></td><td align="left"><bold>0</bold>.<bold>527</bold></td><td align="left"><bold>0</bold>.<bold>726</bold></td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left"><bold>51</bold>.<bold>58</bold></td><td align="left"><bold>0</bold>.<bold>318</bold></td><td align="left"><bold>0</bold>.<bold>569</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">43.89</td><td align="left">0.508</td><td align="left">0.719</td><td align="left"><bold>53</bold>.<bold>398</bold></td><td align="left"><bold>0</bold>.<bold>273</bold></td><td align="left"><bold>0</bold>.<bold>538</bold></td><td align="left">52.609</td><td align="left">0.291</td><td align="left">0.543</td></tr><tr><td align="left">DeepSynergy</td><td align="left">44.44</td><td align="left">0.491</td><td align="left">0.701</td><td align="left">54.560</td><td align="left">0.230</td><td align="left">0.322</td><td align="left">53.500</td><td align="left">0.262</td><td align="left">0.526</td></tr><tr><td align="left">ComboFM</td><td align="left">48.27</td><td align="left">0.399</td><td align="left">0.651</td><td align="left">54.670</td><td align="left">0.245</td><td align="left">0.531</td><td align="left">53.890</td><td align="left">0.267</td><td align="left">0.526</td></tr><tr><td align="left">DTF</td><td align="left">47.03</td><td align="left">0.430</td><td align="left">0.678</td><td align="left">54.730</td><td align="left">0.223</td><td align="left">0.517</td><td align="left">53.470</td><td align="left">0.263</td><td align="left">0.531</td></tr><tr><td align="left">Celebi’s method</td><td align="left">47.31</td><td align="left">0.423</td><td align="left">0.653</td><td align="left">53.49</td><td align="left">0.259</td><td align="left">0.516</td><td align="left">55.830</td><td align="left">0.196</td><td align="left">0.456</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Performance evaluation on independent test</title>
      <p id="Par63">Furthermore, we assessed the generalization performance of our model by testing on independent test sets, and the results are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. Notably, PermuteDDS achieved the overall best performance. Specifically, on the O’Neil dataset, PermuteDDS attained the top result with RMSE, <inline-formula id="IEq88"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M202"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq88.gif"/></alternatives></inline-formula>, and PCC scores of 15.144, 0.659, and 0.821, respectively. While the NCI-ALMANAC dataset’s complexity posed challenges for prediction across all methods, PermuteDDS still exhibited a slight superiority over previous state-of-the-art approaches with RMSE, <inline-formula id="IEq89"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq89.gif"/></alternatives></inline-formula>, and PCC scores of 43.338, 0.484, and 0.696, respectively. To intuitively assess differences in predictive performance across different datasets, we analyzed the distribution of true scores and predicted scores generated by the top three methods—PermuteDDS, HypergraphSynergy, and DeepSynergy. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates that the prediction results of all models on the O’Neil dataset form a well-clustered fitting line, indicative of good predictive performance. Conversely, as depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the results on the ALMANAC datasets appear relatively dispersed, and the expansion of synergy scores (coordinate axis) range further confirms the complexity of this dataset.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance comparison on the independent dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">O’Neil</th><th align="left" colspan="3">NCI-ALMANAC</th></tr><tr><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>15</bold>.<bold>144</bold></td><td align="left"><bold>0</bold>.<bold>659</bold></td><td align="left"><bold>0</bold>.<bold>821</bold></td><td align="left"><bold>43</bold>.<bold>338</bold></td><td align="left"><bold>0</bold>.<bold>484</bold></td><td align="left">0.696</td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">16.710</td><td align="left">0.585</td><td align="left">0.788</td><td align="left">43.730</td><td align="left">0.474</td><td align="left">0.693</td></tr><tr><td align="left">DeepSynergy</td><td align="left">16.840</td><td align="left">0.578</td><td align="left">0.765</td><td align="left">45.325</td><td align="left">0.435</td><td align="left">0.670</td></tr><tr><td align="left">ComboFM</td><td align="left">16.080</td><td align="left">0.541</td><td align="left">0.754</td><td align="left">46.370</td><td align="left">0.457</td><td align="left">0.685</td></tr><tr><td align="left">DTF</td><td align="left">16.150</td><td align="left">0.548</td><td align="left">0.752</td><td align="left">49.860</td><td align="left">0.372</td><td align="left"><bold>0</bold>.<bold>700</bold></td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.500</td><td align="left">0.529</td><td align="left">0.728</td><td align="left">45.860</td><td align="left">0.469</td><td align="left">0.688</td></tr></tbody></table></table-wrap></p>
      <p id="Par64">
        <fig id="Fig4">
          <label>Fig. 4</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig4_HTML" id="MO4"/>
        </fig>
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig5_HTML" id="MO5"/>
        </fig>
        <table-wrap id="Tab4">
          <label>Table 4</label>
          <caption>
            <p>Results of ablation study. Bold values indicate the best performance</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left" rowspan="2"/>
                <th align="left" colspan="3">O’Neil</th>
                <th align="left" colspan="3">NCI-ALMANAC</th>
              </tr>
              <tr>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq90">
                    <alternatives>
                      <tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M206">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq90.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq91">
                    <alternatives>
                      <tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M208">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq91.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">PermuteDDS</td>
                <td align="left"><bold>13</bold>.<bold>721</bold></td>
                <td align="left"><bold>0</bold>.<bold>641</bold></td>
                <td align="left"><bold>0</bold>.<bold>801</bold></td>
                <td align="left"><bold>43</bold>.<bold>053</bold></td>
                <td align="left"><bold>0</bold>.<bold>527</bold></td>
                <td align="left">0.726</td>
              </tr>
              <tr>
                <td align="left">w/o hashtt</td>
                <td align="left">13.895</td>
                <td align="left">0.632</td>
                <td align="left">0.796</td>
                <td align="left">44.081</td>
                <td align="left">0.504</td>
                <td align="left">0.711</td>
              </tr>
              <tr>
                <td align="left">w/o MAP4</td>
                <td align="left">13.746</td>
                <td align="left">0.639</td>
                <td align="left">0.800</td>
                <td align="left">43.964</td>
                <td align="left">0.507</td>
                <td align="left">0.713</td>
              </tr>
              <tr>
                <td align="left">w/o maccs</td>
                <td align="left">13.953</td>
                <td align="left">0.628</td>
                <td align="left">0.793</td>
                <td align="left">44.185</td>
                <td align="left">0.501</td>
                <td align="left">0.709</td>
              </tr>
              <tr>
                <td align="left">hashtt</td>
                <td align="left">14.340</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.034</td>
                <td align="left">0.459</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">maccs</td>
                <td align="left">14.444</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">46.141</td>
                <td align="left">0.456</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">MAP4</td>
                <td align="left">14.345</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.310</td>
                <td align="left">0.452</td>
                <td align="left">0.678</td>
              </tr>
              <tr>
                <td align="left">w/o Permute-MLP</td>
                <td align="left">14.811</td>
                <td align="left">0.581</td>
                <td align="left">0.769</td>
                <td align="left">44.528</td>
                <td align="left">0.494</td>
                <td align="left">0.718</td>
              </tr>
              <tr>
                <td align="left">PermuteDDS-L</td>
                <td align="left">14.433</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">43.138</td>
                <td align="left">0.525</td>
                <td align="left"><bold>0</bold>.<bold>728</bold></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="Sec15">
      <title>Ablation study</title>
      <p id="Par65">To study the effectiveness of each inputs and each PermuteDDS units, we perform the ablation studies under random split on both datasets. As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, the complete PermuteDDS framework achieves the best performance on 5 of 6 evaluation. In terms of the selection of input, we designed variants with different molecular fingerprint combinations as inputs. Upon examination, it becomes evident that the removal of any of the three fingerprints results in a decline in performance, and employing only one fingerprint yields even worse results. We can infer from the results that the combination of the three different fingerprints complements each other jointly contributes to the predictive performance of PermuteDDS. Then, in terms of model design, we conducted another two variants: PermuteDDS without Permute-MLP block and PermuteDDS-L. PermuteDDS-L is the model that utilizes a feedforward network to extract features from fingerprints and cell lines. The model without Permute-MLP block demonstrated inferior performance compared to PermuteDDS, highlighting the effectiveness of this module. Moreover, CNN might not capture as much information from fingerprints and cell lines as expected, as PermuteDDS-L only performed slightly worse than PermuteDDS.</p>
    </sec>
    <sec id="Sec16">
      <title>Model performance is robust against noise cell lines</title>
      <p id="Par66">In actual clinical situations, cancer cells may be mixed with normal cells. To assess the robustness of PermuteDDS, we conducted a sensitivity analysis to evaluate the stability of model performance in response to noise, following the methodology outlined in [<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, we introduced different levels of multiplicative or additive Gaussian noise into the input cell line gene expression and mutation profiles. Subsequently, PermuteDDS was trained using these resulting noisy cell lines. The underlying assumption is that Gaussian noise injected into the data can serve as a simulation of normal cell lines. For a given gene expression (or mutation) profile <italic>X</italic>, the computation of input noisy cell lines is as follows:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{mul}=\,&amp; {} x * N\left( 1, \sigma _{mul}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{add}=\, &amp; {} x + N\left( 0, \sigma _{add}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq92"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{mul}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq92.gif"/></alternatives></inline-formula> represent multiplicative noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq93"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 1, \sigma _{mul}\right) $$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq93.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq94"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{add}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq94.gif"/></alternatives></inline-formula> represent additive noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq95"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 0, \sigma _{add}\right) $$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq95.gif"/></alternatives></inline-formula>. We adopted the same standard deviation as reported in [<xref ref-type="bibr" rid="CR45">45</xref>]. Subsequently, we performed 5-fold cross-validation under random split across each standard deviation on both datasets. As depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, the predicted synergy scores, obtained by training on cell lines with multiplicative Gaussian noise, exhibit consistently high correlations with those trained on the original cell lines. Remarkably, even as the magnitude of the noise increases, the stability of the model’s performance is retained. Similar behavior is observed when subjecting PermuteDDS to additive Gaussian noise, as illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>B. Based on these observations, we can infer that PermuteDDS demonstrates robustness in the presence of noisy data.<fig id="Fig6"><label>Fig. 6</label><caption><p>Correlation between predicted synergy scores of cell lines without noise and cell lines with multiplicative noise (A) or additive noise (B)</p></caption><graphic xlink:href="13321_2024_839_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Cell line data study</title>
      <p id="Par67">Cell lines are known to exhibit sensitivity to variations in experimental conditions. Even identical cell lines obtained from different institutions can exhibit distinct gene expression profiles. To assess the necessity of the selected cell line descriptors, we constructed the variant of the PermuteDDS employing the cell line gene expression profiles sourced from the Cell Lines Project data in the COSMIC database [<xref ref-type="bibr" rid="CR46">46</xref>]. Following the methodology outlined in [<xref ref-type="bibr" rid="CR24">24</xref>], we considered only data related to 651 genes from the COSMIC Cancer Gene Census (<ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/census">https://cancer.sanger.ac.uk/census</ext-link>.). Moreover, we created an another variant utilizing a simple one-hot encoding as the input cell line descriptor, serving as a baseline for comparison. For the leave-cell-out task, the cell lines within the test set, which are unseen during training, are encoded as simple zero vectors. The results on the O’Neil and NCI-ALMANAC datasets are presented in Table <xref rid="Tab5" ref-type="table">5</xref> and Table <xref rid="Tab6" ref-type="table">6</xref>, respectively. The term ‘cline-gdsc’ denotes the original PermuteDDS, whereas ‘cline-cosmic’ and ‘cline-onehot’ refer to the variants employing COSMIC and one-hot cell line descriptors, respectively. The outcomes derived from employing different cell lines descriptors consistently exhibit similar performance across all cross-validation scenarios. This suggests that our method demonstrates insensitivity towards the choice of these cell-line descriptors, as long as the representation method adequately represents and distinguishes different cell lines. It’s crucial to highlight that all variants exhibited poor performance under the leave-cell-out task. Even upon encoding an unseen cell line with a zero vector, no significant differences were observed in comparison to the utilization of gene expression profiles. Indeed, none of the baseline methods demonstrate the capability to achieve satisfactory results on this task (Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>), underscoring the considerable challenge inherent in its execution.</p>
      <p id="Par68">Furthermore, we conducted similar experiments using one-hot encoding as cell line descriptors to construct the other two baseline methods, DeepSynergy and HypergraphSynergy. As presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1 and S2, DeepSynergy exhibited a similar phenomenon to PermuteDDS, wherein employing one-hot encoding as a cell line descriptor yielded similar results to the original. However, replacing the cell line descriptor with one-hot encoding leads to a significant decline in the performance of HypergraphSynergy. This may be attributed to the fact that HypergraphSynergy incorporates the reconstruction of cell line similarities as part of its optimization objective. Since the similarity between cell lines encoded using one-hot encoding is uniformly zero, this reconstruction process loses its significance. These observations reveal the inconsistent sensitivity among different methods to the selection of cell line descriptors, depending on the preprocessing approach applied to the cell lines.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Performance comparison of different cell lines descriptors on the O’Neil dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq96"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M222"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq96.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq97.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq98"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq98.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">13.721</td><td align="left">0.641</td><td align="left">0.801</td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left">16.152</td><td align="left">0.501</td><td align="left">0.709</td></tr><tr><td align="left">cline-cosmic</td><td align="left">13.602</td><td align="left">0.647</td><td align="left">0.805</td><td align="left">19.928</td><td align="left">0.236</td><td align="left">0.508</td><td align="left">16.122</td><td align="left">0.503</td><td align="left">0.71</td></tr><tr><td align="left">cline-onehot</td><td align="left">13.663</td><td align="left">0.644</td><td align="left">0.803</td><td align="left">20.010</td><td align="left">0.232</td><td align="left">0.507</td><td align="left">16.175</td><td align="left">0.499</td><td align="left">0.708</td></tr></tbody></table></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Performance comparison of different cell lines descriptors on the NCI-ALMANAC dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq99"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq99.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq100"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq100.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq101"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M232"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq101.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">43.053</td><td align="left">0.527</td><td align="left">0.726</td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left">51.58</td><td align="left">0.318</td><td align="left">0.569</td></tr><tr><td align="left">cline-cosmic</td><td align="left">43.247</td><td align="left">0.522</td><td align="left">0.723</td><td align="left">54.83</td><td align="left">0.218</td><td align="left">0.515</td><td align="left">51.303</td><td align="left">0.325</td><td align="left">0.575</td></tr><tr><td align="left">cline-onehot</td><td align="left">43.101</td><td align="left">0.526</td><td align="left">0.726</td><td align="left">55.336</td><td align="left">0.209</td><td align="left">0.506</td><td align="left">51.53</td><td align="left">0.319</td><td align="left">0.57</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Predicting novel synergistic combinations</title>
      <p id="Par69">In this section, we employed PermuteDDS to predict novel synergistic drug combinations that had not been previously tested. We utilized all measured trios of drug pairs and cell lines to train PermuteDDS and subsequently made predictions for unmeasured trios using the NCI-ALMANAC dataset. We focused on drug combinations with predicted scores close to 1 (see GitHub link<xref ref-type="fn" rid="Fn3">3</xref>.). We further conducted a nonexhaustive literature search, which revealed that six of the predicted drug combinations were consistent with observations from previous studies. For example, Dasatinib and Gefitinib combination presented a cell-specific cytotoxic synergistic effect in human ovarian cell line OVCAR-3 and IGROV-1 [<xref ref-type="bibr" rid="CR47">47</xref>]. According to the trials of Dolfi et al., combination of fulvestrant and doxorubicin can enhance the sensitivity of breast cancer cell line T47D to these cytotoxic agents [<xref ref-type="bibr" rid="CR48">48</xref>]. We believe that there are other predicted drug pairs that hold the potential of being promising combinations, which require further validation.</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par71">From the results, while PermuteDDS has demonstrated outstanding performance, we noticed that its performance on the leave-cell-out and leave-combination-out tasks is limited. The same situation occurred on other baselines, where <inline-formula id="IEq102"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq102.gif"/></alternatives></inline-formula> and PCC scores are consistently below 0.5 and 0.7, respectively. These scores indicate that the predicted results of the model are almost meaningless for these tasks. The reason for this limitation may be attributed to the distribution shift between the training and test sets, caused by the disparity in drug combinations and cell lines between these sets. The problem is expected to be solved by learning the invariance between different drugs and cell lines [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. Our future work is to explore a more robust model for these leave-out cross validation tasks.</p>
    <p id="Par72">In <xref rid="Sec15" ref-type="sec">3.3</xref>, we deduced that the combined use of the three different fingerprints significantly contributed to the predictive performance of PermuteDDS. This observation is likely because these fingerprints provide distinct descriptions of molecules from various perspectives. HashTT fingerprint is a type of path-based fingerprint that incorporates the topological information of molecules [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. MACCS keys, on the other hand, generate bit strings based on the presence or absence of specific substructures or features, thus enabling the capture of structural information. MAP4 is a novel fingerprint that combines the atom-pair approach with circular substructures, allowing it to encode both molecular shape and chemical information simultaneously [<xref ref-type="bibr" rid="CR35">35</xref>]. Thus, HashTT provides valuable topological information, while MACCS offers essential structural information. Subsequently, MAP4 supplements the chemical properties from the atomic perspective. The fusion of these distinct pieces of information results in a comprehensive and detailed description of the molecules.</p>
    <p id="Par73">In "<xref rid="Sec17" ref-type="sec">Cell line data study</xref>" section, we conducted experiments to investigate the significance of cell line descriptors. The results of these experiments suggest that different methods have varying sensitivities to the choice of cell line descriptors, indicating the limitations of one-hot encoding for certain methods. Moreover, the utilization of different cell line descriptors all resulted in poor performance under the leave-cell-out task. Several other related studies have also demonstrated poor generalization performance on this task [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>]. Nevertheless, we maintain the conviction that continued research in fields such as pharmacology, pharmacokinetics, toxicology, and genetic heterogeneity, alongside the development of novel computational methods, holds the potential to swiftly surmount these challenges.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par74">In conclusion, we proposed PermuteDDS, a novel model designed to predict potential synergistic drug combinations for cancer treatment. PermuteDDS establishes a unified framework that incorporates diverse types of information, including topological structure and chemical properties of drugs, cellular gene expressions and gene mutations. These different data are effectively fused using the FSN architecture to capture the complex interactions between drug pairs and cell lines. PermuteDDS exhibits robust predictive capabilities on two benchmark datasets through comparison with other competitive methods. However, there remain certain limitations that have been previously discussed. Our future work is to explore a more robust model for leave-out cross validation tasks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2024_839_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Table S1. </bold>Performance comparison of one-hot cell line descriptors with different baselines methods on O'Neil dataset.<bold> Table S2.</bold> Performance comparison of one-hot cell line descriptors with different baselines methods on NCI-ALMANAC dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HTS</term>
        <def>
          <p id="Par4">High-throughput screening</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par5">Support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBoost</term>
        <def>
          <p id="Par6">Extreme gradient boosting</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par7">Simplified molecular-input line-entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par8">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>GCN</term>
        <def>
          <p id="Par9">Graph convolutional network</p>
        </def>
      </def-item>
      <def-item>
        <term>HashTT</term>
        <def>
          <p id="Par10">Hashed topological-torsion</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP4</term>
        <def>
          <p id="Par11">MinHashed atom-pair fingerprint up to a diameter of four bonds</p>
        </def>
      </def-item>
      <def-item>
        <term>MACCS</term>
        <def>
          <p id="Par12">Molecular ACCess System</p>
        </def>
      </def-item>
      <def-item>
        <term>DDS</term>
        <def>
          <p id="Par13">Drug-drug synergy</p>
        </def>
      </def-item>
      <def-item>
        <term>GDSC</term>
        <def>
          <p id="Par14">Genomics of Drug Sensitivity in Cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>FSNs</term>
        <def>
          <p id="Par15">Fingerprint specific networks</p>
        </def>
      </def-item>
      <def-item>
        <term>HGNN</term>
        <def>
          <p id="Par16">Hypergraph neural net</p>
        </def>
      </def-item>
      <def-item>
        <term>PPI</term>
        <def>
          <p id="Par17">Protein-protein-interaction</p>
        </def>
      </def-item>
      <def-item>
        <term>Conv1D</term>
        <def>
          <p id="Par18">One-dimensional convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>MSE</term>
        <def>
          <p id="Par19">Mean square error</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par20">Root man squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math>
              <mml:math id="M236">
                <mml:msup>
                  <mml:mtext>R</mml:mtext>
                  <mml:mn>2</mml:mn>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="13321_2024_839_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par21">Coefficient of determination</p>
        </def>
      </def-item>
      <def-item>
        <term>PCC</term>
        <def>
          <p id="Par22">Pearson’s Correlation Coefficient</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par36"><ext-link ext-link-type="uri" xlink:href="https://github.com/reymond-group/MAP4/tree/master">https://github.com/reymond-group/MAP4/tree/master</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par38"><ext-link ext-link-type="uri" xlink:href="https://www.cancerrxgene.org">https://www.cancerrxgene.org</ext-link>.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par70">
        <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv">https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Our deepest gratitude goes to the anonymous reviewers for their careful work and insightful suggestions, which will undoubtedly enhance the quality of this paper.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>X.Z. prepared the data, performed the experiments and wrote the manuscript, J.X. analyzed the results and revised the manuscript, Y.S. and M.X. participated in revising the manuscript, J.H. and X.L. contributed to the interpretation and revising of the manuscript, K.C. organized the database, J.W. and Y.L. supervised the research activity planning and execution.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded by National Natural Science Foundation of China (NSFC, Grant No. 62,271,174, 62,202,373 and 62,102,191); the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department (Grant no.BE2020721); Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"(TC210804V); the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021 (Grant no. [2021]92); the Key Project of Smart Jiangsu in 2020 (Grant no. [2021]1); Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service (Grant no. [2020]1460).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availibility</title>
    <p>Lists the following:</p>
    <p><inline-formula id="IEq103"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M238"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq103.gif"/></alternatives></inline-formula> Project name: PermuteDDS</p>
    <p><inline-formula id="IEq104"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M240"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq104.gif"/></alternatives></inline-formula> Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link></p>
    <p><inline-formula id="IEq105"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M242"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq105.gif"/></alternatives></inline-formula> Operating system(s): Linux, Windows</p>
    <p><inline-formula id="IEq106"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M244"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq106.gif"/></alternatives></inline-formula> Programming language: Python</p>
    <p><inline-formula id="IEq107"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M246"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq107.gif"/></alternatives></inline-formula> Other requirements: Python 3.7 or higher, PyTorch 1.11 or higher</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par80">Not applicable.</p>
    </notes>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par79">The authors declare that they have no Conflict of interest.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Combine and conquer: challenges for targeted therapy combinations in early phase trials</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1038/nrclinonc.2016.96</pub-id>
        <?supplied-pmid 27377132?>
        <pub-id pub-id-type="pmid">27377132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Workman</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial drug therapy for cancer in the post-genomic era</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>679</fpage>
        <lpage>692</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2284</pub-id>
        <?supplied-pmid 22781697?>
        <pub-id pub-id-type="pmid">22781697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gefen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ronin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bar-Meir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
        </person-group>
        <article-title>Effect of tolerance on the evolution of antibiotic resistance under drug combinations</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>367</volume>
        <issue>6474</issue>
        <fpage>200</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3041</pub-id>
        <?supplied-pmid 31919223?>
        <pub-id pub-id-type="pmid">31919223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Azam F, Vazquez A (2021) Trends in Phase II Trials for Cancer Therapies. Cancers 2021, 13, 178. s Note: MDPI stays neu-tral with regard to jurisdictional clai-ms in ..</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ru</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale exploration and analysis of drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>2007</fpage>
        <lpage>2016</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv080</pub-id>
        <?supplied-pmid 25667546?>
        <pub-id pub-id-type="pmid">25667546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Integration of virtual and high-throughput screening</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2002</year>
        <volume>1</volume>
        <issue>11</issue>
        <fpage>882</fpage>
        <lpage>894</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd941</pub-id>
        <?supplied-pmid 12415248?>
        <pub-id pub-id-type="pmid">12415248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferreira</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Adega</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chaves</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The importance of cancer cell lines as in vitro models in cancer methylome analysis and anticancer drugs testing</article-title>
        <source>Oncogenomics</source>
        <year>2013</year>
        <volume>1</volume>
        <fpage>139</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Osimiri</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Lauffenburger</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Systematic analysis of quantitative logic model ensembles predicts drug combination effects on cell signaling networks</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>544</fpage>
        <lpage>553</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preuer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bulusu</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deepsynergy: predicting anti-cancer drug synergy with deep learning</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1538</fpage>
        <lpage>1546</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx806</pub-id>
        <?supplied-pmid 29253077?>
        <pub-id pub-id-type="pmid">29253077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>What is a support vector machine?</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>1565</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1206-1565</pub-id>
        <?supplied-pmid 17160063?>
        <pub-id pub-id-type="pmid">17160063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Chen T, He T, Benesty M, Khotilovich V, Tang Y, Cho H, Chen K, Mitchell R, Cano I, Zhou T et al (2015) Xgboost: extreme gradient boosting. R package version 0.4-2 1(4):1–4</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Dogra</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review on deep synergistic drug prediction techniques for cancer</article-title>
        <source>Arch Comput Methods Eng</source>
        <year>2022</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>1443</fpage>
        <lpage>1461</lpage>
        <pub-id pub-id-type="doi">10.1007/s11831-021-09617-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>In silico drug combination discovery for personalized cancer therapy</article-title>
        <source>BMC Syst Biol</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>59</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="pmid">29801503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>Timonen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koschmieder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wennerberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mustjoki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Patient-customized drug combination prediction and testing for t-cell prolymphocytic leukemia patients</article-title>
        <source>Can Res</source>
        <year>2018</year>
        <volume>78</volume>
        <issue>9</issue>
        <fpage>2407</fpage>
        <lpage>2418</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-3644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuru</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Tastan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cicek</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Matchmaker: a deep learning framework for drug synergy prediction</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2021</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>2334</fpage>
        <lpage>2344</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3086702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>D-S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Q-S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Q-N</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y-Z</given-names>
          </name>
        </person-group>
        <article-title>Chemopy: freely available python package for computational biology and chemoinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1092</fpage>
        <lpage>1094</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt105</pub-id>
        <?supplied-pmid 23493324?>
        <pub-id pub-id-type="pmid">23493324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>An enhanced cascade-based deep forest model for drug combination prediction</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>562</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosseini</surname>
            <given-names>S-R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Ccsynergy: an integrative deep-learning framework enabling context-aware prediction of anti-cancer drug synergy</article-title>
        <source>Brief Bioinform</source>
        <year>2023</year>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>588</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1988</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jim Zheng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Anticancer drug synergy prediction in understudied tissues using transfer learning</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2021</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocaa212</pub-id>
        <?supplied-pmid 33040150?>
        <pub-id pub-id-type="pmid">33040150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Review of unsupervised pretraining strategies for molecules representation</article-title>
        <source>Brief Funct Genomics</source>
        <year>2021</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>323</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elab036</pub-id>
        <?supplied-pmid 34342611?>
        <pub-id pub-id-type="pmid">34342611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Deepdds: deep graph neural network with attention mechanism to predict synergistic drug combinations</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>390</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Multi-way relation-enhanced hypergraph representation learning for anti-cancer drug synergy prediction</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>20</issue>
        <fpage>4782</fpage>
        <lpage>4789</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac579</pub-id>
        <?supplied-pmid 36000898?>
        <pub-id pub-id-type="pmid">36000898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Neil</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Feldman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chenard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kral</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lejnine</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Loboda</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An unbiased oncology compound screen to identify novel combination strategies</article-title>
        <source>Mol Cancer Ther</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1158/1535-7163.MCT-15-0843</pub-id>
        <?supplied-pmid 26983881?>
        <pub-id pub-id-type="pmid">26983881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holbeck</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Camalier</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Crowell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Govindharajulu</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Hollingshead</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Polley</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rubinstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilsker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The national cancer institute almanac: a comprehensive screening resource for the detection of anticancer drug pairs with enhanced therapeutic activity</article-title>
        <source>Can Res</source>
        <year>2017</year>
        <volume>77</volume>
        <issue>13</issue>
        <fpage>3564</fpage>
        <lpage>3576</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-0489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loewe</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The problem of synergism and antagonism of combined drugs</article-title>
        <source>Arzneimittelforschung</source>
        <year>1953</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>285</fpage>
        <lpage>290</lpage>
        <?supplied-pmid 13081480?>
        <pub-id pub-id-type="pmid">13081480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Bliss CI, The toxicity of poisons applied jointly. Ann Appl Biol 26(3):585–615. 10.1111/j.1744-7348.1939.tb06990.x</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gindulyte</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pubchem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>1102</fpage>
        <lpage>1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landrum</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rdkit: a software suite for cheminformatics, computational chemistry, and predictive modeling</article-title>
        <source>Greg Landrum</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iorio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Vis</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Menden</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aben</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gonçalves</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barthorpe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A landscape of pharmacogenomic interactions in cancer</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>3</issue>
        <fpage>740</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.06.017</pub-id>
        <?supplied-pmid 27397505?>
        <pub-id pub-id-type="pmid">27397505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greninger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>IR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of drug sensitivity in cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>955</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Systematic quality control analysis of lincs data</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>588</fpage>
        <lpage>598</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilakantan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bauman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Venkataraghavan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Topological torsion: a new molecular descriptor for SAR applications. Comparison with other descriptors</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1987</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>82</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00054a008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capecchi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>One molecular fingerprint to rule them all: drugs, biomolecules, and the metabolome</article-title>
        <source>J Cheminf</source>
        <year>2020</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00445-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durant</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leland</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Nourse</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Reoptimization of mdl keys for use in drug discovery</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2002</year>
        <volume>42</volume>
        <issue>6</issue>
        <fpage>1273</fpage>
        <lpage>1280</lpage>
        <pub-id pub-id-type="doi">10.1021/ci010132r</pub-id>
        <?supplied-pmid 12444722?>
        <pub-id pub-id-type="pmid">12444722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Hendrycks D, Gimpel K (2016) Gaussian error linear units (gelus). arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1606.08415">arXiv:1606.08415</ext-link></mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolstikhin</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Houlsby</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Unterthiner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Keysers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Uszkoreit</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mlp-mixer: an all-mlp architecture for vision</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2021</year>
        <volume>34</volume>
        <fpage>24261</fpage>
        <lpage>24272</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>M-M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Vision permutator: a permutable MLP-like architecture for visual recognition</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2022</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>1328</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2022.3145427</pub-id>
        <?supplied-pmid 35077359?>
        <pub-id pub-id-type="pmid">35077359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ramachandran P, Zoph B, Le QV (2017) Searching for activation functions. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1710.05941">arXiv:1710.05941</ext-link></mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Ba JL, Kiros JR, Hinton GE (2016) Layer normalization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1607.06450">arXiv:1607.06450</ext-link></mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Dtf: deep tensor factorization for predicting anticancer drug synergy</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>4483</fpage>
        <lpage>4489</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa287</pub-id>
        <?supplied-pmid 32369563?>
        <pub-id pub-id-type="pmid">32369563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Julkunen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cichonska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gautam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Szedmak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Douat</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pahikkala</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Leveraging multi-way interactions for systematic prediction of pre-clinical drug combination effects</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>6136</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19950-z</pub-id>
        <?supplied-pmid 33262326?>
        <pub-id pub-id-type="pmid">33262326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Celebi R, Bear Don’t Walk O, Movva R, Alpsoy S, Dumontier M (2019) In-silico prediction of synergistic anti-cancer drug combinations using multi-omics data. Sci Rep 9(1), 1–10</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Korkut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Ingraham</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cellbox: interpretable machine learning for perturbation biology with application to the design of cancer combination therapy</article-title>
        <source>Cell Syst</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>128</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.11.013</pub-id>
        <?supplied-pmid 33373583?>
        <pub-id pub-id-type="pmid">33373583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gunasekaran</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cosmic: exploring the world’s knowledge of somatic mutations in human cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>805</fpage>
        <lpage>811</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thibault</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jean-Claude</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Dasatinib+ gefitinib, a non platinum-based combination with enhanced growth inhibitory, anti-migratory and anti-invasive potency against human ovarian cancer cells</article-title>
        <source>Journal of ovarian research</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13048-017-0319-2</pub-id>
        <pub-id pub-id-type="pmid">28086946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolfi</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Jäger</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Haffty</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Hirshfield</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Fulvestrant treatment alters mdm2 protein turnover and sensitivity of human breast carcinoma cells to chemotherapeutic drugs</article-title>
        <source>Cancer Lett</source>
        <year>2014</year>
        <volume>350</volume>
        <issue>1–2</issue>
        <fpage>52</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2014.04.009</pub-id>
        <?supplied-pmid 24747123?>
        <pub-id pub-id-type="pmid">24747123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Shen Z, Liu J, He Y, Zhang X, Xu R, Yu H, Cui P (2021) Towards out-of-distribution generalization: a survey. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2108.13624">arXiv:2108.13624</ext-link></mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Learning substructure invariance for out-of-distribution molecular representations</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2022</year>
        <volume>35</volume>
        <fpage>12964</fpage>
        <lpage>12978</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Comparing structural fingerprints using a literature-based similarity benchmark</article-title>
        <source>J Cheminf</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0148-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>A complete graph-based approach with multi-task learning for predicting synergistic drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <issue>6</issue>
        <fpage>351</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btad351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MGAE-DC: Predicting the synergistic effects of drug combinations through multi-channel graph autoencoders</article-title>
        <source>PLoS Comput Biol</source>
        <year>2023</year>
        <volume>19</volume>
        <issue>3</issue>
        <fpage>1010951</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preto</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Matos-Filipe</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mourão</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>IS</given-names>
          </name>
        </person-group>
        <article-title>Synpred: prediction of drug combination effects in cancer using different synergy metrics and ensemble learning</article-title>
        <source>GigaScience</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>087</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giac087</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11017561</article-id>
    <article-id pub-id-type="publisher-id">839</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-024-00839-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PermuteDDS: a permutable feature fusion network for drug-drug synergy prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Xinwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Junqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shui</surname>
          <given-names>Youyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Mengdie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoyan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Che</surname>
          <given-names>Kai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Junjie</given-names>
        </name>
        <address>
          <email>junjie2021@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yun</given-names>
        </name>
        <address>
          <email>liuyun@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Medical Informatics, School of Biomedical Engineering and Informatics, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>The Second Clinical Medical School, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Institute of Medical Informatics and Management, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Information, </institution><institution>the First Affiliated Hospital, Nanjing Medical University, </institution></institution-wrap>No. 300 Guang Zhou Road, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01yqg2h08</institution-id><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>Faculty of Computing, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>No. 92 West Da Zhi St, Harbin, 150001 Heilongjiang China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.424071.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 1755 1589</institution-id><institution>Xi’an Aeronautics Computing Technique Research Institute, AVIC, </institution></institution-wrap>No. 156, TaiBai Nroth Road, Xi’an, 710068 Shanxi China </aff>
      <aff id="Aff7"><label>7</label>Aviation Key Laboratory of Science and Technology on Airborne and Missleborne Computer, Xi’an, 710065 Shanxi China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>41</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Motivation</title>
        <p id="Par1">Drug combination therapies have shown promise in clinical cancer treatments. However, it is hard to experimentally identify all drug combinations for synergistic interaction even with high-throughput screening due to the vast space of potential combinations. Although a number of computational methods for drug synergy prediction have proven successful in narrowing down this space, fusing drug pairs and cell line features effectively still lacks study, hindering current algorithms from understanding the complex interaction between drugs and cell lines.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, named PermuteDDS. PermuteDDS takes multiple representations of drugs and cell lines as input and employs a permutable fusion mechanism to combine drug and cell line features. In experiments, PermuteDDS exhibits state-of-the-art performance on two benchmark data sets. Additionally, the results on independent test set grouped by different tissues reveal that PermuteDDS has good generalization performance. We believed that PermuteDDS is an effective and valuable tool for identifying synergistic drug combinations. It is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link>.</p>
      </sec>
      <sec>
        <title>Scientific contribution</title>
        <p id="Par3">First, this paper proposes a permutable feature fusion network for predicting drug synergy termed PermuteDDS, which extract diverse information from multiple drug representations and cell line representations. Second, the permutable fusion mechanism combine the drug and cell line features by integrating information of different channels, enabling the utilization of complex relationships between drugs and cell lines. Third, comparative and ablation experiments provide evidence of the efficacy of PermuteDDS in predicting drug-drug synergy.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-024-00839-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Drug combination</kwd>
      <kwd>Permutable feature fusion</kwd>
      <kwd>Synergistic effect</kwd>
      <kwd>Cancer</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271174</award-id>
        <award-id>No.62202373</award-id>
        <award-id>No.62102191</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Xiaoyan</given-names>
          </name>
          <name>
            <surname>Che</surname>
            <given-names>Kai</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Junjie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department</institution>
        </funding-source>
        <award-id>no.BE2020721</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"</institution>
        </funding-source>
        <award-id>TC210804V</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021</institution>
        </funding-source>
        <award-id>no. [2021]92</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Key Project of Smart Jiangsu in 2020</institution>
        </funding-source>
        <award-id>no. [2021]1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service</institution>
        </funding-source>
        <award-id>no. [2020]1460</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par23">Single-agent targeted therapies have been widely utilized in clinical cancer treatments. However, the clinical efficacy of monotherapy remains limited due to the biological complexity of tumors and the presence of pre-existing or acquired drug resistance mechanisms [<xref ref-type="bibr" rid="CR1">1</xref>]. In contrast, combination therapies involving the simultaneous administration of multiple drugs have shown promising results in cancer treatment [<xref ref-type="bibr" rid="CR2">2</xref>]. Compared to monotherapy, combination therapies have the potential to enhance treatment efficacy, reduce the dose-limiting toxicity associated with single agents, and overcome drug resistance [<xref ref-type="bibr" rid="CR3">3</xref>]. Despite the potential benefits, it is important to note that not all drug combinations exhibit synergistic effects, and some combinations may even result in antagonistic interactions [<xref ref-type="bibr" rid="CR4">4</xref>]. Therefore, it is essential to accurately determine the interaction between drug combinations to specific diseases.</p>
    <p id="Par24">Traditionally, the discovery of drug combinations heavily relied on clinical trials, posing challenges in terms of time consumption and cost-effectiveness due to the extensive number of potential drug combinations [<xref ref-type="bibr" rid="CR5">5</xref>]. An alternative method is high-throughput screening (HTS), which enables automated testing of chemical and biological compounds against specific biological targets [<xref ref-type="bibr" rid="CR6">6</xref>]. HTS techniques have significantly reduced the time required for identifying potential drug combinations. However, it is important to note that HTS has limitations in revealing the in vivo action modes of drug molecules [<xref ref-type="bibr" rid="CR7">7</xref>]. Moreover, the substantial increase in the number of available drugs has rendered it impractical to comprehensively test the entire combinatorial space using HTS [<xref ref-type="bibr" rid="CR8">8</xref>]. The sheer magnitude of potential drug combinations poses a challenge in terms of feasibility and resource utilization.</p>
    <p id="Par25">Computational methods, particularly machine learning models, have emerged as powerful tools for exploring the vast synergistic space of drug combinations [<xref ref-type="bibr" rid="CR9">9</xref>]. These machine learning-based models can be broadly categorized into two types: classical machine learning and deep learning. Classical machine learning models, such as random forest [<xref ref-type="bibr" rid="CR10">10</xref>], support vector machine (SVM) [<xref ref-type="bibr" rid="CR11">11</xref>], extreme gradient boosting (XGBoost) [<xref ref-type="bibr" rid="CR12">12</xref>], have been widely utilized in drug synergy prediction. These models leverage genomic information from cancer cells, physiochemical properties of drugs, and drug-cell interaction data to predict drug synergy [<xref ref-type="bibr" rid="CR13">13</xref>]. For instance, Jeon et al. [<xref ref-type="bibr" rid="CR14">14</xref>] employed random forest and SVM algorithms to predict the synergistic effects of anticancer drug combinations by incorporating monotherapy response and synthetic lethality information. However, this approach heavily relies on the given dataset, and the model may struggle to accurately predict the features of drug combinations without prior knowledge. Another study by He et al. [<xref ref-type="bibr" rid="CR15">15</xref>] proposed an XGBoost-based model that predicts the selective synergistic effects of cancer by utilizing distinct single compound sensitivity curves between patient cells and healthy controls. This approach aimed to minimize potential toxicity associated with drug combinations.</p>
    <p id="Par26">Recently, deep learning has gained increasing popularity in drug development and discovery. Compare to classical machine learning methods, deep learning algorithms have better generalization performance, making it efficient in handling large drug combination datasets. Deep learning-based methods typically frame the challenge of drug synergy prediction as a regression task, aiming to predict the quantitative synergy scores. These methods can be categorized into three groups: fingerprint-based methods, SMILE-based methods and graph-based methods. Fingerprint-based methods take molecular fingerprint (also called descriptor) as input. Preuer et al. [<xref ref-type="bibr" rid="CR9">9</xref>] proposed DeepSynergy, a feedforward neural network-based deep learning model for drug synergy score prediction that employs molecular fingerprints and gene expression as inputs. The performance of DeepSynergy demonstrated significant improvement over classical machine learning models. Kuru et al. [<xref ref-type="bibr" rid="CR16">16</xref>] developed a MatchMaker model for predicting synergistic drug combinations using chemical descriptors generated by ChemoPy [<xref ref-type="bibr" rid="CR17">17</xref>] and the expression profiles of landmark genes as input. Lin et al. [<xref ref-type="bibr" rid="CR18">18</xref>] amalgamated molecular fingerprint information with drug induced gene expression profiles to capture drug cell responses to reveal the mechanisms of biological synergistic effects, and using deep forests as feature learning models. Hosseini et al. [<xref ref-type="bibr" rid="CR19">19</xref>] proposed CCSynergy, used a feed forward network to obtain the fusion feature of drug fingerprints and mutiple cell line representations for durg syergy prediction. SMILE-based methods select simplified molecular-input line-entry system (SMILES) [<xref ref-type="bibr" rid="CR20">20</xref>] as drug representations. Kim et al. [<xref ref-type="bibr" rid="CR21">21</xref>] utilized a muti-head attention mechanism and convolutional neural networks (CNN) to encode drug SMILES. Graph-based methods that extract features from molecular graphs have the potential to capture structural information about the molecules [<xref ref-type="bibr" rid="CR22">22</xref>]. Wang et al. [<xref ref-type="bibr" rid="CR23">23</xref>] proposed DeepDDS, a model that utilizes a graph convolutional network (GCN) and attention mechanism to compute drug embedding vectors, which are integrated with cell line gene expression data to predict drug synergy. Liu et al. [<xref ref-type="bibr" rid="CR24">24</xref>] proposed HypergraphSynergy, a method employing hypergraph representation learning to predict anti-cancer drug synergy by considering drugs and cell lines as nodes and representing drug pair-cell line triplets as hyperedges.</p>
    <p id="Par27">The previously mentioned deep learning-based methods have exhibited impressive performance in predicting drug synergy, yet there is still room for further improvement. One limitation is that these methods typically only use single type drug representation, thereby failing to provide a comprehensive description of drugs. Moreover, most of these methods simply fuse drug and cell line features through simple operations such as concatenation or addition, neglecting dynamic synergies between drug pairs and cell lines.</p>
    <p id="Par28">In light of the limitations associated with existing approaches for predicting drug synergy, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, namely PermuteDDS. Our method addresses the challenge of limited representation types by considering multiple representations of drugs and cell lines. We employed the one-dimensional CNN to learn and extract high-latent features from these representations. Then, we designed a permutable fusion mechanism to combine the drug and cell line features, allowing us to capture the complex relationships between drug combinations and cell lines. Finally, we conducted experiments on two benchmark datasets, and the results compared to state-of-the-art methods indicated that PermuteDDS is an effective model for drug synergy prediction. In summary, the contributions of our work are as follows:<list list-type="bullet"><list-item><p id="Par29">We propose PermuteDDS, a deep learning model for drug-drug synergy prediction with multiple input representations.</p></list-item><list-item><p id="Par30">Our major contribution lies in the application of the permutable fusion mechanism to represent the interactions between drug combinations and cell lines.</p></list-item><list-item><p id="Par31">We conduct comprehensive experiments to demonstrate the effectiveness of our proposed model. We present ablations and analysis to gain a deeper understanding of the model’s behavior.</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Data description</title>
      <p id="Par32">We collected Drug-Drug Synergy (DDS) data, molecular structures of drugs, the expression profiles and mutation information of cell lines from various public databases as below.<list list-type="bullet"><list-item><p id="Par33"><bold>Drug-Drug Synergy datasets.</bold> The Drug-Drug Synergy (DDS) data were obtained from two released large-scale oncology screening datasets, namely O’Neil [<xref ref-type="bibr" rid="CR25">25</xref>] and NCI-ALMANAC [<xref ref-type="bibr" rid="CR26">26</xref>]. The O’Neil dataset contains 22 737 samples estimated by Loewe synergy score [<xref ref-type="bibr" rid="CR27">27</xref>] consisting of two chemicals and a cell line, covering 38 unique drugs and 39 diverse caner cell lines. The NCI-ALMANAC dataset comprises 304 549 samples evaluated by the ComboScores of pairwise combinations of 104 FDA-approved anticancer drugs against a panel of 60 well-characterized human tumor cell lines.</p></list-item><list-item><p id="Par34"><bold>Drug synergy scores.</bold> The Loewe synergy score incorporates the concepts of sham combination and dose equivalence. Let <italic>A</italic> and <italic>B</italic> denote two drugs, and <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_A$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_B$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq3.gif"/></alternatives></inline-formula> represent their respective doses. The drug synergy score can then be computed as follows [<xref ref-type="bibr" rid="CR27">27</xref>]: <disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{Loewe}=\frac{R_{\min }+R_{\max }\left( \frac{x_A+x_B}{m}\right) ^\lambda }{1+\left( \frac{x_A+x_B}{m}\right) ^\lambda } \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{Loewe}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq4.gif"/></alternatives></inline-formula> is a continuous value, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq6.gif"/></alternatives></inline-formula> represents the maximum and minimum drug response, respectively. <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M14"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq7.gif"/></alternatives></inline-formula> is the shape parameter and <italic>m</italic> is the dose that produce midpoint between <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq9.gif"/></alternatives></inline-formula>. The determination of combination benefit, denoted as ‘ComboScore’ [<xref ref-type="bibr" rid="CR26">26</xref>], relies on a modification of Bliss independence [<xref ref-type="bibr" rid="CR28">28</xref>]. Let <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}^{A_p B_q}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq10.gif"/></alternatives></inline-formula> represent the growth fraction for the <italic>i</italic>-th cell line exposed to the <italic>p</italic>-th concentration of drug A and the <italic>q</italic>-th concentration of drug B. Similarly, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_i^{A_p B_q}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq11.gif"/></alternatives></inline-formula> denote the expected growth fraction for the combination. The final continuous combination score <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ComboScore}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq12.gif"/></alternatives></inline-formula> for the cell line and the drug combination can then be computed as the sum of the differences between expected and observed growth fractions: <disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ComboScore}=\sum _{p, q} Y_i^{A_p B_q}-Z_i^{A_p B_q} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par35"><bold>Molecular structures of drugs.</bold> The SMILES of the drugs were obtained from PubChem database [<xref ref-type="bibr" rid="CR29">29</xref>], based on which the chemical and structure information of a drug can be converted to fingerprints with RDKit [<xref ref-type="bibr" rid="CR30">30</xref>] and MAP4 project.<xref ref-type="fn" rid="Fn1">1</xref></p></list-item><list-item><p id="Par37"><bold>Gene expression and gene mutation of cell lines.</bold> The gene expression and gene mutation of cell lines were obtained from Genomics of Drug Sensitivity in Cancer (GDSC) database,<xref ref-type="fn" rid="Fn2">2</xref>. where 1000 human cancer cell lines were characterised and screened [<xref ref-type="bibr" rid="CR31">31</xref>]. To enhance the representation of cell lines, we identified significant genes by referencing The Library of Integrated Network-Based Cellular Signatures (LINCS) project [<xref ref-type="bibr" rid="CR32">32</xref>]. The LINCS project offers a meticulously curated set of approximately 1000 genes, known as the ‘landmark gene set’, which captures 80% of the information from Connectivity Map data [<xref ref-type="bibr" rid="CR33">33</xref>]. We selected genes that intersected between GDSC gene expression profiles and the landmark set, as well as gene mutation profiles. Finally, 899 genes were chosen for expression profiles, and 968 genes were selected for mutation profiles.</p></list-item></list>We preprocessed the two dataset by eliminating the drugs lacking SMILES and the cell lines devoid of gene expressions or gene mutations. The resulting refined O’Neil dataset comprised 18 950 samples with Loewe synergy scores across 38 drugs and 39 cell lines, while the processed NCI-AlMANAC dataset consisted of 74 139 instances with NCI ComboScores (a Bliss independence modification) across 87 drugs and 55 cell lines.</p>
    </sec>
    <sec id="Sec4">
      <title>Molecular fingerprints</title>
      <p id="Par39">Molecular fingerprints (also referred to as descriptors) is a prevalent method of drug representation. Within this approach, each molecule is encoded as a binary string that delineate the presence or absence of specific substructure fragments or properties within the molecule. A value of 0 corresponds to absence of the particular feature, while a value of 1 denotes its existence. Moreover, the fingerprints exhibit uniqueness; specifically, one molecule possesses one sequence for a particular fingerprints type, yet it can have numerous diverse fingerprints types [<xref ref-type="bibr" rid="CR22">22</xref>]. The three different kinds of fingerprints employed in this article are described below.<list list-type="bullet"><list-item><p id="Par40"><bold>Hashed topological-torsion (HashTT)</bold> is a kind of topological fingerprints [<xref ref-type="bibr" rid="CR34">34</xref>]. The fragments employed in HashTT fingerprints are linear sequence comprising four consecutively bonded non-hydrogen atoms. The label for each fragment is determined based on its atomic type, the number of non-hydrogen branches attached to it, and its number of 7r electrons of each atom. These labels then undergo a hashing process to generate the HashTT fingerprints.</p></list-item><list-item><p id="Par41"><bold>MinHashed atom-pair fingerprint up to a diameter of four bonds (MAP4)</bold> [<xref ref-type="bibr" rid="CR35">35</xref>] is a novel fingerprint that integrates both substructure fingerprints and atom-pair fingerprints. Given a molecule SMILE sentence, the circular substructures with radii of r = 1 and r = 2 bonds around individual atoms within an atom-pair configuration are encoded as two pairs of SMILES. Each pair is subsequently combined with the topological distance separating the central atoms. These atom-pair molecular shingles undergo a hashing process, and the resulting set of hashes is subjected to the MinHashed technique, which lead to the creation of the MAP4 fingerprint.</p></list-item><list-item><p id="Par42"><bold>Molecular ACCess System (MACCS)</bold> [<xref ref-type="bibr" rid="CR36">36</xref>] keys are one of the most commonly used structural fingerprints. In this fingerprint, one molecule is encoded as a 166-bit binary string, where each bit corresponds to a predefined structural fragment (e.g. 3-element ring).</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>The overview of the PermuteDDS framework</p></caption><graphic xlink:href="13321_2024_839_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Overview of PermuteDDS</title>
      <p id="Par43">PermuteDDS is an end-to-end framework for predicting drug combinations, presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Specifically, Fig. <xref rid="Fig1" ref-type="fig">1</xref>(A) illustrates the pipeline implemented by PermuteDDS to derive the synergy scores. Our framework contains three subnetworks called Fingerprint Specific Networks (FSNs), all of which share the same architecture shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(B). Each FSN takes a drug pair of a certain fingerprint and a cell line pair including its gene expression and gene mutation profiles as inputs. Then, the CNNs are used to extract drug and cell line features, and the Permute-MLP module (Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C)) is proposed to obtain the fusion synergy feature, which is the output of FSN. The three FSNs output three distinct synergy features, each of which is propagated through a specific prediction module to generate a synergy score. The final outputs of PermuteDDS is the average of the synergy scores predicted by these prediction modules.</p>
    </sec>
    <sec id="Sec6">
      <title>Fingerprint specific subnetwork (FSN)</title>
      <p id="Par44">Given a drug fingerprint pair and a cell line pair as inputs, the FSN encompasses three essential processes, including drug features extraction, cell line features extraction and feature fusion, which integrates the extracted drug and cell line features. The output of FSN is a synergy feature. A comprehensive overview of these processes is provided below.<fig id="Fig2"><label>Fig. 2</label><caption><p>The architecture of the three-layer Conv1D</p></caption><graphic xlink:href="13321_2024_839_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par45"><bold>Drug features</bold>   To extract the drug fingerprint features, we used the one-dimensional convolutional neural network (Conv1D), where 1D array-like kernel convolves along a single dimension and identify the patterns from fingerprint information. Here, we considered three different fingerprints include Hashtt(<italic>t</italic>), MAP4(<italic>p</italic>) and MACCS(<italic>s</italic>). We conducted a three-layer Conv1D model, as illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. An input fingerprint sequence is represented as <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_d\in {\mathbb {R}}^{L\times 1}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq13.gif"/></alternatives></inline-formula> in which <italic>L</italic> denotes the length, 1 denotes the dimension and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d \in \{t, p, s\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq14.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+j}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq15.gif"/></alternatives></inline-formula> refer to the concatenation of tokens <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_i, {\textbf{X}}_{i+1},..., {\textbf{X}}_{i+j}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq16.gif"/></alternatives></inline-formula> in the sequence, a feature <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq17.gif"/></alternatives></inline-formula> can be generated from the window of tokens <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq18.gif"/></alternatives></inline-formula> by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} z_i=\textrm{GELU}\left( {\textbf{W}}_k \cdot {\textbf{X}}_{i: i+h-1}+b_k\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{GELU}$$\end{document}</tex-math><mml:math id="M42"><mml:mtext>GELU</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq19.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR37">37</xref>] is an activation function, <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_k\in {\mathbb {R}}^{h\times 1 \times k}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq20.gif"/></alternatives></inline-formula> is a <italic>k</italic>-channel (here is 8) filter applied to a window of <italic>h</italic> token, <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_k\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq21.gif"/></alternatives></inline-formula> is a bias term and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq22.gif"/></alternatives></inline-formula> is a feature generated from the window of tokens <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq23.gif"/></alternatives></inline-formula>. Then, the filter is applied to each possible window of tokens to produce a feature map<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{z}} = \textrm{Concat}(z_1, z_2,..., z_L), \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>=</mml:mo><mml:mtext>Concat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Concat$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq24.gif"/></alternatives></inline-formula> refers to the concatenation process and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{z}}\in {\mathbb {R}}^{L\times k}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq25.gif"/></alternatives></inline-formula>. Subsequently, we conducted similar operations as above with different filter channels (16 and 32 respectively) in the next layers and then got an output <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {z'}\in {\mathbb {R}}^{L\times k'}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq26.gif"/></alternatives></inline-formula> in which <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k'}$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq27.gif"/></alternatives></inline-formula> denote the output channel (here is 32) of the third layer. To obtained the final drug features with expected dimension <italic>D</italic>, we conducted a projection process as follow:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{Z}}_d = {\textbf{W}}_d \cdot \textrm{Flatten}(\mathbf {z'}) + b_d, \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Flatten$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq28.gif"/></alternatives></inline-formula> refers to the flattening process, <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_d\in {\mathbb {R}}^{Lk'\times D}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq29.gif"/></alternatives></inline-formula> is the weight matrix, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_d$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq30.gif"/></alternatives></inline-formula> is the bias term and <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_d\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq31.gif"/></alternatives></inline-formula> is the output drug features. Then, given a drug pair (<italic>i</italic>, <italic>j</italic>), the pairwise features can be represented as <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\textbf{Z}}_{di}, {\textbf{Z}}_{dj})$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq32.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{di}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{dj}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq34.gif"/></alternatives></inline-formula>.</p>
      <p id="Par46"><bold>Cell line features</bold>   To derive cell line features, we employed two distinct three-layer CNNs individually for gene expression (<italic>e</italic>) and gene mutation (<italic>m</italic>) data. Consistent with the fingerprint sequence, an initial gene expression sequence can be represented as <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_{e}\in {\mathbb {R}}^{l\times 1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq35.gif"/></alternatives></inline-formula> in which <italic>l</italic> denotes the number of selected genes and 1 is the dimension. We then conducted the same operations described in the Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>, <xref rid="Equ4" ref-type="disp-formula">4</xref> and <xref rid="Equ5" ref-type="disp-formula">5</xref> to obtained the gene expression features <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{e}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq36.gif"/></alternatives></inline-formula> with <italic>D</italic> represents the output dimension, which aligns with the dimension of drug features. Similarly, the extracted gene mutation features are represented as <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{m}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq37.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47"><bold>Feature fusion</bold>   Recent works [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] have demonstrated the superior performance of Multilayer Perceptron (MLP) in feature fusion tasks. Motivated by these findings, we conducted a MLP-based method to extract fusion feature of drug fingerprints and cell lines. Given a triplet of drug pairs and cell line, a feature <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{H}}_d \in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq38.gif"/></alternatives></inline-formula> is constructed by<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{H}}_d = \textrm{Stack}({\textbf{Z}}_{di}, {\textbf{Z}}_{dj}, {\textbf{Z}}_{e}, {\textbf{Z}}_{m}). \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Stack</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>N</italic> corresponds to the value 4, reflecting the number of features utilized in the stacking process. We then employed two Permute-MLP blocks taken the feature <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq39.gif"/></alternatives></inline-formula> as input. A diagrammatic illustration of the Permute-MLP block is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C). First, we conducted a MLP unit along the <italic>D</italic>-channel, which can be formulated as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{\textbf{H}}_d={\textbf{H}}_d+\textrm{LN}(\textrm{Swish}({\textbf{H}}_d{\textbf{W}}_{dD}^1){\textbf{W}}_{dD}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq40"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Swish}$$\end{document}</tex-math><mml:math id="M92"><mml:mtext>Swish</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq40.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR40">40</xref>] is an activation function, <inline-formula id="IEq41"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{LN}$$\end{document}</tex-math><mml:math id="M94"><mml:mtext>LN</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq41.gif"/></alternatives></inline-formula> refers to LayerNorm [<xref ref-type="bibr" rid="CR41">41</xref>], <inline-formula id="IEq42"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dD}^1, {\textbf{W}}_{dD}^2\in {\mathbb {R}}^{D\times D}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq42.gif"/></alternatives></inline-formula> are the weight matrices and <inline-formula id="IEq43"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq43.gif"/></alternatives></inline-formula>. Then, we perform a <inline-formula id="IEq44"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\text{- }D$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>N</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq44.gif"/></alternatives></inline-formula> permutation operation with respect to <inline-formula id="IEq45"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq45.gif"/></alternatives></inline-formula>, yielding <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq46.gif"/></alternatives></inline-formula>, which is serve as the input to the next MLP unit along the <italic>N</italic>-channel. This process can be described as<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \overline{\textbf{H}}_d = \widehat{\textbf{H}}_d^{\top }+\textrm{LN}(\textrm{Swish}(\widehat{\textbf{H}}^{\top }_d{\textbf{W}}_{dN}^1){\textbf{W}}_{dN}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^1\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^2\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq49.gif"/></alternatives></inline-formula>. To recover the original dimensional information to <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq50.gif"/></alternatives></inline-formula>, we only need to perform a <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\text{- }N$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>D</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq51.gif"/></alternatives></inline-formula> permutation operation on <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq52.gif"/></alternatives></inline-formula>, outputting <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msubsup><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq53.gif"/></alternatives></inline-formula>, which is the input to the next Permute-MLP block. Similarly, we conducted the same operations as above in the second block and obtained a fusion feature <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq54.gif"/></alternatives></inline-formula>. Furthermore, we conducted projection process to obtain the final synergy feature<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{M}}_d=\textrm{GELU}(\textrm{Flatten}(\widetilde{\textbf{H}}_d){\textbf{W}}_{dproj}^1){\textbf{W}}_{dproj}^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^1\in {\mathbb {R}}^{ND\times \widehat{D}}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq55.gif"/></alternatives></inline-formula> with hidden size <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{D}$$\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq56.gif"/></alternatives></inline-formula>, <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^2\in {\mathbb {R}}^{\widehat{D}\times \widetilde{D}}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq57.gif"/></alternatives></inline-formula> with the output dimension <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{D}$$\end{document}</tex-math><mml:math id="M132"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq58.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_d\in {\mathbb {R}}^{\widetilde{D}}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq59.gif"/></alternatives></inline-formula> is the output of <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_d$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq60.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec7">
      <title>Predicting the synergistic effect</title>
      <p id="Par48">The objective of drug synergy prediction is to derive a synergy score for a given drug pair and cell line trio. The process outlined above results in the generation of three distinct synergy features, denoted as <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_t$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_p$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_s$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq63.gif"/></alternatives></inline-formula>, through the utilization of the respective modules <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_t$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_p$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq65.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_s$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq66.gif"/></alternatives></inline-formula>. Each of the generated features was then propagated to a specific prediction module, which consisted of two linear transformations with a GELU activation in between, and output a synergy score <inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_d\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq67.gif"/></alternatives></inline-formula>. In other words, we got three different synergy scores denoted as <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_t$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq68.gif"/></alternatives></inline-formula>, <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_p$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_s$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq70.gif"/></alternatives></inline-formula>. Given a drug-drug-cell line trio, the final predicted synergy score <inline-formula id="IEq71"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}$$\end{document}</tex-math><mml:math id="M158"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq71.gif"/></alternatives></inline-formula> can be calculated as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{y}} = \frac{1}{3}({\hat{y}}_t+{\hat{y}}_p+{\hat{y}}_s) \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Then, the mean square error (MSE) is adopted as the loss function to train the model, which is defined as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}_{MSE} = \frac{1}{n} \sum _{i=1}^n\left( y_i-{\hat{y}}_i\right) ^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">MSE</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> represents the number of training set and <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq72.gif"/></alternatives></inline-formula> is the real score of a given trio.</p>
    </sec>
    <sec id="Sec8">
      <title>Experimental setup</title>
      <sec id="Sec9">
        <title>Data split strategies</title>
        <p id="Par49">We first randomly selected 90% samples from each dataset to conduct a 5-fold cross-validation strategy. To benchmark the performance of graph-fp under different situations, we considered three different strategies shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>:<list list-type="bullet"><list-item><p id="Par50"><bold>Random-split</bold>. The training samples were randomly partitioned into five equal folds. Four of these folds were utilized as the training set, while the remaining one was designated as the test set.</p></list-item><list-item><p id="Par51"><bold>Leave-cell-out</bold>. The cell line set was randomly partitioned into five equal folds. Samples containing the cell lines in four of these folds were used as the training set, while the remaining samples were assigned to the test set. This ensured that the test set contained only cell lines that were not included in the training set.</p></list-item><list-item><p id="Par52"><bold>Leave-combination-out</bold>. The set of drug combinations was randomly partitioned into five equal folds. Samples containing the drug combinations in four of these folds were used as the training set, while the remaining samples were used as the test set, ensuring that the test set only contained unseen drug combinations that were not present in the training set.</p></list-item></list><fig id="Fig3"><label>Fig. 3</label><caption><p>Three different data split strategies. The white parts are used as training and validation data. The grey parts indicate testing data</p></caption><graphic xlink:href="13321_2024_839_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par53">Furthermore, to verify the generalization ability of our method, we used the remaining 10% samples as the independent test set. The models were first trained and evaluated on the cross validation set, and then tested on the independent test set.</p>
      </sec>
      <sec id="Sec10">
        <title>Baselines</title>
        <p id="Par54">To evaluate the performance of our model, we compared it with several competitive deep learning methods.<list list-type="bullet"><list-item><p id="Par55"><bold>HypergraphSynergy</bold> [<xref ref-type="bibr" rid="CR24">24</xref>] employed Hypergraph Neural Networks (HGNN) to predict drug synergy with hypergraphs as input. In this method, drugs and cell lines are represented as nodes, while synergistic drug-drug-cell line triplets are represented as hyperedges. We reproduced the results of HypergraphSynergy and obtained the remaining results as reported in the HypergraphSynergy paper.</p></list-item><list-item><p id="Par56"><bold>DeepSynergy</bold> [<xref ref-type="bibr" rid="CR9">9</xref>] takes molecular chemistry and cell line gene expression as input and used a feed forward neural network to predict synergy scores.</p></list-item><list-item><p id="Par57"><bold>DTF</bold> [<xref ref-type="bibr" rid="CR42">42</xref>] utilized a tensor factorization to decompose drug synergy matrix and the results of the tensor decomposition are used as features to train the DNN model for drug synergy prediction.</p></list-item><list-item><p id="Par58"><bold>CombFM</bold> [<xref ref-type="bibr" rid="CR43">43</xref>] used a higher-order factorization machine to predict synergy scores with a higher-order tensor as input which is compiled by drugs, drug concentrations and cell lines.</p></list-item><list-item><p id="Par59"><bold>Celebi’s method</bold> [<xref ref-type="bibr" rid="CR44">44</xref>] integrate drug synergy features with multiple biological and chemical properties’ features and employed an XG-Boost model to predict synergy scores.</p></list-item></list></p>
      </sec>
      <sec id="Sec11">
        <title>Evaluation metrics</title>
        <p id="Par60">We regarded the drug synergy prediction as a regression task, which objective is to predict the quantitative synergy scores of drug combinations. The regression results were evaluated by three metrics: the root man squared error (RMSE), the coefficient of determination (<inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq73.gif"/></alternatives></inline-formula>) and Pearson’s Correlation Coefficient (PCC). These evaluation metrics are calculated as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{RMSE}= &amp; {} \sqrt{\frac{\sum \limits _{i=1}^n\left( y_t^i-y_p^i\right) ^2}{n}} \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{R}^2= &amp; {} 1-\frac{\textrm{RMSE}^2}{{\text {Var}}\left( y_t^i\right) },\quad \textrm{ where } {\text {Var}}\left( y_t\right) =\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mtext>RMSE</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mtext>Var</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>where Var</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{PCC}= &amp; {} \frac{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) \left( y_p^i-\bar{y}_p\right) }{\sqrt{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2} \sqrt{\sum \limits _{i=1}^n\left( y_p^i-\bar{y}_p\right) ^2}} \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>PCC</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>In the equations, <inline-formula id="IEq74"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_t$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_p$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq75.gif"/></alternatives></inline-formula> denotes the true synergy scores and predicted synergy scores, respectively. <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_t$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_p$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq77.gif"/></alternatives></inline-formula> represent the mean value of the true synergy scores and predicted synergy scores, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results</title>
    <sec id="Sec13">
      <title>Performance comparison on cross validation</title>
      <p id="Par61">The 5-fold cross validation results of PermuteDDS and other competitive methods on O’Neil dataset are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. It can be easily seen that our PermuteDDS surpassed all baselines by a large margin on the random split task, e.g. 9.4% relative <inline-formula id="IEq78"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq78.gif"/></alternatives></inline-formula> increase compared to the previous state-of-art method. Compared with random split task, leave-cell-out and leave-combination-out are more challenging, which test the performance of prediction models on unseen drug combinations/cell lines. On these two tasks, the performance of all methods decreased significantly compared to random split task. PermuteDDS performed slightly worse than HypergraphSynergy on the leave-cell-out task. This may be attributed to the fact that HypergraphSynergy utilized an auxiliary task that involved reconstructing cell line and drug similarity networks, which can enhance the robustness of the model on leave-cell-out task. However, this auxiliary task took all drugs and cell lines as input, resulting in the presence of unknown combinations and cell lines solely within the prediction module. Despite these considerations, the performance gap between our method and HypergraphSynergy remains quite small. As for the leave-combination-out task, PermuteDDS achieved the best results, with 19.3% relative <inline-formula id="IEq79"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq79.gif"/></alternatives></inline-formula> increase and 8.1% relative PCC increase compared to HypergraphSynergy. These results highlight the superior predictive capabilities of PermuteDDS in accurately estimating drug synergy.</p>
      <p id="Par62">Table <xref rid="Tab2" ref-type="table">2</xref> shows that the performance of the models is comparatively lower on the NCI-ALMANAC dataset in comparison to the O’Neil dataset. This observation could be attributed to the fact that the NCI-ALMANAC dataset encompasses a wider range of drugs and cell lines, thereby increasing the complexity of prediction. However, PermuteDDS still achieved better performance in most cases. Regarding the random split task, PermuteDDS demonstrated superior performance compared to other state-of-the-art approaches. It achieved a RMSE of 43.053, a <inline-formula id="IEq80"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M186"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq80.gif"/></alternatives></inline-formula> of 0.527 and a PCC of 0.726. However, similar to the results on the O’Neil dataset, our method only achieved competitive results compared to other methods. However, in the leave-combination-out task, PermuteDDS outperformed all other baseline methods by a large margin, achieving the lowest RMSE of 51.58, the highest <inline-formula id="IEq81"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq81.gif"/></alternatives></inline-formula> of 0.318 and the highest PCC of 0.569.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison on the O’Neil dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq82"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq82.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq83"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq83.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq84.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>13</bold>.<bold>721</bold></td><td align="left"><bold>0</bold>.<bold>641</bold></td><td align="left"><bold>0</bold>.<bold>801</bold></td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left"><bold>16</bold>.<bold>152</bold></td><td align="left"><bold>0</bold>.<bold>501</bold></td><td align="left"><bold>0</bold>.<bold>709</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">14.727</td><td align="left">0.586</td><td align="left">0.775</td><td align="left"><bold>19</bold>.<bold>537</bold></td><td align="left"><bold>0</bold>.<bold>252</bold></td><td align="left">0.533</td><td align="left">17.346</td><td align="left">0.420</td><td align="left">0.656</td></tr><tr><td align="left">DeepSynergy</td><td align="left">14.87</td><td align="left">0.584</td><td align="left">0.765</td><td align="left">23.890</td><td align="left">0.195</td><td align="left">0.426</td><td align="left">17.28</td><td align="left">0.433</td><td align="left">0.663</td></tr><tr><td align="left">ComboFM</td><td align="left">16.86</td><td align="left">0.451</td><td align="left">0.702</td><td align="left">20.820</td><td align="left">0.142</td><td align="left">0.396</td><td align="left">18.62</td><td align="left">0.376</td><td align="left">0.635</td></tr><tr><td align="left">DTF</td><td align="left">14.73</td><td align="left">0.594</td><td align="left">0.775</td><td align="left">21.110</td><td align="left">0.132</td><td align="left"><bold>0</bold>.<bold>535</bold></td><td align="left">17.37</td><td align="left">0.429</td><td align="left">0.671</td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.34</td><td align="left">0.5</td><td align="left">0.708</td><td align="left">20.6</td><td align="left">0.179</td><td align="left">0.473</td><td align="left">19.1</td><td align="left">0.309</td><td align="left">0.572</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison on the NCI-ALMANAC dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq85.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq86.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq87.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>43</bold>.<bold>053</bold></td><td align="left"><bold>0</bold>.<bold>527</bold></td><td align="left"><bold>0</bold>.<bold>726</bold></td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left"><bold>51</bold>.<bold>58</bold></td><td align="left"><bold>0</bold>.<bold>318</bold></td><td align="left"><bold>0</bold>.<bold>569</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">43.89</td><td align="left">0.508</td><td align="left">0.719</td><td align="left"><bold>53</bold>.<bold>398</bold></td><td align="left"><bold>0</bold>.<bold>273</bold></td><td align="left"><bold>0</bold>.<bold>538</bold></td><td align="left">52.609</td><td align="left">0.291</td><td align="left">0.543</td></tr><tr><td align="left">DeepSynergy</td><td align="left">44.44</td><td align="left">0.491</td><td align="left">0.701</td><td align="left">54.560</td><td align="left">0.230</td><td align="left">0.322</td><td align="left">53.500</td><td align="left">0.262</td><td align="left">0.526</td></tr><tr><td align="left">ComboFM</td><td align="left">48.27</td><td align="left">0.399</td><td align="left">0.651</td><td align="left">54.670</td><td align="left">0.245</td><td align="left">0.531</td><td align="left">53.890</td><td align="left">0.267</td><td align="left">0.526</td></tr><tr><td align="left">DTF</td><td align="left">47.03</td><td align="left">0.430</td><td align="left">0.678</td><td align="left">54.730</td><td align="left">0.223</td><td align="left">0.517</td><td align="left">53.470</td><td align="left">0.263</td><td align="left">0.531</td></tr><tr><td align="left">Celebi’s method</td><td align="left">47.31</td><td align="left">0.423</td><td align="left">0.653</td><td align="left">53.49</td><td align="left">0.259</td><td align="left">0.516</td><td align="left">55.830</td><td align="left">0.196</td><td align="left">0.456</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Performance evaluation on independent test</title>
      <p id="Par63">Furthermore, we assessed the generalization performance of our model by testing on independent test sets, and the results are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. Notably, PermuteDDS achieved the overall best performance. Specifically, on the O’Neil dataset, PermuteDDS attained the top result with RMSE, <inline-formula id="IEq88"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M202"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq88.gif"/></alternatives></inline-formula>, and PCC scores of 15.144, 0.659, and 0.821, respectively. While the NCI-ALMANAC dataset’s complexity posed challenges for prediction across all methods, PermuteDDS still exhibited a slight superiority over previous state-of-the-art approaches with RMSE, <inline-formula id="IEq89"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq89.gif"/></alternatives></inline-formula>, and PCC scores of 43.338, 0.484, and 0.696, respectively. To intuitively assess differences in predictive performance across different datasets, we analyzed the distribution of true scores and predicted scores generated by the top three methods—PermuteDDS, HypergraphSynergy, and DeepSynergy. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates that the prediction results of all models on the O’Neil dataset form a well-clustered fitting line, indicative of good predictive performance. Conversely, as depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the results on the ALMANAC datasets appear relatively dispersed, and the expansion of synergy scores (coordinate axis) range further confirms the complexity of this dataset.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance comparison on the independent dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">O’Neil</th><th align="left" colspan="3">NCI-ALMANAC</th></tr><tr><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>15</bold>.<bold>144</bold></td><td align="left"><bold>0</bold>.<bold>659</bold></td><td align="left"><bold>0</bold>.<bold>821</bold></td><td align="left"><bold>43</bold>.<bold>338</bold></td><td align="left"><bold>0</bold>.<bold>484</bold></td><td align="left">0.696</td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">16.710</td><td align="left">0.585</td><td align="left">0.788</td><td align="left">43.730</td><td align="left">0.474</td><td align="left">0.693</td></tr><tr><td align="left">DeepSynergy</td><td align="left">16.840</td><td align="left">0.578</td><td align="left">0.765</td><td align="left">45.325</td><td align="left">0.435</td><td align="left">0.670</td></tr><tr><td align="left">ComboFM</td><td align="left">16.080</td><td align="left">0.541</td><td align="left">0.754</td><td align="left">46.370</td><td align="left">0.457</td><td align="left">0.685</td></tr><tr><td align="left">DTF</td><td align="left">16.150</td><td align="left">0.548</td><td align="left">0.752</td><td align="left">49.860</td><td align="left">0.372</td><td align="left"><bold>0</bold>.<bold>700</bold></td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.500</td><td align="left">0.529</td><td align="left">0.728</td><td align="left">45.860</td><td align="left">0.469</td><td align="left">0.688</td></tr></tbody></table></table-wrap></p>
      <p id="Par64">
        <fig id="Fig4">
          <label>Fig. 4</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig4_HTML" id="MO4"/>
        </fig>
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig5_HTML" id="MO5"/>
        </fig>
        <table-wrap id="Tab4">
          <label>Table 4</label>
          <caption>
            <p>Results of ablation study. Bold values indicate the best performance</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left" rowspan="2"/>
                <th align="left" colspan="3">O’Neil</th>
                <th align="left" colspan="3">NCI-ALMANAC</th>
              </tr>
              <tr>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq90">
                    <alternatives>
                      <tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M206">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq90.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq91">
                    <alternatives>
                      <tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M208">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq91.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">PermuteDDS</td>
                <td align="left"><bold>13</bold>.<bold>721</bold></td>
                <td align="left"><bold>0</bold>.<bold>641</bold></td>
                <td align="left"><bold>0</bold>.<bold>801</bold></td>
                <td align="left"><bold>43</bold>.<bold>053</bold></td>
                <td align="left"><bold>0</bold>.<bold>527</bold></td>
                <td align="left">0.726</td>
              </tr>
              <tr>
                <td align="left">w/o hashtt</td>
                <td align="left">13.895</td>
                <td align="left">0.632</td>
                <td align="left">0.796</td>
                <td align="left">44.081</td>
                <td align="left">0.504</td>
                <td align="left">0.711</td>
              </tr>
              <tr>
                <td align="left">w/o MAP4</td>
                <td align="left">13.746</td>
                <td align="left">0.639</td>
                <td align="left">0.800</td>
                <td align="left">43.964</td>
                <td align="left">0.507</td>
                <td align="left">0.713</td>
              </tr>
              <tr>
                <td align="left">w/o maccs</td>
                <td align="left">13.953</td>
                <td align="left">0.628</td>
                <td align="left">0.793</td>
                <td align="left">44.185</td>
                <td align="left">0.501</td>
                <td align="left">0.709</td>
              </tr>
              <tr>
                <td align="left">hashtt</td>
                <td align="left">14.340</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.034</td>
                <td align="left">0.459</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">maccs</td>
                <td align="left">14.444</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">46.141</td>
                <td align="left">0.456</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">MAP4</td>
                <td align="left">14.345</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.310</td>
                <td align="left">0.452</td>
                <td align="left">0.678</td>
              </tr>
              <tr>
                <td align="left">w/o Permute-MLP</td>
                <td align="left">14.811</td>
                <td align="left">0.581</td>
                <td align="left">0.769</td>
                <td align="left">44.528</td>
                <td align="left">0.494</td>
                <td align="left">0.718</td>
              </tr>
              <tr>
                <td align="left">PermuteDDS-L</td>
                <td align="left">14.433</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">43.138</td>
                <td align="left">0.525</td>
                <td align="left"><bold>0</bold>.<bold>728</bold></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="Sec15">
      <title>Ablation study</title>
      <p id="Par65">To study the effectiveness of each inputs and each PermuteDDS units, we perform the ablation studies under random split on both datasets. As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, the complete PermuteDDS framework achieves the best performance on 5 of 6 evaluation. In terms of the selection of input, we designed variants with different molecular fingerprint combinations as inputs. Upon examination, it becomes evident that the removal of any of the three fingerprints results in a decline in performance, and employing only one fingerprint yields even worse results. We can infer from the results that the combination of the three different fingerprints complements each other jointly contributes to the predictive performance of PermuteDDS. Then, in terms of model design, we conducted another two variants: PermuteDDS without Permute-MLP block and PermuteDDS-L. PermuteDDS-L is the model that utilizes a feedforward network to extract features from fingerprints and cell lines. The model without Permute-MLP block demonstrated inferior performance compared to PermuteDDS, highlighting the effectiveness of this module. Moreover, CNN might not capture as much information from fingerprints and cell lines as expected, as PermuteDDS-L only performed slightly worse than PermuteDDS.</p>
    </sec>
    <sec id="Sec16">
      <title>Model performance is robust against noise cell lines</title>
      <p id="Par66">In actual clinical situations, cancer cells may be mixed with normal cells. To assess the robustness of PermuteDDS, we conducted a sensitivity analysis to evaluate the stability of model performance in response to noise, following the methodology outlined in [<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, we introduced different levels of multiplicative or additive Gaussian noise into the input cell line gene expression and mutation profiles. Subsequently, PermuteDDS was trained using these resulting noisy cell lines. The underlying assumption is that Gaussian noise injected into the data can serve as a simulation of normal cell lines. For a given gene expression (or mutation) profile <italic>X</italic>, the computation of input noisy cell lines is as follows:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{mul}=\,&amp; {} x * N\left( 1, \sigma _{mul}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{add}=\, &amp; {} x + N\left( 0, \sigma _{add}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq92"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{mul}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq92.gif"/></alternatives></inline-formula> represent multiplicative noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq93"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 1, \sigma _{mul}\right) $$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq93.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq94"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{add}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq94.gif"/></alternatives></inline-formula> represent additive noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq95"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 0, \sigma _{add}\right) $$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq95.gif"/></alternatives></inline-formula>. We adopted the same standard deviation as reported in [<xref ref-type="bibr" rid="CR45">45</xref>]. Subsequently, we performed 5-fold cross-validation under random split across each standard deviation on both datasets. As depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, the predicted synergy scores, obtained by training on cell lines with multiplicative Gaussian noise, exhibit consistently high correlations with those trained on the original cell lines. Remarkably, even as the magnitude of the noise increases, the stability of the model’s performance is retained. Similar behavior is observed when subjecting PermuteDDS to additive Gaussian noise, as illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>B. Based on these observations, we can infer that PermuteDDS demonstrates robustness in the presence of noisy data.<fig id="Fig6"><label>Fig. 6</label><caption><p>Correlation between predicted synergy scores of cell lines without noise and cell lines with multiplicative noise (A) or additive noise (B)</p></caption><graphic xlink:href="13321_2024_839_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Cell line data study</title>
      <p id="Par67">Cell lines are known to exhibit sensitivity to variations in experimental conditions. Even identical cell lines obtained from different institutions can exhibit distinct gene expression profiles. To assess the necessity of the selected cell line descriptors, we constructed the variant of the PermuteDDS employing the cell line gene expression profiles sourced from the Cell Lines Project data in the COSMIC database [<xref ref-type="bibr" rid="CR46">46</xref>]. Following the methodology outlined in [<xref ref-type="bibr" rid="CR24">24</xref>], we considered only data related to 651 genes from the COSMIC Cancer Gene Census (<ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/census">https://cancer.sanger.ac.uk/census</ext-link>.). Moreover, we created an another variant utilizing a simple one-hot encoding as the input cell line descriptor, serving as a baseline for comparison. For the leave-cell-out task, the cell lines within the test set, which are unseen during training, are encoded as simple zero vectors. The results on the O’Neil and NCI-ALMANAC datasets are presented in Table <xref rid="Tab5" ref-type="table">5</xref> and Table <xref rid="Tab6" ref-type="table">6</xref>, respectively. The term ‘cline-gdsc’ denotes the original PermuteDDS, whereas ‘cline-cosmic’ and ‘cline-onehot’ refer to the variants employing COSMIC and one-hot cell line descriptors, respectively. The outcomes derived from employing different cell lines descriptors consistently exhibit similar performance across all cross-validation scenarios. This suggests that our method demonstrates insensitivity towards the choice of these cell-line descriptors, as long as the representation method adequately represents and distinguishes different cell lines. It’s crucial to highlight that all variants exhibited poor performance under the leave-cell-out task. Even upon encoding an unseen cell line with a zero vector, no significant differences were observed in comparison to the utilization of gene expression profiles. Indeed, none of the baseline methods demonstrate the capability to achieve satisfactory results on this task (Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>), underscoring the considerable challenge inherent in its execution.</p>
      <p id="Par68">Furthermore, we conducted similar experiments using one-hot encoding as cell line descriptors to construct the other two baseline methods, DeepSynergy and HypergraphSynergy. As presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1 and S2, DeepSynergy exhibited a similar phenomenon to PermuteDDS, wherein employing one-hot encoding as a cell line descriptor yielded similar results to the original. However, replacing the cell line descriptor with one-hot encoding leads to a significant decline in the performance of HypergraphSynergy. This may be attributed to the fact that HypergraphSynergy incorporates the reconstruction of cell line similarities as part of its optimization objective. Since the similarity between cell lines encoded using one-hot encoding is uniformly zero, this reconstruction process loses its significance. These observations reveal the inconsistent sensitivity among different methods to the selection of cell line descriptors, depending on the preprocessing approach applied to the cell lines.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Performance comparison of different cell lines descriptors on the O’Neil dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq96"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M222"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq96.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq97.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq98"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq98.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">13.721</td><td align="left">0.641</td><td align="left">0.801</td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left">16.152</td><td align="left">0.501</td><td align="left">0.709</td></tr><tr><td align="left">cline-cosmic</td><td align="left">13.602</td><td align="left">0.647</td><td align="left">0.805</td><td align="left">19.928</td><td align="left">0.236</td><td align="left">0.508</td><td align="left">16.122</td><td align="left">0.503</td><td align="left">0.71</td></tr><tr><td align="left">cline-onehot</td><td align="left">13.663</td><td align="left">0.644</td><td align="left">0.803</td><td align="left">20.010</td><td align="left">0.232</td><td align="left">0.507</td><td align="left">16.175</td><td align="left">0.499</td><td align="left">0.708</td></tr></tbody></table></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Performance comparison of different cell lines descriptors on the NCI-ALMANAC dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq99"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq99.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq100"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq100.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq101"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M232"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq101.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">43.053</td><td align="left">0.527</td><td align="left">0.726</td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left">51.58</td><td align="left">0.318</td><td align="left">0.569</td></tr><tr><td align="left">cline-cosmic</td><td align="left">43.247</td><td align="left">0.522</td><td align="left">0.723</td><td align="left">54.83</td><td align="left">0.218</td><td align="left">0.515</td><td align="left">51.303</td><td align="left">0.325</td><td align="left">0.575</td></tr><tr><td align="left">cline-onehot</td><td align="left">43.101</td><td align="left">0.526</td><td align="left">0.726</td><td align="left">55.336</td><td align="left">0.209</td><td align="left">0.506</td><td align="left">51.53</td><td align="left">0.319</td><td align="left">0.57</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Predicting novel synergistic combinations</title>
      <p id="Par69">In this section, we employed PermuteDDS to predict novel synergistic drug combinations that had not been previously tested. We utilized all measured trios of drug pairs and cell lines to train PermuteDDS and subsequently made predictions for unmeasured trios using the NCI-ALMANAC dataset. We focused on drug combinations with predicted scores close to 1 (see GitHub link<xref ref-type="fn" rid="Fn3">3</xref>.). We further conducted a nonexhaustive literature search, which revealed that six of the predicted drug combinations were consistent with observations from previous studies. For example, Dasatinib and Gefitinib combination presented a cell-specific cytotoxic synergistic effect in human ovarian cell line OVCAR-3 and IGROV-1 [<xref ref-type="bibr" rid="CR47">47</xref>]. According to the trials of Dolfi et al., combination of fulvestrant and doxorubicin can enhance the sensitivity of breast cancer cell line T47D to these cytotoxic agents [<xref ref-type="bibr" rid="CR48">48</xref>]. We believe that there are other predicted drug pairs that hold the potential of being promising combinations, which require further validation.</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par71">From the results, while PermuteDDS has demonstrated outstanding performance, we noticed that its performance on the leave-cell-out and leave-combination-out tasks is limited. The same situation occurred on other baselines, where <inline-formula id="IEq102"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq102.gif"/></alternatives></inline-formula> and PCC scores are consistently below 0.5 and 0.7, respectively. These scores indicate that the predicted results of the model are almost meaningless for these tasks. The reason for this limitation may be attributed to the distribution shift between the training and test sets, caused by the disparity in drug combinations and cell lines between these sets. The problem is expected to be solved by learning the invariance between different drugs and cell lines [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. Our future work is to explore a more robust model for these leave-out cross validation tasks.</p>
    <p id="Par72">In <xref rid="Sec15" ref-type="sec">3.3</xref>, we deduced that the combined use of the three different fingerprints significantly contributed to the predictive performance of PermuteDDS. This observation is likely because these fingerprints provide distinct descriptions of molecules from various perspectives. HashTT fingerprint is a type of path-based fingerprint that incorporates the topological information of molecules [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. MACCS keys, on the other hand, generate bit strings based on the presence or absence of specific substructures or features, thus enabling the capture of structural information. MAP4 is a novel fingerprint that combines the atom-pair approach with circular substructures, allowing it to encode both molecular shape and chemical information simultaneously [<xref ref-type="bibr" rid="CR35">35</xref>]. Thus, HashTT provides valuable topological information, while MACCS offers essential structural information. Subsequently, MAP4 supplements the chemical properties from the atomic perspective. The fusion of these distinct pieces of information results in a comprehensive and detailed description of the molecules.</p>
    <p id="Par73">In "<xref rid="Sec17" ref-type="sec">Cell line data study</xref>" section, we conducted experiments to investigate the significance of cell line descriptors. The results of these experiments suggest that different methods have varying sensitivities to the choice of cell line descriptors, indicating the limitations of one-hot encoding for certain methods. Moreover, the utilization of different cell line descriptors all resulted in poor performance under the leave-cell-out task. Several other related studies have also demonstrated poor generalization performance on this task [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>]. Nevertheless, we maintain the conviction that continued research in fields such as pharmacology, pharmacokinetics, toxicology, and genetic heterogeneity, alongside the development of novel computational methods, holds the potential to swiftly surmount these challenges.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par74">In conclusion, we proposed PermuteDDS, a novel model designed to predict potential synergistic drug combinations for cancer treatment. PermuteDDS establishes a unified framework that incorporates diverse types of information, including topological structure and chemical properties of drugs, cellular gene expressions and gene mutations. These different data are effectively fused using the FSN architecture to capture the complex interactions between drug pairs and cell lines. PermuteDDS exhibits robust predictive capabilities on two benchmark datasets through comparison with other competitive methods. However, there remain certain limitations that have been previously discussed. Our future work is to explore a more robust model for leave-out cross validation tasks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2024_839_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Table S1. </bold>Performance comparison of one-hot cell line descriptors with different baselines methods on O'Neil dataset.<bold> Table S2.</bold> Performance comparison of one-hot cell line descriptors with different baselines methods on NCI-ALMANAC dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HTS</term>
        <def>
          <p id="Par4">High-throughput screening</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par5">Support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBoost</term>
        <def>
          <p id="Par6">Extreme gradient boosting</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par7">Simplified molecular-input line-entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par8">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>GCN</term>
        <def>
          <p id="Par9">Graph convolutional network</p>
        </def>
      </def-item>
      <def-item>
        <term>HashTT</term>
        <def>
          <p id="Par10">Hashed topological-torsion</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP4</term>
        <def>
          <p id="Par11">MinHashed atom-pair fingerprint up to a diameter of four bonds</p>
        </def>
      </def-item>
      <def-item>
        <term>MACCS</term>
        <def>
          <p id="Par12">Molecular ACCess System</p>
        </def>
      </def-item>
      <def-item>
        <term>DDS</term>
        <def>
          <p id="Par13">Drug-drug synergy</p>
        </def>
      </def-item>
      <def-item>
        <term>GDSC</term>
        <def>
          <p id="Par14">Genomics of Drug Sensitivity in Cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>FSNs</term>
        <def>
          <p id="Par15">Fingerprint specific networks</p>
        </def>
      </def-item>
      <def-item>
        <term>HGNN</term>
        <def>
          <p id="Par16">Hypergraph neural net</p>
        </def>
      </def-item>
      <def-item>
        <term>PPI</term>
        <def>
          <p id="Par17">Protein-protein-interaction</p>
        </def>
      </def-item>
      <def-item>
        <term>Conv1D</term>
        <def>
          <p id="Par18">One-dimensional convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>MSE</term>
        <def>
          <p id="Par19">Mean square error</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par20">Root man squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math>
              <mml:math id="M236">
                <mml:msup>
                  <mml:mtext>R</mml:mtext>
                  <mml:mn>2</mml:mn>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="13321_2024_839_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par21">Coefficient of determination</p>
        </def>
      </def-item>
      <def-item>
        <term>PCC</term>
        <def>
          <p id="Par22">Pearson’s Correlation Coefficient</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par36"><ext-link ext-link-type="uri" xlink:href="https://github.com/reymond-group/MAP4/tree/master">https://github.com/reymond-group/MAP4/tree/master</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par38"><ext-link ext-link-type="uri" xlink:href="https://www.cancerrxgene.org">https://www.cancerrxgene.org</ext-link>.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par70">
        <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv">https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Our deepest gratitude goes to the anonymous reviewers for their careful work and insightful suggestions, which will undoubtedly enhance the quality of this paper.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>X.Z. prepared the data, performed the experiments and wrote the manuscript, J.X. analyzed the results and revised the manuscript, Y.S. and M.X. participated in revising the manuscript, J.H. and X.L. contributed to the interpretation and revising of the manuscript, K.C. organized the database, J.W. and Y.L. supervised the research activity planning and execution.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded by National Natural Science Foundation of China (NSFC, Grant No. 62,271,174, 62,202,373 and 62,102,191); the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department (Grant no.BE2020721); Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"(TC210804V); the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021 (Grant no. [2021]92); the Key Project of Smart Jiangsu in 2020 (Grant no. [2021]1); Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service (Grant no. [2020]1460).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availibility</title>
    <p>Lists the following:</p>
    <p><inline-formula id="IEq103"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M238"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq103.gif"/></alternatives></inline-formula> Project name: PermuteDDS</p>
    <p><inline-formula id="IEq104"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M240"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq104.gif"/></alternatives></inline-formula> Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link></p>
    <p><inline-formula id="IEq105"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M242"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq105.gif"/></alternatives></inline-formula> Operating system(s): Linux, Windows</p>
    <p><inline-formula id="IEq106"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M244"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq106.gif"/></alternatives></inline-formula> Programming language: Python</p>
    <p><inline-formula id="IEq107"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M246"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq107.gif"/></alternatives></inline-formula> Other requirements: Python 3.7 or higher, PyTorch 1.11 or higher</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par80">Not applicable.</p>
    </notes>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par79">The authors declare that they have no Conflict of interest.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Combine and conquer: challenges for targeted therapy combinations in early phase trials</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1038/nrclinonc.2016.96</pub-id>
        <?supplied-pmid 27377132?>
        <pub-id pub-id-type="pmid">27377132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Workman</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial drug therapy for cancer in the post-genomic era</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>679</fpage>
        <lpage>692</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2284</pub-id>
        <?supplied-pmid 22781697?>
        <pub-id pub-id-type="pmid">22781697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gefen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ronin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bar-Meir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
        </person-group>
        <article-title>Effect of tolerance on the evolution of antibiotic resistance under drug combinations</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>367</volume>
        <issue>6474</issue>
        <fpage>200</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3041</pub-id>
        <?supplied-pmid 31919223?>
        <pub-id pub-id-type="pmid">31919223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Azam F, Vazquez A (2021) Trends in Phase II Trials for Cancer Therapies. Cancers 2021, 13, 178. s Note: MDPI stays neu-tral with regard to jurisdictional clai-ms in ..</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ru</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale exploration and analysis of drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>2007</fpage>
        <lpage>2016</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv080</pub-id>
        <?supplied-pmid 25667546?>
        <pub-id pub-id-type="pmid">25667546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Integration of virtual and high-throughput screening</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2002</year>
        <volume>1</volume>
        <issue>11</issue>
        <fpage>882</fpage>
        <lpage>894</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd941</pub-id>
        <?supplied-pmid 12415248?>
        <pub-id pub-id-type="pmid">12415248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferreira</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Adega</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chaves</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The importance of cancer cell lines as in vitro models in cancer methylome analysis and anticancer drugs testing</article-title>
        <source>Oncogenomics</source>
        <year>2013</year>
        <volume>1</volume>
        <fpage>139</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Osimiri</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Lauffenburger</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Systematic analysis of quantitative logic model ensembles predicts drug combination effects on cell signaling networks</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>544</fpage>
        <lpage>553</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preuer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bulusu</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deepsynergy: predicting anti-cancer drug synergy with deep learning</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1538</fpage>
        <lpage>1546</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx806</pub-id>
        <?supplied-pmid 29253077?>
        <pub-id pub-id-type="pmid">29253077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>What is a support vector machine?</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>1565</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1206-1565</pub-id>
        <?supplied-pmid 17160063?>
        <pub-id pub-id-type="pmid">17160063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Chen T, He T, Benesty M, Khotilovich V, Tang Y, Cho H, Chen K, Mitchell R, Cano I, Zhou T et al (2015) Xgboost: extreme gradient boosting. R package version 0.4-2 1(4):1–4</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Dogra</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review on deep synergistic drug prediction techniques for cancer</article-title>
        <source>Arch Comput Methods Eng</source>
        <year>2022</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>1443</fpage>
        <lpage>1461</lpage>
        <pub-id pub-id-type="doi">10.1007/s11831-021-09617-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>In silico drug combination discovery for personalized cancer therapy</article-title>
        <source>BMC Syst Biol</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>59</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="pmid">29801503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>Timonen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koschmieder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wennerberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mustjoki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Patient-customized drug combination prediction and testing for t-cell prolymphocytic leukemia patients</article-title>
        <source>Can Res</source>
        <year>2018</year>
        <volume>78</volume>
        <issue>9</issue>
        <fpage>2407</fpage>
        <lpage>2418</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-3644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuru</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Tastan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cicek</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Matchmaker: a deep learning framework for drug synergy prediction</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2021</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>2334</fpage>
        <lpage>2344</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3086702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>D-S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Q-S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Q-N</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y-Z</given-names>
          </name>
        </person-group>
        <article-title>Chemopy: freely available python package for computational biology and chemoinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1092</fpage>
        <lpage>1094</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt105</pub-id>
        <?supplied-pmid 23493324?>
        <pub-id pub-id-type="pmid">23493324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>An enhanced cascade-based deep forest model for drug combination prediction</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>562</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosseini</surname>
            <given-names>S-R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Ccsynergy: an integrative deep-learning framework enabling context-aware prediction of anti-cancer drug synergy</article-title>
        <source>Brief Bioinform</source>
        <year>2023</year>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>588</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1988</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jim Zheng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Anticancer drug synergy prediction in understudied tissues using transfer learning</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2021</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocaa212</pub-id>
        <?supplied-pmid 33040150?>
        <pub-id pub-id-type="pmid">33040150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Review of unsupervised pretraining strategies for molecules representation</article-title>
        <source>Brief Funct Genomics</source>
        <year>2021</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>323</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elab036</pub-id>
        <?supplied-pmid 34342611?>
        <pub-id pub-id-type="pmid">34342611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Deepdds: deep graph neural network with attention mechanism to predict synergistic drug combinations</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>390</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Multi-way relation-enhanced hypergraph representation learning for anti-cancer drug synergy prediction</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>20</issue>
        <fpage>4782</fpage>
        <lpage>4789</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac579</pub-id>
        <?supplied-pmid 36000898?>
        <pub-id pub-id-type="pmid">36000898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Neil</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Feldman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chenard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kral</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lejnine</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Loboda</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An unbiased oncology compound screen to identify novel combination strategies</article-title>
        <source>Mol Cancer Ther</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1158/1535-7163.MCT-15-0843</pub-id>
        <?supplied-pmid 26983881?>
        <pub-id pub-id-type="pmid">26983881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holbeck</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Camalier</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Crowell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Govindharajulu</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Hollingshead</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Polley</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rubinstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilsker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The national cancer institute almanac: a comprehensive screening resource for the detection of anticancer drug pairs with enhanced therapeutic activity</article-title>
        <source>Can Res</source>
        <year>2017</year>
        <volume>77</volume>
        <issue>13</issue>
        <fpage>3564</fpage>
        <lpage>3576</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-0489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loewe</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The problem of synergism and antagonism of combined drugs</article-title>
        <source>Arzneimittelforschung</source>
        <year>1953</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>285</fpage>
        <lpage>290</lpage>
        <?supplied-pmid 13081480?>
        <pub-id pub-id-type="pmid">13081480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Bliss CI, The toxicity of poisons applied jointly. Ann Appl Biol 26(3):585–615. 10.1111/j.1744-7348.1939.tb06990.x</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gindulyte</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pubchem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>1102</fpage>
        <lpage>1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landrum</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rdkit: a software suite for cheminformatics, computational chemistry, and predictive modeling</article-title>
        <source>Greg Landrum</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iorio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Vis</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Menden</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aben</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gonçalves</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barthorpe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A landscape of pharmacogenomic interactions in cancer</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>3</issue>
        <fpage>740</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.06.017</pub-id>
        <?supplied-pmid 27397505?>
        <pub-id pub-id-type="pmid">27397505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greninger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>IR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of drug sensitivity in cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>955</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Systematic quality control analysis of lincs data</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>588</fpage>
        <lpage>598</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilakantan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bauman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Venkataraghavan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Topological torsion: a new molecular descriptor for SAR applications. Comparison with other descriptors</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1987</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>82</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00054a008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capecchi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>One molecular fingerprint to rule them all: drugs, biomolecules, and the metabolome</article-title>
        <source>J Cheminf</source>
        <year>2020</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00445-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durant</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leland</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Nourse</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Reoptimization of mdl keys for use in drug discovery</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2002</year>
        <volume>42</volume>
        <issue>6</issue>
        <fpage>1273</fpage>
        <lpage>1280</lpage>
        <pub-id pub-id-type="doi">10.1021/ci010132r</pub-id>
        <?supplied-pmid 12444722?>
        <pub-id pub-id-type="pmid">12444722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Hendrycks D, Gimpel K (2016) Gaussian error linear units (gelus). arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1606.08415">arXiv:1606.08415</ext-link></mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolstikhin</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Houlsby</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Unterthiner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Keysers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Uszkoreit</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mlp-mixer: an all-mlp architecture for vision</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2021</year>
        <volume>34</volume>
        <fpage>24261</fpage>
        <lpage>24272</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>M-M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Vision permutator: a permutable MLP-like architecture for visual recognition</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2022</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>1328</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2022.3145427</pub-id>
        <?supplied-pmid 35077359?>
        <pub-id pub-id-type="pmid">35077359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ramachandran P, Zoph B, Le QV (2017) Searching for activation functions. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1710.05941">arXiv:1710.05941</ext-link></mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Ba JL, Kiros JR, Hinton GE (2016) Layer normalization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1607.06450">arXiv:1607.06450</ext-link></mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Dtf: deep tensor factorization for predicting anticancer drug synergy</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>4483</fpage>
        <lpage>4489</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa287</pub-id>
        <?supplied-pmid 32369563?>
        <pub-id pub-id-type="pmid">32369563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Julkunen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cichonska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gautam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Szedmak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Douat</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pahikkala</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Leveraging multi-way interactions for systematic prediction of pre-clinical drug combination effects</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>6136</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19950-z</pub-id>
        <?supplied-pmid 33262326?>
        <pub-id pub-id-type="pmid">33262326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Celebi R, Bear Don’t Walk O, Movva R, Alpsoy S, Dumontier M (2019) In-silico prediction of synergistic anti-cancer drug combinations using multi-omics data. Sci Rep 9(1), 1–10</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Korkut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Ingraham</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cellbox: interpretable machine learning for perturbation biology with application to the design of cancer combination therapy</article-title>
        <source>Cell Syst</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>128</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.11.013</pub-id>
        <?supplied-pmid 33373583?>
        <pub-id pub-id-type="pmid">33373583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gunasekaran</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cosmic: exploring the world’s knowledge of somatic mutations in human cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>805</fpage>
        <lpage>811</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thibault</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jean-Claude</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Dasatinib+ gefitinib, a non platinum-based combination with enhanced growth inhibitory, anti-migratory and anti-invasive potency against human ovarian cancer cells</article-title>
        <source>Journal of ovarian research</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13048-017-0319-2</pub-id>
        <pub-id pub-id-type="pmid">28086946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolfi</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Jäger</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Haffty</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Hirshfield</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Fulvestrant treatment alters mdm2 protein turnover and sensitivity of human breast carcinoma cells to chemotherapeutic drugs</article-title>
        <source>Cancer Lett</source>
        <year>2014</year>
        <volume>350</volume>
        <issue>1–2</issue>
        <fpage>52</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2014.04.009</pub-id>
        <?supplied-pmid 24747123?>
        <pub-id pub-id-type="pmid">24747123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Shen Z, Liu J, He Y, Zhang X, Xu R, Yu H, Cui P (2021) Towards out-of-distribution generalization: a survey. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2108.13624">arXiv:2108.13624</ext-link></mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Learning substructure invariance for out-of-distribution molecular representations</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2022</year>
        <volume>35</volume>
        <fpage>12964</fpage>
        <lpage>12978</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Comparing structural fingerprints using a literature-based similarity benchmark</article-title>
        <source>J Cheminf</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0148-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>A complete graph-based approach with multi-task learning for predicting synergistic drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <issue>6</issue>
        <fpage>351</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btad351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MGAE-DC: Predicting the synergistic effects of drug combinations through multi-channel graph autoencoders</article-title>
        <source>PLoS Comput Biol</source>
        <year>2023</year>
        <volume>19</volume>
        <issue>3</issue>
        <fpage>1010951</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preto</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Matos-Filipe</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mourão</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>IS</given-names>
          </name>
        </person-group>
        <article-title>Synpred: prediction of drug combination effects in cancer using different synergy metrics and ensemble learning</article-title>
        <source>GigaScience</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>087</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giac087</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11017561</article-id>
    <article-id pub-id-type="publisher-id">839</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-024-00839-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PermuteDDS: a permutable feature fusion network for drug-drug synergy prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Xinwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Junqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shui</surname>
          <given-names>Youyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Mengdie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoyan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Che</surname>
          <given-names>Kai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Junjie</given-names>
        </name>
        <address>
          <email>junjie2021@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yun</given-names>
        </name>
        <address>
          <email>liuyun@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Medical Informatics, School of Biomedical Engineering and Informatics, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>The Second Clinical Medical School, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 211166 Jiangsu China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Institute of Medical Informatics and Management, </institution><institution>Nanjing Medical University, </institution></institution-wrap>101 Longmian Avenue, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059gcgy73</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution>Department of Information, </institution><institution>the First Affiliated Hospital, Nanjing Medical University, </institution></institution-wrap>No. 300 Guang Zhou Road, Nanjing, 210029 Jiangsu China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01yqg2h08</institution-id><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>Faculty of Computing, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>No. 92 West Da Zhi St, Harbin, 150001 Heilongjiang China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.424071.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 1755 1589</institution-id><institution>Xi’an Aeronautics Computing Technique Research Institute, AVIC, </institution></institution-wrap>No. 156, TaiBai Nroth Road, Xi’an, 710068 Shanxi China </aff>
      <aff id="Aff7"><label>7</label>Aviation Key Laboratory of Science and Technology on Airborne and Missleborne Computer, Xi’an, 710065 Shanxi China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>41</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Motivation</title>
        <p id="Par1">Drug combination therapies have shown promise in clinical cancer treatments. However, it is hard to experimentally identify all drug combinations for synergistic interaction even with high-throughput screening due to the vast space of potential combinations. Although a number of computational methods for drug synergy prediction have proven successful in narrowing down this space, fusing drug pairs and cell line features effectively still lacks study, hindering current algorithms from understanding the complex interaction between drugs and cell lines.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, named PermuteDDS. PermuteDDS takes multiple representations of drugs and cell lines as input and employs a permutable fusion mechanism to combine drug and cell line features. In experiments, PermuteDDS exhibits state-of-the-art performance on two benchmark data sets. Additionally, the results on independent test set grouped by different tissues reveal that PermuteDDS has good generalization performance. We believed that PermuteDDS is an effective and valuable tool for identifying synergistic drug combinations. It is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link>.</p>
      </sec>
      <sec>
        <title>Scientific contribution</title>
        <p id="Par3">First, this paper proposes a permutable feature fusion network for predicting drug synergy termed PermuteDDS, which extract diverse information from multiple drug representations and cell line representations. Second, the permutable fusion mechanism combine the drug and cell line features by integrating information of different channels, enabling the utilization of complex relationships between drugs and cell lines. Third, comparative and ablation experiments provide evidence of the efficacy of PermuteDDS in predicting drug-drug synergy.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-024-00839-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Drug combination</kwd>
      <kwd>Permutable feature fusion</kwd>
      <kwd>Synergistic effect</kwd>
      <kwd>Cancer</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>No. 62271174</award-id>
        <award-id>No.62202373</award-id>
        <award-id>No.62102191</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Xiaoyan</given-names>
          </name>
          <name>
            <surname>Che</surname>
            <given-names>Kai</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Junjie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department</institution>
        </funding-source>
        <award-id>no.BE2020721</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"</institution>
        </funding-source>
        <award-id>TC210804V</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021</institution>
        </funding-source>
        <award-id>no. [2021]92</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Key Project of Smart Jiangsu in 2020</institution>
        </funding-source>
        <award-id>no. [2021]1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service</institution>
        </funding-source>
        <award-id>no. [2020]1460</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Yun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par23">Single-agent targeted therapies have been widely utilized in clinical cancer treatments. However, the clinical efficacy of monotherapy remains limited due to the biological complexity of tumors and the presence of pre-existing or acquired drug resistance mechanisms [<xref ref-type="bibr" rid="CR1">1</xref>]. In contrast, combination therapies involving the simultaneous administration of multiple drugs have shown promising results in cancer treatment [<xref ref-type="bibr" rid="CR2">2</xref>]. Compared to monotherapy, combination therapies have the potential to enhance treatment efficacy, reduce the dose-limiting toxicity associated with single agents, and overcome drug resistance [<xref ref-type="bibr" rid="CR3">3</xref>]. Despite the potential benefits, it is important to note that not all drug combinations exhibit synergistic effects, and some combinations may even result in antagonistic interactions [<xref ref-type="bibr" rid="CR4">4</xref>]. Therefore, it is essential to accurately determine the interaction between drug combinations to specific diseases.</p>
    <p id="Par24">Traditionally, the discovery of drug combinations heavily relied on clinical trials, posing challenges in terms of time consumption and cost-effectiveness due to the extensive number of potential drug combinations [<xref ref-type="bibr" rid="CR5">5</xref>]. An alternative method is high-throughput screening (HTS), which enables automated testing of chemical and biological compounds against specific biological targets [<xref ref-type="bibr" rid="CR6">6</xref>]. HTS techniques have significantly reduced the time required for identifying potential drug combinations. However, it is important to note that HTS has limitations in revealing the in vivo action modes of drug molecules [<xref ref-type="bibr" rid="CR7">7</xref>]. Moreover, the substantial increase in the number of available drugs has rendered it impractical to comprehensively test the entire combinatorial space using HTS [<xref ref-type="bibr" rid="CR8">8</xref>]. The sheer magnitude of potential drug combinations poses a challenge in terms of feasibility and resource utilization.</p>
    <p id="Par25">Computational methods, particularly machine learning models, have emerged as powerful tools for exploring the vast synergistic space of drug combinations [<xref ref-type="bibr" rid="CR9">9</xref>]. These machine learning-based models can be broadly categorized into two types: classical machine learning and deep learning. Classical machine learning models, such as random forest [<xref ref-type="bibr" rid="CR10">10</xref>], support vector machine (SVM) [<xref ref-type="bibr" rid="CR11">11</xref>], extreme gradient boosting (XGBoost) [<xref ref-type="bibr" rid="CR12">12</xref>], have been widely utilized in drug synergy prediction. These models leverage genomic information from cancer cells, physiochemical properties of drugs, and drug-cell interaction data to predict drug synergy [<xref ref-type="bibr" rid="CR13">13</xref>]. For instance, Jeon et al. [<xref ref-type="bibr" rid="CR14">14</xref>] employed random forest and SVM algorithms to predict the synergistic effects of anticancer drug combinations by incorporating monotherapy response and synthetic lethality information. However, this approach heavily relies on the given dataset, and the model may struggle to accurately predict the features of drug combinations without prior knowledge. Another study by He et al. [<xref ref-type="bibr" rid="CR15">15</xref>] proposed an XGBoost-based model that predicts the selective synergistic effects of cancer by utilizing distinct single compound sensitivity curves between patient cells and healthy controls. This approach aimed to minimize potential toxicity associated with drug combinations.</p>
    <p id="Par26">Recently, deep learning has gained increasing popularity in drug development and discovery. Compare to classical machine learning methods, deep learning algorithms have better generalization performance, making it efficient in handling large drug combination datasets. Deep learning-based methods typically frame the challenge of drug synergy prediction as a regression task, aiming to predict the quantitative synergy scores. These methods can be categorized into three groups: fingerprint-based methods, SMILE-based methods and graph-based methods. Fingerprint-based methods take molecular fingerprint (also called descriptor) as input. Preuer et al. [<xref ref-type="bibr" rid="CR9">9</xref>] proposed DeepSynergy, a feedforward neural network-based deep learning model for drug synergy score prediction that employs molecular fingerprints and gene expression as inputs. The performance of DeepSynergy demonstrated significant improvement over classical machine learning models. Kuru et al. [<xref ref-type="bibr" rid="CR16">16</xref>] developed a MatchMaker model for predicting synergistic drug combinations using chemical descriptors generated by ChemoPy [<xref ref-type="bibr" rid="CR17">17</xref>] and the expression profiles of landmark genes as input. Lin et al. [<xref ref-type="bibr" rid="CR18">18</xref>] amalgamated molecular fingerprint information with drug induced gene expression profiles to capture drug cell responses to reveal the mechanisms of biological synergistic effects, and using deep forests as feature learning models. Hosseini et al. [<xref ref-type="bibr" rid="CR19">19</xref>] proposed CCSynergy, used a feed forward network to obtain the fusion feature of drug fingerprints and mutiple cell line representations for durg syergy prediction. SMILE-based methods select simplified molecular-input line-entry system (SMILES) [<xref ref-type="bibr" rid="CR20">20</xref>] as drug representations. Kim et al. [<xref ref-type="bibr" rid="CR21">21</xref>] utilized a muti-head attention mechanism and convolutional neural networks (CNN) to encode drug SMILES. Graph-based methods that extract features from molecular graphs have the potential to capture structural information about the molecules [<xref ref-type="bibr" rid="CR22">22</xref>]. Wang et al. [<xref ref-type="bibr" rid="CR23">23</xref>] proposed DeepDDS, a model that utilizes a graph convolutional network (GCN) and attention mechanism to compute drug embedding vectors, which are integrated with cell line gene expression data to predict drug synergy. Liu et al. [<xref ref-type="bibr" rid="CR24">24</xref>] proposed HypergraphSynergy, a method employing hypergraph representation learning to predict anti-cancer drug synergy by considering drugs and cell lines as nodes and representing drug pair-cell line triplets as hyperedges.</p>
    <p id="Par27">The previously mentioned deep learning-based methods have exhibited impressive performance in predicting drug synergy, yet there is still room for further improvement. One limitation is that these methods typically only use single type drug representation, thereby failing to provide a comprehensive description of drugs. Moreover, most of these methods simply fuse drug and cell line features through simple operations such as concatenation or addition, neglecting dynamic synergies between drug pairs and cell lines.</p>
    <p id="Par28">In light of the limitations associated with existing approaches for predicting drug synergy, we proposed a Permutable feature fusion network for Drug-Drug Synergy prediction, namely PermuteDDS. Our method addresses the challenge of limited representation types by considering multiple representations of drugs and cell lines. We employed the one-dimensional CNN to learn and extract high-latent features from these representations. Then, we designed a permutable fusion mechanism to combine the drug and cell line features, allowing us to capture the complex relationships between drug combinations and cell lines. Finally, we conducted experiments on two benchmark datasets, and the results compared to state-of-the-art methods indicated that PermuteDDS is an effective model for drug synergy prediction. In summary, the contributions of our work are as follows:<list list-type="bullet"><list-item><p id="Par29">We propose PermuteDDS, a deep learning model for drug-drug synergy prediction with multiple input representations.</p></list-item><list-item><p id="Par30">Our major contribution lies in the application of the permutable fusion mechanism to represent the interactions between drug combinations and cell lines.</p></list-item><list-item><p id="Par31">We conduct comprehensive experiments to demonstrate the effectiveness of our proposed model. We present ablations and analysis to gain a deeper understanding of the model’s behavior.</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Data description</title>
      <p id="Par32">We collected Drug-Drug Synergy (DDS) data, molecular structures of drugs, the expression profiles and mutation information of cell lines from various public databases as below.<list list-type="bullet"><list-item><p id="Par33"><bold>Drug-Drug Synergy datasets.</bold> The Drug-Drug Synergy (DDS) data were obtained from two released large-scale oncology screening datasets, namely O’Neil [<xref ref-type="bibr" rid="CR25">25</xref>] and NCI-ALMANAC [<xref ref-type="bibr" rid="CR26">26</xref>]. The O’Neil dataset contains 22 737 samples estimated by Loewe synergy score [<xref ref-type="bibr" rid="CR27">27</xref>] consisting of two chemicals and a cell line, covering 38 unique drugs and 39 diverse caner cell lines. The NCI-ALMANAC dataset comprises 304 549 samples evaluated by the ComboScores of pairwise combinations of 104 FDA-approved anticancer drugs against a panel of 60 well-characterized human tumor cell lines.</p></list-item><list-item><p id="Par34"><bold>Drug synergy scores.</bold> The Loewe synergy score incorporates the concepts of sham combination and dose equivalence. Let <italic>A</italic> and <italic>B</italic> denote two drugs, and <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_A$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_B$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq3.gif"/></alternatives></inline-formula> represent their respective doses. The drug synergy score can then be computed as follows [<xref ref-type="bibr" rid="CR27">27</xref>]: <disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{Loewe}=\frac{R_{\min }+R_{\max }\left( \frac{x_A+x_B}{m}\right) ^\lambda }{1+\left( \frac{x_A+x_B}{m}\right) ^\lambda } \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{Loewe}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">Loewe</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq4.gif"/></alternatives></inline-formula> is a continuous value, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq6.gif"/></alternatives></inline-formula> represents the maximum and minimum drug response, respectively. <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M14"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq7.gif"/></alternatives></inline-formula> is the shape parameter and <italic>m</italic> is the dose that produce midpoint between <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\min }$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">min</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\max }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>R</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq9.gif"/></alternatives></inline-formula>. The determination of combination benefit, denoted as ‘ComboScore’ [<xref ref-type="bibr" rid="CR26">26</xref>], relies on a modification of Bliss independence [<xref ref-type="bibr" rid="CR28">28</xref>]. Let <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}^{A_p B_q}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq10.gif"/></alternatives></inline-formula> represent the growth fraction for the <italic>i</italic>-th cell line exposed to the <italic>p</italic>-th concentration of drug A and the <italic>q</italic>-th concentration of drug B. Similarly, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_i^{A_p B_q}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq11.gif"/></alternatives></inline-formula> denote the expected growth fraction for the combination. The final continuous combination score <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ComboScore}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq12.gif"/></alternatives></inline-formula> for the cell line and the drug combination can then be computed as the sum of the differences between expected and observed growth fractions: <disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ComboScore}=\sum _{p, q} Y_i^{A_p B_q}-Z_i^{A_p B_q} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ComboScore</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par35"><bold>Molecular structures of drugs.</bold> The SMILES of the drugs were obtained from PubChem database [<xref ref-type="bibr" rid="CR29">29</xref>], based on which the chemical and structure information of a drug can be converted to fingerprints with RDKit [<xref ref-type="bibr" rid="CR30">30</xref>] and MAP4 project.<xref ref-type="fn" rid="Fn1">1</xref></p></list-item><list-item><p id="Par37"><bold>Gene expression and gene mutation of cell lines.</bold> The gene expression and gene mutation of cell lines were obtained from Genomics of Drug Sensitivity in Cancer (GDSC) database,<xref ref-type="fn" rid="Fn2">2</xref>. where 1000 human cancer cell lines were characterised and screened [<xref ref-type="bibr" rid="CR31">31</xref>]. To enhance the representation of cell lines, we identified significant genes by referencing The Library of Integrated Network-Based Cellular Signatures (LINCS) project [<xref ref-type="bibr" rid="CR32">32</xref>]. The LINCS project offers a meticulously curated set of approximately 1000 genes, known as the ‘landmark gene set’, which captures 80% of the information from Connectivity Map data [<xref ref-type="bibr" rid="CR33">33</xref>]. We selected genes that intersected between GDSC gene expression profiles and the landmark set, as well as gene mutation profiles. Finally, 899 genes were chosen for expression profiles, and 968 genes were selected for mutation profiles.</p></list-item></list>We preprocessed the two dataset by eliminating the drugs lacking SMILES and the cell lines devoid of gene expressions or gene mutations. The resulting refined O’Neil dataset comprised 18 950 samples with Loewe synergy scores across 38 drugs and 39 cell lines, while the processed NCI-AlMANAC dataset consisted of 74 139 instances with NCI ComboScores (a Bliss independence modification) across 87 drugs and 55 cell lines.</p>
    </sec>
    <sec id="Sec4">
      <title>Molecular fingerprints</title>
      <p id="Par39">Molecular fingerprints (also referred to as descriptors) is a prevalent method of drug representation. Within this approach, each molecule is encoded as a binary string that delineate the presence or absence of specific substructure fragments or properties within the molecule. A value of 0 corresponds to absence of the particular feature, while a value of 1 denotes its existence. Moreover, the fingerprints exhibit uniqueness; specifically, one molecule possesses one sequence for a particular fingerprints type, yet it can have numerous diverse fingerprints types [<xref ref-type="bibr" rid="CR22">22</xref>]. The three different kinds of fingerprints employed in this article are described below.<list list-type="bullet"><list-item><p id="Par40"><bold>Hashed topological-torsion (HashTT)</bold> is a kind of topological fingerprints [<xref ref-type="bibr" rid="CR34">34</xref>]. The fragments employed in HashTT fingerprints are linear sequence comprising four consecutively bonded non-hydrogen atoms. The label for each fragment is determined based on its atomic type, the number of non-hydrogen branches attached to it, and its number of 7r electrons of each atom. These labels then undergo a hashing process to generate the HashTT fingerprints.</p></list-item><list-item><p id="Par41"><bold>MinHashed atom-pair fingerprint up to a diameter of four bonds (MAP4)</bold> [<xref ref-type="bibr" rid="CR35">35</xref>] is a novel fingerprint that integrates both substructure fingerprints and atom-pair fingerprints. Given a molecule SMILE sentence, the circular substructures with radii of r = 1 and r = 2 bonds around individual atoms within an atom-pair configuration are encoded as two pairs of SMILES. Each pair is subsequently combined with the topological distance separating the central atoms. These atom-pair molecular shingles undergo a hashing process, and the resulting set of hashes is subjected to the MinHashed technique, which lead to the creation of the MAP4 fingerprint.</p></list-item><list-item><p id="Par42"><bold>Molecular ACCess System (MACCS)</bold> [<xref ref-type="bibr" rid="CR36">36</xref>] keys are one of the most commonly used structural fingerprints. In this fingerprint, one molecule is encoded as a 166-bit binary string, where each bit corresponds to a predefined structural fragment (e.g. 3-element ring).</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>The overview of the PermuteDDS framework</p></caption><graphic xlink:href="13321_2024_839_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Overview of PermuteDDS</title>
      <p id="Par43">PermuteDDS is an end-to-end framework for predicting drug combinations, presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Specifically, Fig. <xref rid="Fig1" ref-type="fig">1</xref>(A) illustrates the pipeline implemented by PermuteDDS to derive the synergy scores. Our framework contains three subnetworks called Fingerprint Specific Networks (FSNs), all of which share the same architecture shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(B). Each FSN takes a drug pair of a certain fingerprint and a cell line pair including its gene expression and gene mutation profiles as inputs. Then, the CNNs are used to extract drug and cell line features, and the Permute-MLP module (Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C)) is proposed to obtain the fusion synergy feature, which is the output of FSN. The three FSNs output three distinct synergy features, each of which is propagated through a specific prediction module to generate a synergy score. The final outputs of PermuteDDS is the average of the synergy scores predicted by these prediction modules.</p>
    </sec>
    <sec id="Sec6">
      <title>Fingerprint specific subnetwork (FSN)</title>
      <p id="Par44">Given a drug fingerprint pair and a cell line pair as inputs, the FSN encompasses three essential processes, including drug features extraction, cell line features extraction and feature fusion, which integrates the extracted drug and cell line features. The output of FSN is a synergy feature. A comprehensive overview of these processes is provided below.<fig id="Fig2"><label>Fig. 2</label><caption><p>The architecture of the three-layer Conv1D</p></caption><graphic xlink:href="13321_2024_839_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par45"><bold>Drug features</bold>   To extract the drug fingerprint features, we used the one-dimensional convolutional neural network (Conv1D), where 1D array-like kernel convolves along a single dimension and identify the patterns from fingerprint information. Here, we considered three different fingerprints include Hashtt(<italic>t</italic>), MAP4(<italic>p</italic>) and MACCS(<italic>s</italic>). We conducted a three-layer Conv1D model, as illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. An input fingerprint sequence is represented as <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_d\in {\mathbb {R}}^{L\times 1}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq13.gif"/></alternatives></inline-formula> in which <italic>L</italic> denotes the length, 1 denotes the dimension and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d \in \{t, p, s\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq14.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+j}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq15.gif"/></alternatives></inline-formula> refer to the concatenation of tokens <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_i, {\textbf{X}}_{i+1},..., {\textbf{X}}_{i+j}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq16.gif"/></alternatives></inline-formula> in the sequence, a feature <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq17.gif"/></alternatives></inline-formula> can be generated from the window of tokens <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq18.gif"/></alternatives></inline-formula> by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} z_i=\textrm{GELU}\left( {\textbf{W}}_k \cdot {\textbf{X}}_{i: i+h-1}+b_k\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{GELU}$$\end{document}</tex-math><mml:math id="M42"><mml:mtext>GELU</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq19.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR37">37</xref>] is an activation function, <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_k\in {\mathbb {R}}^{h\times 1 \times k}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq20.gif"/></alternatives></inline-formula> is a <italic>k</italic>-channel (here is 8) filter applied to a window of <italic>h</italic> token, <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_k\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq21.gif"/></alternatives></inline-formula> is a bias term and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_i\in {\mathbb {R}}^{k}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq22.gif"/></alternatives></inline-formula> is a feature generated from the window of tokens <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_{i: i+h-1}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq23.gif"/></alternatives></inline-formula>. Then, the filter is applied to each possible window of tokens to produce a feature map<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{z}} = \textrm{Concat}(z_1, z_2,..., z_L), \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>=</mml:mo><mml:mtext>Concat</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Concat$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq24.gif"/></alternatives></inline-formula> refers to the concatenation process and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{z}}\in {\mathbb {R}}^{L\times k}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq25.gif"/></alternatives></inline-formula>. Subsequently, we conducted similar operations as above with different filter channels (16 and 32 respectively) in the next layers and then got an output <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {z'}\in {\mathbb {R}}^{L\times k'}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq26.gif"/></alternatives></inline-formula> in which <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k'}$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq27.gif"/></alternatives></inline-formula> denote the output channel (here is 32) of the third layer. To obtained the final drug features with expected dimension <italic>D</italic>, we conducted a projection process as follow:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{Z}}_d = {\textbf{W}}_d \cdot \textrm{Flatten}(\mathbf {z'}) + b_d, \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm Flatten$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq28.gif"/></alternatives></inline-formula> refers to the flattening process, <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_d\in {\mathbb {R}}^{Lk'\times D}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq29.gif"/></alternatives></inline-formula> is the weight matrix, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_d$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>b</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq30.gif"/></alternatives></inline-formula> is the bias term and <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_d\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq31.gif"/></alternatives></inline-formula> is the output drug features. Then, given a drug pair (<italic>i</italic>, <italic>j</italic>), the pairwise features can be represented as <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\textbf{Z}}_{di}, {\textbf{Z}}_{dj})$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq32.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{di}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{dj}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq34.gif"/></alternatives></inline-formula>.</p>
      <p id="Par46"><bold>Cell line features</bold>   To derive cell line features, we employed two distinct three-layer CNNs individually for gene expression (<italic>e</italic>) and gene mutation (<italic>m</italic>) data. Consistent with the fingerprint sequence, an initial gene expression sequence can be represented as <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\textbf{X}}_{e}\in {\mathbb {R}}^{l\times 1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq35.gif"/></alternatives></inline-formula> in which <italic>l</italic> denotes the number of selected genes and 1 is the dimension. We then conducted the same operations described in the Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>, <xref rid="Equ4" ref-type="disp-formula">4</xref> and <xref rid="Equ5" ref-type="disp-formula">5</xref> to obtained the gene expression features <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{e}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq36.gif"/></alternatives></inline-formula> with <italic>D</italic> represents the output dimension, which aligns with the dimension of drug features. Similarly, the extracted gene mutation features are represented as <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_{m}\in {\mathbb {R}}^{D}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq37.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47"><bold>Feature fusion</bold>   Recent works [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] have demonstrated the superior performance of Multilayer Perceptron (MLP) in feature fusion tasks. Motivated by these findings, we conducted a MLP-based method to extract fusion feature of drug fingerprints and cell lines. Given a triplet of drug pairs and cell line, a feature <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{H}}_d \in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq38.gif"/></alternatives></inline-formula> is constructed by<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{H}}_d = \textrm{Stack}({\textbf{Z}}_{di}, {\textbf{Z}}_{dj}, {\textbf{Z}}_{e}, {\textbf{Z}}_{m}). \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Stack</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">di</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">dj</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>N</italic> corresponds to the value 4, reflecting the number of features utilized in the stacking process. We then employed two Permute-MLP blocks taken the feature <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq39.gif"/></alternatives></inline-formula> as input. A diagrammatic illustration of the Permute-MLP block is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>(C). First, we conducted a MLP unit along the <italic>D</italic>-channel, which can be formulated as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{\textbf{H}}_d={\textbf{H}}_d+\textrm{LN}(\textrm{Swish}({\textbf{H}}_d{\textbf{W}}_{dD}^1){\textbf{W}}_{dD}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq40"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Swish}$$\end{document}</tex-math><mml:math id="M92"><mml:mtext>Swish</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq40.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR40">40</xref>] is an activation function, <inline-formula id="IEq41"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{LN}$$\end{document}</tex-math><mml:math id="M94"><mml:mtext>LN</mml:mtext></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq41.gif"/></alternatives></inline-formula> refers to LayerNorm [<xref ref-type="bibr" rid="CR41">41</xref>], <inline-formula id="IEq42"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dD}^1, {\textbf{W}}_{dD}^2\in {\mathbb {R}}^{D\times D}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dD</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq42.gif"/></alternatives></inline-formula> are the weight matrices and <inline-formula id="IEq43"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq43.gif"/></alternatives></inline-formula>. Then, we perform a <inline-formula id="IEq44"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\text{- }D$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>N</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq44.gif"/></alternatives></inline-formula> permutation operation with respect to <inline-formula id="IEq45"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq45.gif"/></alternatives></inline-formula>, yielding <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq46.gif"/></alternatives></inline-formula>, which is serve as the input to the next MLP unit along the <italic>N</italic>-channel. This process can be described as<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \overline{\textbf{H}}_d = \widehat{\textbf{H}}_d^{\top }+\textrm{LN}(\textrm{Swish}(\widehat{\textbf{H}}^{\top }_d{\textbf{W}}_{dN}^1){\textbf{W}}_{dN}^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mtext>LN</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Swish</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^1\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dN}^2\in {\mathbb {R}}^{D\times N}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dN</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq49.gif"/></alternatives></inline-formula>. To recover the original dimensional information to <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {H_d}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi mathvariant="bold">d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq50.gif"/></alternatives></inline-formula>, we only need to perform a <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\text{- }N$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>D</mml:mi><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq51.gif"/></alternatives></inline-formula> permutation operation on <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq52.gif"/></alternatives></inline-formula>, outputting <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\textbf{H}}_d^{\top }\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msubsup><mml:mover><mml:mi mathvariant="bold">H</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq53.gif"/></alternatives></inline-formula>, which is the input to the next Permute-MLP block. Similarly, we conducted the same operations as above in the second block and obtained a fusion feature <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textbf{H}}_d\in {\mathbb {R}}^{N\times D}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq54.gif"/></alternatives></inline-formula>. Furthermore, we conducted projection process to obtain the final synergy feature<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{M}}_d=\textrm{GELU}(\textrm{Flatten}(\widetilde{\textbf{H}}_d){\textbf{W}}_{dproj}^1){\textbf{W}}_{dproj}^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>GELU</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Flatten</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">H</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^1\in {\mathbb {R}}^{ND\times \widehat{D}}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq55.gif"/></alternatives></inline-formula> with hidden size <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{D}$$\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq56.gif"/></alternatives></inline-formula>, <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{W}}_{dproj}^2\in {\mathbb {R}}^{\widehat{D}\times \widetilde{D}}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi mathvariant="italic">dproj</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq57.gif"/></alternatives></inline-formula> with the output dimension <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{D}$$\end{document}</tex-math><mml:math id="M132"><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq58.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_d\in {\mathbb {R}}^{\widetilde{D}}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq59.gif"/></alternatives></inline-formula> is the output of <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_d$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq60.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec7">
      <title>Predicting the synergistic effect</title>
      <p id="Par48">The objective of drug synergy prediction is to derive a synergy score for a given drug pair and cell line trio. The process outlined above results in the generation of three distinct synergy features, denoted as <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_t$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_p$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}}_s$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq63.gif"/></alternatives></inline-formula>, through the utilization of the respective modules <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_t$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_p$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq65.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{FSN}_s$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mtext>FSN</mml:mtext><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq66.gif"/></alternatives></inline-formula>. Each of the generated features was then propagated to a specific prediction module, which consisted of two linear transformations with a GELU activation in between, and output a synergy score <inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_d\in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq67.gif"/></alternatives></inline-formula>. In other words, we got three different synergy scores denoted as <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_t$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq68.gif"/></alternatives></inline-formula>, <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_p$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_s$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq70.gif"/></alternatives></inline-formula>. Given a drug-drug-cell line trio, the final predicted synergy score <inline-formula id="IEq71"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}$$\end{document}</tex-math><mml:math id="M158"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq71.gif"/></alternatives></inline-formula> can be calculated as<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{y}} = \frac{1}{3}({\hat{y}}_t+{\hat{y}}_p+{\hat{y}}_s) \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Then, the mean square error (MSE) is adopted as the loss function to train the model, which is defined as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathcal {L}}_{MSE} = \frac{1}{n} \sum _{i=1}^n\left( y_i-{\hat{y}}_i\right) ^2, \end{aligned}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">MSE</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> represents the number of training set and <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq72.gif"/></alternatives></inline-formula> is the real score of a given trio.</p>
    </sec>
    <sec id="Sec8">
      <title>Experimental setup</title>
      <sec id="Sec9">
        <title>Data split strategies</title>
        <p id="Par49">We first randomly selected 90% samples from each dataset to conduct a 5-fold cross-validation strategy. To benchmark the performance of graph-fp under different situations, we considered three different strategies shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>:<list list-type="bullet"><list-item><p id="Par50"><bold>Random-split</bold>. The training samples were randomly partitioned into five equal folds. Four of these folds were utilized as the training set, while the remaining one was designated as the test set.</p></list-item><list-item><p id="Par51"><bold>Leave-cell-out</bold>. The cell line set was randomly partitioned into five equal folds. Samples containing the cell lines in four of these folds were used as the training set, while the remaining samples were assigned to the test set. This ensured that the test set contained only cell lines that were not included in the training set.</p></list-item><list-item><p id="Par52"><bold>Leave-combination-out</bold>. The set of drug combinations was randomly partitioned into five equal folds. Samples containing the drug combinations in four of these folds were used as the training set, while the remaining samples were used as the test set, ensuring that the test set only contained unseen drug combinations that were not present in the training set.</p></list-item></list><fig id="Fig3"><label>Fig. 3</label><caption><p>Three different data split strategies. The white parts are used as training and validation data. The grey parts indicate testing data</p></caption><graphic xlink:href="13321_2024_839_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par53">Furthermore, to verify the generalization ability of our method, we used the remaining 10% samples as the independent test set. The models were first trained and evaluated on the cross validation set, and then tested on the independent test set.</p>
      </sec>
      <sec id="Sec10">
        <title>Baselines</title>
        <p id="Par54">To evaluate the performance of our model, we compared it with several competitive deep learning methods.<list list-type="bullet"><list-item><p id="Par55"><bold>HypergraphSynergy</bold> [<xref ref-type="bibr" rid="CR24">24</xref>] employed Hypergraph Neural Networks (HGNN) to predict drug synergy with hypergraphs as input. In this method, drugs and cell lines are represented as nodes, while synergistic drug-drug-cell line triplets are represented as hyperedges. We reproduced the results of HypergraphSynergy and obtained the remaining results as reported in the HypergraphSynergy paper.</p></list-item><list-item><p id="Par56"><bold>DeepSynergy</bold> [<xref ref-type="bibr" rid="CR9">9</xref>] takes molecular chemistry and cell line gene expression as input and used a feed forward neural network to predict synergy scores.</p></list-item><list-item><p id="Par57"><bold>DTF</bold> [<xref ref-type="bibr" rid="CR42">42</xref>] utilized a tensor factorization to decompose drug synergy matrix and the results of the tensor decomposition are used as features to train the DNN model for drug synergy prediction.</p></list-item><list-item><p id="Par58"><bold>CombFM</bold> [<xref ref-type="bibr" rid="CR43">43</xref>] used a higher-order factorization machine to predict synergy scores with a higher-order tensor as input which is compiled by drugs, drug concentrations and cell lines.</p></list-item><list-item><p id="Par59"><bold>Celebi’s method</bold> [<xref ref-type="bibr" rid="CR44">44</xref>] integrate drug synergy features with multiple biological and chemical properties’ features and employed an XG-Boost model to predict synergy scores.</p></list-item></list></p>
      </sec>
      <sec id="Sec11">
        <title>Evaluation metrics</title>
        <p id="Par60">We regarded the drug synergy prediction as a regression task, which objective is to predict the quantitative synergy scores of drug combinations. The regression results were evaluated by three metrics: the root man squared error (RMSE), the coefficient of determination (<inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq73.gif"/></alternatives></inline-formula>) and Pearson’s Correlation Coefficient (PCC). These evaluation metrics are calculated as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{RMSE}= &amp; {} \sqrt{\frac{\sum \limits _{i=1}^n\left( y_t^i-y_p^i\right) ^2}{n}} \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msqrt><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{R}^2= &amp; {} 1-\frac{\textrm{RMSE}^2}{{\text {Var}}\left( y_t^i\right) },\quad \textrm{ where } {\text {Var}}\left( y_t\right) =\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mtext>RMSE</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mtext>Var</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="0.333333em"/><mml:mtext>where Var</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \textrm{PCC}= &amp; {} \frac{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) \left( y_p^i-\bar{y}_p\right) }{\sqrt{\sum \limits _{i=1}^n\left( y_t^i-\bar{y}_t\right) ^2} \sqrt{\sum \limits _{i=1}^n\left( y_p^i-\bar{y}_p\right) ^2}} \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>PCC</mml:mtext><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>In the equations, <inline-formula id="IEq74"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_t$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_p$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq75.gif"/></alternatives></inline-formula> denotes the true synergy scores and predicted synergy scores, respectively. <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_t$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{y}_p$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq77.gif"/></alternatives></inline-formula> represent the mean value of the true synergy scores and predicted synergy scores, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results</title>
    <sec id="Sec13">
      <title>Performance comparison on cross validation</title>
      <p id="Par61">The 5-fold cross validation results of PermuteDDS and other competitive methods on O’Neil dataset are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. It can be easily seen that our PermuteDDS surpassed all baselines by a large margin on the random split task, e.g. 9.4% relative <inline-formula id="IEq78"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq78.gif"/></alternatives></inline-formula> increase compared to the previous state-of-art method. Compared with random split task, leave-cell-out and leave-combination-out are more challenging, which test the performance of prediction models on unseen drug combinations/cell lines. On these two tasks, the performance of all methods decreased significantly compared to random split task. PermuteDDS performed slightly worse than HypergraphSynergy on the leave-cell-out task. This may be attributed to the fact that HypergraphSynergy utilized an auxiliary task that involved reconstructing cell line and drug similarity networks, which can enhance the robustness of the model on leave-cell-out task. However, this auxiliary task took all drugs and cell lines as input, resulting in the presence of unknown combinations and cell lines solely within the prediction module. Despite these considerations, the performance gap between our method and HypergraphSynergy remains quite small. As for the leave-combination-out task, PermuteDDS achieved the best results, with 19.3% relative <inline-formula id="IEq79"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq79.gif"/></alternatives></inline-formula> increase and 8.1% relative PCC increase compared to HypergraphSynergy. These results highlight the superior predictive capabilities of PermuteDDS in accurately estimating drug synergy.</p>
      <p id="Par62">Table <xref rid="Tab2" ref-type="table">2</xref> shows that the performance of the models is comparatively lower on the NCI-ALMANAC dataset in comparison to the O’Neil dataset. This observation could be attributed to the fact that the NCI-ALMANAC dataset encompasses a wider range of drugs and cell lines, thereby increasing the complexity of prediction. However, PermuteDDS still achieved better performance in most cases. Regarding the random split task, PermuteDDS demonstrated superior performance compared to other state-of-the-art approaches. It achieved a RMSE of 43.053, a <inline-formula id="IEq80"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M186"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq80.gif"/></alternatives></inline-formula> of 0.527 and a PCC of 0.726. However, similar to the results on the O’Neil dataset, our method only achieved competitive results compared to other methods. However, in the leave-combination-out task, PermuteDDS outperformed all other baseline methods by a large margin, achieving the lowest RMSE of 51.58, the highest <inline-formula id="IEq81"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq81.gif"/></alternatives></inline-formula> of 0.318 and the highest PCC of 0.569.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison on the O’Neil dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq82"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq82.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq83"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq83.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq84.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>13</bold>.<bold>721</bold></td><td align="left"><bold>0</bold>.<bold>641</bold></td><td align="left"><bold>0</bold>.<bold>801</bold></td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left"><bold>16</bold>.<bold>152</bold></td><td align="left"><bold>0</bold>.<bold>501</bold></td><td align="left"><bold>0</bold>.<bold>709</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">14.727</td><td align="left">0.586</td><td align="left">0.775</td><td align="left"><bold>19</bold>.<bold>537</bold></td><td align="left"><bold>0</bold>.<bold>252</bold></td><td align="left">0.533</td><td align="left">17.346</td><td align="left">0.420</td><td align="left">0.656</td></tr><tr><td align="left">DeepSynergy</td><td align="left">14.87</td><td align="left">0.584</td><td align="left">0.765</td><td align="left">23.890</td><td align="left">0.195</td><td align="left">0.426</td><td align="left">17.28</td><td align="left">0.433</td><td align="left">0.663</td></tr><tr><td align="left">ComboFM</td><td align="left">16.86</td><td align="left">0.451</td><td align="left">0.702</td><td align="left">20.820</td><td align="left">0.142</td><td align="left">0.396</td><td align="left">18.62</td><td align="left">0.376</td><td align="left">0.635</td></tr><tr><td align="left">DTF</td><td align="left">14.73</td><td align="left">0.594</td><td align="left">0.775</td><td align="left">21.110</td><td align="left">0.132</td><td align="left"><bold>0</bold>.<bold>535</bold></td><td align="left">17.37</td><td align="left">0.429</td><td align="left">0.671</td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.34</td><td align="left">0.5</td><td align="left">0.708</td><td align="left">20.6</td><td align="left">0.179</td><td align="left">0.473</td><td align="left">19.1</td><td align="left">0.309</td><td align="left">0.572</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison on the NCI-ALMANAC dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq85.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq86.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq87.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>43</bold>.<bold>053</bold></td><td align="left"><bold>0</bold>.<bold>527</bold></td><td align="left"><bold>0</bold>.<bold>726</bold></td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left"><bold>51</bold>.<bold>58</bold></td><td align="left"><bold>0</bold>.<bold>318</bold></td><td align="left"><bold>0</bold>.<bold>569</bold></td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">43.89</td><td align="left">0.508</td><td align="left">0.719</td><td align="left"><bold>53</bold>.<bold>398</bold></td><td align="left"><bold>0</bold>.<bold>273</bold></td><td align="left"><bold>0</bold>.<bold>538</bold></td><td align="left">52.609</td><td align="left">0.291</td><td align="left">0.543</td></tr><tr><td align="left">DeepSynergy</td><td align="left">44.44</td><td align="left">0.491</td><td align="left">0.701</td><td align="left">54.560</td><td align="left">0.230</td><td align="left">0.322</td><td align="left">53.500</td><td align="left">0.262</td><td align="left">0.526</td></tr><tr><td align="left">ComboFM</td><td align="left">48.27</td><td align="left">0.399</td><td align="left">0.651</td><td align="left">54.670</td><td align="left">0.245</td><td align="left">0.531</td><td align="left">53.890</td><td align="left">0.267</td><td align="left">0.526</td></tr><tr><td align="left">DTF</td><td align="left">47.03</td><td align="left">0.430</td><td align="left">0.678</td><td align="left">54.730</td><td align="left">0.223</td><td align="left">0.517</td><td align="left">53.470</td><td align="left">0.263</td><td align="left">0.531</td></tr><tr><td align="left">Celebi’s method</td><td align="left">47.31</td><td align="left">0.423</td><td align="left">0.653</td><td align="left">53.49</td><td align="left">0.259</td><td align="left">0.516</td><td align="left">55.830</td><td align="left">0.196</td><td align="left">0.456</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Performance evaluation on independent test</title>
      <p id="Par63">Furthermore, we assessed the generalization performance of our model by testing on independent test sets, and the results are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. Notably, PermuteDDS achieved the overall best performance. Specifically, on the O’Neil dataset, PermuteDDS attained the top result with RMSE, <inline-formula id="IEq88"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M202"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq88.gif"/></alternatives></inline-formula>, and PCC scores of 15.144, 0.659, and 0.821, respectively. While the NCI-ALMANAC dataset’s complexity posed challenges for prediction across all methods, PermuteDDS still exhibited a slight superiority over previous state-of-the-art approaches with RMSE, <inline-formula id="IEq89"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq89.gif"/></alternatives></inline-formula>, and PCC scores of 43.338, 0.484, and 0.696, respectively. To intuitively assess differences in predictive performance across different datasets, we analyzed the distribution of true scores and predicted scores generated by the top three methods—PermuteDDS, HypergraphSynergy, and DeepSynergy. Figure <xref rid="Fig4" ref-type="fig">4</xref> illustrates that the prediction results of all models on the O’Neil dataset form a well-clustered fitting line, indicative of good predictive performance. Conversely, as depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the results on the ALMANAC datasets appear relatively dispersed, and the expansion of synergy scores (coordinate axis) range further confirms the complexity of this dataset.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance comparison on the independent dataset. Bold values indicate the best performance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">O’Neil</th><th align="left" colspan="3">NCI-ALMANAC</th></tr><tr><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th><th align="left">RMSE</th><th align="left">R2</th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">PermuteDDS</td><td align="left"><bold>15</bold>.<bold>144</bold></td><td align="left"><bold>0</bold>.<bold>659</bold></td><td align="left"><bold>0</bold>.<bold>821</bold></td><td align="left"><bold>43</bold>.<bold>338</bold></td><td align="left"><bold>0</bold>.<bold>484</bold></td><td align="left">0.696</td></tr><tr><td align="left">HypergraphSynergy</td><td align="left">16.710</td><td align="left">0.585</td><td align="left">0.788</td><td align="left">43.730</td><td align="left">0.474</td><td align="left">0.693</td></tr><tr><td align="left">DeepSynergy</td><td align="left">16.840</td><td align="left">0.578</td><td align="left">0.765</td><td align="left">45.325</td><td align="left">0.435</td><td align="left">0.670</td></tr><tr><td align="left">ComboFM</td><td align="left">16.080</td><td align="left">0.541</td><td align="left">0.754</td><td align="left">46.370</td><td align="left">0.457</td><td align="left">0.685</td></tr><tr><td align="left">DTF</td><td align="left">16.150</td><td align="left">0.548</td><td align="left">0.752</td><td align="left">49.860</td><td align="left">0.372</td><td align="left"><bold>0</bold>.<bold>700</bold></td></tr><tr><td align="left">Celebi’s method</td><td align="left">16.500</td><td align="left">0.529</td><td align="left">0.728</td><td align="left">45.860</td><td align="left">0.469</td><td align="left">0.688</td></tr></tbody></table></table-wrap></p>
      <p id="Par64">
        <fig id="Fig4">
          <label>Fig. 4</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig4_HTML" id="MO4"/>
        </fig>
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Independent test results on the O’Neil dataset. From left to right: PermuteDDS, HypergraphSynergy and DeepSynergy</p>
          </caption>
          <graphic xlink:href="13321_2024_839_Fig5_HTML" id="MO5"/>
        </fig>
        <table-wrap id="Tab4">
          <label>Table 4</label>
          <caption>
            <p>Results of ablation study. Bold values indicate the best performance</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left" rowspan="2"/>
                <th align="left" colspan="3">O’Neil</th>
                <th align="left" colspan="3">NCI-ALMANAC</th>
              </tr>
              <tr>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq90">
                    <alternatives>
                      <tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M206">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq90.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
                <th align="left">RMSE</th>
                <th align="left">
                  <inline-formula id="IEq91">
                    <alternatives>
                      <tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^{2}$$\end{document}</tex-math>
                      <mml:math id="M208">
                        <mml:msup>
                          <mml:mtext>R</mml:mtext>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:math>
                      <inline-graphic xlink:href="13321_2024_839_Article_IEq91.gif"/>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left">PCC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">PermuteDDS</td>
                <td align="left"><bold>13</bold>.<bold>721</bold></td>
                <td align="left"><bold>0</bold>.<bold>641</bold></td>
                <td align="left"><bold>0</bold>.<bold>801</bold></td>
                <td align="left"><bold>43</bold>.<bold>053</bold></td>
                <td align="left"><bold>0</bold>.<bold>527</bold></td>
                <td align="left">0.726</td>
              </tr>
              <tr>
                <td align="left">w/o hashtt</td>
                <td align="left">13.895</td>
                <td align="left">0.632</td>
                <td align="left">0.796</td>
                <td align="left">44.081</td>
                <td align="left">0.504</td>
                <td align="left">0.711</td>
              </tr>
              <tr>
                <td align="left">w/o MAP4</td>
                <td align="left">13.746</td>
                <td align="left">0.639</td>
                <td align="left">0.800</td>
                <td align="left">43.964</td>
                <td align="left">0.507</td>
                <td align="left">0.713</td>
              </tr>
              <tr>
                <td align="left">w/o maccs</td>
                <td align="left">13.953</td>
                <td align="left">0.628</td>
                <td align="left">0.793</td>
                <td align="left">44.185</td>
                <td align="left">0.501</td>
                <td align="left">0.709</td>
              </tr>
              <tr>
                <td align="left">hashtt</td>
                <td align="left">14.340</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.034</td>
                <td align="left">0.459</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">maccs</td>
                <td align="left">14.444</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">46.141</td>
                <td align="left">0.456</td>
                <td align="left">0.681</td>
              </tr>
              <tr>
                <td align="left">MAP4</td>
                <td align="left">14.345</td>
                <td align="left">0.607</td>
                <td align="left">0.780</td>
                <td align="left">46.310</td>
                <td align="left">0.452</td>
                <td align="left">0.678</td>
              </tr>
              <tr>
                <td align="left">w/o Permute-MLP</td>
                <td align="left">14.811</td>
                <td align="left">0.581</td>
                <td align="left">0.769</td>
                <td align="left">44.528</td>
                <td align="left">0.494</td>
                <td align="left">0.718</td>
              </tr>
              <tr>
                <td align="left">PermuteDDS-L</td>
                <td align="left">14.433</td>
                <td align="left">0.602</td>
                <td align="left">0.777</td>
                <td align="left">43.138</td>
                <td align="left">0.525</td>
                <td align="left"><bold>0</bold>.<bold>728</bold></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="Sec15">
      <title>Ablation study</title>
      <p id="Par65">To study the effectiveness of each inputs and each PermuteDDS units, we perform the ablation studies under random split on both datasets. As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, the complete PermuteDDS framework achieves the best performance on 5 of 6 evaluation. In terms of the selection of input, we designed variants with different molecular fingerprint combinations as inputs. Upon examination, it becomes evident that the removal of any of the three fingerprints results in a decline in performance, and employing only one fingerprint yields even worse results. We can infer from the results that the combination of the three different fingerprints complements each other jointly contributes to the predictive performance of PermuteDDS. Then, in terms of model design, we conducted another two variants: PermuteDDS without Permute-MLP block and PermuteDDS-L. PermuteDDS-L is the model that utilizes a feedforward network to extract features from fingerprints and cell lines. The model without Permute-MLP block demonstrated inferior performance compared to PermuteDDS, highlighting the effectiveness of this module. Moreover, CNN might not capture as much information from fingerprints and cell lines as expected, as PermuteDDS-L only performed slightly worse than PermuteDDS.</p>
    </sec>
    <sec id="Sec16">
      <title>Model performance is robust against noise cell lines</title>
      <p id="Par66">In actual clinical situations, cancer cells may be mixed with normal cells. To assess the robustness of PermuteDDS, we conducted a sensitivity analysis to evaluate the stability of model performance in response to noise, following the methodology outlined in [<xref ref-type="bibr" rid="CR45">45</xref>]. Specifically, we introduced different levels of multiplicative or additive Gaussian noise into the input cell line gene expression and mutation profiles. Subsequently, PermuteDDS was trained using these resulting noisy cell lines. The underlying assumption is that Gaussian noise injected into the data can serve as a simulation of normal cell lines. For a given gene expression (or mutation) profile <italic>X</italic>, the computation of input noisy cell lines is as follows:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{mul}=\,&amp; {} x * N\left( 1, \sigma _{mul}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x_{add}=\, &amp; {} x + N\left( 0, \sigma _{add}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2024_839_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq92"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{mul}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq92.gif"/></alternatives></inline-formula> represent multiplicative noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq93"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 1, \sigma _{mul}\right) $$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">mul</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq93.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq94"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{add}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq94.gif"/></alternatives></inline-formula> represent additive noisy cell lines generated with a Gaussian distribution <inline-formula id="IEq95"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left( 0, \sigma _{add}\right) $$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">add</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq95.gif"/></alternatives></inline-formula>. We adopted the same standard deviation as reported in [<xref ref-type="bibr" rid="CR45">45</xref>]. Subsequently, we performed 5-fold cross-validation under random split across each standard deviation on both datasets. As depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, the predicted synergy scores, obtained by training on cell lines with multiplicative Gaussian noise, exhibit consistently high correlations with those trained on the original cell lines. Remarkably, even as the magnitude of the noise increases, the stability of the model’s performance is retained. Similar behavior is observed when subjecting PermuteDDS to additive Gaussian noise, as illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>B. Based on these observations, we can infer that PermuteDDS demonstrates robustness in the presence of noisy data.<fig id="Fig6"><label>Fig. 6</label><caption><p>Correlation between predicted synergy scores of cell lines without noise and cell lines with multiplicative noise (A) or additive noise (B)</p></caption><graphic xlink:href="13321_2024_839_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Cell line data study</title>
      <p id="Par67">Cell lines are known to exhibit sensitivity to variations in experimental conditions. Even identical cell lines obtained from different institutions can exhibit distinct gene expression profiles. To assess the necessity of the selected cell line descriptors, we constructed the variant of the PermuteDDS employing the cell line gene expression profiles sourced from the Cell Lines Project data in the COSMIC database [<xref ref-type="bibr" rid="CR46">46</xref>]. Following the methodology outlined in [<xref ref-type="bibr" rid="CR24">24</xref>], we considered only data related to 651 genes from the COSMIC Cancer Gene Census (<ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/census">https://cancer.sanger.ac.uk/census</ext-link>.). Moreover, we created an another variant utilizing a simple one-hot encoding as the input cell line descriptor, serving as a baseline for comparison. For the leave-cell-out task, the cell lines within the test set, which are unseen during training, are encoded as simple zero vectors. The results on the O’Neil and NCI-ALMANAC datasets are presented in Table <xref rid="Tab5" ref-type="table">5</xref> and Table <xref rid="Tab6" ref-type="table">6</xref>, respectively. The term ‘cline-gdsc’ denotes the original PermuteDDS, whereas ‘cline-cosmic’ and ‘cline-onehot’ refer to the variants employing COSMIC and one-hot cell line descriptors, respectively. The outcomes derived from employing different cell lines descriptors consistently exhibit similar performance across all cross-validation scenarios. This suggests that our method demonstrates insensitivity towards the choice of these cell-line descriptors, as long as the representation method adequately represents and distinguishes different cell lines. It’s crucial to highlight that all variants exhibited poor performance under the leave-cell-out task. Even upon encoding an unseen cell line with a zero vector, no significant differences were observed in comparison to the utilization of gene expression profiles. Indeed, none of the baseline methods demonstrate the capability to achieve satisfactory results on this task (Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>), underscoring the considerable challenge inherent in its execution.</p>
      <p id="Par68">Furthermore, we conducted similar experiments using one-hot encoding as cell line descriptors to construct the other two baseline methods, DeepSynergy and HypergraphSynergy. As presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1 and S2, DeepSynergy exhibited a similar phenomenon to PermuteDDS, wherein employing one-hot encoding as a cell line descriptor yielded similar results to the original. However, replacing the cell line descriptor with one-hot encoding leads to a significant decline in the performance of HypergraphSynergy. This may be attributed to the fact that HypergraphSynergy incorporates the reconstruction of cell line similarities as part of its optimization objective. Since the similarity between cell lines encoded using one-hot encoding is uniformly zero, this reconstruction process loses its significance. These observations reveal the inconsistent sensitivity among different methods to the selection of cell line descriptors, depending on the preprocessing approach applied to the cell lines.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Performance comparison of different cell lines descriptors on the O’Neil dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq96"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M222"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq96.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq97.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq98"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq98.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">13.721</td><td align="left">0.641</td><td align="left">0.801</td><td align="left">19.668</td><td align="left">0.243</td><td align="left">0.522</td><td align="left">16.152</td><td align="left">0.501</td><td align="left">0.709</td></tr><tr><td align="left">cline-cosmic</td><td align="left">13.602</td><td align="left">0.647</td><td align="left">0.805</td><td align="left">19.928</td><td align="left">0.236</td><td align="left">0.508</td><td align="left">16.122</td><td align="left">0.503</td><td align="left">0.71</td></tr><tr><td align="left">cline-onehot</td><td align="left">13.663</td><td align="left">0.644</td><td align="left">0.803</td><td align="left">20.010</td><td align="left">0.232</td><td align="left">0.507</td><td align="left">16.175</td><td align="left">0.499</td><td align="left">0.708</td></tr></tbody></table></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Performance comparison of different cell lines descriptors on the NCI-ALMANAC dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left" colspan="3">Random split</th><th align="left" colspan="3">Leave-cell-out</th><th align="left" colspan="3">Leave-combination-out</th></tr><tr><th align="left">RMSE</th><th align="left"><inline-formula id="IEq99"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq99.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq100"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq100.gif"/></alternatives></inline-formula></th><th align="left">PCC</th><th align="left">RMSE</th><th align="left"><inline-formula id="IEq101"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math><mml:math id="M232"><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq101.gif"/></alternatives></inline-formula></th><th align="left">PCC</th></tr></thead><tbody><tr><td align="left">cline-gdsc</td><td align="left">43.053</td><td align="left">0.527</td><td align="left">0.726</td><td align="left">54.128</td><td align="left">0.242</td><td align="left">0.519</td><td align="left">51.58</td><td align="left">0.318</td><td align="left">0.569</td></tr><tr><td align="left">cline-cosmic</td><td align="left">43.247</td><td align="left">0.522</td><td align="left">0.723</td><td align="left">54.83</td><td align="left">0.218</td><td align="left">0.515</td><td align="left">51.303</td><td align="left">0.325</td><td align="left">0.575</td></tr><tr><td align="left">cline-onehot</td><td align="left">43.101</td><td align="left">0.526</td><td align="left">0.726</td><td align="left">55.336</td><td align="left">0.209</td><td align="left">0.506</td><td align="left">51.53</td><td align="left">0.319</td><td align="left">0.57</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Predicting novel synergistic combinations</title>
      <p id="Par69">In this section, we employed PermuteDDS to predict novel synergistic drug combinations that had not been previously tested. We utilized all measured trios of drug pairs and cell lines to train PermuteDDS and subsequently made predictions for unmeasured trios using the NCI-ALMANAC dataset. We focused on drug combinations with predicted scores close to 1 (see GitHub link<xref ref-type="fn" rid="Fn3">3</xref>.). We further conducted a nonexhaustive literature search, which revealed that six of the predicted drug combinations were consistent with observations from previous studies. For example, Dasatinib and Gefitinib combination presented a cell-specific cytotoxic synergistic effect in human ovarian cell line OVCAR-3 and IGROV-1 [<xref ref-type="bibr" rid="CR47">47</xref>]. According to the trials of Dolfi et al., combination of fulvestrant and doxorubicin can enhance the sensitivity of breast cancer cell line T47D to these cytotoxic agents [<xref ref-type="bibr" rid="CR48">48</xref>]. We believe that there are other predicted drug pairs that hold the potential of being promising combinations, which require further validation.</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par71">From the results, while PermuteDDS has demonstrated outstanding performance, we noticed that its performance on the leave-cell-out and leave-combination-out tasks is limited. The same situation occurred on other baselines, where <inline-formula id="IEq102"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^{2}$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq102.gif"/></alternatives></inline-formula> and PCC scores are consistently below 0.5 and 0.7, respectively. These scores indicate that the predicted results of the model are almost meaningless for these tasks. The reason for this limitation may be attributed to the distribution shift between the training and test sets, caused by the disparity in drug combinations and cell lines between these sets. The problem is expected to be solved by learning the invariance between different drugs and cell lines [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. Our future work is to explore a more robust model for these leave-out cross validation tasks.</p>
    <p id="Par72">In <xref rid="Sec15" ref-type="sec">3.3</xref>, we deduced that the combined use of the three different fingerprints significantly contributed to the predictive performance of PermuteDDS. This observation is likely because these fingerprints provide distinct descriptions of molecules from various perspectives. HashTT fingerprint is a type of path-based fingerprint that incorporates the topological information of molecules [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. MACCS keys, on the other hand, generate bit strings based on the presence or absence of specific substructures or features, thus enabling the capture of structural information. MAP4 is a novel fingerprint that combines the atom-pair approach with circular substructures, allowing it to encode both molecular shape and chemical information simultaneously [<xref ref-type="bibr" rid="CR35">35</xref>]. Thus, HashTT provides valuable topological information, while MACCS offers essential structural information. Subsequently, MAP4 supplements the chemical properties from the atomic perspective. The fusion of these distinct pieces of information results in a comprehensive and detailed description of the molecules.</p>
    <p id="Par73">In "<xref rid="Sec17" ref-type="sec">Cell line data study</xref>" section, we conducted experiments to investigate the significance of cell line descriptors. The results of these experiments suggest that different methods have varying sensitivities to the choice of cell line descriptors, indicating the limitations of one-hot encoding for certain methods. Moreover, the utilization of different cell line descriptors all resulted in poor performance under the leave-cell-out task. Several other related studies have also demonstrated poor generalization performance on this task [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>]. Nevertheless, we maintain the conviction that continued research in fields such as pharmacology, pharmacokinetics, toxicology, and genetic heterogeneity, alongside the development of novel computational methods, holds the potential to swiftly surmount these challenges.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par74">In conclusion, we proposed PermuteDDS, a novel model designed to predict potential synergistic drug combinations for cancer treatment. PermuteDDS establishes a unified framework that incorporates diverse types of information, including topological structure and chemical properties of drugs, cellular gene expressions and gene mutations. These different data are effectively fused using the FSN architecture to capture the complex interactions between drug pairs and cell lines. PermuteDDS exhibits robust predictive capabilities on two benchmark datasets through comparison with other competitive methods. However, there remain certain limitations that have been previously discussed. Our future work is to explore a more robust model for leave-out cross validation tasks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2024_839_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Table S1. </bold>Performance comparison of one-hot cell line descriptors with different baselines methods on O'Neil dataset.<bold> Table S2.</bold> Performance comparison of one-hot cell line descriptors with different baselines methods on NCI-ALMANAC dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HTS</term>
        <def>
          <p id="Par4">High-throughput screening</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par5">Support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBoost</term>
        <def>
          <p id="Par6">Extreme gradient boosting</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par7">Simplified molecular-input line-entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par8">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>GCN</term>
        <def>
          <p id="Par9">Graph convolutional network</p>
        </def>
      </def-item>
      <def-item>
        <term>HashTT</term>
        <def>
          <p id="Par10">Hashed topological-torsion</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP4</term>
        <def>
          <p id="Par11">MinHashed atom-pair fingerprint up to a diameter of four bonds</p>
        </def>
      </def-item>
      <def-item>
        <term>MACCS</term>
        <def>
          <p id="Par12">Molecular ACCess System</p>
        </def>
      </def-item>
      <def-item>
        <term>DDS</term>
        <def>
          <p id="Par13">Drug-drug synergy</p>
        </def>
      </def-item>
      <def-item>
        <term>GDSC</term>
        <def>
          <p id="Par14">Genomics of Drug Sensitivity in Cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>FSNs</term>
        <def>
          <p id="Par15">Fingerprint specific networks</p>
        </def>
      </def-item>
      <def-item>
        <term>HGNN</term>
        <def>
          <p id="Par16">Hypergraph neural net</p>
        </def>
      </def-item>
      <def-item>
        <term>PPI</term>
        <def>
          <p id="Par17">Protein-protein-interaction</p>
        </def>
      </def-item>
      <def-item>
        <term>Conv1D</term>
        <def>
          <p id="Par18">One-dimensional convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>MSE</term>
        <def>
          <p id="Par19">Mean square error</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par20">Root man squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}^2$$\end{document}</tex-math>
              <mml:math id="M236">
                <mml:msup>
                  <mml:mtext>R</mml:mtext>
                  <mml:mn>2</mml:mn>
                </mml:msup>
              </mml:math>
              <inline-graphic xlink:href="13321_2024_839_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par21">Coefficient of determination</p>
        </def>
      </def-item>
      <def-item>
        <term>PCC</term>
        <def>
          <p id="Par22">Pearson’s Correlation Coefficient</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par36"><ext-link ext-link-type="uri" xlink:href="https://github.com/reymond-group/MAP4/tree/master">https://github.com/reymond-group/MAP4/tree/master</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par38"><ext-link ext-link-type="uri" xlink:href="https://www.cancerrxgene.org">https://www.cancerrxgene.org</ext-link>.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par70">
        <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv">https://github.com/littlewei-lazy/PermuteDDS/blob/main/Data/novel_synergy_predict.csv</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Our deepest gratitude goes to the anonymous reviewers for their careful work and insightful suggestions, which will undoubtedly enhance the quality of this paper.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>X.Z. prepared the data, performed the experiments and wrote the manuscript, J.X. analyzed the results and revised the manuscript, Y.S. and M.X. participated in revising the manuscript, J.H. and X.L. contributed to the interpretation and revising of the manuscript, K.C. organized the database, J.W. and Y.L. supervised the research activity planning and execution.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded by National Natural Science Foundation of China (NSFC, Grant No. 62,271,174, 62,202,373 and 62,102,191); the Industry Prospecting and Common Key Technology Key Projects of Jiangsu Province Science and Technology Department (Grant no.BE2020721); Industrial Chain Collaborative Innovation Project of Ministry of Industry and Information Technology "Multi-modal Medical Data Intelligent Management Software for the New Generation of Information Technology"(TC210804V); the Industrial and Information Industry Transformation and Upgrading Special Fund of Jiangsu Province in 2021 (Grant no. [2021]92); the Key Project of Smart Jiangsu in 2020 (Grant no. [2021]1); Jiangsu Province Engineering Research Center of Big Data Application in Chronic Disease and Intelligent Health Service (Grant no. [2020]1460).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availibility</title>
    <p>Lists the following:</p>
    <p><inline-formula id="IEq103"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M238"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq103.gif"/></alternatives></inline-formula> Project name: PermuteDDS</p>
    <p><inline-formula id="IEq104"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M240"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq104.gif"/></alternatives></inline-formula> Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/littlewei-lazy/PermuteDDS">https://github.com/littlewei-lazy/PermuteDDS</ext-link></p>
    <p><inline-formula id="IEq105"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M242"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq105.gif"/></alternatives></inline-formula> Operating system(s): Linux, Windows</p>
    <p><inline-formula id="IEq106"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M244"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq106.gif"/></alternatives></inline-formula> Programming language: Python</p>
    <p><inline-formula id="IEq107"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet $$\end{document}</tex-math><mml:math id="M246"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13321_2024_839_Article_IEq107.gif"/></alternatives></inline-formula> Other requirements: Python 3.7 or higher, PyTorch 1.11 or higher</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par80">Not applicable.</p>
    </notes>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par79">The authors declare that they have no Conflict of interest.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Combine and conquer: challenges for targeted therapy combinations in early phase trials</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1038/nrclinonc.2016.96</pub-id>
        <?supplied-pmid 27377132?>
        <pub-id pub-id-type="pmid">27377132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Banerji</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Workman</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial drug therapy for cancer in the post-genomic era</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>679</fpage>
        <lpage>692</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2284</pub-id>
        <?supplied-pmid 22781697?>
        <pub-id pub-id-type="pmid">22781697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gefen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ronin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bar-Meir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Balaban</surname>
            <given-names>NQ</given-names>
          </name>
        </person-group>
        <article-title>Effect of tolerance on the evolution of antibiotic resistance under drug combinations</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>367</volume>
        <issue>6474</issue>
        <fpage>200</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3041</pub-id>
        <?supplied-pmid 31919223?>
        <pub-id pub-id-type="pmid">31919223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Azam F, Vazquez A (2021) Trends in Phase II Trials for Cancer Therapies. Cancers 2021, 13, 178. s Note: MDPI stays neu-tral with regard to jurisdictional clai-ms in ..</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ru</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale exploration and analysis of drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>2007</fpage>
        <lpage>2016</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv080</pub-id>
        <?supplied-pmid 25667546?>
        <pub-id pub-id-type="pmid">25667546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Integration of virtual and high-throughput screening</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2002</year>
        <volume>1</volume>
        <issue>11</issue>
        <fpage>882</fpage>
        <lpage>894</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd941</pub-id>
        <?supplied-pmid 12415248?>
        <pub-id pub-id-type="pmid">12415248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferreira</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Adega</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chaves</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The importance of cancer cell lines as in vitro models in cancer methylome analysis and anticancer drugs testing</article-title>
        <source>Oncogenomics</source>
        <year>2013</year>
        <volume>1</volume>
        <fpage>139</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Osimiri</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Lauffenburger</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Systematic analysis of quantitative logic model ensembles predicts drug combination effects on cell signaling networks</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>544</fpage>
        <lpage>553</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preuer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bulusu</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deepsynergy: predicting anti-cancer drug synergy with deep learning</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1538</fpage>
        <lpage>1546</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx806</pub-id>
        <?supplied-pmid 29253077?>
        <pub-id pub-id-type="pmid">29253077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>What is a support vector machine?</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>1565</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1206-1565</pub-id>
        <?supplied-pmid 17160063?>
        <pub-id pub-id-type="pmid">17160063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Chen T, He T, Benesty M, Khotilovich V, Tang Y, Cho H, Chen K, Mitchell R, Cano I, Zhou T et al (2015) Xgboost: extreme gradient boosting. R package version 0.4-2 1(4):1–4</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Dogra</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive review on deep synergistic drug prediction techniques for cancer</article-title>
        <source>Arch Comput Methods Eng</source>
        <year>2022</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>1443</fpage>
        <lpage>1461</lpage>
        <pub-id pub-id-type="doi">10.1007/s11831-021-09617-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>In silico drug combination discovery for personalized cancer therapy</article-title>
        <source>BMC Syst Biol</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>59</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="pmid">29801503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>Timonen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koschmieder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wennerberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mustjoki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Patient-customized drug combination prediction and testing for t-cell prolymphocytic leukemia patients</article-title>
        <source>Can Res</source>
        <year>2018</year>
        <volume>78</volume>
        <issue>9</issue>
        <fpage>2407</fpage>
        <lpage>2418</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-3644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuru</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Tastan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cicek</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Matchmaker: a deep learning framework for drug synergy prediction</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2021</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>2334</fpage>
        <lpage>2344</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3086702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>D-S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Q-S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Q-N</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y-Z</given-names>
          </name>
        </person-group>
        <article-title>Chemopy: freely available python package for computational biology and chemoinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1092</fpage>
        <lpage>1094</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt105</pub-id>
        <?supplied-pmid 23493324?>
        <pub-id pub-id-type="pmid">23493324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>An enhanced cascade-based deep forest model for drug combination prediction</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>562</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosseini</surname>
            <given-names>S-R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Ccsynergy: an integrative deep-learning framework enabling context-aware prediction of anti-cancer drug synergy</article-title>
        <source>Brief Bioinform</source>
        <year>2023</year>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>588</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbac588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1988</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jim Zheng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Anticancer drug synergy prediction in understudied tissues using transfer learning</article-title>
        <source>J Am Med Inform Assoc</source>
        <year>2021</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocaa212</pub-id>
        <?supplied-pmid 33040150?>
        <pub-id pub-id-type="pmid">33040150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Review of unsupervised pretraining strategies for molecules representation</article-title>
        <source>Brief Funct Genomics</source>
        <year>2021</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>323</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elab036</pub-id>
        <?supplied-pmid 34342611?>
        <pub-id pub-id-type="pmid">34342611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Deepdds: deep graph neural network with attention mechanism to predict synergistic drug combinations</article-title>
        <source>Brief Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>390</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbab390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Multi-way relation-enhanced hypergraph representation learning for anti-cancer drug synergy prediction</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>20</issue>
        <fpage>4782</fpage>
        <lpage>4789</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac579</pub-id>
        <?supplied-pmid 36000898?>
        <pub-id pub-id-type="pmid">36000898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Neil</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Feldman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chenard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kral</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lejnine</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Loboda</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An unbiased oncology compound screen to identify novel combination strategies</article-title>
        <source>Mol Cancer Ther</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1158/1535-7163.MCT-15-0843</pub-id>
        <?supplied-pmid 26983881?>
        <pub-id pub-id-type="pmid">26983881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holbeck</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Camalier</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Crowell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Govindharajulu</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Hollingshead</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Polley</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rubinstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilsker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The national cancer institute almanac: a comprehensive screening resource for the detection of anticancer drug pairs with enhanced therapeutic activity</article-title>
        <source>Can Res</source>
        <year>2017</year>
        <volume>77</volume>
        <issue>13</issue>
        <fpage>3564</fpage>
        <lpage>3576</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-0489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loewe</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The problem of synergism and antagonism of combined drugs</article-title>
        <source>Arzneimittelforschung</source>
        <year>1953</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>285</fpage>
        <lpage>290</lpage>
        <?supplied-pmid 13081480?>
        <pub-id pub-id-type="pmid">13081480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Bliss CI, The toxicity of poisons applied jointly. Ann Appl Biol 26(3):585–615. 10.1111/j.1744-7348.1939.tb06990.x</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gindulyte</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pubchem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>1102</fpage>
        <lpage>1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landrum</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rdkit: a software suite for cheminformatics, computational chemistry, and predictive modeling</article-title>
        <source>Greg Landrum</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iorio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Vis</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Menden</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aben</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gonçalves</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Barthorpe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A landscape of pharmacogenomic interactions in cancer</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>3</issue>
        <fpage>740</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.06.017</pub-id>
        <?supplied-pmid 27397505?>
        <pub-id pub-id-type="pmid">27397505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greninger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>IR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of drug sensitivity in cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>955</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Systematic quality control analysis of lincs data</article-title>
        <source>CPT</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>588</fpage>
        <lpage>598</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilakantan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bauman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Venkataraghavan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Topological torsion: a new molecular descriptor for SAR applications. Comparison with other descriptors</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1987</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>82</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00054a008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capecchi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>One molecular fingerprint to rule them all: drugs, biomolecules, and the metabolome</article-title>
        <source>J Cheminf</source>
        <year>2020</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00445-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durant</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leland</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Nourse</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Reoptimization of mdl keys for use in drug discovery</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2002</year>
        <volume>42</volume>
        <issue>6</issue>
        <fpage>1273</fpage>
        <lpage>1280</lpage>
        <pub-id pub-id-type="doi">10.1021/ci010132r</pub-id>
        <?supplied-pmid 12444722?>
        <pub-id pub-id-type="pmid">12444722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Hendrycks D, Gimpel K (2016) Gaussian error linear units (gelus). arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1606.08415">arXiv:1606.08415</ext-link></mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolstikhin</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Houlsby</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Unterthiner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Keysers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Uszkoreit</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mlp-mixer: an all-mlp architecture for vision</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2021</year>
        <volume>34</volume>
        <fpage>24261</fpage>
        <lpage>24272</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>M-M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Vision permutator: a permutable MLP-like architecture for visual recognition</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2022</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>1328</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2022.3145427</pub-id>
        <?supplied-pmid 35077359?>
        <pub-id pub-id-type="pmid">35077359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ramachandran P, Zoph B, Le QV (2017) Searching for activation functions. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1710.05941">arXiv:1710.05941</ext-link></mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Ba JL, Kiros JR, Hinton GE (2016) Layer normalization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1607.06450">arXiv:1607.06450</ext-link></mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Dtf: deep tensor factorization for predicting anticancer drug synergy</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>4483</fpage>
        <lpage>4489</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa287</pub-id>
        <?supplied-pmid 32369563?>
        <pub-id pub-id-type="pmid">32369563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Julkunen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cichonska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gautam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Szedmak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Douat</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pahikkala</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Leveraging multi-way interactions for systematic prediction of pre-clinical drug combination effects</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>6136</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19950-z</pub-id>
        <?supplied-pmid 33262326?>
        <pub-id pub-id-type="pmid">33262326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Celebi R, Bear Don’t Walk O, Movva R, Alpsoy S, Dumontier M (2019) In-silico prediction of synergistic anti-cancer drug combinations using multi-omics data. Sci Rep 9(1), 1–10</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Korkut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Ingraham</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cellbox: interpretable machine learning for perturbation biology with application to the design of cancer combination therapy</article-title>
        <source>Cell Syst</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>128</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.11.013</pub-id>
        <?supplied-pmid 33373583?>
        <pub-id pub-id-type="pmid">33373583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gunasekaran</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cosmic: exploring the world’s knowledge of somatic mutations in human cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>805</fpage>
        <lpage>811</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thibault</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jean-Claude</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Dasatinib+ gefitinib, a non platinum-based combination with enhanced growth inhibitory, anti-migratory and anti-invasive potency against human ovarian cancer cells</article-title>
        <source>Journal of ovarian research</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13048-017-0319-2</pub-id>
        <pub-id pub-id-type="pmid">28086946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolfi</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Jäger</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Haffty</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Hirshfield</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Fulvestrant treatment alters mdm2 protein turnover and sensitivity of human breast carcinoma cells to chemotherapeutic drugs</article-title>
        <source>Cancer Lett</source>
        <year>2014</year>
        <volume>350</volume>
        <issue>1–2</issue>
        <fpage>52</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2014.04.009</pub-id>
        <?supplied-pmid 24747123?>
        <pub-id pub-id-type="pmid">24747123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Shen Z, Liu J, He Y, Zhang X, Xu R, Yu H, Cui P (2021) Towards out-of-distribution generalization: a survey. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2108.13624">arXiv:2108.13624</ext-link></mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Learning substructure invariance for out-of-distribution molecular representations</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2022</year>
        <volume>35</volume>
        <fpage>12964</fpage>
        <lpage>12978</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Comparing structural fingerprints using a literature-based similarity benchmark</article-title>
        <source>J Cheminf</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0148-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>A complete graph-based approach with multi-task learning for predicting synergistic drug combinations</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <issue>6</issue>
        <fpage>351</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btad351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MGAE-DC: Predicting the synergistic effects of drug combinations through multi-channel graph autoencoders</article-title>
        <source>PLoS Comput Biol</source>
        <year>2023</year>
        <volume>19</volume>
        <issue>3</issue>
        <fpage>1010951</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preto</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Matos-Filipe</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mourão</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>IS</given-names>
          </name>
        </person-group>
        <article-title>Synpred: prediction of drug combination effects in cancer using different synergy metrics and ensemble learning</article-title>
        <source>GigaScience</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>087</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giac087</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
