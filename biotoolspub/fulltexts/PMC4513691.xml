<?properties open_access?>
<?subarticle report9558?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4513691</article-id>
    <article-id pub-id-type="pmid">26236465</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.6157.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ViennaNGS: A toolbox for building efficient next- generation sequencing analysis pipelines</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>v2; ref status: indexed</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wolfinger</surname>
          <given-names>Michael T.</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fallmann</surname>
          <given-names>Jörg</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eggenhofer</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amman</surname>
          <given-names>Fabian</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <aff id="a1"><label>1</label>Institute for Theoretical Chemistry, University of Vienna, Währingerstraße 17, A-1090, Vienna, Austria</aff>
      <aff id="a2"><label>2</label>Center for Integrative Bioinformatics Vienna, Max F. Perutz Laboratories, University of Vienna, Medical University of Vienna, Dr. Bohr-Gasse 9, A-1030 Vienna, Austria</aff>
      <aff id="a3"><label>3</label>Department of Biochemistry and Molecular Cell Biology, Max F. Perutz Laboratories, University of Vienna, Dr. Bohr-Gasse 9, A-1030 Vienna, Austria</aff>
      <aff id="a4"><label>4</label>Department of Chromosome Biology, Max F. Perutz Laboratories, University of Vienna, Medical University of Vienna, Dr. Bohr-Gasse 9, A-1030 Vienna, Austria</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:michael.wolfinger@univie.ac.at">michael.wolfinger@univie.ac.at</email>
      </corresp>
      <fn fn-type="con">
        <p>MTW, JF, FE, FA designed and implemented the software. MTW and FA wrote the manuscript. All authors approved the final manuscript.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>50</elocation-id>
    <history>
      <date date-type="accepted">
        <day>10</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2015 Wolfinger MT et al.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
      <license license-type="open-access" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
        <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-4-7298.pdf"/>
    <abstract>
      <p>Recent achievements in next-generation sequencing (NGS) technologies lead to a high demand for reuseable software components to easily compile customized analysis workflows for big genomics data. We present ViennaNGS, an integrated collection of Perl modules focused on building efficient pipelines for NGS data processing. It comes with functionality for extracting and converting features from common NGS file formats, computation and evaluation of read mapping statistics, as well as normalization of RNA abundance. Moreover, ViennaNGS provides software components for identification and characterization of splice junctions from RNA-seq data, parsing and condensing sequence motif data, automated construction of Assembly and Track Hubs for the UCSC genome browser, as well as wrapper routines for a set of commonly used NGS command line tools.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Perl</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>read mapping</kwd>
      <kwd>pipelines</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>This work was funded by the Austrian Science Fund (FWF projects F43 to MTW, FA and FE) and the Research Platform “Decoding mRNA decay in inflammation” by the University of Vienna to JF.</funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec>
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>We have addressed the reviewers' suggestions and updated the manuscript accordingly at different places. Specifically, we have worked out what is unique about the ViennaNGS suite in the Introduction and added a new Applications section where we put emphasis on the process of building custom NGS analysis pipelines by means of the ViennaNGS tutorials. Moreover, we have benchmarked CPU and memory consumption of our package, providing results in Table 1 and added a paragraph on the internal testing strategy. In addition, we highlight past and future use cases and development plans of the software and mention possible parallelization scenarios in the Discussion.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Next-generation sequencing (NGS) technologies have influenced both our understanding of genomic landscapes as well as our attitude towards handling big biological data. Emerging functional genomics methods based on high-throughput sequencing allow investigation of highly specialized and complex scientific questions, which continuously poses challenges in the design of analysis strategies. Moreover, the demand for efficient data analysis methods has dramatically increased. While a typical NGS analysis workflow is built on a cascade of routine tasks, individual steps are often specific for a certain assay, e.g. depend on a particular sequencing protocol.</p>
    <p>Here, we present
<monospace>ViennaNGS</monospace>, a Perl distribution that integrates high-level routines and wrapper functions for common NGS processing tasks.
<monospace>ViennaNGS</monospace> provides tools and functionality for the development of custom NGS pipelines, rather than being an established pipeline per se. It comes with a set of utility scripts that serve as reference implementation for most library functions and can readily be applied for specific tasks or integrated as-is into tailor-made pipelines. Moreover, we provide extensive documentation, including a dedicated tutorial that showcases core features of the software and discusses common application scenarios.</p>
    <p>A set of NGS analysis pipelines are available for general
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-2" ref-type="bibr">2</xref></sup>, and specialized assays such as de-novo motif discovery
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>. While these tools mostly cover the elementary steps of an analysis workflow, they often represent custom-tailored solutions that lack flexibility. Web-based approaches like
<italic>Galaxy</italic>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> cover a wide portfolio of available applications, however they do not offer enough room for power users who are used to the benefits of the command line.</p>
    <p>The recently published
<italic>HTSeq</italic> framework
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> as well as the
<ext-link ext-link-type="uri" xlink:href="https://code.google.com/p/biotoolbox"><italic>biotoolbox</italic></ext-link> package provide library modules for processing high-throughput data. While both packages implement NGS analysis functionality in a coherent manner, we encountered use cases that were not covered by these tools.</p>
    <p><monospace>ViennaNGS</monospace> is a pure Perl-based alternative to existing approaches, addressing the broad Perl community in bioinformatics. It partly builds on
<italic>BioPerl</italic>
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> and has been designed in an object-oriented manner based on the
<ext-link ext-link-type="uri" xlink:href="https://metacpan.org/pod/Moose"><italic>Moose</italic></ext-link> object framework, thus allowing to write modular code with different libraries that engage with one another. Moose is based in large part on the Perl 6 object system, thererby enabling rapid conversion to Perl 6. While there is ongoing discussion in the BioPerl community regarding possible directions towards a shift to
<ext-link ext-link-type="uri" xlink:href="http://bioperl.org/wiki/BioMoose">Perl 6</ext-link>,
<monospace>ViennaNGS</monospace> is, to our knowledge, the first toolbox for NGS data processing that can be regarded ready for Perl 6.</p>
  </sec>
  <sec>
    <title>Motivation</title>
    <p>The motivation for this contribution emerged in the course of the research consortium “RNA regulation of the transcriptome” (Austrian Science Fund project F43), which brings together more than a dozen experimental groups with various thematic backgrounds. In the line of this project it turned out that complex tasks in NGS analysis could easily be automated, whereas linking individual steps was very labour-intensive. As such, it became apparent that there is a strong need for modular and reusable software components that can efficiently be assembled into different full-fledged NGS analysis pipelines. Development of the
<monospace>ViennaNGS</monospace> suite was triggered by two driving forces. On the one hand we wanted to return to the open source community our own contribution, which itself is heavily based and dependent on open source software. On the other hand, beside “open science” we advocate for the concept of “reproducible science”
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>. Unfortunately, and to some extent surprising, bioinformatics analyses are often not fully reproducible due to inaccessibility of tools (keyword “in-house script”) or software versions used. It is therefore essential to ensure the entire chain of reproducibility from data generation to interpretation in the analysis of biological data.</p>
  </sec>
  <sec>
    <title>Applications</title>
    <p><monospace>ViennaNGS</monospace> has been designed to facilitate the process of builing NGS pipelines. To this end, the toolbox comes with several modules and library functions that can easily be combined into custom analysis workflows. We provide step by guides in the form of dedicated tutorials to lead prospective users through the development of basic NGS analysis pipelines.</p>
    <sec>
      <title>Building a pipeline with
<monospace>ViennaNGS</monospace>
</title>
      <p><monospace>ViennaNGS::Tutorial</monospace> is a showcase for building custom analysis pipelines and consists of several chapters, each illustrating an example workflow together with a possible solution based on
<monospace>ViennaNGS</monospace> library functions. Tutorial #0 shows how to deduce both qualitative and quantitative parameters from mapped reads, together with visual data representation. Tutorial #1 exemplifies the detection of sequence motifs in close proximity to gene start loci in order to identify regulatory regions. Tutorial #2 exemplifies the visualization of highly expressed genes together with a 50 nt region upstream of the gene start and Tutorial #3 explains how to construct UCSC genome browser Assembly Hubs. The tutorials are meant to assist prospective users applying
<monospace>ViennaNGS</monospace> to implement their own full-fledged pipelines. Moreover, we used the tutorials to demonstrate the run time and memory requirement of sample implementations of
<monospace>ViennaNGS</monospace> in a real world scenario (
<xref ref-type="table" rid="T1">Table 1</xref>).</p>
      <table-wrap id="T1" orientation="portrait" position="anchor">
        <label>Table 1. </label>
        <caption>
          <title>Time and memory requirements of exemplary implementations of the
<monospace>ViennaNGS</monospace> core modules, as implemented in the
<monospace>ViennaNGS</monospace> tutorials.</title>
          <p>Data were collected on a single core of a desktop workstation (Intel
<sup>®</sup> Core™ i7-4771 CPU @ 3.50GHz; 32GB RAM).</p>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Script</th>
              <th align="left" rowspan="1" colspan="1">Input</th>
              <th align="left" rowspan="1" colspan="1">Run time</th>
              <th align="left" rowspan="1" colspan="1">RAM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Tutorial #0</td>
              <td rowspan="1" colspan="1">4GB BAM file</td>
              <td rowspan="1" colspan="1">50m 30s</td>
              <td rowspan="1" colspan="1">5.1 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Tutorial #1</td>
              <td rowspan="1" colspan="1">28GB Fasta, 16KB BED, 292KB XML</td>
              <td rowspan="1" colspan="1">0m 38s</td>
              <td rowspan="1" colspan="1">219 MB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Tutorial #2</td>
              <td rowspan="1" colspan="1">4GB BAM, 28GB Fasta, 16KB BED</td>
              <td rowspan="1" colspan="1">7m 49s</td>
              <td rowspan="1" colspan="1">663 MB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Tutorial #3</td>
              <td rowspan="1" colspan="1">5MB BigBed, 4MB BigWig, 4MB BigBed, 3MB BigWig</td>
              <td rowspan="1" colspan="1">0m 1s</td>
              <td rowspan="1" colspan="1">213MB</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Utilities</title>
      <p>The
<monospace>ViennaNGS</monospace> suite comes with a collection of complementary executable Perl scripts for accomplishing routine tasks often required in NGS data processing. These command line utilities serve as reference implementations of the routines implemented in the library and can readily be used for atomic tasks in NGS data processing.
<xref ref-type="table" rid="T2">Table 2</xref> lists the utilities and gives a short description of their functionality.</p>
      <table-wrap id="T2" orientation="portrait" position="anchor">
        <label>Table 2. </label>
        <caption>
          <title>Overview of the complementary utilities shipped with
<monospace>ViennaNGS</monospace>.</title>
          <p>While some of these scripts are re-implementations of functionality available elsewhere, they have been developed primarily as reference implementation of the library routines to help prospective
<monospace>ViennaNGS</monospace> users getting started quickly with the development of custom pipelines.</p>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Utility</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>assembly_hub_constructor.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Construct Assembly Hubs for UCSC genome browser visualization</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>bam_quality_stat.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Compute mapping/quality statistics along with publication-ready figures</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>bam_split.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Split BAM files by strand</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>bam_to_bigwig.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Produce BigWig coverage profiles from BAM files for visualization</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>bam_uniq.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Filter uniquely and multi mapped reads from BAM files</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>bed2bedGraph.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Convert BED to (strand specific) BedGraph format</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>extend_bed.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Extend genomic intervals in BED format at the 5′, 3′, or both ends</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>gff2bed.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Convert bacterial RefSeq GFF3 annotation to BED12 format</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>kmer_analysis.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Count k-mers of predefined length in FastQ and Fasta files</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>MEME_xml_motif_extractor.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Compute basic statistics from MEME XML output</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>newUCSCdb.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Create a new genome database in a local UCSC genome browser
<break/>instance</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>normalize_multicov.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Compute normalized expression data in RPKM and TPM from read
<break/>counts</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>sj_visualizer.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Convert splice junctions in segemehl BED6 splice junction format to
<break/>BED12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>splice_site_summary.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Identify and characterize splice junctions from RNA-seq data</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>track_hub_constructor.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Construct Track Hubs for UCSC genome browser visualization</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>trim_fastq.pl</monospace>
              </td>
              <td rowspan="1" colspan="1">Trim sequence and quality fields in FastQ format</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>The major design consideration for the
<monospace>ViennaNGS</monospace> toolbox was to make available modular and reuseable code for NGS processing in a popular scripting language. We therefore implemented thematically related functionality in different Perl modules under the
<monospace>Bio</monospace> namespace (
<xref ref-type="fig" rid="f1">Figure 1</xref>).</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="float">
      <label>Figure 1. </label>
      <caption>
        <title>Schematic overview of
<monospace>ViennaNGS</monospace> components.</title>
        <p>Core modules can be combined within a data analysis script in a flexible manner to meet individual analysis objectives and experimental setup.</p>
      </caption>
      <graphic xlink:href="f1000research-4-7298-g0000"/>
    </fig>
    <p>Our focus is on consistent versioning, facilitated through Github hosting. In addition,
<monospace>ViennaNGS</monospace> releases are available via the Comprehensive Perl Architecture Network (CPAN), thereby enabling users to get back to previous versions at any time in order to reenact conclusions drawn from shared biological data.</p>
    <p><monospace>ViennaNGS</monospace> has been designed to close gaps in established analysis workflows by covering a wide range of processing steps from raw data to data visualization. In the following we introduce individual
<monospace>ViennaNGS</monospace> components and describe their main functionality.</p>
    <sec>
      <title>BAM handling and filtering</title>
      <p>Once mapped to a reference genome, NGS data is typically stored in the widely used SAM/BAM file format. BAM is a binary format, which can easily be converted into text-based SAM format via
<italic>samtools</italic>
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> for downstream analysis. However, modern NGS assays produce hundreds of millions of reads per sample, hence SAM files tend to become excessively large and can have a size of several hundred gigabytes. Given that storage resources are always limited, strategies to efficiently retrieve mapping information from BAM format are an asset. To accomodate that, we provide functionality for querying global mapping statistics and extracting specific alignment information from BAM files directly.</p>
      <p><monospace>ViennaNGS::BamStat</monospace> extracts both qualitative and quantitative information from BAM files, i.e. the amount of total alignments, aligned reads, as well as uniquely and multi mapped reads. Numbers are reported individually for single-end reads, paired-end fragments and pairs missing a mate. Quality-wise
<monospace>ViennaNGS::BamStat</monospace> collects data on edit distance in the alignments, fraction of clipped bases, fraction of matched bases, and quality scores for entire alignments. Subsequently,
<monospace>ViennaNGS::BamStatSummary</monospace> compares different samples in BAM format and illustrates results graphically. Summary information is made available in CSV format to facilitate downstream processing.</p>
      <p>Efficient filtering of BAM files is among the most common tasks in NGS analysis pipelines. Building on the
<ext-link ext-link-type="uri" xlink:href="https://metacpan.org/release/Bio-SamTools">Bio-SamTools</ext-link> distribution,
<monospace>ViennaNGS::Bam</monospace> provides a set of convenience routines for rapid handling of BAM files, including filters for unique and multiple alignments as well as functionality for splitting BAM files by strand, thereby creating two strand-specific BAM files. Results can optionally be converted to BedGraph or BigWig formats for visualization purposes.</p>
    </sec>
    <sec>
      <title>Genomic annotation</title>
      <p>Proper handling of genomic intervals is essential for NGS analysis pipelines. Several feature annotation formats have gained acceptance in the scientific community, including BED, GTF, GFF, etc., each having its particular benefits and drawbacks. While annotation for a certain organism is often only available in a specific format, interconversion among these formats can be regarded a routine task, and a pipeline should be capable of processing as many formats as possible.</p>
      <p>We address this issue at different levels. On the one hand, we provide
<monospace>ViennaNGS::AnnoC</monospace>, a lightweight annotation converter for non-spliced genomic intervals, which can be regarded a simple yet powerful solution for conversion of bacterial annotation data. On the other hand we have developed an abstract representation of genomic features via generic
<italic>Moose</italic>-based classes, which provide functionality for efficient manipulation of BED4, BED6, BED12 and GTF/GFF elements, respectively, and allow for BED format conversion facilitated by
<monospace>ViennaNGS::Bed</monospace>.
<monospace>ViennaNGS::MinimalFeature</monospace> represents an elementary genomic interval, characterized by chromosome, start, end and strand.
<monospace>ViennaNGS::Feature</monospace> extends
<monospace>ViennaNGS::MinimalFeature</monospace> by two attributes, name and score, thereby creating a representation of a single BED6 element.
<monospace>ViennaNGS::FeatureChain</monospace> pools a set of
<monospace>ViennaNGS::Feature</monospace> objects via an array reference. All intervals of interest can be covered by a
<monospace>ViennaNGS::FeatureLine</monospace> object, which holds a hash of references to
<monospace>ViennaNGS::FeatureChain</monospace> objects (
<xref ref-type="fig" rid="f2">Figure 2</xref>).</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="float">
        <label>Figure 2. </label>
        <caption>
          <title>Class diagram illustrating the relations among generic Moose classes which are used as abstract representations of genomic intervals (only attributes are shown).</title>
        </caption>
        <graphic xlink:href="f1000research-4-7298-g0001"/>
      </fig>
      <p>This framework can handle annotation data by providing abstract data representations of genomic intervals such as exons, introns, splice junctions etc. It allows for efficient description and manipulation of genomic features up to the level of transcripts (
<xref ref-type="fig" rid="f3">Figure 3</xref>). Conversely, it is highly generic and can be extended to hierarchically higher levels such as genes composed of different transcript isoforms or clusters of paralogous genes.</p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="float">
        <label>Figure 3. </label>
        <caption>
          <title>Schematic representation of genomic interval classes in terms of their corresponding feature annotation.</title>
          <p>Simple intervals (“features”) are characterized by
<monospace>ViennaNGS::Feature</monospace> objects (bottom box). At the next level,
<monospace>ViennaNGS::FeatureChain</monospace> bundles these, thereby maintaining individual annotation chains for e.g. UTRs, exons, introns, splice junctions, etc. (middle box). The topmost level is given by
<monospace>ViennaNGS::FeatureLine</monospace> objects, representing individual transcripts.</p>
        </caption>
        <graphic xlink:href="f1000research-4-7298-g0002"/>
      </fig>
    </sec>
    <sec>
      <title>Visualization</title>
      <p>Another cornerstone of NGS analysis pipelines is graphical representation of mapped sequencing data. In this context a standard application is visualization of ChIPseq peaks or RNA-seq coverage profiles. The latter are typically encoded in Wiggle format, or its indexed binary variant, BigWig, which can readily be displayed within a genome browser. In the same line, genomic annotation and intervals are often made available in BigBed format, an indexed binary version of BED.
<monospace>ViennaNGS::Util</monospace> comes with wrapper routines for automated conversion from common formats like BAM to BigWig or BED to BigBed via third-party utilities
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>. In addition, we have implemented interfaces for a selection of
<italic>BEDtools</italic>
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> components as well as a collection of auxiliary routines. The UCSC genome browser allows to display potentially large genomic data sets, that are hosted at web-accessible locations by means of Track Hubs
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>. On a more general basis this even works for custom organisms that are not supported by default through the UCSC genome browser, via Assembly Hubs. A typical use case is visualization of genomic annotation, RNA-seq coverage profiles and ChIPseq peaks for
<italic>Arabidopsis thaliana</italic> (which is not available through the generic UCSC browser) via a locally hosted Assembly Hub.
<monospace>ViennaNGS::UCSC</monospace> provides all relevant routines for automatic construction of Assembly and Track Hubs from genomic sequence and/or annotation. Besides automated Assembly and Track Hub generation, we support deployment of custom organism databases in local mirrors of the UCSC genome browser.</p>
    </sec>
    <sec>
      <title>Gene expression and normalization</title>
      <p>RNA-seq has become a standard approach for gene and transcript quantification by means of measuring the relative amount of RNA present in a certain sample or under a specific condition, thus ideally providing a good estimate for the relative molar concentration of RNA species. Simple “count-based” quantification models assume that the total number of reads mapping to a region can be used as a proxy for RNA abundance
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>. A good measure for transcript abundance is ideally as closely proportional to the relative molar concentration of a RNA species as possible. Various measures have been proposed, one of the most prominent being RPKM (reads per kilobase per million). It accounts for different transcript lengths and sequencing depth by normalizing by the number of reads in a specific sample, divided by 10
<sup>6</sup>. It has, however, been shown that RPKM is not appropriate for measuring the relative molar concentration of a RNA species due to normalization by the total number of reads
<sup><xref rid="ref-13" ref-type="bibr">13</xref>,
<xref rid="ref-14" ref-type="bibr">14</xref></sup>.</p>
      <p>Alternative measures that overcome this shortcoming have been suggested, e.g. TPM (transcript per million), where a proxy for the total number of transcript samples considering the sequencing reads per gene is used for normalization, rather than the total number of mapped reads. We provide routines for the computation of RPKM and TPM values for genomic intervals from raw read counts within
<monospace>ViennaNGS::Expression</monospace>.</p>
    </sec>
    <sec>
      <title>Characterization of splice junctions</title>
      <p><monospace>ViennaNGS::SpliceJunc</monospace> addresses a more specific problem, namely characterization of splice junctions which is becoming increasingly relevant for understanding alternative splicing events. This module provides code for identification and characterization of splice junctions from short read mappers. It can detect novel splice junctions in RNA-seq data and generate visualization files. While we have focused on processing the output of
<italic>segemehl</italic>
<sup><xref rid="ref-15" ref-type="bibr">15</xref>,
<xref rid="ref-16" ref-type="bibr">16</xref></sup>, the module can easily be extended for other splice-aware split read mappers.</p>
    </sec>
    <sec>
      <title>Documentation</title>
      <p>The
<monospace>ViennaNGS</monospace> suite comes with extensive documentation based on Perl’s POD system, thereby providing a single documentation base which is available through different channels, e.g. on the command line via the
<italic>perldoc</italic> utility or on the Web via CPAN.</p>
    </sec>
    <sec>
      <title>Testing</title>
      <p>In the development process of the
<monospace>ViennaNGS</monospace> suite special emphasis has been placed on code integrity, thereby ensuring that the software produces correct results as novel features are added and the code base is maintained. To achieve that, we make use of the Perl testing framework, which allows to build automated tests that are run at installation time and highlight any issues with code or third party dependencies. Furthermore this includes comparison of MD5 sums for output files produced by
<monospace>ViennaNGS</monospace> routines, thereby enabling consistency and reproducibility of biological results.</p>
    </sec>
  </sec>
  <sec>
    <title>Use cases</title>
    <p>We have successfully applied components of
<monospace>ViennaNGS</monospace> in the course of an ongoing, large scale collaboration project focusing on RNA regulation. It has been used with different genomics assays in a wide range of biological systems, including human, plants and bacteria. While we have primarily applied
<monospace>ViennaNGS</monospace> in combination with the short read aligner
<italic>segemehl</italic>
<sup><xref rid="ref-15" ref-type="bibr">15</xref>,
<xref rid="ref-16" ref-type="bibr">16</xref></sup>, e.g. in a study addressing ribosome associated mRNA degradation in
<italic>Drosophila</italic>
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup>, it has also been used recently with
<italic>Tophat</italic>
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup> output in a large scale transcriptome study of Ebola and Marburg virus infection in human and bat cells (Hölzer
<italic>et al.</italic>, unpublished data).</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p><monospace>ViennaNGS</monospace> is a comprehensive software library for rapid development of custom NGS analysis pipelines. An aspect that is becoming increasingly relevant in scientific computation is parallelization. While we have focused on code convenience, feature richness and easy extensibility, custom
<monospace>ViennaNGS</monospace>-based pipelines can potentially be implemented in a parallel manner by the end user, e.g. through the Perl threads functionality. An example would be to process and filter a set of BAM files in parallel, provided sufficient IO resources are available.</p>
    <p><monospace>ViennaNGS</monospace> is actively developed and its code base is constantly maintained and expanded. We will provide a generic, Moose based annotation converter that builds on and extends the feature annotation classes in the future. In addition, we will incorporate functionality for manipulation and storage of sequence variants, such as SNPs, editing and modification events.
<monospace>ViennaNGS</monospace> will also be used for automated UCSC genome browser integration in an upcoming version of TSSAR
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>, a recently published approach for characterization of transcription start sites from dRNA-seq data. Moreover, we will provide
<monospace>Bio::HubFactory</monospace>, a
<monospace>ViennaNGS</monospace>-based Web Service for automatic generation of UCSC genome browser Assembly Hubs for all
<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/refseq">RefSeq</ext-link> bacteria.</p>
    <p><monospace>ViennaNGS</monospace> is an open platform for building specialized NGS pipelines, which fills a niche by providing functionality that is, to our knowledge, not available elsewhere. In this line, we would like to encourage the scientific community to contribute novel features and patches via Github.</p>
  </sec>
  <sec>
    <title>Data availability</title>
    <p>Input data for the
<monospace>ViennaNGS</monospace> tutorial is available from
<ext-link ext-link-type="uri" xlink:href="http://rna.tbi.univie.ac.at/ViennaNGS">http://rna.tbi.univie.ac.at/ViennaNGS</ext-link>.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>The
<monospace>ViennaNGS</monospace> distribution is available through the Comprehensive Perl Architecture Network (CPAN) and at GitHub.
<list list-type="simple"><list-item><label>1. </label><p><ext-link ext-link-type="uri" xlink:href="http://search.cpan.org/dist/Bio-ViennaNGS">http://search.cpan.org/dist/Bio-ViennaNGS</ext-link></p></list-item><list-item><label>2. </label><p><ext-link ext-link-type="uri" xlink:href="https://github.com/mtw/Bio-ViennaNGS">https://github.com/mtw/Bio-ViennaNGS</ext-link></p></list-item><list-item><label>3. </label><p>Software license: The Perl 5 License</p></list-item></list>
</p>
  </sec>
  <sec>
    <title>Third party dependencies</title>
    <p>The
<monospace>ViennaNGS</monospace> toolbox depends on a set of third-party tools and libraries which are required for specific filtering and file format conversion tasks as well as for building internally used Perl modules:
<list list-type="bullet"><list-item><p><ext-link ext-link-type="uri" xlink:href="https://github.com/arq5x/bedtools2">BEDtools &gt;= 2.17</ext-link><sup><xref rid="ref-10" ref-type="bibr">10</xref></sup></p></list-item><list-item><p><ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/admin/exe/">bedGraphToBigWig, fetchChromSizes and faToTwoBit from the UCSC Genome Browser applications</ext-link><sup><xref rid="ref-9" ref-type="bibr">9</xref></sup></p></list-item><list-item><p>the
<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">R Statistics software</ext-link>
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>
</p></list-item><list-item><p>samtools &lt;= v0.1.19
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup> for building
<ext-link ext-link-type="uri" xlink:href="http://search.cpan.org/lds/Bio-SamTools/lib/Bio/DB/Sam.pm">Bio::DB::Sam</ext-link>. Please note that more recent HTSlib-based versions of samtools will not work with Bio::DB::Sam</p></list-item></list>
</p>
  </sec>
</body>
<back>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Förstner</surname><given-names>KU</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name><name><surname>Sharma</surname><given-names>CM</given-names></name></person-group>:
<article-title>READemption-a tool for the computational analysis of deep-sequencing-based transcriptome data.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>23</issue>):<fpage>3421</fpage>–<lpage>3</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu533</pub-id><?supplied-pmid 25123900?><pub-id pub-id-type="pmid">25123900</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breese</surname><given-names>MR</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name></person-group>:
<article-title>NGSUtils: a software suite for analyzing and manipulating next-generation sequencing datasets.</article-title><source><italic>Bioinformatics.</italic></source><year>2013</year>;<volume>29</volume>(<issue>4</issue>):<fpage>494</fpage>–<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts731</pub-id><!--<pub-id pub-id-type="pmcid">3570212</pub-id>--><?supplied-pmid 23314324?><pub-id pub-id-type="pmid">23314324</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinz</surname><given-names>S</given-names></name><name><surname>Benner</surname><given-names>C</given-names></name><name><surname>Spann</surname><given-names>N</given-names></name><etal/></person-group>:
<article-title>Simple combinations of lineage-determining transcription factors prime
<italic>cis</italic>-regulatory elements required for macrophage and B cell identities.</article-title><source><italic>Mol Cell.</italic></source><year>2010</year>;<volume>38</volume>(<issue>4</issue>):<fpage>576</fpage>–<lpage>89</lpage>.
<pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id><!--<pub-id pub-id-type="pmcid">2898526</pub-id>--><?supplied-pmid 20513432?><pub-id pub-id-type="pmid">20513432</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goecks</surname><given-names>J</given-names></name><name><surname>Nekrutenko</surname><given-names>A</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences.</article-title><source><italic>Genome Biol.</italic></source><year>2010</year>;<volume>11</volume>(<issue>8</issue>):<fpage>R86</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2010-11-8-r86</pub-id><!--<pub-id pub-id-type="pmcid">2945788</pub-id>--><?supplied-pmid 20738864?><pub-id pub-id-type="pmid">20738864</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname> Pyl</surname><given-names>PT</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>HTSeq--a Python framework to work with high-throughput sequencing data.</article-title><source><italic>Bioinformatics.</italic></source><year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>166</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id><!--<pub-id pub-id-type="pmcid">4287950</pub-id>--><?supplied-pmid 25260700?><pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stajich</surname><given-names>JE</given-names></name><name><surname>Block</surname><given-names>D</given-names></name><name><surname>Boulez</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>The Bioperl toolkit: Perl modules for the life sciences.</article-title><source><italic>Genome Res.</italic></source><year>2002</year>;<volume>12</volume>(<issue>10</issue>):<fpage>1611</fpage>–<lpage>8</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.361602</pub-id><!--<pub-id pub-id-type="pmcid">187536</pub-id>--><?supplied-pmid 12368254?><pub-id pub-id-type="pmid">12368254</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stodden</surname><given-names>V</given-names></name><name><surname>Leisch</surname><given-names>F</given-names></name><name><surname>Peng</surname><given-names>RD</given-names></name></person-group>:
<article-title>Implementing Reproducible Research</article-title>. CRC Press,<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://www.crcpress.com/product/isbn/9781466561595">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Sequence Alignment/Map format and SAMtools.</article-title><source><italic>Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><!--<pub-id pub-id-type="pmcid">2723002</pub-id>--><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>WJ</given-names></name><name><surname>Zweig</surname><given-names>AS</given-names></name><name><surname>Barber</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>BigWig and BigBed: enabling browsing of large distributed datasets.</article-title><source><italic>Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>17</issue>):<fpage>2204</fpage>–<lpage>7</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btq351</pub-id><!--<pub-id pub-id-type="pmcid">2922891</pub-id>--><?supplied-pmid 20639541?><pub-id pub-id-type="pmid">20639541</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group>:
<article-title>BEDTools: a flexible suite of utilities for comparing genomic features.</article-title><source><italic>Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>2</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id><!--<pub-id pub-id-type="pmcid">2832824</pub-id>--><?supplied-pmid 20110278?><pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raney</surname><given-names>BJ</given-names></name><name><surname>Dreszer</surname><given-names>TR</given-names></name><name><surname>Barber</surname><given-names>GP</given-names></name><etal/></person-group>:
<article-title>Track data hubs enable visualization of user-defined genome-wide annotations on the UCSC Genome Browser.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>1003</fpage>–<lpage>1005</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt637</pub-id><!--<pub-id pub-id-type="pmcid">3967101</pub-id>--><?supplied-pmid 24227676?><pub-id pub-id-type="pmid">24227676</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachter</surname><given-names>L</given-names></name></person-group>:
<article-title>Models for transcript quantification from RNA-Seq.</article-title><source><italic>arXiv preprint arXiv: 1104.3889.</italic></source><year>2011</year><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1104.3889">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Ruotti</surname><given-names>V</given-names></name><name><surname>Stewart</surname><given-names>RM</given-names></name><etal/></person-group>:
<article-title>RNA-Seq gene expression estimation with read mapping uncertainty.</article-title><source><italic>Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>4</issue>):<fpage>493</fpage>–<lpage>500</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp692</pub-id><!--<pub-id pub-id-type="pmcid">2820677</pub-id>--><?supplied-pmid 20022975?><pub-id pub-id-type="pmid">20022975</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>GP</given-names></name><name><surname>Kin</surname><given-names>K</given-names></name><name><surname>Lynch</surname><given-names>VJ</given-names></name></person-group>:
<article-title>Measurement of mRNA abundance using RNA-seq data: RPKM measure is inconsistent among samples.</article-title><source><italic>Theory Biosci.</italic></source><year>2012</year>;<volume>131</volume>(<issue>4</issue>):<fpage>281</fpage>–<lpage>285</lpage>.
<pub-id pub-id-type="doi">10.1007/s12064-012-0162-3</pub-id><?supplied-pmid 22872506?><pub-id pub-id-type="pmid">22872506</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>S</given-names></name><name><surname>Otto</surname><given-names>C</given-names></name><name><surname>Kurtz</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Fast mapping of short sequences with mismatches, insertions and deletions using index structures.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2009</year>;<volume>5</volume>(<issue>9</issue>):<fpage>e1000502</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1000502</pub-id><!--<pub-id pub-id-type="pmcid">2730575</pub-id>--><?supplied-pmid 19750212?><pub-id pub-id-type="pmid">19750212</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>S</given-names></name><name><surname>Otto</surname><given-names>C</given-names></name><name><surname>Doose</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>A multi-split mapping algorithm for circular RNA splicing, trans-splicing, and fusion detection.</article-title><source><italic>Genome Biol.</italic></source><year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R34</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r34</pub-id><!--<pub-id pub-id-type="pmcid">4056463</pub-id>--><?supplied-pmid 24512684?><pub-id pub-id-type="pmid">24512684</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antic</surname><given-names>S</given-names></name><name><surname>Wolfinger</surname><given-names>MT</given-names></name><name><surname>Skucha</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>General and MicroRNA-Mediated mRNA Degradation Occurs on Ribosome Complexes in
<italic>Drosophila</italic> Cells.</article-title><source><italic>Mol Cell Biol.</italic></source><year>2015</year>;<volume>35</volume>(<issue>13</issue>):<fpage>2309</fpage>–<lpage>20</lpage>.
<pub-id pub-id-type="doi">10.1128/MCB.01346-14</pub-id><?supplied-pmid 25918245?><pub-id pub-id-type="pmid">25918245</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>:
<article-title>TopHat: discovering splice junctions with RNA-Seq.</article-title><source><italic>Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>9</issue>):<fpage>1105</fpage>–<lpage>1111</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp120</pub-id><!--<pub-id pub-id-type="pmcid">2672628</pub-id>--><?supplied-pmid 19289445?><pub-id pub-id-type="pmid">19289445</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amman</surname><given-names>F</given-names></name><name><surname>Wolfinger</surname><given-names>MT</given-names></name><name><surname>Lorenz</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>TSSAR: TSS annotation regime for dRNA-seq data.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2014</year>;<volume>15</volume>:<fpage>89</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-15-89</pub-id><!--<pub-id pub-id-type="pmcid">4098767</pub-id>--><?supplied-pmid 24674136?><pub-id pub-id-type="pmid">24674136</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>.
<article-title>R: A Language and Environment for Statistical Computing</article-title>. R Foundation for Statistical Computing, Vienna, Austria,<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://web.mit.edu/r_v3.0.1/fullrefman.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report9558" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.7298.r9558</article-id>
    <title-group>
      <article-title>Referee response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Voß</surname>
          <given-names>Björn</given-names>
        </name>
        <xref ref-type="aff" rid="r9558a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r9558a1"><label>1</label>Faculty of Biology, University of Freiburg, Freiburg, Germany</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <related-article id="d35e1925" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.6157.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have significantly improved their manuscript and satisfactorily replied to my comments, such that I feel happy to approve this version of the manuscript.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report8396" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.6600.r8396</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Voß</surname>
          <given-names>Björn</given-names>
        </name>
        <xref ref-type="aff" rid="r8396a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r8396a1"><label>1</label>Faculty of Biology, University of Freiburg, Freiburg, Germany</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <related-article id="d35e1974" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.6157.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In their manuscript about ViennaNGS the authors describe a set of perl modules and scripts that is useful to build pipelines for NGS data analysis. A key motivation for this is to promote reproducible science, especially with respect to medium-level users, who often create "in-house scripts" for data analysis, which are rarely publicly available. This target community distinguishes ViennaNGS from related approaches, such as Galaxy. The contribution is, thus, relevant and has the potential to serve as a basis for future developments in NGS analysis pipelines. I tested the tutorials and some of the utility scripts and they worked fine. Nevertheless, I think the authors need to clarify some issues and can improve the presentation of their work.</p>
    <p>Major Comments:
<list list-type="bullet"><list-item><p>The authors should point out clearly, what distinguishes ViennaNGS from other suites. In the end, they need to convince people to use ViennaNGS. For that  it would be helpful to clearly state what is hard or even impossible to implement in one of the other systems (galaxy, HTSeq, ...) at best with real world examples.</p></list-item><list-item><p>As stated in the title the aim of ViennaNGS is to ease the process of building NGS analysis pipelines. Unfortunately, exactly this aspect is more or less not mentioned in the main text. It would be interesting to know, especially for the data analysts with scripting experience, how such a pipeline looks like and why it is easier to build using ViennaNGS.</p></list-item><list-item><p>I do not quite understand the explicit discussion of TPM and RPKM. The differences are extensively discussed in
<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22872506">Wagner
<italic>et al. </italic>(2012)</ext-link>, which the authors can refer to.</p></list-item><list-item><p>Similarly, the description of the accompanying utilities in Table 1 is of minor interest. I would suggest to mention them when the corresponding functionality is described in the main text, e.g., assembly_hub_constructor.pl in the paragraph on Visualization. Furthermore, the authors can explain one tool in detail to show how ViennaNGS pipelines are implemented.</p></list-item><list-item><p>BioPerl already provides modules to handle Annotation Features (Bio::SeqFeature), which at first glance seem to provide the same functionality as the ViennaNGS feature annotation classes. Why is there a need for an own class?</p></list-item></list>Minor Comments:
<list list-type="bullet"><list-item><p>An aspect that is becoming more and more important is parallelization. The authors should describe the possibilities of ViennaNGS to be used in cluster or massively parallel environments.</p></list-item><list-item><p>The authors should make clear that for some/many tasks they use external tools, such as bedtools2, samtools and tools offered by the UCSC and that the user has to install them on its own. Of course, this is the same as for galaxy and others.</p></list-item><list-item><p>I was wondering if ViennaNGS or its pipelines may be integrated into Galaxy. In this way the systems would complement and benefit from each other.</p></list-item><list-item><p>At the end of the discussion the authors could provide actual functionalities that they are planning to integrate in the near future. This is interesting for potential users who are missing certain functionalities in the current release. On example is quality control of the raw sequencing data.</p></list-item><list-item><p>P.5, Software availability: "at and" --&gt; "and at"</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article id="report8057" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.6600.r8057</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chapman</surname>
          <given-names>Brad</given-names>
        </name>
        <xref ref-type="aff" rid="r8057a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r8057a1"><label>1</label>Department of Biostatistics, Harvard Public School of Health, Boston, MA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <related-article id="d35e2065" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.6157.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors describe ViennaNGS, a set of Perl modules and scripts to provide RNA-seq analysis and visualization via UCSC integration. The code is nicely written, open source and easy to install via CPAN with cpanminus. Additionally, the documentation is excellent and contains both high level material in the form of blog posts as well as detailed source code descriptions. In reading the paper I found a few areas that would help improve reader's understanding of the toolbox:
<list list-type="bullet"><list-item><p>Please include additional information about what is unique about ViennaNGS in the introduction. Currently it reads generally and is more about pointing about flaws in other software without saying what ViennaNGS provides. The motivation provides much of this text but it seems out of order relative to the introductory material.</p></list-item><list-item><p>Please provide benchmarks on your BAM manipulation tools relative other common tools. I don't think this needs to be extensive, but providing a summary of how they perform on a 100Gb 30x whole human genome sequence would be helpful. For filtering comparisons, I suggest comparing with samtools or sambamba (https://github.com/lomereiter/sambamba). For quality control, comparisons to QualiMap (http://qualimap.bioinfo.cipf.es/) or bamtools (https://github.com/pezmaster31/bamtools) would be helpful.</p></list-item><list-item><p>Similarly, it would be great to have benchamrking on annotation and BED manipulation tools in ViennaNGS. How does the functionality and timing compare with bedtools? You require and use bedtools for visualization, and it would be useful to clarify benefits and tradeoffs to using ViennaNGS versus interfacing directly with bedtools.</p></list-item><list-item><p>How do you handle testing and validation of ViennaNGS tools and pipelines? I saw new tests for UCSC integration coming in during review, which is great. It would be nice to understand the process by which you ensure new development improves (or at least doesn't degrade) the biological results.</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article id="report8365" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.6600.r8365</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Merkel</surname>
          <given-names>Angelika</given-names>
        </name>
        <xref ref-type="aff" rid="r8365a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r8365a1"><label>1</label>Centro Nacional de Análisis Genómico, Parc Científic de Barcelona, Barcelona, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <related-article id="d35e2128" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.6157.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors present a useful and relevant toolbox for the analysis of NGS data. Its modular design allows for flexibility in the analysis, and the utilization of track hubs for easy exchange of data as well as visualization with popular tools. A nice implementation is the ability to adapt genome annotations of various formats.</p>
    <p>Still, I feel the description of the software is rather too general and could be improved.</p>
    <p>Major Comments:</p>
    <p>The article lacks any benchmarking or presentation of an example analysis, making it difficult to put the software's performance in perspective with any of the  other numerous tools already available. Important for NGS data analysis are specifications for the usage of computational resources (RAM, number of CPUs, processing time, space requirements) and how those scale up with the size of the data set (=number and size of data sets) or type of NGS data (genomic, RNAseq, ChIPseq, Bisulfite-Seq) - all of which are not mentioned. Similarly, the authors do not make any statement on the possibility of parallelization or adaption to cluster infrastructures.</p>
    <p>Minor comments:</p>
    <p>Although, truly RPKM has been shown to be inappropriate for measuring the relative molar concentration of a RNA species due to normalization by the total number of reads, it is still widely used. Computing RPMK values as well (optionally) as TPM would allow for comparison with other pipelines.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
