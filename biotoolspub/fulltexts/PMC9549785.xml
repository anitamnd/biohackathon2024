<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9549785</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqac073</article-id>
    <article-id pub-id-type="publisher-id">lqac073</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AntiSplodge: a neural-network-based RNA-profile deconvolution pipeline designed for spatial transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9483-1603</contrib-id>
        <name>
          <surname>Lund</surname>
          <given-names>Jesper B</given-names>
        </name>
        <aff><institution>Digital Health &amp; Machine Learning Research Group, Hasso Plattner Institut for Digital Engineering</institution>, Potsdam, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lindberg</surname>
          <given-names>Eric L</given-names>
        </name>
        <aff><institution>Cardiovascular and Metabolic Sciences, Max Delbrück Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maatz</surname>
          <given-names>Henrike</given-names>
        </name>
        <aff><institution>Cardiovascular and Metabolic Sciences, Max Delbrück Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), Partner Site Berlin</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pottbaecker</surname>
          <given-names>Fabian</given-names>
        </name>
        <aff><institution>Digital Health &amp; Machine Learning Research Group, Hasso Plattner Institut for Digital Engineering</institution>, Potsdam, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hübner</surname>
          <given-names>Norbert</given-names>
        </name>
        <aff><institution>Cardiovascular and Metabolic Sciences, Max Delbrück Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), Partner Site Berlin</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Charite, Universitätsmedizin Berlin</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lippert</surname>
          <given-names>Christoph</given-names>
        </name>
        <!--christoph.Lippert@hpi.de-->
        <aff><institution>Digital Health &amp; Machine Learning Research Group, Hasso Plattner Institut for Digital Engineering</institution>, Potsdam, <country country="DE">Germany</country></aff>
        <aff><institution>Hasso Plattner Institute for Digital Health at Mount Sinai, Icahn School of Medicine at Mount Sinai</institution>, New York, NY, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +49 331 5509 4850; Email: <email>christoph.Lippert@hpi.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-10">
      <day>10</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>4</volume>
    <issue>4</issue>
    <elocation-id>lqac073</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqac073.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>With the current surge of spatial transcriptomics (ST) studies, researchers are exploring the deep interactive cell-play directly in tissues, in situ. However, with the current technologies, measurements consist of mRNA transcript profiles of mixed origin. Recently, applications have been proposed to tackle the deconvolution process, to gain knowledge about which cell types (SC) are found within. This is usually done by incorporating metrics from single-cell (SC) RNA, from similar tissues. Yet, most existing tools are cumbersome, and we found them hard to integrate and properly utilize. Therefore, we present <italic toggle="yes">AntiSplodge</italic>, a simple feed-forward neural-network-based pipeline designed to effective deconvolute ST profiles by utilizing synthetic ST profiles derived from real-life SC datasets. <italic toggle="yes">AntiSplodge</italic> is designed to be easy, fast and intuitive while still being lightweight. To demonstrate <italic toggle="yes">AntiSplodge</italic>, we deconvolute the human heart and verify correctness across time points. We further deconvolute the mouse brain, where spot patterns correctly follow that of the underlying tissue. In particular, for the hippocampus from where the cells originate. Furthermore, <italic toggle="yes">AntiSplodge</italic> demonstrates top of the line performance when compared to current state-of-the-art tools. Software availability: <ext-link xlink:href="https://github.com/HealthML/AntiSplodge/" ext-link-type="uri">https://github.com/HealthML/AntiSplodge/</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Federal Ministry of Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01|S19066</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Recently, technologies capturing the <italic toggle="yes">in-situ</italic> diversities of the transcriptomic landscape have emerged (<xref rid="B1" ref-type="bibr">1–3</xref>). These have spawned a subfield of transcriptomics coined spatial transcriptomics (ST), also known as spatially resolved transcriptomics(<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>). ST allows for localized measurements of RNA content, mapped directly in the interrogated tissues. The most popular and highest throughput ST technologies such as the 10X Visium (<xref rid="B1" ref-type="bibr">1</xref>) and slide-seq (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B6" ref-type="bibr">6</xref>) technologies, relies on spots (probe capture areas), rather than on fluorescent imaging, which still today remains lower throughput (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B7" ref-type="bibr">7</xref>).</p>
    <p>The advantages of these new technologies are manyfold. We can now perform inquires directly in the tissue of interest to gain previously unseen knowledge about what genes are up-regulated within the visible regions interrogated. However, the single-cellular populations remains a mystery in the spot-based approaches and thus does the corresponding cell-cell communication, cell function, and cell states kept within, which accounts for organ functionality, disease development, and pathology. The spot-based ST techniques and their corresponding RNA profiles(<xref rid="B1" ref-type="bibr">1</xref>) are obtained from populations of cells that are mixed, including mixed cell-states, as multiple cells can contribute to the RNA profiles generated.</p>
    <p>With the recent vast improvements within SC transcriptomics (<xref rid="B8" ref-type="bibr">8</xref>), including highly detailed, explored, and phenotyped datasets (<xref rid="B9" ref-type="bibr">9</xref>), multi-modality projects spanning both fields have been enabled (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B11" ref-type="bibr">11</xref>). As a result, researchers have already shown proof of concepts for tackling the deconvolution of the spatial transcriptomics profiles (<xref rid="B12" ref-type="bibr">12–17</xref>), these includes, <italic toggle="yes">SPOTlight</italic> (<xref rid="B14" ref-type="bibr">14</xref>), <italic toggle="yes">Stereoscope</italic> (<xref rid="B12" ref-type="bibr">12</xref>), <italic toggle="yes">Cell2Location</italic> (<xref rid="B17" ref-type="bibr">17</xref>) and <italic toggle="yes">DSTG</italic> (<xref rid="B18" ref-type="bibr">18</xref>).</p>
    <p><italic toggle="yes">SPOTlight</italic> constructs topic profiles based on a selected reference scRNA dataset, in a way such that each cell type has a uniquely assigned topic profile, i.e. each topic profile accounts for a specific cell type’s expression profile. This is done using seeded non-negative matrix factorization (NMF) regression, initialized using cell type marker genes, which can subsequently be used to deconvolute spatial transcriptomics spots using a non-negative least squares (NNLS) method.</p>
    <p><italic toggle="yes">Stereoscope</italic> uses a model-based approach to estimating both the cell type signatures and the relative cell abundance for each spot. This is done by estimating coefficients and rates, which resembles logits for each gene, to measure how much a gene’s expression contributes to a specific cell type proportion based on a scRNA reference dataset. These estimates are found through a training procedure, with assumptions that the data follows a negative binomial distribution. When the logits for all genes are estimated, a profile can be deconvoluted based on these logits by examining the log counts of each gene, where logits are summarized and scaled to form a proportion vector. One major issue with <italic toggle="yes">Stereoscope</italic> is its run-time-complexity, in our comparison it took more than 24 hours to train, others also report long training times, for example, <italic toggle="yes">Cell2Location</italic> reported &gt;14 h for training for <italic toggle="yes">Stereoscope</italic> in their tests.</p>
    <p><italic toggle="yes">Cell2Location</italic> is a Bayesian model, which estimates absolute cell densities for each cell type by decomposing mRNA counts of each gene, i.e. cell type proportions can be estimated by scaling the resulting cell type count profiles to 1. <italic toggle="yes">Cell2Location</italic> comes with several analysis procedures, where the standard procedure for estimating cell types are a statistical method based on Negative Binomial regression, much like the <italic toggle="yes">Stereoscope</italic> method, where logits are estimated for each gene. One issue with <italic toggle="yes">Cell2location</italic> is that it is heavyweight in terms of the number of required dependencies, which can be non-trivial to implement into an existing pipeline.</p>
    <p><italic toggle="yes">DSTG</italic> which is short for Deconvoluting Spatial Transcriptomics data through Graph-based convolutional networks and is a tool implemented in Python using Tensorflow (<xref rid="B19" ref-type="bibr">19</xref>). It relies on constructing a graph based on the input data, where edges are generated in a preprocessing step and passed into the neural network, which is then used to train the convolutional filters of the network. <italic toggle="yes">DSTG</italic> uses single-cell data to construct synthetic ST spot data, and then computes approximate profiles by linking these real spot data in the graph, using a nearest neighbours approach. We had a few issues running <italic toggle="yes">DSTG</italic>, including having to alter the source code of the preprocessing step to exclude genes with no nearest neighbours (and therefore no connection) in the graphs (as our data had these, see the Comparison section), but it was fast once it was running.</p>
    <p>Despite these existing applications, highly accurate and precise deconvolution of spatial transcriptomics spots remains a challenge, and we found that on average these tools produced profiles deviating from the ground truth profiles in the range of 10–25% (see Comparison). Therefore, we deemed it adequate to contribute with <italic toggle="yes">AntiSplodge</italic>, a neural-network-based tool, for fast and accurate deconvolution of spot-based RNA profiles.</p>
    <p>The main strength of <italic toggle="yes">AntiSplodge</italic> comes from its ease of usage, speed, and accuracy. With the annotation of synthetic ST profiles using cell type information originating from real-life SC datasets, we further eliminate the data imbalance that usually exists in biological datasets. Additionally, because of the accompanying temperature sampling method, it is possible to generate millions of profiles in short amounts of time (usually minutes). The sampler captures both extreme and mean cell abundances, and uses the specific cell profiles which allow for learning the biases within each cell type, which further enhances the accuracy of the networks trained.</p>
    <p>The utility of <italic toggle="yes">AntiSplodge</italic> comes from its high speed, a typical analysis is in the range of a few hours, where training usually take between 15 minutes to 90 minutes while requiring no more RAM than a standard laptop. <italic toggle="yes">AntiSplodge</italic> can be run with less than 16GB of RAM needed, and training the model required less than two GB of GPU memory (alternatively, this can be done on the CPU with an expected increase in training time). Only a few libraries outside the standard Python libraries are required, making it easy to integrate into existing environments and pipelines, and the whole pipeline has been wrapped into a python package (<ext-link xlink:href="https://pypi.org/project/antisplodge/" ext-link-type="uri">https://pypi.org/project/antisplodge/</ext-link>). The tool is presented with a comparison to existing state-of-the-art software, and a showcase of the various workflows enabled by the software.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Cell density</title>
      <p>Cell density is the measure of the number of contributing cells in a single RNA profile. In spatial transcriptomics, it is the measure of cells per spot, where each spot has a single RNA profile. As noted by recent publications (<xref rid="B20" ref-type="bibr">20</xref>), the average cell per spot is technology dependant, but also tissue-dependent. It is deemed reasonable that for the 10× genomics’ Visium Spatial Gene Expression, the cell density lies in the range of 1–10, whereas for the more custom technologies such as the Slide-seqV1 (<xref rid="B2" ref-type="bibr">2</xref>), a cell density of 10–40 is oftentimes observed. In the developing human heart study (<xref rid="B20" ref-type="bibr">20</xref>), they observed an average cell density of 20–40 by manual inspection of the tissue images. <italic toggle="yes">AntiSplodge</italic> requires a cell density range to be specified by the user.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Marker genes</title>
      <p>Prior to training the <italic toggle="yes">AntiSplodge</italic> model, it is recommended to reduce the number of genes of the profiles, to a set of genes that are heterogeneous among the cells of the SC dataset. This allows for saving memory, as we need to generate many synthetic profiles (usually in the range of hundreds of thousands to millions), each removed gene essentially saves a lot of memory. Additionally, this increases training speed, as we need to look at fewer genes, and therefore computations will be performed faster, but it also increases the effectiveness of the algorithm, as we only look at non-redundant genes, and thus, converge faster. Overall, the precision penalty of removing redundant genes will have little to no impact on the resulting deconvolutions.</p>
      <sec id="SEC2-2-1">
        <title>Finding marker genes</title>
        <p>In order to find marker genes, we use the following data-driven procedure. We find the intersecting gene set among all STs to be deconvoluted and the SC dataset. Using this new gene set, we find the marker genes by performing logistic regression for each gene, note that, logistic regression is more time consuming than performing <italic toggle="yes">t</italic>-tests, which can also be used. The fact that we are using a large number of genes diminishes the difference between the t-tests and logistic regressions. For smaller sets of marker genes, logistic regression is generally preferred (<xref rid="B21" ref-type="bibr">21</xref>). The marker genes models are computed using Scanpy (<xref rid="B22" ref-type="bibr">22</xref>). This choice of model is recommended by previous work (<xref rid="B23" ref-type="bibr">23</xref>). These tests are carried out on a gene basis by comparing one cell type to the rest of the cell types in the SC dataset.</p>
        <p>By doing so, we get a score for each gene, which we can use to rank our genes for each cell type. We then select the top X genes for each cell type, which might contain duplicates across cell types, we simply use the unique set of these (scanpy ranks genes by <italic toggle="yes">Z</italic>-score). As a safety check, we assess the power of the resulting gene set using a gradient boosting trees model (XGBClassifier from scikit-learn (<xref rid="B24" ref-type="bibr">24</xref>)). To do this, we split the SC into 90% train and 10% test and train the classifier, with the SC profiles as input and their corresponding cell type as the outcome. If the test accuracy is at least 90%, then we deem this gene set a good differentiable gene set for the cell types. If the test accuracy is below 90% we recommend seeking other means to compute the marker genes. Note: We do not need the statistics from these tests, we simply need to know what genes to include when we produce the synthetic ST profiles.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Sampling synthetic ST profiles</title>
      <p>In order to generate synthetic ST profiles, based on a reference SC dataset, we sample scRNA profiles from multiple cell types. To ensure that we extract both the extreme (all cells of one type) and mean (mixed cell types) cell type distributions, we use a multinomial distribution, defined as:<disp-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} f(x_1,...,x_K;p_1,...,p_K) = \frac{\Gamma {(\sum _ix_i+1)}}{\prod _i\Gamma {x_i+1}}\displaystyle \prod ^K_{i=1}{p_i}^{x_i} \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">p</italic><sub><italic toggle="yes">i</italic></sub> denotes the chance of drawing cell type <italic toggle="yes">i</italic>, <italic toggle="yes">K</italic> is the number of classes (in this case cell types), and <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{i=1}^Kp_i=1$\end{document}</tex-math></inline-formula>. Here, <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> is the number of sampled types for cell type <italic toggle="yes">i</italic>. The weights for the multinomial draws (<italic toggle="yes">p</italic>), are further sampled using a temperature function defined as:<disp-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} p_i = ({CD}^{i})^{\left(\frac{temp}{steps}\right)} \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">i</italic> ∈ [0, <italic toggle="yes">K</italic>], and <italic toggle="yes">K</italic> is the number of classes. Here, <italic toggle="yes">temp</italic> ∈ [0, <italic toggle="yes">steps</italic>], and <italic toggle="yes">steps</italic> is the number of temperature steps that are used to sample weights. Each <italic toggle="yes">p</italic> are scaled, so that they in total sum to 1 by diving <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{i=1}^K p_i$\end{document}</tex-math></inline-formula>. Intuitively, the temperature function starts with equal weights (all equal to 1), and scales to weights that have <italic toggle="yes">pow</italic> times higher for each increasing <italic toggle="yes">i</italic>. This allows us to sample the extreme RNA profile cases, where the cells all originate from the same type (<italic toggle="yes">temp</italic> = <italic toggle="yes">steps</italic>), as well as, profiles that are fully mixed (<italic toggle="yes">temp</italic> = 0). For each profile sampled, the produced weights of the temperature function are shuffled to randomize which cell type get which power, thus ensuring that all cell types can sample extreme profiles when the temperature (<italic toggle="yes">temp</italic>) goes to 1.</p>
      <p>Once a cell type distribution for a given profile has been found, the cells corresponding to the number of each cell type (<italic toggle="yes">x</italic>) are extracted from the SC dataset and combined into a single profile, where the sum of the gene counts of the profile are scaled to sum to 1. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1</xref> for a more detailed explanation of the sampling method.</p>
    </sec>
    <sec id="SEC2-4">
      <title>The AntiSplodge model</title>
      <sec id="SEC2-4-1">
        <title>Architecture</title>
        <p>The neural network is a feed-forward network with decreasing nodes for each hidden layer block, before the output layer with nodes equal to the number of cell types in the SC dataset. The true power of the method comes from how the sampling is performed. The input is a vector of gene counts (profile), corresponding to the count for each marker gene, scaled in the range of between 1 and 0, but usually very close to 0 because of the high number of genes. The output is a vector containing the predicted estimate of the cell type proportion. Three groups of hidden layers are used. With the default settings, these start as a pair of hidden layers with size 512, followed by pairs of layers with sizes 256 and 128, leading to a last single hidden layer with size 64. The last layer outputs the predicted proportions. Between each group of layers (hidden pairs, and the last layer), ReLu activation units are used, while for each hidden pair, a batch normalization process is used to make training faster and more stable. For <italic toggle="yes">AntiSplodge</italic> the default loss is a L1 loss. The loss is computed before the output scaling is applied, as we found this to optimize the weights to not output zero sum vectors (as zero sum vectors are usually a problem that occurs with a large number of cell types). This was further enforced by having the connection between the last hidden layer and the output layer, linked by a smooth ReLu function with a 0.1 gradient, punishing the loss score for vectors containing negative values. Network topology is that of a standard multilayer perceptron.</p>
      </sec>
      <sec id="SEC2-4-2">
        <title>scRNA dataset split during training</title>
        <p>As with most machine-learning methods, to assess the power of the model, generated synthetic profiles are divided into a train, validation, and test sets. The training set is used to train the model, usually, 90% or 95% of the profiles are in this set. We leave the testing profiles for accuracy estimation for when the training is complete. We use the validation set to select the best model parameters during training. These will be saved to a checkpoint file during training, and once the training is complete we will load the best parameters found back onto the model (based on the error of the validation dataset).</p>
        <p>During training, the network will see each copy of the synthetic training dataset (synthetic RNA profiles) in mini-batches, while at each finished epoch, we check how the current weights compare on the validation dataset. For each lower validation loss, we save the current weights of the model. This is to counter the overfitting of the training data.</p>
      </sec>
      <sec id="SEC2-4-3">
        <title>Output scaling</title>
        <p>As a proportion vector always sums to 1, any vector with a higher or lower sum is simply not a good estimate. Therefore, at the end of the model, linear scaling is applied, after a smooth ReLU activator:<disp-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} X_i = \frac{x_i}{S},\ \ \ S = \sum _i X_i \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> is the <italic toggle="yes">i</italic>th element of the vector <italic toggle="yes">X</italic>. And <italic toggle="yes">S</italic> is the initial sum of the <italic toggle="yes">X</italic> vector. Note, the error is computed beforehand to train the network to output elements between 0 and 1, as this worked better for problems with a higher number of cell types.</p>
      </sec>
      <sec id="SEC2-4-4">
        <title>Hyperparameters</title>
        <p><italic toggle="yes">AntiSplodge</italic> has been implemented in Python using PyTorch (<xref rid="B25" ref-type="bibr">25</xref>). By default, is uses the Adam (<xref rid="B26" ref-type="bibr">26</xref>) optimizer with a L1 Loss (MAE). The number of genes to use in the synthetic profiles is found by trial and error, we recommend starting with profiles of around 1000 unique genes. You might need to increase this number if the Jensen-Shannon Divergence (JSD) reported is not satisfactory. JSD is a distance metric used to measure the similarity between two probability distributions, and it is the symmetric and smoothed version of the Kullback–Leibler divergence. JSD is often used for comparison of cell-count profiles in the literature (<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B17" ref-type="bibr">17</xref>,<xref rid="B18" ref-type="bibr">18</xref>). If the JSD reported is already satisfactory, it is possible to decrease the number of genes used in order to save computations. The number of profiles needed is heavily dependent on the homology of the cell types to deconvolute. We recommend starting with a manageable amount of profiles, depending on your system, and increasing this if the results do not look promising.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>The AntiSplodge pipeline</title>
      <p>The <italic toggle="yes">AntiSplodge</italic> pipeline is presented in Figure <xref rid="F1" ref-type="fig">1</xref>. You only need two datasets to use <italic toggle="yes">AntiSplodge</italic>, an SC and an ST dataset (dotted boxes in Figure <xref rid="F1" ref-type="fig">1</xref>). Preferably, these dataset comes from the same individuals, but they could also originate from the same type of tissue (e.g. heart tissue), as long as they are comparable (e.g. individuals with similar phenotypes, for the example of heart tissues, both datasets could be from individuals with no heart diseases).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the AntiSplodge pipeline. Dotted boxes are outside the AntiSplodge regime, while full drawn boxes are the steps of AntiSplodge. (1) First the scRNA data along with cell type information are added. (2) The data is then split into three chunks, stratified by cell type information, to make train, validation, and test dataset splits. (3) For each of the dataset splits, synthetic spot profiles are generated based on the cells from the scRNA data. (4) The AntiSplodge neural network is initialized and trained using the synthetic profiles, where the ground truth is known. (5) Once the network has been trained, the spatial transcriptomics data is loaded. (6) With the trained network, the spot profiles are passed through the network to deconvolute each profile. (7) The output of the network is a proportion vector indicating the percentage of each cell type for each spot profile, these can then be used in downstream analysis tasks.</p>
        </caption>
        <graphic xlink:href="lqac073fig1" position="float"/>
      </fig>
      <p>For the SC part of the pipeline, first, the chosen dataset (Figure <xref rid="F1" ref-type="fig">1</xref>(1)) is split stratified based on cell types into train, validation, and test splits (Figure <xref rid="F1" ref-type="fig">1</xref>(2)). This ensures that there is an equal proportion of each cell type in each split. Then synthetic profiles are sampled for each dataset split (Figure <xref rid="F1" ref-type="fig">1</xref>(3)). The synthetic profile uses the mean of each gene count for all cells selected. The user needs to decide the number of potential cells that contribute to each profile. See the Methods section for more details.</p>
      <p>Finally, the network can be trained with the generated profiles (Figure <xref rid="F1" ref-type="fig">1</xref>(4)), where the user can freely decide what optimizer and error function to use, along with additional training parameters to control how long and how the training will be. We recommend using <italic toggle="yes">L1 Loss</italic>, as <italic toggle="yes">L1 Loss</italic> does a good job of reducing over-fitting in combination with using the validation dataset (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2</xref>).</p>
      <p>For the ST part of the pipeline, all that is needed is to pass the spot profiles to the <italic toggle="yes">AntiSplodge</italic> neural-network (Figure <xref rid="F1" ref-type="fig">1</xref>(5 and 6)), and the network will output the predicted cell type proportions, which will be a percentage of each cell type, where each profile sums to 1 (100%).</p>
      <p>The true strength of this approach comes from the synthetic profiles, as they will be closely comparable (given that the SC and ST datasets are comparable) to real-life spot profiles. We highly recommend doing data quality control and performing normalization techniques on both the SC and ST datasets, especially keeping profiles of each set on the same scale, for example, scale both sets to profiles with total gene counts of 1.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Comparison</title>
      <p>In order to validate our tool, we compared our methods to three state-of-the-art methods, namely; <italic toggle="yes">SPOTlight</italic>, <italic toggle="yes">Stereoscope</italic>, <italic toggle="yes">Cell2Location</italic> and <italic toggle="yes">DSTG</italic>. Furthermore, we made a baseline model, to check the complexity of the problem, and additionally, a regression-based Random Forest model was trained to check the utility of a traditional machine learning model. The models were tested to see how well they could deconvolute synthetic RNA profiles where we have the ground truth, compared in JSD. This is done by sampling SCs from the preprocessed Heart Cell Atlas (HCA), further referred to as synthetic ST spots.</p>
      <sec id="SEC3-2-1">
        <title>Dataset and quality control</title>
        <p>We downloaded the full catalogue of scRNA profiles from HCA (<xref rid="B9" ref-type="bibr">9</xref>), which comprises 486 134 SC and single-nuclei profiles, containing a total of 33 538 genes. We refer to both as cells. For preprocessing during our comparison, we removed cells with unassigned cell types or cells which were predicted as doublets. Furthermore, we performed strict quality control; removing cells with more than 1% mitochondrial genes, and the top and bottom 2.5% based on total gene count to get a more consistent set of cells, gene count-wise. Subsequently, we removed genes that were no longer found in any cell. After preprocessing a total of 305,875 cells remained, containing a total of 31 504 genes, distributed across 11 cell types. Using top 150 genes for each cell type, gave us a total of 1389 unique genes. The test accuracy for predicting each cell type using the procedure described above is 99.04% with a 90%/10% train/test split.</p>
      </sec>
      <sec id="SEC3-2-2">
        <title>Comparison setup</title>
        <p>We sampled a total of 2 100 000 training synthetic ST spot profiles (100 000 profiles for each number of cell densities used). For the validation and test dataset, we sampled 42 000 synthetic ST spots, 2000 of each cell density. The synthetic validation ST spots are only used during training of <italic toggle="yes">AntiSplodge</italic>. We here have an unscaled version (competing methods) and scaled version (our method and baselines) of the dataset.</p>
        <p>In this comparison, each of the tools (<italic toggle="yes">SPOTlight</italic>, <italic toggle="yes">Stereoscope</italic>, <italic toggle="yes">Cell2Location</italic>, and <italic toggle="yes">DSTG</italic>) were trained on the training dataset, accordingly to their documentations. For <italic toggle="yes">AntiSplodge</italic> and the <italic toggle="yes">Random Forest</italic> model, we generated synthetic ST spots using normalized gene-count profiles (each profile sums to 1) based on the training dataset. The profiles were generated with cell densities in the range of 10–30 (both inclusive). Initially, we divided the SC samples into a 80% train, 10% validation, and 10% test datasets.</p>
      </sec>
      <sec id="SEC3-2-3">
        <title>Hyperparameters for each model of the comparison</title>
        <p>In order to reproduce our results, we here present the hyperparameters used for the models of the comparison. The <italic toggle="yes">baseline</italic> model predicts an equal proportion for each cell type defined by <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{1}{N_C}$\end{document}</tex-math></inline-formula> where <italic toggle="yes">N</italic><sub><italic toggle="yes">C</italic></sub> is the total number of classes, i.e. an equal proportion of all classes or cell types (C). In this comparison, <italic toggle="yes">N</italic><sub><italic toggle="yes">C</italic></sub> is 11. The <italic toggle="yes">RandomForest</italic> model is built using scikit-learn’s (<xref rid="B27" ref-type="bibr">27</xref>) implementation of Random Forest Regressor. It was trained using the synthetic train profiles and tested using the synthetic test profiles (parameters: n_estimators = 1000, max_depth = 20, min_samples_split = 0.05, min_samples_leaf = 0.05, max_features = ‘sqrt’).</p>
        <p><italic toggle="yes">SPOTlight</italic>, <italic toggle="yes">Stereoscope</italic>, <italic toggle="yes">Cell2Location</italic> and <italic toggle="yes">DSTG</italic>, was trained using the default parameters recommended by in their respective tutorials, using the unscaled gene-count matrices (the training split of the scRNA dataset). <italic toggle="yes">AntiSplodge</italic> was trained on the training dataset, with the validation dataset used to find the best loss, and tested on the test dataset (all synthetic).</p>
      </sec>
      <sec id="SEC3-2-4">
        <title>Results</title>
        <p>The results for predicting the test profiles are presented in Figure <xref rid="F2" ref-type="fig">2</xref>. Note, all models output profiles that sum to 1, either through scaling (see Materials and Methods section) or by natural behaviour of the algorithms.</p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>Results for performance compared across the models tested, based on synthetic data generated from single-cell data from the Heart Cell Atlas, measured by Jensen–Shannon divergence (JSD). Ordered by their mean JSD, from left to right: <italic toggle="yes">Baseline</italic> (mean: 60.5%), Regression-based <italic toggle="yes">Random Forest</italic> (mean: 35.1%), <italic toggle="yes">SPOTlight</italic> (mean: 24.8%) <italic toggle="yes">Stereoscope</italic> (mean: 20.6%), <italic toggle="yes">Cell2Location</italic> (mean: 20.6%), <italic toggle="yes">DSTG</italic> (mean: 10.0%), and our method <italic toggle="yes">AntiSplodge</italic> (mean: 7.6%). <italic toggle="yes">P</italic>-values at the top of the plot are Bonferroni adjusted <italic toggle="yes">t</italic>-test <italic toggle="yes">P</italic>-values, comparing the distributions of JSDs for each model against <italic toggle="yes">AntiSplodge</italic>.</p>
          </caption>
          <graphic xlink:href="lqac073fig2" position="float"/>
        </fig>
        <p>The <italic toggle="yes">Baseline</italic> model performs the worst with a mean JSD of 60.5%. Random Forest had a relatively high mean JSD of 35.1%, compared to the methods designed for deconvolution (both competing and our methods). Each of the competing models produced quite similar proportion profiles in terms of mean JSD (<italic toggle="yes">SPOTlight</italic>: 24.8%, <italic toggle="yes">Stereoscope</italic>: 20.6%, and <italic toggle="yes">Cell2Location</italic>: 20.6%). However, we want to emphasize here that we used the tools with the default settings (with only minor alterations to make some of them run). <italic toggle="yes">DSTG</italic> has a very comparable mean JSD to that of <italic toggle="yes">AntiSplodge</italic> with 10.0%. <italic toggle="yes">AntiSplodge</italic> had the lowest mean JSD of all the tools compared (7.6%), which is considerably lower than the competing methods. Cell population overview and marker genes can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 3</xref>. Additionally, we computed Bonferroni adjusted <italic toggle="yes">t</italic>-test <italic toggle="yes">P</italic>-values for the output of <italic toggle="yes">AntiSplodge</italic> compared to each of the other models, in order to see if there was a significant difference between the distributions of the outputs. Here we found that there was a significant difference between the output of <italic toggle="yes">AntiSplodge</italic> and all the other models (these are shown at the top of Figure <xref rid="F2" ref-type="fig">2</xref>).</p>
      </sec>
      <sec id="SEC3-2-5">
        <title>10-fold cross-validation</title>
        <p>In order to test the robustness of <italic toggle="yes">AntiSplodge</italic>, we performed 10-fold cross-validation. Using the same dataset (HCA (<xref rid="B9" ref-type="bibr">9</xref>)), we filtered it to only contain samples that were gathered from Harvard Nucleic sequencing (<italic toggle="yes">N</italic> = 163 959), again removing doublets and cell types there were defined as not assigned and filtering genes such that we only had the marker genes found in the comparison (<italic toggle="yes">N</italic> = 1389), we did not do any trimming of the dataset. We then constructed 10-fold, where each fold was stratified to contain an equal number of samples for each cell type. For each fold, we set up an <italic toggle="yes">AntiSplodge</italic> experiment, where 9-fold was used for training and the remaining were used for testing. For each experiment, we constructed 100 000 training, 2500 validation and 2500 testing profiles, synthetically, each with a cell density of 10. We then initialized a model for each experiment and trained each with 25 warm restarts (where the best found weight configuration were loaded back onto the model) with restarts occurring when we did not see an improvement for five epochs. The total run time of all experiments time was 2 h and 23 min. The mean JSDs reported were from the lowest 7.71% mean JSD to the highest 10.05% mean JSD, the total mean across all 10-fold was 8.59% JSD. The folds have been plotted in Figure <xref rid="F3" ref-type="fig">3</xref>. Overall, this demonstrates that <italic toggle="yes">AntiSplodge</italic> is very robust, even with random initiation of the weights. We used the Adam (<xref rid="B26" ref-type="bibr">26</xref>) optimizer with an L1 Loss (MAE). A Python notebook with the full reproducible analysis is found in the GitHub repository. Note, even though 10-fold cross-validation is normally used to select the best model, we mainly use it to show the robustness of the model across multiple initiations, which produces very similar results. One could of course select any of the folds (usually the one with the best accuracy) for the down-steam analysis.</p>
        <fig position="float" id="F3">
          <label>Figure 3.</label>
          <caption>
            <p>Results for the <italic toggle="yes">AntiSplodge</italic> 10-fold cross-validation. Each fold contains 2500 synthetic test profiles with a cell density of 10. From left to right, we have a mean JSD of: Fold 1: 8.64% (SD: 7.97%), Fold 2: 8.27% (SD: 7.11%), Fold 3: 9.18% (SD: 8.43%), Fold 4: 10.05% (SD: 8.07%), Fold 5: 8.67% (SD: 8.28%), Fold 6: 7.78% (SD: 7.74%), Fold 7: 8.11% (SD: 7.83%), Fold 8: 8.16% (SD: 8.14%), Fold 9: 7.72% (SD: 8.15%), Fold 10: 9.37% (SD: 8.53%). Red line denotes the mean JSD across all folds with 8.59%.</p>
          </caption>
          <graphic xlink:href="lqac073fig3" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="SEC3-3">
      <title>Application 1: Deconvoluting the developing human heart</title>
      <sec id="SEC3-3-1">
        <title>Overview</title>
        <p>Recently, an organ-wide cell atlas of the developing human heart has been published (<xref rid="B20" ref-type="bibr">20</xref>). The dataset features 19 slices of fetal hearts, from three different time points in the first trimester: 4.5–5, 6.5 and 9 post-conception weeks (PCW, <italic toggle="yes">N</italic> = 4, 9 and 6, respectively), with ST measurements. Additionally, paired SC gene expression data, featuring 3717 SCs with an average of 2900 genes per cell, is available. The SCs are annotated with cell types, covering 14 classes, with some of the cell types sharing the same majority type.</p>
        <p>We intersect all 19 ST samples with the paired SC dataset to a common gene set (<italic toggle="yes">N</italic> = 7638). Using the SC dataset, we compute the marker genes via logistic regression, as explained during the comparison. We found that using the top 200 genes for each cell type (1387 unique genes) yielded a 94.35% test accuracy, which makes the gene set a good gene set for the cell type differentiation.</p>
      </sec>
      <sec id="SEC3-3-2">
        <title>AntiSplodge pipeline</title>
        <p>First we divided the SC dataset into a a 90% train, 5% validation and 5% test split. We then created synthesized ST profiles, with cell densities in the range of 20–41 (which is noted in the ST dataset manuscript (<xref rid="B20" ref-type="bibr">20</xref>) as the average cell counts found for each spot). For each cell density we create 10 000 train, 2000 validation and 2000 test synthesized profiles, for a total of 210 000 train, 42 000 validation and 42 000 test profiles.</p>
        <p>Training the model took 13.83 min on a single GPU, and it ran for 192 epochs (with the last 100 being the patience epochs with no increase in validation performance), the best model was found at epoch 93. We achieve a mean Jensen–Shannon divergence (JSD) of 12.91% in the test dataset.</p>
      </sec>
      <sec id="SEC3-3-3">
        <title>Results</title>
        <p>The results for this application has been displayed in Figure <xref rid="F4" ref-type="fig">4</xref>. With the fast training of the network (∼14 min, Figure <xref rid="F4" ref-type="fig">4A</xref>), we see a very satisfactory low mean JSD (12.91%, Figure <xref rid="F4" ref-type="fig">4B</xref>). Across all samples, we see a coherent pattern of the highest cell types abundances residing in the regions to which they are expected to be found (Figure <xref rid="F4" ref-type="fig">4F</xref>). Here, ventricular cardiomyocytes are found in the regions of the left and right ventricle, while atrial cardiomyocytes are found in the regions of the left and right atrium. Smooth muscle and fibroblast-like cells are found in the smooth muscle tissues connecting the heart muscles. Erythrocytes are found in spots with low-density tissues such as heart chambers. Furthermore, looking at Figure <xref rid="F4" ref-type="fig">4E</xref>, we see that these cell types are only predicted in the regions where we would expect, but have little to no contributions in the other regions. If we look at how the cell type distributions change over time (i.e. PCW, Figure <xref rid="F4" ref-type="fig">4C</xref> and <xref rid="F4" ref-type="fig">D</xref>), we see a more or less stable abundancy relation between the cell types except for ventricular cardiomyocytes, which seems to increase over time (based on their proportions allocated in the spots), which is most likely since the ventricular regions are growing/developing over this period, which can be seen with the naked eye in Figure <xref rid="F4" ref-type="fig">4F</xref>. Cell population overview, marker genes, and cell type proportions per sample, can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 4</xref>.</p>
        <fig position="float" id="F4">
          <label>Figure 4.</label>
          <caption>
            <p>Results for ST samples from the developing human heart (<italic toggle="yes">N</italic> = 19). (<bold>A</bold>) Loss over epochs, best loss found is indicated with a green dot (epoch = 92, loss = 0.0017). (<bold>B</bold>) Jensen–Shannon divergence box plot for the test samples (mean JSD = 12.9%). (<bold>C</bold>) Distributions of cell types across samples, ordered by PCW. (<bold>D</bold>) Mean proportion of each cell type for each PCW. (<bold>E</bold>) Zoom of the fourth 6.5 PCW sample. First four plots are the top four cell types ordered by their cell type abundance across ST spots (highest first), ventricular cardiomyocytes, erythrocytes, smooth muscle cells/fibroblast-like, and atrial cardiomyocytes. Fifth plot is the corresponding plot in (F). Last plot is the cell type distribution across spots. (<bold>F</bold>) Map of maximum cell types for each spot for each of the samples. Samples are ordered as; first four is 4.5–5 PCW (black), next nine is 6.5 PCW (green), and last six is 9 PCW (purple). (<bold>G</bold>) Legend for cell types and their associated colors.</p>
          </caption>
          <graphic xlink:href="lqac073fig4" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="SEC3-4">
      <title>Application 2: Deconvoluting the mouse brain</title>
      <sec id="SEC3-4-1">
        <title>Overview</title>
        <p>With the release of the 10× genomics visium spatial technology, several demonstration datasets were publicly released. These included datasets for the mouse brain, which we deconvolute in this application. For this, we use five datasets, namely the adult mouse brain sample (coronal view), and the four sagittal cuts of the mouse brain (two for the posterior and two for the anterior part of the mouse brain) (<xref rid="B28" ref-type="bibr">28</xref>). To deconvolute these samples, we downloaded scRNA profiles (<italic toggle="yes">N</italic> = 76 533, with 45 768 unique genes) from the Allen mouse brain atlas, which are SCs isolated from &gt;20 areas of mouse cortex and hippocamopus (<xref rid="B29" ref-type="bibr">29</xref>), processed with a 10× SMART-seq machine. In this dataset, there are four major cell types, and 42 subclass cell types, with a nomenclature for the subcell types of either describing what part of the brain they reside (e.g. CA1, which is a region of the mouse hippocampus) or what genes are highly expressed (e.g. <italic toggle="yes">Vip</italic> and <italic toggle="yes">Meis2</italic>). In this application, we want to deconvolute the mouse brain using the 42 subclass cell types.</p>
        <p>We find the intersecting gene set among all STs and the SC dataset (<italic toggle="yes">N</italic> genes=15 262). We compute the marker genes, as explained in the Comparison using t-tests and use the top 250 genes (3559 unique genes), which yield a 97.73% test accuracy. This makes this gene set a good set for differentiation among the 42 cell types. We used <italic toggle="yes">t</italic>-tests as the number of cell types and therefore the number of unique genes, were too high for the logistic regression to be beneficial, and thus we could save computational time.</p>
      </sec>
      <sec id="SEC3-4-2">
        <title>AntiSplodge pipeline</title>
        <p>We create synthesized ST profiles, with cell densities in the range of 1–20 (note the 10× samples usually have between 1 and 10 cells (<xref rid="B20" ref-type="bibr">20</xref>), but we add another 10 to serve as a buffer for the upper limit). For each cell density we create 30 000 train, 5000 validation and 5000 test synthesized profiles, for a total of 600 000 train, 100 000 validation and 100 000 test profiles. We used a 90% train, 5% validation and 5% test split, for the SC samples that were used to make the synthetic ST profiles.</p>
        <p>Training the model took 96.24 min on a single GPU, and it ran for 490 epochs, the best model was found at epoch 389. We achieve a mean Jensen–Shannon divergence (JSD) of 12.12% in the test dataset.</p>
      </sec>
      <sec id="SEC3-4-3">
        <title>Results</title>
        <p>The results for this application has been displayed in Figure <xref rid="F5" ref-type="fig">5</xref>. Based on the network performance, we see a very satisfactory low mean JSD (12.12%, Figure <xref rid="F5" ref-type="fig">5B</xref>), even though the complexity of the problem is quite high, with 42 subcell types to estimate. The perhaps most intriguing result is shown in Figure <xref rid="F5" ref-type="fig">5D</xref>, which is a zoom-in of the mouse hippocampus. Here, we see that the cell types; CA1, CA2, CA3 (cornu ammonis), and DG (dentate gyrus) are extremely well predicted based on their associated brain region found in Figure <xref rid="F5" ref-type="fig">5</xref>D*. These cells are named after those particular regions in the Allen mouse brain atlas. For each of the five tissues and their respective spot predictions (Figure <xref rid="F5" ref-type="fig">5G</xref>), we see that the cell type majority (indicated by color), closely follows the tissue regions. For both the mouse cerebellum (Figure <xref rid="F5" ref-type="fig">5E</xref> and <xref rid="F5" ref-type="fig">F</xref>) and brain cortex (Figure <xref rid="F5" ref-type="fig">5C</xref>), we see that the cell type expressions are heavily dependent on the regions of the brain. Furthermore, for both brain structures, we see coherent and matching cell types expression across the samples, which demonstrates the reliability of the network. Cell population overview, marker genes and cell type proportions per sample, can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 5</xref>.</p>
        <fig position="float" id="F5">
          <label>Figure 5.</label>
          <caption>
            <p>Results for ST samples from the developing human heart (<italic toggle="yes">N</italic> = 5). (<bold>A</bold>) Loss over epochs, best loss found is indicated with a green dot (epoch = 390, loss = 0.0006). (<bold>B</bold>) Jensen-Shannon Divergence box plot for the test samples (mean JSD = 12.12%). (<bold>C</bold>) Predicted cell types for layers of the mouse brain cortex in the sagittal anterior samples, different types are found in the different cortex layers. (<bold>D</bold>) Predicted distributions of cell types for CA1, CA2, CA3 (cornu ammonis) and DG (dentate gyrus). Note: In the Allen mouse brain atlas, the cell subclass types are defined by the regions in which they were found. (<bold>D*</bold>) Hippocampus regions according to the Allen mouse brain atlas. (<bold>E</bold>) Predicted cell types in the mouse brain for the first sagittal posterior sample. (<bold>F</bold>) Predicted cell types in the mouse brain for the second sagittal posterior sample. (<bold>G</bold>) Pairs of the tissue and deconvoluted spots, for the mouse brain ST samples. (<bold>H</bold>) Legend for cell types and their associated colors, for the figures in (G).</p>
          </caption>
          <graphic xlink:href="lqac073fig5" position="float"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>DISCUSSION AND CONCLUSION</title>
    <p>In this study, we present a completely new method for the process of deconvoluting spot areas of spatial transcriptomics by utilizing SC profiles from similar or matched tissues. Although the deconvolution idea is no longer novel, we think that the speed and accuracy of <italic toggle="yes">AntiSplodge</italic> could be of interest to the science community. We show that this procedure generates approximations far more accurate (or less diverged) compared to state-of-the-art methods which estimate profiles mainly based on the contributions of logits computed for each gene. In addition, by using the included sampler, researchers no longer need to take care of skewed distributions, as this is taken care of directly by the sampling procedure.</p>
    <p>In our study, we illuminated the workflow of the pipeline with two applications. One is the deconvolution of the developing human heart, and the other is the adult mouse brain. For the developing human heart, we showed that the deconvoluting process, correctly estimated cell types based on where they are expected to frequently appear. This was in particular apparent for cells of the type; ventricular cardiomyocytes, smooth muscle cells, and atrial cardiomyocytes (Figure <xref rid="F4" ref-type="fig">4E</xref> and <xref rid="F4" ref-type="fig">F</xref>). These patterns are further confirmed when we compare our results to a recent study preprint (<xref rid="B30" ref-type="bibr">30</xref>), especially for the two oldest sets of the tissues (6.5 and 9 PCW). However, in the same preprint, they did not find the same patterns of the expected cells types in 4.5–5 PCW samples, while we did in our study. Although the patterns are less sharply expressed (at least in our study), it seems that their method failed to fully deconvolute the cell type signals in the youngest of samples (4.5–5 PCW), perhaps because the profiles seems to be more differentially convoluted, compared to the older samples.</p>
    <p>In the mouse brain applications, we similarly found credible patterns of cell types which based on the literature seems highly plausible. For example, in the mouse hippocampus (Figure <xref rid="F5" ref-type="fig">5D</xref> and D*), we found that the cell types CA1, CA2, CA3 (cornu ammonis), and DG (dentate gyrus) exactly followed the patterns of the regions (<xref rid="B31" ref-type="bibr">31–33</xref>) (from which they are named in the Allen mouse brain atlas, which is the SC dataset used). Furthermore, the expressions found in the mouse brain cortex (Figure <xref rid="F5" ref-type="fig">5C</xref>), followed similar patterns found in recent deconvolution publications which used the same ST dataset (<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B34" ref-type="bibr">34</xref>). In addition, by manual inspection, most cell types were distributed in patterns that closely followed the underlying tissue, which is broadly used as a confirmation of results in experimental ST publications.</p>
    <p>As with most of the available deconvolution tools, we recommend using a smaller set of marker genes, as such a set yields faster training while reducing the memory footprint, in our case considerably if a large number of synthetic profiles are generated. While like most deconvolution tools, it is still feasible to run with the full gene set. Although in theory, more genes mean more heterogeneous cell type profiles, the extra noise added (combined with reduced performance) is usually not worth the effort. One additional advantage of using marker genes is that when stricter quality control and filtering is applied to both the SC and ST dataset, using marker genes found in the trimmed data ensures a higher orchestration of intersectional genes, which makes it easier to ensure that cell types markers are present across both data sets.</p>
    <p>In conclusion, we have shown that <italic toggle="yes">AntiSplodge</italic> is a proven contender among state-of-the-art ST deconvolution tools and that it is capable of producing good results within very short time spans, both for problems with low and high complexity. One general problem persists for deconvolution of ST spots using SC data, unlike the developing human heart study (<xref rid="B20" ref-type="bibr">20</xref>) which contains SC and ST data from the same donor with adjacent tissues, most ST datasets do not contain SC data (and <italic toggle="yes">vice-versa</italic>), and determining if an SC dataset is a good representative for the cells in the convoluted ST spots, remains unsolved. However, this might be temporarily fixed by adding good uncertainty estimates to the results (<xref rid="B35" ref-type="bibr">35</xref>), which is something we are currently investigating and hope to share some results on in a near future.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The software is available at: <ext-link xlink:href="https://github.com/HealthML/AntiSplodge/" ext-link-type="uri">https://github.com/HealthML/AntiSplodge/</ext-link>. The single cell profiles from the Heart Cell Atlas can be found at: <ext-link xlink:href="https://www.heartcellatlas.org/" ext-link-type="uri">https://www.heartcellatlas.org/</ext-link>. The developing human heart spatial transcriptomics samples and along with the paired scRNA can be found at: <ext-link xlink:href="https://www.spatialresearch.org/resources-published-datasets/doi-10-1016-j-cell-2019-11-025/" ext-link-type="uri">https://www.spatialresearch.org/resources-published-datasets/doi-10-1016-j-cell-2019-11-025/</ext-link>. The 10X mouse brain spatial transcriptomics are located at: <ext-link xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/" ext-link-type="uri">https://support.10xgenomics.com/spatial-gene-expression/datasets/</ext-link>. The mouse brain scRNA profiles from the Allen mouse brain atlas are found at: <ext-link xlink:href="https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-smart-seq" ext-link-type="uri">https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-smart-seq</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>lqac073_Supplemental_File</label>
      <media xlink:href="lqac073_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Michaela Asp for her guidance and information about the developing human heart samples.</p>
    <p><italic toggle="yes">Author contributions:</italic> J.L. and C.L. designed the study. J.L. developed <italic toggle="yes">AntiSplodge</italic>. J.L. and C.L. performed ST and SC data analyses. E.L., H.M., and N.H. provided SC data, biological insights, and performed data annotation. F.P. supported the data analysis and provided statistical knowledge. J.L. and C.L. wrote the initial manuscript. All authors commented, read, and approved the final version. All authors discussed and guided the direction of the study. Correspondence should be addressed to C.L.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nargab/article-lookup/doi/10.1093/nargab/lqac073#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NARGAB Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>German Federal Ministry of Education and Research (BMBF) in the project KI-LAB-ITSE [01|S19066].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>P.L.</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F.</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lundmark</surname><given-names>A.</given-names></string-name>, <string-name><surname>Navarro</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Magnusson</surname><given-names>J.</given-names></string-name>, <string-name><surname>Giacomello</surname><given-names>S.</given-names></string-name>, <string-name><surname>Asp</surname><given-names>M.</given-names></string-name>, <string-name><surname>Westholm</surname><given-names>J.O.</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>. <year>2016</year>; <volume>353</volume>:<fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriques</surname><given-names>S.G.</given-names></string-name>, <string-name><surname>Stickels</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Goeva</surname><given-names>A.</given-names></string-name>, <string-name><surname>Martin</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E.</given-names></string-name>, <string-name><surname>Vanderburg</surname><given-names>C.R.</given-names></string-name>, <string-name><surname>Welch</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L.M.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F.</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name></person-group><article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>. <source>Science</source>. <year>2019</year>; <volume>363</volume>:<fpage>1463</fpage>–<lpage>1467</lpage>.<pub-id pub-id-type="pmid">30923225</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shah</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lubeck</surname><given-names>E.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>W.</given-names></string-name>, <string-name><surname>Cai</surname><given-names>L.</given-names></string-name></person-group><article-title>seqFISH accurately detects transcripts in single cells and reveals robust spatial organization in the hippocampus</article-title>. <source>Neuron</source>. <year>2017</year>; <volume>94</volume>:<fpage>752</fpage>–<lpage>758</lpage>.<pub-id pub-id-type="pmid">28521130</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marx</surname><given-names>V.</given-names></string-name></person-group><article-title>Method of the year: spatially resolved transcriptomics</article-title>. <source>Nat. Methods</source>. <year>2021</year>; <volume>18</volume>:<fpage>9</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">33408395</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crosetto</surname><given-names>N.</given-names></string-name>, <string-name><surname>Bienko</surname><given-names>M.</given-names></string-name>, <string-name><surname>Van Oudenaarden</surname><given-names>A.</given-names></string-name></person-group><article-title>Spatially resolved transcriptomics and beyond</article-title>. <source>Nat. Rev. Genet.</source><year>2015</year>; <volume>16</volume>:<fpage>57</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">25446315</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stickels</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E.</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>P.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name>, <string-name><surname>Marshall</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Di Bella</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Arlotta</surname><given-names>P.</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F.</given-names></string-name></person-group><article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>39</volume>:<fpage>313</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">33288904</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eng</surname><given-names>C.-H.L.</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Dries</surname><given-names>R.</given-names></string-name>, <string-name><surname>Koulena</surname><given-names>N.</given-names></string-name>, <string-name><surname>Takei</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Yun</surname><given-names>J.</given-names></string-name>, <string-name><surname>Cronin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Karp</surname><given-names>C.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>G.-C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH+</article-title>. <source>Nature</source>. <year>2019</year>; <volume>568</volume>:<fpage>235</fpage>–<lpage>239</lpage>.<pub-id pub-id-type="pmid">30911168</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aldridge</surname><given-names>S.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name></person-group><article-title>Single cell transcriptomics comes of age</article-title>. <source>Nat. Commun.</source><year>2020</year>; <volume>11</volume>:<fpage>4307</fpage>.<pub-id pub-id-type="pmid">32855414</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Litviňuková</surname><given-names>M.</given-names></string-name>, <string-name><surname>Talavera-López</surname><given-names>C.</given-names></string-name>, <string-name><surname>Maatz</surname><given-names>H.</given-names></string-name>, <string-name><surname>Reichart</surname><given-names>D.</given-names></string-name>, <string-name><surname>Worth</surname><given-names>C.L.</given-names></string-name>, <string-name><surname>Lindberg</surname><given-names>E.L.</given-names></string-name>, <string-name><surname>Kanda</surname><given-names>M.</given-names></string-name>, <string-name><surname>Polanski</surname><given-names>K.</given-names></string-name>, <string-name><surname>Heinig</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Cells of the adult human heart</article-title>. <source>Nature</source>. <year>2020</year>; <volume>588</volume>:<fpage>466</fpage>–<lpage>472</lpage>.<pub-id pub-id-type="pmid">32971526</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baccin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Al-Sabah</surname><given-names>J.</given-names></string-name>, <string-name><surname>Velten</surname><given-names>L.</given-names></string-name>, <string-name><surname>Helbling</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Grünschläger</surname><given-names>F.</given-names></string-name>, <string-name><surname>Hernández-Malmierca</surname><given-names>P.</given-names></string-name>, <string-name><surname>Nombela-Arrieta</surname><given-names>C.</given-names></string-name>, <string-name><surname>Steinmetz</surname><given-names>L.M.</given-names></string-name>, <string-name><surname>Trumpp</surname><given-names>A.</given-names></string-name>, <string-name><surname>Haas</surname><given-names>S.</given-names></string-name></person-group><article-title>Combined single-cell and spatial transcriptomics reveal the molecular, cellular and spatial bone marrow niche organization</article-title>. <source>Nat. Cell Biol.</source><year>2020</year>; <volume>22</volume>:<fpage>38</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">31871321</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grønning</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Oubounyt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kanev</surname><given-names>K.</given-names></string-name>, <string-name><surname>Lund</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kacprowski</surname><given-names>T.</given-names></string-name>, <string-name><surname>Zehn</surname><given-names>D.</given-names></string-name>, <string-name><surname>Röttger</surname><given-names>R.</given-names></string-name>, <string-name><surname>Baumbach</surname><given-names>J.</given-names></string-name></person-group><article-title>Enabling single-cell trajectory network enrichment</article-title>. <source>Nat. Computat. Sci.</source><year>2021</year>; <volume>1</volume>:<fpage>153</fpage>–<lpage>163</lpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J.</given-names></string-name>, <string-name><surname>Asp</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>L.</given-names></string-name>, <string-name><surname>Jurek</surname><given-names>A.</given-names></string-name>, <string-name><surname>Navarro</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Lundeberg</surname><given-names>J.</given-names></string-name></person-group><article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title>. <source>Commun. Biol.</source><year>2020</year>; <volume>3</volume>:<fpage>565</fpage>.<pub-id pub-id-type="pmid">33037292</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Hafemeister</surname><given-names>C.</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Mauck III</surname><given-names>W.M.</given-names></string-name>, <string-name><surname>Hao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Stoeckius</surname><given-names>M.</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua-Bayes</surname><given-names>M.</given-names></string-name>, <string-name><surname>Nieto</surname><given-names>P.</given-names></string-name>, <string-name><surname>Mereu</surname><given-names>E.</given-names></string-name>, <string-name><surname>Gut</surname><given-names>I.</given-names></string-name>, <string-name><surname>Heyn</surname><given-names>H.</given-names></string-name></person-group><article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>Nucleic Acids Res.</source><year>2021</year>; <volume>49</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">33544846</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E.</given-names></string-name>, <string-name><surname>Zou</surname><given-names>L.S.</given-names></string-name>, <string-name><surname>Goeva</surname><given-names>A.</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F.</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>R.A.</given-names></string-name></person-group><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat. Biotechnol.</source><year>2021</year>; <volume>40</volume>:<fpage>517</fpage>–<lpage>526</lpage>.<pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R.</given-names></string-name>, <string-name><surname>Barkley</surname><given-names>D.</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>F.</given-names></string-name>, <string-name><surname>Chiodin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Devlin</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Baron</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hajdu</surname><given-names>C.H.</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Yanai</surname><given-names>I.</given-names></string-name></person-group><article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>333</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V.</given-names></string-name>, <string-name><surname>Shmatko</surname><given-names>A.</given-names></string-name>, <string-name><surname>Dann</surname><given-names>E.</given-names></string-name>, <string-name><surname>Aivazidis</surname><given-names>A.</given-names></string-name>, <string-name><surname>King</surname><given-names>H.W.</given-names></string-name>, <string-name><surname>Li</surname><given-names>T.</given-names></string-name>, <string-name><surname>Elmentaite</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lomakin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kedlian</surname><given-names>V.</given-names></string-name>, <string-name><surname>Gayoso</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Cell2location maps fine-grained cell types in spatial transcriptomics</article-title>. <source>Nat. Biotechnol.</source><year>2022</year>; <volume>40</volume>:<fpage>661</fpage>–<lpage>671</lpage>.<pub-id pub-id-type="pmid">35027729</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Su</surname><given-names>J.</given-names></string-name></person-group><article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title>. <source>Brief. Bioinform.</source><year>2021</year>; <volume>22</volume>:<fpage>bbaa414</fpage>.<pub-id pub-id-type="pmid">33480403</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M.</given-names></string-name>, <string-name><surname>Barham</surname><given-names>P.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>A.</given-names></string-name>, <string-name><surname>Dean</surname><given-names>J.</given-names></string-name>, <string-name><surname>Devin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Ghemawat</surname><given-names>S.</given-names></string-name>, <string-name><surname>Irving</surname><given-names>G.</given-names></string-name>, <string-name><surname>Isard</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>{TensorFlow}: a system for {Large-Scale} machine learning</article-title>. <source>12th USENIX symposium on operating systems design and implementation (OSDI 16)</source>. <year>2016</year>; <fpage>265</fpage>–<lpage>283</lpage>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asp</surname><given-names>M.</given-names></string-name>, <string-name><surname>Giacomello</surname><given-names>S.</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>L.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Fürth</surname><given-names>D.</given-names></string-name>, <string-name><surname>Qian</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wärdell</surname><given-names>E.</given-names></string-name>, <string-name><surname>Custodio</surname><given-names>J.</given-names></string-name>, <string-name><surname>Reimegård</surname><given-names>J.</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>. <source>Cell</source>. <year>2019</year>; <volume>179</volume>:<fpage>1647</fpage>–<lpage>1660</lpage>.<pub-id pub-id-type="pmid">31835037</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ntranos</surname><given-names>V.</given-names></string-name>, <string-name><surname>Yi</surname><given-names>L.</given-names></string-name>, <string-name><surname>Melsted</surname><given-names>P.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group><article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">30664774</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source><year>2018</year>; <volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shekhar</surname><given-names>K.</given-names></string-name>, <string-name><surname>Menon</surname><given-names>V.</given-names></string-name></person-group><article-title>Identification of cell types from single-cell transcriptomic data</article-title>. <source>Computational Methods for Single-Cell Data Analysis</source>. <year>2019</year>; <fpage>45</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group><article-title>Xgboost: a scalable tree boosting system</article-title>. <source>Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining</source>. <year>2016</year>; <fpage>785</fpage>–<lpage>794</lpage>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Paszke</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gross</surname><given-names>S.</given-names></string-name>, <string-name><surname>Massa</surname><given-names>F.</given-names></string-name>, <string-name><surname>Lerer</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bradbury</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chanan</surname><given-names>G.</given-names></string-name>, <string-name><surname>Killeen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Gimelshein</surname><given-names>N.</given-names></string-name>, <string-name><surname>Antiga</surname><given-names>L.</given-names></string-name><etal>et al</etal>.</person-group><source>PyTorch: An Imperative Style, High-Performance Deep Learning Library</source>. <year>2019</year>; <fpage>8024</fpage>–<lpage>8035</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>D.P.</given-names></string-name>, <string-name><surname>Ba</surname><given-names>J.</given-names></string-name></person-group><article-title>Adam: a method for stochastic optimization</article-title>. <year>2014</year>; <comment>arXiv doi:</comment><comment>22 December 2014, preprint: not peer reviewed</comment><uri xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</uri>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F.</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G.</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A.</given-names></string-name>, <string-name><surname>Michel</surname><given-names>V.</given-names></string-name>, <string-name><surname>Thirion</surname><given-names>B.</given-names></string-name>, <string-name><surname>Grisel</surname><given-names>O.</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M.</given-names></string-name>, <string-name><surname>Prettenhofer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>R.</given-names></string-name>, <string-name><surname>Dubourg</surname><given-names>V.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Scikit-learn: Machine learning in Python</article-title>. <source>J. Mach. Learn. Res.</source><year>2011</year>; <volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villacampa</surname><given-names>E.G.</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>L.</given-names></string-name>, <string-name><surname>Mirzazadeh</surname><given-names>R.</given-names></string-name>, <string-name><surname>Kvastad</surname><given-names>L.</given-names></string-name>, <string-name><surname>Andersson</surname><given-names>A.</given-names></string-name>, <string-name><surname>Mollbrink</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kokaraki</surname><given-names>G.</given-names></string-name>, <string-name><surname>Monteil</surname><given-names>V.</given-names></string-name>, <string-name><surname>Schultz</surname><given-names>N.</given-names></string-name>, <string-name><surname>Appelberg</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>et</surname><given-names>al.</given-names></string-name></person-group><article-title>Genome-wide spatial expression profiling in formalin-fixed tissues</article-title>. <source>Cell Genom.</source><year>2021</year>; <volume>1</volume>:<fpage>100065</fpage>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T.N.</given-names></string-name>, <string-name><surname>van Velthoven</surname><given-names>C.T.</given-names></string-name>, <string-name><surname>Goldy</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sedeno-Cortes</surname><given-names>A.E.</given-names></string-name>, <string-name><surname>Baftizadeh</surname><given-names>F.</given-names></string-name>, <string-name><surname>Bertagnolli</surname><given-names>D.</given-names></string-name>, <string-name><surname>Casper</surname><given-names>T.</given-names></string-name>, <string-name><surname>Crichton</surname><given-names>K.</given-names></string-name>, <string-name><surname>Ding</surname><given-names>S.-L.</given-names></string-name>, <string-name><surname>et</surname><given-names>al.</given-names></string-name></person-group><article-title>A taxonomy of transcriptomic cell types across the isocortex and hippocampal formation</article-title>. <year>2020</year>; </mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname><given-names>R.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>G.-C.</given-names></string-name></person-group><article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title>. <source>Genome Biol.</source><year>2021</year>; <volume>22</volume>:<fpage>145</fpage>.<pub-id pub-id-type="pmid">33971932</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pépin</surname><given-names>J.</given-names></string-name>, <string-name><surname>Jégo</surname><given-names>P.</given-names></string-name>, <string-name><surname>Valette</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bonvento</surname><given-names>G.</given-names></string-name>, <string-name><surname>Flament</surname><given-names>J.</given-names></string-name>, <string-name><surname>Roses</surname><given-names>F.</given-names></string-name></person-group><article-title>Imaging of neuronal compartment using gluCEST method</article-title>. <source>International Society for Magnetic Resonance in Medicine</source>. <year>2017</year>; </mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habib</surname><given-names>N.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Heidenreich</surname><given-names>M.</given-names></string-name>, <string-name><surname>Swiech</surname><given-names>L.</given-names></string-name>, <string-name><surname>Avraham-Davidi</surname><given-names>I.</given-names></string-name>, <string-name><surname>Trombetta</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Hession</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>F.</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A.</given-names></string-name></person-group><article-title>Div-Seq: Single-nucleus RNA-Seq reveals dynamics of rare adult newborn neurons</article-title>. <source>Science</source>. <year>2016</year>; <volume>353</volume>:<fpage>925</fpage>–<lpage>928</lpage>.<pub-id pub-id-type="pmid">27471252</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Schröder</surname><given-names>H.</given-names></string-name>, <string-name><surname>Moser</surname><given-names>N.</given-names></string-name>, <string-name><surname>Huggenberger</surname><given-names>S.</given-names></string-name></person-group><article-title>The mouse hippocampus</article-title>. <source>Neuroanatomy of the Mouse</source>. <year>2020</year>; <publisher-name>Springer</publisher-name><fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Su</surname><given-names>J.</given-names></string-name></person-group><article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title>. <source>Brief. Bioinform.</source><year>2021</year>; <volume>22</volume>:<fpage>bbaa414</fpage>.<pub-id pub-id-type="pmid">33480403</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pearce</surname><given-names>T.</given-names></string-name>, <string-name><surname>Leibfried</surname><given-names>F.</given-names></string-name>, <string-name><surname>Brintrup</surname><given-names>A.</given-names></string-name></person-group><article-title>Uncertainty in neural networks: approximately bayesian ensembling</article-title>. <source>International conference on artificial intelligence and statistics</source>. <year>2020</year>; <publisher-name>PMLR</publisher-name><fpage>234</fpage>–<lpage>244</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
