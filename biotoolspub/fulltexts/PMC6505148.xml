<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="hwp">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="pmc">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">G3: Genes, Genomes, Genetics</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Genetics Society of America</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6505148</article-id>
    <article-id pub-id-type="publisher-id">GGG_400126</article-id>
    <article-id pub-id-type="doi">10.1534/g3.119.400126</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An R Package for Bayesian Analysis of Multi-environment and Multi-trait Multi-environment Data for Genome-Based Prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Montesinos-López</surname>
          <given-names>Osval A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Montesinos-López</surname>
          <given-names>Abelardo</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>†</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luna-Vázquez</surname>
          <given-names>Francisco Javier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toledo</surname>
          <given-names>Fernando H.</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez-Rodríguez</surname>
          <given-names>Paulino</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>§</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lillemo</surname>
          <given-names>Morten</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">**</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crossa</surname>
          <given-names>José</given-names>
        </name>
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9429-5855</contrib-id>
        <xref ref-type="aff" rid="aff3">
          <sup>‡</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label>*</label>Facultad de Telemática, Universidad de Colima, Colima, Colima, 28040, México</aff>
      <aff id="aff2"><label>†</label>Departamento de Matemáticas, Centro Universitario de Ciencias Exactas e Ingenierías, (CUCEI), Universidad de Guadalajara, Guadalajara, Jalisco, 44430, México</aff>
      <aff id="aff3"><label>‡</label>Biometrics and Statistics Unit, International Maize and Wheat Improvement Center, (CIMMYT), Apdo. Postal 6-641, Ciudad de México, 06600, México</aff>
      <aff id="aff4"><label>§</label>Colegio de Postgraduados, CP 56230, Montecillos, Edo. de México, México</aff>
      <aff id="aff5"><label>**</label>Department of Plant Sciences, Norwegian University of Life Sciences, IHA/CIGENE, P.O. Box 5003, NO-1432 Ås, Norway</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>1</label>Corresponding Authors: Biometrics and Statistics Unit, International Maize and Wheat Improvement Center (CIMMYT), Apdo. Postal 6-641, Ciudad de México, 06600, México. E-mail: <email>j.crossa@cgiar.org</email>. Departamento de Matemáticas, Centro Universitario de Ciencias Exactas e Ingenierías (CUCEI), Universidad de Guadalajara, Guadalajara, Jalisco, 44430, México. E-mail: <email>aml_uach@hotmail.com</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <fpage>1355</fpage>
    <lpage>1369</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>2</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Montesinos-López <italic>et al.</italic></copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:type="simple" xlink:href="1355.pdf"/>
    <abstract>
      <p>Evidence that genomic selection (GS) is a technology that is revolutionizing plant breeding continues to grow. However, it is very well documented that its success strongly depends on statistical models, which are used by GS to perform predictions of candidate genotypes that were not phenotyped. Because there is no universally better model for prediction and models for each type of response variable are needed (continuous, binary, ordinal, count, etc.), an active area of research aims to develop statistical models for the prediction of univariate and multivariate traits in GS. However, most of the models developed so far are for univariate and continuous (Gaussian) traits. Therefore, to overcome the lack of multivariate statistical models for genome-based prediction by improving the original version of the BMTME, we propose an improved Bayesian multi-trait and multi-environment (BMTME) R package for analyzing breeding data with multiple traits and multiple environments. We also introduce Bayesian multi-output regressor stacking (BMORS) functions that are considerably efficient in terms of computational resources. The package allows parameter estimation and evaluates the prediction performance of multi-trait and multi-environment data in a reliable, efficient and user-friendly way. We illustrate the use of the BMTME with real toy datasets to show all the facilities that the software offers the user. However, for large datasets, the BME() and BMTME() functions of the BMTME R package are very intense in terms of computing time; on the other hand, less intensive computing is required with BMORS functions BMORS() and BMORS_Env() that are also included in the BMTME package.</p>
    </abstract>
    <kwd-group>
      <kwd>multi-environment</kwd>
      <kwd>multi-trait</kwd>
      <kwd>genome-based prediction and selection</kwd>
      <kwd>R-software</kwd>
      <kwd>multivariate analysis</kwd>
      <kwd>GenPred</kwd>
      <kwd>Shared data resources</kwd>
      <kwd>Genomic Prediction</kwd>
    </kwd-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="0"/>
      <equation-count count="3"/>
      <ref-count count="47"/>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Genomic selection (GS) is a methodology used in plant breeding that was proposed by <xref rid="bib24" ref-type="bibr">Meuwissen <italic>et al.</italic> (2001)</xref>. It is a type of marker-assisted selection that consists of genotyping and phenotyping a training sample (reference population); with the help of statistical models, predictions of genomic estimated breeding values (GEBV) or phenotypic values of the testing sample (validation population) are obtained for which only genome-wide dense genetic marker data were available. GS does not depend on prior knowledge about a few, large-effect genes or QTL, since all markers are used simultaneously in the training of the statistical models. GS was first used in animal breeding (<xref rid="bib15" ref-type="bibr">Hayes and Goddard 2010</xref>), but nowadays is being implemented in many crops, for example, maize (<xref rid="bib9" ref-type="bibr">Crossa <italic>et al.</italic>, 2014</xref>), cassava (<xref rid="bib11" ref-type="bibr">de Oliveira <italic>et al.</italic>, 2012</xref>), wheat (<xref rid="bib35" ref-type="bibr">Rutkoski <italic>et al.</italic>, 2011</xref>), sugar beet (<xref rid="bib46" ref-type="bibr">Würschum <italic>et al.</italic>, 2013</xref>), tomato (<xref rid="bib47" ref-type="bibr">Yamamoto <italic>et al.</italic>, 2016</xref>), rice (<xref rid="bib38" ref-type="bibr">Spindel <italic>et al.</italic>, 2015</xref>), apple (<xref rid="bib22" ref-type="bibr">Kumar <italic>et al.</italic>, 2012</xref>), pea (<xref rid="bib3" ref-type="bibr">Burstin <italic>et al.</italic>, 2015</xref>), cranberry (<xref rid="bib8" ref-type="bibr">Covarrubias-Pazaran <italic>et al.</italic>, 2018</xref>) and many others.</p>
  <p>In recent years, an active area of research has begun to develop and improve existing statistical models for genomic selection (GS) due to the fact that successful GS implementation is strongly related to the accuracy of the predictions performed by statistical models. However, because there are no universally superior machines for prediction, many models have been proposed. For example, most of the proposed models are univariate and few are multivariate. Most of the univariate models are appropriate for continuous and Gaussian phenotypes, but there are several appropriate models for binary, ordinal and count traits. Some examples of implementations of models for non-Gaussian, non-continuous traits are unordered categorical (<xref rid="bib18" ref-type="bibr">Heuer <italic>et al.</italic>, 2016</xref>), binomial (<xref rid="bib43" ref-type="bibr">Technow and Melchinger 2013</xref>) and ordinal categorical (<xref rid="bib25" ref-type="bibr">Montesinos-López <italic>et al.</italic>, 2015a</xref>,<xref rid="bib26" ref-type="bibr">b</xref>). While multivariate models are used almost routinely nowadays, for the joint analysis of multiple-traits (<italic>e.g.</italic>, <xref rid="bib20" ref-type="bibr">Jia and Jannink 2012</xref>) as well as multiple-environments (<italic>e.g.</italic>, <xref rid="bib2" ref-type="bibr">Burgueño <italic>et al.</italic>, 2012</xref>) and even multiple populations (<italic>e.g.</italic>, <xref rid="bib31" ref-type="bibr">Olson <italic>et al.</italic>, 2012</xref>), there are few multivariate practical software programs for continuous and Gaussian phenotypes and there are scarcely any models and software for other types of response variables. To the best of our knowledge, almost none of the currently reported models consider mixed phenotypes including continuous, binary, ordinal, count, etc. traits. For this reason, it is clear that to increase the power of GS technology, it is of paramount importance to develop more models and improve the existing ones.</p>
  <p>Multi-trait models in GS have been applied by many scientists. For example, <xref rid="bib4" ref-type="bibr">Calus and Veerkamp (2011)</xref>, <xref rid="bib20" ref-type="bibr">Jia and Jannink (2012)</xref>, <xref rid="bib21" ref-type="bibr">Jiang <italic>et al.</italic> (2015)</xref>, <xref rid="bib16" ref-type="bibr">He <italic>et al.</italic> (2016)</xref>, <xref rid="bib37" ref-type="bibr">Schulthess <italic>et al.</italic> (2017)</xref>, and <xref rid="bib8" ref-type="bibr">Covarrubias-Pazaran <italic>et al.</italic> (2018)</xref> reported that multi-trait analysis outperforms uni-trait analysis in terms of prediction accuracy and that the larger the correlation between traits, the larger the benefit of multi-trait analysis. The Multi-Trait Model (MTM) of <xref rid="bib10" ref-type="bibr">de los Campos and Grüneberg (2016)</xref> is a mixed multi-trait Gaussian model under the Bayesian framework that uses a Gibbs sampler for inferences. Furthermore, Bayesian multi-output regressor stacking (BMORS) is a Bayesian version of the multi-trait regressor stacking method proposed by <xref rid="bib39" ref-type="bibr">Spyromitros-Xioufis <italic>et al.</italic> (2012</xref>; <xref rid="bib40" ref-type="bibr">2016</xref>). The training of BMORS has two stages: (1) a single univariate model is implemented using the GBLUP model, and (2) the resulting predictions are directly included by BMORS in an additional training stage. Thus, the concept of BMORS is that a second-stage model will correct the predictions of the first-stage model [using the predictions of the first-stage univariate GBLUP model (<xref rid="bib39" ref-type="bibr">Spyromitros-Xioufis <italic>et al.</italic>, 2012</xref>; <xref rid="bib40" ref-type="bibr">2016</xref>)].</p>
  <p><xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref> were the first to develop a comprehensive theory for a Bayesian multi-trait multi-environment (BMTME) model for genome-based prediction. An improved version of BMTME allows general covariance matrices by using the matrix normal distribution that facilitates easy derivation of all full conditional distributions and permits a more efficient model in terms of time of implementation <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a</xref>,<xref rid="bib29" ref-type="bibr">b</xref>,<xref rid="bib30" ref-type="bibr">c</xref>). In general, the matrix normal distribution model considerably improved in terms of implementation time over the time required by the original BMTME. Also, the Gibbs sampler for implementing the new BMTME model can be found in <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a)</xref>, and the priors of the model are given in detail in <xref rid="bib29" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018b)</xref>. <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a)</xref> provide the appropriate notations used for the matrix-variate normal distribution that is a generalization of the multivariate normal distributions to matrices. This plays a key role in building the BMTME model. The original software used by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref> to fit the BMTME was the first attempt to implement the multi-trait multi-environment theory when analyzing real data; however, the lack of the necessary optimization algorithms for efficiently applying the software made the original BMTME difficult to apply to real data.</p>
  <p>It is also important to point out that even though the existing R statistical software for Bayesian analysis like ’stan’ (<ext-link ext-link-type="uri" xlink:href="https://mc-stan.org/">https://mc-stan.org/</ext-link>) and ‘JAGS’ (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Just_another_Gibbs_sampler">https://en.wikipedia.org/wiki/Just_another_Gibbs_sampler</ext-link>) are very flexible for implementing Bayesian analysis, they are not user-friendly because the user needs a certain level of programming skills to correctly implement them (<xref rid="bib42" ref-type="bibr">Stan Development Team 2018</xref>; <xref rid="bib33" ref-type="bibr">Plummer 2018</xref>). These two software programs (stan and JAGS) also require more computational resources for their implementation since they are built not with conjugate priors. It is documented that multivariate analysis improves parameter estimation (<xref rid="bib37" ref-type="bibr">Schulthess <italic>et al.</italic>, 2017</xref>). For this reason, we agree with <xref rid="bib5" ref-type="bibr">Castro <italic>et al.</italic> (2013)</xref> and <xref rid="bib17" ref-type="bibr">Huang <italic>et al.</italic> (2015)</xref>, who stated that multi-trait analysis is a powerful tool for clarifying the relationship and the effect of each studied variable and for building more efficient prediction models.</p>
  <p>Due to the background of plant breeders, not only are new models needed, but the existing ones need to be improved. We also need reliable, efficient, user-friendly software in which breeders can implement the existing GS models. One popular R package in the context of genomic selection for continuous and ordinal data are the BGLR package of <xref rid="bib32" ref-type="bibr">Pérez and de los Campos (2014)</xref> that was built under the Bayesian framework and is very flexible because it allows the use of a genomic relationship matrix (derived from marker or pedigree), and also allows implementing various methods like BayesA, BayesB, Bayes Lasso, Bayes Ridge and GBLUP and can deal with moderate datasets; however, it only allows the implementation of univaritate models. Therefore, to contribute to this requirement, we developed a Bayesian multi-trait and multi-environment (BMTME) R software that allows the implementation of multi-trait and multi-environment data for performing parameter estimates and evaluating the prediction performance of multiple traits that are studied in many environments. This BMTME package is different from existing ones [sommer (<xref rid="bib7" ref-type="bibr">Covarrubias-Pazaran 2016</xref>), BGGE (<xref rid="bib12" ref-type="bibr">Granato <italic>et al.</italic>, 2018</xref>), ASREML (<xref rid="bib13" ref-type="bibr">Gilmour <italic>et al.</italic>, 1995</xref>) and MCMCglmm (<xref rid="bib14" ref-type="bibr">Hadfield <italic>et al.</italic>, 2010</xref>)] because it takes into account the genetic correlation between traits and between environments. The main difference of BMTME with sommer and ASREML is that our package was built under a Bayesian framework, while sommer and ASREML were based on a classical approach using restricted maximum likelihood. The difference between BGGE and our model is that our model is not only for multi-environment data but rather for multi-environment and multi-trait data simultaneously. On the other hand, the MCMCglmm package only allows a general covariance matrix for traits but not for environments, like the proposed BMTME package; however, it is important to point out that the MCMCglmm package allows modeling not only continuous responses but also binary, ordinal and counts.</p>
  <p>The main objective of this research was to illustrate the application of the new BMTME with two real toy datasets; with these we show how to use the functions available in the BMTME package for implementing multi-environment (BME function), multi-trait and multi-environment data (BMTME function), as well as the Bayesian multi-output regressor stacking functions BMORS () and BMORS_ENV (). These two functions are very different to what the existing software [sommer (<xref rid="bib7" ref-type="bibr">Covarrubias-Pazaran 2016</xref>), BGGE (<xref rid="bib12" ref-type="bibr">Granato <italic>et al.</italic>, 2018</xref>), ASREML (<xref rid="bib13" ref-type="bibr">Gilmour <italic>et al.</italic>, 1995</xref>) and MCMCglmm (<xref rid="bib14" ref-type="bibr">Hadfield <italic>et al.</italic>, 2010</xref>)] implements, since the theory behind this function is that of stacking methods. Stacking methods consist of training multiple learning algorithms for the same dataset and then combining the predictions to obtain the final predictions. In this study we used the initial BMTME of <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref> but improved it by using the matrix variate normal distribution (<xref rid="bib30" ref-type="bibr">Montesinos-López <italic>et al.</italic>, 2018c</xref>) and the appropriate priors given by <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a)</xref> and <xref rid="bib29" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018b)</xref>.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s2">
      <title>Statistical models</title>
      <sec id="s3">
        <title>Multiple-environment Genomic Best Linear Unbiased Predictor (GBLUP) model:</title>
        <p>Since genotype <inline-formula><mml:math id="me1"><mml:mo>×</mml:mo></mml:math></inline-formula> environment interaction is of paramount importance in plant breeding, the following univariate linear mixed model is often used for each trait:<disp-formula id="eq1"><mml:math id="me2"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><label>(1)</label></disp-formula>where <inline-formula><mml:math id="me3"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents the response of the <inline-formula><mml:math id="me4"><mml:mi>j</mml:mi></mml:math></inline-formula>th line in the <inline-formula><mml:math id="me5"><mml:mi>i</mml:mi></mml:math></inline-formula>th environment (<inline-formula><mml:math id="me6"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me7"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="me8"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>represents the effect of the <inline-formula><mml:math id="me9"><mml:mi>i</mml:mi></mml:math></inline-formula>th environment, <inline-formula><mml:math id="me10"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents the random genomic effect of the <inline-formula><mml:math id="me11"><mml:mi>j</mml:mi></mml:math></inline-formula>th line, with <inline-formula><mml:math id="me12"><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="me13"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is a genomic variance, <inline-formula><mml:math id="me14"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me15"><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and represents the genomic relationship matrix (GRM) and is calculated (<xref rid="bib45" ref-type="bibr">VanRaden 2008</xref>) as <inline-formula><mml:math id="me16"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me17"><mml:mi>p</mml:mi></mml:math></inline-formula> denotes the number of markers and <inline-formula><mml:math id="me18"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> is the matrix of markers of order <inline-formula><mml:math id="me19"><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>. The <inline-formula><mml:math id="me20"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi></mml:msub><mml:mi mathvariant="bold-italic"> </mml:mi></mml:mrow></mml:math></inline-formula>matrix is constructed using the observed similarity at the genomic level between lines, rather than the expected similarity based on pedigree. Further, <inline-formula><mml:math id="me21"><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the random interaction term between the genomic effect of the <inline-formula><mml:math id="me22"><mml:mi>j</mml:mi></mml:math></inline-formula>th line and the <inline-formula><mml:math id="me23"><mml:mi>i</mml:mi></mml:math></inline-formula>th environment with <inline-formula><mml:math id="me24"><mml:mrow><mml:mi mathvariant="bold-italic">gE</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>I</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me25"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is an interaction variance, and <inline-formula><mml:math id="me26"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a random residual associated with the <inline-formula><mml:math id="me27"><mml:mi>j</mml:mi></mml:math></inline-formula>th line in the <inline-formula><mml:math id="me28"><mml:mi>i</mml:mi></mml:math></inline-formula>th environment distributed as <inline-formula><mml:math id="me29"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me30"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the residual variance.</p>
      </sec>
      <sec id="s4">
        <title>Bayesian multiple-trait multiple-environment (BMTME) model:</title>
        <p>The current BMTME model was implemented by <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a</xref>,<xref rid="bib29" ref-type="bibr">b</xref>,<xref rid="bib30" ref-type="bibr">c</xref>). For a complete understanding of its description, first we provide the notations used for the matrix-variate normal distribution that plays a key role in building the BMTME model. Matrix-variate normal distribution is a generalization of the multivariate normal distribution to matrices. The (<italic>n</italic>×<italic>p</italic>) random matrix, <inline-formula><mml:math id="me31"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:math></inline-formula>, has a matrix-variate normal distribution denoted as <inline-formula><mml:math id="me32"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ω</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, if and only if, the (<italic>np</italic>×1) random vector <inline-formula><mml:math id="me33"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is distributed as multivariate normal as <inline-formula><mml:math id="me34"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mo>⊗</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ω</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; therefore, <inline-formula><mml:math id="me35"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the (<inline-formula><mml:math id="me36"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>) dimensional matrix-variate normal distribution, <inline-formula><mml:math id="me37"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula> is a (<italic>n</italic> × <italic>p</italic>) location matrix, <inline-formula><mml:math id="me38"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:math></inline-formula> is a (<inline-formula><mml:math id="me39"><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>) first covariance matrix, and <inline-formula><mml:math id="me40"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Ω</mml:mi></mml:mstyle></mml:math></inline-formula> is a (<inline-formula><mml:math id="me41"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>) second covariance matrix (<xref rid="bib41" ref-type="bibr">Srivastava and Khatri 1979</xref>). <inline-formula><mml:math id="me42"><mml:mrow><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and ⊗ are the standard vector operator and Kronecker product, respectively. Unlike in a multivariate normal model where the data are concatenated into a single vector of length <italic>np</italic>, in a matrix-variate normal model, the data <inline-formula><mml:math id="me43"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are in an <italic>n</italic>×<italic>p</italic> matrix where each column is a trait (<xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic>, 2018a</xref>). Therefore, the proposed BMTME model is defined as follows:<disp-formula id="eq2"><mml:math id="me44"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Xβ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">E</mml:mi></mml:math><label>(2)</label></disp-formula>where <inline-formula><mml:math id="me46"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me47"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="me48"><mml:mi>L</mml:mi></mml:math></inline-formula> the number of traits and <inline-formula><mml:math id="me49"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me50"><mml:mi>J</mml:mi></mml:math></inline-formula> denotes the number of lines and <inline-formula><mml:math id="me51"><mml:mi>I</mml:mi></mml:math></inline-formula> the number of environments, <inline-formula><mml:math id="me52"><mml:mi mathvariant="bold-italic">X</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me53"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me54"><mml:mi mathvariant="bold-italic">β</mml:mi></mml:math></inline-formula> is of order <inline-formula><mml:math id="me55"><mml:mrow><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, since <inline-formula><mml:math id="me56"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="me57"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="me58"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="me59"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me60"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me61"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me62"><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and contains the genotype <inline-formula><mml:math id="me63"><mml:mo>×</mml:mo></mml:math></inline-formula> trait interaction term since <inline-formula><mml:math id="me64"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me65"><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the effect of the genotype <inline-formula><mml:math id="me66"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> trait interaction term for <inline-formula><mml:math id="me67"><mml:mrow><mml:mtext>l</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and for <inline-formula><mml:math id="me68"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>.<inline-formula><mml:math id="me69"><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me70"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me71"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me72"><mml:mrow><mml:mi>I</mml:mi><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and contains the genotype <inline-formula><mml:math id="me73"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> environment <inline-formula><mml:math id="me74"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> trait interaction, since <inline-formula><mml:math id="me75"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me76"><mml:mrow><mml:mi>g</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the effect of genotype <inline-formula><mml:math id="me77"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> environment <inline-formula><mml:math id="me78"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> trait interaction for <inline-formula><mml:math id="me79"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="me80"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and for <inline-formula><mml:math id="me81"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. Vector <inline-formula><mml:math id="me82"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>is distributed under a matrix-variate normal distribution as <inline-formula><mml:math id="me83"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="me84"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is of order <inline-formula><mml:math id="me85"><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and represents the Genomic Relationship Matrix (GRM) and is calculated using the <xref rid="bib45" ref-type="bibr">VanRaden (2008)</xref> method as <inline-formula><mml:math id="me86"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me87"><mml:mi>p</mml:mi></mml:math></inline-formula> denotes the number of markers and <inline-formula><mml:math id="me88"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> the matrix of markers of order <inline-formula><mml:math id="me89"><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>; and <inline-formula><mml:math id="me90"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unstructured genetic (co)variance matrix of traits of order <inline-formula><mml:math id="me91"><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="me92"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me93"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mi>E</mml:mi></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>is an unstructured (co)variance matrix of order <inline-formula><mml:math id="me94"><mml:mrow><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="me95"><mml:mi mathvariant="bold-italic">E</mml:mi></mml:math></inline-formula> is the matrix of residuals of order <inline-formula><mml:math id="me96"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="me97"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">0</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="me98"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unstructured residual (co)variance matrix of traits of order <inline-formula><mml:math id="me99"><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="me100"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the genomic relationship matrix described above (<xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic>, 2018a</xref>). The BMTME model resulting from equation (2) was implemented by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref>.</p>
        <p>Next, we used the modified version of the Gibbs sampler of the original BMTME model proposed by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref> that was implemented in <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a)</xref>. It is important to point out that model (2) takes into account the genotype <inline-formula><mml:math id="me101"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> environment terms in the (<inline-formula><mml:math id="me102"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> term and, for comparison purposes, we also ran the model in equation (2) but without the (<inline-formula><mml:math id="me103"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> term to study the effect on prediction performance with and without the genotype <inline-formula><mml:math id="me104"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> environment term. The Gibbs sampler for implementing the BMTME model is found in <xref rid="bib28" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018a)</xref>, and the priors of this model are given in detail in <xref rid="bib29" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018b)</xref>. The concept of the matrix variate normal distribution is given in <xref rid="bib30" ref-type="bibr">Montesinos-López <italic>et al.</italic> (2018c)</xref>.</p>
      </sec>
      <sec id="s5">
        <title>Bayesian multi-output regressor stacking (BMORS):</title>
        <p>The proposed BMORS is a Bayesian version of the multi-trait regressor stacking method proposed by <xref rid="bib39" ref-type="bibr">Spyromitros-Xioufis <italic>et al.</italic> (2012</xref>; <xref rid="bib40" ref-type="bibr">2016</xref>). The training of BMORS consists of two stages. In the first stage, <inline-formula><mml:math id="me105"><mml:mi>L</mml:mi></mml:math></inline-formula> single univariate models are implemented using the GBLUP model given in equation (1), but instead of using the resulting predictions directly as the final output, the BMORS includes an additional training stage where a second set of <inline-formula><mml:math id="me106"><mml:mi>L</mml:mi></mml:math></inline-formula> meta-models are implemented for each of the <inline-formula><mml:math id="me107"><mml:mi>L</mml:mi></mml:math></inline-formula> traits under study. Each meta-model is implemented with the following model:<disp-formula id="eq3"><mml:math id="me108"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><label>(3)</label></disp-formula>where the covariates <inline-formula><mml:math id="me109"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represent the scaled predictions of each trait obtained with the GBLUP model in the first-stage analysis, and <inline-formula><mml:math id="me110"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the beta coefficients for each covariate. The scaling of each prediction was performed by subtracting its mean (<inline-formula><mml:math id="me111"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) and dividing by its corresponding standard deviation (<inline-formula><mml:math id="me112"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), that is, <inline-formula><mml:math id="me113"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>=<inline-formula><mml:math id="me114"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, for each <inline-formula><mml:math id="me115"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. Therefore, the BMORS model contains as predictor information the scaled predictions of its response variables yielded by the first-stage models. In other words, the BMORS model is based on the idea that a second-stage model is able to correct the predictions of a first-stage model using information about the predictions of other first-stage models (<xref rid="bib39" ref-type="bibr">Spyromitros-Xioufis <italic>et al.</italic>, 2012</xref>; <xref rid="bib40" ref-type="bibr">2016</xref>).</p>
      </sec>
    </sec>
    <sec id="s6">
      <title>Real toy datasets</title>
      <sec id="s7">
        <title>Mada dataset:</title>
        <p>This dataset was obtained from the study by <xref rid="bib1" ref-type="bibr">Ben Hassen <italic>et al.</italic> (2018)</xref>. The dataset is composed of a sample of 188 wheat lines evaluated for six traits. Each of the lines was evaluated in one environment. The lines were genotyped and 32,066 single nucleotide polymorphisms (SNPs) were obtained with a heterozygosity rate &lt; 5% and a minor allele frequency (MAF) &gt; 5%. A subset of the data were included in the package that includes 30 lines, and we named this dataset Mada. For more details, see the study by <xref rid="bib1" ref-type="bibr">Ben Hassen <italic>et al.</italic> (2018)</xref>. Raw markers are not included, and we provide the genomic relationship matrix (GRM) calculated according to the method of <xref rid="bib45" ref-type="bibr">VanRaden (2008)</xref>.</p>
      </sec>
      <sec id="s8">
        <title>Maize dataset:</title>
        <p>This dataset was obtained from the study by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref>. It consists of a sample of 309 maize lines evaluated for three traits: anthesis-silking interval (ASI), plant height (PH), and grain yield (GY). Each trait was evaluated in three optimal environments (Env1, Env2 and Env3). The lines were genotyped, 681,257 single nucleotide polymorphisms (SNPs) were obtained, and markers with more than 20% missing values were removed. After that, markers were imputed using observed allelic frequencies, and markers with MAF &lt; 0.05 were removed, so that at the end of the quality control and imputation, 158,281 SNPs were still available for further analyses. To load this dataset in the package, we used only 30 lines, and we named this dataset Maize. For more details, see the study by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref>.</p>
      </sec>
    </sec>
    <sec id="s9">
      <title>Evaluation of prediction performance</title>
      <p>We implemented cross-validation (CV) to evaluate the prediction performance. Two types of CV were implemented: K-fold cross-validation and random cross-validation.</p>
      <sec id="s10">
        <title>K-fold cross-validation:</title>
        <p>Under this CV, the dataset was partitioned into K subsamples of equal size; each time K-1 of them were used for training (TRN) and the remaining one for testing (TST). In this CV, one observation cannot appear in more than one fold. In the design, some lines can be evaluated in some, but not all, target environments, which mimics a prediction problem faced by breeders in incomplete field trials. This CV strategy is exactly the same as the strategy denoted as CV2 that was proposed and implemented by <xref rid="bib19" ref-type="bibr">Jarquín <italic>et al.</italic> (2017)</xref>, where a certain portion of test lines (genotypes) in a certain portion of test environments is predicted, since some test lines that were evaluated in some test environments are assumed to be missing in others.</p>
      </sec>
      <sec id="s11">
        <title>Random cross-validation:</title>
        <p>This CV strategy randomly splits the dataset into training (TRN) and testing data (TST). For each such split, the model is fitted to the TRN data, and predictive accuracy is assessed using the TST data. Since we used sampling with replacement, one observation may appear in more than one partition. The implemented CV mimics a prediction problem faced by breeders in incomplete field trials, where some lines may be evaluated in some, but not all, target environments. Since <inline-formula><mml:math id="me116"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> denotes the total number of records per each available trait, then to select lines in the TST dataset, we fixed the percentage of data to be used for TST [PTesting]. Then PTesting<inline-formula><mml:math id="me117"><mml:mrow><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> (lines) were chosen at random, and subsequently for each of these lines, one environment was randomly picked from <inline-formula><mml:math id="me118"><mml:mi>I</mml:mi></mml:math></inline-formula> environments. The cells selected through this algorithm were allocated to the TST dataset, while the cells (<inline-formula><mml:math id="me119"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that were not selected were assigned to the TRN dataset. Lines were sampled with replacement if <inline-formula><mml:math id="me120"><mml:mrow><mml:mi>J</mml:mi><mml:mo>&lt;</mml:mo><mml:mtext>PTesting</mml:mtext><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and without replacement otherwise (<xref rid="bib23" ref-type="bibr">López-Cruz <italic>et al.</italic>, 2015</xref>). The metrics used to measure the prediction accuracy under both CV strategies were Pearson’s correlation and the mean arctan absolute percentage error (MAAPE), which has the advantage that no zero estimates are produced when the response variable contains many zeros. They were calculated from each trait-environment combination for each of the testing sets and the average of all random partitions (folds) is reported as a measure of prediction performance.</p>
      </sec>
    </sec>
    <sec sec-type="data-availability" id="s12">
      <title>Data availability</title>
      <p>The data used in this study are included in the BMTME package, so once that package is installed, the datasets can be loaded into the R environment.</p>
    </sec>
    <sec id="s13">
      <title>Installation of the BMTME package</title>
      <p>The aim of this section is to illustrate the use of the R BMTME package for analyzing multi-environment and multi-trait and multi-environment data from plant breeding programs. The BMTME package was built following the paper by <xref rid="bib27" ref-type="bibr">Montesinos-Lopez <italic>et al.</italic> (2016)</xref> and implemented in the R statistical software (<xref rid="bib34" ref-type="bibr">R Core Team 2018</xref>).</p>
      <p>The development version of the BMTME package can be installed directly from the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/frahik/BMTME">https://github.com/frahik/BMTME</ext-link>). In order to install the package, it is necessary to install the appropriate compilers; the installation process and the required tools depend heavily on the operating system. For example, in Windows it is necessary to install Rtools (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/windows/Rtools/">https://cran.r-project.org/bin/windows/Rtools/</ext-link>), and in modern versions of macOS, it is necessary to install XCode from App Store or the development tools for R from CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/macosx/tools/">https://cran.r-project.org/bin/macosx/tools/</ext-link>). In the case of Linux, it is necessary to install the C++ compilers included in your distribution, for example, g++ from GNU (<ext-link ext-link-type="uri" xlink:href="https://www.gnu.org">https://www.gnu.org</ext-link>). Once the tools have been installed, use the following command to install the package within your R session:</p>
      <list list-type="simple" id="L1">
        <list-item>
          <p>install.packages(′devtools′)</p>
        </list-item>
        <list-item>
          <p>devtools::install_github(′frahik/BMTME′)</p>
        </list-item>
      </list>
      <p>You can also find the package in the CRAN repository, and you can use the following command (see below) to install a version of the package from CRAN. This will avoid the need to install some dependencies manually and install the Rtools software using the following command:</p>
      <list list-type="simple" id="L2">
        <list-item>
          <p>install.packages(′BMTME′)</p>
        </list-item>
      </list>
      <p>The R package BMTME is available at the following link: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/BMTME/index.html">https://cran.r-project.org/web/packages/BMTME/index.html</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s14">
    <title>Results</title>
    <p>The results are given in three main sections. The first section illustrates the use of the BME function for implementing multi-environment analysis, while the second and the third sections illustrate the use of the BMTME and BMORs functions for implementing multi-trait and multi-environment analyses.</p>
    <sec id="s15">
      <title>The BME Function</title>
      <p>This example illustrates how to fit a model when there is only one environment and several dependent variables. First, we load the library:</p>
      <list list-type="simple" id="L3">
        <list-item>
          <p>library(BMTME)</p>
        </list-item>
      </list>
      <p>Then we load the Mada dataset:</p>
      <list list-type="simple" id="L4">
        <list-item>
          <p>data(“WheatMadaToy”)</p>
        </list-item>
      </list>
      <p>Then we define the model to be adjusted; since the dataset only includes an environment where several dependent variables were evaluated, the BME model is used. To implement it, first we need to order the dataset as follows:</p>
      <list list-type="simple" id="L5">
        <list-item>
          <p>phenoMada &lt;- (phenoMada[order(phenoMada$GID),])</p>
        </list-item>
        <list-item>
          <p>rownames(phenoMada)=1:nrow(phenoMada)</p>
        </list-item>
        <list-item>
          <p>head(phenoMada)</p>
        </list-item>
        <list-item>
          <p>GID PH FL FE NS SY NP</p>
        </list-item>
        <list-item>
          <p>1 9 29.7776 -8.8882 -4.93900 1.04100 169.06 28.8025</p>
        </list-item>
        <list-item>
          <p>2 11 3.2210 -7.1111 -0.36940 -3.88940 -107.19 58.2516</p>
        </list-item>
        <list-item>
          <p>3 12 6.1670 -9.5337 -12.43680 2.58250 -160.54 17.1278</p>
        </list-item>
        <list-item>
          <p>4 15 6.8117 4.6377 11.78860 -0.03378 235.70 -19.6571</p>
        </list-item>
        <list-item>
          <p>5 20 -14.4480 3.2525 6.40780 -14.23460 131.87 42.2962</p>
        </list-item>
        <list-item>
          <p>6 21 -13.2185 3.8902 0.09722 5.35680 164.06 36.8239</p>
        </list-item>
      </list>
      <p>This is a very important step in the analysis, because if the dataset is not ordered correctly, this may cause conflicts and produce incorrect estimations. Also, with the head() function we printed the phenotypic dataset, where the required format of the dataset requires a first column with the identifiers of the lines and then the names of all the traits. It is important to respect this format to be able to successfully implement the multi-environment (trait) datasets.</p>
      <p>Then, the design matrix for the genetic effects should be generated, as shown below.</p>
      <list list-type="simple" id="L6">
        <list-item>
          <p>LG &lt;- cholesky(genoMada)</p>
        </list-item>
        <list-item>
          <p>ZG &lt;- model.matrix(∼0 + as.factor(phenoMada$GID))</p>
        </list-item>
        <list-item>
          <p>Z.G &lt;- ZG %*% LG</p>
        </list-item>
      </list>
      <p>Then, we can extract the phenotypic responses that were converted to matrix object as shown in the following command:</p>
      <list list-type="simple" id="L7">
        <list-item>
          <p>Y &lt;- as.matrix(phenoMada[, -c(1)])</p>
        </list-item>
      </list>
      <p>Finally, the model was adjusted, and 30,000 iterations were used to adjust the model.</p>
      <list list-type="simple" id="L8">
        <list-item>
          <p>fm &lt;- BME(<underline>Y =</underline> Y, <underline>Z1 =</underline> Z.G, <underline>nIter =</underline> 30000, <underline>burnIn =</underline> 20000, <underline>thin =</underline> 2, <underline>bs =</underline> 50)</p>
        </list-item>
      </list>
      <p>It is important to point out that bs is the block size for sampling from posterior distributions; we suggest using a value of at least 50 but less than 1000.</p>
      <p>Next we used the names() function to identify all the available outputs of the fitted model.</p>
      <list list-type="simple" id="L9">
        <list-item>
          <p>names(fm)</p>
        </list-item>
        <list-item>
          <p>[1] “Y” “nIter” “burnIn” “thin” “dfe”</p>
        </list-item>
        <list-item>
          <p>[6] “Se” “yHat” “SD.yHat” “beta” “SD.beta”</p>
        </list-item>
        <list-item>
          <p>[11] “b1” “SD.b1” “vare” “SD.vare” “varTrait”</p>
        </list-item>
        <list-item>
          <p>[16] “SD.varTrait” “NAvalues”</p>
        </list-item>
      </list>
      <p>Here we extracted the observed values ($Y), the predicted values ($yHat), the parameters provided for the model fit ($nIter, $burnIn, $thin, etc.), the estimates of the beta coefficients, random effects of lines and the genetic and residual covariances ($beta, $SD.beta, $b1, $SD.b1, $varTrait, $vare, etc.). Next we show how to extract the predicted values:</p>
      <list list-type="simple" id="L10">
        <list-item>
          <p>head(fm$yHat)</p>
        </list-item>
        <list-item>
          <p>PH FL FE NS SY NP</p>
        </list-item>
        <list-item>
          <p>[1,] 13.4602 -4.6073 2.2247 -5.2839 -161.7740 28.9334</p>
        </list-item>
        <list-item>
          <p>[2,] 4.6792 -2.7261 2.3857 -3.3243 -89.1425 29.2848</p>
        </list-item>
        <list-item>
          <p>[3,] 3.0779 -2.0297 0.1369 -3.2161 -91.4642 11.7453</p>
        </list-item>
        <list-item>
          <p>[4,] 5.2408 1.6600 5.6141 1.6136 60.2424 -23.3492</p>
        </list-item>
        <list-item>
          <p>[5,] -5.1899 1.0555 1.8783 -3.0015 49.6383 11.7256</p>
        </list-item>
        <list-item>
          <p>[6,] -9.8591 1.2399 0.5886 3.4539 88.8181 26.9665</p>
        </list-item>
      </list>
      <p>We also extracted the genetic covariance between traits, as shown below:</p>
      <list list-type="simple" id="L11">
        <list-item>
          <p>COV_TraitGenetic &lt;- fm$varTrait</p>
        </list-item>
        <list-item>
          <p>COV_TraitGenetic</p>
        </list-item>
        <list-item>
          <p>PH FL FE NS SY NP</p>
        </list-item>
        <list-item>
          <p>[1,] 64.4266 -4.2148 6.3730 -0.0049 -103.8781 -114.4456</p>
        </list-item>
        <list-item>
          <p>[2,] -4.2148 5.9607 3.2257 -0.1355 175.7770 -21.0909</p>
        </list-item>
        <list-item>
          <p>[3,] 6.3730 3.2257 23.8617 1.3721 -133.4962 -43.6292</p>
        </list-item>
        <list-item>
          <p>[4,] -0.0049 -0.1355 1.3721 46.2903 370.1770 -59.0136</p>
        </list-item>
        <list-item>
          <p>[5,] -103.8781 175.7770 -133.4962 370.1770 27963.1634 604.6203</p>
        </list-item>
        <list-item>
          <p>[6,] -114.4456 -21.0909 -43.6292 -59.0136 604.6203 872.3525</p>
        </list-item>
      </list>
      <p>To convert this covariance matrix into a correlation matrix, we suggest using the following command:</p>
      <list list-type="simple" id="L12">
        <list-item>
          <p>COR_TraitGenetic &lt;- cov2cor(COV_TraitGenetic)</p>
        </list-item>
        <list-item>
          <p>COR_TraitGenetic</p>
        </list-item>
        <list-item>
          <p>PH FL FE NS SY NP</p>
        </list-item>
        <list-item>
          <p>[1,] 1.000000e+00 -0.215077873 0.16254014 -8.972603e-05 -0.07739239 -0.4827480</p>
        </list-item>
        <list-item>
          <p>[2,] -2.150779e-01 1.000000000 0.27047346 -8.157286e-03 0.43054670 -0.2924829</p>
        </list-item>
        <list-item>
          <p>[3,] 1.625401e-01 0.270473457 1.00000000 4.128479e-02 -0.16342747 -0.3023991</p>
        </list-item>
        <list-item>
          <p>[4,] -8.972603e-05 -0.008157286 0.04128479 1.000000e+00 0.32536534 -0.2936710</p>
        </list-item>
        <list-item>
          <p>[5,] -7.739239e-02 0.430546701 -0.16342747 3.253653e-01 1.00000000 0.1224175</p>
        </list-item>
        <list-item>
          <p>[6,] -4.827480e-01 -0.292482897 -0.30239914 -2.936710e-01 0.12241752 1.0000000</p>
        </list-item>
      </list>
      <p>Here there are no high correlations (<italic>i.e.</italic>, greater than 0.5). In a similar way, we obtained the residual covariance matrix:</p>
      <list list-type="simple" id="L13">
        <list-item>
          <p>COV_ResGenetic &lt;- fm$vare</p>
        </list-item>
        <list-item>
          <p>COV_ResGenetic</p>
        </list-item>
        <list-item>
          <p>PH FL FE NS SY NP</p>
        </list-item>
        <list-item>
          <p>[1,] 65.2173 -2.7253 -12.3196 20.9669 880.3571 -71.9332</p>
        </list-item>
        <list-item>
          <p>[2,] -2.7253 11.6654 10.6847 -7.8144 182.0011 -10.3907</p>
        </list-item>
        <list-item>
          <p>[3,] -12.3196 10.6847 40.1432 -20.4498 -436.0834 -31.4401</p>
        </list-item>
        <list-item>
          <p>[4,] 20.9669 -7.8144 -20.4498 54.0458 375.0032 -70.7700</p>
        </list-item>
        <list-item>
          <p>[5,] 880.3571 182.0011 -436.0834 375.0032 60960.1184 2058.4876</p>
        </list-item>
        <list-item>
          <p>[6,] -71.9332 -10.3907 -31.4401 -70.7700 2058.4876 670.1587</p>
        </list-item>
      </list>
      <p>For demonstration purposes, we will only extract the first 6 predictions for the 6 evaluated traits. We also plotted the observed values against the predicted values for each trait, as follows (see <xref ref-type="fig" rid="fig1">Figure 1</xref>):</p>
      <fig id="fig1" fig-type="figure" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Observed and predicted values for trait FL resulting from fitting the model with the BME function to the Mada dataset.</p>
        </caption>
        <graphic xlink:href="1355f1"/>
      </fig>
      <list list-type="simple" id="L14">
        <list-item>
          <p>plot(fm, trait = ′FL′)</p>
        </list-item>
      </list>
      <p>Since the code provided above is only appropriate for parameter estimation, now we provide the code required to evaluate the prediction accuracy using the BME() function. For this reason, first we built the random CV strategy with 10 random partitions, each with TRN = 80% and TST = 20%, using the following code:</p>
      <list list-type="simple" id="L15">
        <list-item>
          <p>pheno &lt;- data.frame(GID = phenoMada[, 1], Response = phenoMada[, 2])</p>
        </list-item>
        <list-item>
          <p>CrossV &lt;- CV.RandomPart(pheno, NPartitions = 10, PTesting = 0.2, set_seed = 123)</p>
        </list-item>
        <list-item>
          <p>Finally, we implemented the CV strategy as:</p>
        </list-item>
        <list-item>
          <p>pm &lt;- BME(Y = Y, Z1 = Z.G, nIter = 1250, burnIn = 500, thin = 2, bs = 50, testingSet = CrossV)</p>
        </list-item>
      </list>
      <p>In the summary we show the average predictions of the 10 random partitions implemented under average Pearson's correlation (APC) and MAAPE:</p>
      <list list-type="simple" id="L16">
        <list-item>
          <p>summary(pm)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Pearson SE_Pearson MAAPE SE_MAAPE</p>
        </list-item>
        <list-item>
          <p>1 FE 0.3895 0.0847 0.7264 0.0313</p>
        </list-item>
        <list-item>
          <p>2 FL 0.1758 0.0767 0.7751 0.0248</p>
        </list-item>
        <list-item>
          <p>3 NP 0.3920 0.1192 0.7070 0.0347</p>
        </list-item>
        <list-item>
          <p>4 NS 0.4281 0.0879 0.7604 0.0364</p>
        </list-item>
        <list-item>
          <p>5 PH 0.5612 0.0767 0.7285 0.0542</p>
        </list-item>
        <list-item>
          <p>6 SY 0.0242 0.0623 0.7436 0.0255</p>
        </list-item>
      </list>
      <p>Here we see that the best prediction in terms of APC was found in trait PH (0.5612), while the worst was in trait SY (0.0242). However, in terms of MAAPE, the best prediction was observed in trait NP (0.7070), while the worst was found in trait FL (0.7751). With the boxplot(pm) function, we created a plot summarizing the predictions in terms of Pearson’s correlation, but if users want this plot in MAAPE terms, they need to use the following code: boxplot(pm, select=“MAAPE”) (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p>
      <fig id="fig2" fig-type="figure" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Boxplot of Pearson’s correlation of the testing sets for each trait of the Mada data-set.</p>
        </caption>
        <graphic xlink:href="1355f2"/>
      </fig>
      <list list-type="simple" id="L17">
        <list-item>
          <p>boxplot(pm)</p>
        </list-item>
      </list>
      <p>It is important to point out that the BME function can be used with only 1 testing set that can be defined by the user, as shown in the following example:</p>
      <list list-type="simple" id="L18">
        <list-item>
          <p>CrossV1 &lt;-sample(nrow(Y),15)</p>
        </list-item>
        <list-item>
          <p>pm &lt;- BME(Y = Y, Z1 = Z.G, nIter = 1250, burnIn = 500, thin = 2, bs = 50,testingSet = CrossV1)</p>
        </list-item>
      </list>
      <p>Next we summarize the prediction accuracy:</p>
      <list list-type="simple" id="L19">
        <list-item>
          <p>summary(pm)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Pearson SE_Pearson MAAPE SE_MAAPE</p>
        </list-item>
        <list-item>
          <p>1 NA FE 0.1181 NaN 0.7765 NaN</p>
        </list-item>
        <list-item>
          <p>2 NA FL -0.1222 NaN 0.8207 NaN</p>
        </list-item>
        <list-item>
          <p>3 NA NP 0.6937 NaN 0.6813 NaN</p>
        </list-item>
        <list-item>
          <p>4 NA NS 0.4636 NaN 0.7098 NaN</p>
        </list-item>
        <list-item>
          <p>5 NA PH 0.7362 NaN 0.7949 NaN</p>
        </list-item>
        <list-item>
          <p>6 NA SY -0.0079 NaN 0.8251 NaN</p>
        </list-item>
      </list>
      <p>Since only one training set and one testing set were used, the standard errors for both metrics appear with NaN, given that it is not possible to calculate the standard error because only one testing set is available.</p>
    </sec>
    <sec id="s16">
      <title>The Bayesian Multi-Trait and Multi-Environment (BMTME) function</title>
      <p>This example illustrates how to fit a model with multiple traits and multiple environments. To do this, use the Maize dataset; first, load the data using the following function:</p>
      <list list-type="simple" id="L20">
        <list-item>
          <p>data(“MaizeToy”)</p>
        </list-item>
      </list>
      <p>Next, order the dataset, rename the rows of the phenotypic dataset and print the first six observations of the data in order to see the structure required of the data, which consists of a first column that includes the lines, a second column that includes the environments and third, fourth and fifth columns that correspond to the traits under study.</p>
      <list list-type="simple" id="L21">
        <list-item>
          <p>phenoMaizeToy&lt;-(phenoMaizeToy[order(phenoMaizeToy$Env,phenoMaizeToy$Line),])</p>
        </list-item>
        <list-item>
          <p>rownames(phenoMaizeToy)=1:nrow(phenoMaizeToy)</p>
        </list-item>
        <list-item>
          <p>head(phenoMaizeToy)</p>
        </list-item>
        <list-item>
          <p>Line Env Yield ASI PH</p>
        </list-item>
        <list-item>
          <p>1 CKDHL0008 EBU 6.88 2.7 226</p>
        </list-item>
        <list-item>
          <p>2 CKDHL0039 EBU 6.85 1.3 239</p>
        </list-item>
        <list-item>
          <p>3 CKDHL0042 EBU 6.37 2.3 238</p>
        </list-item>
        <list-item>
          <p>4 CKDHL0050 EBU 4.98 3.1 239</p>
        </list-item>
        <list-item>
          <p>5 CKDHL0060 EBU 7.07 1.4 242</p>
        </list-item>
        <list-item>
          <p>6 CKDHL0063 EBU 8.62 2.3 250</p>
        </list-item>
        <list-item>
          <p>7 CKDHL0069 EBU 5.16 1.0 248</p>
        </list-item>
        <list-item>
          <p>8 CKDHL0072 EBU 5.77 1.7 227</p>
        </list-item>
      </list>
      <p>This step is very important for avoiding an incorrect estimation process. Then the design matrices for the line effects, the environment and the genotype<inline-formula><mml:math id="me121"><mml:mo>×</mml:mo></mml:math></inline-formula>environment interaction are generated:</p>
      <list list-type="simple" id="L22">
        <list-item>
          <p>LG &lt;- cholesky(genoMaizeToy)</p>
        </list-item>
        <list-item>
          <p>ZG &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Line))</p>
        </list-item>
        <list-item>
          <p>Z.G &lt;- ZG %*% LG</p>
        </list-item>
        <list-item>
          <p>Z.E &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Env))</p>
        </list-item>
        <list-item>
          <p>ZEG &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Line):as.factor(phenoMaizeToy$Env))</p>
        </list-item>
        <list-item>
          <p>G2 &lt;- kronecker(diag(length(unique(phenoMaizeToy$Env))), data.matrix(genoMaizeToy))</p>
        </list-item>
        <list-item>
          <p>LG2 &lt;- cholesky(G2)</p>
        </list-item>
        <list-item>
          <p>Z.EG &lt;- ZEG %*% LG2</p>
        </list-item>
        <list-item>
          <p>Y &lt;- as.matrix(phenoMaizeToy[, -c(1, 2)])</p>
        </list-item>
      </list>
      <p>Finally, the following command is used to fit the model:</p>
      <list list-type="simple" id="L23">
        <list-item>
          <p>fm &lt;- BMTME(Y = Y, X = Z.E, Z1 = Z.G, Z2 = Z.EG, nIter =15000, burnIn =10000, thin = 2,bs = 50)</p>
        </list-item>
      </list>
      <p>We used the names() function to see all the things that can be extracted after fitting a model with the BMTME function.</p>
      <list list-type="simple" id="L24">
        <list-item>
          <p>names(fm)</p>
        </list-item>
        <list-item>
          <p>[1] “Y” “nIter” “burnIn” “thin” “dfe” “Se” “yHat” [8] “SD.yHat” “beta” “SD.beta” “b1” “b2” “vare” “SD.vare”</p>
        </list-item>
        <list-item>
          <p>[15] “varEnv” “SD.varEnv” “varTrait” “SD.varTrait” “NAvalues”</p>
        </list-item>
      </list>
      <p>We can extract the predicted and observed values, the random effects of lines, of lines<inline-formula><mml:math id="me122"><mml:mo>×</mml:mo></mml:math></inline-formula>trait, lines<inline-formula><mml:math id="me123"><mml:mo>×</mml:mo></mml:math></inline-formula>environment<inline-formula><mml:math id="me124"><mml:mo>×</mml:mo></mml:math></inline-formula>trait, as well as the genetic covariances between traits and environments, and the residual covariance between traits. To extract the matrix of covariances between traits, we used the following:</p>
      <list list-type="simple" id="L25">
        <list-item>
          <p>COV_TraitGenetic &lt;- fm$varTrait</p>
        </list-item>
        <list-item>
          <p>COV_TraitGenetic</p>
        </list-item>
        <list-item>
          <p>Yield ASI PH</p>
        </list-item>
        <list-item>
          <p>[1,] 0.0956 -0.0027 0.9642</p>
        </list-item>
        <list-item>
          <p>[2,] -0.0027 0.0654 0.1893</p>
        </list-item>
        <list-item>
          <p>[3,] 0.9642 0.1893 23.0647</p>
        </list-item>
      </list>
      <p>To convert this covariance matrix between traits into a correlation matrix, we used the following command:</p>
      <list list-type="simple" id="L26">
        <list-item>
          <p>COR_TraitGenetic &lt;- cov2cor(COV_TraitGenetic)</p>
        </list-item>
        <list-item>
          <p>COR_TraitGenetic</p>
        </list-item>
        <list-item>
          <p>Yield ASI PH</p>
        </list-item>
        <list-item>
          <p>[1,] 1.00000000 -0.03414648 0.6493282</p>
        </list-item>
        <list-item>
          <p>[2,] -0.03414648 1.00000000 0.1541302</p>
        </list-item>
        <list-item>
          <p>[3,] 0.64932822 0.15413023 1.0000000</p>
        </list-item>
      </list>
      <p>Next we show how to extract the matrix of genetic covariance between the environments.</p>
      <list list-type="simple" id="L27">
        <list-item>
          <p>COV_EnvGenetic &lt;- fm$varEnv</p>
        </list-item>
        <list-item>
          <p>COV_EnvGenetic</p>
        </list-item>
        <list-item>
          <p>EBU KAK KTI</p>
        </list-item>
        <list-item>
          <p>[1,] 308.6270 258.9984 285.3723</p>
        </list-item>
        <list-item>
          <p>[2,] 258.9984 237.9283 264.3881</p>
        </list-item>
        <list-item>
          <p>[3,] 285.3723 264.3881 324.4536</p>
        </list-item>
      </list>
      <p>Finally, we show how to extract the residual covariance matrix between traits.</p>
      <list list-type="simple" id="L28">
        <list-item>
          <p>COV_ResGenetic &lt;- fm$vare</p>
        </list-item>
        <list-item>
          <p>COV_ResGenetic</p>
        </list-item>
        <list-item>
          <p>Yield ASI PH</p>
        </list-item>
        <list-item>
          <p>[1,] 0.5282 -0.0955 3.3701</p>
        </list-item>
        <list-item>
          <p>[2,] -0.0955 0.4837 -1.5896</p>
        </list-item>
        <list-item>
          <p>[3,] 3.3701 -1.5896 106.5525</p>
        </list-item>
      </list>
      <p>The observed and predicted values of each trait can be plotted using the following plot(), function (<xref ref-type="fig" rid="fig3">Figure 3</xref>):</p>
      <fig id="fig3" fig-type="figure" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Observed and predicted values for trait Yield resulting from fitting the model with the BMTME function to the Maize dataset.</p>
        </caption>
        <graphic xlink:href="1355f3"/>
      </fig>
      <list list-type="simple" id="L29">
        <list-item>
          <p>plot(fm, trait=′Yield′)</p>
        </list-item>
      </list>
      <p>We provide the corresponding code for the fivefold CV strategy and its implementation with the BMTME function:</p>
      <list list-type="simple" id="L30">
        <list-item>
          <p>pheno &lt;- data.frame(GID = phenoMaizeToy[, 1], Env = phenoMaizeToy[, 2], Response = phenoMaizeToy[, 3])</p>
        </list-item>
        <list-item>
          <p>CrossV &lt;- CV.KFold(pheno, DataSetID = ′GID′, K = 5, set_seed = 123)</p>
        </list-item>
        <list-item>
          <p>pm &lt;- BMTME(Y = Y, X = Z.E, Z1 = Z.G, Z2 = Z.EG, nIter = 1250, burnIn = 500, thin = 2,bs = 50, testingSet = CrossV)</p>
        </list-item>
      </list>
      <p>With the summary we obtained the average predictions in terms of Pearson’s correlation and MAAPE for each trait <inline-formula><mml:math id="me125"><mml:mo>×</mml:mo></mml:math></inline-formula> environment combination.</p>
      <list list-type="simple" id="L31">
        <list-item>
          <p>summary(pm)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Pearson SE_Pearson MAAPE SE_MAAPE</p>
        </list-item>
        <list-item>
          <p>1 EBU ASI 0.4136 0.1997 0.3128 0.0369</p>
        </list-item>
        <list-item>
          <p>2 EBU PH 0.2141 0.1227 0.0553 0.0054</p>
        </list-item>
        <list-item>
          <p>3 EBU Yield 0.1064 0.2358 0.1554 0.0153</p>
        </list-item>
        <list-item>
          <p>4 KAK ASI 0.1711 0.3141 0.5771 0.0375</p>
        </list-item>
        <list-item>
          <p>5 KAK PH 0.5918 0.1907 0.0462 0.0097</p>
        </list-item>
        <list-item>
          <p>6 KAK Yield 0.6233 0.1642 0.1161 0.0162</p>
        </list-item>
        <list-item>
          <p>7 KTI ASI 0.0064 0.1436 0.3421 0.0300</p>
        </list-item>
        <list-item>
          <p>8 KTI PH 0.2599 0.2212 0.0631 0.0103</p>
        </list-item>
        <list-item>
          <p>9 KTI Yield 0.6077 0.1241 0.1390 0.0116</p>
        </list-item>
      </list>
      <p>The summary information is given with the following code using the boxplot(pm, select=”MAAPE”, las = 2), where we added the parameter las = 2, to show the labels vertically and be able to distinguish the complete names (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p>
      <fig id="fig4" fig-type="figure" position="float">
        <label>Figure 4</label>
        <caption>
          <p>MAAPE of the testing sets for each trait-environment combination of the Maize dataset using the BMTME function.</p>
        </caption>
        <graphic xlink:href="1355f4"/>
      </fig>
      <list list-type="simple" id="L32">
        <list-item>
          <p>boxplot(pm, select=”MAAPE”, las = 2)</p>
        </list-item>
      </list>
    </sec>
    <sec id="s17">
      <title>The BMORS Function</title>
      <p>Since the BMORS function is only appropriate for evaluating prediction performance (but not for parameter estimation), we provide the required R script for evaluating the prediction performance of multiple trait and multiple environment data with a random CV strategy. Since we use the same dataset that was used to illustrate the BMTME function, we only provide the R code for building the predictor (ETA), the CV strategy and for implementing the BMORS function. To build the linear predictor, we used the following R code:</p>
      <list list-type="simple" id="L33">
        <list-item>
          <p>ETA &lt;- list(Env = list(X = Z.E, model = “BRR”), Gen = list(X = Z.G, model = “BRR”), EnvGen = list(X = Z.EG, model = “BRR”))</p>
        </list-item>
      </list>
      <p>Next, we provide the R code for implementing the random CV strategy:</p>
      <list list-type="simple" id="L34">
        <list-item>
          <p>CrossValidation &lt;-CV.RandomPart(pheno, NPartitions = 10, PTesting = 0.2, set_seed = 123)</p>
        </list-item>
      </list>
      <p>Finally, the model will be implemented with 15,000 iterations, of which 10,000 will be used as burn-in to fit the model. Below we show the resulting predictive performance using the summary() function. The information = ′complete′ command inside the summary() function shows the prediction performance (in terms of Pearson’s correlation and MAAPE) for all partitions implemented, but we only show the first 20 observations.</p>
      <list list-type="simple" id="L35">
        <list-item>
          <p>pm &lt;- BMORS(Y, ETA = ETA, nIter = 15000, burnIn = 10000, thin = 2, progressBar = TRUE, testingSet = CrossValidation, digits = 4)</p>
        </list-item>
        <list-item>
          <p>head(summary(pm, information = ′complete′), 20)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Partition Pearson MAAPE</p>
        </list-item>
        <list-item>
          <p>1 EBU Yield 1 0.4815 0.1693</p>
        </list-item>
        <list-item>
          <p>2 EBU Yield 2 0.1231 0.1170</p>
        </list-item>
        <list-item>
          <p>3 EBU Yield 3 0.2922 0.2016</p>
        </list-item>
        <list-item>
          <p>4 EBU Yield 4 0.5016 0.2224</p>
        </list-item>
        <list-item>
          <p>5 EBU Yield 5 -0.1674 0.2701</p>
        </list-item>
        <list-item>
          <p>6 EBU Yield 6 0.1033 0.1774</p>
        </list-item>
        <list-item>
          <p>7 EBU Yield 7 0.6086 0.0919</p>
        </list-item>
        <list-item>
          <p>8 EBU Yield 8 0.6689 0.1878</p>
        </list-item>
        <list-item>
          <p>9 EBU Yield 9 0.3322 0.1068</p>
        </list-item>
        <list-item>
          <p>10 EBU Yield 10 0.1161 0.1966</p>
        </list-item>
        <list-item>
          <p>11 EBU ASI 1 0.3506 0.3080</p>
        </list-item>
        <list-item>
          <p>12 EBU ASI 2 0.2944 0.2764</p>
        </list-item>
        <list-item>
          <p>13 EBU ASI 3 0.0694 0.4862</p>
        </list-item>
        <list-item>
          <p>14 EBU ASI 4 0.9157 0.3902</p>
        </list-item>
        <list-item>
          <p>15 EBU ASI 5 0.7654 0.2694</p>
        </list-item>
        <list-item>
          <p>16 EBU ASI 6 0.7956 0.2843</p>
        </list-item>
        <list-item>
          <p>17 EBU ASI 7 0.8630 0.3009</p>
        </list-item>
        <list-item>
          <p>18 EBU ASI 8 -0.1160 0.3421</p>
        </list-item>
        <list-item>
          <p>19 EBU ASI 9 0.1343 0.2799</p>
        </list-item>
        <list-item>
          <p>20 EBU ASI 10 0.8346 0.2041</p>
        </list-item>
      </list>
      <p>The summary of the predictions is obtained with the following code:</p>
      <list list-type="simple" id="L36">
        <list-item>
          <p>summary(pm)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Pearson SE_Pearson MAAPE SE_MAAPE</p>
        </list-item>
        <list-item>
          <p>1 EBU Yield 0.3060 0.0835 0.1741 0.0175</p>
        </list-item>
        <list-item>
          <p>2 EBU ASI 0.4907 0.1219 0.3142 0.0245</p>
        </list-item>
        <list-item>
          <p>3 EBU PH 0.3486 0.1612 0.0482 0.0050</p>
        </list-item>
        <list-item>
          <p>4 KAK Yield 0.3075 0.1019 0.0965 0.0079</p>
        </list-item>
        <list-item>
          <p>5 KAK ASI 0.0064 0.1296 0.5733 0.0449</p>
        </list-item>
        <list-item>
          <p>6 KAK PH 0.6010 0.0650 0.0396 0.0037</p>
        </list-item>
        <list-item>
          <p>7 KTI Yield 0.3816 0.0992 0.1639 0.0104</p>
        </list-item>
        <list-item>
          <p>8 KTI ASI 0.0278 0.0973 0.2878 0.0198</p>
        </list-item>
        <list-item>
          <p>9 KTI PH 0.3835 0.0753 0.0591 0.0063</p>
        </list-item>
      </list>
      <p>To create a graph with a summary of the predictions in terms of Pearson’s correlation and in terms of MAAPE, we used the plot() function (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Because the names are composed of the evaluated traits and environments, we added the parameter las = 2 to show the labels in a vertical way and to distinguish the complete names of the trait-environment combinations. In addition, we used the par() function and the mar parameter to modify the margins of the graph.</p>
      <fig id="fig5" fig-type="figure" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Average Pearson’s correlation of the testing sets for each trait-environment combination of the Maize dataset using the BMORS function.</p>
        </caption>
        <graphic xlink:href="1355f5"/>
      </fig>
      <list list-type="simple" id="L37">
        <list-item>
          <p>par(mar = c(6,4,2,1))</p>
        </list-item>
        <list-item>
          <p>plot(pm, las = 2)</p>
        </list-item>
      </list>
      <p><xref ref-type="fig" rid="fig5">Figure 5</xref> shows that the lowest average Pearson’s correlation obtained was observed in the ASI_KAK and ASI_KTI trait-environment combinations, while the highest average Pearson’s correlation was obtained in the PH_KAK trait-environment combination. It is possible to create a boxplot with the results of the MAAPE, using the following command (<xref ref-type="fig" rid="fig6">Figure 6</xref>):</p>
      <fig id="fig6" fig-type="figure" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Boxplot of MAAPE of the testing sets for each trait-environment combination of the Maize dataset using the BMORS function.</p>
        </caption>
        <graphic xlink:href="1355f6"/>
      </fig>
      <list list-type="simple" id="L38">
        <list-item>
          <p>boxplot(pm, select =”MAAPE”, las = 2)</p>
        </list-item>
      </list>
      <p><xref ref-type="fig" rid="fig6">Figure 6</xref> shows that the lowest MAAPE was for PH_KAK (best prediction), while the highest MAAPE was for the ASI_KAK trait-environment combination (worst prediction).</p>
    </sec>
    <sec id="s18">
      <title>The BMORS_ENV Function</title>
      <p>This function is useful for predicting whole environments using the remaining environments as training. Next we provide the R code for evaluating the prediction performance of the same maize dataset, but using the KAK environment as training and the KTI and EBU environments as testing. Two important things to point out for using this function are: (a) that we provided not only the matrix of response variables, but also a data.frame that contains, in the first column, the names of the environments followed by information on all response variables, and (b) we did not create a separate file for specifying the training and testing individuals; we only specified in testingEnv which environments are used as testing; the remaining environments are used by default as training, as shown below.</p>
      <list list-type="simple" id="L39">
        <list-item>
          <p>dataset &lt;- phenoMaizeToy[, 2:5]</p>
        </list-item>
        <list-item>
          <p>pm &lt;- BMORS_Env(dataset, testingEnv = <bold>c</bold>(′KTI′, ′EBU′), ETA = ETA, covModel = ′BayesB′, nIter = 15000, burnIn = 10000, thin = 2, progressBar = TRUE, digits = 3)</p>
        </list-item>
        <list-item>
          <p>summary(pm)</p>
        </list-item>
        <list-item>
          <p>Environment Trait Pearson MAAPE</p>
        </list-item>
        <list-item>
          <p>1 KTI Yield 0.4114 0.1344</p>
        </list-item>
        <list-item>
          <p>2 KTI ASI 0.0334 0.4304</p>
        </list-item>
        <list-item>
          <p>3 KTI PH 0.2091 0.0760</p>
        </list-item>
        <list-item>
          <p>4 EBU Yield 0.2775 0.1722</p>
        </list-item>
        <list-item>
          <p>5 EBU ASI -0.0586 0.3825</p>
        </list-item>
        <list-item>
          <p>6 EBU PH 0.0533 0.0933</p>
        </list-item>
      </list>
      <p>For this example, we specified that covModel = ′BayesB′, which means that the Bayesian BayesB model will be implemented for the second stage of the model where it is implemented (equation 3). In covModel, in addition to Bayesian Ridge regression (BRR) and BayesB, we can also implement BayesA, BayesC and Bayesian Lasso (BL); however, the BRR model is implemented by default.To create a graph with Pearson’s correlation or the MAAPE index, we used the barplot() function, as shown below (<xref ref-type="fig" rid="fig7">Figure 7</xref>):</p>
      <fig id="fig7" fig-type="figure" position="float">
        <label>Figure 7</label>
        <caption>
          <p>Average Pearson’s correlations of the testing sets for each trait-environment combination of the Maize dataset using the BMORS_Env function.</p>
        </caption>
        <graphic xlink:href="1355f7"/>
      </fig>
      <list list-type="simple" id="L40">
        <list-item>
          <p>barplot(pm)</p>
        </list-item>
      </list>
      <p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows that the lowest Pearson’s correlation obtained was in the ASI_EBU trait-environment combination, while the highest Pearson’s correlation was obtained in the Yield_KTI trait-environment combination.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s19">
    <title>Discussion</title>
    <p>As mentioned in the introduction, we propose a Bayesian R package for implementing multi-environment and multi-trait and multi-environment analysis for parameter estimation and for evaluating prediction accuracy. We illustrate the four main functions [BME(), BMTME(), BMORS() and BMORS_Env()] of the BMTME package with real toy datasets starting from the type and preprocessing required to make correct use of each of these datasets for parameter estimation and for evaluating prediction performance. It is important to point out that one advantage of the BME and BMTME functions is that, in addition to being used to evaluate the prediction accuracy, they can also be used for parameter estimation, which allows estimating the random effects (lines, lines<inline-formula><mml:math id="me126"><mml:mo>×</mml:mo></mml:math></inline-formula>environments for each trait) and variance-covariance matrices of genetic (for traits and environments) and residual (for traits) effects. The BMORS() and BMORS_Env() functions are not useful for obtaining parameter estimates of covariances between traits and environments because they implement univariate analysis at both stages. However, they have two important advantages: (a) they allow implementing even more complex predictors than the one specified in equation (1), which modifies the ETA list used to create the predictor, and (b) the computational resources required to implement it are much less than those needed by the BMTME() function for implementing multi-trait and multi-environment data. This last point is observed in <xref ref-type="fig" rid="fig8">Figure 8</xref> where the implementation time for the Mada and Maize datasets is reported. The figure shows that in the Mada dataset, the BMORS model was more than 15 times faster than the BMTME model (25.246/ 1.621= 15.572), while in the Maize dataset, the BMORS model was more than 37 times faster than the BMTME model (25.668/ 0.692= 37.093); these results were obtained with 10000 iterations of the Gibbs sampler. The BMTME R package provides very synthetic summaries (tables and plots) of the prediction accuracies, which are ready to be interpreted and used to write the results in a manuscript. Additionally, we provide three types of cross-validations useful for breeders that are implemented in this R package, which is very simple to use and implement.</p>
    <fig id="fig8" fig-type="figure" position="float">
      <label>Figure 8</label>
      <caption>
        <p>Implementation time in minutes between the BMTME and BMORS models under the Mada and Maize datasets.</p>
      </caption>
      <graphic xlink:href="1355f8"/>
    </fig>
    <p>The main disadvantage of the BME() and BMTME() functions of the BMTME R package is that the computational resources required for their implementation are very demanding; fortunately, the parameter estimates involved are stabilized very quickly even with few iterations. The toy examples used in this article are for illustration purposes and to help users follow, as easily as possible, the necessary steps for running the different processes. Comparing them with other software of similar type is not possible, as no similar software for simultaneously fitting multi-trait multi-environment is currently available. For example, the MTM (<xref rid="bib10" ref-type="bibr">de los Campos and Grüneberg 2016</xref>) is an efficient Bayesian multi-trait software but is not multi-trait and multi-environment. Future research on benchmarking the BME() and BMTME() functions of the BMTME package with other potential software to be developed in terms of computing time for processing large datasets should be performed. However, the BMORS() and BMORS_Env() functions that also belong to the BMTME R package are very efficient in terms of computational resources, which gives the user an alternative option for performing this type of analyses.</p>
    <p>It is important to point out that the proposed BMTME package is different from existing multi-trait analysis software such as ASREML (<xref rid="bib13" ref-type="bibr">Gilmour <italic>et al.</italic>, 1995</xref>), sommer (<xref rid="bib7" ref-type="bibr">Covarrubias-Pazaran 2016</xref>), BGGE (<xref rid="bib12" ref-type="bibr">Granato <italic>et al.</italic>, 2018</xref>) and MCMCglmm (<xref rid="bib14" ref-type="bibr">Hadfield <italic>et al.</italic>, 2010</xref>). In addition to taking into account variance-covariance matrices of traits (genetic and residual), it also takes into account the genetic covariance (correlation) between environments, which is estimated from the data. This can help improve parameter estimates and prediction accuracy when the degree of correlation between traits is moderate or high.</p>
    <p>Multi-trait models are preferred over univariate-trait models because they have the following advantages: (a) they produce higher prediction accuracy because they have more information (direct or indirect) and better data connectedness (<xref rid="bib6" ref-type="bibr">Colleau <italic>et al.</italic>, 2009</xref>); (b) they improve index selection because optimal weight factors can be obtained for the total merit index (<xref rid="bib6" ref-type="bibr">Colleau <italic>et al.</italic>, 2009</xref>); and (c) they allow obtaining more precise genetic and residual covariances and incorporating them into expected breeding value (EBV) estimates for across-location, across-country or across-region evaluations (<xref rid="bib44" ref-type="bibr">Thompson and Meyer 1986</xref>; <xref rid="bib36" ref-type="bibr">Schaeffer 2001</xref>).</p>
    <p>Note that the two datasets used for illustrating the main functions of the BMTME R package are datasets with few lines (toy datasets) with the main intention that users interested in using the package can obtain results very quickly and practice using the software. However, the structure of the data are exactly the same as the structure of the data produced in plant breeding programs. The two toy datasets are included in the BMTME package to facilitate its implementation and allow users to practice using the R software.</p>
    <p>To conclude, this paper presents the R package BMTME which allows the implementation of multi-trait, multi-trait and multi-environment analysis for estimating parameters (genetic correlation between traits and environments, residual correlation between traits, random effects of lines and lines×environments) and evaluating the prediction accuracies of many traits simultaneously. We illustrate the implementation of the main functions (BME, BMTE and BMORS) of the R package with two toy real datasets that are very common in plant breeding programs. We provide details of the characteristics that each of the datasets must have, and show how to build the CV strategies available in the package, how to prepare the data to implement the main functions of the BMTME package, how to extract the parameter estimates and how to obtain the summary and plots of prediction accuracies resulting from the implemented CV strategy. The computing time of the BME() and BMTE() functions of the BMTME R package for large datasets is significantly more demanding (in terms of time) than for the toy examples used in this study.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We acknowledge the financial support provided by the Foundation for Research Levy on Agricultural Products (FFL) and the Agricultural Agreement Research Fund (JA) in Norway through NFR grant 267806. Financial support was also provided by the Bill &amp; Melinda Gates Foundation, as well as the CIMMYT CRP Global Maize Breeding Program that generated the data analyzed in this study.</p>
  </ack>
  <fn-group>
    <fn id="fn1">
      <p>Communicating editor: D. J. de Koning</p>
    </fn>
  </fn-group>
  <app-group>
    <app>
      <title>APPENDIX A – R CODE</title>
      <sec id="s20">
        <title>R code for example 1.</title>
        <p>rm(list=ls())</p>
        <p>library(BMTME)</p>
        <p>data(“WheatMadaToy”)</p>
        <p>ls()</p>
        <p>phenoMada &lt;- (phenoMada[order(phenoMada$GID),])</p>
        <p>rownames(phenoMada)=1:nrow(phenoMada)</p>
        <p>head(phenoMada)</p>
        <p>LG &lt;- cholesky(genoMada)</p>
        <p>ZG &lt;- model.matrix(∼0 + as.factor(phenoMada$GID))</p>
        <p>Z.G &lt;- ZG %*% LG</p>
        <p>Y &lt;- as.matrix(phenoMada[, -c(1)])</p>
        <p>head(Y)</p>
        <p>##############Parameter estimation##############################</p>
        <p>fm &lt;- BME(Y = Y, Z1 = Z.G, nIter =15000, burnIn =10000, thin = 2, bs = 50)</p>
        <p>names(fm)</p>
        <p>head(fm$yHat)</p>
        <p>COV_TraitGenetic &lt;- fm$varTrait</p>
        <p>COV_TraitGenetic</p>
        <p>COR_TraitGenetic &lt;- cov2cor(COV_TraitGenetic)</p>
        <p>COR_TraitGenetic</p>
        <p>COV_ResGenetic &lt;- fm$vare</p>
        <p>COV_ResGenetic</p>
        <p>COR_ResGenetic &lt;- cov2cor(COV_ResGenetic)</p>
        <p>COR_ResGenetic</p>
        <p>head(fm$yHat)</p>
        <p>plot(fm,trait=”FL”)</p>
        <p>plot(fm,trait=”FE”)</p>
        <p>#############Evaluation of prediction performance#################</p>
        <p>pheno &lt;- data.frame(GID=phenoMada[, 1],</p>
        <p>Response = phenoMada[, 2])</p>
        <p>CrossV &lt;- CV.RandomPart(pheno, NPartitions = 10, PTesting = 0.2, set_seed = 123)</p>
        <p>pm &lt;- BME(Y = Y, Z1 = Z.G, nIter = 1250, burnIn = 500, thin = 2, bs = 50,</p>
        <p>testingSet = CrossV)</p>
        <p>summary(pm)</p>
        <p>boxplot(pm)</p>
        <p>boxplot(pm, select=”MAAPE”)</p>
        <p>CrossV1 &lt;-sample(nrow(Y),15)</p>
        <p>CrossV1</p>
        <p>pm &lt;- BME(Y = Y, Z1 = Z.G, nIter = 1250, burnIn = 500, thin = 2, bs = 50,</p>
        <p>testingSet = CrossV1)</p>
        <p>summary(pm)</p>
        <p>boxplot(pm)</p>
        <p>boxplot(pm, select=”MAAPE”)</p>
      </sec>
      <sec id="s21">
        <title>R code for example 2.</title>
        <p>rm(list=ls())</p>
        <p>library(BMTME)</p>
        <p>data(“MaizeToy”)</p>
        <p>phenoMaizeToy&lt;-(phenoMaizeToy[order(phenoMaizeToy$Env,phenoMaizeToy$Line),])</p>
        <p>rownames(phenoMaizeToy)=1:nrow(phenoMaizeToy)</p>
        <p>head(phenoMaizeToy,8)</p>
        <p>LG &lt;- cholesky(genoMaizeToy)</p>
        <p>ZG &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Line))</p>
        <p>Z.G &lt;- ZG %*% LG</p>
        <p>Z.E &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Env))</p>
        <p>ZEG &lt;- model.matrix(∼0 + as.factor(phenoMaizeToy$Line):as.factor(phenoMaizeToy$Env))</p>
        <p>G2 &lt;- kronecker(diag(length(unique(phenoMaizeToy$Env))), data.matrix(genoMaizeToy))</p>
        <p>LG2 &lt;- cholesky(G2)</p>
        <p>Z.EG &lt;- ZEG %*% LG2</p>
        <p>Y &lt;- as.matrix(phenoMaizeToy[, -c(1, 2)])</p>
        <p>fm &lt;- BMTME(Y = Y, X = Z.E, Z1 = Z.G, Z2 = Z.EG, nIter =1500, burnIn =1000, thin = 2,bs = 50)</p>
        <p>str(fm)</p>
        <p>COV_TraitGenetic &lt;- fm$varTrait</p>
        <p>COV_TraitGenetic</p>
        <p>COR_TraitGenetic &lt;- cov2cor(COV_TraitGenetic)</p>
        <p>COR_TraitGenetic</p>
        <p>COV_EnvGenetic &lt;- fm$varEnv</p>
        <p>COV_EnvGenetic</p>
        <p>COR_EnvGenetic &lt;- cov2cor(COV_EnvGenetic)</p>
        <p>COR_EnvGenetic</p>
        <p>COV_ResGenetic &lt;- fm$vare</p>
        <p>COV_ResGenetic</p>
        <p>COR_ResGenetic &lt;- cov2cor(COV_ResGenetic)</p>
        <p>COR_ResGenetic</p>
        <p>plot(fm, trait=′Yield′)</p>
        <p>plot(fm,trait=”ASI”)</p>
        <p>####Evaluation of prediction performance with BMTME###############</p>
        <p>pheno &lt;- data.frame(GID = phenoMaizeToy[, 1], Env = phenoMaizeToy[, 2],</p>
        <p>Response = phenoMaizeToy[, 3])</p>
        <p>CrossV &lt;- CV.KFold(pheno, DataSetID = ′GID′, K = 5, set_seed = 123)</p>
        <p>pm &lt;- BMTME(Y = Y, X = Z.E, Z1 = Z.G, Z2 = Z.EG, nIter = 1250, burnIn = 500, thin = 2,bs = 50, testingSet = CrossV)</p>
        <p>summary(pm)</p>
        <p>boxplot(pm, select =”MAAPE”, las = 2)</p>
        <p>####Evaluation of prediction performance with BMORS####################</p>
        <p>ETA &lt;- list(Env = list(X = Z.E, model = “BRR”), Gen = list(X = Z.G, model = ’BRR’), EnvGen = list(X = Z.EG, model = “BRR”))</p>
        <p>CrossValidation &lt;-CV.RandomPart(pheno, NPartitions = 10, PTesting = 0.2,set_seed = 123)</p>
        <p>pm &lt;- BMORS(Y, ETA = ETA, nIter = 15000, burnIn = 10000, thin = 2, progressBar = TRUE, testingSet = CrossValidation, digits = 4)</p>
        <p>head(summary(pm, information = ′complete′), 20)</p>
        <p>par(mar=c(6,4,2,1))</p>
        <p>plot(pm, las = 2)</p>
        <p>boxplot(pm, select =”MAAPE”, las = 2)</p>
        <p>###########Evaluation of prediction performance with BMORS_Env################################</p>
        <p>dataset &lt;- phenoMaizeToy[, 2:5]</p>
        <p>pm1 &lt;- BMORS_Env(dataset, testingEnv = c(’KTI’, ’EBU’), ETA = ETA, covModel = ’BayesB’, nIter = 1500, burnIn = 1000, thin = 2, </p>
        <p>progressBar = TRUE, digits = 3)</p>
        <p>summary(pm1)</p>
        <p>barplot(pm1)</p>
        <p>barplot(pm1,select=”MAAPE”)</p>
      </sec>
    </app>
  </app-group>
  <ref-list>
    <title>Literature Cited</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben Hassen</surname><given-names>M.</given-names></name><name><surname>Bartholomé</surname><given-names>J.</given-names></name><name><surname>Valè</surname><given-names>G.</given-names></name><name><surname>Cao</surname><given-names>T.-V.</given-names></name><name><surname>Ahmadi</surname><given-names>N.</given-names></name></person-group><year>2018</year> Genomic Prediction Accounting for Genotype by Environment Interaction Offers an Effective Framework for Breeding Simultaneously for Adaptation to an Abiotic Stress and Performance Under Normal Cropping Conditions in Rice. <italic>G3: Genes|Genomes|Genetics</italic>, <italic>8</italic>(July), 2319–2332. <pub-id pub-id-type="doi">10.1534/g3.118.200098</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgueño</surname><given-names>J.</given-names></name><name><surname>de los Campos</surname><given-names>G. D. L.</given-names></name><name><surname>Weigel</surname><given-names>K.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name></person-group>, <year>2012</year> <article-title>Genomic prediction of breeding values when modeling genotype x environment interaction using pedigree and dense molecular markers.</article-title><source>Crop Sci.</source><volume>52</volume>: <fpage>707</fpage>–<lpage>719</lpage>. <pub-id pub-id-type="doi">10.2135/cropsci2011.06.0299</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burstin</surname><given-names>J.</given-names></name><name><surname>Salloignon</surname><given-names>P.</given-names></name><name><surname>Martinello</surname><given-names>M.</given-names></name><name><surname>Magnin-Robert</surname><given-names>J. B.</given-names></name><name><surname>Siol</surname><given-names>M.</given-names></name><name><surname>Jacquin</surname><given-names>F.</given-names></name><etal/></person-group>, <year>2015</year> <article-title>Genetic diversity and trait genomic prediction in a pea diversity panel.</article-title> BMC Genomics, 2015;16(1):105. pmid:25765216. <pub-id pub-id-type="doi">10.1186/s12864-015-1266-1</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calus</surname><given-names>M. P.</given-names></name><name><surname>Veerkamp</surname><given-names>R. F.</given-names></name></person-group>, <year>2011</year> <article-title>Accuracy of multi-trait genomic selection using different methods. Genetics, Selection</article-title>. <source>Evolution : GSE</source><volume>43</volume>: <fpage>26</fpage><pub-id pub-id-type="doi">10.1186/1297-9686-43-26</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castro</surname><given-names>A. F. N. M.</given-names></name><name><surname>Castro</surname><given-names>R. V.</given-names></name><name><surname>Oliveira</surname><given-names>C. A. O.</given-names></name><name><surname>Lima</surname><given-names>J. E.</given-names></name><name><surname>Santos</surname><given-names>R. C.</given-names></name><etal/></person-group>, <year>2013</year> <article-title>Multivariate analysis for the selection of eucalyptus clones destined for charcoal production.</article-title><source>Pesqui. Agropecu. Bras.</source><volume>48</volume>: <fpage>627</fpage>–<lpage>635</lpage>. <pub-id pub-id-type="doi">10.1590/S0100-204X2013000600008</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colleau</surname><given-names>J. J.</given-names></name><name><surname>Fritz</surname><given-names>S.</given-names></name><name><surname>Guillaume</surname><given-names>F.</given-names></name><name><surname>Baur</surname><given-names>A.</given-names></name><name><surname>Dupassieux</surname><given-names>D.</given-names></name><etal/></person-group>, <year>2009</year> <article-title>Simulating the potential of genomic selection in dairy cattle breeding.</article-title><source>Rencontres Recherches Ruminants</source><volume>16</volume>: <fpage>419</fpage>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covarrubias-Pazaran</surname><given-names>G.</given-names></name></person-group><year>2016</year> Genome-assisted prediction of quantitative traits using the R package sommer. PLoS ONE. 11(6): 1–15. <pub-id pub-id-type="doi">10.1371/journal.pone.0156744</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covarrubias-Pazaran</surname><given-names>G.</given-names></name><name><surname>Schlautman</surname><given-names>B.</given-names></name><name><surname>Diaz-Garcia</surname><given-names>L.</given-names></name><name><surname>Grygleski</surname><given-names>E.</given-names></name><name><surname>Polashock</surname><given-names>J.</given-names></name><etal/></person-group>, <year>2018</year> <article-title>Multivariate GBLUP Improves Accuracy of Genomic Selection for Yield and Fruit Weight in Biparental Populations of <italic>Vaccinium macrocarpon</italic> Ait.</article-title><source>Front. Plant Sci.</source><volume>9</volume>: <fpage>1310</fpage><pub-id pub-id-type="doi">10.3389/fpls.2018.01310</pub-id><pub-id pub-id-type="pmid">30258453</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Pérez</surname><given-names>P.</given-names></name><name><surname>Hickey</surname><given-names>J.</given-names></name><name><surname>Burgueño</surname><given-names>J.</given-names></name><name><surname>Ornella</surname><given-names>L.</given-names></name><etal/></person-group>, <year>2014</year> <article-title>Genomic prediction in CIMMYT maize and wheat breeding programs.</article-title><source>Heredity</source><volume>112</volume>: <fpage>48</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1038/hdy.2013.16</pub-id><pub-id pub-id-type="pmid">23572121</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="webpage">de los Campos, G., and A. Grüneberg, 2016 MTM (Multiple-Trait Model) package [WWW Document]. URL <ext-link ext-link-type="uri" xlink:href="http://quantgen.github.io/MTM/vignette.html">http://quantgen.github.io/MTM/vignette.html</ext-link> (accessed 10.25.17).</mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Oliveira</surname><given-names>E. J.</given-names></name><name><surname>Vilela de Resende</surname><given-names>M. D.</given-names></name><name><surname>Silva Santos</surname><given-names>V.</given-names></name><name><surname>Fortes Ferreira</surname><given-names>C.</given-names></name><name><surname>Fachardo Oliveira</surname><given-names>G. A.</given-names></name><etal/></person-group>, <year>2012</year> <article-title>Genome-wide selection in cassava.</article-title><source>Euphytica</source><volume>187</volume>: <fpage>263</fpage>–<lpage>276</lpage>. <pub-id pub-id-type="doi">10.1007/s10681-012-0722-0</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granato</surname><given-names>I.</given-names></name><name><surname>Cuevas</surname><given-names>J.</given-names></name><name><surname>Luna-Vázquez</surname><given-names>F.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><etal/></person-group>, <year>2018</year> <article-title>BGGE: A New Package for Genomic-Enabled Prediction Incorporating Genotype × Environment Interaction Models. Genes</article-title>. <source>Genomes and Genetics</source><volume>8</volume>: <fpage>3039</fpage>–<lpage>3047</lpage>. <pub-id pub-id-type="doi">10.1534/g3.118.200435</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilmour</surname><given-names>A.</given-names></name><name><surname>Thompson</surname><given-names>R.</given-names></name><name><surname>Cullis</surname><given-names>B.</given-names></name></person-group>, <year>1995</year> <article-title>Average Information REML: An Efficient Algorithm for Variance Parameter Estimation in Linear Mixed Models.</article-title><source>Biometrics</source><volume>51</volume>: <fpage>1440</fpage>–<lpage>1450</lpage>. <pub-id pub-id-type="doi">10.2307/2533274</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadfield</surname><given-names>J. D.</given-names></name><etal/></person-group><year>2010</year> MCMC methods for multi-response generalized linear mixed models: the MCMCglmm R package. Journal of Statistical Software, 33(2): 1–22. <pub-id pub-id-type="doi">10.18637/jss.v033.i02</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>B.</given-names></name><name><surname>Goddard</surname><given-names>M.</given-names></name></person-group>, <year>2010</year> <article-title>Genome-wide association and genomic selection in animal breeding.</article-title><source>Genome</source><volume>53</volume>: <fpage>876</fpage>–<lpage>883</lpage>. <pub-id pub-id-type="doi">10.1139/G10-076</pub-id><pub-id pub-id-type="pmid">21076503</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>D.</given-names></name><name><surname>Kuhn</surname><given-names>D.</given-names></name><name><surname>Parida</surname><given-names>L.</given-names></name></person-group>, <year>2016</year> <article-title>Novel applications of multitask learning and multiple output regression to multiple genetic trait prediction.</article-title><source>Bioinformatics</source><volume>32</volume>: <fpage>i37</fpage>–<lpage>i43</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw249</pub-id><pub-id pub-id-type="pmid">27307640</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M.</given-names></name><name><surname>Chen</surname><given-names>L.</given-names></name><name><surname>Chen</surname><given-names>Z.</given-names></name></person-group>, <year>2015</year> <article-title>Diallel analysis of combining ability and heterosis for yield and yield components in rice by using positive loci.</article-title><source>Euphytica</source><volume>205</volume>: <fpage>37</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1007/s10681-015-1381-8</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heuer</surname><given-names>C.</given-names></name><name><surname>Scheel</surname><given-names>C.</given-names></name><name><surname>Tetens</surname><given-names>J.</given-names></name><name><surname>Kühn</surname><given-names>C.</given-names></name><name><surname>Thaller</surname><given-names>G.</given-names></name></person-group>, <year>2016</year> <article-title>Genomic prediction of unordered categorical traits: an application to subpopulation assignment in German Warmblood horses.</article-title><source>Genet. Sel. Evol.</source><volume>48</volume>: <fpage>13</fpage><pub-id pub-id-type="doi">10.1186/s12711-016-0192-2</pub-id><pub-id pub-id-type="pmid">26867647</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarquín</surname><given-names>D.</given-names></name><name><surname>Lemes da Silva</surname><given-names>C.</given-names></name><name><surname>Gaynor</surname><given-names>R. C.</given-names></name><name><surname>Poland</surname><given-names>J.</given-names></name><name><surname>Fritz</surname><given-names>A.</given-names></name><etal/></person-group>, <year>2017</year> <article-title>Increasing Genomic-Enabled Prediction Accuracy by Modeling Genotype × Environment Interactions in Kansas Wheat.</article-title><source>Plant Genome</source><volume>10</volume><pub-id pub-id-type="doi">10.3835/plantgenome2016.12.0130</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>Y.</given-names></name><name><surname>Jannink</surname><given-names>J.-L.</given-names></name></person-group>, <year>2012</year> <article-title>Multiple-Trait Genomic Selection Methods Increase Genetic Value Prediction Accuracy.</article-title><source>Genetics</source><volume>192</volume>: <fpage>1513</fpage>–<lpage>1522</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.112.144246</pub-id><pub-id pub-id-type="pmid">23086217</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Q.</given-names></name><name><surname>Ma</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name><etal/></person-group>, <year>2015</year> <article-title>Joint prediction of multiple quantitative traits using a Bayesian multivariate antedependence model.</article-title><source>Heredity</source><volume>115</volume>: <fpage>29</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1038/hdy.2015.9</pub-id><pub-id pub-id-type="pmid">25873147</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>S.</given-names></name><name><surname>Chagné</surname><given-names>D.</given-names></name><name><surname>Bink</surname><given-names>M. C.</given-names></name><name><surname>Volz</surname><given-names>R. K.</given-names></name><name><surname>Whitworth</surname><given-names>C.</given-names></name><name><surname>Carlisle</surname><given-names>C.</given-names></name></person-group><year>2012</year> Genomic selection for fruit quality traits in apple (<italic>Malus × domestica</italic> Borkh.). PloS One. 2012;7(5):e36674. pmid:22574211.</mixed-citation>
    </ref>
    <ref id="bib23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>López-Cruz</surname><given-names>M.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Bonnett</surname><given-names>D.</given-names></name><name><surname>Dreisigacker</surname><given-names>S.</given-names></name><name><surname>Poland</surname><given-names>J.</given-names></name><name><surname>Jannink</surname><given-names>J.-L.</given-names></name><name><surname>Singh</surname><given-names>R. P.</given-names></name><name><surname>Autrique</surname><given-names>E.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name></person-group>, <year>2015</year> Increased prediction accuracy in wheat breeding trials using a marker × environment interaction genomic selection model. G3: Genes|Genomes|Genetics, 5(4): 569–82.</mixed-citation>
    </ref>
    <ref id="bib24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meuwissen</surname><given-names>T. H. E.</given-names></name><name><surname>Hayes</surname><given-names>B. J.</given-names></name><name><surname>Goddard</surname><given-names>M. E.</given-names></name></person-group>, <year>2001</year> <article-title>Prediction of total genetic value using genome-wide dense marker maps.</article-title><source>Genetics</source><volume>157</volume>: <fpage>1819</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="bib25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Pérez-Rodríguez</surname><given-names>P.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name><name><surname>Eskridge</surname><given-names>K. M.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name></person-group>, <year>2015</year><comment>a</comment> Threshold models for genome-enabled prediction of ordinal categorical traits in plant breeding. G3: Genes| Genomes| Genetics, 5(1): 291–300.</mixed-citation>
    </ref>
    <ref id="bib26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Burgueño</surname><given-names>J.</given-names></name><name><surname>Eskridge</surname><given-names>K.</given-names></name></person-group>, <year>2015</year><comment>b</comment> Genomic-Enabled Prediction of Ordinal Data with Bayesian Logistic Ordinal Regression. G3: Genes|Genomes|Genetics, 5(10): 2113–2126. <pub-id pub-id-type="doi">10.1534/g3.115.021154</pub-id></mixed-citation>
    </ref>
    <ref id="bib27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-Lopez</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-Lopez</surname><given-names>A.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Toledo</surname><given-names>F. H.</given-names></name><name><surname>Perez-Hernandez</surname><given-names>O.</given-names></name><name><surname>Eskridge</surname><given-names>K. M.</given-names></name><name><surname>Rutkoski</surname><given-names>J.</given-names></name></person-group>, <year>2016</year> A Genomic Bayesian Multi-trait and Multi-environment Model. G3: Genes|Genomes|Genetics, 6(9), 2725–2744. <pub-id pub-id-type="doi">10.1534/g3.116.032359</pub-id></mixed-citation>
    </ref>
    <ref id="bib28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Hernández-Suárez</surname><given-names>C. M.</given-names></name></person-group>, <year>2018</year><comment>a</comment> <article-title>Multivariate Bayesian analysis of on-farm trials with multiple-trait and multiple-environment data.</article-title><source>Agron. J.</source><volume>111</volume>: <fpage>1</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.2134/agronj2018.06.0362</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Gianola</surname><given-names>D.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Hernández-Suárez</surname><given-names>C. M.</given-names></name><etal/></person-group>, <year>2018</year><comment>b</comment> <article-title>Multi-trait, multi-environment deep learning modeling for genomic-enabled prediction of plant traits. G3: Genes, Genomes</article-title>. <source>Genetics</source><volume>8</volume>: <fpage>3829</fpage>–<lpage>3840</lpage>. <pub-id pub-id-type="doi">10.1534/g3.118.200728</pub-id></mixed-citation>
    </ref>
    <ref id="bib30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Montesinos-López</surname><given-names>O. A.</given-names></name><name><surname>Montesinos-López</surname><given-names>A.</given-names></name><name><surname>Montesinos-López</surname><given-names>J. C.</given-names></name><name><surname>Crossa</surname><given-names>J.</given-names></name><name><surname>Luna-Vázquez</surname><given-names>F. J.</given-names></name></person-group><italic>et al.</italic>, <year>2018</year><comment>c</comment> <article-title>A Bayesian Multiple-Trait and Multiple-Environment Model Using the Matrix Normal Distribution</article-title>, <source>Physical Methods for Stimulation of Plant and Mushroom Development</source>, chap 13., edited by <person-group person-group-type="editor"><name><surname>El-Esawi</surname><given-names>M. A.</given-names></name></person-group>, <publisher-name>Tanta University</publisher-name>, London Bridge Street London, United Kingdom. <pub-id pub-id-type="doi">10.5772/intechopen.71521</pub-id></mixed-citation>
    </ref>
    <ref id="bib31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>K. M.</given-names></name><name><surname>VanRaden</surname><given-names>P. M.</given-names></name><name><surname>Tooker</surname><given-names>M. E.</given-names></name></person-group>, <year>2012</year> <article-title>Multibreed genomic evaluations using purebred Holsteins, Jerseys, and Brown Swiss.</article-title><source>J. Dairy Sci.</source><volume>95</volume>: <fpage>5378</fpage>–<lpage>5383</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2011-5006</pub-id><pub-id pub-id-type="pmid">22916944</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>P.</given-names></name><name><surname>de los Campos</surname><given-names>G.</given-names></name></person-group>, <year>2014</year> <article-title>Genome-Wide Regression and Prediction with the BGLR Statistical Package.</article-title><source>Genetics</source><volume>198</volume>: <fpage>483</fpage>–<lpage>495</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.164442</pub-id><pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation>
    </ref>
    <ref id="bib33">
      <mixed-citation publication-type="webpage">Plummer, M., 2018 rjags: Bayesian Graphical Models using MCMC. URL <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rjags">https://CRAN.R-project.org/package=rjags</ext-link>. R package version 4–6.</mixed-citation>
    </ref>
    <ref id="bib34">
      <mixed-citation publication-type="webpage">R Core Team, 2018 R: A Language and Environment for Statistical Computing. Vienna, Austria. Retrieved from <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="bib35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutkoski</surname><given-names>J. E.</given-names></name><name><surname>Heffner</surname><given-names>E. L.</given-names></name><name><surname>Sorrells</surname><given-names>M. E.</given-names></name></person-group>, <year>2011</year> <article-title>Genomic selection for durable stem rust resistance in wheat.</article-title><source>Euphytica</source><volume>179</volume>: <fpage>161</fpage>–<lpage>173</lpage>. <pub-id pub-id-type="doi">10.1007/s10681-010-0301-1</pub-id></mixed-citation>
    </ref>
    <ref id="bib36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaeffer</surname><given-names>L. R.</given-names></name></person-group>, <year>2001</year> <article-title>Multiple trait international bull comparisons.</article-title><source>Livest. Prod. Sci.</source><volume>69</volume>: <fpage>145</fpage>–<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1016/S0301-6226(00)00255-4</pub-id></mixed-citation>
    </ref>
    <ref id="bib37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulthess</surname><given-names>A. W.</given-names></name><name><surname>Zhao</surname><given-names>Y.</given-names></name><name><surname>Longin</surname><given-names>C. F. H.</given-names></name><name><surname>Reif</surname><given-names>J. C.</given-names></name></person-group>, <year>2017</year> <article-title>Advantages and limitations of multiple-trait genomic prediction for Fusarium head blight severity in hybrid wheat (<italic>Triticum aestivum</italic> L.).</article-title><source>Theor. Appl. Genet.</source><pub-id pub-id-type="doi">10.1007/s00122-017-3029-7</pub-id></mixed-citation>
    </ref>
    <ref id="bib38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spindel</surname><given-names>J.</given-names></name><name><surname>Begum</surname><given-names>H.</given-names></name><name><surname>Akdemir</surname><given-names>D.</given-names></name><name><surname>Virk</surname><given-names>P.</given-names></name><name><surname>Collard</surname><given-names>B.</given-names></name><etal/></person-group>, <year>2015</year> <article-title>Genomic selection and association mapping in rice (<italic>Oryza sativa</italic>): effect of trait genetic architecture, training population composition, marker number and statistical model on accuracy of rice genomic selection in elite, tropical rice breeding lines.</article-title><source>PLoS Genet.</source><volume>11</volume>: <fpage>e1004982</fpage> (erratum: PLoS Genet. 11: e1005350). <pub-id pub-id-type="doi">10.1371/journal.pgen.1004982</pub-id><pub-id pub-id-type="pmid">25689273</pub-id></mixed-citation>
    </ref>
    <ref id="bib39">
      <mixed-citation publication-type="webpage">Spyromitros-Xioufis, E., W. Groves, G. Tsoumakas, and I. Vlahavas, 2012 Multi-label classification methods for multi-target regression. arXiv preprint arXiv:1211.6581, 2012, 1159–1168. Cornell University Library.</mixed-citation>
    </ref>
    <ref id="bib40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spyromitros-Xioufis</surname><given-names>E.</given-names></name><name><surname>Tsoumakas</surname><given-names>G.</given-names></name><name><surname>Groves</surname><given-names>W.</given-names></name><name><surname>Vlahavas</surname><given-names>I.</given-names></name></person-group><year>2016</year> <article-title>Multi-target regression via input space expansion: treating targets as inputs.</article-title><source>Mach. Learn.</source><volume>104</volume>: <fpage>55</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1007/s10994-016-5546-z</pub-id></mixed-citation>
    </ref>
    <ref id="bib41">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>M. S.</given-names></name><name><surname>Khatri</surname><given-names>C. G.</given-names></name></person-group>, <year>1979</year> <source><italic>An Introduction to Multivariate Statistics</italic>.</source><publisher-name>Elsevier North Holland</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bib42">
      <mixed-citation publication-type="webpage">Stan Development Team, (2018). Stan Modeling Language Users Guide and Reference Manual, Version 2.18.0. <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org">http://mc-stan.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="bib43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Technow</surname><given-names>F.</given-names></name><name><surname>Melchinger</surname><given-names>A. E.</given-names></name></person-group>, <year>2013</year> <article-title>Genomic prediction of dichotomous traits with Bayesian logistic models.</article-title><source>Theor. Appl. Genet.</source><volume>126</volume>: <fpage>1133</fpage>–<lpage>1143</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-013-2041-9</pub-id><pub-id pub-id-type="pmid">23385660</pub-id></mixed-citation>
    </ref>
    <ref id="bib44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>R.</given-names></name><name><surname>Meyer</surname><given-names>K.</given-names></name></person-group>, <year>1986</year> <article-title>A review of theoretical aspects in the estimation of breeding values for multi-trait selection.</article-title><source>Livest. Prod. Sci.</source><volume>15</volume>: <fpage>299</fpage>–<lpage>313</lpage>. <pub-id pub-id-type="doi">10.1016/0301-6226(86)90071-0</pub-id></mixed-citation>
    </ref>
    <ref id="bib45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanRaden</surname><given-names>P. M.</given-names></name></person-group>, <year>2008</year> <article-title>Efficient methods to compute genomic predictions.</article-title><source>J. Dairy Sci.</source><volume>91</volume>: <fpage>4414</fpage>–<lpage>4423</lpage>. <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id><pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation>
    </ref>
    <ref id="bib46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Würschum</surname><given-names>T.</given-names></name><name><surname>Reif</surname><given-names>J. C.</given-names></name><name><surname>Kraft</surname><given-names>T.</given-names></name><name><surname>Janssen</surname><given-names>G.</given-names></name><name><surname>Zhao</surname><given-names>Y.</given-names></name></person-group>, <year>2013</year> <article-title>Genomic selection in sugar beet breeding populations.</article-title><source>BMC Genet.</source><volume>14</volume>: <fpage>85</fpage>–<lpage>93</lpage>. <pub-id pub-id-type="doi">10.1186/1471-2156-14-85</pub-id><pub-id pub-id-type="pmid">24047500</pub-id></mixed-citation>
    </ref>
    <ref id="bib47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname><given-names>E.</given-names></name><name><surname>Matsunaga</surname><given-names>A.</given-names></name><name><surname>Onogi</surname><given-names>A.</given-names></name><name><surname>Kajiya-Kanegae</surname><given-names>H.</given-names></name><name><surname>Minamikawa</surname><given-names>M.</given-names></name><etal/></person-group>, <year>2016</year> <article-title>A simulation-based breeding design that uses whole-genome prediction in tomato.</article-title><source>Sci. Rep.</source><volume>6</volume>: <fpage>19454</fpage><pub-id pub-id-type="doi">10.1038/srep19454</pub-id><pub-id pub-id-type="pmid">26787426</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
