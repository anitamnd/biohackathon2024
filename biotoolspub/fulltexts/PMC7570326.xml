<?properties open_access?>
<?subarticle report73164?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7570326</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.22242.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AlignmentViewer: Sequence Analysis of Large Protein Families</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Reguant</surname>
          <given-names>Roc</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0350-3899</contrib-id>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antipin</surname>
          <given-names>Yevgeniy</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sheridan</surname>
          <given-names>Rob</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dallago</surname>
          <given-names>Christian</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4650-6181</contrib-id>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Diamantoukos</surname>
          <given-names>Drew</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luna</surname>
          <given-names>Augustin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5709-371X</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sander</surname>
          <given-names>Chris</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6059-6270</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gauthier</surname>
          <given-names>Nicholas Paul</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Informatics, Technical University of Munich, Munich, Germany</aff>
      <aff id="a2"><label>2</label>cBio Center, Department of Data Sciences, Dana-Farber Cancer Institute, Boston, MA, USA</aff>
      <aff id="a3"><label>3</label>Department of Cell Biology, Harvard Medical School, Boston, MA, USA</aff>
      <aff id="a4"><label>4</label>Icahn School of Medicine, Mount Sinai, New York, NY, USA</aff>
      <aff id="a5"><label>5</label>Knowledge Systems Group, Computational Oncology, Memorial Sloan Kettering Cancer Center, New York, NY, USA</aff>
      <aff id="a6"><label>6</label>Broad Institute of MIT and Harvard, Cambridge, MA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:sander.research@gmail.com">sander.research@gmail.com</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email xlink:href="mailto:nicholasp_gauthier@dfci.harvard.edu">nicholasp_gauthier@dfci.harvard.edu</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>ISCB Comm J-213</elocation-id>
    <history>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2020 Reguant R et al.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-9-30135.pdf"/>
    <abstract>
      <p>AlignmentViewer is a web-based tool to view and analyze multiple sequence alignments of protein families. The particular strengths of AlignmentViewer include flexible visualization at different scales as well as analysis of conservation patterns and of the distribution of proteins in sequence space. The tool is directly accessible in web browsers without the need for software installation. It can handle protein families with tens of thousands of sequences and is particularly suitable for evolutionary coupling analysis, e.g. via EVcouplings.org.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>alignment viewer</kwd>
      <kwd>MSA</kwd>
      <kwd>JavaScript</kwd>
      <kwd>protein alignments</kwd>
      <kwd>web-based</kwd>
      <kwd>tool</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1" xlink:href="http://dx.doi.org/10.13039/100004412">
        <funding-source>Human Frontier Science Program</funding-source>
        <award-id>RGP0055/2015</award-id>
      </award-group>
      <award-group id="fund-2" xlink:href="http://dx.doi.org/10.13039/100000057">
        <funding-source>National Institute of General Medical Sciences</funding-source>
        <award-id>P41GM103504</award-id>
      </award-group>
      <award-group id="fund-3" xlink:href="http://dx.doi.org/10.13039/100006691">
        <funding-source>Harvard Medical School</funding-source>
      </award-group>
      <funding-statement>The project was supported by the Human Frontier Science Program (HFSP) (RGP0055/2015), the National Resource for Network Biology (NRNB) from the National Institute of General Medical Sciences (NIGMS) (P41 GM103504), and the Department of Cell Biology at Harvard Medical School.</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>We have updated the manuscript and the software according to reviewer comments. We have added a new feature to select the coloring scheme of the alignment, addressed cross-browser compatibility issues, and improved the usability. We have also addressed comments from the reviewers meant to improve the clarity of the manuscript.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) analysis (e.g., analysis of sequence patterns, subfamilies, specificity residues, evolutionary couplings) and visualization allows researchers to extract information and gain a better understanding of protein families. MSA is a basic step in many protein analysis workflows, including 3D structure prediction (
<xref rid="ref-5" ref-type="bibr">Marks
<italic>et al.</italic>, 2011</xref>), structure detection in flexible (‘disordered’) domains (
<xref rid="ref-9" ref-type="bibr">Toth-Petroczy
<italic>et al.</italic>, 2016</xref>), function prediction (
<xref rid="ref-8" ref-type="bibr">Tamames
<italic>et al.</italic>, 1998</xref>) and intracellular localization (
<xref rid="ref-2" ref-type="bibr">Goldberg
<italic>et al.</italic>, 2014</xref>).</p>
    <p>A number of useful tools exist for the visualization of protein MSAs, such as,
<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/Tools/msa/mview/">MView</ext-link>,
<ext-link ext-link-type="uri" xlink:href="http://wasabiapp.org/">Wasabi</ext-link>,
<ext-link ext-link-type="uri" xlink:href="https://ormbunkar.se/aliview/">AliView</ext-link>,
<ext-link ext-link-type="uri" xlink:href="https://msa.biojs.net/">MSAViewer</ext-link> and
<ext-link ext-link-type="uri" xlink:href="https://www.jalview.org/">Jalview</ext-link> (
<xref rid="ref-1" ref-type="bibr">Brown
<italic>et al.</italic>, 1998</xref>;
<xref rid="ref-4" ref-type="bibr">Larsson, 2014</xref>;
<xref rid="ref-10" ref-type="bibr">Veidenberg
<italic>et al.</italic>, 2016</xref>;
<xref rid="ref-11" ref-type="bibr">Waterhouse
<italic>et al.</italic>, 2009</xref>;
<xref rid="ref-12" ref-type="bibr">Yachdav
<italic>et al.</italic>, 2016</xref>). MView was one of the first online browser-based MSA viewers, with alignments formatted as an HTML document. Wasabi is a web-based tool particularly useful for phylogenetic analysis and incorporates phylogeny-aware alignment methods. Another desktop application, AliView, has features such as sorting, viewing, removing, editing and merging sequences from large nucleotide sequence datasets. MSAViewer is an interactive MSA visualizer in JavaScript that implements basic features of viewing, scrolling and motif selection. Jalview is a Java-based desktop tool accessible through websites using an embeddable applet, but unfortunately the technology for these applets is no longer supported in most browsers.</p>
    <p>AlignmentViewer complements these MSA tools and provides the following features: (i) in-browser and serverless execution, (ii) visualization of very large MSAs, (iii) visualization of conservation patterns, (iv) sequence filtering, (v) logo display, (vi) pairwise sequence identity map, (vii) sequence space exploration by UMAP dimensionality reduction, and (viii) display of top-ranked evolutionary couplings (
<xref rid="ref-3" ref-type="bibr">Hopf
<italic>et al.</italic>, 2019</xref>).</p>
    <p>An earlier version of this article can be found on bioRxiv (DOI:
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/269720">https://doi.org/10.1101/269720</ext-link>); additional features have been implemented since the earlier version.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Operation</title>
      <p>AlignmentViewer is a web-based tool written in JavaScript with minimal system requirements. AlignmentViewer works best on Chrome regardless of operating system. AlignmentViewer is developed with the D3 library (d3js.org) to produce dynamic and interactive data visualizations, with performance (speed) for large alignments a major consideration. The tool is entirely client-based, running inside a web browser without the need for server-side computation.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Users can access AlignmentViewer and all its features directly from alignmentviewer.org, but its serverless execution enables anyone to quickly start a local copy for online or offline use. Hyperlinks for lookup in background databases, such as Uniprot or Pfam, are made directly from the client. Alignments can be passed to AlignmentViewer also via a URL query parameter that is served by https and is properly encoded (e.g.,
<ext-link ext-link-type="uri" xlink:href="https://alignmentviewer.org/?url=https://alignmentviewer.org/example/1bkr_A.1-108.msa.txt">https://alignmentviewer.org/?url=https://alignmentviewer.org/example/1bkr_A.1-108.msa.txt</ext-link>), enabling seamless integration from external web services via a simple link (e.g. the EVcouplings, evcouplings.org, web server (
<xref rid="ref-3" ref-type="bibr">Hopf
<italic>et al.</italic>, 2019</xref>) offers visualization of computed alignments via a link to AlignmentViewer). The tool has been thoroughly tested with many large alignments. An alignment with, e.g., 50,000 sequences (about 13 MB of memory) loads in the Safari browser within one minute; further speedup is planned.</p>
    </sec>
  </sec>
  <sec>
    <title>Use case</title>
    <p><xref ref-type="fig" rid="f1">Figure 1</xref> shows the main functionalities from AlignmentViewer explained in more detail in the next subsections. The top sub-figure shows the
<italic>msa view</italic> with the sequence logo and the alignment capturing most of the attention. This view lets the user examine in depth the alignment. Each amino acid position is represented in sequence logo and the height shows users the information content of each position, in bits. Then, from left to right we show the
<italic>pixel view</italic>, a part of the
<italic>stats view</italic>, and the sequence space (with annotations). The
<italic>pixel view</italic> gives an overview display of the alignment to enable a coarse view of the alignment for better visualization and pattern identification. The all versus all sequence identity sub-figure in
<xref ref-type="fig" rid="f1">Figure 1</xref> (part of the
<italic>stats view</italic>) displays allows users to identify possible clusters in the alignment based on sequence identity. The bottom right sub-figure of
<xref ref-type="fig" rid="f1">Figure 1</xref> displays the sequences clustered by similarity (see section
<italic>Sequence space</italic>) highlighted by user-provided annotations to aid in interpretation of the clusters.</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
      <label>Figure 1. </label>
      <caption>
        <title>AlignmentViewer visualization of the beta-lactamase protein domain family.</title>
        <p>Bars above the sequence alignment quantify residue conservation. The alignment consensus logo (just below the bar chart) is based on the amino acid frequencies. Lower left:
<italic>pixel view</italic> of the alignment especially useful for large families; lower middle: protein-protein sequence similarity matrix graded by percentage identity; lower right: distribution of sequences in sequence space (UMAP projection), colored by species groups.</p>
      </caption>
      <graphic xlink:href="f1000research-9-30135-g0000"/>
    </fig>
    <sec>
      <title>MSA view</title>
      <p><bold><italic>Alignment details.</italic></bold> The
<italic>msa view</italic> page has summary information: number of sequences, conservation and gap counts for each position, a sequence logo, and the residues in one letter code. By default, columns with gaps in the reference sequence (first row) are omitted in order to facilitate visual focus on sequence patterns relative to a protein of interest and to avoid extremely gapped alignment views typical of many MSA presentations. The amino acids are colored using a conventional coloring scheme, adopted from Mview, based on amino acid properties.</p>
      <p><bold><italic>Sequence attributes and sorting.</italic></bold> Sequences in the alignment can be sorted using one of four different methods: (i) the original order provided by the user, (ii–iii) by % sequence identity between a particular sequence and the reference (top) sequence, relative to the first or the second (gaps not counted), and (iv) by user-provided (upload annotations tab) sequence weights or other attributes, such as alignment profile scores (e.g., HMM bit scores). Sequences can be filtered by sequence identity relative to a reference sequence or by percentage of gaps.</p>
    </sec>
    <sec>
      <title>Pixel view (suitable for large families)</title>
      <p>The
<italic>pixel view</italic> (
<italic>image view</italic> website tab) leads to an overview of the entire depth and breadth of an MSA. The amino acid letters are represented by small rectangles of pixels, retaining the amino acid type coloring (
<italic>image view</italic> tab). This striking visual impression can reveal patterns of conservation and variation, especially for large alignments. This is very useful to gain an intuitive view of sequence properties, noise at the uncertain edges of a protein family, as well as subfamily distributions. The coloring scheme can be by (1) amino acid properties, (2) hydrophobicity (red to blue) or (3) mutational difference (stronger color) in a sequence relative to the reference (first row) sequence.</p>
    </sec>
    <sec>
      <title>Stats view</title>
      <p>The
<italic>stats view</italic> tab leads to plots of statistical properties of the set of sequences in the alignment, including (i) sequence identity relative to the reference sequence, and (ii) min, max, and average of (i); and (iii) a pairwise sequence identity matrix in which each pixel represents the degree of similarity between two sequences, such that a block-diagonal structure of the matrix is indicative of distinct subfamilies, given, e.g., a tree-derived sequence order as user input. The ordering of sequences by phylogeny is (currently) not part of the tool and can be performed using external tools, e.g., Wasabi (
<xref rid="ref-10" ref-type="bibr">Veidenberg
<italic>et al.</italic>, 2016</xref>).</p>
    </sec>
    <sec>
      <title>Annotations and evolutionary couplings</title>
      <p>Users can upload custom numerical attributes or labels for the sequences in the MSA (
<italic>upload annotations</italic>) or evolutionary couplings between residue positions (
<italic>load couplings</italic>). Adding these attributes allows users to use sequence weights, compare different measures of sequence fitness (e.g., bitscore, sequence identity, statistical energy) or visualize evolutionary coupling constraints for pairs of positions.</p>
    </sec>
    <sec>
      <title>Sequence space</title>
      <p>Users can view representations of the MSA sequences in two- or three-dimensional space under the “sequence space” tab. These representations are generated using the Uniform Manifold Approximation and Projection (UMAP) dimensionality reduction algorithm (
<xref rid="ref-6" ref-type="bibr">McInnes
<italic>et al.</italic>, 2018</xref>), whichhas been adapted for Javascript using the
<ext-link ext-link-type="uri" xlink:href="https://github.com/PAIR-code/umap-js">umap-js library</ext-link> (
<ext-link ext-link-type="uri" xlink:href="https://github.com/PAIR-code/umap-js">https://github.com/PAIR-code/umap-js</ext-link>). The alignmentviewer.org implementation uses the number of amino acid differences between pairs of sequences (the Hamming distance) as the distance metric parameter. The algorithm then iteratively calculates an embedding in two- or three-dimensional space, which is displayed in real time for the end users. UMAP hyperparameters are set to reasonable defaults, but can also be configured via the settings panel. Sequences can be colored by user provided annotations ("upload annotations" tab).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>AlignmentViewer is a lightweight online viewer for biological multiple sequence alignments that focuses on usability and performance. Written in JavaScript, this tool can be used in many browsers. The architecture of AlignmentViewer allows its use without software installation and without an internet connection. The visualization capabilities, analysis features and metrics in AlignmentViewer are useful in many areas of biology, especially evolutionary, structural, synthetic and chemical biology. In the future we plan to add a visualization of species diversity, predicted contact maps, and organization by sequence subfamilies with specificity residues. A standalone version of AlignmentViewer is available at
<ext-link ext-link-type="uri" xlink:href="http://alignmentviewer.org/">alignmentviewer.org</ext-link> and is in use by external services including EVcouplings.org. AlignmentViewer is an open source project hosted on GitHub, which welcomes engagement of interested members of the community.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data underlying the results are available as part of the article and no additional source data are required.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p><bold>AlignmentViewer website and demo can be found at:</bold><ext-link ext-link-type="uri" xlink:href="https://alignmentviewer.org/">https://alignmentviewer.org/</ext-link>.</p>
    <p><bold>Source code available at:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/sanderlab/alignmentviewer">https://github.com/sanderlab/alignmentviewer</ext-link>.</p>
    <p><bold>Archived source code at time of publication:</bold><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4063551">https://doi.org/10.5281/zenodo.4063551</ext-link> (
<xref rid="ref-7" ref-type="bibr">Reguant, 2020</xref>).</p>
    <p><bold>License:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/sanderlab/alignmentviewer/blob/master/LICENSE">MIT license</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Debora Marks for constructive discussions.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>NP</given-names></name><name><surname>Leroy</surname><given-names>C</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>MView: a web-compatible database search or multiple alignment viewer.</article-title><source><italic toggle="yes">Bioinforma.</italic></source><year>1998</year>;<volume>14</volume>(<issue>4</issue>):<fpage>380</fpage>–<lpage>381</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/14.4.380</pub-id><?supplied-pmid 9632837?><pub-id pub-id-type="pmid">9632837</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname><given-names>T</given-names></name><name><surname>Hecht</surname><given-names>M</given-names></name><name><surname>Hamp</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>LocTree3 prediction of localization.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2014</year>;<volume>42</volume>(Web Server issue):<fpage>W350</fpage>–<lpage>W355</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gku396</pub-id><!--<pub-id pub-id-type="pmcid">4086075</pub-id>--><?supplied-pmid 24848019?><pub-id pub-id-type="pmid">24848019</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname><given-names>TA</given-names></name><name><surname>Green</surname><given-names>AG</given-names></name><name><surname>Schubert</surname><given-names>B</given-names></name><etal/></person-group>:
<article-title>The EVcouplings Python framework for coevolutionary sequence analysis.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2019</year>;<volume>35</volume>(<issue>9</issue>):<fpage>1582</fpage>–<lpage>1584</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bty862</pub-id><!--<pub-id pub-id-type="pmcid">6499242</pub-id>--><?supplied-pmid 30304492?><pub-id pub-id-type="pmid">30304492</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsson</surname><given-names>A</given-names></name></person-group>:
<article-title>AliView: a fast and lightweight alignment viewer and editor for large datasets.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>22</issue>):<fpage>3276</fpage>–<lpage>3278</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu531</pub-id><!--<pub-id pub-id-type="pmcid">4221126</pub-id>--><?supplied-pmid 25095880?><pub-id pub-id-type="pmid">25095880</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marks</surname><given-names>DS</given-names></name><name><surname>Colwell</surname><given-names>LJ</given-names></name><name><surname>Sheridan</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Protein 3D structure computed from evolutionary sequence variation.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>2011</year>;<volume>6</volume>(<issue>12</issue>);<fpage>e28766</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0028766</pub-id><!--<pub-id pub-id-type="pmcid">3233603</pub-id>--><?supplied-pmid 22163331?><pub-id pub-id-type="pmid">22163331</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Melville</surname><given-names>J</given-names></name></person-group>:
<article-title>Umap: Uniform manifold approximation and projection for dimension reduction.</article-title>arXiv preprint. arXiv: 1802.03426.<fpage>2018</fpage><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/1802.03426.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reguant</surname><given-names>R</given-names></name></person-group>:
<article-title>Alignmentviewer (Version v2.1)</article-title>.
<source><italic toggle="yes">Zenodo.</italic></source><fpage>2020</fpage><pub-id pub-id-type="doi">10.5281/zenodo.4063551</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamames</surname><given-names>J</given-names></name><name><surname>Ouzounis</surname><given-names>C</given-names></name><name><surname>Casari</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>EUCLID: automatic classification of proteins in functional classes by their database annotations.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>1998</year>;<volume>14</volume>(<issue>6</issue>):<fpage>542</fpage>–<lpage>3</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/14.6.542</pub-id><?supplied-pmid 9694995?><pub-id pub-id-type="pmid">9694995</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toth-Petroczy</surname><given-names>A</given-names></name><name><surname>Palmedo</surname><given-names>P</given-names></name><name><surname>Ingraham</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Structured States of Disordered Proteins from Genomic Sequences.</article-title><source><italic toggle="yes">Cell.</italic></source><year>2016</year>;<volume>167</volume>(<issue>1</issue>);<fpage>158</fpage>–<lpage>170.e12</lpage>.
<pub-id pub-id-type="doi">10.1016/j.cell.2016.09.010</pub-id><!--<pub-id pub-id-type="pmcid">5451116</pub-id>--><?supplied-pmid 27662088?><pub-id pub-id-type="pmid">27662088</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veidenberg</surname><given-names>A</given-names></name><name><surname>Medlar</surname><given-names>A</given-names></name><name><surname>Löytynoja</surname><given-names>A</given-names></name></person-group>:
<article-title>Wasabi: An Integrated Platform for Evolutionary Sequence Analysis and Data Visualization.</article-title><source><italic toggle="yes">Mol Biol Evol.</italic></source><year>2016</year>;<volume>33</volume>(<issue>4</issue>):<fpage>1126</fpage>–<lpage>1130</lpage>.
<pub-id pub-id-type="doi">10.1093/molbev/msv333</pub-id><?supplied-pmid 26635364?><pub-id pub-id-type="pmid">26635364</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waterhouse</surname><given-names>AM</given-names></name><name><surname>Procter</surname><given-names>JB</given-names></name><name><surname>Martin</surname><given-names>DM</given-names></name><etal/></person-group>:
<article-title>Jalview Version 2--a multiple sequence alignment editor and analysis workbench.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>9</issue>):<fpage>1189</fpage>–<lpage>91</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp033</pub-id><!--<pub-id pub-id-type="pmcid">2672624</pub-id>--><?supplied-pmid 19151095?><pub-id pub-id-type="pmid">19151095</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yachdav</surname><given-names>G</given-names></name><name><surname>Wilzbach</surname><given-names>S</given-names></name><name><surname>Rauscher</surname><given-names>B</given-names></name><etal/></person-group>:
<article-title>MSAViewer: interactive JavaScript visualization of multiple sequence alignments.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2016</year>;<volume>32</volume>(<issue>22</issue>):<fpage>3501</fpage>–<lpage>3503</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btw474</pub-id><!--<pub-id pub-id-type="pmcid">5181560</pub-id>--><?supplied-pmid 27412096?><pub-id pub-id-type="pmid">27412096</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report73164" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.30135.r73164</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="r73164a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6982-4660</contrib-id>
      </contrib>
      <aff id="r73164a1"><label>1</label>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2020 Bateman A</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1196" ext-link-type="doi" xlink:href="10.12688/f1000research.22242.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have addressed my concerns fully.</p>
    <p> The authors may wish to double check the alignment of the example 1KR:A on the website. It does not look well aligned to my eyes. This suggestion is not required for approval of the manuscript.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Computational biology with specialism in biological databases and analysis of protein families.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report61763" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.24533.r61763</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="r61763a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6982-4660</contrib-id>
      </contrib>
      <aff id="r61763a1"><label>1</label>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2020 Bateman A</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1284" ext-link-type="doi" xlink:href="10.12688/f1000research.22242.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Overall there is a need for Javascript based alignment viewers which can handle large numbers of sequences. So this software is rather timely. However, I think the current implementation seems to still contain significant bugs and the web page requires a round of user experience testing to make it easier to use and interpret the results. Once these improvements are made then I think this has the potential to be a very useful tool.</p>
    <p>
      <bold>Manuscript changes:</bold>
    </p>
    <p> Please fix capitalisation of PFAM to Pfam</p>
    <p>
      <bold>Software/Website changes:</bold>
    </p>
    <p> The computing conservation box is annoyingly placed. It does not go away and covers the UMAP view significantly.</p>
    <p> I really need an estimate of how long it will take for the pairwise identity to load. Some time passes…I didn’t realise I had to click on calculate to get the pairwise identity to show. Please UX test this page to make it easier/clearer for the user to understand what to do.  </p>
    <p> For the top graph on the stats view the three colours used for max/average and min identity are hard to distinguish. Please use a broader colour palette. Please add axis legends for this graph and make it clearer what the title of this graph is. The title is very clear for the bottom plot.</p>
    <p> Please add alternative colouring schemes for viewing the alignments. It makes a surprisingly big difference for experienced users ability to interpret an alignment. I personally like the ClustalX colouring scheme that is widely adopted, but there are other popular schemes it would be nice to incorporate as options.</p>
    <p> “Based on this and other small tests we can safely state that any computer that is able to run any modern web browser will be able to run any alignment that requires visualization”. This is overstating the case. Needs to be toned down. Try testing the software on the ABC transporter family (PF00005) alignment in Pfam. The NCBI alignment contains 2.6 million sequences. If it works seamlessly for that then you can safely state.</p>
    <p> I tried to hook the viewer up to a Pfam alignment which is not very large (840 sequences). I got a box that said Fetching file…and no response beyond that.</p>
    <p> https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=fasta&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</p>
    <p> also tried Stockholm format with no luck.</p>
    <p> https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</p>
    <p> I also tried with a Pfam family with just 3 sequences. Still with no luck.</p>
    <p> I got the viewer to work by uploading a Pfam alignment in fasta format with 3 sequences. Then I tried uploading the seed alignment for the CBS domain downloaded from Pfam in fasta format. I then got the following error:</p>
    <p> Parsing error: sequence #3 has different length.</p>
    <p> The first few lines of the alignment are included below and the third sequence appears to be the same length as all the others.</p>
    <p> &gt;Q8EHI4_SHEON/79-134</p>
    <p> I........H.Q...V........MTR........NP.........V.......TVAPY.</p>
    <p> ...VS.LDVAS....RT..L.....L....E.....HN..I.....G..CL.P.V.L...</p>
    <p> .........ENG....D......LV.GIVTWKDLLRAYCA</p>
    <p> &gt;Q97V95_SULSO/193-248</p>
    <p> V........L.D...A.......G.TK........NP.........I.......TINRY.</p>
    <p> ...YS.ILNAA....KL..M.....I....E.....KR..I.....G..TL.L.V.M...</p>
    <p> .......E..NQ....K......LV.GIVTERDLMYAYIN</p>
    <p> &gt;Q6M020_METMP/269-321</p>
    <p> V........K.E...I.........MS........PP.........V.......MVSPE.</p>
    <p> ...AA.LNELI....KG..M.....A....N.........T.....D..RV.Y.V.V...</p>
    <p> .........DNG....N......IL.GIISKTDIVRTLSI</p>
    <p> &gt;Q72KI1_THET2/367-424</p>
    <p> V........E.G...F.........LA........RA.........V.......VLPPS.</p>
    <p> ...TP.LSQVE....PR..L..........R.....EA..G.....G..RV.L.V.GE..</p>
    <p> .......RAGEG...WR......LL.GIYTRTDLYRSAPK</p>
    <p> &gt;Q8TX96_METKA/244-298</p>
    <p> A........R.N...Y.......L..Q........EM.........V.......VVPPE.</p>
    <p> ...TP.LHEAL....WE..V.........ID.....KM..S.....D..RI.Y.V.M...</p>
    <p> ..........DG.....R....KLT.GVVPLIDAVYTLAK</p>
    <p> &gt;Q836T2_ENTFA/77-132</p>
    <p> V........Q.E...I........MSP........PL.................MVAQD.</p>
    <p> ...TS.IRDAI....TN..L................FMYDV.....G..SL.Y.V.M...</p>
    <p> ........DEAK....E......LL.GVLSRKDLLRASLN</p>
    <p> &gt;Q8XIV1_CLOPE/77-131</p>
    <p> V........K.D...I.........MS........KP.........V.......TVCEE.</p>
    <p> ...TM.LHDAI....VH.LF.....L...ND.........V.....G..TM.F.VEN...</p>
    <p> ..........GG....V......LT.GAVSRKDFLKVAIG</p>
    <p> If I delete the third sequence and re-upload I get exactly the same error.</p>
    <p> For info I carried out tests with Firefox for Mac version 74.0 and Safari Version 13.1</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Computational biology with specialism in biological databases and analysis of protein families.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment6023-61763" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Reguant</surname>
            <given-names>Roc</given-names>
          </name>
          <aff>Dana-Farber Cancer Institute and Harvard Medical School, USA</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>9</day>
        <month>10</month>
        <year>2020</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic>
          <underline>Manuscript changes:</underline>
        </italic>
      </p>
      <p>
        <italic>Please fix capitalisation of PFAM to Pfam</italic>
      </p>
      <p><bold>Response: </bold>The manuscript has been updated to Pfam.</p>
      <p>
        <italic>
          <underline>Software/Website changes:</underline>
        </italic>
      </p>
      <p>
        <italic>The computing conservation box is annoyingly placed. It does not go away and covers the UMAP view significantly.</italic>
      </p>
      <p><bold>Response: </bold>This bug has now been fixed - the pop-up will disappear after the alignment has been loaded.</p>
      <p>
        <italic>I really need an estimate of how long it will take for the pairwise identity to load. Some time passes…I didn’t realise I had to click on calculate to get the pairwise identity to show. Please UX test this page to make it easier/clearer for the user to understand what to do.  </italic>
      </p>
      <p><bold>Response: </bold>We have added a button into the middle of the plot to indicate that an action needs to be taken by the user to begin calculating pairwise sequence identity.</p>
      <p>
        <italic>For the top graph on the stats view the three colours used for max/average and min identity are hard to distinguish. Please use a broader colour palette. Please add axis legends for this graph and make it clearer what the title of this graph is. The title is very clear for the bottom plot.</italic>
      </p>
      <p><bold>Response: </bold>We have updated the color palette to increase the contrast, added axis labels and added a clear title. </p>
      <p>
        <italic>Please add alternative colouring schemes for viewing the alignments. It makes a surprisingly big difference for experienced users ability to interpret an alignment. I personally like the ClustalX colouring scheme that is widely adopted, but there are other popular schemes it would be nice to incorporate as options.</italic>
      </p>
      <p><bold>Response: </bold>We agree alternative coloring schemes are useful and have added the clustal colors as a drop-down option on the main page as well as in the image view.</p>
      <p>
        <italic>“Based on this and other small tests we can safely state that any computer that is able to run any modern web browser will be able to run any alignment that requires visualization”. This is overstating the case. Needs to be toned down. Try testing the software on the ABC transporter family (PF00005) alignment in Pfam. The NCBI alignment contains 2.6 million sequences. If it works seamlessly for that then you can safely state.</italic>
      </p>
      <p><bold>Response: </bold>We agree with the reviewer that the phrasing was optimistic and have removed the sentence from the main manuscript.</p>
      <p>
        <italic>I tried to hook the viewer up to a Pfam alignment which is not very large (840 sequences). I got a box that said Fetching file…and no response beyond that.</italic>
      </p>
      <p>
        <italic>https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=fasta&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</italic>
      </p>
      <p>
        <italic>also tried Stockholm format with no luck.</italic>
      </p>
      <p>
        <italic>
          <ext-link ext-link-type="uri" xlink:href="https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0">https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</ext-link>
        </italic>
      </p>
      <p><bold>Response: </bold>There are two technical limitations inherent to how requests happen in the browser. We take as an example your suggested URL:
<ext-link ext-link-type="uri" xlink:href="https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0">https://alignmentviewer.org/?url=http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</ext-link></p>
      <p>Limitation 1: The alignmentviewer.org website is hosted as a secure site under https. However, the location of the requested alignment (from Pfam) is passed via an insecure connection (http). For security reasons mixing different protocols (also called "mixed content", see
<ext-link ext-link-type="uri" xlink:href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content</ext-link>) is not allowed.</p>
      <p>Limitation 2: the string passed to the query parameter URL (aka. what follows "?url=") needs to be sanitized before being served. More information about this can be found here:
<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Query_string#URL_encoding">https://en.wikipedia.org/wiki/Query_string#URL_encoding</ext-link>. For clarity, we have updated the example in the main text to be stanitized / encoded.  </p>
      <p>In your example, the alignment lives at "
<ext-link ext-link-type="uri" xlink:href="http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0">http://pfam.xfam.org/family/PF00571/alignment/seed/format?format=stockholm&amp;alnType=seed&amp;order=t&amp;case=l&amp;gaps=default&amp;download=0</ext-link>". Passing the string as-is will confuse the browser that will interpret e.g. "&amp;gaps=" as query for alignmentviewer rather than for
<ext-link ext-link-type="uri" xlink:href="http://pfam.xfam.org/">pfam.xfam.org</ext-link> . Many languages offer built-in functions to sanitize strings to be passed to URL queries (e.g. in a JavaScript frontend application, using the window.encodeURIComponent() function; an interactive website can be found here:
<ext-link ext-link-type="uri" xlink:href="https://www.url-encode-decode.com/">https://www.url-encode-decode.com</ext-link>). By doing so, the string proposed for the alignment would result in: "http%3A%2F%
<ext-link ext-link-type="uri" xlink:href="http://2fpfam.xfam.org/">2Fpfam.xfam.org</ext-link>%2Ffamily%2FPF00571%2Falignment%2Fseed%2Fformat%3Fformat%3Dstockholm%26alnType%3Dseed%26order%3Dt%26case%3Dl%26gaps%3Ddefault%26download%3D0".</p>
      <p>Conclusion: considering the two inherit browser limitations mentioned above, your requests can be sanitized and fixed as follows:</p>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://alignmentviewer.org/?url=https%3A%2F%2Fpfam.xfam.org%2Ffamily%2FPF00571%2Falignment%2Fseed%2Fformat%3Fformat%3Dfasta%26alnType%3Dseed%26order%3Dt%26case%3Dl%26gaps%3Ddefault%26download%3D0">https://alignmentviewer.org/?url=https%3A%2F%2Fpfam.xfam.org%2Ffamily%2FPF00571%2Falignment%2Fseed%2Fformat%3Fformat%3Dfasta%26alnType%3Dseed%26order%3Dt%26case%3Dl%26gaps%3Ddefault%26download%3D0</ext-link>
      </p>
      <p>Again, note that for both URLs the protocol has been changed to "https" instead of "http", and that the string that follows "&amp;url=" has been sanitized using Chrome's built-in console and the "window.encodeURIComponent(x)" function, where x is the string to be sanitized. We have added some text to the manuscript to highlight these requirements.</p>
      <p>
        <italic>I also tried with a Pfam family with just 3 sequences. Still with no luck.</italic>
      </p>
      <p>
        <italic>I got the viewer to work by uploading a Pfam alignment in fasta format with 3 sequences. Then I tried uploading the seed alignment for the CBS domain downloaded from Pfam in fasta format. I then got the following error:</italic>
      </p>
      <p>
        <italic>Parsing error: sequence #3 has different length.</italic>
      </p>
      <p>
        <italic>The first few lines of the alignment are included below and the third sequence appears to be the same length as all the others.</italic>
      </p>
      <p>
        <italic>&gt;Q8EHI4_SHEON/79-134</italic>
      </p>
      <p>
        <italic>I........H.Q...V........MTR........NP.........V.......TVAPY.</italic>
      </p>
      <p>
        <italic>...VS.LDVAS....RT..L.....L....E.....HN..I.....G..CL.P.V.L...</italic>
      </p>
      <p>
        <italic>.........ENG....D......LV.GIVTWKDLLRAYCA</italic>
      </p>
      <p>
        <italic>&gt;Q97V95_SULSO/193-248</italic>
      </p>
      <p>
        <italic>V........L.D...A.......G.TK........NP.........I.......TINRY.</italic>
      </p>
      <p>
        <italic>...YS.ILNAA....KL..M.....I....E.....KR..I.....G..TL.L.V.M...</italic>
      </p>
      <p>
        <italic>.......E..NQ....K......LV.GIVTERDLMYAYIN</italic>
      </p>
      <p>
        <italic>&gt;Q6M020_METMP/269-321</italic>
      </p>
      <p>
        <italic>V........K.E...I.........MS........PP.........V.......MVSPE.</italic>
      </p>
      <p>
        <italic>...AA.LNELI....KG..M.....A....N.........T.....D..RV.Y.V.V...</italic>
      </p>
      <p>
        <italic>.........DNG....N......IL.GIISKTDIVRTLSI</italic>
      </p>
      <p>
        <italic>&gt;Q72KI1_THET2/367-424</italic>
      </p>
      <p>
        <italic>V........E.G...F.........LA........RA.........V.......VLPPS.</italic>
      </p>
      <p>
        <italic>...TP.LSQVE....PR..L..........R.....EA..G.....G..RV.L.V.GE..</italic>
      </p>
      <p>
        <italic>.......RAGEG...WR......LL.GIYTRTDLYRSAPK</italic>
      </p>
      <p>
        <italic>&gt;Q8TX96_METKA/244-298</italic>
      </p>
      <p>
        <italic>A........R.N...Y.......L..Q........EM.........V.......VVPPE.</italic>
      </p>
      <p>
        <italic>...TP.LHEAL....WE..V.........ID.....KM..S.....D..RI.Y.V.M...</italic>
      </p>
      <p>
        <italic>..........DG.....R....KLT.GVVPLIDAVYTLAK</italic>
      </p>
      <p>
        <italic>&gt;Q836T2_ENTFA/77-132</italic>
      </p>
      <p>
        <italic>V........Q.E...I........MSP........PL.................MVAQD.</italic>
      </p>
      <p>
        <italic>...TS.IRDAI....TN..L................FMYDV.....G..SL.Y.V.M...</italic>
      </p>
      <p>
        <italic>........DEAK....E......LL.GVLSRKDLLRASLN</italic>
      </p>
      <p>
        <italic>&gt;Q8XIV1_CLOPE/77-131</italic>
      </p>
      <p>
        <italic>V........K.D...I.........MS........KP.........V.......TVCEE.</italic>
      </p>
      <p>
        <italic>...TM.LHDAI....VH.LF.....L...ND.........V.....G..TM.F.VEN...</italic>
      </p>
      <p>
        <italic>..........GG....V......LT.GAVSRKDFLKVAIG</italic>
      </p>
      <p>
        <italic>If I delete the third sequence and re-upload I get exactly the same error.</italic>
      </p>
      <p>
        <italic>For info I carried out tests with Firefox for Mac version 74.0 and Safari Version 13.1</italic>
      </p>
      <p><bold>Response: </bold>Thank you for pointing out this issue. This bug occurred when refreshing an internal variable, and has now been fixed.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report61767" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.24533.r61767</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lekholm</surname>
          <given-names>Erik Larsson</given-names>
        </name>
        <xref ref-type="aff" rid="r61767a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r61767a1"><label>1</label>Department of Medical Biochemistry and Cell Biology, Institute of Biomedicine, The Sahlgrenska Academy, University of Gothenburg, Gothenburg, Sweden</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>I was a postdoc in Chris Sander's lab at MSKCC, NYC, during 2009-2011. I confirm that this competing interest has not affected my ability to write an objective and unbiased review of the article.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2020 Lekholm EL</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1848" ext-link-type="doi" xlink:href="10.12688/f1000research.22242.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This Software Tool article, describing a web-based sequence alignment viewer (AlignmentViewer), is well-written and very clearly presented. The introduction nicely motivates the need for this tool, given the many other available alternatives. The main features of the software are clearly explained in the article. The tool in itself seems useful and ran quickly and efficiently when tested on sample data. I have only a few minor comments that may be considered by the authors:</p>
    <p>
      <bold>Minor:</bold>
      <list list-type="bullet">
        <list-item>
          <p>A little bit of detail may be added to the “Sequence space” section. “Two- or three-dimensional sequence space” is at first a bit confusing, as no information has been given at that stage as to what it means. How is UMAP applied to the Hamming distances? Is each sequence first represented by a vector of Hamming distances, with each element corresponding to one of the included sequences? Maybe this can be clarified with a few additional words.</p>
        </list-item>
        <list-item>
          <p>The following sentence is somewhat confusing: "
<ext-link ext-link-type="uri" xlink:href="https://f1000research.com/my/referee/report/61767#f1">Figure 1</ext-link> shows the main functionalities from AlignmentViewer (
<ext-link ext-link-type="uri" xlink:href="https://f1000research.com/my/referee/report/61767#ref-7">Reguant, 2020</ext-link>) explained in more detail in the next subsections.”</p>
        </list-item>
        <list-item>
          <p>"This view lets the user examine in depth the alignment.” - should it be “examine the alignment in depth"?</p>
        </list-item>
        <list-item>
          <p>When loading an alignment using a somewhat older version of Safari (12.1.2), the “computing conservation” window does not disappear after the operation finishes. This problem was absent in Chrome.</p>
        </list-item>
      </list>
    </p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Genomics, bioinformatics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment5469-61767" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Sander</surname>
            <given-names>Chris</given-names>
          </name>
          <aff>Dana-Farber Cancer Institute and Harvard Medical School, USA</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>29</day>
        <month>4</month>
        <year>2020</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for your comments and suggestions - they are spot on.</p>
      <p>We will work on taking these into account on the web site and in the next version of the manuscript.</p>
      <p>Chris Sander - DFCI and HMS</p>
    </body>
  </sub-article>
  <sub-article id="comment6022-61767" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Reguant</surname>
            <given-names>Roc</given-names>
          </name>
          <aff>Dana-Farber Cancer Institute and Harvard Medical School, USA</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>9</day>
        <month>10</month>
        <year>2020</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <italic>A little bit of detail may be added to the “Sequence space” section. “Two- or three-dimensional sequence space” is at first a bit confusing, as no information has been given at that stage as to what it means. How is UMAP applied to the Hamming distances? Is each sequence first represented by a vector of Hamming distances, with each element corresponding to one of the included sequences? Maybe this can be clarified with a few additional words. </italic>
      </p>
      <p>
        <bold>Response: We agree that a bit more detail is warranted and have updated the manuscript that describes using the hamming distance between individual sequences as the distance metric (parameter) for UMAP. </bold>
      </p>
      <p>
        <italic>The following sentence is somewhat confusing: "Figure 1 shows the main functionalities from AlignmentViewer (Reguant, 2020) explained in more detail in the next subsections.”</italic>
      </p>
      <p>
        <bold>Response: We have updated the manuscript to make it more understandable. The citation to Reguant 2020 was also confusing (it points to the codebase) so we moved that codebase DOI to a single instance at the end of the manuscript.</bold>
      </p>
      <p>
        <bold> </bold>
      </p>
      <p>
        <italic>"This view lets the user examine in depth the alignment.” - should it be “examine the alignment in depth"?</italic>
      </p>
      <p>
        <bold>Response: The manuscript has been corrected.</bold>
      </p>
      <p>
        <bold> </bold>
      </p>
      <p>
        <italic>When loading an alignment using a somewhat older version of Safari (12.1.2), the “computing conservation” window does not disappear after the operation finishes. This problem was absent in Chrome.</italic>
      </p>
      <p>
        <bold>Response: Thank you for noticing this bug. We have now corrected the issue and the dialog disappears when using Safari.</bold>
      </p>
    </body>
  </sub-article>
</sub-article>
