<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8590130</article-id>
    <article-id pub-id-type="publisher-id">4463</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04463-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cosinoRmixedeffects: an R package for mixed-effects cosinor models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hou</surname>
          <given-names>Ruixue</given-names>
        </name>
        <address>
          <email>ruixue.hou@mountsinai.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tomalin</surname>
          <given-names>Lewis E.</given-names>
        </name>
        <address>
          <email>lewis.tomalin@mountsinai.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8712-3553</contrib-id>
        <name>
          <surname>Suárez-Fariñas</surname>
          <given-names>Mayte</given-names>
        </name>
        <address>
          <email>Mayte.SuarezFarinas@mssm.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution>Department of Population Health Science and Policy, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.416167.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 0442 1996</institution-id><institution>Department of Population Health Science and Policy, </institution><institution>Mount Sinai Clinical Informatics Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution>Department of Genetics and Genomics, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>553</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Wearable devices enable monitoring and measurement of physiological parameters over a 24-h period, and some of which exhibit circadian rhythm characteristics. However, the currently available R package <italic>cosinor</italic> could only analyze daily cross-sectional data and compare the parameters between groups with two levels. To evaluate longitudinal changes in the circadian patterns, we need to extend the model to a mixed-effect model framework, allowing for random effects and interaction between COSINOR parameters and time-varying covariates.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed the <italic>cosinoRmixedeffects</italic> R package for modelling longitudinal periodic data using mixed-effects cosinor models. The model allows for covariates and interactions with the non-linear parameters MESOR, amplitude, and acrophase. To facilitate ease of use, the package utilizes the syntax and functions of the widely used <italic>emmeans</italic> package to obtain estimated marginal means and contrasts. Estimation and hypothesis testing involving the non-linear circadian parameters are carried out using bootstrapping. We illustrate the package functionality by modelling daily measurements of heart rate variability (HRV) collected among health care workers over several months. Differences in circadian patterns of HRV between genders, BMI, and during infection with SARS-CoV2 are evaluated to illustrate how to perform hypothesis testing.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3"><italic>cosinoRmixedeffects</italic> package provides the model fitting, estimation and hypothesis testing for the mixed-effects COSINOR model, for the linear and non-linear circadian parameters MESOR, amplitude and acrophase. The model accommodates factors with any number of categories, as well as complex interactions with circadian parameters and categorical factors.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04463-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Circadian data</kwd>
      <kwd>Cosinor</kwd>
      <kwd>Mixed-effects</kwd>
      <kwd>Wearable data</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>mount sinai clinical intelligence center</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Circadian rhythms play a key role in many physiological processes, including sleep/wake cycles, hormone secretion and neural function [<xref ref-type="bibr" rid="CR1">1</xref>]. Wearable devices (such as smart watches) can monitor health-related physiological parameters and, coupled with AI technology, can provide low cost, non-invasive monitoring of chronic conditions [<xref ref-type="bibr" rid="CR2">2</xref>], broadening access to health care. Many physiological parameters collected by wearable devices exhibit a circadian pattern (e.g., heart rate variability (HRV)). Current technology does not continuously record such parameters over a 24-h period, but rather follows a sparse and non-uniform sampling [<xref ref-type="bibr" rid="CR3">3</xref>], therefore, readily derived variables (i.e. mean, range of the data within the day) would ignore this circadian pattern and introduce bias if used to develop AI algorithms, hindering accuracy. Therefore, development of techniques that appropriately model the non-uniform, sparsely sampled circadian rhythm data in a longitudinal setting, and implement a proper hypothesis testing framework, are needed to advance the use of integrated wearable data for prediction of any relevant outcomes.</p>
    <p id="Par8">Daily circadian rhythm has been modeled by a non-linear COSINOR method with three rhythm characteristics: the rhythm-adjusted mean (MESOR), half the extent of variation within a cycle (amplitude), and an angle relating to the time at which peak values recur in each cycle (acrophase) [<xref ref-type="bibr" rid="CR4">4</xref>]. The currently available R package <italic>cosinor</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] implements such a model and allows the user to evaluate cross-sectional differences in the COSINOR parameters between groups with only two levels. However, if we have a daily circadian curve, repeated over a period of time, and we aim to investigate how this daily pattern changes in relationship to a factor or intervention, we cannot use the <italic>cosinor</italic> package, as it does not account for correlations within individuals. Therefore, to evaluate longitudinal changes in the circadian patterns, we extended the COSINOR model to a mixed-effect model framework, allowing for random effects and interaction between COSINOR parameters and time-varying covariates. We recently proposed a mixed-effect COSINOR model framework to evaluate changes in circadian HRV patterns after infection with SARS-CoV2 in healthcare workers [<xref ref-type="bibr" rid="CR6">6</xref>], as well as to evaluate the association of HRV and self-reported stress [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par9">Here, we present an open-source R package for our cosinor mixed-effect model, <italic>cosinoRmixedeffects</italic>, which can assume random circadian rhythm parameters for each subject when modelling longitudinal changes of daily data. <italic>CosinoRmixedeffects</italic> uses <italic>lme4</italic> package [<xref ref-type="bibr" rid="CR8">8</xref>] for model fitting, and is integrated with the <italic>emmeans</italic> package [<xref ref-type="bibr" rid="CR9">9</xref>] for obtaining estimated marginal means (EMMs) across levels of categorical factors (not only binary), and estimate differences between these levels. To illustrate utilization, <italic>cosinoRmixedeffects</italic> includes a vignette with detailed explanations of three models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). While the example framework in the vignette is described using HRV as an outcome, it can be applied to any outcome that displays circadian pattern characteristics. To the authors’ knowledge, <italic>cosinoRmixedeffects</italic> is the only R package currently available providing estimation and prediction of a mixed-effects COSINOR model for longitudinal periodic data with multi-level group comparisons.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par10">The COSINOR model was used to model daily circadian rhythm over a 24 h period with the non-linear function:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Y(t)}} = {\text{M}} + {\text{Acos}}\left( {{2}\uppi {\text{t}}/\uptau +\upphi } \right) + {\text{e}}_{{\text{i}}} ({\text{t}})$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtext>Y(t)</mml:mtext><mml:mo>=</mml:mo><mml:mtext>M</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Acos</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">π</mml:mi><mml:mtext>t</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">ϕ</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mtext>e</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>t</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4463_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where τ, M, A and Φ are the period, MESOR, amplitude and acrophase respectively [<xref ref-type="bibr" rid="CR4">4</xref>]. This non-linear model can be transformed into a linear model by recoding time (t) into two new variables x and z as x = cos(2πt/τ), z = sin(2πt/τ). HRV can then be written as:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Y(t)}} = {\text{M}} +\upbeta \times {\text{x}}_{{\text{t}}} +\upgamma \times {\text{z}}_{{\text{t}}} + {\text{e}}_{{\text{i}}} {\text{(t)}}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtext>Y(t)</mml:mtext><mml:mo>=</mml:mo><mml:mtext>M</mml:mtext><mml:mo>+</mml:mo><mml:mi mathvariant="normal">β</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mtext>x</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mtext>z</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext>e</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mtext>(t)</mml:mtext></mml:mrow></mml:math><graphic xlink:href="12859_2021_4463_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par11">To broaden this to a longitudinal framework, where individual circadian patterns change over a period of many days, we extended the model (Eq. <xref rid="Equ1" ref-type="">1</xref>) to a mixed-effect COSINOR model, where the measure Y of subject <italic>i</italic> at time <italic>t</italic> can be written as Y<sub>it</sub> = (M + β × x<sub>it</sub> + γ × z<sub>it</sub>) + W<sub>it</sub> × θ<sub>i</sub> + e<sub>i</sub>(t), e<sub>i</sub>(t) ~ N(0, s), where θ<sub>i</sub> is a vector of random effects with multivariate normal distribution θ<sub>i</sub> ~ N(0,Σ) that intrinsically modeled the within-patient correlation. To measure the impact of a covariate C on the daily circadian curve, we can include C as fixed effects and its interaction with x and z:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Y}}_{{{\text{it}}}} = {\text{M}} + \upalpha _{{\text{o}}} {\text{C}}_{{\text{i}}} + \left( {\upbeta + \upalpha _{{2}} {\text{C}}_{{\text{i}}} } \right) \times {\text{x}}_{{{\text{it}}}} + \left( {\upgamma + \upalpha _{{3}} {\text{C}}_{{\text{i}}} } \right) \times {\text{z}}_{{{\text{it}}}} + {\text{W}}_{{{\text{it}}}} \times\uptheta _{{\text{i}}} + {\text{e}}_{{\text{i}}} ({\text{t}})$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:msub><mml:mtext>Y</mml:mtext><mml:mtext>it</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mtext>M</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">α</mml:mi><mml:mtext>o</mml:mtext></mml:msub><mml:msub><mml:mtext>C</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mtext>C</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:msub><mml:mtext>x</mml:mtext><mml:mtext>it</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">α</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mtext>C</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:msub><mml:mtext>z</mml:mtext><mml:mtext>it</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext>W</mml:mtext><mml:mtext>it</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">θ</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext>e</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>t</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2021_4463_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par12">Hypothesis testing can be performed for any comparison, provided it can be written as a linear function of α’s, β and γ parameters.</p>
    <p id="Par13">To test for differences in COSINOR parameters M, A and ϕ between the populations defined by the covariate C, we used a bootstrapping procedure, where for each resampling iteration we:<list list-type="order"><list-item><p id="Par14">Fit a linear mixed-effect model by reweighted least squares;</p></list-item><list-item><p id="Par15">Estimate the marginal means obtaining the linear parameters for each group defined by C;</p></list-item><list-item><p id="Par16">Use the inverse relationship to obtain EMMs for M, A and ϕ of each group defined by C;</p></list-item><list-item><p id="Par17">Define the bootstrapping statistics as the pairwise differences of M, A and ϕ between groups defined by C.</p></list-item></list></p>
    <p id="Par18">These iterations were then used to define confidence intervals for the non-linear parameter with standard bootstrapping, and to derive <italic>p</italic>-values for the differences of each non-linear parameter, between groups defined by C.</p>
    <p id="Par19">In dealing with missing data, mixed-effects models utilize all observed data and produce robust estimates under the missing at random (MAR) assumption. On the other hand, generalized estimating equation (GEE) approaches and most imputation procedures, like complete case analysis and last-observed-carry-forward, require a much stronger missing completely at random (MCAR) assumption. As such, mixed-effects models are recommended as a more efficient and reliable method of primary analysis for clinical studies [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. If the number of missing values is large, the cosinor mixed-effects models could be followed up with sensitivity analysis, including imputation methods or combined with multiple imputation procedures.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <p id="Par20">The usage of <italic>cosinoRmixedeffects</italic> is illustrated with a subset of data from the Warrior Watch Study™ of Mount Sinai Health System (n = 121). In the study, health care workers were monitored by a smartphone app that remotely collected physiological data at non-uniform times across days [<xref ref-type="bibr" rid="CR12">12</xref>]. HRV exhibits a 24-h circadian pattern, and changes in this pattern can be used to identify different physiological states [<xref ref-type="bibr" rid="CR13">13</xref>]. HRV has also been found to be associated with infection and correlated with its severity [<xref ref-type="bibr" rid="CR14">14</xref>]. Here, we present how to use the functions in the <italic>consinoRmixedeffects</italic> package to fit simple models comparing MESOR, amplitude and acrophase of HRV: (1) between COVID-19 positive and COVID-19 negative infection status and (2) across body mass index (BMI) categories within each biological sex.</p>
    <p id="Par21">A brief walkthrough of examples is outlined below, with details explained in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. To estimate the effects of COVID-19 infection on HRV patterns, we can use a mixed-effects COSINOR model with sex and COVID-19 status as covariates and a random MESOR as:</p>
    <p id="Par22">HRV ~ sex + COVID + sex*x + sex*z + COVID*x + COVID*z + (1 | id)).</p>
    <p id="Par23">To model the data with <italic>cosinormixedeffects</italic> package, we follow 5 steps:<list list-type="order"><list-item><p id="Par24">Use the <italic>create.cosinor.param</italic> function to create linear parameters:</p><p id="Par25">db&lt;-create.cosinor.param(time="Hour",period=24,data=db)</p></list-item><list-item><p id="Par26">Use the <italic>fit.cosinor.mixed</italic> function <italic>to fit the desired model:</italic></p><p id="Par27">f&lt;-fit.cosinor.mixed(y="hrv",x=c("sex","COVID"), random="1|id", data=db);</p></list-item><list-item><p id="Par28">Estimate EMMs and 95% CI of MESOR, amplitude and acrophase by COVID-19 status using the function <italic>get.means.ci.cosinor</italic> defining <italic>contrasts as they are defined</italic> in the emmeans function</p><p id="Par29">db.m&lt;-get.means.ci.cosinor(f, contrast.mean.frm="~COVID")</p></list-item><list-item><p id="Par30">Use <italic>ggplot.cosinor.lmer</italic> to get the circadian curves by COVID-19 status (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A),<fig id="Fig1"><label>Fig. 1</label><caption><p>The association of COVID-19 status and BMI-sex interaction with HRV circadian rhythm. <bold>A</bold> Daily HRV pattern and <bold>B</bold> mean and 95% CI for the MESOR, Amplitude, and Acrophase for subjects with COVID-19 positive or negative status. <bold>C</bold> Daily HRV pattern and <bold>D</bold> mean and 95% CI for the MESOR, Amplitude, and Acrophase for each combination of biological sex by BMI category. Time (h) is indicated by the x-axis while HRV (ms) is indicated by the y-axis. Stars indicate significant differences, with (<sup>+</sup><italic>p</italic> &lt; 0.1; *<italic>p</italic> &lt; 0.05; **<italic>p</italic> &lt; 0.01; ***<italic>p</italic> &lt; 0.001)</p></caption><graphic xlink:href="12859_2021_4463_Fig1_HTML" id="MO1"/></fig></p><p id="Par31">p&lt;-ggplot.cosinor.lmer(f,x_str="COVID",period=24,db.m, DATA=db)</p><p id="Par32">offers a core plot, which can be customized by adding more layers (p+labs()).</p></list-item><list-item><p id="Par33">Use <italic>get.contrasts.ci.cosinor</italic> to test for differences in non-linear cosinor parameters by COVID-19 status using the bootstrap approach:</p><p id="Par34">db.delta&lt;-get.contrasts.ci.cosinor(f,contrast.frm="~COVID");</p></list-item></list></p>
    <p id="Par35">To facilitate plotting the EMMs with significance of the contrasts, as depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B, the function <italic>stat.test.stars()</italic> adds the significance of the contrasts to the db.means data frame that can then be visualized with ggplot, exemplified in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <p id="Par36">As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>A, B, we found a statistically significant decrease in the amplitude and acrophase during SARS-CoV-2 infection, which is consistent with analysis showing that viral infection is associated with abnormal HRV [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par37">Our package also allows the introduction of interaction terms to the COSINOR model. For example, to evaluate whether HRV rhythm is dependent on the relationship between BMI and biological sex, an interaction term <italic>sex*BMI_category</italic> can be added into the model and the means and contrasts can be estimated following the syntax of <italic>emmeans.</italic><list list-type="bullet"><list-item><p id="Par38">f&lt;-fit.cosinor.mixed(y="hrv", interaction=c("sex",</p></list-item><list-item><p id="Par39"> "bmi_cat"), random="1+rrr+sss|id”, data=db.m)</p></list-item><list-item><p id="Par40">db.means&lt;-get.means.ci.cosinor(fit=f,</p></list-item><list-item><p id="Par41"> contrast.mean.frm="~bmi_cat|sex", nsim=500)</p></list-item><list-item><p id="Par42">db.delta&lt;-get.contrasts.ci.cosinor(fit=f,</p></list-item><list-item><p id="Par43">contrast.frm="~bmi_cat|sex", nsim=500)</p></list-item></list></p>
    <p id="Par44">We found statistically significant differences in MESOR, amplitude and acrophase between groups (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C, D). Sex differences in amplitude were observed only among subjects with normal BMI. A meta-analysis of 172 studies also revealed that HRV data obtained in men and women cannot be treated equally, potentially due to the sex differences in the autonomic control of the heart [<xref ref-type="bibr" rid="CR15">15</xref>]. MESOR consistently decreased with BMI in both sexes, with obese and overweight women reaching their amplitude peak later than women with normal weight. Koenig et al. found that BMI was inversely associated with two time-related measures of HRV, and Yadav et al. also found differences in HRV parasympathetic and sympathetic indicators between obese and normal weight group [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>].</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par45"><italic>cosinoRmixedeffects</italic> package provides functionality to model circadian rhythm outcomes in a longitudinal setting. Through a series of functions, the user can estimate the parameters of the COSINOR model, conduct hypothesis testing for the linear parameter and use bootstrap-based procedures to test hypothesis on the non-linear circadian parameters MESOR, amplitude and acrophase. The package accommodates factors in the model with any number of categories, and a variety of random effects, as well as complex interactions between circadian parameters and categorical factors. We expect that the availability of this package, will provide biomedical researchers with the proper tools to model circadian rhythm outcomes in a longitudinal setting, and also to be used as a circadian-conscious feature extraction tool for the development of AI algorithms for screening and monitoring health outcomes using wearable devices.
</p>
  </sec>
  <sec id="Sec5">
    <title>Availability and requirements</title>
    <p id="Par46">
      <list list-type="bullet">
        <list-item>
          <p id="Par47">Project name: cosinoRmixedeffects</p>
        </list-item>
        <list-item>
          <p id="Par48">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/maytesuarezfarinas/cosinoRmixedeffects">https://github.com/maytesuarezfarinas/cosinoRmixedeffects</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par49">Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p id="Par50">Programming language: R</p>
        </list-item>
        <list-item>
          <p id="Par51">Other requirements: None</p>
        </list-item>
        <list-item>
          <p id="Par52">License: GNU GPL v3</p>
        </list-item>
        <list-item>
          <p id="Par53">Any restrictions to use by non-academics: No</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec6">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4463_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. </bold>Vignettes of package “cosinoRmixedeffects”.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HRV</term>
        <def>
          <p id="Par4">Heart rate variability</p>
        </def>
      </def-item>
      <def-item>
        <term>BMI</term>
        <def>
          <p id="Par5">Body mass index</p>
        </def>
      </def-item>
      <def-item>
        <term>MESOR</term>
        <def>
          <p id="Par6">Rhythm-adjusted mean</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors of the paper would like to acknowledge Drs Maria Suprun, Robert Hirten, Girish Nadkari and Zahi Fayad for their insight and valuable discussion over the course of this projects’ development.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>RH—Implementation, documentation, and manuscript writing, LET—Implementation and manuscript review, MSF—Conception, design, oversight, manuscript review. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by the Mount Sinai Clinical Intelligence Center (MSCIC) funding. The funders had no role in the design of the study, collection, analysis and interpretation of the data and in the preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>cosinoRmixedeffects</italic> is open-source and freely available from GitHub as an R package: <ext-link ext-link-type="uri" xlink:href="https://github.com/maytesuarezfarinas/cosinoRmixedeffects">https://github.com/maytesuarezfarinas/cosinoRmixedeffects</ext-link>; with example data available (the subset of Warrior Watch Study data used in examples) and vignettes included in the package.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par54">Participants completed eligibility questionnaires and signed an electronic consent form after downloading the custom Warrior Watch app. This study was approved by the Institutional Review Board at The Icahn School of Medicine at Mount Sinai.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par55">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par56">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Panda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Circadian rhythms from flies to human</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>417</volume>
        <fpage>329</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1038/417329a</pub-id>
        <pub-id pub-id-type="pmid">12015613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Chorin E, Hochstadt A, Schwartz AL, Matz G, Viskin S, Rosso R. Continuous heart rate monitoring for automatic detection of life-threatening arrhythmias with novel bio-sensing technology. Front Cardiovasc Med. 2021;748.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schüssler-Fiorenza Rose</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Perelman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Colbert</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Runge</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rego</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Digital health: tracking physiomes and activity using wearable biosensors reveals useful health-related information</article-title>
        <source>PLoS Biol</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>e2001402</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2001402</pub-id>
        <pub-id pub-id-type="pmid">28081144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornelissen</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Cosinor-based rhythmometry</article-title>
        <source>Theor Biol Med Model</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/1742-4682-11-16</pub-id>
        <pub-id pub-id-type="pmid">24725531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Sachs M. cosinor: tools for estimating and predicting the cosinor model. R package version 1.1. 2014.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirten</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Danieletto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomalin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Golden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kaur</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Helmus</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Biello</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pyzik</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Use of physiological data from a wearable device to identify SARS-CoV-2 infection and symptoms and predict COVID-19 diagnosis: observational study</article-title>
        <source>J Med Internet Res</source>
        <year>2021</year>
        <volume>23</volume>
        <fpage>e26107</fpage>
        <pub-id pub-id-type="doi">10.2196/26107</pub-id>
        <pub-id pub-id-type="pmid">33529156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirten</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Danieletto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomalin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Golden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kaur</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Helmus</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Biello</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pyzik</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Factors associated with longitudinal psychological and physiological stress in health care workers during the COVID-19 pandemic: observational study using Apple Watch data</article-title>
        <source>J Med Internet Res</source>
        <year>2021</year>
        <volume>23</volume>
        <fpage>e31295</fpage>
        <pub-id pub-id-type="doi">10.2196/31295</pub-id>
        <pub-id pub-id-type="pmid">34379602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>BWS</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>J Stat Softw</source>
        <year>2015</year>
        <volume>67</volume>
        <fpage>1</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Lenth R. emmeans: estimated marginal means, aka least-squares mean. R package version 1.5.2-1. 2020.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallinckrod</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Schnell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mancuso</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Recommendations for the primary analysis of continuous endpoints in longitudinal clinical trials</article-title>
        <source>Drug Inf J</source>
        <year>2008</year>
        <volume>42</volume>
        <fpage>303</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1177/009286150804200402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallinckrodt</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Sanger</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Dubé</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>DeBrota</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>WZ</given-names>
          </name>
          <name>
            <surname>Tollefson</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Assessing and interpreting treatment effects in longitudinal clinical trials with missing data</article-title>
        <source>Biol Psychiatry</source>
        <year>2003</year>
        <volume>53</volume>
        <fpage>754</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3223(02)01867-X</pub-id>
        <pub-id pub-id-type="pmid">12706959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Hirten RP, Danieletto M, Tomalin L, Choi KH, Zweig M, Golden E, Kaur S, Helmus D, Biello A, Pyzik R. Longitudinal physiological data from a wearable device identifies SARS-CoV-2 infection and symptoms and predicts COVID-19 diagnosis. medRxiv. 2020.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahmad</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ramsay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huebsch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Flanagan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McDiarmid</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batkin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McIntyre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sundaresan</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Maziak</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Shamji</surname>
            <given-names>FM</given-names>
          </name>
        </person-group>
        <article-title>Continuous multi-parameter heart rate variability analysis heralds onset of sepsis in adults</article-title>
        <source>PLoS ONE</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e6642</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0006642</pub-id>
        <pub-id pub-id-type="pmid">19680545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahmad</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tejuja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Zarychanski</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seely</surname>
            <given-names>AJE</given-names>
          </name>
        </person-group>
        <article-title>Clinical review: a review and analysis of heart rate variability and the diagnosis and prognosis of infection</article-title>
        <source>Crit Care</source>
        <year>2009</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1186/cc8132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koenig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thayer</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Sex differences in healthy human heart rate variability: a meta-analysis</article-title>
        <source>Neurosci Biobehav Rev</source>
        <year>2016</year>
        <volume>64</volume>
        <fpage>288</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neubiorev.2016.03.007</pub-id>
        <pub-id pub-id-type="pmid">26964804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yadav</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Yadav</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Yadav</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sah</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>MN</given-names>
          </name>
        </person-group>
        <article-title>Association between obesity and heart rate variability indices: an intuition toward cardiac autonomic alteration–a risk of CVD</article-title>
        <source>Diabetes Metab Syndr Obes Targets Ther</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <pub-id pub-id-type="doi">10.2147/DMSO.S123935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koenig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jarczok</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Warth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hillecke</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Thayer</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Body mass index is related to autonomic nervous system activity as measured by heart rate variability—a replication using short term measurements</article-title>
        <source>J Nutr Health Aging</source>
        <year>2014</year>
        <volume>18</volume>
        <fpage>300</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1007/s12603-014-0022-6</pub-id>
        <pub-id pub-id-type="pmid">24626758</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
