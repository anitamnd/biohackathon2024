<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1131889</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-108</article-id>
    <article-id pub-id-type="pmid">15857510</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-108</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Scoredist</italic>: A simple and robust protein sequence distance estimator</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Sonnhammer</surname>
          <given-names>Erik LL</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>erik.sonnhammer@cgb.ki.se</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Hollich</surname>
          <given-names>Volker</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>volker.hollich@cgb.ki.se</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Center for Genomics and Bioinformatics, Karolinska Institutet, Berzelius väg 35, 171 77 Stockholm, Sweden</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>4</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>108</fpage>
    <lpage>108</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/108"/>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>12</month>
        <year>2004</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2005</year>
      </date>
    </history>
    <copyright-statement>Copyright © 2005 Sonnhammer and Hollich; licensee BioMed Central Ltd.</copyright-statement>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
      <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
    </license>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Distance-based methods are popular for reconstructing evolutionary trees thanks to their speed and generality. A number of methods exist for estimating distances from sequence alignments, which often involves some sort of correction for multiple substitutions. The problem is to accurately estimate the number of true substitutions given an observed alignment. So far, the most accurate protein distance estimators have looked for the optimal matrix in a series of transition probability matrices, <italic>e.g. </italic>the Dayhoff series. The evolutionary distance between two aligned sequences is here estimated as the evolutionary distance of the optimal matrix. The optimal matrix can be found either by an iterative search for the Maximum Likelihood matrix, or by integration to find the Expected Distance. As a consequence, these methods are more complex to implement and computationally heavier than correction-based methods. Another problem is that the result may vary substantially depending on the evolutionary model used for the matrices. An ideal distance estimator should produce consistent and accurate distances independent of the evolutionary model used.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose a correction-based protein sequence estimator called <italic>Scoredist</italic>. It uses a logarithmic correction of observed divergence based on the alignment score according to the BLOSUM62 score matrix. We evaluated <italic>Scoredist </italic>and a number of optimal matrix methods using three evolutionary models for both training and testing Dayhoff, Jones-Taylor-Thornton, and Müller-Vingron, as well as Whelan and Goldman solely for testing. Test alignments with known distances between 0.01 and 2 substitutions per position (1–200 PAM) were simulated using ROSE. <italic>Scoredist </italic>proved as accurate as the optimal matrix methods, yet substantially more robust. When trained on one model but tested on another one, <italic>Scoredist </italic>was nearly always more accurate. The Jukes-Cantor and Kimura correction methods were also tested, but were substantially less accurate.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The <italic>Scoredist </italic>distance estimator is fast to implement and run, and combines robustness with accuracy. <italic>Scoredist </italic>has been incorporated into the Belvu alignment viewer, which is available at <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.cgb.ki.se/pub/prog/belvu/"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Estimating divergence time of protein sequences is one of the fundamental problems in bioinformatics. Evolutionary distance estimates are used by many of the most commonly used phylogenetic tree reconstruction algorithms [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. In current research, phylogenetic trees are used for many types of subsequent analysis, <italic>e.g. </italic>orthology inference [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. Early models for sequence evolution focussed on nucleotides. They commonly employ Markov chains and assume independent evolution at every site. Each of the four nucleotides is identified by one state and the substitution probability is modelled as a state transition probability from one state to another. In the most straightforward approach, the same state transition probability is assigned to every substitution [<xref ref-type="bibr" rid="B7">7</xref>]. Subsequent models take account of more nucleotide specific properties, <italic>e.g. </italic>transitional and transversional substitutions as well as GC content (see [<xref ref-type="bibr" rid="B8">8</xref>] for an introduction). These more advanced approaches are bound to nucleotide sequences and cannot be directly used with protein sequences.</p>
    <p>Markov chain models for protein evolution differ from nucleotide approaches in their larger number of states and transitions for which parameters need to be estimated. The protein sequence Jukes-Cantor model assigns the same probability to each substitution and is hence a rather poor approximation. This method essentially takes the observed differences between two sequences and corrects this value to the estimated evolutionary distance using a logarithmic function. Other similar methods exist that also correct observed differences, <italic>e.g. </italic>Kimura's method [<xref ref-type="bibr" rid="B9">9</xref>]. Although they produce rather inaccurate distance estimates, correction-based distance estimators are popular because of their simplicity. More advanced protein evolution models estimate parameters from protein sequence alignments. Assuming the same substitutions for closely and distantly related sequences leads to the construction of the Dayhoff matrix series [<xref ref-type="bibr" rid="B10">10</xref>]. Following this approach, it suffices to collect data from alignments of closely related sequences to build an evolutionary model of amino acid substitution.</p>
    <p>Dayhoff and co-workers introduced the term Percent Accepted (point) Mutation (PAM), which denotes a commonly used measure for evolutionary distance between two aligned sequences (insertions and deletions are ignored). In other words, two sequences at a distance of 150 PAM are related to each other by 1.5 substitutions per position on average. As substitution is a stochastic process, some positions will experience multiple substitutions while others will experience none. It is also possible that secondary substitutions at one site will result in the original residue, making the evolutionary steps invisible. This is in essence the reason why estimating evolutionary distance is so hard – multiple substitutions cannot be observed directly. An evolutionary distance of 250 PAM corresponds roughly to 80% observed differences. The term PAM is found in literature for both the matrix series given by Dayhoff et al. as well as for evolutionary distance unit. In this publication we refer to the matrices as Dayhoff matrices and reserve the term PAM for distance units.</p>
    <p>There are two major shortcomings connected with the derivation of the Dayhoff matrices. First, potential errors inherent in the experimental data will be magnified by extrapolation. Additionally, it is questionable whether substitution probabilities observed on closely related sequences can accurately reflect the evolution of more distantly related sequences. The efforts of researchers since the publication of the Dayhoff matrices have led to several other matrix series, sharing the idea of an underlying Markov chain. They differ in terms of the data they are built upon and account for the above-mentioned shortcomings in various ways [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B13">13</xref>].</p>
    <p>The approach behind the BLOSUM matrices [<xref ref-type="bibr" rid="B14">14</xref>] is different from Dayhoff's evolutionary model. Whereas the Markov model assumes that any transition probability matrix may be derived from another matrix in the same series, the BLOSUM matrices do not imply any evolutionary time. There is no direct mathematical relationship between matrices in the BLOSUM series. Sequences with identities above a given identity cutoff are clustered and used to derive score matrices. The BLOSUM matrices are known as a good general-purpose choice. Especially, BLOSUM62 is frequently chosen for the alignment of sequences.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>We here introduce <italic>Scoredist</italic>, a novel correction-based distance estimator for protein sequences. It applies a correction function to an observed reduction in normalised score, rather than to observed differences as other correction-based methods. This gives a better estimate of the divergence in the well-established PAM measure and allows the popular BLOSUM matrix series to be used. Other matrices could in principle be used, but the BLOSUM matrix has proved to be the most universal. <italic>Scoredist </italic>distance estimates are calculated directly by a simple equation and do not require cumbersome computational approximations, which is needed for <italic>e.g. </italic>Maximum Likelihood (ML) and Expected Distance (ED) estimates [<xref ref-type="bibr" rid="B15">15</xref>]. Additional calibration opens the possibility to make <italic>Scoredist </italic>tuned to other evolutionary models.</p>
    <p>In order to evaluate our novel protein distance estimator <italic>Scoredist </italic>against other estimators, we generated a large testset of artificial sequence alignments. Simulation is the only way to exactly know an alignment's evolutionary distance. The substitutions were made by ROSE [<xref ref-type="bibr" rid="B16">16</xref>] according to an evolutionary model that can be chosen arbitrarily. It is to be expected that a distance estimator based on a particular evolutionary model will perform optimally on a testset generated with the same model. We therefore generated testsets using four different matrix series: Dayhoff [<xref ref-type="bibr" rid="B10">10</xref>], MV [<xref ref-type="bibr" rid="B12">12</xref>], JTT [<xref ref-type="bibr" rid="B11">11</xref>], and WAG [<xref ref-type="bibr" rid="B13">13</xref>]. For each model, 2000 alignments were created for evolutionary distances between 1 and 200 PAM units, i.e. 10 alignments for each distance. The <italic>Scoredist</italic>, Maximum Likelihood, and Expected Distance estimators can all be tuned towards a particular evolutionary model. We therefore used three evolutionary models which were also used to generate the testsets for these distance estimators, and use a shorthand to refer to these as "method-model". For instance, Maximum Likelihood using the MV model is denoted ML-MV. The Jukes-Cantor and Kimura estimators can not be tuned to a specific model but were tested on all four datasets.</p>
    <p>Table <xref ref-type="table" rid="T1">1</xref> shows a compressed summary of the results. For each combination of distance estimator and dataset, the average root mean square deviation from the true distance was calculated for all 2000 alignments. The Expected Distance results were similar to ML, as the methods are akin in nature, but ML was generally more accurate and is much more widely used. As expected, low RMSD values as a sign of good distance estimates were generally obtained when using the same model for alignment creation and subsequent distance estimation. This is seen in the diagonal of low RMSD values from Dayhoff/Dayhoff to JTT/JTT. The only exception to this rule was observed when the testset was generated with Dayhoff. Here, ML-JTT was slightly better than ML-Dayhoff. This result was also verified for distances up to 250 and 300 PAM (data not shown). Comparing <italic>Scoredist </italic>and ML accuracies when training and testing using the same model resulted in a tie. <italic>Scoredist </italic>was better for MV, ML was better for JTT, and they were equally accurate for Dayhoff. When comparing accuracies for different training and testing models, however, <italic>Scoredist </italic>dominates. Here, <italic>Scoredist </italic>performed better than ML in five of the six cases. For the MV testset the difference was very big. The only case where ML was better than <italic>Scoredist </italic>was again when running ML-JTT on the Dayhoff testset, which for unclear reasons produced very accurate distance estimates.</p>
    <p>The Jukes-Cantor and Kimura correction methods are generally less accurate than <italic>Scoredist </italic>and ML estimators. In some cases they reached higher accuracy than <italic>Scoredist </italic>and ML trained on the "wrong" model. For instance, on the Dayhoff testset Kimura was better than <italic>Scoredist</italic>-MV and ML-MV, and on the MV testset Jukes-Cantor was better than <italic>Scoredist </italic>and ML trained on Dayhoff or JTT. However, Jukes-Cantor and Kimura never came near the <italic>Scoredist </italic>and ML accuracy when trained on the "right" model. In a real situation, it is of course not known which evolutionary model is most appropriate. Therefore, taking the average RMSD values for each training model reveals the generality and robustness of the method on different testsets. The average accuracy of <italic>Scoredist </italic>is consistently better than for ML, and Jukes-Cantor and Kimura are even further behind.</p>
    <p>Figure <xref ref-type="fig" rid="F1">1</xref> two shows a more detailed picture of the different distance estimators. The average of 10 estimates from 10 independent simulations at each evolutionary distance is plotted for data generated with the Dayhoff matrices. The variance among the 10 estimates is not shown for clarity; they are however reflected by the RMSD values in Table <xref ref-type="table" rid="T1">1</xref> which may give a slightly different picture. For instance, it is possible that the average deviation is close to zero if the individual estimates have large positive and negative deviations that cancel each other out. Therefore, the RMSD values should be trusted more than the deviation plots when in doubt. Figure <xref ref-type="fig" rid="F1">1A</xref> shows the dependence on evolutionary model for <italic>Scoredist </italic>and ML. Testing on the Dayhoff testset, <italic>Scoredist</italic>-Dayhoff and ML-Dayhoff stayed reasonable accurate in the entire range (below 5% error). In contrast, <italic>Scoredist</italic>-MV and ML-MV deviated considerably from the true distance. It is however clear that ML is more affected by switching model than <italic>Scoredist </italic>is. In Figure <xref ref-type="fig" rid="F1">1B</xref> the testset was generated with the MV model. Again, the corresponding deviation was observed for "wrong model" estimators. Here it is even more pronounced that ML is more dependent on the model, and generalizes poorly. <italic>Scoredist </italic>was less affected by the change of model – <italic>Scoredist</italic>-Dayhoff was considerably more accurate on the MV testset than ML-Dayhoff. As expected, when <italic>Scoredist </italic>and ML had been trained on MV data, the accuracy is very good for both estimators. In conclusion, we observed that although the <italic>Scoredist </italic>method is very simple compared to the ML method, it is approximately equally accurate when testing and training using the same evolutionary model. However, when testing on a different model, <italic>Scoredist </italic>is considerably more accurate.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>The <italic>Scoredist </italic>estimator was implemented in Belvu, which is a general-purpose multiple alignment viewer that allows basic alignment editing. Belvu can calculate and display phylogenetic trees. The tree reconstruction can be based on <italic>Scoredist </italic>or other common correction-based distance estimators available within Belvu.</p>
    <p>Multiple alignments can be coloured in Belvu according to conservation using average BLOSUM62 score in the column, or by residue-specific colours. User-specified cutoffs can be employed to fine-tune the display. Belvu has a range of functions for sorting, colouring, marking up, and printing alignments. In Figure <xref ref-type="fig" rid="F2">2</xref>, the alignment is coloured according to conservation, and sorted according to the tree. The effect of distance correction with <italic>Scoredist </italic>is illustrated.</p>
    <p>Belvu can also be utilised for batch mode operations on the multiple alignment, or for producing distance matrices or phylogenetic trees without graphical output. It is available for the most common UNIX operating systems and can be obtained from [<xref ref-type="bibr" rid="B20">20</xref>]. A Windows version exists but is less frequently maintained. See [<xref ref-type="bibr" rid="B17">17</xref>] for instructions, and [<xref ref-type="bibr" rid="B18">18</xref>] for information on the Stockholm format, which is used by the Pfam project.</p>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Our analysis was based on four different evolutionary models – Dayhoff, MV, JTT and WAG. We chose these because they represent the spectrum of models well. The only tuning done in the <italic>Scoredist </italic>method is the estimation of the calibration factor <italic>c</italic>. This factor can be seen as a scaling factor for the logarithm base in equation (5) that needs to be set empirically.</p>
    <p>The difference between <italic>Scoredist </italic>and ML becomes particularly apparent in the MV dataset. There are several hypotheses for this behaviour. The Dayhoff matrices were constructed with the limited data available at the time. Given the substantial increase of research output in this field particularly during the last decade, it is not surprising that the Müller-Vingron model (published in 2000) reports substantially other results than the Dayhoff (1978) and JTT (1992) matrices. Additionally, the calibration factor <italic>c </italic>can also be interpreted as measure for the similarity of the respective models. Following this argument, JTT and Dayhoff are more akin given a Δ<italic>c </italic>≈ 0.05. The MV model is more distant to both JTT (Δ<italic>c </italic>≈ 0.11) and Dayhoff (Δ<italic>c </italic>≈ 0.16).</p>
    <p>The Expected Distance estimator generally overestimates distances. For instance, among Dayhoff-calibrated estimators on the MV testset, Expected Distance is more than 10 PAM RMSD units (over 50%) poorer than the best method <italic>Scoredist</italic>. Similar values are observed for JTT calibrated estimators. Generally, MV-trained estimators are prone to underestimate evolutionary distances (Figure <xref ref-type="fig" rid="F1">1A</xref>). In combination with the ED higher distance estimation, this rather fortuitously leads to good results for ED – MV. However, the scope of this research was to identify a robust method that performs well on various data sources. An estimator which is highly sensitive to the data source or possible incorrect calibration is of less value. The best single estimator was JTT-calibrated <italic>Scoredist</italic>. If the method <italic>per se </italic>is measured by averaging over all calibrations and testsets, <italic>Scoredist </italic>receives 15.39, ED 16.89, and ML 17.14 PAM RMSD units. This highlights <italic>Scoredist </italic>as the most robust estimator, with the distance between <italic>Scoredist </italic>and ED (Δ<sub><italic>Scoredist</italic>, ED </sub>≈ 1.50) being 6 fold the difference between ED and ML (Δ<sub>ED, ML </sub>≈ 0.25).</p>
    <p>We here only present <italic>Scoredist </italic>results using BLOSUM62 for calculating the score <italic>σ </italic>between two sequences. In principle one could use some other score matrix, but we found that this had little effect on the results. Since the goal was to make a general-purpose method, BLOSUM62 was an obvious choice. The key to <italic>Scoredist </italic>is the usage of scores rather than identities, and the choice of somewhat arbitrary parameters is not of primary concern. At present, gaps in the alignments are not included in the <italic>Scoredist </italic>calculation. Traditionally, gaps have been difficult to embody in evolutionary models. In the models used here, they are at best crudely modelled by treating every gap equally. An inherent problem is that the probabilities for insertions and deletions (indels) are not necessarily synchronized with the substitution probabilities. Some protein families are more prone to indels than others, hence it is hard to make a generalizable model that suits all protein types. We have experimented with affine gap penalties in the <italic>Scoredist </italic>method (this is an option in the implementation), but this resulted in decreased accuracy. We therefore do not recommend using gaps to estimate protein distances.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have developed the score matrix based distance estimator <italic>Scoredist </italic>for aligned protein sequences. Its main advantages are computational simplicity and high robustness. Most other distance estimators produce good results for certain evolutionary models but perform poorly on others. The Maximum Likelihood and Expected Distance were found to overfit their estimates to the evolutionary model so much that the results on testsets generated with other models suffered heavily. The correction-based methods Jukes-Cantor and Kimura also favoured a particular evolutionary model, but were not competitively accurate on any testset. It seems that <italic>Scoredist </italic>achieved the best compromise between accuracy and generalization power.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>For the estimation of divergence time, let s<sup>1 </sup>and s<sup>2 </sup>be two aligned protein sequences (gaps are ignored) of identical length <italic>l</italic>. A similarity score <italic>σ </italic>is defined as</p>
    <p>
      <inline-graphic xlink:href="1471-2105-6-108-i1.gif"/>
    </p>
    <p>where <italic>S </italic>is a log-odds score matrix. Log-odds score matrices are constructed such that substitutions by the same or a similar amino acid receive a positive score, whereas substitutions to dissimilar amino acids are attributed a negative score. The expected value for this kind of matrix is negative. This ensures that the comparison of unrelated sequences returns a negative score. For two random sequences of length <italic>l </italic>the expected score <italic>σ</italic><sup><italic>r</italic></sup>(<italic>l</italic>) = <italic>σ</italic><sup>0 </sup>* <italic>l</italic>, where is the expected value of the score matrix. As we strive to measure scores above the scores for the null model of sequence independence, the score <italic>σ</italic>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>2</sup>) is deducted by the expected score <italic>σ</italic><sup><italic>r</italic></sup>, giving the normalised score <italic>σ</italic><sup><italic>N</italic></sup></p>
    <p><italic>σ</italic><sup><italic>N </italic></sup>= <italic>σ</italic>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>2</sup>) - <italic>σ</italic><sup><italic>r </italic></sup>(<italic>l</italic>).     (2)</p>
    <p>For two random sequences of length <italic>l </italic>the expected score <italic>σ<sup>r </sup></italic>(<italic>l</italic>) = <italic>σ</italic><sup>0 </sup>* <italic>l</italic>, where <italic>σ</italic><sup>0 </sup>is the expected value of the score matrix.</p>
    <p>The expected score <italic>σ</italic><sup><italic>r </italic></sup>for unrelated sequences can be regarded as lower limit. The upper limit of the score between <italic>s</italic><sup>1 </sup>and any other sequences is given by <italic>σ</italic>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>1</sup>). For two different sequences, the upper limit of the score <italic>σ</italic><sup><italic>U </italic></sup>is, for the sake of symmetry, assumed to be</p>
    <p>
      <inline-graphic xlink:href="1471-2105-6-108-i2.gif"/>
    </p>
    <p>and normalised</p>
    <p><italic>σ</italic><sup><italic>UN </italic></sup>= <italic>σ</italic><sup><italic>U </italic></sup>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>2</sup>) - <italic>σ</italic><sup><italic>r </italic></sup>(<italic>l</italic>).     (4)</p>
    <p>Any sound score <italic>σ<sup>N </sup></italic>is situated within the interval [0, <italic>σ<sup>UN</sup></italic>]. The validity of the upper boundary follows from the score's definition. The lower boundary might, however, get violated if two sequences receive a score <italic>σ</italic>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>2</sup>) &lt;<italic>σ<sup>r </sup></italic>(<italic>l</italic>). As the model assumes independent evolution already for <italic>σ</italic><sup><italic>r </italic></sup>(<italic>l</italic>), a score below <italic>σ</italic><sup><italic>r </italic></sup>does not contain any additional information. A lower score is therefore set to <italic>σ</italic>(<italic>s</italic><sup>1</sup>, <italic>s</italic><sup>2</sup>) = <italic>σ</italic><sup><italic>r </italic></sup>(<italic>l</italic>). We model the raw distance as a modified Poisson process</p>
    <p>
      <inline-graphic xlink:href="1471-2105-6-108-i3.gif"/>
    </p>
    <p>As seen in Figure <xref ref-type="fig" rid="F3">3</xref>, <italic>d</italic><sub><italic>r </italic></sub>is linearly related to the true distance, deviating only by a constant factor. The <italic>Scoredist </italic>evolutionary distance estimate of two sequences is given as the product of the raw distance and a calibration factor</p>
    <p><italic>d</italic><sub><italic>s </italic></sub>= <italic>c </italic>* <italic>d</italic><sub><italic>r</italic></sub>.     (6)</p>
    <p>Evolutionary distances of 250–300 PAM units are commonly considered as the maximum for reasonable distance estimation and, therefore, the <italic>Scoredist </italic>estimate <italic>d</italic><sub><italic>s </italic></sub>is restricted to the interval [0, 300] PAM.</p>
    <p>Calibration factors can be determined for various evolutionary models. We used the ROSE program [<xref ref-type="bibr" rid="B16">16</xref>] to simulate evolution with three different matrix series and generated 2000 sample sequence alignments for distances up to 200 PAM units. The calibration factor <italic>c </italic>was calculated by least squares fitting on this data, using the BLOSUM62 score matrix for calculating the score <italic>σ </italic>in the estimator (Table <xref ref-type="table" rid="T2">2</xref>, Figure <xref ref-type="fig" rid="F3">3</xref>). The simulated evolution started with a random sequence of 200 residues. For each integer distance within the interval [1, 200] PAM, we produced 10 alignments, yielding 2000 alignments per dataset. The default gap parameters of ROSE V1.3 were applied. Each dataset was generated with the transition probability matrix and the stationary frequencies of the respective evolutionary model.</p>
    <p>Calculation of Maximum Likelihood (ML) and Expected Distances (ED): ML distances were estimated by applying the Newton-Raphson method to the derivative of the likelihood of the evolutionary distance given an alignment. To calculate ED, the same likelihood function was numerically integrated, to get its "center of gravity" [<xref ref-type="bibr" rid="B15">15</xref>]. Both methods are implemented in the program lapd (L. Arvestad, unpublished), which uses Perl and Octave. The Jukes-Cantor and Kimura distance estimators were run as implemented in Belvu. The popular PROTDIST program from the PHYLIP package [<xref ref-type="bibr" rid="B19">19</xref>] calculates only ML-Dayhoff and Kimura distances. We therefore chose to use lapd in order to assess <italic>Scoredist </italic>by a broader range of distance estimators.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>ES had the initial idea and implemented the method. VH carried out the evaluation and wrote the first manuscript draft. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Lars Arvestad for the lapd program, for helpful discussions, and for reading the manuscript.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bruno</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Socci</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Weighted Neighbor Joining: A Likelihood-Based Approach to Distance-Based Phylogeny Reconstruction</article-title>
        <source>Mol Biol Evol</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>189</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">10666718</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>BIONJ: An Improved Version on the NJ Algorithm Based on a Simple Model of Sequence Data</article-title>
        <source>Mol Biol Evol</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>685</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="pmid">9254330</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Neighbor-joining Method: A New Method for Reconstructing Phylogenetic Trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1987</year>
        <volume>4</volume>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zmasek</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>RIO: analyzing proteomes by automated phylogenenomics using resampled inference of orthologs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="pmid">12028595</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-3-14</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hollich</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Storm</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
        </person-group>
        <article-title>OrthoGUI: graphical presentation of Orthostrapper results</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1272</fpage>
        <lpage>1273</lpage>
        <pub-id pub-id-type="pmid">12217923</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.9.1272</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storm</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
        </person-group>
        <article-title>Automated ortholog inference from phylogenetic trees and calculation of orthology reliability</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>92</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="pmid">11836216</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.1.92</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Munro HN</surname>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mammalian Protein Metabolism</source>
        <year>1969</year>
        <publisher-name>Academic Press</publisher-name>
        <fpage>21</fpage>
        <lpage>132</lpage>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Molecular Evolution and Phylogenetics</source>
        <year>2000</year>
        <publisher-name>New York: Oxford University Press</publisher-name>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>The Neutral Theory of Molecular Evolution</source>
        <year>1983</year>
        <publisher-name>Cambridge: Cambridge University Press</publisher-name>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dayhoff</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Orcutt</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dayhoff MO</surname>
          </name>
        </person-group>
        <article-title>A model of Evolutionary Change in Proteins</article-title>
        <source>Atlas of Protein Sequence and Structure vol 5 supplement 3</source>
        <year>1978</year>
        <publisher-name>National Biomedical Research Foundation, Washington</publisher-name>
        <fpage>353</fpage>
        <lpage>352</lpage>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>
        <source>Comput Appl Biosci</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">1633570</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Modeling amino acid replacement</article-title>
        <source>J Comput Biol</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>761</fpage>
        <lpage>776</lpage>
        <pub-id pub-id-type="pmid">11382360</pub-id>
        <pub-id pub-id-type="doi">10.1089/10665270050514918</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title>
        <source>Mol Biol Evol</source>
        <year>2001</year>
        <volume>18</volume>
        <fpage>691</fpage>
        <lpage>699</lpage>
        <pub-id pub-id-type="pmid">11319253</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agarwal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>States</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian Evolutionary Distance for Parametrically Aligned Sequences</article-title>
        <source>J Comput Biol</source>
        <year>1996</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">8697232</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Evers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Rose: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.2.157</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="other">
        <article-title>Belvu website</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.cgb.ki.se/cgb/groups/sonnhammer/Belvu.html"/>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="other">
        <article-title>Stockholm data format</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.cgb.ki.se/cgb/groups/sonnhammer/Stockholm.html"/>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>PHYLIP – Phylogeny Inference Package (Version 3.2)</article-title>
        <source>Cladistics</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>166</lpage>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="other">
        <article-title>Belvu download site</article-title>
        <ext-link ext-link-type="uri" xlink:href="ftp://ftp.cgb.ki.se/pub/prog/belvu/"/>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Stratified accuracy analysis of <italic>Scoredist </italic>and ML</bold>. To illustrate how estimated distance depends on the model, the average deviation is plotted as a function of true distance for two evolutionary models, Dayhoff and Mueller-Vingron. For each evolutionary distance between 1 and 200 PAM, 10 alignments were generated. For each alignment, the deviation was calculated as the difference between the estimated distance and the true distance used for data generation by ROSE [16]. The average of the 10 deviations was plotted using a running average with a window of 10 residues. Note that positive and negative deviations at the same true distance can cancel each other out – the curve only shows the average deviation and not the variability. The values in Table 1 measure the accuracy more correctly by using RMSD of every datapoint. The testset data was created with the matrices given by Dayhoff (A) or Müller-Vingron (B). In both cases, the estimators using the same evolutionary model as the testset data perform well. However, when switching the model in the estimator, <italic>Scoredist </italic>diverges less than ML, indicating that <italic>Scoredist </italic>is more robust. The curves show that ML-MV is more different from ML-Dayhoff than <italic>Scoredist</italic>-MV is from <italic>Scoredist</italic>-Dayhoff, particularly for the MV dataset in (B). The less difference between estimates using different models, the more robust is the method.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-108-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>The Belvu multiple sequence alignment viewer</bold>. Belvu is a multiple sequence alignment viewer that implements the <italic>Scoredist </italic>distance estimator. The alignment window (A) shows a subset of the Pfam family DNA_pol_A (PF00476). Uniprot IDs are shown throughout. A sequence with known structure is included (DPO1_ECOLI) – the SA line showing surface accessibility and the SS line showing secondary structure. The neighbour-joining tree in (B) used uncorrected distances (observed differences), while the tree in (C) used <italic>Scoredist </italic>correction. Belvu assigns a colour to each species if provided with species markup information. The distance correction mainly affects the longer branches, and affects the tree topology in some cases, <italic>e.g</italic>. the placement of DPOQ_HUMAN. Structural markup and taxonomic information were embedded in the Stockholm format alignment provided by the Pfam database.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-108-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Estimation of the calibration factor <italic>c </italic>in <italic>Scoredist</italic></bold>. This factor rescales the raw distance <italic>d</italic><sub><italic>r </italic></sub>to optimally fit true evolutionary distances. The plot shows how <italic>c </italic>is estimated by least-squares fitting of raw distances <italic>d</italic><sub><italic>r </italic></sub>to true distances for 2000 artificially produced sequence alignments, using the Dayhoff matrix series. The linear relationship between the raw distance <italic>d</italic><sub><italic>r </italic></sub>and the true distance of the sequence samples justifies the introduction of the calibration factor <italic>c</italic>, which was here determined to <italic>c</italic><sub><italic>Dayhoff </italic></sub>= 1.3370 (See Table 2).</p>
      </caption>
      <graphic xlink:href="1471-2105-6-108-3"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Accuracy as average RMSD values for combinations of data modelsand estimators</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td align="center" colspan="4">testset</td>
            <td/>
          </tr>
          <tr>
            <td/>
            <td colspan="4">
              <hr/>
            </td>
            <td/>
          </tr>
          <tr>
            <td/>
            <td align="right">Dayhoff</td>
            <td align="right">MV</td>
            <td align="right">JTT</td>
            <td align="right">WAG</td>
            <td align="right">average</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Scoredist – Dayhoff</td>
            <td align="right">12.68</td>
            <td align="right">20.85</td>
            <td align="right">13.67</td>
            <td align="right">12.81</td>
            <td align="right">15.00</td>
          </tr>
          <tr>
            <td align="left">ML – Dayhoff</td>
            <td align="right">12.70</td>
            <td align="right">28.40</td>
            <td align="right">14.75</td>
            <td align="right">15.15</td>
            <td align="right">17.75</td>
          </tr>
          <tr>
            <td align="left">ED – Dayhoff</td>
            <td align="right">13.57</td>
            <td align="right">31.36</td>
            <td align="right">16.10</td>
            <td align="right">16.63</td>
            <td align="right">19.41</td>
          </tr>
          <tr>
            <td align="left">Scoredist – MV</td>
            <td align="right">19.28</td>
            <td align="right">13.15</td>
            <td align="right">16.29</td>
            <td align="right">18.73</td>
            <td align="right">16.86</td>
          </tr>
          <tr>
            <td align="left">ML – MV</td>
            <td align="right">19.96</td>
            <td align="right">13.44</td>
            <td align="right">19.36</td>
            <td align="right">19.21</td>
            <td align="right">17.99</td>
          </tr>
          <tr>
            <td align="left">ED – MV</td>
            <td align="right">15.68</td>
            <td align="right">13.35</td>
            <td align="right">13.95</td>
            <td align="right">14.75</td>
            <td align="right">14.43</td>
          </tr>
          <tr>
            <td align="left">Scoredist – JTT</td>
            <td align="right">13.67</td>
            <td align="right">17.16</td>
            <td align="right">12.89</td>
            <td align="right">13.47</td>
            <td align="right">14.30</td>
          </tr>
          <tr>
            <td align="left">ML – JTT</td>
            <td align="right">12.15</td>
            <td align="right">25.07</td>
            <td align="right">12.10</td>
            <td align="right">13.44</td>
            <td align="right">15.69</td>
          </tr>
          <tr>
            <td align="left">ED – JTT</td>
            <td align="right">12.56</td>
            <td align="right">27.71</td>
            <td align="right">12.70</td>
            <td align="right">14.37</td>
            <td align="right">16.84</td>
          </tr>
          <tr>
            <td align="left">Jukes-Cantor</td>
            <td align="right">23.92</td>
            <td align="right">16.28</td>
            <td align="right">19.88</td>
            <td align="right">22.48</td>
            <td align="right">20.64</td>
          </tr>
          <tr>
            <td align="left">Kimura</td>
            <td align="right">16.24</td>
            <td align="right">29.81</td>
            <td align="right">22.36</td>
            <td align="right">19.16</td>
            <td align="right">21.89</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>For each testset and method, the average root mean square deviation from the true distance was calculated for 2,000 alignment samples in the interval 1–200 PAM units. Lower RMSD values indicate higher accuracy on a single testset. The column 'average' gives the mean of the four evaluated testsets. A low value in this column shows the estimator's robustness as it measures the accuracy over all four models (including "wrong" data models). <italic>Scoredist </italic>was more robust than ML, as it for each training set always had higher accuracy on average. The ED estimator gave good results when trained with MV, but was poor in all other cases (see Discussion for details). <italic>Scoredist</italic>, Jukes-Cantor, and Kimura distances were calculated with the Belvu alignment viewer. The Maximum Likelihood (ML) and Expected Distance (ED) estimates were produced by lapd (L. Arvestad, unpublished).</p>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>Calibration factors for three evolutionary models</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td align="right">
              <italic>c</italic>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Dayhoff</td>
            <td align="right">1.3370</td>
          </tr>
          <tr>
            <td align="left">JTT</td>
            <td align="right">1.2873</td>
          </tr>
          <tr>
            <td align="left">MV</td>
            <td align="right">1.1775</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>The raw distance <italic>d</italic><sub><italic>r </italic></sub>is scaled by the calibration factor <italic>c</italic>, which was obtained by least squares fitting of 2000 artificial protein sequence alignments generated for the matrices as given by Dayhoff, JTT (Jones-Taylor-Thornton), and MV (Müller-Vingron).</p>
      </table-wrap-foot>
    </table-wrap>
  </sec>
</back>
