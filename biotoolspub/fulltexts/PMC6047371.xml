<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Res Methodol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Res Methodol</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Research Methodology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2288</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6047371</article-id>
    <article-id pub-id-type="pmid">29879902</article-id>
    <article-id pub-id-type="publisher-id">502</article-id>
    <article-id pub-id-type="doi">10.1186/s12874-018-0502-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>joineRML: a joint model and software package for time-to-event and multivariate longitudinal outcomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4989-0054</contrib-id>
        <name>
          <surname>Hickey</surname>
          <given-names>Graeme L.</given-names>
        </name>
        <address>
          <email>graeme.hickey@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Philipson</surname>
          <given-names>Pete</given-names>
        </name>
        <address>
          <email>pete.philipson@northumbria.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jorgensen</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>a.l.jorgensen@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kolamunnage-Dona</surname>
          <given-names>Ruwanthi</given-names>
        </name>
        <address>
          <email>ruwanthi.kolamunnage-dona@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8470</institution-id><institution-id institution-id-type="GRID">grid.10025.36</institution-id><institution>Department of Biostatistics, Institute of Translational Medicine, University of Liverpool, </institution></institution-wrap>Waterhouse Building, 1-5 Brownlow Street, Liverpool, L69 3GL UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121965555</institution-id><institution-id institution-id-type="GRID">grid.42629.3b</institution-id><institution>Department of Mathematics, Physics and Electrical Engineering, Northumbria University, </institution></institution-wrap>Ellison Place, Newcastle upon Tyne, NE1 8ST UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>50</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Joint modelling of longitudinal and time-to-event outcomes has received considerable attention over recent years. Commensurate with this has been a rise in statistical software options for fitting these models. However, these tools have generally been limited to a single longitudinal outcome. Here, we describe the classical joint model to the case of <italic>multiple</italic> longitudinal outcomes, propose a practical algorithm for fitting the models, and demonstrate how to fit the models using a new package for the statistical software platform R, joineRML.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>A multivariate linear mixed sub-model is specified for the longitudinal outcomes, and a Cox proportional hazards regression model with time-varying covariates is specified for the event time sub-model. The association between models is captured through a zero-mean multivariate latent Gaussian process. The models are fitted using a Monte Carlo Expectation-Maximisation algorithm, and inferences are based on approximate standard errors from the empirical profile information matrix, which are contrasted to an alternative bootstrap estimation approach. We illustrate the model and software on a real data example for patients with primary biliary cirrhosis with three repeatedly measured biomarkers.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>An open-source software package capable of fitting multivariate joint models is available. The underlying algorithm and source code makes use of several methods to increase computational speed.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12874-018-0502-1) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Joint modelling</kwd>
      <kwd>Longitudinal data</kwd>
      <kwd>Multivariate data</kwd>
      <kwd>Time-to-event data</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/M013227/1</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>In many clinical studies, subjects are followed-up repeatedly and response data collected. For example, routine blood tests might be performed at each follow-up clinic appointment for patients enrolled in a randomized drug trial, and biomarker measurements recorded. An event time is also usually of interest, for example time of death or study drop-out. It has been repeatedly shown elsewhere that if the longitudinal and event-time outcomes are correlated, then modelling the two outcome processes separately, for example using linear mixed models and Cox regression models, can lead to biased effect size estimates [<xref ref-type="bibr" rid="CR1">1</xref>]. The same criticism has also been levelled at the application of so-called two-stage models [<xref ref-type="bibr" rid="CR2">2</xref>]. The motivation for using joint models can be broadly separated into interest in drawing inference about (1) the time-to-event process whilst adjusting for the intermittently measured (and potentially error-prone) longitudinal outcomes, and (2) the longitudinal data process whilst adjusting for a potentially informative drop-out mechanism [<xref ref-type="bibr" rid="CR3">3</xref>]. The literature on joint modelling is extensive, with excellent reviews given by Tsiatis and Davidian [<xref ref-type="bibr" rid="CR4">4</xref>], Gould et al. [<xref ref-type="bibr" rid="CR5">5</xref>], and the book by Rizopoulos [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Joint modelling has until recently been predominated by modelling a single longitudinal outcome together with a solitary event time outcome; herein referred to as <italic>univariate joint modelling</italic>. Commensurate with methodological research has been an increase in wide-ranging clinical applications (e.g. [<xref ref-type="bibr" rid="CR7">7</xref>]). Recent innovations in the field of joint models have included the incorporation of multivariate longitudinal data [<xref ref-type="bibr" rid="CR8">8</xref>], competing risks data [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], recurrent events data [<xref ref-type="bibr" rid="CR11">11</xref>], multivariate time-to-event data [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], non-continuous repeated measurements (e.g. count, binary, ordinal, and censored data) [<xref ref-type="bibr" rid="CR14">14</xref>], non-normally and non-parametrically distributed random effects [<xref ref-type="bibr" rid="CR15">15</xref>], alternative estimation methodologies (e.g. Bayesian fitting and conditional estimating equations) [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], and different association structures [<xref ref-type="bibr" rid="CR18">18</xref>]. In this article, we specifically focus on the first innovation: multivariate longitudinal data. In this situation, we assume that multiple longitudinal outcomes are measured on each subject, which can be unbalanced and measured at different times for each subject.</p>
    <p>Despite the inherently obvious benefits of harnessing all data in a single model or the published research on the topic of joint models for multivariate longitudinal data, a recent literature review by Hickey et al. [<xref ref-type="bibr" rid="CR19">19</xref>] identified that publicly available software for fitting such models was lacking, which has translated into limited uptake by biomedical researchers. In this article we present the classical joint model described by Henderson et al. [<xref ref-type="bibr" rid="CR3">3</xref>] extended to the case of multiple longitudinal outcomes. An algorithm proposed by Lin et al. [<xref ref-type="bibr" rid="CR20">20</xref>] is used to fit the model, augmented by techniques to reduce the computational fitting time, including a quasi-Newton update approach, variance reduction method, and dynamic Monte Carlo updates. This algorithm is encoded into a R sofware package–joineRML. A simulation analysis and real-world data example are used to demonstrate the accuracy of the algorithm and the software, respectively.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>As a prelude to the introduction and demonstration of the newly introduced software package, in the following section we describe the underlying model formulation and model fitting methodology.</p>
    <sec id="Sec3">
      <title>Model</title>
      <p>For each subject <italic>i</italic>=1,…,<italic>n</italic>, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {y}_{i} = \left (\boldsymbol {y}_{i1}^{\top }, \dots, \boldsymbol {y}_{iK}^{\top }\right)$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iK</mml:mtext></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq1.gif"/></alternatives></inline-formula> is the <italic>K</italic>-variate continuous outcome vector, where each <bold><italic>y</italic></bold><sub><italic>ik</italic></sub> denotes an (<italic>n</italic><sub><italic>ik</italic></sub>×1)-vector of observed longitudinal measurements for the <italic>k</italic>-th outcome type: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {y}_{ik} = (y_{i1k}, \dots, y_{in_{ik}k})^{\top }$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq2.gif"/></alternatives></inline-formula>. Each outcome is measured at observed (possibly pre-specified) times <italic>t</italic><sub><italic>ijk</italic></sub> for <italic>j</italic>=1,…,<italic>n</italic><sub><italic>ik</italic></sub>, which can differ between subjects and outcomes. Additionally, for each subject there is an event time <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i}^{*}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq3.gif"/></alternatives></inline-formula>, which is subject to right censoring. Therefore, we observe <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i} = \min (T_{i}^{*}, C_{i})$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq4.gif"/></alternatives></inline-formula>, where <italic>C</italic><sub><italic>i</italic></sub> corresponds to a potential censoring time, and the failure indicator <italic>δ</italic><sub><italic>i</italic></sub>, which is equal to 1 if the failure is observed <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(T_{i}^{*} \leq C_{i})$\end{document}</tex-math><mml:math id="M10"><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq5.gif"/></alternatives></inline-formula> and 0 otherwise. We assume that both censoring and measurement times are non-informative.</p>
      <p>The model we describe is the natural extension of the model proposed by Henderson et al. [<xref ref-type="bibr" rid="CR3">3</xref>] to the case of multivariate longitudinal data. The model posits an unobserved or latent zero-mean (<italic>K</italic>+1)-variate Gaussian process that is realised independently for each subject, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{i}(t) = \left \{W_{1i}^{(1)}(t), \dots, W_{1i}^{(K)}(t), W_{2i}(t)\right \}$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq6.gif"/></alternatives></inline-formula>. This latent process subsequently links the separate sub-models via association parameters.</p>
      <p>The <italic>k</italic>-th longitudinal data sub-model is given by 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ y_{ik}(t) = \mu_{ik}(t) + W_{1i}^{(k)}(t) + \varepsilon_{ik}(t),  $$ \end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>μ</italic><sub><italic>ik</italic></sub>(<italic>t</italic>) is the mean response, and <italic>ε</italic><sub><italic>ik</italic></sub>(<italic>t</italic>) is the model error term, which we assume to be independent and identically distributed normal with mean 0 and variance <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{k}^{2}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq7.gif"/></alternatives></inline-formula>. The mean response is specified as a linear model 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mu_{ik}(t) = \boldsymbol{x}_{ik}^{\top}(t) \boldsymbol{\beta}_{k},  $$ \end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>x</italic></bold><sub><italic>ik</italic></sub>(<italic>t</italic>) is a <italic>p</italic><sub><italic>k</italic></sub>-vector of (possibly) time-varying covariates with corresponding fixed effect terms <bold><italic>β</italic></bold><sub><italic>k</italic></sub>. <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1i}^{(k)}(t)$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq8.gif"/></alternatives></inline-formula> is specified as 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ W_{1i}^{(k)}(t) = \boldsymbol{z}_{ik}^{\top}(t) \boldsymbol{b}_{ik},  $$ \end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>z</italic></bold><sub><italic>ik</italic></sub>(<italic>t</italic>) is an <italic>r</italic><sub><italic>k</italic></sub>-vector of (possibly) time-varying covariates with corresponding subject-and-outcome random effect terms <bold><italic>b</italic></bold><sub><italic>ik</italic></sub>, which follow a zero-mean multivariate normal distribution with (<italic>r</italic><sub><italic>k</italic></sub>×<italic>r</italic><sub><italic>k</italic></sub>)-variance-covariance matrix <bold><italic>D</italic></bold><sub><italic>kk</italic></sub>. To account for dependence between the different longitudinal outcome outcomes, we let cov(<bold><italic>b</italic></bold><sub><italic>ik</italic></sub>,<bold><italic>b</italic></bold><sub><italic>il</italic></sub>)=<bold><italic>D</italic></bold><sub><italic>kl</italic></sub> for <italic>k</italic>≠<italic>l</italic>. Furthermore, we assume <italic>ε</italic><sub><italic>ik</italic></sub>(<italic>t</italic>) and <bold><italic>b</italic></bold><sub><italic>ik</italic></sub> are uncorrelated, and that the censoring times are independent of the random effects. These distributional assumptions together with the model given by (<xref rid="Equ1" ref-type="">1</xref>)–(<xref rid="Equ3" ref-type="">3</xref>) are equivalent to the multivariate extension of the Laird and Ware [<xref ref-type="bibr" rid="CR21">21</xref>] linear mixed effects model. More flexible specifications of <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1i}^{(k)}(t)$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq9.gif"/></alternatives></inline-formula> can be used [<xref ref-type="bibr" rid="CR3">3</xref>], including for example, stationary Gaussian processes. However, we do not consider these cases here owing to the increased computational burden it carries, even for the univariate case.</p>
      <p>The sub-model for the time-to-event outcome is given by the hazard model 
<disp-formula id="Equa"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \lambda_{i}(t) = \lambda_{0}(t) \exp \left\{\boldsymbol{v}_{i}^{\top}(t) \boldsymbol{\gamma}_{v} + W_{2i}(t)\right\}, $$ \end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>λ</italic><sub>0</sub>(·) is an unspecified baseline hazard, and <bold><italic>v</italic></bold><sub><italic>i</italic></sub>(<italic>t</italic>) is a <italic>q</italic>-vector of (possibly) time-varying covariates with corresponding fixed effect terms <bold><italic>γ</italic></bold><sub><italic>v</italic></sub>. Conditional on <italic>W</italic><sub><italic>i</italic></sub>(<italic>t</italic>) and the observed covariate data, the longitudinal and time-to-event data generating processes are conditionally independent. To establish a latent association, we specify <italic>W</italic><sub>2<italic>i</italic></sub>(<italic>t</italic>) as a linear combination of <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{W_{1i}^{(1)}(t), \dots, W_{1i}^{(K)}(t)\right \}$\end{document}</tex-math><mml:math id="M28"><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq10.gif"/></alternatives></inline-formula>: 
<disp-formula id="Equb"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ W_{2i}(t) = \sum\limits_{k=1}^{K} \gamma_{yk} W_{1i}^{(k)}(t), $$ \end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">yk</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <bold><italic>γ</italic></bold><sub><italic>y</italic></sub>=(<italic>γ</italic><sub><italic>y</italic>1</sub>,…,<italic>γ</italic><sub><italic>yK</italic></sub>) are the corresponding association parameters. To emphasise the dependence of <italic>W</italic><sub>2<italic>i</italic></sub>(<italic>t</italic>) on the random effects, we explicitly write it as <italic>W</italic><sub>2<italic>i</italic></sub>(<italic>t</italic>,<bold><italic>b</italic></bold><sub><italic>i</italic></sub>) from here onwards. As per <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1i}^{(k)}(t)$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq11.gif"/></alternatives></inline-formula>, <italic>W</italic><sub>2<italic>i</italic></sub>(<italic>t</italic>,<bold><italic>b</italic></bold><sub><italic>i</italic></sub>) can also be flexibly extended, for example to include subject-specific frailty effects [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Estimation</title>
      <sec id="Sec5">
        <title>Likelihood</title>
        <p>For each subject <italic>i</italic>, let <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{i} = \bigoplus _{k = 1}^{K} \boldsymbol {X}_{ik}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>⊕</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Z}_{i} = \bigoplus _{k = 1}^{K} \boldsymbol {Z}_{ik}$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>⊕</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq13.gif"/></alternatives></inline-formula> be block-diagonal matrices, where <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}_{ik} = \left (\boldsymbol {x}_{i1k}^{\top }, \dots, \boldsymbol {x}_{in_{ik}k}^{\top }\right)$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq14.gif"/></alternatives></inline-formula> is an (<italic>n</italic><sub><italic>ik</italic></sub>×<italic>p</italic><sub><italic>k</italic></sub>)-design matrix, with the <italic>j</italic>-th row corresponding to the <italic>p</italic><sub><italic>k</italic></sub>-vector of covariates measured at time <italic>t</italic><sub><italic>ijk</italic></sub>, and <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bigoplus $\end{document}</tex-math><mml:math id="M40"><mml:mo>⊕</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq15.gif"/></alternatives></inline-formula> denotes the direct matrix sum. The notation similarly follows for the random effects design matrices, <bold><italic>Z</italic></bold><sub><italic>ik</italic></sub>. We denote the error terms by a diagonal matrix <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\Sigma }_{i} = \bigoplus _{k = 1}^{K} \sigma _{k}^{2} \boldsymbol {I}_{n_{ik}}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>⊕</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq16.gif"/></alternatives></inline-formula> and write the overall variance-covariance matrix for the random effects as 
<disp-formula id="Equc"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{D} = \left(\begin{array}{ccc} \boldsymbol{D}_{11} &amp; \cdots &amp; \boldsymbol{D}_{1K} \\ \vdots &amp; \ddots &amp; \vdots \\ \boldsymbol{D}_{1K}^{\top} &amp; \cdots &amp; \boldsymbol{D}_{KK} \\ \end{array}\right), $$ \end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">KK</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <bold><italic>I</italic></bold><sub><italic>n</italic></sub> denotes an <italic>n</italic>×<italic>n</italic> identity matrix. We further define <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta } = \left (\boldsymbol {\beta }_{1}^{\top }, \dots, \boldsymbol {\beta }_{K}^{\top }\right)^{\top }$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {b}_{i} = \left (\boldsymbol {b}_{i1}^{\top }, \dots, \boldsymbol {b}_{iK}^{\top }\right)^{\top }$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iK</mml:mtext></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq18.gif"/></alternatives></inline-formula>. Hence, we can then rewrite the longitudinal outcome sub-model as 
<disp-formula id="Equd"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \boldsymbol{y}_{i} \,|\, \boldsymbol{b}_{i}, \boldsymbol{\beta}, \boldsymbol{\Sigma}_{i} &amp;\sim&amp; N(\boldsymbol{X}_{i} \boldsymbol{\beta} + \boldsymbol{Z}_{i} \boldsymbol{b}_{i}, \boldsymbol{\Sigma}_{i}), \\ \text{with}\ \boldsymbol{b}_{i} \,|\, \boldsymbol{D} &amp;\sim&amp; N(\boldsymbol{0}, \boldsymbol{D}). \end{array} $$ \end{document}</tex-math><mml:math id="M50"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>For the estimation, we will assume that the covariates in the time-to-event sub-model are time-independent and known at baseline, i.e. <bold><italic>v</italic></bold><sub><italic>i</italic></sub>≡<bold><italic>v</italic></bold><sub><italic>i</italic></sub>(0). Extensions of the estimation procedure for time-varying covariates are outlined elsewhere [<xref ref-type="bibr" rid="CR6">6, p. 115</xref>]. The <italic>observed</italic> data likelihood for the joint outcome is given by 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \prod\limits_{i=1}^{n} \left(\int_{-\infty}^{\infty} f(\boldsymbol{y}_{i} \,|\, \boldsymbol{b}_{i}, \boldsymbol{\theta}) f(T_{i}, \delta_{i} \,|\, \boldsymbol{b}_{i}, \boldsymbol{\theta}) f(\boldsymbol{b}_{i} \,|\, \boldsymbol{\theta}) d\boldsymbol{b}_{i} \right),  $$ \end{document}</tex-math><mml:math id="M52"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq19"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\theta } = \left (\boldsymbol {\beta }^{\top }, \text {vech}(\boldsymbol {D}), \sigma _{1}^{2}, \dots, \sigma _{K}^{2}, \lambda _{0}(t), \boldsymbol {\gamma }_{v}^{\top }, \boldsymbol {\gamma }_{y}^{\top }\right)$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext>vech</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq19.gif"/></alternatives></inline-formula> is the collection of unknown parameters that we want to estimate, with vech(<bold><italic>D</italic></bold>) denoting the half-vectorisation operator that returns the vector of lower-triangular elements of matrix <bold><italic>D</italic></bold>.</p>
        <p>As noted by Henderson et al. [<xref ref-type="bibr" rid="CR3">3</xref>], the observed data likelihood can be calculated by rewriting it as 
<disp-formula id="Eque"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \prod\limits_{i=1}^{n} f(\boldsymbol{y}_{i} \,|\, \boldsymbol{\theta}) \left(\int_{-\infty}^{\infty} f(T_{i}, \delta_{i} \,|\, \boldsymbol{b}_{i}, \boldsymbol{\theta}) f(\boldsymbol{b}_{i} \,|\, \boldsymbol{y}_{i}, \boldsymbol{\theta}) d\boldsymbol{b}_{i} \right), $$ \end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> where the marginal distribution <italic>f</italic>(<bold><italic>y</italic></bold><sub><italic>i</italic></sub> | <bold><italic>θ</italic></bold>) is a multivariate normal density with mean <bold><italic>X</italic></bold><sub><italic>i</italic></sub><bold><italic>β</italic></bold> and variance-covariance matrix <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\Sigma }_{i} + \boldsymbol {Z}_{i} \boldsymbol {D} \boldsymbol {Z}_{i}^{\top }$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq20.gif"/></alternatives></inline-formula>, and <italic>f</italic>(<bold><italic>b</italic></bold><sub><italic>i</italic></sub> | <bold><italic>y</italic></bold><sub><italic>i</italic></sub>,<bold><italic>θ</italic></bold>) is given by (<xref rid="Equ6" ref-type="">6</xref>).</p>
      </sec>
      <sec id="Sec6">
        <title>MCEM algorithm</title>
        <p>We determine maximum likelihood estimates of the parameters <bold><italic>θ</italic></bold> using the Monte Carlo Expectation Maximisation (MCEM) algorithm [<xref ref-type="bibr" rid="CR22">22</xref>], by treating the random effects <bold><italic>b</italic></bold><sub><italic>i</italic></sub> as missing data. This is effectively the same as the conventional Expectation-Maximisation (EM) algorithm, as used by Wulfsohn and Tsiatis [<xref ref-type="bibr" rid="CR23">23</xref>] and Ratcliffe et al. [<xref ref-type="bibr" rid="CR24">24</xref>] in the context of fitting univariate data joint models, except the E-step exploits a Monte Carlo (MC) integration routine as opposed to Gaussian quadrature methods, which we expect to be beneficial when the dimension of random effects becomes large.</p>
        <p>Starting from an initial estimate of the parameters, <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\theta }}^{(0)}$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq21.gif"/></alternatives></inline-formula>, the procedure involves iterating between the following two steps until convergence is achieved. 
<list list-type="order"><list-item><p><italic>E-step</italic>. At the (<italic>m</italic>+1)-th iteration, we compute the expected log-likelihood of the <italic>complete</italic> data conditional on the <italic>observed</italic> data and the current estimate of the parameters, 
<disp-formula id="Equf"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} {\selectfont{\begin{aligned} {} Q(\boldsymbol{\theta} \,|\, \hat{\boldsymbol{\theta}}^{(m)}) &amp;= \sum\limits_{i=1}^{n} \mathbb{E} \Big\{\log f(\boldsymbol{y}_{i}, T_{i}, \delta_{i}, \boldsymbol{b}_{i} \,|\, \boldsymbol{\theta})\Big\} \\ &amp;= \sum\limits _{i=1}^{n} \int_{-\infty}^{\infty} \Big\{\log f(\boldsymbol{y}_{i}, T_{i}, \delta_{i}, \boldsymbol{b}_{i} \,|\, \boldsymbol{\theta})\Big\} f(\boldsymbol{b}_{i} \,\!|\, T_{i}, \delta_{i}, \boldsymbol{y}_{i};\hat{\boldsymbol{\theta}}^{(m)}) d\boldsymbol{b}_{i}. \end{aligned}}} \end{array} $$ \end{document}</tex-math><mml:math id="M62"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtable><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="{" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>log</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="}" separators=""><mml:mrow/></mml:mfenced></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="{" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mo>log</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mstyle mathsize="1.61em"><mml:mfenced close="" open="}" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p><p>Here, the complete-data likelihood contribution for subject <italic>i</italic> is given by the integrand of (<xref rid="Equ4" ref-type="">4</xref>).</p></list-item><list-item><p><italic>M-step</italic>. We maximise <inline-formula id="IEq22"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q(\boldsymbol {\theta } \,|\, \hat {\boldsymbol {\theta }}^{(m)})$\end{document}</tex-math><mml:math id="M64"><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq22.gif"/></alternatives></inline-formula> with respect to <bold><italic>θ</italic></bold>. Namely, we set 
<disp-formula id="Equg"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{\boldsymbol{\theta}}^{(m+1)} = \underset{\boldsymbol{\theta}}{\text{argmax}}\ Q\left(\boldsymbol{\theta} \,|\, \hat{\boldsymbol{\theta}}^{(m)}\right). $$ \end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:munder><mml:mspace width="1em"/><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
        <p>The M-step estimators naturally follow from Wulfsohn and Tsiatis [<xref ref-type="bibr" rid="CR23">23</xref>] and Lin et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. Maximizers for all parameters except <bold><italic>γ</italic></bold><sub><italic>v</italic></sub> and <bold><italic>γ</italic></bold><sub><italic>y</italic></sub> are available in closed-form; algebraic details are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The parameters <inline-formula id="IEq23"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\gamma } = (\boldsymbol {\gamma _{v}}^{\top }, \boldsymbol {\gamma }_{y}^{\top })^{\top }$\end{document}</tex-math><mml:math id="M68"><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq23.gif"/></alternatives></inline-formula> are jointly updated using a one-step Newton-Raphson algorithm as 
<disp-formula id="Equh"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{\boldsymbol{\gamma}}^{(m+1)} = \hat{\boldsymbol{\gamma}}^{(m)} + I\left(\hat{\boldsymbol{\gamma}}^{(m)}\right)^{-1} S\left(\hat{\boldsymbol{\gamma}}^{(m)}\right),$$ \end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\gamma }}^{(m)}$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq24.gif"/></alternatives></inline-formula> denotes the value of <bold><italic>γ</italic></bold> at the current iteration, <inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S\left (\hat {\boldsymbol {\gamma }}^{(m)}\right)$\end{document}</tex-math><mml:math id="M74"><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq25.gif"/></alternatives></inline-formula> is the corresponding score, and <inline-formula id="IEq26"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I\left (\hat {\boldsymbol {\gamma }}^{(m)}\right)$\end{document}</tex-math><mml:math id="M76"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq26.gif"/></alternatives></inline-formula> is the observed information matrix, which is equal to the derivative of the negative score. Further details of this update are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The M-step for <bold><italic>γ</italic></bold> is computationally expensive to evaluate. Therefore, we also propose a quasi-Newton one-step update by approximating <inline-formula id="IEq27"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I\left (\hat {\boldsymbol {\gamma }}^{(m)}\right)$\end{document}</tex-math><mml:math id="M78"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq27.gif"/></alternatives></inline-formula> by an empirical information matrix for <bold><italic>γ</italic></bold>, which can be considered an analogue of the Gauss-Newton method [<xref ref-type="bibr" rid="CR25">25, p. 8</xref>]. To further compensate for this approximation, we also use a nominal step-size of 0.5 rather than 1, which is used when using the Newton-Raphson update.</p>
        <p>The M-step involves terms of the form <inline-formula id="IEq28"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {E}\left [h(\boldsymbol {b}_{i}) \,|\, T_{i},{\vphantom {\hat {\boldsymbol {\theta }}}}\right. \left.\delta _{i}, \boldsymbol {y}_{i}; \hat {\boldsymbol {\theta }}\right ]$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mfenced close="" open="[" separators=""><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close="]" open="" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq28.gif"/></alternatives></inline-formula>, for known functions <italic>h</italic>(·). The conditional expectation of a function of the random effects can be written as 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\selectfont{\begin{aligned} {} \mathbb{E}\left[h(\boldsymbol{b}_{i}) \,|\, T_{i}, \delta_{i}, \boldsymbol{y}_{i}; \hat{\boldsymbol{\theta}}\right] = \frac{\int_{-\infty}^{\infty} h(\boldsymbol{b}_{i}) f(\boldsymbol{b}_{i} \,|\, \boldsymbol{y}_{i}; \hat{\boldsymbol{\theta}}) f(T_{i}, \delta_{i} \,|\, \boldsymbol{b}_{i}; \hat{\boldsymbol{\theta}}) d\boldsymbol{b}_{i}}{\int_{-\infty}^{\infty} f(\boldsymbol{b}_{i} \,|\, \boldsymbol{y}_{i}; \hat{\boldsymbol{\theta}}) f(T_{i}, \delta_{i} \,|\, \boldsymbol{b}_{i}; \hat{\boldsymbol{\theta}}) d\boldsymbol{b}_{i}}, \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M82"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq29"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f(T_{i}, \delta _{i} \,|\, \boldsymbol {b}_{i}; \hat {\boldsymbol {\theta }})$\end{document}</tex-math><mml:math id="M84"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq29.gif"/></alternatives></inline-formula> is given by 
<disp-formula id="Equi"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\selectfont{\begin{aligned} {} f(T_{i}, \delta_{i} \,|\, \boldsymbol{b}_{i}; \boldsymbol{\theta}) = &amp;\left[\lambda_{0}(T_{i}) \exp\left\{\boldsymbol{v}_{i}^{\top} \boldsymbol{\gamma}_{v} + W_{2i}(T_{i}, \boldsymbol{b}_{i})\right\}\right]^{\delta_{i}} \\ &amp;\times \exp\left\{-\int_{0}^{T_{i}}\lambda_{0}(u)\exp\left\{\boldsymbol{v}_{i}^{\top} \boldsymbol{\gamma}_{v} + W_{2i}(u, \boldsymbol{b}_{i})\right\}du\right\} \end{aligned}}} $$ \end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mtext mathvariant="italic">du</mml:mtext></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f(\boldsymbol {b}_{i} \,|\, \boldsymbol {y}_{i}; \hat {\boldsymbol {\theta }})$\end{document}</tex-math><mml:math id="M88"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq30.gif"/></alternatives></inline-formula> is calculated from multivariate normal distribution theory as 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{b}_{i} \,|\, \boldsymbol{y}_{i}, \boldsymbol{\theta} \sim N\left(\boldsymbol{A}_{i} \left\{\boldsymbol{Z}_{i}^{\top} \boldsymbol{\Sigma}_{i}^{-1}(\boldsymbol{y}_{i} - \boldsymbol{X}_{i} \boldsymbol{\beta})\right\}, \boldsymbol{A}_{i}\right),  $$ \end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>with <inline-formula id="IEq31"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {A}_{i} = \left (\boldsymbol {Z}_{i}^{\top } \boldsymbol {\Sigma }_{i}^{-1} \boldsymbol {Z}_{i} + \boldsymbol {D}^{-1}\right)^{-1}$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq31.gif"/></alternatives></inline-formula>. As this becomes computationally expensive using Gaussian quadrature commensurate with increasing dimension of <bold><italic>b</italic></bold><sub><italic>i</italic></sub>, we estimate the integrals by MC sampling such that the expectation is approximated by the ratio of the sample means for <inline-formula id="IEq32"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$h(\boldsymbol {b}_{i}) f(T_{i}, \delta _{i} \,|\, \boldsymbol {b}_{i}; \hat {\boldsymbol {\theta }})$\end{document}</tex-math><mml:math id="M94"><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f(T_{i}, \delta _{i} \,|\, \boldsymbol {b}_{i}; \hat {\boldsymbol {\theta }})$\end{document}</tex-math><mml:math id="M96"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq33.gif"/></alternatives></inline-formula> evaluated at each MC draw. Furthermore, we use antithetic simulation for variance reduction in the MC integration. Instead of directly sampling from (<xref rid="Equ6" ref-type="">6</xref>), we sample <bold><italic>Ω</italic></bold>∼<italic>N</italic>(0,<bold><italic>I</italic></bold><sub><italic>r</italic></sub>) and obtain the <italic>pairs</italic>
<disp-formula id="Equj"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{A}_{i} \left\{ \boldsymbol{Z}_{i}^{\top} \boldsymbol{\Sigma}_{i}^{-1} (\boldsymbol{y}_{i} - \boldsymbol{X}_{i} \boldsymbol{\beta}) \right\} \pm \boldsymbol{C}_{i} \boldsymbol{\Omega}, $$ \end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where <bold><italic>C</italic></bold><sub><italic>i</italic></sub> is the Cholesky decomposition of <bold><italic>A</italic></bold><sub><italic>i</italic></sub> such that <inline-formula id="IEq34"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {C}_{i} \boldsymbol {C}_{i}^{\top } = \boldsymbol {A}_{i}$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq34.gif"/></alternatives></inline-formula>. Therefore we only need to draw <italic>N</italic>/2 samples using this approach, and by virtue of the negative correlation between the pairs, it leads to a smaller variance in the sample means taken in the approximation than would be obtained from <italic>N</italic> independent simulations. The choice of <italic>N</italic> is described below.</p>
      </sec>
      <sec id="Sec7">
        <title>Initial values</title>
        <p>The EM algorithm requires that initial parameters are specified, namely <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\theta }}^{(0)}$\end{document}</tex-math><mml:math id="M102"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq35.gif"/></alternatives></inline-formula>. By choosing values close to the maximizer, the number of iterations required to reach convergence should be reduced.</p>
        <p>For the time-to-event sub-model, a quasi-two-stage model is fitted when the measurement times are balanced, i.e. when <italic>t</italic><sub><italic>ijk</italic></sub>=<italic>t</italic><sub><italic>ij</italic></sub>∀<italic>k</italic>. That is, we fit <italic>separate</italic> LMMs for each longitudinal outcome as per (<xref rid="Equ1" ref-type="">1</xref>), ignoring the correlation between different outcomes. This is straightforward to implement using standard software, in particular using lme() and coxph() from the R packages nlme [<xref ref-type="bibr" rid="CR26">26</xref>] and survival [<xref ref-type="bibr" rid="CR27">27</xref>], respectively. From the fitted models, the best linear unbiased predictions (BLUPs) of the separate model random effects are used to estimate each <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1i}^{(k)}(t)$\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq36.gif"/></alternatives></inline-formula> function. These estimates are then included as time-varying covariates in a Cox regression model, alongside any other fixed effect covariates, which can be straightforwardly fitted using standard software. In the situation that the data are not balanced, i.e. when <italic>t</italic><sub><italic>ijk</italic></sub>≠<italic>t</italic><sub><italic>ij</italic></sub>∀<italic>k</italic>, then we fit a standard Cox proportional hazards regression model to estimate <bold><italic>γ</italic></bold><sub><italic>v</italic></sub> and set <italic>γ</italic><sub><italic>yk</italic></sub>=0∀<italic>k</italic>.</p>
        <p>For the longitudinal data sub-model, when <italic>K</italic>&gt;1 we first find the maximum likelihood estimate of <inline-formula id="IEq37"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\boldsymbol {\beta }, \text {vech}(\boldsymbol {D}), \sigma _{1}^{2}, \dots, \sigma _{K}^{2}\right \}$\end{document}</tex-math><mml:math id="M106"><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mtext>vech</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq37.gif"/></alternatives></inline-formula> by running a separate EM algorithm for the multivariate linear mixed model. Both the E- and M-step updates are available in closed form, and the initial parameters for this EM algorithm are available from the separate LMM fits, with <bold><italic>D</italic></bold> initialized as block-diagonal. As these are estimated using an EM rather than MCEM algorithm, we can specify a stricter convergence criterion on the estimates.</p>
      </sec>
      <sec id="Sec8">
        <title>Convergence and stopping rules</title>
        <p>Two standard stopping rules for the deterministic EM algorithm used to declare convergence are the relative and absolute differences, defined as 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \Delta_{\text{rel}}^{(m+1)} &amp;=&amp; \max\left\{\frac{\left|\hat{\boldsymbol{\theta}}^{(m+1)} - \hat{\boldsymbol{\theta}}^{(m)}\right|}{\left|\hat{\boldsymbol{\theta}}^{(m)}\right| + \epsilon_{1}}\right\} &lt; \epsilon_{0}, \text{ and}  \end{array} $$ \end{document}</tex-math><mml:math id="M108"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>
          <disp-formula id="Equ8">
            <label>8</label>
            <alternatives>
              <tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \Delta_{\text{abs}}^{(m+1)} &amp;=&amp; \max\left\{\left|\hat{\boldsymbol{\theta}}^{(m+1)} - \hat{\boldsymbol{\theta}}^{(m)}\right|\right\} &lt; \epsilon_{2}  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M110">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>Δ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext>abs</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mtd>
                    <mml:mtd class="eqnarray-2">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd class="eqnarray-3">
                      <mml:mo>max</mml:mo>
                      <mml:mfenced close="}" open="{" separators="">
                        <mml:mrow>
                          <mml:mfenced close="|" open="|" separators="">
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold-italic">θ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>^</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>m</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo>−</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold-italic">θ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>^</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>m</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>&lt;</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>ε</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12874_2018_502_Article_Equ8.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>respectively, for some appropriate choice of <italic>ε</italic><sub>0</sub>, <italic>ε</italic><sub>1</sub>, and <italic>ε</italic><sub>2</sub>, where the maximum is taken over the components of <bold><italic>θ</italic></bold>. For reference, the R package JM [<xref ref-type="bibr" rid="CR28">28</xref>] implements (<xref rid="Equ7" ref-type="">7</xref>) (in combination with another rule based on relative change in the likelihood), whereas the R package joineR [<xref ref-type="bibr" rid="CR29">29</xref>] implements (<xref rid="Equ8" ref-type="">8</xref>). The relative difference might be unstable about parameters near zero that are subject to MC error. Therefore, the convergence criterion for each parameter might be chosen separately at each EM iteration based on whether the absolute magnitude is below or above some threshold. A similar approach is adopted in the EM algorithms employed by the software package SAS [<xref ref-type="bibr" rid="CR30">30, p. 330</xref>].</p>
        <p>The choice of <italic>N</italic> and the monitoring of convergence are conflated when applying a MCEM algorithm, and a dynamic approach is required. As noted by [<xref ref-type="bibr" rid="CR22">22</xref>], it is computationally inefficient to use a large <italic>N</italic> in the early phase of the algorithm when the parameter estimates are likely to be far from the maximizer. On the flip side, as the parameter estimates approach the maximizer, the stopping rules will fail as the changes in parameter estimates will be swamped by MC error. Therefore, it has been recommended that one increase <italic>N</italic> as the estimate moves towards the maximizer. Although this might be done subjectively [<xref ref-type="bibr" rid="CR31">31</xref>] or by pre-specified rules [<xref ref-type="bibr" rid="CR32">32</xref>], an automated approach is preferable and necessary for a software implementation. Booth and Hobert [<xref ref-type="bibr" rid="CR33">33</xref>] proposed an update rule based on a confidence ellipsoid for the maximizer at the (<italic>m</italic>+1)-th iteration, calculated using an approximate sandwich estimator for the maximizer, which accounts for the MC error at each iteration. This approach requires additional variance estimation at each iteration, therefore we opt for a simpler approach described by Ripatti et al. [<xref ref-type="bibr" rid="CR34">34</xref>]. Namely, we calculate a coefficient of variation at the (<italic>m</italic>+1)-th iteration as 
<disp-formula id="Equk"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{cv}\left(\Delta_{\text{rel}}^{(m+1)}\right) = \frac{\text{sd}\left(\Delta_{\text{rel}}^{(m-1)}, \Delta_{\text{rel}}^{(m)}, \Delta_{\text{rel}}^{(m+1)}\right)}{\text{mean}\left(\Delta_{\text{rel}}^{(m-1)}, \Delta_{\text{rel}}^{(m)}, \Delta_{\text{rel}}^{(m+1)}\right)}, $$ \end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mtext>cv</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>sd</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12874_2018_502_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq38"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta _{\text {rel}}^{(m+1)}$\end{document}</tex-math><mml:math id="M114"><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq38.gif"/></alternatives></inline-formula> is given by (<xref rid="Equ7" ref-type="">7</xref>), and sd(·) and mean(·) are the sample standard deviation and mean functions, respectively. If <inline-formula id="IEq39"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {cv}\left (\Delta _{\text {rel}}^{(m+1)}\right) &gt; \text {cv}\left (\Delta _{\text {rel}}^{(m)}\right)$\end{document}</tex-math><mml:math id="M116"><mml:mtext>cv</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mtext>cv</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq39.gif"/></alternatives></inline-formula>, then <italic>N</italic>:=<italic>N</italic>+⌊<italic>N</italic>/<italic>δ</italic>⌋, for some small positive integer <italic>δ</italic>. Typically, we run the MCEM algorithm with a small <italic>N</italic> (for a fixed number of iterations—a <italic>burn-in</italic>) before implementing this update rule in order to get into the approximately correct parameter region. Appropriate values for other parameters will be application specific, however we have found <italic>δ</italic>=3, <italic>N</italic>=100<italic>K</italic> (for 100<italic>K</italic> burn-in iterations), <italic>ε</italic><sub>1</sub>=0.001, and <italic>ε</italic><sub>0</sub>=<italic>ε</italic><sub>2</sub>=0.005 delivers reasonably accurate estimates in many cases, where <italic>K</italic> was earlier defined as the number of longitudinal outcomes.</p>
        <p>As the EM monotonicity property is lost due to the MC integrations in the MCEM algorithm, convergence might be prematurely declared due to stochasticity if the <italic>ε</italic>-values are too large. To reduce the chance of this occurring, we require that the stopping rule is satisfied for 3 consecutive iterations [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. However, in any case, trace plots should be inspected to confirm convergence is appropriate.</p>
      </sec>
      <sec id="Sec9">
        <title>Standard error estimation</title>
        <p>Standard error (SE) estimation is usually based on inverting the observed information matrix. When the baseline hazard is unspecified, as is the case here, this presents several challenges. First, <inline-formula id="IEq40"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\lambda }_{0}(t)$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq40.gif"/></alternatives></inline-formula> will generally be a high-dimensional vector, which might lead to numerical difficulties in the inversion of the observed information matrix [<xref ref-type="bibr" rid="CR6">6</xref>]. Second, the profile likelihood estimates based on the usual observed information matrix approach are known to be underestimated [<xref ref-type="bibr" rid="CR35">35</xref>]. The reason for this is that the profile estimates are implicit, since the posterior expectations, given by (<xref rid="Equ5" ref-type="">5</xref>), depend on the parameters being estimated, including <italic>λ</italic><sub>0</sub>(<italic>t</italic>) [<xref ref-type="bibr" rid="CR6">6, p. 67</xref>].</p>
        <p>To overcome these challenges, Hsieh et al. [<xref ref-type="bibr" rid="CR35">35</xref>] recommended to use bootstrap methods to calculate the SEs. However, this approach is computationally expensive. Moreover, despite the purported theoretical advantages, we also note that recently it has been suggested that bootstrap estimators might actually <italic>overestimate</italic> the SEs; e.g. [<xref ref-type="bibr" rid="CR36">36, p. 740</xref>] and [<xref ref-type="bibr" rid="CR35">35, p. 1041</xref>]. At the model development stage, it is often of interest to gauge the strength of association of model covariates, which is not feasible with repeated bootstrap implementations. Hence, an approximate SE estimator is desirable. In either case, the theoretical properties will be contaminated by the addition of MC error from the MCEM algorithm, and it is not yet fully understood what the ramifications of this are. Hence, any standard errors must be interpreted with a degree of caution. We consider two estimators below.</p>
        <p><bold>1. Bootstrap method.</bold> These are estimated by sampling <italic>n</italic> subjects with replacement and re-labelling the subjects with indices <italic>i</italic><sup>′</sup>=1,…,<italic>n</italic>. We then re-fit the model to the bootstrap-sampled dataset. It is important to note that we re-sample subjects, not individual data points. This is repeated <italic>B</italic>-times, for a sufficiently large integer <italic>B</italic>. Since we already have the MLEs from the fitted model, we can use these as initial values for each bootstrap model fit, thus reducing initial computational overheads in calculating approximate initial parameters. For each iteration, we extract the model parameter estimates for <inline-formula id="IEq41"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\boldsymbol {\beta }^{\top }, \text {vech}(\boldsymbol {D}), \sigma _{1}^{2}, \dots, \sigma _{K}^{2}, \boldsymbol {\gamma }_{v}^{\top }, \boldsymbol {\gamma }_{y}^{\top }\right)$\end{document}</tex-math><mml:math id="M120"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext>vech</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq41.gif"/></alternatives></inline-formula>. Note that we do not estimate SEs for <italic>λ</italic><sub>0</sub>(<italic>t</italic>) using this approach. However, they are generally not of inferential interest. When <italic>B</italic> is sufficiently large, the SEs can be estimated from the estimated coefficients of the bootstrap samples. Alternatively, 100(1−<italic>α</italic>)%-confidence intervals can be estimated from the the 100<italic>α</italic>/2-th and 100(1−<italic>α</italic>/2)-th percentiles.</p>
        <p><bold>2. Empirical information matrix method.</bold> Using the Breslow estimator for <inline-formula id="IEq42"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\int _{0}^{t} \lambda _{0}(u) \mathrm {d}u$\end{document}</tex-math><mml:math id="M122"><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq42.gif"/></alternatives></inline-formula>, the profile score vector for <inline-formula id="IEq43"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\theta }_{-\lambda } = (\boldsymbol {\beta }^{\top }, \text {vech}(\boldsymbol {D}), \sigma _{1}^{2}, \dots, \sigma _{K}^{2}, \boldsymbol {\gamma }^{\top })$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext>vech</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq43.gif"/></alternatives></inline-formula> is calculated (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We approximate the profile information for <bold><italic>θ</italic></bold><sub>−<italic>λ</italic></sub> by <inline-formula id="IEq44"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{e}^{-1/2}(\hat {\boldsymbol {\theta }}_{-\lambda _{0}})$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq44.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{e}(\boldsymbol {\theta }_{-\lambda _{0}})\phantom {\dot {i}\!}$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq45.gif"/></alternatives></inline-formula> is the observed empirical information [<xref ref-type="bibr" rid="CR25">25</xref>] given by 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ I_{e}(\boldsymbol{\theta}_{-\lambda}) = \sum\limits_{i=1}^{n} s_{i}(\boldsymbol{\theta}_{-\lambda})^{\otimes 2} - \frac{1}{n} S(\boldsymbol{\theta}_{-\lambda})^{\otimes 2},  $$ \end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12874_2018_502_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
        <p><italic>s</italic><sub><italic>i</italic></sub>(<bold><italic>θ</italic></bold><sub>−<italic>λ</italic></sub>) is the conditional expectation of the complete-data profile score for subject <italic>i</italic>, <italic>S</italic>(<bold><italic>θ</italic></bold><sub>−<italic>λ</italic></sub>) is the score defined by <inline-formula id="IEq46"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S(\boldsymbol {\theta }_{-\lambda }) = \sum _{i=1}^{n} s_{i}(\boldsymbol {\theta }_{-\lambda })$\end{document}</tex-math><mml:math id="M132"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq46.gif"/></alternatives></inline-formula>, and <bold><italic>a</italic></bold><sup>⊗2</sup>=<bold><italic>a</italic></bold><bold><italic>a</italic></bold><sup>⊤</sup> is outer product for a vector <bold><italic>a</italic></bold>. At the maximizer, <inline-formula id="IEq47"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S(\hat {\boldsymbol {\theta }}) = 0$\end{document}</tex-math><mml:math id="M134"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq47.gif"/></alternatives></inline-formula>, meaning that the right hand-side of (<xref rid="Equ9" ref-type="">9</xref>) is zero. Due to the MC error in the MCEM algorithm, this will not be exactly zero, and therefore we include it in the calculations. As per the bootstrap approach, SEs for the baseline hazard are again not calculated. We note that this SE estimator will be subject to the exact same theoretical limitation of underestimation described by Hsieh et al. [<xref ref-type="bibr" rid="CR35">35</xref>], since the profiling was implicit; that is, because the posterior expectations involve the parameters <italic>θ</italic>.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Software</title>
      <p>The model described here is implemented in the R package joineRML, which is available on the The Comprehensive R Archive Network (CRAN) (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=joineRML">https://CRAN.R-project.org/package=joineRML</ext-link>). The principal function in joineRML is mjoint(). The primary arguments for implementing mjoint() are summarised in Table <xref rid="Tab1" ref-type="table">1</xref>. To achieve computationally efficiency, parts of the MCEM algorithm in joineRML are coded in C++ using the Armadillo linear algebra library and integrated using the R package RcppArmadillo [<xref ref-type="bibr" rid="CR37">37</xref>].
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The primary arguments<sup>a</sup> with descriptions for the mjoint() function in the R package joineRML</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Argument</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">
formLongFixed
</td><td align="justify">a list of formulae for the fixed effects component of each longitudinal outcome. The left hand-hand side defines the response, and the right-hand side specifies the fixed effect terms.</td></tr><tr><td align="left">
formLongRandom
</td><td align="justify">a list of one-sided formulae specifying the model for the random effects effects of each longitudinal outcome.</td></tr><tr><td align="left">
formSurv
</td><td align="justify">a formula specifying the proportional hazards regression model (not including the latent association structure).</td></tr><tr><td align="left">
data
</td><td align="justify">a list of data.frame objects for each longitudinal outcome in which to interpret the variables named in the formLongFixed and formLongRandom. The list structure enables one to include multiple longitudinal outcomes with different measurement protocols. If the multiple longitudinal outcomes are measured at the same time points for each patient (i.e. <italic>t</italic><sub><italic>ijk</italic></sub>=<italic>t</italic><sub><italic>ij</italic></sub>∀<italic>k</italic>), then a single data.frame object can be given instead of a list. It is assumed that each data frame is in <italic>long format</italic>.</td></tr><tr><td align="left">
survData
</td><td align="justify">(optional) a data.frame in which to interpret the variables named in the formSurv. If survData is not given, then mjoint() looks for the time-to-event data in data.</td></tr><tr><td align="left">
timeVar
</td><td align="justify">a character string indicating the time variable in the linear mixed effects model.</td></tr><tr><td align="left">
inits
</td><td align="justify">(optional) a list of initial values for some or all of the parameters estimated in the model.</td></tr><tr><td align="left">
control
</td><td align="justify">(optional) a list of control parameters. These allow for the control of <italic>ε</italic><sub>0</sub>, <italic>ε</italic><sub>1</sub>, and <italic>ε</italic><sub>2</sub> in (<xref rid="Equ7" ref-type="">7</xref>) and (<xref rid="Equ8" ref-type="">8</xref>); the choice of <italic>N</italic>, <italic>δ</italic>, and convergence criteria; the maximum number of MCEM iterations, and the minimum number of MCEM iterations during burn-in. Additionally, the control argument gammaOpt can be used to specify whether a one-step Newton-Raphson (=~NR~) or Gauss-Newton-like (=~GN~) update should be used for the M-step update of <bold><italic>γ</italic></bold>.</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>mjoint() also takes the optional additional arguments verbose, which if TRUE allows for monitoring updates at each MCEM algorithm iteration, and pfs, which if FALSE can force the function not to calculate post-fit statistics such as the BLUPs and associated standard errors of the random effects and approximate standard errors of the model parameters. In general, these arguments are not required</p></table-wrap-foot></table-wrap></p>
      <p>A model fitted using the mjoint() function returns an object of class mjoint. By default, approximate SE estimates are calculated using the empirical information matrix. If one wishes to use bootstrap standard error estimates, then the user can pass the model object to the bootSE() function. Several generic functions (or rather, S3 methods) can also be applied to mjoint objects, as described in Table <xref rid="Tab2" ref-type="table">2</xref>. These generic functions include common methods, for example coef(), which extracts the model coefficients; ranef(), which extracts the BLUPs (and optional standard errors); and resid(), which extracts the residuals from the linear mixed sub-model. The intention of these functions is to have a common syntax with standard R packages for linear mixed models [<xref ref-type="bibr" rid="CR26">26</xref>] and survival analysis [<xref ref-type="bibr" rid="CR27">27</xref>]. Additionally, plotting capabilities are included in joineRML. These include trace plots for assessment of convergence of the MCEM algorithm, and caterpillar plots for subject-specific random effects (Table <xref rid="Tab2" ref-type="table">2</xref>).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Additional functions with descriptions that can be applied to objects of class mjoint<sup>a</sup></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Function(s)</th><th align="left">Returns</th></tr></thead><tbody><tr><td align="left">logLik, AIC, BIC</td><td align="justify">the log-likelihood, Akaike information criterion and Bayesian information criterion statistics, respectively</td></tr><tr><td align="left">coef, fixef</td><td align="justify">the fixed effects parameter estimates</td></tr><tr><td align="left">
ranef
</td><td align="justify">the BLUPs (and optional standard errors)</td></tr><tr><td align="left">print<sup>a</sup>, summary<sup>c</sup></td><td align="justify">short and long model summary outputs, respectively</td></tr><tr><td align="left">fitted, resid</td><td align="justify">the fitted values and raw residuals from the multivariate LMM sub-model, respectively</td></tr><tr><td align="left">
plot
<sup>b</sup>
</td><td align="justify">the MCEM algorithm convergence trace plots</td></tr><tr><td align="left">
sigma
</td><td align="justify">the residual standard errors from the LMM sub-model</td></tr><tr><td align="left">
vcov
</td><td align="justify">the variance-covariance matrix of the main parameters of the fitted model (except the baseline hazard)</td></tr><tr><td align="left">
getVarCov
</td><td align="justify">the random effects variance-covariance matrix</td></tr><tr><td align="left">
confint
</td><td align="justify">the confidence intervals based on asymptotic normality</td></tr><tr><td align="left">
update
</td><td align="justify">specific parts of a fitted model can be updated, e.g. by adding or removing terms from a sub-model, and then re-fitted</td></tr><tr><td align="left">
sampleData
</td><td align="justify">sample data (with or without replacement) from a joint model</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>print() also applies to objects of class summary.mjoint and bootSE inheriting from the summary() and bootSE() functions, respectively</p><p><sup>b</sup>plot() also accepts objects of class ranef.mjoint inheriting from the ranef() function, which displays a caterpillar plot (with 95% prediction intervals) for each random effect</p><p><sup>c</sup>summary() can also take the optional argument of an object of class bootSE inheriting from the function bootSE(), which overrides the approximate SEs and CIs with those from a bootstrap estimation routine</p></table-wrap-foot></table-wrap></p>
      <p>The package also provides several datasets, and a function simData() that allows for simulation of data from joint models with multiple longitudinal outcomes. joineRML can also fit univariate joint models, however in this case we would currently recommend that the R packages joineR [<xref ref-type="bibr" rid="CR29">29</xref>], JM [<xref ref-type="bibr" rid="CR28">28</xref>], or frailtypack [<xref ref-type="bibr" rid="CR38">38</xref>] are used, which are optimized for the univariate case and exploits Gaussian quadrature. In addition, these packages allow for extensions to more complex cases; for example, competing risks [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] and recurrent events [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>Simulation analysis</title>
      <p>A simulation study was conducted assuming two longitudinal outcomes and <italic>n</italic>=200 subjects. Longitudinal data were simulated according to a follow-up schedule of 6 time points (at times 0,1,…,5), with each model including subject-and-outcome-specific random-intercepts and random-slopes: <bold><italic>b</italic></bold><sub><italic>i</italic></sub>=(<italic>b</italic><sub>0<italic>i</italic>1</sub>,<italic>b</italic><sub>1<italic>i</italic>1</sub>,<italic>b</italic><sub>0<italic>i</italic>2</sub>,<italic>b</italic><sub>1<italic>i</italic>2</sub>)<sup>⊤</sup>, Correlation was induced between the 2 outcomes by assuming correlation of − 0.5 between the random intercepts for each outcome. Event times were simulated from a Gompertz distribution with shape <italic>θ</italic><sub>1</sub>=−3.5 and scale exp(<italic>θ</italic><sub>0</sub>)= exp(0.25)≈1.28, following the methodology described by Austin [<xref ref-type="bibr" rid="CR39">39</xref>]. Independent censoring times were drawn from an exponential distribution with rate 0.05. Any subject where the event and censoring time exceeded 5 was administratively censored at the truncation time <italic>C</italic>=5.1. For all sub-models, we included a pair of covariates <bold><italic>X</italic></bold><sub><italic>i</italic></sub>=(<italic>x</italic><sub><italic>i</italic>1</sub>,<italic>x</italic><sub><italic>i</italic>2</sub>)<sup>⊤</sup>, where <italic>x</italic><sub><italic>i</italic>1</sub> is a continuous covariate independently drawn from <italic>N</italic>(0,1) and <italic>x</italic><sub><italic>i</italic>2</sub> is a binary covariate independently drawn from <italic>B</italic><italic>i</italic><italic>n</italic>(1,0.5). The sub-models are given as 
<disp-formula id="Equl"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} y_{ijk} &amp;=&amp; (\beta_{0, k} + b_{i0k}) + (\beta_{1, k} + b_{i1k}) t_{j} \\&amp;\quad+&amp; \beta_{2, k} x_{i1} + \beta_{3, k} x_{i2} + \varepsilon_{ijk}, \text{ for } k = 1, 2; \\ \lambda_{i}(t) &amp;=&amp; \exp\left\{ (\theta_{0} + \theta_{1} t) + \gamma_{v1} x_{i1} + \gamma_{v2} x_{i2} \right.\\&amp;\quad+&amp;\left. \gamma_{y1} (b_{i01} + b_{i11} t) + \gamma_{y2} (b_{i02} + b_{i12} t) \right\}; \\ {b}_{i} &amp;\sim&amp; N_{4}(0, \boldsymbol{D}); \\ \varepsilon_{ijk} &amp;\sim&amp; N(0, \sigma_{k}^{2}), \end{array} $$ \end{document}</tex-math><mml:math id="M136"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>;</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>exp</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>02</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>;</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>D</italic> is specified unstructured (4×4)-covariance matrix with 10 unique parameters. Simulating datasets is straightforward using the joineRML package by means of the simData() function. The true parameter values and results from 500 simulations are shown in Table <xref rid="Tab3" ref-type="table">3</xref>. In particular, we display the mean estimate, the bias, the empirical SE (= the standard deviation of the the parameter estimates); the mean SE (= the mean SE of each parameter calculated for each fitted model); the mean square error (MSE), and the coverage. The results confirm that the model fitting algorithm generally performs well.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Results of simulation study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Parameter</th><th align="left">True value</th><th align="left">Mean estimated value</th><th align="left">Empirical SE</th><th align="left">Mean SE</th><th align="left">Bias</th><th align="left">MSE</th><th align="left">Coverage</th></tr></thead><tbody><tr><td align="left"><italic>D</italic><sub>11</sub></td><td align="left">0.2500</td><td align="left">0.2411</td><td align="left">0.0435</td><td align="left">—</td><td align="left">−0.0089</td><td align="left">0.0020</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>21</sub></td><td align="left">0.0000</td><td align="left">0.0010</td><td align="left">0.0136</td><td align="left">—</td><td align="left">0.0010</td><td align="left">0.0002</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>31</sub></td><td align="left">−0.1250</td><td align="left">−0.1212</td><td align="left">0.0295</td><td align="left">—</td><td align="left">0.0038</td><td align="left">0.0009</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>41</sub></td><td align="left">0.0000</td><td align="left">−0.0006</td><td align="left">0.0127</td><td align="left">—</td><td align="left">−0.0006</td><td align="left">0.0002</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>22</sub></td><td align="left">0.0400</td><td align="left">0.0396</td><td align="left">0.0072</td><td align="left">—</td><td align="left">−0.0004</td><td align="left">0.0001</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>32</sub></td><td align="left">0.0000</td><td align="left">−0.0002</td><td align="left">0.0138</td><td align="left">—</td><td align="left">−0.0002</td><td align="left">0.0002</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>42</sub></td><td align="left">0.0000</td><td align="left">−0.0001</td><td align="left">0.0055</td><td align="left">—</td><td align="left">−0.0001</td><td align="left">0.0000</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>33</sub></td><td align="left">0.2500</td><td align="left">0.2420</td><td align="left">0.0400</td><td align="left">—</td><td align="left">−0.0080</td><td align="left">0.0017</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>43</sub></td><td align="left">0.0000</td><td align="left">0.0007</td><td align="left">0.0134</td><td align="left">—</td><td align="left">0.0007</td><td align="left">0.0002</td><td align="left">—</td></tr><tr><td align="left"><italic>D</italic><sub>44</sub></td><td align="left">0.0400</td><td align="left">0.0399</td><td align="left">0.0075</td><td align="left">—</td><td align="left">−0.0001</td><td align="left">0.0001</td><td align="left">—</td></tr><tr><td align="left"><italic>β</italic><sub>0,1</sub></td><td align="left">0.0000</td><td align="left">0.0028</td><td align="left">0.0612</td><td align="left">0.0660</td><td align="left">0.0028</td><td align="left">0.0038</td><td align="left">0.9660</td></tr><tr><td align="left"><italic>β</italic><sub>1,1</sub></td><td align="left">1.0000</td><td align="left">1.0012</td><td align="left">0.0218</td><td align="left">0.0229</td><td align="left">0.0012</td><td align="left">0.0005</td><td align="left">0.9500</td></tr><tr><td align="left"><italic>β</italic><sub>2,1</sub></td><td align="left">1.0000</td><td align="left">1.0010</td><td align="left">0.0449</td><td align="left">0.0470</td><td align="left">0.0010</td><td align="left">0.0020</td><td align="left">0.9540</td></tr><tr><td align="left"><italic>β</italic><sub>3,1</sub></td><td align="left">1.0000</td><td align="left">0.9932</td><td align="left">0.0897</td><td align="left">0.0925</td><td align="left">−0.0068</td><td align="left">0.0081</td><td align="left">0.9440</td></tr><tr><td align="left"><inline-formula id="IEq48"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{1}^{2}$\end{document}</tex-math><mml:math id="M138"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq48.gif"/></alternatives></inline-formula></td><td align="left">0.2500</td><td align="left">0.2506</td><td align="left">0.0165</td><td align="left">0.0171</td><td align="left">0.0006</td><td align="left">0.0003</td><td align="left">0.9560</td></tr><tr><td align="left"><italic>β</italic><sub>0,2</sub></td><td align="left">0.0000</td><td align="left">−0.0026</td><td align="left">0.0637</td><td align="left">0.0655</td><td align="left">−0.0026</td><td align="left">0.0041</td><td align="left">0.9660</td></tr><tr><td align="left"><italic>β</italic><sub>1,2</sub></td><td align="left">−1.0000</td><td align="left">−1.0011</td><td align="left">0.0229</td><td align="left">0.0223</td><td align="left">−0.0011</td><td align="left">0.0005</td><td align="left">0.9480</td></tr><tr><td align="left"><italic>β</italic><sub>2,2</sub></td><td align="left">0.0000</td><td align="left">0.0008</td><td align="left">0.0399</td><td align="left">0.0472</td><td align="left">0.0008</td><td align="left">0.0016</td><td align="left">0.9700</td></tr><tr><td align="left"><italic>β</italic><sub>3,2</sub></td><td align="left">0.5000</td><td align="left">0.5061</td><td align="left">0.0894</td><td align="left">0.0923</td><td align="left">0.0061</td><td align="left">0.0080</td><td align="left">0.9540</td></tr><tr><td align="left"><inline-formula id="IEq49"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{2}^{2}$\end{document}</tex-math><mml:math id="M140"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq49.gif"/></alternatives></inline-formula></td><td align="left">0.2500</td><td align="left">0.2501</td><td align="left">0.0162</td><td align="left">0.0171</td><td align="left">0.0001</td><td align="left">0.0003</td><td align="left">0.9540</td></tr><tr><td align="left"><italic>γ</italic><sub><italic>v</italic>1</sub></td><td align="left">0.0000</td><td align="left">0.0011</td><td align="left">0.1243</td><td align="left">0.1392</td><td align="left">0.0011</td><td align="left">0.0155</td><td align="left">0.9720</td></tr><tr><td align="left"><italic>γ</italic><sub><italic>v</italic>2</sub></td><td align="left">1.0000</td><td align="left">1.0487</td><td align="left">0.2837</td><td align="left">0.2750</td><td align="left">0.0487</td><td align="left">0.0829</td><td align="left">0.9340</td></tr><tr><td align="left"><italic>γ</italic><sub><italic>y</italic>1</sub></td><td align="left">−0.5000</td><td align="left">−0.5121</td><td align="left">0.1936</td><td align="left">0.2084</td><td align="left">−0.0121</td><td align="left">0.0376</td><td align="left">0.9560</td></tr><tr><td align="left"><italic>γ</italic><sub><italic>y</italic>2</sub></td><td align="left">1.0000</td><td align="left">1.0311</td><td align="left">0.2220</td><td align="left">0.2145</td><td align="left">0.0311</td><td align="left">0.0502</td><td align="left">0.9400</td></tr></tbody></table></table-wrap></p>
      <p>A second simulation analysis was conducted using the parameters above (with <italic>n</italic>=100 subjects per dataset). However, in this case we used a heavier-tailed distribution for the random effects: a multivariate <italic>t</italic><sub>5</sub> distribution [<xref ref-type="bibr" rid="CR40">40</xref>]. The bias for the fixed effect coefficients was comparable to the multivariate normal random effects simulation study (above). The empirical standard error was consistently smaller than the mean standard error, resulting in coverage between 95% and 99% for the coefficient parameters. Rizopoulos et al. [<xref ref-type="bibr" rid="CR41">41</xref>] noted that the misspecification of the random effects distributions was minimised as the number of longitudinal measurements per subject increased, but that the standard errors are generally affected. These findings are broadly in agreement with the simulation study conducted here, and other studies [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. Choi et al. [<xref ref-type="bibr" rid="CR44">44</xref>] provide a review of existing research on the misspecification of random effects in joint modelling.</p>
    </sec>
    <sec id="Sec13">
      <title>Example</title>
      <p>We consider the primary biliary cirrhosis (PBC) data collected at the Mayo Clinic between 1974 to 1984 [<xref ref-type="bibr" rid="CR45">45</xref>]. This dataset has been widely analyzed using joint modelling methods [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. PBC is a long-term liver disease in which the bile ducts in the liver become damaged. Progressively, this leads to a build-up of bile in the liver, which can damage it and eventually lead to cirrhosis. If PBC is not treated or reaches an advanced stage, it can lead to several major complications, including mortality. In this study, 312 patients were randomised to receive D-penicillamine (<italic>n</italic>=158) or placebo (<italic>n</italic>=154). In this example we analyse the subset of patients randomized to placebo.</p>
      <p>Patients with PBC typically have abnormalities in several blood tests; hence, during follow-up several biomarkers associated with liver function were serially recorded for these patients. We consider three biomarkers: serum bilirunbin (denoted serBilir in the model and data; measured in units of mg/dl), serum albumin (albumin; mg/dl), and prothrombin time (prothrombin; seconds). Patients had a mean 6.3 (SD = 3.7) visits (including baseline). The data can be accessed from the joineRML package via the command data(pbc2). Profile plots for each biomarker are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, indicating distinct differences in trajectories between the those who died during follow-up and those who did not (right-censored cases). A Kaplan-Meier curve for overall survival is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. There were a total of 69 (44.8%) deaths during follow-up in the placebo subset.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Longitudinal trajectory plots. The black lines show individual subject trajectories, and the coloured lines show smoothed (LOESS) curves stratified by whether the patient experienced the endpoint (blue) or not (red)</p></caption><graphic xlink:href="12874_2018_502_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Kaplan-Meier curve for overall survival. A pointwise 95% band is shown (dashed lines). In total, 69 patients (of 154) died during follow-up</p></caption><graphic xlink:href="12874_2018_502_Fig2_HTML" id="MO2"/></fig></p>
      <p>We fit a relatively simple joint model for the purposes of demonstration, which encompasses the following trivariate longitudinal data sub-model: 
<disp-formula id="Equm"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} {{}\selectfont{\begin{aligned} \log(\texttt{serBilir}) &amp;\,=\, (\beta_{0, 1} \,+\, b_{0i, 1}) \,+\, (\beta_{1,1} \,+\, b_{1i, 1}) \texttt{year} \,+\, \varepsilon_{ij1}, \\ \texttt{albumin} &amp;\,=\, (\beta_{0, 2} \,+\, b_{0i, 2}) \,+\, (\beta_{1,2}\! + \!b_{1i, 2}) \texttt{year} \,+\, \varepsilon_{ij2}, \\ (0.1 \times \texttt{prothrombin})^{-4} &amp;\,=\, (\beta_{0, 3} \,+\, b_{0i, 3}) \,+\, (\beta_{1,3} \,+\, b_{1i, 3}) \texttt{year} \,+\, \varepsilon_{ij3}, \\ \boldsymbol{b}_{i} &amp;\!\sim\! N_{6} (0, \boldsymbol{D}), \text{ and } \varepsilon_{ijk} \!\sim\! N(0, \sigma_{k}^{2}) \text{ for } k\,=\,1, \!2,\! 3; \end{aligned}}} \end{array} $$ \end{document}</tex-math><mml:math id="M142"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mtext mathvariant="monospace">serBilir</mml:mtext><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mtext mathvariant="monospace">year</mml:mtext><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="monospace">albumin</mml:mtext></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mtext mathvariant="monospace">year</mml:mtext><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>×</mml:mo><mml:mtext mathvariant="monospace">prothrombin</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mtext mathvariant="monospace">year</mml:mtext><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>and</mml:mtext><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mtext>for</mml:mtext><mml:mi>k</mml:mi><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mn>3</mml:mn><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and a time-to-event sub-model for the study endpoint of death: 
<disp-formula id="Equn"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \lambda_{i}(t) &amp;=&amp; \lambda_{0}(t) \exp \left\{\gamma_{v} \texttt{age}_{i} + W_{2i}(t) \right\}, \\ W_{2i}(t) &amp;=&amp; \gamma_{\texttt{bil}}(b_{0i, 1} + b_{1i, 1} t) + \gamma_{\texttt{alb}}(b_{0i, 2} + b_{1i, 2} t) \\ &amp;\quad+&amp; \gamma_{\texttt{pro}}(b_{0i, 3} + b_{1i, 3} t). \end{array} $$ \end{document}</tex-math><mml:math id="M144"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mtext mathvariant="monospace">age</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="monospace">bil</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="monospace">alb</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"><mml:mspace width="1em"/><mml:mo>+</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="monospace">pro</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2018_502_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The log transformation of bilirubin is standard, and confirmed reasonable based on inspection of Q-Q plots for residuals from a separate fitted linear mixed model fitted using the lme() function from the R package nlme. Albumin did not require transformation. Residuals were grossly non-normal for prothrombin time using both untransformed and log-transformed outcomes. Therefore, a Box-Cox transformation was applied, which suggested an inverse-quartic transform might be suitable, which was confirmed by inspection of a Q-Q plot. The pairwise correlations for baseline measurements between the three transformed markers were 0.19 (prothrombin time <italic>vs.</italic> albumin), − 0.30 (bilirubin <italic>vs.</italic> prothrombin time and albumin). The model is fit using the joineRML R package (version 0.2.0) using the following code.</p>
      <p>
        <graphic position="anchor" xlink:href="12874_2018_502_Figa_HTML" id="MO3"/>
      </p>
      <p>Here, we have specified a more stringent tolerance value for <italic>ε</italic><sub>0</sub> than the default setting in mjoint(). Additionally, the burn-in phase was increased to 400 iterations after inspection of convergence trace plots. The model fits in 3.1 min on a MacBook Air 1.6GHz Intel Core i5 with 8GB or RAM running R version 3.3.0, having completed 423 MCEM iterations (not including the EM algorithm iterations performed for determining the initial values of the separate multivariate linear mixed sub-model) with a final MC size of <italic>M</italic>=3528. The fitted model results are shown in Table <xref rid="Tab4" ref-type="table">4</xref>.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Fitted multivariate and separate univariate joint models to the PBC data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">joineRML (NR)</th><th align="left" colspan="3">joineRML (GN)</th><th align="left" colspan="2">Bootstrap</th><th align="left" colspan="3">
joineR
</th></tr><tr><th align="left"/><th align="left">Estimate</th><th align="left">SE</th><th align="left">95% CI<sup>d</sup></th><th align="left">Estimate</th><th align="left">SE</th><th align="left">95% CI<sup>d</sup></th><th align="left">SE</th><th align="left">95% CI<sup>e</sup></th><th align="left">Estimate</th><th align="left">SE</th><th align="left">95% CI<sup>e</sup></th></tr></thead><tbody><tr><td align="left"><italic>β</italic><sub>0,1</sub></td><td align="left">0.5541</td><td align="left">0.0858</td><td align="left">(0.3859, 0.7223)</td><td align="left">0.5549</td><td align="left">0.0846</td><td align="left">(0.3892, 0.7207)</td><td align="left">0.0800</td><td align="left">(0.4264, 0.7435)</td><td align="left">0.5545</td><td align="left">0.0838</td><td align="left">(0.3802, 0.7031)</td></tr><tr><td align="left"><italic>β</italic><sub>1,1</sub></td><td align="left">0.2009</td><td align="left">0.0201</td><td align="left">(0.1616, 0.2402)</td><td align="left">0.2008</td><td align="left">0.0201</td><td align="left">(0.1614, 0.2402)</td><td align="left">0.0204</td><td align="left">(0.1669, 0.2468)</td><td align="left">0.1808</td><td align="left">0.0209</td><td align="left">(0.1430, 0.2324)</td></tr><tr><td align="left"><italic>β</italic><sub>0,2</sub></td><td align="left">3.5549</td><td align="left">0.0356</td><td align="left">(3.4850, 3.6248)</td><td align="left">3.5546</td><td align="left">0.0357</td><td align="left">(3.4846, 3.6245)</td><td align="left">0.0255</td><td align="left">(3.4972, 3.5904)</td><td align="left">3.5437</td><td align="left">0.0333</td><td align="left">(3.4418, 3.6095)</td></tr><tr><td align="left"><italic>β</italic><sub>1,2</sub></td><td align="left">−0.1245</td><td align="left">0.0101</td><td align="left">(−0.1444, −0.1047)</td><td align="left">−0.1246</td><td align="left">0.0101</td><td align="left">(−0.1444, −0.1047)</td><td align="left">0.0120</td><td align="left">(−0.1489, −0.1063)</td><td align="left">−0.0997</td><td align="left">0.0113</td><td align="left">(−0.1256, −0.0773)</td></tr><tr><td align="left"><italic>β</italic><sub>0,3</sub></td><td align="left">0.8304</td><td align="left">0.0212</td><td align="left">(0.7888, 0.8719)</td><td align="left">0.8301</td><td align="left">0.0210</td><td align="left">(0.7888, 0.8713)</td><td align="left">0.0196</td><td align="left">(0.7953, 0.8638)</td><td align="left">0.8233</td><td align="left">0.0220</td><td align="left">(0.7818, 0.8677)</td></tr><tr><td align="left"><italic>β</italic><sub>1,3</sub></td><td align="left">−0.0577</td><td align="left">0.0062</td><td align="left">(−0.0699, −0.0456)</td><td align="left">−0.0577</td><td align="left">0.0062</td><td align="left">(−0.0698, −0.0455)</td><td align="left">0.0057</td><td align="left">(−0.0698, −0.0486)</td><td align="left">−0.0447</td><td align="left">0.0052</td><td align="left">(−0.0555, −0.0362)</td></tr><tr><td align="left"><italic>γ</italic><sub><italic>v</italic></sub></td><td align="left">0.0462</td><td align="left">0.0151</td><td align="left">(0.0166, 0.0759)</td><td align="left">0.0462</td><td align="left">0.0152</td><td align="left">(0.0165, 0.0759)</td><td align="left">0.0173</td><td align="left">(0.0198, 0.0880)</td><td align="left">0.0575<sup>a</sup></td><td align="left">0.0123<sup>a</sup></td><td align="left">(0.0314, 0.0760)<sup>a</sup></td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.0413<sup>b</sup></td><td align="left">0.0150<sup>b</sup></td><td align="left">(0.0113, 0.0714)<sup>b</sup></td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">0.0424<sup>c</sup></td><td align="left">0.0157<sup>c</sup></td><td align="left">(0.0146, 0.0724)<sup>c</sup></td></tr><tr><td align="left"><italic>γ</italic><sub>bil</sub></td><td align="left">0.8181</td><td align="left">0.2046</td><td align="left">(0.4171, 1.2191)</td><td align="left">0.8187</td><td align="left">0.2036</td><td align="left">(0.4197, 1.2177)</td><td align="left">0.2153</td><td align="left">(0.5172, 1.4021)</td><td align="left">1.2182</td><td align="left">0.1654</td><td align="left">(0.9800, 1.5331)</td></tr><tr><td align="left"><italic>γ</italic><sub>alb</sub></td><td align="left">−1.7060</td><td align="left">0.6181</td><td align="left">(−2.9173, −0.4946)</td><td align="left">−1.6973</td><td align="left">0.6163</td><td align="left">(−2.9053, −0.4893)</td><td align="left">0.7562</td><td align="left">(−3.3862, −0.5188)</td><td align="left">−3.0770</td><td align="left">0.6052</td><td align="left">(−4.7133, −2.1987)</td></tr><tr><td align="left"><italic>γ</italic><sub>pro</sub></td><td align="left">−2.2085</td><td align="left">1.6070</td><td align="left">(−5.3582, 0.9412)</td><td align="left">−2.2148</td><td align="left">1.6133</td><td align="left">(−5.3768, 0.9472)</td><td align="left">1.6094</td><td align="left">(−5.3050, 0.6723)</td><td align="left">−7.2078</td><td align="left">1.2640</td><td align="left">(−10.5247, −5.2616)</td></tr></tbody></table><table-wrap-foot><p>Notation: SE = standard error; CI = confidence interval; NR = one-step Newton-Raphson update for <bold><italic>γ</italic></bold>; GN = one-step Gauss-Newton-like update for <bold><italic>γ</italic></bold></p><p><sup>a</sup>Separate model fit for serBilir</p><p><sup>b</sup>Separate model fit for albumin</p><p><sup>c</sup>Separate model fit for prothrombin</p><p><sup>d</sup>SEs are calculated from the inverse profile empirical information matrix, and confidence intervals are based on normal approximations of the type <inline-formula id="IEq50"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\theta }} \pm 1.96 \text {SE}(\hat {\boldsymbol {\theta }})$\end{document}</tex-math><mml:math id="M146"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>±</mml:mo><mml:mn>1.96</mml:mn><mml:mtext>SE</mml:mtext><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq50.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq51"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\theta }}$\end{document}</tex-math><mml:math id="M148"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq51.gif"/></alternatives></inline-formula> denote the estimated maximum likelihood estimates</p><p><sup>e</sup>SEs and confidence intervals are derived from <italic>B</italic>=100 bootstrap samples, with confidence intervals based on the 2.5<italic>%</italic> and 97.5<italic>%</italic> percentiles. NB. one model failed to converge using joineRML within the maximum number of MC iterations, and so SEs and CIs are based on 99 bootstrap samples only</p></table-wrap-foot></table-wrap></p>
      <p>The fitted model indicated that an increase in the subject-specific random deviation from the population trajectory of serum bilirubin was significantly associated with increased hazard of death. A significant association was also detected for subject-specific decreases in albumin from the population mean trajectory. However, prothrombin time was not significantly associated with hazard of death, although its direction is clinically consistent with PBC disease. Albert and Shih [<xref ref-type="bibr" rid="CR46">46</xref>] analysed the first 4-years follow-up from this dataset with the same 3 biomarkers and a discrete event time distribution using a regression calibration model. Their results were broadly consistent, although the effect of prothrombin time on the event time sub-model was strongly significant.</p>
      <p>We also fitted 3 univariate joint models to each of the biomarkers and the event time sub-model using the R package joineR (version 1.2.0) owing to its optimization for such models. The LMM parameter estimates were similar, although the absolute magnitude of the slopes was smaller for the separate univariate models. Since 3 separate models were fitted, 3 estimates of <italic>γ</italic><sub><italic>v</italic></sub> were estimated, with the average comparable to the multivariate model estimate. The multivariate model estimates of <bold><italic>γ</italic></bold><sub><italic>y</italic></sub>=(<italic>γ</italic><sub>bil</sub>,<italic>γ</italic><sub>alb</sub>,<italic>γ</italic><sub>pro</sub>)<sup>⊤</sup> were substantially attenuated relative to the separate model estimates, although the directions remained consistent. It is also interesting to note that <italic>γ</italic><sub>pro</sub> was statistically significant in the univariate model. However, the univariate models are not accounting for the correlation between different outcomes, whereas the multivariate joint model does.</p>
      <p>The model was refitted with the one-step Newton-Raphson update for <italic>γ</italic> replaced by a Gauss-Newton-like update in a time of 2.2 minutes for 419 MCEM iterations with a final MC size of <italic>M</italic>=6272. This is easily achieved by running the following code.</p>
      <p>
        <graphic position="anchor" xlink:href="12874_2018_502_Figb_HTML" id="MO4"/>
      </p>
      <p>In addition, we bootstrapped this model with <italic>B</italic>=100 samples to estimate SEs and contrast them with the approximate estimates based on the inverse empirical profile information matrix. In practice, one should choose <italic>B</italic>&gt;100, particularly if using bootstrap percentile confidence intervals; however, we used a small value to reduce the computational burden on this process. In a similar spirit, we relaxed the convergence criteria and reduced the number of burn-in iterations. This is easily implemented by running the following code, taking 1.8 h to fit.</p>
      <p>
        <graphic position="anchor" xlink:href="12874_2018_502_Figc_HTML" id="MO5"/>
      </p>
      <p>It was observed that the choice of gradient matrix in the <italic>γ</italic>-update led to virtually indistinguishable parameter estimates, although we note the same random seed was used in both cases. The bootstrap estimated SEs were broadly consistent with the approximate SEs, with no consistent pattern in underestimation observed.</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="discussion">
    <title>Discussion</title>
    <p>Multivariate joint models introduce three types of correlations: (1) within-subject serial correlation for repeated measures; (2) between longitudinal outcomes correlation; and (3) correlation between the multivariate LMM and time-to-event sub-models. It is important to account for all of these types of correlations; however, some authors have reported collapsing their multivariate data to permit univariate joint models to be fitted. For example, Battes et al. [<xref ref-type="bibr" rid="CR7">7</xref>] used an ad hoc approach of either summing or multiplying the three repeated continuous measures (standardized according to clinical upper reference limits of the biomarker assays), and then applying standard univariate joint models. Wang et al. [<xref ref-type="bibr" rid="CR48">48</xref>] fitted separate univariate joint models to each longitudinal outcome in turn. Neither approach takes complete advantage of the correlation between the multiple longitudinal measures and the time-to-event outcome.</p>
    <p>Here, we described a new R package joineRML that can fit the models described in this paper. This was demonstrated on a real-world dataset. Although in the fitted model we assumed linear trajectories for the biomarkers, splines could be straightforwardly employed, as have been used in other multivariate joint model applications [<xref ref-type="bibr" rid="CR15">15</xref>], albeit at the cost of additional computational time. Despite a growing availability of software for univariate joint models, Hickey et al. [<xref ref-type="bibr" rid="CR19">19</xref>] noted that there were very few options for fitting joint models involving multivariate longitudinal data. To the best of our knowledge, options are limited to the R packages JMbayes [<xref ref-type="bibr" rid="CR49">49</xref>], rstanarm [<xref ref-type="bibr" rid="CR50">50</xref>], and the Stata package stjm [<xref ref-type="bibr" rid="CR47">47</xref>]. Moreover, none of these incorporates an unspecified baseline hazard. The first two packages use Markov chain Monte Carlo (MCMC) methods to fit the joint models. Bayesian models are potentially very useful for fitting joint models, and in particular for dynamic prediction; however, MCMC is also computationally demanding, especially in the case of multivariate models. Several other publications have made BUGS code available for use with WinBUGS and OpenBUGS (e.g. [<xref ref-type="bibr" rid="CR51">51</xref>]), but these are not easily modifiable and post-fit computations are cumbersome.</p>
    <p>joineRML is a new software package developed to fill a void in the joint modelling field, but is still in its infancy relative to highly developed univariate joint model packages such as the R package JM [<xref ref-type="bibr" rid="CR28">28</xref>] and Stata package stjm [<xref ref-type="bibr" rid="CR47">47</xref>]. Future developments of joineRML intend to cover several deficiencies. First, joineRML currently only permits an association structure of the form <inline-formula id="IEq52"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{2i}(t) = \sum _{k=1}^{K} \gamma _{yk} W_{1i}^{(k)}(t)$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">yk</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12874_2018_502_Article_IEq52.gif"/></alternatives></inline-formula>. As has been demonstrated by others, the association might take different forms, including random-slopes and cumulative effects or some combination of multiple structures, and these may also be different for separate longitudinal outcomes [<xref ref-type="bibr" rid="CR18">18</xref>]. Moreover, it is conceivable that separate longitudinal outcomes may interact in the hazard sub-model. Second, the use of MC integration provides a scalable solution to the issue of increasing dimensionality in the random effects. However, for simpler cases, e.g. bivariate models with random-intercepts and random-slopes (total of 4 random effects), Gaussian quadrature might be computationally superior; this trade-off requires further investigation. Third, joineRML can currently only model a single event time. However, there is a growing interest in competing risks [<xref ref-type="bibr" rid="CR9">9</xref>] and recurrent events data [<xref ref-type="bibr" rid="CR11">11</xref>], which if incorporated into joineRML, would provide a flexible all-round multivariate joint modelling platform. Competing risks [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] and recurrent events [<xref ref-type="bibr" rid="CR38">38</xref>] have been incorporated into joint modelling R packages already, but are limited to the case of a solitary longitudinal outcome. Of note, the PBC trial dataset analysed in this study includes times to the competing risk of liver transplantation. Fourth, with ever-increasing volumes of data collected during routine clinical visits, the need for software to fit joint models with very many longitudinal outcomes is foreseeable [<xref ref-type="bibr" rid="CR52">52</xref>]. This would likely require the use of approximate methods for the numerical integration or data reduction methods. Fifth, additional residual diagnostics are necessary for assessing possible violations of model assumptions. The joineRML package has a resid() function for extracting the longitudinal sub-model residuals; however, these are complex for diagnostic purposes due to the informative dropout, hence the development of multiple-imputation based residuals [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
  </sec>
  <sec id="Sec15" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this paper we have presented an extension of the classical joint model proposed by Henderson et al. [<xref ref-type="bibr" rid="CR3">3</xref>] and an estimation procedure for fitting the models that builds on the foundations laid by Lin et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. In addition, we described a new R package joineRML that can fit the models described in this paper, which leverages the MCEM algorithm and which should scale well for increasing number of longitudinal outcomes. This software is timely, as it has previously been highlighted that there is a paucity of software available to fit such models [<xref ref-type="bibr" rid="CR19">19</xref>]. The software is being regularly updated and improved.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold>joineRML<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/graemeleehickey/joineRML/">https://github.com/graemeleehickey/joineRML/</ext-link><bold>Operating system(s):</bold> platform independent <bold>Programming language:</bold> R <bold>Other requirements:</bold> none <bold>License:</bold> GNU GPL-3 Any restrictions to use by non-academics: none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12874_2018_502_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>An appendix (appendix.pdf) is available that includes details on the score vector and M-step estimators. (PDF 220 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BLUP</term>
        <def>
          <p>Best linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>CRAN</term>
        <def>
          <p>The Comprehensive R Archive Network</p>
        </def>
      </def-item>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation maximisation</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p>Linear mixed models</p>
        </def>
      </def-item>
      <def-item>
        <term>MC</term>
        <def>
          <p>Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>MCEM</term>
        <def>
          <p>Monte Carlo expectation maximisation</p>
        </def>
      </def-item>
      <def-item>
        <term>MLE</term>
        <def>
          <p>Maximum likelihood estimate</p>
        </def>
      </def-item>
      <def-item>
        <term>PBC</term>
        <def>
          <p>Primary biliary cirrhosis</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p>Standard deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p>Standard error</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s12874-018-0502-1) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Professor Robin Henderson (University of Newcastle) for useful discussions with regards to the MCEM algorithm, and Dr Haiqun Lin (Yale University) for helpful discussions on the likelihood specification.</p>
    <sec id="d29e9524">
      <title>Funding</title>
      <p>Funding for the project was provided by the Medical Research Council (Grant number MR/M013227/1). The funder had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
    </sec>
    <sec id="d29e9529">
      <title>Availability of data and materials</title>
      <p>The R package joineRML can be installed directly using install.packages(~joineRML~) in an R console. The source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/graemeleehickey/joineRML">https://github.com/graemeleehickey/joineRML</ext-link>. Archived versions are available from the Comprehensive R Archive Network (CRAN) at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/joineRML/">https://cran.r-project.org/web/packages/joineRML/</ext-link>. joineRML is platform independent, requiring R version ≥ 3.3.0, and is published under a GNU GPL-3 license. The dataset analysed during the current study is bundled with the R package joineRML, and can be accessed by running the command data(pbc2, package = ~joineRML~).</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>All authors collaborated in developing the model fitting algorithm reported. The programming and running of the analysis was carried out by GLH. GLH wrote the first draft of the manuscript, with input provided by PP, AJ, and RKD. All authors contributed to the manuscript revisions. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e9566">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e9571">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e9576">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ibrahim</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Basic concepts and methods for joint models of longitudinal and survival data</article-title>
        <source>J Clin Oncol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>16</issue>
        <fpage>2796</fpage>
        <lpage>801</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2009.25.0654</pub-id>
        <?supplied-pmid 20439643?>
        <pub-id pub-id-type="pmid">20439643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweeting</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>Joint modelling of longitudinal and time-to-event data with application to predicting abdominal aortic aneurysm growth and rupture</article-title>
        <source>Biom J</source>
        <year>2011</year>
        <volume>53</volume>
        <issue>5</issue>
        <fpage>750</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1002/bimj.201100052</pub-id>
        <?supplied-pmid 21834127?>
        <pub-id pub-id-type="pmid">21834127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henderson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Diggle</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dobson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Joint modelling of longitudinal measurements and event time data</article-title>
        <source>Biostatistics</source>
        <year>2000</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>465</fpage>
        <lpage>480</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/1.4.465</pub-id>
        <?supplied-pmid 12933568?>
        <pub-id pub-id-type="pmid">12933568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsiatis</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Davidian</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of longitudinal and time-to-event data: an overview</article-title>
        <source>Stat Sin</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>809</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gould</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Boye</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Crowther</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Quartey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Micallef</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bois</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of survival and longitudinal non-survival data: current methods and issues. report of the DIA Bayesian joint modeling working group</article-title>
        <source>Stat Med</source>
        <year>2015</year>
        <volume>34</volume>
        <fpage>2181</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.6141</pub-id>
        <pub-id pub-id-type="pmid">24634327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Joint Models for Longitudinal and Time-to-Event Data, with Applications in R</source>
        <year>2012</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Battes</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Caliskan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Constantinescu</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Robertus</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Akkerhuis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Manintveld</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Boersma</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kardys</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Repeated measurements of NT-pro-B-type natriuretic peptide, troponin T or C-reactive protein do not predict future allograft rejection in heart transplant recipients</article-title>
        <source>Transplantation</source>
        <year>2015</year>
        <volume>99</volume>
        <issue>3</issue>
        <fpage>580</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1097/TP.0000000000000378</pub-id>
        <?supplied-pmid 25136844?>
        <pub-id pub-id-type="pmid">25136844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Davidian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsiatis</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>An estimator for the proportional hazards model with multiple longitudinal covariates measured with error</article-title>
        <source>Biostatistics</source>
        <year>2002</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>511</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/3.4.511</pub-id>
        <?supplied-pmid 12933595?>
        <pub-id pub-id-type="pmid">12933595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williamson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kolamunnage-Dona</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Philipson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marson</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>Joint modelling of longitudinal and competing risks data</article-title>
        <source>Stat Med</source>
        <year>2008</year>
        <volume>27</volume>
        <fpage>6426</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.3451</pub-id>
        <?supplied-pmid 18825652?>
        <pub-id pub-id-type="pmid">18825652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">Hickey GL, Philipson P, Jorgensen A, Kolamunnage-Dona R. A comparison of joint models for longitudinal and competing risks data, with application to an epilepsy drug randomized controlled trial. J R Stat Soc: Ser A: Stat Soc. 2018. 10.1111/rssa.12348.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Joint analysis of correlated repeated measures and recurrent events processes in the presence of death, with application to a study on acquired immune deficiency syndrome</article-title>
        <source>J R Stat Soc: Ser C: Appl Stat</source>
        <year>2009</year>
        <volume>58</volume>
        <issue>1</issue>
        <fpage>65</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9876.2008.00641.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chi</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Joint models for multivariate longitudinal and multivariate survival data</article-title>
        <source>Biometrics</source>
        <year>2006</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>432</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2005.00448.x</pub-id>
        <?supplied-pmid 16918907?>
        <pub-id pub-id-type="pmid">16918907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Hickey GL, Philipson P, Jorgensen A, Kolamunnage-Dona R. Joint models of longitudinal and time-to-event data with more than one event time outcome: a review. Int J Biostat. 2018. 10.1515/ijb-2017-0047.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrinopoulou</surname>
            <given-names>E-R</given-names>
          </name>
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Takkenberg</surname>
            <given-names>JJM</given-names>
          </name>
          <name>
            <surname>Lesaffre</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Combined dynamic predictions using joint models of two longitudinal outcomes and competing risk data</article-title>
        <source>Stat Methods Med Res</source>
        <year>2017</year>
        <volume>26</volume>
        <issue>4</issue>
        <fpage>1787</fpage>
        <lpage>1801</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280215588340</pub-id>
        <?supplied-pmid 26059114?>
        <pub-id pub-id-type="pmid">26059114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian semiparametric multivariate joint model for multiple longitudinal outcomes and a time-to-event</article-title>
        <source>Stat Med</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>12</issue>
        <fpage>1366</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.4205</pub-id>
        <?supplied-pmid 21337596?>
        <pub-id pub-id-type="pmid">21337596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faucett</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Simultaneously modelling censored survival data and repeatedly measured covariates: a Gibbs sampling approach</article-title>
        <source>Stat Med</source>
        <year>1996</year>
        <volume>15</volume>
        <issue>15</issue>
        <fpage>1663</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(19960815)15:15&lt;1663::AID-SIM294&gt;3.0.CO;2-1</pub-id>
        <?supplied-pmid 8858789?>
        <pub-id pub-id-type="pmid">8858789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Davidian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsiatis</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>A semiparametric likelihood approach to joint modeling of longitudinal and time-to-event data</article-title>
        <source>Biometrics</source>
        <year>2002</year>
        <volume>58</volume>
        <issue>4</issue>
        <fpage>742</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2002.00742.x</pub-id>
        <?supplied-pmid 12495128?>
        <pub-id pub-id-type="pmid">12495128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrinopoulou</surname>
            <given-names>E-R</given-names>
          </name>
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Bayesian shrinkage approach for a joint model of longitudinal and survival outcomes assuming different association structures</article-title>
        <source>Stat Med</source>
        <year>2016</year>
        <volume>35</volume>
        <issue>26</issue>
        <fpage>4813</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.7027</pub-id>
        <?supplied-pmid 27383428?>
        <pub-id pub-id-type="pmid">27383428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Philipson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jorgensen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolamunnage-Dona</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Joint modelling of time-to-event and multivariate longitudinal outcomes: recent developments and issues</article-title>
        <source>BMC Med Res Methodol</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s12874-016-0212-5</pub-id>
        <pub-id pub-id-type="pmid">26728979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mayne</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation in the joint analysis of time-to-event and multiple longitudinal variables</article-title>
        <source>Stat Med</source>
        <year>2002</year>
        <volume>21</volume>
        <fpage>2369</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.1179</pub-id>
        <?supplied-pmid 12210621?>
        <pub-id pub-id-type="pmid">12210621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Random-effects models for longitudinal data</article-title>
        <source>Biometrics</source>
        <year>1982</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>963</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.2307/2529876</pub-id>
        <?supplied-pmid 7168798?>
        <pub-id pub-id-type="pmid">7168798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Tanner</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>A Monte Carlo implementation of the EM algorithm and the poor man’s data augmentation algorithms</article-title>
        <source>J Am Stat Assoc</source>
        <year>1990</year>
        <volume>85</volume>
        <issue>411</issue>
        <fpage>699</fpage>
        <lpage>704</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1990.10474930</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wulfsohn</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Tsiatis</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>A joint model for survival and longitudinal data measured with error</article-title>
        <source>Biometrics</source>
        <year>1997</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>330</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.2307/2533118</pub-id>
        <?supplied-pmid 9147598?>
        <pub-id pub-id-type="pmid">9147598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ratcliffe</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ten Have</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of longitudinal and survival data via a common frailty</article-title>
        <source>Biometrics</source>
        <year>2004</year>
        <volume>60</volume>
        <issue>4</issue>
        <fpage>892</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2004.00244.x</pub-id>
        <?supplied-pmid 15606409?>
        <pub-id pub-id-type="pmid">15606409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>The EM Algorithm and Extensions, 2nd ed.</source>
        <year>2008</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley-Interscience</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pinheiro</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <source>Mixed-Effects Models in S and S-PLUS</source>
        <year>2000</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Therneau</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grambsch</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <source>Modeling Survival Data: Extending the Cox Model</source>
        <year>2000</year>
        <publisher-loc>New Jersey</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>JM: an R package for the joint modelling of longitudinal and time-to-event data</article-title>
        <source>Journal of Statistical Software</source>
        <year>2010</year>
        <volume>35</volume>
        <issue>9</issue>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v035.i09</pub-id>
        <pub-id pub-id-type="pmid">21603108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Philipson P, Sousa I, Diggle PJ, Williamson P, Kolamunnage-Dona R, Henderson R, Hickey GL. joineR: Joint Modelling of Repeated Measurements and Time-to-event Data. 2017. R package version 1.2.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=joineR">https://CRAN.R-project.org/package=joineR</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dmitrienko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chuang-Stein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Offen</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Analysis of Clinical Trials Using SAS: A Practical Guide.</source>
        <year>2005</year>
        <publisher-loc>Cary</publisher-loc>
        <publisher-name>SAS Institute</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sandler</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The joint modeling of a longitudinal disease progression marker and the failure time process in the presence of cure</article-title>
        <source>Biostatistics</source>
        <year>2002</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>547</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/3.4.547</pub-id>
        <?supplied-pmid 12933597?>
        <pub-id pub-id-type="pmid">12933597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood algorithms for generalized linear mixed models</article-title>
        <source>J Am Stat Assoc</source>
        <year>1997</year>
        <volume>92</volume>
        <issue>437</issue>
        <fpage>162</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1997.10473613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Booth</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hobert</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Maximizing generalized linear mixed model likelihoods with an automated Monte Carlo EM algorithm.</article-title>
        <source>J R Stat Soc Ser B Stat Methodol</source>
        <year>1999</year>
        <volume>61</volume>
        <issue>1</issue>
        <fpage>265</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ripatti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Palmgren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood inference for multivariate frailty models using an automated Monte Carlo EM algorithm</article-title>
        <source>Lifetime Data Anal</source>
        <year>2002</year>
        <volume>8</volume>
        <issue>2002</issue>
        <fpage>349</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1020566821163</pub-id>
        <?supplied-pmid 12471944?>
        <pub-id pub-id-type="pmid">12471944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tseng</surname>
            <given-names>YK</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of survival and longitudinal data: Likelihood approach revisited</article-title>
        <source>Biometrics</source>
        <year>2006</year>
        <volume>62</volume>
        <issue>4</issue>
        <fpage>1037</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2006.00570.x</pub-id>
        <?supplied-pmid 17156277?>
        <pub-id pub-id-type="pmid">17156277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Baines</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Standard error estimation using the EM algorithm for the joint modeling of survival and longitudinal data</article-title>
        <source>Biostatistics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>731</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxu015</pub-id>
        <?supplied-pmid 24771699?>
        <pub-id pub-id-type="pmid">24771699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanderson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>RcppArmadillo: accelerating r with high-performance C++ linear algebra</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2014</year>
        <volume>71</volume>
        <fpage>1054</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2013.02.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Król</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mauguen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mazroui</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michiels</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rondeau</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Tutorial in joint modeling and prediction: A statistical software for correlated longitudinal outcomes, recurrent events and a terminal event</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v081.i03</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Austin</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Generating survival times to simulate Cox proportional hazards models with time-varying covariates</article-title>
        <source>Stat Med</source>
        <year>2012</year>
        <volume>31</volume>
        <issue>29</issue>
        <fpage>3946</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.5452</pub-id>
        <?supplied-pmid 22763916?>
        <pub-id pub-id-type="pmid">22763916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Genz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bretz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Computation of Multivariate Normal and t Probabilities</source>
        <year>2009</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Verbeke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Shared parameter models under random-effects misspecification</article-title>
        <source>Biometrika</source>
        <year>2008</year>
        <volume>95</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asm087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zeger</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>The evaluation of multiple surrogate endpoints</article-title>
        <source>Biometrics</source>
        <year>2001</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>81</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2001.00081.x</pub-id>
        <?supplied-pmid 11252622?>
        <pub-id pub-id-type="pmid">11252622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pantazis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Touloumi</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Robustness of a parametric model for informatively censored bivariate longitudinal data under misspecification of its distributional assumptions: a simulation study</article-title>
        <source>Stat Med</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>5473</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.3147</pub-id>
        <?supplied-pmid 18058854?>
        <pub-id pub-id-type="pmid">18058854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Olshan</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of survival time and longitudinal outcomes with flexible random effects</article-title>
        <source>Lifetime Data Anal</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>126</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1007/s10985-017-9405-4</pub-id>
        <?supplied-pmid 28856493?>
        <pub-id pub-id-type="pmid">28856493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murtaugh</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Dickson</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Van Dam</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Malinchoc</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grambsch</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Langworthy</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gips</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Primary biliary cirrhosis: prediction of short-term survival based on repeated patient visits</article-title>
        <source>Hepatology</source>
        <year>1994</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>126</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1002/hep.1840200120</pub-id>
        <?supplied-pmid 8020881?>
        <pub-id pub-id-type="pmid">8020881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albert</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>An approach for jointly modeling multivariate longitudinal measurements and discrete time-to-event data</article-title>
        <source>Ann Appl Stat</source>
        <year>2010</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>1517</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1214/10-AOAS339</pub-id>
        <?supplied-pmid 21938267?>
        <pub-id pub-id-type="pmid">21938267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowther</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Abrams</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of longitudinal and survival data</article-title>
        <source>Stata J</source>
        <year>2013</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>165</fpage>
        <lpage>84</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Boye</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of longitudinal outcomes and survival using latent growth modeling approach in a mesothelioma trial</article-title>
        <source>Health Serv Outcome Res Methodol</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>2–3</issue>
        <fpage>182</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1007/s10742-012-0092-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The R package JMbayes for fitting joint models for longitudinal and time-to-event data using mcmc</article-title>
        <source>J Stat Softw</source>
        <year>2016</year>
        <volume>72</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v072.i07</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Betancourt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Riddell</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Stan: a probabilistic programming language</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrinopoulou</surname>
            <given-names>E-R</given-names>
          </name>
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Takkenberg</surname>
            <given-names>JJM</given-names>
          </name>
          <name>
            <surname>Lesaffre</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Joint modeling of two longitudinal outcomes and competing risk data</article-title>
        <source>Stat Med</source>
        <year>2014</year>
        <volume>33</volume>
        <issue>18</issue>
        <fpage>3167</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.6158</pub-id>
        <?supplied-pmid 24676841?>
        <pub-id pub-id-type="pmid">24676841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaffa</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Gebregziabher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaffa</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>A joint modeling approach for right censored high dimensiondal multivariate longitudinal data</article-title>
        <source>J Biom Biostat</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>1000203</fpage>
        <pub-id pub-id-type="doi">10.4172/2155-6180.1000203</pub-id>
        <?supplied-pmid 25688330?>
        <pub-id pub-id-type="pmid">25688330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizopoulos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Verbeke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Multiple-imputation-based residuals and diagnostic plots for joint models of longitudinal and survival outcomes</article-title>
        <source>Biometrics</source>
        <year>2010</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>20</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2009.01273.x</pub-id>
        <?supplied-pmid 19459832?>
        <pub-id pub-id-type="pmid">19459832</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
