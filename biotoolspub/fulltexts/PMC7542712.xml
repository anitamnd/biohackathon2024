<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7542712</article-id>
    <article-id pub-id-type="publisher-id">3750</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03750-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><sc>AllCoPol</sc>: inferring allele co-ancestry in polyploids</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lautenschlager</surname>
          <given-names>Ulrich</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wagner</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7134-501X</contrib-id>
        <name>
          <surname>Oberprieler</surname>
          <given-names>Christoph</given-names>
        </name>
        <address>
          <email>christoph.oberprieler@ur.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.7727.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2190 5763</institution-id><institution>Evolutionary and Systematic Botany Group, Institute of Plant Sciences, </institution><institution>University of Regensburg, </institution></institution-wrap>Universitätsstr. 31, 93053 Regensburg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>441</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Inferring phylogenetic relationships of polyploid species and their diploid ancestors (leading to reticulate phylogenies in the case of an allopolyploid origin) based on multi-locus sequence data is complicated by the unknown assignment of alleles found in polyploids to diploid subgenomes. A parsimony-based approach to this problem has been proposed by Oberprieler et al. (Methods Ecol Evol 8:835–849, 2017), however, its implementation is of limited practical value. In addition to previously identified shortcomings, it has been found that in some cases, the obtained results barely satisfy the applied criterion. To be of better use to other researchers, a reimplementation with methodological refinement appears to be indispensable.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present the AllCoPol package, which provides a heuristic method for assigning alleles from polyploids to diploid subgenomes based on the Minimizing Deep Coalescences (MDC) criterion in multi-locus sequence datasets. An additional consensus approach further allows to assess the confidence of phylogenetic reconstructions. Simulations of tetra- and hexaploids show that under simplifying assumptions such as completely disomic inheritance, the topological errors of reconstructed phylogenies are similar to those of MDC species trees based on the true allele partition.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">AllCoPol is a Python package for phylogenetic reconstructions of polyploids offering enhanced functionality as well as improved usability. The included methods are supplied as command line tools without the need for prior programming knowledge.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Coalescent theory</kwd>
      <kwd>Gene tree</kwd>
      <kwd>Multilocus sequence data</kwd>
      <kwd>Polyploidy</kwd>
      <kwd>Python</kwd>
      <kwd>Reticulate evolution</kwd>
      <kwd>Simulations</kwd>
      <kwd>Species tree</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>OB 155/13-1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Oberprieler</surname>
            <given-names>Christoph</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Due to the paramount importance of polyploid speciation in plant evolution and the advent of large-scale sequencing technologies (‘next-generation sequencing’) in phylogenetics, there is a growing need for bioinformatics methods that allow the objective reconstruction of reticulate phylogenies caused by allopolyploidy (see [<xref ref-type="bibr" rid="CR10">10</xref>]). One possible approach suggested by the present workgroup is to explicitly assign sampled alleles of a polyploid taxon to different diploid subgenomes in order to enable species-tree reconstructions or further downstream analyses [<xref ref-type="bibr" rid="CR8">8</xref>]. It makes use of a parsimony-based principle in species-tree reconstruction (minimizing deep coalescences, MDC, [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]). However, technical shortcomings such as the lack of a complete implementation and its dependence on commercial software hindered the broader application of this method. While its applicability for relatively small data sets has been demonstrated, only poor parsimony scores—sometimes at the level of random solutions—were observed when applied in more challenging cases. This can be explained by its limited optimization strategy, which is ignorant about the interplay of independently calculated partial solutions. For this reason, the AllCoPol package implements a different heuristic approach based on the tabu-search metaheuristic [<xref ref-type="bibr" rid="CR2">2</xref>] while following the same criterion. The occasional lack of reproducibility caused by the stochasticity of our heuristic further motivated the development of a novel method for calculating consensus results. Other enhancements over the original pipeline include the possibility to address gene tree uncertainty, independence from commercial software, and a more user-friendly interface. AllCoPol as well as the analysis pipeline suggested by Oberprieler et al. [<xref ref-type="bibr" rid="CR8">8</xref>] uses PhyloNet [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], an actively developed collection of phylogenetic analysis tools, to compute MDC-based species trees. Newer methods implemented in PhyloNet allow to directly infer species networks with a predefined maximum number of reticulations. As proposed by Cao et al. [<xref ref-type="bibr" rid="CR1">1</xref>], such methods, which can be constrained to consider polyploids as hybridogenic, could be used for the analysis of polyploids. Therefore, AllCoPol is compared with similar analyses using MDC-based species network reconstruction in PhyloNet.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par8">The Python package AllCoPol provides a collection of command line tools. Their usage and a complete list of available options can be displayed using the command line options –help or -h. For application examples along with further guidelines, the reader is referred to the README file.</p>
    </sec>
    <sec id="Sec3">
      <title>Reconstruction of subgenome memberships</title>
      <p id="Par9">The main problem AllCoPol aims to solve is to partition a set of alleles from a <italic>n</italic>-ploid taxon, considering all sampled individuals and loci, into at most <italic>n</italic>/2 subsets representing its hypothetical diploid subgenomes. In doing so, we seek to minimize the number of extra lineages in the resulting MDC species tree. Assuming single-copy loci, for each polyploid individual, at most two alleles per locus may be assigned to the same subgenome. Solutions to the described problem are approximated using the command allcopol, whose options can be specified via command line arguments or within a configuration file. Optimization is done by a simple tabu-search algorithm. Despite its similarity to hillclimbing, the former, when properly parameterized, is able to escape from local optima. Its characteristic feature is a so-called tabu-list, which discourages certain moves in the search space for a specified number of iterations (tabu tenure), aiming to avoid cyclic trajectories.</p>
      <p id="Par10">The analysis requires two input files, one for precomputed gene trees and another one specifying allele names, taxon membership, and ploidy level for each accession (individual) under study. Each taxon may be represented by multiple accessions, each of which may comprise multiple alleles per locus. The calculation of MDC species trees along with their number of extra lineages (i.e., the evaluation of the objective function) is carried out in PhyloNet (in the following, PhyloNet v.3.8.0 is used) using the command Infer_ST_MDC [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], which requires the input gene trees to be rooted. Subgenome memberships are reconstructed for one polyploid taxon at a time. Therefore, alleles belonging to other polyploids in the study are internally pruned from the gene trees. Because, apart from simulation studies, the input gene trees themselves are only estimated, they are better represented by samples from a posterior distribution rather than single point estimates or summary trees [<xref ref-type="bibr" rid="CR9">9</xref>]. Our script therefore allows multiple gene trees per locus to be considered. The most parsimonious allele partition found during the search, along with its resulting MDC species tree, is returned as output. To fully exploit the advantage of keeping a tabu list, it is recommended to test different values for the tabu-tenure parameter because it is difficult to provide a sensible default. The optimization process stops after a prespecified number of iterations, which represents a trade-off between solution quality (i.e., number of extra lineages) and required runtime. Further recommendations on the optimization parameters can be found in the README file.</p>
    </sec>
    <sec id="Sec4">
      <title>Combination of replicate results</title>
      <p id="Par11">Due to plateaus, local optima, and the inherent stochasticity of our heuristic, the results from repeated runs of allcopol based on the same input data and parameter settings may vary. If they need to be summarized to assess their consistency and to obtain a more robust result, this is complicated by the unknown homology of reconstructed subgenomes across multiple analyses. We therefore implemented a relabeling strategy, which can be applied if multiple reconstructions are based on the same set of loci. Provided that there is a hidden one-to-one correspondence of inferred subgenomes across multiple reconstructions (as expected in case of allopolyploids), proper relabeling allows, for example, the application of common tree consensus methods.</p>
      <p id="Par12">Inferred allele partitions (hard clusterings) can be represented as matrices of binary membership coefficients, where each row represents an allele and each column corresponds to one cluster (subgenome). Assuming that for each column index j, the jth column of each coefficient matrix represents the same subgenome, the membership coefficients can be averaged over all matrices. If these are properly aligned, we expect the distribution of averaged coefficients, which might be viewed as membership probabilities, to be as sharp as possible. In other words, we want to minimize the uncertainty about the cluster membership of alleles in the averaged clustering. For the ith allele, this can be measured by the Shannon entropy H<sub>i</sub> = − Σ<sub>j</sub>(c<sub>ij</sub>log(c<sub>ij</sub>)), where (c<sub>ij</sub>) are the averaged membership coefficients and c<sub>ij</sub>log(c<sub>ij</sub>): = 0 if c<sub>ij</sub> = 0. The mean entropy of all considered alleles can be used as objective function, which is minimized by the command align_clusters to match clusters (subgenomes) across multiple reconstructions from allcopol. Its tabular input based on previously inferred allele partitions can be created through the command create_indfile, whose output is also compatible with CLUMPP [<xref ref-type="bibr" rid="CR4">4</xref>]. Once corresponding subgenomes have been identified, relabel_trees can be used to relabel them in the inferred species trees.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <sec id="Sec6">
      <title>Example analysis</title>
      <p id="Par13">A way of addressing gene-tree uncertainty is exemplified by an analysis of the tetraploid <italic>Leucanthemum ircutianum</italic> subsp. <italic>crassifolium</italic> (Lange) Vogt together with 21 diploid representatives of the genus and an outgroup. For each of 10 markers, 18,000 gene trees sampled from the posterior were available (Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>). From these, subsamples of 100 trees per marker were used as input for subgenome and species-tree reconstructions using allcopol. The program also requires accession-specific information, which is specified in Additional file <xref rid="MOESM3" ref-type="media">3</xref>. To account for the stochastic nature of both the optimization and the subsampling process, 96 replicate analyses based on different tree subsamples were performed. Thus, we obtained 96 species trees, whose subgenome leaves were then relabeled according to the output of align_clusters. Eventually, a greedy consensus tree was computed with SumTrees from DendroPy v.4.4.0 [<xref ref-type="bibr" rid="CR12">12</xref>] and visualized with Dendroscope v.3.5.9 [<xref ref-type="bibr" rid="CR3">3</xref>]. The complete analysis pipeline is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>; optimization parameters were specified according to Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1. While one subgenome is consistently inferred as sister of <italic>L. pyrenaicum</italic> Vogt, Konowalik &amp; Oberpr., the phylogenetic placement of the second one appears to be less reliable (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Nevertheless, as most averaged membership coefficients (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) are close to either one or zero, the obtained allele partitions are quite consistent and argue for an allotetraploid origin of the subspecies. On the other hand, a lack of allelic separation (i.e., averaged membership coefficients around 0.5) would not necessarily imply autopolyploidy and could, for instance, also be caused by insufficient optimization of the MDC criterion, recombination between subgenomes, or other violated assumptions. For each of the 96 input tree samples, the heuristic used by AllCoPol finds a more parsimonious solution than the original permutation approach (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), which highlights the importance of the algorithmic re-design for complex input data.<fig id="Fig1"><label>Fig. 1</label><caption><p>Central tools (color filled boxes) used in the example analysis with their respective input and output files. Blue filled boxes represent scripts which are included in the AllCoPol package</p></caption><graphic xlink:href="12859_2020_3750_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Phylogenetic reconstruction of <italic>L. ircutianum</italic> subsp. <italic>crassifolium</italic>. The presented species tree (<bold>a</bold>) based on optimized allele partitions forms the consensus of 96 individual reconstructions with AllCoPol. Only clade frequencies of at least 0.5 are displayed. The histogram (<bold>b</bold>) illustrates the corresponding frequency distribution of averaged membership coefficients. The presented values refer to the first cluster only, i.e., a value of one denotes that an allele is consistently assigned to the same subgenome labeled as “P1” in the tree above. For comparison, an exemplary network inferred by the PhyloNet command InferNetwork_MP is shown (<bold>c</bold>). Both reticulating branches are annotated with their corresponding inheritance probabilities. The <italic>L. vulgare</italic>-group is marked with asterisk in (<bold>a</bold>) and (<bold>c</bold>)</p></caption><graphic xlink:href="12859_2020_3750_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Parsimony of results obtained with different heuristic approaches. All 96 input tree samples were analyzed using the tabu search implemented in AllCoPol, the permutation approach proposed by Oberprieler et al. [<xref ref-type="bibr" rid="CR8">8</xref>], and the PhyloNet command InferNetwork_MP. For comparison, random solutions, from which AllCoPol starts its optimization, were evaluated. The scores obtained with InferNetwork_MP have been rescaled (multiplication by 100) because, if multiple gene trees per locus are provided, AllCoPol in its current version sums up their number of extra lineages, whereas the former by default uses their average</p></caption><graphic xlink:href="12859_2020_3750_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par14">For comparison, the same input data was used to calculate 96 species networks using the PhyloNet command InferNetwork_MP, where we allowed one reticulation and specified <italic>Leucanthemum ircutianum</italic> subsp. <italic>crassifolium</italic> as hybrid species. For each reconstruction, 100 optimization runs were performed (default: 5), otherwise we kept the default settings.</p>
      <p id="Par15">The results differ in several ways from those of AllCoPol. InferNetwork_MP tends to produce more parsimonious solutions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) and, in 95 of 96 of cases, suggests parental lineages from both inside and outside the so-called <italic>L. vulgare</italic>-group (or ‘Group 2’ of [<xref ref-type="bibr" rid="CR5">5</xref>]), a monophyletic group of closely related diploids. In contrast, AllCoPol places both subgenomes inside the <italic>L. vulgare</italic>-group. An exemplary species network is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, inferred sister clades are summarized in Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Tables S2 and S3 and show less reproducibility in case of the network reconstructions. While AllCoPol infers quite balanced allele partitions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), InferNetwork_MP assigns rather different inheritance probabilities to the parents of a reticulation node, on average 0.83 for the branch inside the <italic>L. vulgare</italic>-group and 0.17 for the other one. The differences mentioned above are probably due to the fact that AllCoPol does not accept solutions where more than two alleles of one locus per individual are assigned to the same subgenome. Without this constraint, reticulation events within closely related taxa are more likely to be dominated by introgression signals from less closely related taxa. It should also be noted that the presented numbers of extra lineages depend on how much computing time is spent on the optimization process. Because InferNetwork_MP is directly implemented in PhyloNet and thus generally faster, its runtime has been less limiting compared to allcopol, where a single analysis consumed about 320 h of CPU time using a Intel Xeon E5-v2650v4 processor. It is recommended to perform analyses of this size on a HPC cluster.</p>
    </sec>
    <sec id="Sec7">
      <title>Validation</title>
      <p id="Par16">To study the accuracy of phylogenetic reconstructions for tetra- and hexaploids, AllCoPol was applied to a simulated dataset. This was generated using the treesim submodule from DendroPy v.4.4.0 and parameters similar to those used by Than and Nakhleh [<xref ref-type="bibr" rid="CR14">14</xref>], which implies a considerable amount of incomplete lineage sorting. A pure-birth process with uniform speciation was used to simulate 30 8-taxon species trees, whose edge lengths were scaled to a total depth of 10<sup>6</sup> generations. Within each species tree, 10,000 coalescent gene trees, each comprising two alleles per taxon, were simulated based on an effective population size of N<sub>e</sub> = 10<sup>5</sup>. To simulate allopolyploids with completely disomic inheritance (i.e., without recombination among subgenomes), different taxa were treated as subgenomes of a hypothetical polyploid by combining their alleles into one artificial taxon. For each combination of 2 or 3 diploid taxa, allele partitions and species trees were reconstructed using allcopol. To assess the impact of varying numbers of loci, randomly chosen subsets of 2, 5, 10, or 20 gene trees were used as input. For each constellation (species tree, combination of diploids, number of gene trees), 24 reconstructions based on different gene-tree samples were performed. Prior to the analyses, optimization parameters for allcopol were tuned for each ploidy level and sample size (Additional file <xref rid="MOESM6" ref-type="media">6</xref>). When different parameter settings resulted in similar average performance, we preferred settings with a higher value of the sample size parameter because, for a fixed number of solution evaluations, this internally leads to less executions of PhyloNet and therefore less runtime spent on redundant calculations. Multiple analyses were executed in parallel on a HPC node with an Intel Xeon E5-v2650v4 processor, where a single reconstruction took between 5 min and about 1 h of CPU time, depending on the ploidy level and the number of gene trees. In addition to the analyses with AllCoPol, MDC species trees for the original diploids were calculated with the PhyloNet command Infer_ST_MDC. The artificial tetraploids were also analysed with the InferNetwork_MP command, where they were specified as hybrid species, allowing one reticulation node in the resulting species network. Each network reconstruction comprised 20 hillclimbing runs. The inferred networks were converted to multi-labelled trees to facilitate the comparison with tree-shaped reference topologies. Reconstruction errors were measured by the normalized Robinson–Foulds (RF) distance [<xref ref-type="bibr" rid="CR11">11</xref>] between inferred topologies and the known species trees. If polyploids were involved, 2 (tetraploid) or 6 (hexaploid) different mappings between inferred subgenomes and original diploids were possible, from which we used the one that led to the lowest RF distance. The results, illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, show that the missing information about subgenome (taxon) membership in tetra- and hexaploids only moderately increases the errors of reconstructed topologies. In case of the tetraploids, AllCoPol tends to find somewhat more accurate results than InferNetwork_MP. However, this difference decreases if cases are excluded where a polyploid derives from two monophyletic diploid species, which themselves are no longer present in analysis. For such problems, InferNetwork_MP in its applied form cannot infer the correct tree topology, instead, calculating a non-reticulate species tree would be more appropriate. While higher numbers of loci typically lead to lower errors, they not only increase the search space, but also the computing time required to evaluate a single solution.<fig id="Fig4"><label>Fig. 4</label><caption><p>Average topological distance between known and inferred species trees with and without involved polyploids. As all considered trees comprise 8 leaves, the normalized RF distance can only adopt six discrete values (0, 0.2, 0.4, 0.6, 0.8, 1). In contrast to (<bold>a</bold>), polyploids with monophyletic ancestors were excluded in (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2020_3750_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Comparison of methods</title>
      <p id="Par17">While AllCoPol outputs a taxon/subgenome tree along with the underlying allele partition, MDC-based network inference in PhyloNet yields a possibly reticulate network without providing allele-specific information. However, explicit allele mappings are a prerequisite to perform certain downstream analyses such as the proposed consensus approach. Varying numbers of reticulations further complicate an empirical comparison of both approaches, especially if ploidy levels beyond tetraploids are concerned. Besides providing a consensus approach for replicate analyses, a distinctive feature of AllCoPol consists in its restriction that a subgenome must not contain more than two alleles at one locus per individual in order to prevent biologically implausible solutions. Despite their conceptual similarity, both methods may infer quite different phylogenies as shown in the example analysis. The presented validation analyses show similar accuracy in either case, but are too simplistic to elucidate under which circumstances one method is preferable over the other and how sensitively they react to violations of their assumptions. To interpret the results obtained, it may be useful to observe how the topologies of the diploid taxa behave, depending on whether polyploids are included.</p>
    </sec>
    <sec id="Sec9">
      <title>Outlook</title>
      <p id="Par18">It should be noted that considering multiple gene trees per locus as well as replicate analyses come at the cost of increased runtime requirements, which may be prohibitive for certain analyses. Future work should therefore pay particular attention to computational efficiency. In addition, the usability could be further improved through a more robust algorithm, which could, for instance, provide an automatic adjustment of optimization parameters.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par19">AllCoPol is a Python package for phylogenetic reconstructions of polyploids, which improves the methodology of Oberprieler et al. [<xref ref-type="bibr" rid="CR8">8</xref>] in multiple ways, allowing a simpler and more robust analysis than before. Based on gene trees comprising alleles from either diploid and polyploid taxa, it allows to infer which alleles from a polyploid belong to the same diploid subgenome. Its functionality is provided in the form of command line tools, whose application does not require any programming skills.</p>
    <sec id="Sec11">
      <title>Availability and requirements</title>
      <p id="Par20">Project name: AllCoPol.</p>
      <p id="Par21">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/AGOberprieler/allcopol">https://github.com/AGOberprieler/allcopol</ext-link>.</p>
      <p id="Par22">Operating system: Platform independent.</p>
      <p id="Par23">Programming language: Python.</p>
      <p id="Par24">Other requirements: Python 3.5 or higher. To use the main command allcopol, a current version of PhyloNet (3.6.0 or higher) must be obtained. The latter requires a suitable Java installation.</p>
      <p id="Par25">License: MIT. Any restrictions to use by non-academics: none.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3750_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Empirical data from <italic>Leucanthemum</italic> Mill. (Compositae, Anthemideae). This file describes the data used in the example analysis.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3750_MOESM2_ESM.zip">
            <caption>
              <p><bold>Additional file 2:</bold> Gene trees used in the example analysis. This file contains the data used in the example analysis comprising 10 markers with 18,000 gene trees each.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2020_3750_MOESM3_ESM.txt">
            <caption>
              <p><bold>Additional file 3:</bold> Allele mapping used in the example analysis. This file assigns taxon membership, allele identifiers, and ploidy level to each accession under study.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2020_3750_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Table S1</bold>. Optimization of tuning parameters for the example analysis.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2020_3750_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Tables S2 and S3</bold>. Inferred sister clades of parental branches of <italic>L. ircutianum</italic> subsp. <italic>crassifolium</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2020_3750_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6: Tables S4–S11</bold>. Optimization of tuning parameters for validation analyses.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MDC</term>
        <def>
          <p id="Par4">Minimizing deep coalescences</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC Cluster</term>
        <def>
          <p id="Par5">High-performance computing cluster</p>
        </def>
      </def-item>
      <def-item>
        <term>RF distance</term>
        <def>
          <p id="Par6">Robinson–Foulds distance</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03750-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Gudrun Karch and Marco Dorfner for technical assistance in the molecular laboratory of the Evolutionary and Systematic Botany Group at Regensburg University. We also thank three anonymous reviewers who improved the present version of our contribution considerably.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>UL conceived and implemented the presented methodology, carried out the analyses, and wrote a first draft of the manuscript; CO conceived the underlying idea of inferring subgenomes by means of MDC and supervised the progress of the project; FW produced the gene trees used in the exemplary analysis of <italic>Leucanthemum ircutianum</italic> subsp. <italic>crassifolium</italic>. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work (i.e., the position of the first author U.L.) was funded by a Grant (OB 155/13-1) of the German Research Foundation (DFG) in the frame of the Priority Programme SPP 1991 “Taxon-omics − New Approaches for Discovering and Naming Biodiversity” to C.O.).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The Python package AllCoPol is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/agoberprieler/allcopol">https://github.com/agoberprieler/allcopol</ext-link>. Gene tree populations used in the example analysis are provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par26">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par27">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par28">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Cao Z, Liu X, Ogilvie HA, Yan Z, Nakhleh L. Practical aspects of phylogenetic network analysis using PhyloNet. bioRxiv 746362 [Preprint]; 2019.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glover</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Future paths for integer programming and links to artificial intelligence</article-title>
        <source>Comput Oper Res</source>
        <year>1986</year>
        <volume>13</volume>
        <fpage>533</fpage>
        <lpage>549</lpage>
        <pub-id pub-id-type="doi">10.1016/0305-0548(86)90048-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Scornavacca</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dendroscope 3: an interactive viewer for rooted phylogenetic trees and networks</article-title>
        <source>Syst Biol</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>1061</fpage>
        <lpage>1067</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys062</pub-id>
        <pub-id pub-id-type="pmid">22780991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jakobsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>CLUMPP: a cluster matching and permutation program for dealing with label switching and multimodality in analysis of population structure</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1801</fpage>
        <lpage>1806</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm233</pub-id>
        <pub-id pub-id-type="pmid">17485429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konowalik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tomasello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vogt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oberprieler</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Detecting reticulate relationships among diploid <italic>Leucanthemum</italic> Mill. (Compositae, Anthemideae) taxa using multilocus species tree reconstruction methods and AFLP fingerprinting</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2015</year>
        <volume>92</volume>
        <fpage>308</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2015.06.003</pub-id>
        <pub-id pub-id-type="pmid">26103001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Gene trees in species trees</article-title>
        <source>Syst Biol</source>
        <year>1997</year>
        <volume>46</volume>
        <fpage>523</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/46.3.523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Inferring phylogeny despite incomplete lineage sorting</article-title>
        <source>Syst Biol</source>
        <year>2006</year>
        <volume>55</volume>
        <fpage>21</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1080/10635150500354928</pub-id>
        <pub-id pub-id-type="pmid">16507521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oberprieler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tomasello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Konowalik</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A permutation approach for inferring species networks from gene trees in polyploid complexes by minimising deep coalescences</article-title>
        <source>Methods Ecol Evol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>835</fpage>
        <lpage>849</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Reilly</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Donoghue</surname>
            <given-names>PCJ</given-names>
          </name>
        </person-group>
        <article-title>The efficacy of consensus tree methods for summarizing phylogenetic relationships from a posterior sample of trees estimated from morphological data</article-title>
        <source>Syst Biol</source>
        <year>2018</year>
        <volume>67</volume>
        <fpage>354</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syx086</pub-id>
        <pub-id pub-id-type="pmid">29106675</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oxelman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brysting</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Marcussen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Oberprieler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pfeil</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetics of allopolyploids</article-title>
        <source>Annu Rev Ecol Evol Syst</source>
        <year>2017</year>
        <volume>48</volume>
        <fpage>543</fpage>
        <lpage>557</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110316-022729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <lpage>147</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sukumaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>DendroPy: a Python library for phylogenetic computing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1569</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id>
        <pub-id pub-id-type="pmid">20421198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Than</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ruths</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>PhyloNet: a software package for analyzing and reconstructing reticulate evolutionary relationships</article-title>
        <source>BMC Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>322</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Than</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Species tree inference by minimizing deep coalescences</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000501</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000501</pub-id>
        <pub-id pub-id-type="pmid">19749978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Inferring phylogenetic networks using PhyloNet</article-title>
        <source>Syst Biol</source>
        <year>2018</year>
        <volume>67</volume>
        <issue>4</issue>
        <fpage>735</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syy015</pub-id>
        <pub-id pub-id-type="pmid">29514307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for MDC-based multi-locus phylogeny inference: beyond rooted binary gene trees on single alleles</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1543</fpage>
        <lpage>1559</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0174</pub-id>
        <pub-id pub-id-type="pmid">22035329</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
