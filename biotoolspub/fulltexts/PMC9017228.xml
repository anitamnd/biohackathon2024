<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CRMETH100085 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 pdf ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cell Rep Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cell Rep Methods</journal-id>
    <journal-title-group>
      <journal-title>Cell Reports Methods</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2667-2375</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9017228</article-id>
    <article-id pub-id-type="pii">S2667-2375(21)00140-5</article-id>
    <article-id pub-id-type="doi">10.1016/j.crmeth.2021.100085</article-id>
    <article-id pub-id-type="publisher-id">100085</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Report</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An object-oriented framework for evolutionary pangenome analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Ferrés</surname>
          <given-names>Ignacio</given-names>
        </name>
        <email>iferres@pasteur.edu.uy</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Iraola</surname>
          <given-names>Gregorio</given-names>
        </name>
        <email>giraola@pasteur.edu.uy</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
        <xref rid="cor2" ref-type="corresp">∗∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Microbial Genomics Laboratory, Institut Pasteur Montevideo, Montevideo, Uruguay</aff>
      <aff id="aff2"><label>2</label>Center for Innovation in Epidemiological Surveillance, Institut Pasteur Montevideo, Montevideo, Uruguay</aff>
      <aff id="aff3"><label>3</label>Wellcome Sanger Institute, Hinxton, UK</aff>
      <aff id="aff4"><label>4</label>Center for Integrative Biology, Universidad Mayor, Santiago de Chile, Chile</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>iferres@pasteur.edu.uy</email></corresp>
      <corresp id="cor2"><label>∗∗</label>Corresponding author <email>giraola@pasteur.edu.uy</email></corresp>
      <fn id="fn1">
        <label>5</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>27</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>1</volume>
    <issue>5</issue>
    <elocation-id>100085</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Pangenome analysis is fundamental to explore molecular evolution occurring in bacterial populations. Here, we introduce Pagoo, an R framework that enables straightforward handling of pangenome data. The encapsulated nature of Pagoo allows the storage of complex molecular and phenotypic information using an object-oriented approach. This facilitates to go back and forward to the data using a single programming environment and saving any stage of analysis (including the raw data) in a single file, making it sharable and reproducible. Pagoo provides tools to query, subset, compare, visualize, and perform statistical analyses, in concert with other microbial genomics packages available in the R ecosystem. As working examples, we used 1,000 <italic>Escherichia coli</italic> genomes to show that Pagoo is scalable, and a global dataset of <italic>Campylobacter fetus</italic> genomes to identify evolutionary patterns and genomic markers of host-adaptation in this pathogen.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">Pagoo is a software framework to analyze bacterial pangenomes</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">It can be used with the output of any pangenome reconstruction software</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">Genetic, phenotypic, and other metadata are integrated in a single object or file</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">Pagoo is extensible and interacts easily with other microbial genomics packages</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="editor-highlights" id="abs0025">
      <title>Motivation</title>
      <p>Despite the extensive availability of software for bacterial pangenome reconstruction, current tools for pangenome data analysis do not provide end-to-end solutions because, once visualizations are generated, users cannot use the same framework to return to the data and perform further comparisons and more complex analyses using standardized methods. To fill this gap, we developed Pagoo, a flexible and extensible but standardized framework that allows performing integrative pangenome analysis in a simple and reproducible way.</p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0030">
      <p>Ferrés and Iraola develop a software package in R to integrate and analyze bacterial pangenome data. This allows creating a single programming object that stores all the data, as well as methods to produce standard analyses and visualizations for comparative genomics.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Keywords</title>
      <kwd>pangenome analysis</kwd>
      <kwd>bacterial comparative genomics</kwd>
      <kwd>bacterial evolution</kwd>
      <kwd>data visualization</kwd>
      <kwd>object-oriented programming</kwd>
      <kwd>R</kwd>
      <kwd>pangenome reconstruction</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: September 27, 2021</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0045">The exponentially growing number of diverse bacterial genomes has prompted pangenome reconstruction as a gold standard to uncover molecular evolution of bacterial populations (<xref rid="bib16" ref-type="bibr">Tettelin et al., 2005</xref>; <xref rid="bib19" ref-type="bibr">Vernikos et al., 2015</xref>). This is because of the high intraspecific diversity observed in bacterial genomes, which are affected by horizontal gene transfer, variations in effective population size, and constant colonization of new niches. As these forces are influential in determining pangenome size and structure (<xref rid="bib8" ref-type="bibr">McInerney et al., 2017</xref>), pangenome comparisons can reveal genome evolutionary dynamics associated with important biological processes, such as speciation, host adaptation, pathogenicity, or the acquisition of antimicrobial resistance. Pangenome reconstruction is typically performed from genes annotated in a set of whole-genome sequences. In general, coding sequences of different strains are grouped in orthologous clusters based on different similarity criteria. Then, pangenome data inform about the belonging of each gene encoded in each genome to a certain orthologous cluster. In recent years, several software tools have been developed to reconstruct bacterial pangenomes, such as Roary (<xref rid="bib9" ref-type="bibr">Page et al., 2015</xref>), panX (<xref rid="bib3" ref-type="bibr">Ding et al., 2018</xref>), PanOCT (<xref rid="bib4" ref-type="bibr">Fouts et al., 2012</xref>), PIRATE (<xref rid="bib1" ref-type="bibr">Bayliss et al., 2019</xref>), PEPPAN (<xref rid="bib22" ref-type="bibr">Zhou et al., 2020</xref>), or Panaroo (<xref rid="bib18" ref-type="bibr">Tonkin-Hill et al., 2020</xref>). These tools focus on automation of steps, improvement of clustering algorithms, and optimization of computational costs to process thousands of sequences of increasingly large genomic datasets. Many of these software include data visualization modules along with other specific software that have been developed with this purpose, including Phandango (<xref rid="bib5" ref-type="bibr">Hadfield et al., 2018</xref>) or PanViz (<xref rid="bib11" ref-type="bibr">Pedersen et al., 2017</xref>). However, current tools do not provide end-to-end solutions for customized pangenome data analysis, since, once visualizations are generated, users cannot use the same framework to return to the data and perform further comparisons and more complex analyses using standardized methods.</p>
    <p id="p0050">Here, we introduce Pagoo, a pangenome post-processing tool that can take the output produced by pangenome reconstruction software tools providing a standardized framework for its analysis. Pagoo is based on an object-oriented design built on a class system in R (<xref rid="bib12" ref-type="bibr">R Core team, 2017</xref>), which implements: (1) an integrative data structure for standardized storage of pangenome information, such as orthologous clusters, sequences, annotations, and metadata, in a single object (shareable through a single file); (2) a set of straightforward methods for responsive querying, handling, and subsetting of this data structure; and (3) a set of standard statistics and active visualizations leveraging flexible downstream comparative analyses. Along with extensive documentation, we show how Pagoo interacts with other widely used microbial genomics tools and the R ecosystem for improved analysis of molecular evolution in bacterial populations.</p>
    <sec id="sec1.1">
      <title>New approaches</title>
      <sec id="sec1.1.1">
        <title>Description of the software</title>
        <p id="p0055">A pangenome can be represented as individual genes that belong to organisms (genomes), which are then assigned to a cluster of orthologous genes. Pagoo stores this as a three-column matrix, with one column identifying an individual gene, the next one identifying the organism that this gene belongs to, and the last one identifying the orthologous cluster that the gene was assigned by the pangenome reconstruction method. Optionally, this matrix can contain additional columns as gene-specific metadata, such as annotations, functional assignments, or genomic coordinates. Orthologous clusters and organisms can also take metadata represented as two different matrices, with the condition that each one must contain a column that correctly maps each observation (cluster or organism) into the former matrix. Gene sequences can also be added to this structure, with the condition that their names must also map to rows in the first matrix (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). This relational structure optimizes data storage avoiding duplication, enables flexibility to work with different types of metadata, and facilitates complex querying and analysis.<fig id="fig1"><label>Figure 1</label><caption><p>Framework and overall design of Pagoo</p><p>(A) Example of the relational structure implemented to store, link, and operate over different pangenome data types.</p><p>(B) General description of the workflow from assembled genomes to Pagoo analysis. Once pangenome files are created with any available pangenome reconstruction software, these files can be loaded to create the Pagoo object. The specific R6 classes store and manage different data types that can store all the information in a single file or perform comparative analyses using the R console interface or the Pagoo Shiny application.</p></caption><graphic xlink:href="gr1"/></fig></p>
        <p id="p0060">A salient and unique feature of Pagoo is that these data structures are stored and managed in an encapsulated, object-oriented fashion using the R6 package as backend. In contrast with traditional R programming, the R6 paradigm considers that methods belong to objects rather than to generic functions, so an object contains both the data and embedded methods to analyze it. In this context, the Pagoo object is built on three R6 classes. PgR6 is the most basic class that contains methods and functions for data handling and subsetting. Then, PgR6M inherits all the methods and fields from PgR6 and incorporates statistical methods and visualization tools based on the ggplot2 package (<xref rid="bib20" ref-type="bibr">Wickham, 2011</xref>). PgR6MS inherits all capabilities from the others and adds methods for manipulation of biological sequences using the Biostrings package (<xref rid="fig1" ref-type="fig">Figure 1</xref>B). These classes support the main data types that typically represent a pangenome, providing a synergistic framework to manage both the raw data and methods to perform operations and explore results with customized visualizations. Moreover, any of these classes could be further inherited and easily extended by third-party applications.</p>
        <p id="p0065">Another remarkable feature of Pagoo is that raw data stored in the pangenome object are kept unaltered in the background, while users can query, mutate, or subset the object using active bindings. This allows changing the state of the object without altering the original data. For example, users can temporarily hide certain organisms from the dataset, actively set thresholds that change the definition of core genes, or extract specific information from organisms, genes, clusters, or sequences. Class-specific methods for generic subset operators are also implemented, enabling extraction of relevant fields straight from the object by using standard R subset notation.</p>
        <p id="p0070">Pagoo provides specific methods for generating the pangenome object from scratch by formatting output files from any pangenome reconstruction software. In addition, Pagoo provides specific functions to automatically generate the pangenome object from output files produced by Roary and Panaroo. Other popular pangenome reconstruction software, such as PIRATE and PEPPAN, have functions to transform their outputs into Roary's output format, making them compatible with Pagoo. Then, pangenome can be saved with any changes to the object along with the unaltered original data as a single file. Pagoo has been built and tested in all three major operative systems (Linux, Windows, and Mac). A detailed explanation of each method and operator for data input, saving, and loading, and for specific comparative analyses, is provided in the online user manual (GitHub: <ext-link ext-link-type="uri" xlink:href="https://iferres.github.io/pagoo/" id="intref0010">https://iferres.github.io/pagoo/</ext-link>). Together, this implementation represents a conceptual advance for pangenome data handling, facilitating reproducibility, and enabling multiple and flexible analyses.</p>
      </sec>
      <sec id="sec1.1.2">
        <title>Data analysis and visualization</title>
        <p id="p0075">Pagoo includes statistical and visualization methods. Customized plots and statistical analyses can be generated directly from the pangenome object using active bindings on the console, or by deploying a built-in R-Shiny application. This interactive application is divided into two main components: (1) a general dashboard that interactively displays summary statistics, including number of organisms, orthologous clusters and genes, core and accessory genome sizes, gene frequency barplots, pangenome curves, and scrollable information about core genome clusters and genes (i.e., annotation or any other metadata); and (2) a specific dashboard showing clustering of genomes according to accessory gene distances and principal-component analysis (PCA), genome-specific accessory genome sizes, visualization of gene presence/absence matrix with associated metadata, and information about accessory gene clusters (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>). This interactive application allows responsive exploration of evolutionary trends in bacterial populations, guiding downstream analyses on the console that can be performed over the same pangenome object using methods provided by Pagoo or leveraging the interaction with other R tools.</p>
      </sec>
      <sec id="sec1.1.3">
        <title>Creating recipes for more complex analyses</title>
        <p id="p0080">Remarkably, more complex comparative pangenome analyses can be performed by applying concise code recipes. We define recipes as relatively short snippets that pipe pangenome information extracted from the object as input to other R tools. We have developed example recipes (available in the online user manual at GitHub: <ext-link ext-link-type="uri" xlink:href="https://iferres.github.io/pagoo/articles/6-Recipes.html" id="intref0015">https://iferres.github.io/pagoo/articles/6-Recipes.html</ext-link>) to build core genome phylogenies, identify population structure, explore genome-wide selective pressures acting over the core genes, and compare individual gene sequences against specific databases. Importantly, the development and implementation of recipes enable full reproducibility of publication-quality figures generated directly from the pangenome object. Despite the R ecosystem currently including dozens of packages that allow performing diverse and complex comparative analyses, it is possible that some specific tasks could be difficult to implement in R. In this sense, Pagoo recipes can be designed to interact with external tools to generate results outside the R session and integrate them into the pangenome object using standard R data input functions.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <p id="p0085">As a working example, we used a previously published study on the genomic evolution of <italic>Campylobacter fetus</italic> (<xref rid="bib6" ref-type="bibr">Iraola et al., 2017</xref>), a zoonotic pathogen that presents a strong population structure with different lineages adapted to livestock or humans. In brief, we used Pagoo to analyze a pangenome reconstructed from 164 <italic>C. fetus</italic> genomes (<xref rid="fig2" ref-type="fig">Figure 2</xref>). Using simple and readable R code we were able to recover the main diversity trends reported for this species, such as a marked difference in accessory gene patterns between livestock- and human-adapted lineages. Specifically, we identified a set of 78 highly discriminant accessory genes that can differentiate between these lineages and could be used to develop molecular typing tools (<xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>). In addition, automatic extraction of core genes from the Pagoo object enabled robust phylogenomic analyses in interaction with other R packages, such as DECIPHER (<xref rid="bib21" ref-type="bibr">Wright, 2015</xref>), for multiple sequence alignment, phangorn (<xref rid="bib13" ref-type="bibr">Schliep, 2011</xref>) for phylogenetic reconstruction, and Rhierbaps (<xref rid="bib17" ref-type="bibr">Tonkin-Hill et al., 2018</xref>) for population structure inference. This analysis revealed the same population structure composed by eight main <italic>C. fetus</italic> lineages as reported in the original study (<xref rid="bib6" ref-type="bibr">Iraola et al., 2017</xref>). Then, we used Pagoo to compare phylogenies built from every single core gene against the core genome phylogeny. This allowed us to rank the core genes based on their goodness to recover the population structure, <italic>mcp4</italic> being the one with the closest distance (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>A). This enables the future development of high-resolution <italic>C. fetus</italic> typing methods using amplicon sequencing of single core genes. Also, the PCA based on the accessory genes allowed to recover previously observed patterns of variation separating bovine-adapted <italic>C. fetus</italic> from other hosts, including humans (discrimination given by PC1 in observed in <xref rid="fig2" ref-type="fig">Figure 2</xref>D). Using this approach we also detected a separation between bovine-adapted genomes given by PC2 (<xref rid="fig2" ref-type="fig">Figure 2</xref>D). Further exploration of this demonstrated a specific group of genomes from Spain with particular accessory gene patterns, suggesting a previously unnoticed geographic structuring of this pathogen.<fig id="fig2"><label>Figure 2</label><caption><p>Results extracted from the pangenome object</p><p>Exploration of the <italic>C. fetus</italic> pangenome using information directly extracted from the pangenome object and customized esthetics.</p><p>(A) Pangenome and core genome curves with gray circles representing different sub-samples at increasing numbers of genomes; the black lines show the fitting to the power law and exponential decay functions, respectively.</p><p>(B) The distribution of genes in different subsets of genomes.</p><p>(C) The distribution of the pangenome in core genes and accessory genes (shell and cloud genes).</p><p>(D) A principal components analysis generated from the gene presence/absence matrix whose first principal component (PC1) clearly distinguishes between two groups of genomes, one of mostly bovine-derived strains (right), and the other with various hosts (left).</p><p>(E) A heatmap (right) with gene count (paralogs) abundance (in columns) and per organisms in (rows, associated to a phylogenetic tree [left]) inferred from a concatenated alignment of core genes. Between the tree and the heatmap, the color bars indicate, from left to right, the host associated to each isolate, and three different depth levels of subpopulations inferred by the Rhierbaps package.</p></caption><graphic xlink:href="gr2"/></fig></p>
    <p id="p0090">An additional dataset consisting of hundreds of multi-drug resistant <italic>E. coli</italic> genomes (<xref rid="bib2" ref-type="bibr">Decano and Downing, 2019</xref>) was used to test scalability by measuring the time it takes Pagoo to perform certain operations. First, Pagoo was able to upload the output from Roary, including gene sequences automatically extracted from GFF3 annotation files, and automatically build its relational structure for 500 genomes in ∼20 min. This time does not scale linearly because it depends on the number and size of gene clusters, but was completed in reasonable time (&lt;2 h) for 1,000 genomes. Second, once the Pagoo object is created, information can be queried on the fly in matter of seconds or minutes. For example, one single operation can extract all core genes from 1,000 genomes in ∼2 min. Also, visualizations such as gene distribution plots can be rendered in seconds just using single operations (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>B).</p>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0095">The advent of high-throughput sequencing technologies more than 15 years ago pushed microbiology toward the field of comparative genomics, which rapidly transitioned from studies including few to thousands of genomes (<xref rid="bib19" ref-type="bibr">Vernikos et al., 2015</xref>). This substantially increased the complexity of datasets, requiring new approaches to systematically handle and track different components of interrelated pangenomic data. Pagoo introduces a framework underpinned in a concept that leverages the simplicity of storing all the information in a standardized and reproducible manner in a single, shareable object, as well as providing specific methods to query and analyze it. The implemented classes can be easily inherited and extended, so users can eventually incorporate methods able to cope with any kind of metadata added to the pangenomes, such as genomic coordinates or structural information. Pagoo not only allows to perform basic exploratory analysis through the Shiny application, but also facilitates expert bioinformatic analysis to deliver more complex results through the R console ecosystem working in concert with other population genomic packages. The advantage of using an interpreted language for post-processing of pangenomic data, like R, in contrast to compiled tools that run from the terminal interface, is that users can go back and forward to the data, producing both general and fine-grained analyses in a single environment. Pagoo's encapsulated and object-oriented nature brings simplicity and intuition to the experience of working with these kinds of complex relational data, in combination with the active-binding feature of R6 classes, which opens the possibility of changing the state of the object as a whole and its behavior. On the contrary, the classic functional object-oriented R programming works well for simpler data structures, but falls short and becomes inconvenient when dealing with complex and potentially mutable structures, which pangenomes are. Overall, Pagoo's design aims to improve and facilitate current practices on the analysis of molecular evolution in bacterial populations.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0100">Although the R ecosystem includes dozens of packages to perform diverse comparative genomic analyses, it is possible that some specific tasks are difficult to implement in R or are better covered by other pangenome analysis tools. Also, Pagoo has been tested with hundreds to thousands of genomes, but a potential limitation is the time it can take to generate Pagoo objects from extremely big datasets. In particular, Pagoo's Shiny application for dynamic visualization has been designed to work with small to medium size datasets.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0105">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td><italic>Campylobacter fetus</italic> dataset</td>
                <td>
                  <xref rid="bib6" ref-type="bibr">Iraola et al. (2017)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.13622354.v1" id="intref0020">https://doi.org/10.6084/m9.figshare.13622354.v1</ext-link>
                </td>
              </tr>
              <tr>
                <td><italic>Escherichia coli</italic> ST131 dataset</td>
                <td>
                  <xref rid="bib2" ref-type="bibr">Decano and Downing (2019)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3341535" id="intref0025">https://doi.org/10.5281/zenodo.3341535</ext-link>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <bold>Software and algorithms</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>Pagoo</td>
                <td>This paper</td>
                <td><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=pagoo" id="intref0030">https://cran.r-project.org/package=pagoo</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/iferres/pagoo" id="intref0035">https://github.com/iferres/pagoo</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.15074652.v1" id="intref0040">https://doi.org/10.6084/m9.figshare.15074652.v1</ext-link></td>
              </tr>
              <tr>
                <td>Prokka</td>
                <td>
                  <xref rid="bib14" ref-type="bibr">Seemann, 2014</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/prokka" id="intref0045">https://github.com/tseemann/prokka</ext-link>
                </td>
              </tr>
              <tr>
                <td>ggplot2</td>
                <td>
                  <xref rid="bib20" ref-type="bibr">Wickham (2016)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ggplot2" id="intref0050">cran.r-project.org/package=ggplot2</ext-link>
                </td>
              </tr>
              <tr>
                <td>DECIPHER</td>
                <td>
                  <xref rid="bib21" ref-type="bibr">Wright (2015)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/DECIPHER.html" id="intref0055">https://www.bioconductor.org/packages/release/bioc/html/DECIPHER.html</ext-link>
                </td>
              </tr>
              <tr>
                <td>Phangorn</td>
                <td>
                  <xref rid="bib13" ref-type="bibr">Schliep (2010)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=phangorn" id="intref0060">cran.r-project.org/package=phangorn</ext-link>
                </td>
              </tr>
              <tr>
                <td>Rhierbaps</td>
                <td>
                  <xref rid="bib17" ref-type="bibr">Tonkin-Hill et al., 2018</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=rhierbaps" id="intref0065">cran.r-project.org/package=rhierbaps</ext-link>
                </td>
              </tr>
              <tr>
                <td>Ape</td>
                <td>
                  <xref rid="bib10" ref-type="bibr">Paradis and Schliep (2019)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ape" id="intref0070">cran.r-project.org/package=ape</ext-link>
                </td>
              </tr>
              <tr>
                <td>Roary</td>
                <td>
                  <xref rid="bib9" ref-type="bibr">Page et al. (2015)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://sanger-pathogens.github.io/Roary/" id="intref0075">https://sanger-pathogens.github.io/Roary/</ext-link>
                </td>
              </tr>
              <tr>
                <td>Scripts to run all the analysis</td>
                <td>This paper</td>
                <td><ext-link ext-link-type="uri" xlink:href="https://github.com/iferres/pagoo_publication_scripts" id="intref0080">github.com/iferres/pagoo_publication_scripts</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.15074673.v1" id="intref0085">https://doi.org/10.6084/m9.figshare.15074673.v1</ext-link></td>
              </tr>
              <tr>
                <td>Singularity</td>
                <td>
                  <xref rid="bib7" ref-type="bibr">Kurtzer et al. (2017)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://sylabs.io/singularity/" id="intref0090">https://sylabs.io/singularity/</ext-link>
                </td>
              </tr>
              <tr>
                <td>Singularity container hosted at singularity-hub</td>
                <td>
                  <xref rid="bib15" ref-type="bibr">Sochat et al. (2017)</xref>
                </td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://singularity-hub.org/collections/5123" id="intref0095">https://singularity-hub.org/collections/5123</ext-link>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0110">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Gregorio Iraola (<ext-link ext-link-type="uri" xlink:href="mailto:giraola@pasteur.edu.uy" id="intref0100">giraola@pasteur.edu.uy</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0115">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <sec id="sec4.3.1">
        <title>Re-analysis of <italic>C. fetus</italic> dataset</title>
        <p id="p0120">Genome assemblies were obtained from a previously published study by (<xref rid="bib6" ref-type="bibr">Iraola et al., 2017</xref>). Genome re-annotation was performed with Prokka (<xref rid="bib14" ref-type="bibr">Seemann, 2014</xref>) and the pangenome was reconstructed using Roary (<xref rid="bib9" ref-type="bibr">Page et al., 2015</xref>) with default parameters. Assessment of genome quality revealed that 4 assemblies contained an abnormal number of genes (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>C), so they were hidden from the dataset using Pagoo’s ‘drop()’ function. This function is recommended only with exploratory purposes or when the number of hidden organisms is small. Otherwise, it is recommended to reconstruct the pangenome by removing undesired genomes from the beginning. Plots describing summary statistics were generated using Pagoo’s built-in methods and the ggplot2 package (<xref rid="bib20" ref-type="bibr">Wickham, 2011</xref>).</p>
        <p id="p0125">Core genes were extracted from the pangenome object using Pagoo’s method ‘core_seqs_4_phylo’, were aligned with DECIPHER (<xref rid="bib21" ref-type="bibr">Wright, 2015</xref>) and a reference phylogeny was reconstructed from concatenated core gene sequences using the phangorn package (<xref rid="bib13" ref-type="bibr">Schliep, 2011</xref>). The Rhierbaps package (<xref rid="bib17" ref-type="bibr">Tonkin-Hill et al., 2018</xref>) was used to infer population structure. Each individual core gene was aligned to reconstruct gene-specific phylogenies as described above. The topological distance between the reference phylogeny and gene-specific phylogenies was calculated with the ‘dist.topo’ function from the ape package (<xref rid="bib10" ref-type="bibr">Paradis and Schliep, 2019</xref>). A tanglegram was plotted to compare the reference phylogeny with the closest topology obtained with single genes.</p>
      </sec>
      <sec id="sec4.3.2">
        <title>Scalability assessment using <italic>E. coli</italic> genomes</title>
        <p id="p0130">To evaluate scalability, annotated GFF3 files from 1,000 <italic>E. coli</italic> genomes were obtained from (<xref rid="bib2" ref-type="bibr">Decano and Downing, 2019</xref>). We used subsets of 10, 100, 500 and 1,000 genomes to build pangenomes using Roary (<xref rid="bib9" ref-type="bibr">Page et al., 2015</xref>) with default parameters. Then, we assessed the time Pagoo takes to complete five different operations using these pangenome datasets (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>B). The evaluated operations were grouped in two categories: (1) loading pangenome data, and (2) querying already loaded pangenome data. In the first category, we evaluated the time it takes to: (1.1) create a Pagoo object using the built-in function ‘roary_2_pagoo()’ providing only the gene presence/absence matrix file, (1.2) create a Pagoo object using the ‘roary_2_pagoo()’ function but also providing the GFF3 files to include sequences into the Pagoo object, and (1.3) create a Pagoo object from already loaded information and sequences into the R session using the ‘pagoo()’ function. In the second category we measured the time it takes to (2.1) retrieve core genome sequences, and (2.2) generate a pangenome frequency plot. Each operation was repeated 10 times.</p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <p id="p0135">A Principal Component Analysis (PCA) based on accessory gene presence/absence patterns was generated with Pagoo's method ‘pan_pca()’. Then, those accessory genes which most contributed to discriminate between livestock-associated and human-associated lineages were identified based on the eigenvector of the first component. Genes with a loading value lower than −0.05 and greater than 0.05 were selected (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>D; <xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>).</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Bayliss</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Thorpe</surname>
            <given-names>H.A.</given-names>
          </name>
          <name>
            <surname>Coyle</surname>
            <given-names>N.M.</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>S.K.</given-names>
          </name>
          <name>
            <surname>Feil</surname>
            <given-names>E.J.</given-names>
          </name>
        </person-group>
        <article-title>PIRATE: a fast and scalable pangenomics toolbox for clustering diverged orthologues in bacteria</article-title>
        <source>GigaScience</source>
        <volume>8</volume>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Decano</surname>
            <given-names>A.G.</given-names>
          </name>
          <name>
            <surname>Downing</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>An <italic>Escherichia coli</italic> ST131 pangenome atlas reveals population structure and evolution across 4,071 isolates</article-title>
        <source>Sci. Rep.</source>
        <volume>9</volume>
        <year>2019</year>
        <fpage>17394</fpage>
        <pub-id pub-id-type="pmid">31758048</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Baumdicker</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Neher</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>panX: pan-genome analysis and exploration</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>46</volume>
        <year>2018</year>
        <fpage>e5</fpage>
        <pub-id pub-id-type="pmid">29077859</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Fouts</surname>
            <given-names>D.E.</given-names>
          </name>
          <name>
            <surname>Brinkac</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Inman</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>PanOCT: automated clustering of orthologs using conserved gene neighborhood for pan-genomic analysis of bacterial strains and closely related species</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>40</volume>
        <year>2012</year>
        <fpage>e172</fpage>
        <pub-id pub-id-type="pmid">22904089</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Hadfield</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Croucher</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Goater</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Abudahab</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>S.R.</given-names>
          </name>
        </person-group>
        <article-title>Phandango: an interactive viewer for bacterial population genomics</article-title>
        <source>Bioinformatics</source>
        <volume>34</volume>
        <year>2018</year>
        <fpage>292</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="pmid">29028899</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Iraola</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lehours</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Bekal</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>García-Peña</surname>
            <given-names>F.J.</given-names>
          </name>
          <name>
            <surname>Paolicchi</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Morsella</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hotzel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hsueh</surname>
            <given-names>P.-R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct <italic>Campylobacter fetus</italic> lineages adapted as livestock pathogens and human pathobionts in the intestinal microbiota</article-title>
        <source>Nat. Commun.</source>
        <volume>8</volume>
        <year>2017</year>
        <fpage>1367</fpage>
        <pub-id pub-id-type="pmid">29118316</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtzer</surname>
            <given-names>G.M.</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>M.W.</given-names>
          </name>
        </person-group>
        <article-title>Singularity: scientific containers for mobility of compute</article-title>
        <source>PLoS One</source>
        <volume>12</volume>
        <year>2017</year>
        <fpage>e0177459</fpage>
        <pub-id pub-id-type="pmid">28494014</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>McInerney</surname>
            <given-names>J.O.</given-names>
          </name>
          <name>
            <surname>McNally</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>O’Connell</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Why prokaryotes have pangenomes</article-title>
        <source>Nat. Microbiol.</source>
        <volume>2</volume>
        <year>2017</year>
        <fpage>1</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Cummins</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>V.K.</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Holden</surname>
            <given-names>M.T.G.</given-names>
          </name>
          <name>
            <surname>Fookes</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Falush</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Keane</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <year>2015</year>
        <fpage>3691</fpage>
        <lpage>3693</lpage>
        <pub-id pub-id-type="pmid">26198102</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Schliep</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>526</fpage>
        <lpage>528</lpage>
        <pub-id pub-id-type="pmid">30016406</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Pedersen</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Nookaew</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Wayne Ussery</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Månsson</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>PanViz: interactive visualization of the structure of functionally annotated pangenomes</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>1081</fpage>
        <lpage>1082</lpage>
        <pub-id pub-id-type="pmid">28057677</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="other" id="sref12">R Core team (2017). R: A Languague and Environment for Statistical Computing.</mixed-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Schliep</surname>
            <given-names>K.P.</given-names>
          </name>
        </person-group>
        <article-title>phangorn: phylogenetic analysis in R</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <year>2011</year>
        <fpage>592</fpage>
        <lpage>593</lpage>
        <pub-id pub-id-type="pmid">21169378</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Seemann</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Prokka: rapid prokaryotic genome annotation</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>2068</fpage>
        <lpage>2069</lpage>
        <pub-id pub-id-type="pmid">24642063</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Sochat</surname>
            <given-names>V.V.</given-names>
          </name>
          <name>
            <surname>Prybol</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Kurtzer</surname>
            <given-names>G.M.</given-names>
          </name>
        </person-group>
        <article-title>Enhancing reproducibility in scientific computing: metrics and registry for singularity containers</article-title>
        <source>PLoS One</source>
        <volume>12</volume>
        <year>2017</year>
        <fpage>e0188511</fpage>
        <pub-id pub-id-type="pmid">29186161</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Tettelin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Masignani</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Cieslewicz</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Donati</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Medini</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Angiuoli</surname>
            <given-names>S.V.</given-names>
          </name>
          <name>
            <surname>Crabtree</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Durkin</surname>
            <given-names>A.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome analysis of multiple pathogenic isolates of <italic>Streptococcus agalactiae</italic>: implications for the microbial “pan-genome”</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <volume>102</volume>
        <year>2005</year>
        <fpage>13950</fpage>
        <lpage>13955</lpage>
        <pub-id pub-id-type="pmid">16172379</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lees</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>S.D.</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>S.D.W.</given-names>
          </name>
          <name>
            <surname>Corander</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>RhierBAPS: an R implementation of the population clustering algorithm hierBAPS</article-title>
        <source>Wellcome Open Res.</source>
        <volume>3</volume>
        <year>2018</year>
        <fpage>93</fpage>
        <pub-id pub-id-type="doi">10.12688/wellcomeopenres.14694.1</pub-id>
        <pub-id pub-id-type="pmid">30345380</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Tonkin-Hill</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>MacAlasdair</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Ruis</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Weimann</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Horesh</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lees</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Gladstone</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Beaudoin</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Floto</surname>
            <given-names>R.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Producing polished prokaryotic pangenomes with the Panaroo pipeline</article-title>
        <source>Genome Biol.</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>180</fpage>
        <pub-id pub-id-type="pmid">32698896</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Vernikos</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Medini</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Riley</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Tettelin</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pan-genome analyses</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <volume>23</volume>
        <year>2015</year>
        <fpage>148</fpage>
        <lpage>154</lpage>
        <pub-id pub-id-type="pmid">25483351</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>ggplot2</article-title>
        <source>WIREs Comput. Stat.</source>
        <volume>3</volume>
        <year>2011</year>
        <fpage>180</fpage>
        <lpage>185</lpage>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>E.S.</given-names>
          </name>
        </person-group>
        <article-title>DECIPHER: harnessing local sequence context to improve protein multiple sequence alignment</article-title>
        <source>BMC Bioinformatics</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>322</fpage>
        <pub-id pub-id-type="pmid">26445311</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Charlesworth</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Achtman</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Accurate reconstruction of bacterial pan- and core genomes with PEPPAN</article-title>
        <source>Genome Res.</source>
        <volume>30</volume>
        <year>2020</year>
        <fpage>1667</fpage>
        <lpage>1679</lpage>
        <pub-id pub-id-type="pmid">33055096</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0160">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1 and S2 and Table S1</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Document S2. Article plus supplemental information</title>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">
      <list list-type="simple" id="ulist0015">
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">Pagoo code has been deposited and is available at the Comprehensive R Archive Network (CRAN). Pagoo’s source code is also available at GitHub. We provide a Singularity (<xref rid="bib7" ref-type="bibr">Kurtzer et al., 2017</xref>) image with all dependencies needed to fully reproduce analyses using the two working dataset (<italic>C. fetus</italic> and <italic>E. coli</italic>), from downloading the data to generating the plots. The Singularity definition file along with the scripts are publicly available at GitHub. The prebuilt Singularity image is hosted at Singularity-hub (<xref rid="bib15" ref-type="bibr">Sochat et al., 2017</xref>).</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040">Any additional information required to reanalyze the data reported in this paper is available from the lead contact upon request.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0140">We thank Pablo Fresia, Daniela Costa, and Andrés Parada for insightful comments and suggestions during testing of Pagoo. I.F. is funded by grant ANII-POS_NAC_2018_1_151494 from the <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/100008725</institution-id><institution>Agencia Nacional de Investigación e Innovación</institution></institution-wrap></funding-source> (ANII), Uruguay. This work has been partially funded by the G4 Research Groups Program from <funding-source id="gs2">Institut Pasteur Montevideo</funding-source> and <funding-source id="gs3">Banco de Seguros del Estado (BSE)</funding-source> of Uruguay.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0145">G.I. and I.F. conceived the idea. I.F. developed the software and performed experiments. G.I. and I.F. wrote the manuscript.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0150">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0155">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.crmeth.2021.100085" id="intref0105">https://doi.org/10.1016/j.crmeth.2021.100085</ext-link>.</p>
    </fn>
  </fn-group>
</back>
