<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8548853</article-id>
    <article-id pub-id-type="publisher-id">2511</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02511-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SquiggleNet: real-time, direct classification of nanopore signals</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bao</surname>
          <given-names>Yuwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wadden</surname>
          <given-names>Jack</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Erb-Downward</surname>
          <given-names>John R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ranjan</surname>
          <given-names>Piyush</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Weichen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McDonald</surname>
          <given-names>Torrin L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mills</surname>
          <given-names>Ryan E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boyle</surname>
          <given-names>Alan P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dickson</surname>
          <given-names>Robert P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blaauw</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5869-2391</contrib-id>
        <name>
          <surname>Welch</surname>
          <given-names>Joshua D.</given-names>
        </name>
        <address>
          <email>welchjd@umich.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Electrical and Computer Engineering, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Division of Pulmonary and Critical Care Medicine, Department of Internal Medicine, </institution><institution>University of Michigan Medical School, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Computational Medicine and Bioinformatics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Human Genetics, </institution><institution>University of Michigan Medical, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Microbiology and Immunology, </institution><institution>University of Michigan Medical School, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Michigan Center for Integrative Research in Critical Care, </institution></institution-wrap>Ann Arbor, 48109 MI USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>298</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We present SquiggleNet, the first deep-learning model that can classify nanopore reads directly from their electrical signals. SquiggleNet operates faster than DNA passes through the pore, allowing real-time classification and read ejection. Using 1 s of sequencing data, the classifier achieves significantly higher accuracy than base calling followed by sequence alignment. Our approach is also faster and requires an order of magnitude less memory than alignment-based approaches. SquiggleNet distinguished human from bacterial DNA with over 90% accuracy, generalized to unseen bacterial species in a human respiratory meta genome sample, and accurately classified sequences containing human long interspersed repeat elements.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13059-021-02511-y).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deep learning</kwd>
      <kwd>Read-until</kwd>
      <kwd>Oxford Nanopore</kwd>
      <kwd>Raw signal</kwd>
      <kwd>Real-time</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21AI137669</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>national human genome research institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21HG011493</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>national human genome research institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG010883</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL144599</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec2">
    <title>Background</title>
    <p>Oxford Nanopore sequencers, such as MinION or PromethION, determine the nucleotide sequence of a DNA or RNA molecule by measuring changes in electrical current (called “squiggles”) as the molecule translocates through a protein nanopore. This approach is fundamentally different from the widely-used Illumina platform and provides several benefits: the MinION is small, fast, and portable, making it ideal for rapid diagnostics and field work. Because it does not rely upon synchronized nucleotide addition (the heart of the Illumina sequencing-by-synthesis technology), MinION also produces much longer reads. To our knowledge, the longest published MinION read is around 2 Mbp [<xref ref-type="bibr" rid="CR1">1</xref>], though even longer reads have been reported anecdotally. The changes in electrical current induced by a DNA or RNA molecule depend on the specific chemical properties of the nucleotides, including secondary structure interactions and epigenomic modifications such as methylation. Additionally, the nanopore sequencer can stream the squiggle data to a computer in real time.</p>
    <p>The nanopore sequencer can also eject a partially sequenced molecule, a capability referred to as “Read-Until”. In principle, this enables targeted sequencing without the need for biochemical enrichment. The Read-Until capability allows selective sequencing of molecules by reversing the voltage across individually selected nanopores, ejecting the unwanted molecules. The unoccupied nanopores can then sequence different molecules of interest.</p>
    <p>Such computational enrichment of target sequences holds great promise for clinical diagnostics and field research, but realizing this potential requires fast and accurate approaches for identifying molecules of interest. For example, identifying pathogenic DNA in a patient lung fluid sample requires bypassing human DNA—which often represents &gt; 99<italic>%</italic> of the sequences—to find the pathogen sequences. Biochemical methods for target sequence enrichment, such as PCR [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>], hybrid capture [<xref ref-type="bibr" rid="CR6">6</xref>], or CRISPR/Cas9 enrichment [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] require much more time, expertise, and equipment. In contrast, a computational approach to enriching target sequences provides clear savings of time, labor, and cost.</p>
    <p>Previous computational approaches for this problem include (a) perform standard base calling followed by sequence alignment as in [<xref ref-type="bibr" rid="CR9">9</xref>] and (b) perform rough base calling to identify and align <italic>k</italic>-mers [<xref ref-type="bibr" rid="CR10">10</xref>]. The first approach requires significant computing resources—such as a graphics processing unit (GPU) and a large genome index database for the sequence aligner. The second approach also requires a large genome index and multiple CPU cores and can map only non-repetitive references smaller than ∼ 100 Mbp. Both approaches are based on sequence alignment and thus are limited by sequencing errors, their reliance on genome indexes, and their inability to capture non-sequence information such as DNA methylation.</p>
    <p>To address these limitations, we developed SquiggleNet, the first deep-learning-based approach for classifying DNA sequences directly from electrical signals. SquiggleNet is fast, accurate, memory-efficient, and robust to unknown species. It requires only 3000 signals—less than the amount of data generated in one second of sequencing—to classify the species of a DNA molecule with over 90% accuracy, significantly higher than the best alignment-based methods. The model requires only 304 KB of RAM and no external reference database. SquiggleNet is faster than or on par with the competitors and can run in real time on a single core of a standard laptop. When tested on a human respiratory metagenome sample with a majority of unseen species, our approach achieves &gt; 90<italic>%</italic> overall accuracy.</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results</title>
    <sec id="Sec4">
      <title>SquiggleNet: a convolutional neural network for classifying nanopore signals</title>
      <p>SquiggleNet is a deep neural network that classifies molecules of interest based on statistical patterns in nanopore conductivity, which are often hard for humans to identify by eye, automatically extracted from the input data. The overall workflow for using SquiggleNet to enrich sequences of interest is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. The network is first trained to recognize certain classes of sequences, such as human vs. bacterial DNA, using labeled examples. Then, as the nanopore sequencer generates raw electrical signals from a new and unseen sample, SquiggleNet rapidly classifies each molecule to determine whether it is a sequence of interest. Molecules not of interest are ejected from the nanopore, freeing the pore to sequence a different molecule. In contrast, targeted molecules are sequenced to full length and used for downstream analysis.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Read-until pipeline overview. <bold>a</bold> A DNA molecule translocates through a nanopore, generating electric signals (squiggles). SquiggleNet rapidly classifies the molecule to determine whether it is a sequence of interest. If the molecule is accepted by the classifier, it is sequenced to full length. Otherwise, the molecule is ejected from the pore, freeing the pore to sequence another molecule. <bold>b</bold> SquiggleNet employs 1D-ResNet-styled bottleneck blocks with increasing numbers of filters. Average pooling and a final fully connected layer are performed after the last convolutional block</p></caption><graphic xlink:href="13059_2021_2511_Fig1_HTML" id="MO1"/></fig></p>
      <p>SquiggleNet (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) employs a convolutional architecture, using residual blocks modified from ResNet [<xref ref-type="bibr" rid="CR11">11</xref>] to perform one-dimensional (time-domain) convolution over squiggles. The architecture consists of four blocks with increasing numbers of channels; each block includes two 1D-ResNet Bottleneck units. Mean pooling followed by a fully-connected layer with softmax activation allows SquiggleNet to classify sequences based on the convolutional filters in the last ResNet block. The final output is a conditional probability on the sequence labels, which is then used to make the final class prediction. We experimented with several other approaches, including a recurrent neural network (RNN) with long short-term memory (LSTM) blocks; gated recurrent units (GRUs); other types of convolutional blocks; a combination of RNN and convolution; different convolutional window sizes; and differing model hyperparameters. However, we found that approaches based on convolution outperformed models using LSTM blocks, suggesting that local features are sufficient for this problem, and long-range time-dependent relationships do not add much information. Convolutional architectures without LSTM blocks are also faster to train. Our final architecture gave the best classification accuracy of any approach we tried and could not be made significantly smaller without sacrificing performance. Additional details about the model architecture and hyperparameter choices can be found in the Method section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Overall performance across five test datasets: accuracy, true positive rate (TPR, RECALL), true negative rate (TNR), precision, and the AUROC score of the model trained on the HeLa&amp;Zymo training set, and tested on five test sets with bacterial sequences as the target</p></caption><graphic xlink:href="13059_2021_2511_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>SquiggleNet accurately classifies species directly from squiggles</title>
      <p>To test the performance of SquiggleNet, we generated four experimental datasets containing a mixture of human and bacterial DNA. The first dataset, HeLa&amp;Zymo, contains 8 bacterial species from the Zymo mixture [<xref ref-type="bibr" rid="CR12">12</xref>] and HeLa cells. The species labels were obtained through Minimap2 [<xref ref-type="bibr" rid="CR13">13</xref>] alignment. The other three datasets (Human&amp;Zymo_b12, Human&amp;Zymo_b34, and Human&amp;Zymo_b56) contain a mixture of human GM12878 DNA and DNA from Zymo High Molecular Weight mixture with 7 bacterial species [<xref ref-type="bibr" rid="CR14">14</xref>]. To avoid systematic error from the alignment algorithms, we obtained reliable ground-truth species labels for these three datasets by attaching a nucleotide sequence barcode to each DNA molecule indicating whether the molecule is from human or bacteria. Note that our direct biochemical labeling strategy allows us to independently assess the accuracy of species determination from base calling followed by read alignment; this is important for our application, since we expect that SquiggleNet may be able to outperform purely sequence-based approaches by leveraging other information from the electrical signals. Further dataset details can be found in the Method section and Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p>We trained SquiggleNet using more than two million reads from the first dataset (HeLa&amp;Zymo), which contains equal proportions of HeLa and bacterial sequences. We used 3000 signals from each read, the equivalent of about 300 nucleotides. We discarded the first 1500 signals of each read (an overestimation of the adapter length), to remove potential pore noise and adapter sequences, which could confound training. Thus SquiggleNet requires a total of 4500 signals, which is equivalent to about 1 second of sequencing time. (The exact time and number of nucleotides depends on the translocation speed, which varies per pore and molecule over the course of the sequencing experiment.) However, using this exact amount of signal is not crucial; we verified that using fewer signals did not significantly change the results (see below). Our best-performing model was trained on the HeLa&amp;Zymo dataset, which contains the largest number of sequenced reads. This dataset also lacks species-specific barcodes, and we were careful to remove the sequencing adapters and species barcodes before extracting the 3000 signals used for classification (Methods). Thus, there is no way that the classifier could “cheat” by using the barcodes to classify the species. When we instead trained the model on the Human&amp;Zymo datasets and tested on HeLa&amp;Zymo, the model accuracy was nearly identical but slightly lower, possibly due to the smaller number of training samples (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
      <p>Overall, the model classifies each molecule as bacterial or human with over 90% accuracy across different test datasets using only 3000 signals per read (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The classifier generalizes well to different lab preparations, flow cells and proportions of species. For the first three datasets (HeLa&amp;Zymo, Human&amp;Zymo_b12, Human&amp;Zymo_b34), the true positive rates (TPR, also Recall) and the true negative rates (TNR) are all above or around 90%. The precision and AUROC scores are all about 90% as well. Even for samples with significantly more human than bacterial DNA (Human&amp;Zymo_b56 and Respiratory Metagenome), the accuracy and recall both remain high.</p>
      <p>We used the method of integrated gradients (IG) [<xref ref-type="bibr" rid="CR15">15</xref>] to investigate the features influencing SquiggleNet’s classification decisions. The IG method computes the amount of gradient change for each corresponding input, and by doing so, offers interpretation on which part of the input contributes the most to the model’s decision. Inspecting these IG results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) shows that SquiggleNet predictions are most strongly influenced by positions where the signal changes direction, changes by a large amount, and/or changes from one nucleotide to another. This suggests that SquiggleNet has learned filters related to the nucleotide composition of the signal and uses the results to make classification decisions. Further details are contained in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p>To demonstrate that the results are robust to the amount of signal removed from the beginning of the read at test time, we also tested our pre-trained model on the Human&amp;Zymo_b34 dataset with only the first 1000 signals per read removed. We chose the number 1000 because this is a closer estimation of the adapter length [<xref ref-type="bibr" rid="CR16">16</xref>], and at test time, we would like to make the decision as soon as possible to enable real-time read selection. When testing the model on sequences with the first 1000 signals removed, the results were nearly identical to those obtained from conservatively removing 1500 signals: 89.35% accuracy, 90% true positive rate, and 86.9% true negative rate. Thus it appears that, as long as the initial pore noise, adaptors, and barcodes are removed from the training sequences, the model is able to make an accurate and fast decision at test time. This robustness also allows flexibility if, for example, different sequencing datasets use sequencing adapters of different lengths.</p>
      <p>Remarkably, we find that SquiggleNet achieves significantly higher accuracy from 3000 signals than base calling followed by sequence alignment using the same amount of signal. This result gives crucial context for interpreting the accuracy of our model and suggests that the convolutional filters may detect some non-sequence features that help with species classification, such as chemical modification of nucleotides by methylation. Indeed, we found that the bacterial and human DNA sequences in our dataset show significant methylation differences, with significantly more methylated cytosines in human sequences and significantly more methylated adenines in bacterial sequences (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 for details).</p>
      <p>For the Human&amp;Zymob_56 dataset, the target to non-target sequence ratio is 1 to 99. The overall accuracy, TNR, and AUROC score are around 90%. The TPR (Recall) is closely following, above 87%. The precision, however, is about 1/10 of the other cases. This is due to the extremely low concentration of the target sequences (Zymo bacterial species), and the precision calculation is diluted by the overwhelming number of false positive reads. Nevertheless, this is acceptable, since we want to preserve as many targeted reads as possible (high recall) due to the low target read concentration. All true positives and false positives will be sequenced to full length, and thus can be further processed in the downstream analysis. Considering that the Human&amp;Zymo_b56 dataset has 99 × more non-targeted reads than targeted, whereas only ∼ 10× more reads were falsely identified as positive compared to the HeLa&amp;Zymo dataset, this model demonstrated strong ability to filter out non-targeted reads, and has high potential to improve throughput (see below). Overall, the model that was trained on only the HeLa&amp;Zymo dataset yields high performance across different testing datasets, highlighting the robustness of the model.</p>
      <p>Interestingly, SquiggleNet performance varies systematically across bacterial taxa. The network classifies human vs. bacterial DNA with 90% accuracy, but some bacterial species are easier to distinguish from human sequences than others. The eight bacterial species in the Zymo mixture are related according to the taxonomy tree shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The top three species—<italic>Pseudomonas aeruginosa</italic> (Pse), <italic>Salmonella enterica</italic> (Sal), and <italic>Escherichia coli</italic> (Esc)—are gram-negative bacteria and are most easy to identify, while the bottom five species are gram-positive bacteria and are harder to distinguish from human DNA. It is not clear what specific features of the gram-negative bacteria make them easier to identify, but this behavior may be related to species differences in GC-content or the amount of methylation.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Taxonomy tree and accuracy per species. Taxonomy tree for the eight species in our dataset grouped in color and their corresponding accuracy breakdown per species. The accuracy for distinguishing bacterial sequences from human was highest for the red branch, intermediate for the blue group, and lowest for the brown group</p></caption><graphic xlink:href="13059_2021_2511_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>SquiggleNet identifies species not seen during training</title>
      <p>In real-world applications, samples may contain species whose genomes are not in the training samples. We thus investigated whether the model can identify unseen species. To do this, we performed a leave-one-out analysis, removing each of the bacterial species separately during training, then putting it back during testing to challenge SquiggleNet’s generalization ability. For the held-out species comparisons, we used 400k and 20k reads from the HeLa&amp;Zymo dataset for training and testing, respectively.</p>
      <p>During each training run, we removed one of the eight Zymo bacterial species from the training dataset. We then compared the test accuracy from the classifier trained on seven bacterial species plus human with the performance of the same model on two different testing sets containing the eighth held-out species. The dataset we call Test-Uniform/HeLa includes all eight species (including the one held out during training), evenly distributed, and balanced to contain equal numbers of HeLa and bacterial molecules. The dataset we refer to as Test-One/HeLa includes only the single held-out species and HeLa, in equal proportions.</p>
      <p>The unknown species identification results can be found in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The red bars are the test accuracy results without held-out species. The left-most column is the performance of a training run with all 8 bacterial species as a reference for cross-testing run performance comparison.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance of SquiggleNet on unseen species. Each column (except “All”) is a model trained on a Zymo/HeLa 1:1 mix without the held-out species. For each species, the red bar shows the test accuracy on all species minus the held-out species; this number provides a baseline against which to compare performance on the held-out species. Blue bars show the accuracy of each trained model on Test-Uniform/HeLa, a test set with all eight Zymo bacterial species included and HeLa in a 1:1 ratio. Brown bars show the accuracy of each model on Test-One/HeLa, a test set with only the single unseen species and HeLa in a 1:1 ratio</p></caption><graphic xlink:href="13059_2021_2511_Fig4_HTML" id="MO4"/></fig></p>
      <p>Across different runs, the test accuracies, not including held-out species, are around 84–86%. For each Test-Uniform/HeLa experiment, accuracy of classifying the held-out species was ∼ 83–85%, only about 1% lower compared to when the species was seen during training. This shows that the model was able to accurately identify sequences from bacterial species that were not seen during training. For the Test-One/HeLa experiment, the test performance is more influenced by the taxonomic position of the held-out species. Since the testing datasets only include human DNA and the one species that was held out, we expected performance to drop even more than the previous Test-Uniform/HeLa experiment. However, the test accuracies of the first three gram-negative bacterial species, <italic>Pseudomonas aeruginosa</italic> (Pse), <italic>Salmonella enterica</italic> (Sal), and <italic>Escherichia coli</italic> (Esc) actually increased by ∼ 1–4% compared to their validation accuracies. The remaining four gram-positive species had a minor performance increase or drop within 4%. <italic>Staphylococcus aureus</italic> had the largest performance drop among all, but the accuracy was still above 75%.</p>
      <p>In summary, these two sets of experiments show that even when one species was not seen during training time, SquiggleNet was still able to identify it with high confidence.</p>
    </sec>
    <sec id="Sec7">
      <title>SquiggleNet identifies bacterial DNA in a human respiratory metagenome sample</title>
      <p>To further test the generalizability and practicality of SquiggleNet, we tested the best performing model (trained on the Hela&amp;Zymo dataset) on a dataset collected from several clinical human samples. We collected the data following the procedures in [<xref ref-type="bibr" rid="CR17">17</xref>]. The ground-truth labels were obtained using our previously published read alignment pipeline[<xref ref-type="bibr" rid="CR18">18</xref>]. The dataset includes 324,526 human reads and 341 bacteria and other (less than 0.6%), a human:bacterial ratio of 951:1. Some of the dominant bacteria groups include <italic>Prevotella</italic> (29%), <italic>Neisseria</italic> (20%), and <italic>Rothia</italic> (11%). However, less than 3% of the bacterial species overlap with the training dataset. The full taxonomic composition can be found in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and [<xref ref-type="bibr" rid="CR17">17</xref>].
<fig id="Fig5"><label>Fig. 5</label><caption><p>SquiggleNet accuracy by species in human respiratory metagenome sample[<xref ref-type="bibr" rid="CR19">19</xref>]. Some of the dominant bacterial groups include <italic>Neisseria</italic> (23%), <italic>Bacteriodales</italic> (21%), and <italic>Firmicutes</italic> (20%). Less than 3% of the bacterial species overlap with the training dataset</p></caption><graphic xlink:href="13059_2021_2511_Fig5_HTML" id="MO5"/></fig></p>
      <p>Even though the model was trained on dataset Hela&amp;Zymo, it achieved 90.8% overall accuracy in the Respiratory Metagenome dataset, 72.5% true positive rate, and 90.9% true negative rate (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The AUROC score is 0.817. The precision is about 1/5 of that in dataset Human&amp;Zymo_b56. As with the unbalanced Human&amp;Zymo dataset, the precision is diluted by the extremely low concentration of bacteria, but the model still achieves high recall—which is critical to retrieve all the bacterial reads for downstream analysis.</p>
      <p>The Zymo community of the dataset on which the model was trained has very little overlap (&lt; 3<italic>%</italic>) with the bacterial species found in the Respiratory Metagenome dataset. The genome information in this testing dataset was mostly unseen and unknown for the trained model. However, it still achieved a true positive rate of 72.5%. This shows that SquiggleNet is able to extract common bacterial genome features and distinguish them from the human genome sequencing raw signals. The generalizability of SquiggleNet significantly increases the potential applications of our method. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, different species were classified with different accuracy. The model is therefore, expected to be even more accurate if it can be fine-tuned in a dataset with closer range of species.</p>
    </sec>
    <sec id="Sec8">
      <title>SquiggleNet is more accurate and efficient than previous approaches</title>
      <p>We next compared the performance and efficiency of SquiggleNet against the current state-of-the-art methods: Guppy+Minimap2 and UNCALLED. This experiment was conducted on dataset Human&amp;Zymo_b34 with 1:4 Human and Zymo mix. All the analysis was done on a single-usage Intel(R) Xeon(R) CPU E5-2697 v3 @ 2.60GHz machine with a single TITAN Xp GPU.</p>
      <p>We benchmarked the running time required to classify 712,000 reads (178 fast5 files with 4000 sequences each and 3000 signals per read, adapters and barcodes removed). SquiggleNet took 806.74 s (13 min 27 s) to finish processing all on GPU (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). When tested on a 3.5-GHz Dual-Core Intel Core i7 Macbook Pro, SquiggleNet finished processing all the files in 2630.58 s (43 min 51 s). With the Guppy+Minimap2 method [<xref ref-type="bibr" rid="CR9">9</xref>], sequences were base called using Guppy [<xref ref-type="bibr" rid="CR20">20</xref>] with 4 callers and 4 runners/GPU, and we used 32 threads for sequence alignment with Minimap2 [<xref ref-type="bibr" rid="CR13">13</xref>]. It took 742.602 s (12 min 23 s) for Guppy to finish base calling 3000 signals and another 25.673 s for Minimap2 to finish the alignment, about the same amount of time as SquiggleNet. The accuracy of Guppy+Minimap2, however, was 79%, more than 10% lower than SquiggleNet. Using the full length of the input sequence increased the accuracy of Guppy+Minimap2 to 91%, but the processing time increased dramatically. With UNCALLED, 32 threads were used to process 3000 signals, 6000 signals, and full-length reads respectively. It took at least 1277.28 seconds (21 min 17 s) to finish the 3000 signals, but the accuracy was below 50%. With longer input length, the accuracy increased to 60% (82% for full-length), but the full length accuracy was still lower than SquiggleNet with 3000 signals. Meanwhile, the processing time grows drastically as well. SquiggleNet is, therefore, faster and more accurate than either Guppy+Minimap2 or UNCALLED.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Processing time and accuracy comparison. The processing time of SquiggleNet with 300 bp of input is among the lowest, and yet the accuracy is the highest among the three methods. For the other two alignment-based methods, with longer input length, the processing time grows drastically, whereas the accuracy gain is limited</p></caption><graphic xlink:href="13059_2021_2511_Fig6_HTML" id="MO6"/></fig></p>
      <p>Note that the accuracy values that we report take into account all reads, including those that Minimap2 could not align. In contrast, the UNCALLED paper reported that the method was able to recover 94% of the alignments identified by Minimap2, but this number does not take into account the reads that Minimap2 failed to align. Crucially, our datasets have molecular barcodes, allowing us to determine the true species even for reads that Minimap2 failed to align. Furthermore, the 94% accuracy reported by the UNCALLED paper is based on using the entire sequence, whereas we only used significantly less information (3000 signals) to classify the reads.</p>
      <p>We also observed that over 90% of the SquiggleNet processing time on GPU and over 40% of the processing time on CPU is spent on loading data from the disk. The actual classification time for a batch of 500 reads is about 0.06 seconds on GPU and about 0.8 seconds on CPU (one thread). When streaming directly from the nanopore sequencer in real time, this loading time can be significantly reduced.</p>
      <p>SquiggleNet also offers significant advantages in terms of space requirements (Table <xref rid="Tab1" ref-type="table">1</xref>), requiring only 304 KB to store the model parameters. The run-time space usage is dominated by the storage required for each mini-batch of sequences, rather than the model parameters. Guppy, however, is a much larger deep-learning model, and the smallest pre-trained option available through Oxford Nanopore Community [<xref ref-type="bibr" rid="CR20">20</xref>] is 5.5MB. On top of that, however, the Guppy+Minimap2 method also requires a customized database for Minimap2 reference. In this experiment, the human and Zymo reference database takes 3.2GB. UNCALLED is currently operational only on CPU. Similarly, it also takes a reference database to build a Burrows-Wheeler index, which is an extra 3.2 GB in this experiment. Therefore, SquiggleNet requires much less space than the other two methods.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Method requirement comparison</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">SquiggleNet</th><th align="left">SquiggleNet</th><th align="left">Guppy+Minimap2</th><th align="left">UNCALLED</th></tr></thead><tbody><tr><td align="left">Equipment (<italic>t</italic> = thread)</td><td align="left">GPU</td><td align="left">CPU (<italic>t</italic> = 1)</td><td align="left">GPU+CPU (<italic>t</italic> = 32)</td><td align="left">CPU (<italic>t</italic> = 32)</td></tr><tr><td align="left">Space requirement <italic>↓</italic></td><td align="left"><bold>≤ GPU Max</bold></td><td align="left"><bold>≤ Mem Max</bold></td><td align="left">≤ GPU Max + 3.2GB</td><td align="left">≤ Mem Max + 3.2GB</td></tr><tr><td align="left">Model size <italic>↓</italic></td><td align="left"><bold>304 KB</bold></td><td align="left"><bold>304 KB</bold></td><td align="left">5.5/40/116 MB</td><td align="left"/></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec9">
      <title>SquiggleNet identifies reads containing human long interspersed repeat elements</title>
      <p>Classifying species is useful for many applications, but distinguishing among different loci from the same species would significantly expand the settings in which SquiggleNet can be applied. To investigate whether SquiggleNet can be used to enrich loci of interest within a single species, we analyzed data from a recently published protocol [<xref ref-type="bibr" rid="CR21">21</xref>] that enriches specific families of interspersed repeat elements using Cas9-directed adapter ligation (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). This experimental enrichment is effective, but still fewer than 50% of reads contain the repeats of interest [<xref ref-type="bibr" rid="CR21">21</xref>]. As previously described [<xref ref-type="bibr" rid="CR22">22</xref>], we used BLASTn [<xref ref-type="bibr" rid="CR23">23</xref>] on the base-called sequence of each read to label the reads as target (repeat-containing) or non-target (no repeat). We focused specifically on a single class of interspersed repeats, human-specific long interspersed elements (L1Hs), which was the family most effectively enriched by the Cas9-directed ligation protocol. Using these labels, we trained SquiggleNet on a balanced dataset containing approximately 170,000 reads from each class. Note that this is about tenfold less training data than we used in the human vs. bacterial classification experiments above. As with the species classification experiments, we discarded the first 1500 signals from each read, then used the next 3000 for training or testing. Despite the smaller training dataset, we found that SquiggleNet was extremely effective at identifying reads containing L1Hs elements (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b, c). Our model achieved more than 92% accuracy with a true positive rate above 93%. These results indicate that using SquiggleNet in a read-until setting to enrich long interspersed repeats would provide a significant benefit compared to Cas9 enrichment only.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Identifying reads containing human long interspersed repeat elements. <bold>a</bold> Diagram of experimental strategy for enriching human mobile elements, including interspersed repeats. A guide RNA specific to each repeat class directs Cas9 to cut the DNA and ligate a sequencing adapter. However, adapters are also ligated to some sequences without repeat elements. Subsequent nanopore sequencing produces both target and non-target reads. <bold>b</bold> Pie charts of the proportion of L1Hs repeat elements from Cas9 enrichment only vs. SquiggleNet classification. <bold>c</bold> Classification metrics demonstrating SquiggleNet’s ability to distinguish reads with or without L1Hs repeats</p></caption><graphic xlink:href="13059_2021_2511_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>SquiggleNet improves throughput by enabling computationally targeted sequencing</title>
      <p>To assess the potential improvement in sequencing throughput that SquiggleNet could provide, we developed a mathematical model to compare the total number of base pairs and total sequencing time needed to obtain a certain number of targeted sequences with and without SquiggleNet.</p>
      <p>The detailed derivation of the model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The most influential hyper-parameters include average target sequence length <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {z}$\end{document}</tex-math><mml:math id="M2"><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2021_2511_Article_IEq1.gif"/></alternatives></inline-formula>, average non-target sequence length <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {h}$\end{document}</tex-math><mml:math id="M4"><mml:mover accent="true"><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2021_2511_Article_IEq2.gif"/></alternatives></inline-formula>, and target sequence concentration <italic>c</italic>. Several other tunable hyper-parameters, including the waiting time to eject one molecule and begin sequencing another; the total number of active pores in a flow cell; the sequencing speed; and the total number of targeted sequences, did not significantly influence the predicted increase in throughput (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We chose the values for these less influential parameters based on the empirical time requirements and accuracy of SquiggleNet and the sample means from the real sequencing data.</p>
      <p>In Fig. <xref rid="Fig8" ref-type="fig">8</xref>, we picked the average non-target/target sequence length ratio as one axis, and the target sequence concentration as the other axis to demonstrate the total number of base pairs (left) and total sequencing time (right) that a regular nanopore sequencing pipeline would require, compared to those of a pipeline with SquiggleNet, in order to obtain a fixed number of targeted reads. Based on the properties of our sequencing datasets, we set average sequencing speed to be 450 base pairs per second and the total number of active pores in a flow cell to be 500. We also used the following parameters based on SquiggleNet’s empirical performance: TPR = 0.9, TNR = 0.9, sequencing time = 1s, and classification decision time = 0.8 s (time required for SquiggleNet on CPU).
<fig id="Fig8"><label>Fig. 8</label><caption><p>Throughput and sequencing time comparison without/with read-until. When the average non-target read length is about 20 times longer than the target read length, and sample contains over 90% non-target reads, a normal sequencing pipeline would have to sequence ∼ 10 times more base pairs (left) than Read-Until pipeline with SquiggleNet to achieve a fixed number of targeted reads. The ratio is about 10 for the required sequencing time as well (right)</p></caption><graphic xlink:href="13059_2021_2511_Fig8_HTML" id="MO8"/></fig></p>
      <p>We show the predicted gains in throughput and sequencing time for a range of the most important hyperparameters (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). When the average non-target read length is about 20 times longer than the target read length, and the sample contains over 90% non-target sequences, it would take a nanopore sequencing pipeline ∼ 10 times longer than Read-Until pipeline with SquiggleNet to achieve a fixed number of targeted reads. The regular nanopore sequencing pipeline would also have to sequence ∼ 10 times more base pairs than the Read-Until pipeline. Even if we set these parameters much more pessimistically, the model still predicts about a 5-fold gain in throughput and time. These numbers are also in the same ballpark as the 4.5 × enrichment reported in the UNCALLED paper [<xref ref-type="bibr" rid="CR10">10</xref>], supporting the plausibility of our mathematical model. We therefore conclude that Read-Until with SquiggleNet holds great promise to improve target read throughput, saving sequencing time and resources.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p>The success of our approach suggests that the raw sequencing signals generated by nanopore sequencing contain rich information for identifying target sequences from background sequences. Such features could include different DNA modification patterns, codon frequencies, GC content, or even DNA shape or RNA secondary structure. Furthermore, because these features are primarily local in nature, only a small amount of sequencing signal is required. In contrast, approaches that rely on sequence information alone require much more signal (more sequencing time), are susceptible to base-calling errors, and do not leverage non-sequence information.</p>
    <p>We also note that different reads go through the pores at different speeds. Future work could also include an event detector and a scaler into the classifier, which may further improve performance. Additionally, the squiggles from different MinION flow cells show systematic run-to-run differences. Thus, the data preprocessing and normalization procedures that we employed are crucial for generalizing across datasets.</p>
    <p>We tested the capability of our model to enrich bacterial DNA in the presence of more abundant human DNA. Human and bacterial DNA are significantly different, which makes this classification task feasible. We also demonstrated that SquiggleNet can identify target sequences in other contexts, such as interspersed repeat elements within the human genome. This suggests that SquiggleNet could be used for targeted enrichment of other genomic loci, such as commonly mutated cancer genes or regions that are highly polymorphic across the human population. We also anticipate that SquiggleNet will be useful for distinguishing viral DNA or RNA sequences from host molecules within infected cells. Rapidly identifying targeted sequences could be helpful in numerous clinical settings, including cancer diagnosis, respiratory pathogen identification, and coronavirus testing.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Data collection</title>
      <p>We generated five datasets using a MinION sequencer (Table <xref rid="Tab2" ref-type="table">2</xref>) for this paper. The first four datasets used the standard Rapid Sequencing Kit (SQK-RAD004) protocol on a FLO-106D MinION Flow Cell. The HeLa&amp;Zymo dataset used the ZymoBIOMICS Microbial Community DNA Standard, and datasets 2–4 used the ZymoBIOMICS HMW DNA Standard with different barcodes specified in Table <xref rid="Tab2" ref-type="table">2</xref>. Details about the dataset composition can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The Respiratory Metagenome data collection method can be found in [<xref ref-type="bibr" rid="CR17">17</xref>].
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Datasets description</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Name</th><th align="left">Ratio</th><th align="left">Train</th><th align="left">Validation</th><th align="left">Test</th><th align="left">Note</th></tr></thead><tbody><tr><td align="left">HeLa&amp;Zymo</td><td align="left">1:1</td><td align="left">2.4M</td><td align="left">40k</td><td align="left">54k</td><td align="left"/></tr><tr><td align="left">Human&amp;Zymo_b12</td><td align="left">1:1</td><td align="left">1.72M</td><td align="left">40k</td><td align="left">44k</td><td align="left">Barcode 1 and 2</td></tr><tr><td align="left">Human&amp;Zymo_b34</td><td align="left">1:4</td><td align="left"/><td align="left"/><td align="left">224k</td><td align="left">Barcode 3 and 4</td></tr><tr><td align="left">Human&amp;Zymo_b56</td><td align="left">99:1</td><td align="left"/><td align="left"/><td align="left">100k</td><td align="left">Barcode 5 and 6</td></tr><tr><td align="left">Respiratory Metagenome</td><td align="left">951:1</td><td align="left"/><td align="left"/><td align="left">324,867</td><td align="left">Real patient samples</td></tr></tbody></table></table-wrap></p>
      <p>Because base calling and sequence alignment of noisy nanopore reads can result in systematic errors and is not a completely reliable source of ground truth, we used barcodes to label the sequences in the three Human&amp;Zymo datasets as either bacteria or human before mixing them together. The labels obtained in this way thus represent reliable ground truth.</p>
      <p>Each extracted signal read was normalized with fast5 scaling and offset. All reads were also normalized using <italic>Z</italic>-scored median absolute deviation. The extreme signal values with a modified <italic>z</italic>-score larger than 3.5 were replaced by the average of closest neighbors.</p>
    </sec>
    <sec id="Sec14">
      <title>Model architecture</title>
      <p>SquiggleNet is a 1D-ResNet-based binary classifier (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The first layer of 1D-CNN is comparable to the first layer of Guppy[<xref ref-type="bibr" rid="CR20">20</xref>], but with significantly fewer channels (20 instead of 512). After that, there are four layers of 1D-ResNet, and each layer includes two BottleNeck blocks. The number of channels for each layer increases by a factor of 1.5, and each BottleNeck block decreases the string size with a stride of 2. We perform average pooling after the final convolutional layer, followed by a fully connected layer. We also experimented with other architectures (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>Training and evaluation</title>
      <p>Our best-performing model was trained on the HeLa&amp;Zymo dataset with binary cross-entropy loss. The dataset was split into training, validation, and testing sets. The Human&amp;Zymo_b12, Human&amp;Zymo_b34, Human&amp;Zymo_b56, and Respiratory Metagenome datasets were used to assemble testing sets for the best-performing model.</p>
      <p>As a separate analysis, we also trained on the Human&amp;Zymo datasets and tested on the HeLa&amp;Zymo datasets. The performance of this model was nearly identical but slightly worse than the model trained on HeLa&amp;Zymo (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details).</p>
      <p>The Adam optimizer was used for over 6 epochs on each dataset, with a learning rate of 1e-3 and batch size of 1000. The model was initialized using Kaiming initialization in fan-out mode. Batch normalization was conducted within each Bottleneck block.</p>
      <p>For the human interspersed repeat analysis, we used a balanced training dataset with equal numbers of reads that contained and did not contain an L1Hs element (about 170,000 reads each). We identified L1Hs elements using BLAST on the base-called reads with an <italic>e</italic>-value cutoff of 1×10<sup>−5</sup>, as previously described [<xref ref-type="bibr" rid="CR21">21</xref>]. We trained for 3 epochs using the Adam optimizer. Evaluation metrics include overall accuracy, true positive rate (TPR, Recall), true negative rate (TNR), Precision, and area under receiver operating characteristic curve (AUROC) when running the model on different test datasets. Speed and memory comparisons were performed on the same Intel(R) Xeon(R) CPU E5-2697 v3 @ 2.60 GHz machine with a single TITAN Xp GPU.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2511_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplement. Details on data collection, model parameters, hyperparameter tuning, details on the efficiency comparison experiment method, details on the theoretical throughput estimation model are included in the Supplement. Additional experiment results, including DNA methylation, model interpretation, model performance trained on a different dataset, model performance on different test dataset composition ratio and on odd/even chromosomes, are also presented in the Supplement [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR28">28</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2511_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the CELab, including Satish Narayanasamy, Reetu Das, and Prof. Jenna Wiens for their helpful suggestions and advice during this project.</p>
    <sec id="d32e1139">
      <title>Peer review information</title>
      <p>Anahita Bishop was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="d32e1144">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <sec id="FPar1">
      <title>Authors’ contributions</title>
      <p>YB and JDW conceived the idea of SquiggleNet. YB designed and implemented the model and analyzed the data. JW generated datasets 1 to 4. JRE, PR, and RPD provided the human-pathogen dataset and generated Fig. <xref rid="Fig5" ref-type="fig">5</xref>. YB and JDW wrote the paper. JRE and DB offered suggestions and advice. TM, WZ, RM, and AB generated and annotated the Cas9 enrichment dataset. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Authors’ information</title>
      <p>Twitter: @baobaoyaobaobao (Yuwei Bao); @LabWelch (Joshua D. Welch).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The authors wish to acknowledge support from NIH grants R01HG010883 (JW), R21HG011493 (AB and RM), and R01HL144599 and R21AI137669 (RD).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>We have uploaded our data to SRA (SRP296988) [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The human metagenome dataset has been previously published in [<xref ref-type="bibr" rid="CR17">17</xref>]. The Cas9 enrichment dataset is previously published and available on the SRA (BioProject accession PRJNA699027)[<xref ref-type="bibr" rid="CR21">21</xref>]. The code is available at a DOI-assigning repository Zenodo (10.5281/zenodo.4728278) and under the MIT license in our Github repository [<xref ref-type="bibr" rid="CR31">31</xref>]: <ext-link ext-link-type="uri" xlink:href="https://github.com/welch-lab/SquiggleNet">https://github.com/welch-lab/SquiggleNet</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>No ethical approval was necessary for this study.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <mixed-citation publication-type="other">Oxford Nanopore: Minion. <ext-link ext-link-type="uri" xlink:href="https://nanoporetech.com/products/minion">https://nanoporetech.com/products/minion</ext-link>. Accessed 10 Sept 2019.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rogov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>LeProust</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Solution hybrid selection with ultra-long oligonucleotides for massively parallel targeted sequencing</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>182</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1523</pub-id>
        <pub-id pub-id-type="pmid">19182786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Armisen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Slatko</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>Overview of Target Enrichment Strategies</article-title>
        <source>Curr Protoc Mol Biol</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7.21.1</fpage>
        <lpage>7.21.23</lpage>
        <pub-id pub-id-type="doi">10.1002/0471142727.mb0721s112</pub-id>
        <pub-id pub-id-type="pmid">26423591</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rand</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Musselman-Brown</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Mapping dna methylation with high-throughput nanopore sequencing</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>411</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4189</pub-id>
        <pub-id pub-id-type="pmid">28218897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Workman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Zuzarte</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dursi</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Detecting dna cytosine methylation using nanopore sequencing</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>407</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4184</pub-id>
        <pub-id pub-id-type="pmid">28218898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charalampous</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aydin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baldan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jeanes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rae</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grundy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Wain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leggett</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Livermore</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>O’Grady</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nanopore metagenomics enables rapid clinical diagnosis of bacterial lower respiratory infection</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>783</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0156-5</pub-id>
        <pub-id pub-id-type="pmid">31235920</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Gilpatrick T, Lee I, Graham JE, Raimondeau E, Bowen R, Heron A, Sedlazeck FJ, Timp W. Targeted nanopore sequencing with cas9 for studies of methylation, structural variants, and mutations. bioRxiv. 2019:604173. 10.1101/604173.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Retallack</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>DeRisi</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Depletion of abundant sequences by hybridization (dash): using cas9 to remove unwanted high-abundance species in sequencing libraries and molecular counting applications</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0904-5</pub-id>
        <pub-id pub-id-type="pmid">26944702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Payne A, Holmes N, Clarke T, Munro R, Debebe BJ, Loose M. Readfish Enables Targeted Nanopore Sequencing of Gigabase-sized Genomes. 10.1038/s41587-020-00746-x.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">Kovaka S, Fan Y, Ni B, Timp W, Schatz MC. Targeted Nanopore Sequencing by Real-time Mapping of Raw Electrical Signal with UNCALLED. 10.1038/s41587-020-0731-9.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep Residual Learning for Image Recognition. In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR): 2016.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">ZymoBIOMICS Microbial Community DNA Standard. <ext-link ext-link-type="uri" xlink:href="https://www.zymoresearch.com/collections/zymobiomics-microbial-community-standards/products/zymobiomics-microbial-community-dna-standard">https://www.zymoresearch.com/collections/zymobiomics-microbial-community-standards/products/zymobiomics-microbial-community-dna-standard</ext-link>. Accessed Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">ZymoBIOMICS HMW DNA Standard. https://www.zymoresearch.com/collections/zymobiomics-microbial-community-standards/ products/zymobiomics-hmw-dna-standard. Accessed Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sundararajan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taly</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Precup</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Teh</surname>
            <given-names>YW</given-names>
          </name>
        </person-group>
        <article-title>Axiomatic attribution for deep networks</article-title>
        <source>Proceedings of the 34th International Conference on Machine Learning. Proceedings of Machine Learning Research, vol. 70</source>
        <year>2017</year>
        <publisher-loc>Sydney</publisher-loc>
        <publisher-name>PMLR, International Convention Centre</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Oxford Nanopore Technologies ML. Real-Time Selective Sequencing on the MinION. Youtube. https://www.youtube.com/watch?v=34sWScdYyYQ&amp;t=303s&amp;ab_channel= OxfordNanoporeTechnologies. Accessed 8 Mar 2020.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Dwyer</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Ashley</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Gurczynski</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Falkowski</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Norman</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Huffnagle</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Salisbury</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Flaherty</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Martinez</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Erb-Downward</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Dickson</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>Lung microbiota contribute to pulmonary inflammation and disease progression in pulmonary fibrosis</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2019</year>
        <volume>199</volume>
        <issue>9</issue>
        <fpage>1127</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1164/rccm.201809-1650OC</pub-id>
        <pub-id pub-id-type="pmid">30789747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pendleton</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Erb-Downward</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Branton</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Falkowski</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Huffnagle</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Dickson</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>Rapid Pathogen Identification in Bacterial Pneumonia Using Real-Time Metagenomics</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2017</year>
        <volume>196</volume>
        <issue>12</issue>
        <fpage>1610</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1164/rccm.201703-0537LE</pub-id>
        <pub-id pub-id-type="pmid">28475350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Interactive metagenomic visualization in a web browser</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>385</issue>
        <fpage>1471</fpage>
        <lpage>2105</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Oxford Nanopore: Guppy. <ext-link ext-link-type="uri" xlink:href="https://community.nanoporetech.com/protocols/Guppy-protocol/v/GPB_2003_v1_revT_14Dec2018">https://community.nanoporetech.com/protocols/Guppy-protocol/v/GPB_2003_v1_revT_14Dec2018</ext-link>. Accessed 29 Feb 2020.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Mumm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Switzenberg</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Cas9 targeted enrichment of mobile elements using nanopore sequencing</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>3586</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23918-y</pub-id>
        <pub-id pub-id-type="pmid">34117247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Emery</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Flasch</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kidd</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of occult human-specific line-1 insertions using long-read sequencing technology</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>1146</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz1173</pub-id>
        <pub-id pub-id-type="pmid">31853540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A greedy algorithm for aligning dna sequences</article-title>
        <source>J Comput Biol</source>
        <year>2000</year>
        <volume>7</volume>
        <issue>1-2</issue>
        <fpage>203</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id>
        <pub-id pub-id-type="pmid">10890397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Oxford Nanopore: Barcoding Kits. <ext-link ext-link-type="uri" xlink:href="https://community.nanoporetech.com/technical_documents/chemistry-technical-document/v/chtd_500_v1_revw_07jul2016/barcoding-kits">https://community.nanoporetech.com/technical_documents/chemistry-technical-document/v/chtd_500_v1_revw_07jul2016/barcoding-kits</ext-link>. Accessed 25 Jan 2020.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Oxford Nanopore: Rapid Sequencing Kit Family. https://community.nanoporetech.com/technical_documents/chemistry-technical-document/v/chtd_500_v1_revw_07jul2016/rapid-sequencing-kit-family . Accessed 25 Jan 2020.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Kriman S, Beliaev S, Ginsburg B, Huang J, Kuchaiev O, Lavrukhin V, Leary R, Li J, Zhang Y. Quartznet: Deep Automatic Speech Recognition with 1D Time-Channel Separable Convolutions. In: ICASSP 2020 - 2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP): 2020. p. 6124–8. 10.1109/ICASSP40776.2020.9053889.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Bonito. <ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/bonito">https://github.com/nanoporetech/bonito</ext-link>. Accessed 2 Feb 2020.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Integrated Gradient. <ext-link ext-link-type="uri" xlink:href="https://github.com/TianhongDai/integrated-gradient-pytorch">https://github.com/TianhongDai/integrated-gradient-pytorch</ext-link>. Accessed 23 July 2020.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Wadden J. WGS of Human NA12878 and Zymo HMW mixture. Datasets. 2020. https://www.ncbi.nlm.nih.gov/sra/SRX9818342[accn]. Accessed 11 Jan 2021.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <mixed-citation publication-type="other">Wadden J. WGS of Hela and Zymo Standard mixture. Datasets. 2020. https://www.ncbi.nlm.nih.gov/sra/SRX9818341[accn]. Accessed 11 Jan 2021.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">Bao Y. SquiggleNet. Github. 2021. 10.5281/zenodo.5532521. <ext-link ext-link-type="uri" xlink:href="https://github.com/welch-lab/SquiggleNet">https://github.com/welch-lab/SquiggleNet</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
