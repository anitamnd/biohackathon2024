<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7703765</article-id>
    <article-id pub-id-type="pmid">31697323</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz808</article-id>
    <article-id pub-id-type="publisher-id">btz808</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiCBricks: building blocks for efficient handling of large Hi-C datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pal</surname>
          <given-names>Koustav</given-names>
        </name>
        <xref ref-type="aff" rid="btz808-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tagliaferri</surname>
          <given-names>Ilario</given-names>
        </name>
        <xref ref-type="aff" rid="btz808-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Livi</surname>
          <given-names>Carmen Maria</given-names>
        </name>
        <xref ref-type="aff" rid="btz808-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9811-3753</contrib-id>
        <name>
          <surname>Ferrari</surname>
          <given-names>Francesco</given-names>
        </name>
        <xref ref-type="aff" rid="btz808-aff1">1</xref>
        <xref ref-type="aff" rid="btz808-aff2">2</xref>
        <xref ref-type="corresp" rid="btz808-cor1"/>
        <!--<email>francesco.ferrari@ifom.eu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz808-aff1"><label>1</label><institution>IFOM, The FIRC Institute of Molecular Oncology</institution>, Milan, <country country="IT">Italy</country></aff>
    <aff id="btz808-aff2"><label>2</label><institution>Institute of Molecular Genetics, National Research Council</institution>, Pavia, <country country="IT">Italy</country></aff>
    <author-notes>
      <corresp id="btz808-cor1">
        <email>francesco.ferrari@ifom.eu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-07">
      <day>07</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>6</issue>
    <fpage>1917</fpage>
    <lpage>1919</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz808.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Genome-wide chromosome conformation capture based on high-throughput sequencing (Hi-C) has been widely adopted to study chromatin architecture by generating datasets of ever-increasing complexity and size. HiCBricks offers user-friendly and efficient solutions for handling large high-resolution Hi-C datasets. The package provides an R/Bioconductor framework with the bricks to build more complex data analysis pipelines and algorithms. HiCBricks already incorporates functions for calling domain boundaries and functions for high-quality data visualization.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/devel/bioc/html/HiCBricks.html">http://bioconductor.org/packages/devel/bioc/html/HiCBricks.html</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AIRC Start-up</institution>
          </institution-wrap>
        </funding-source>
        <award-id>16841</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AIRC fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-throughput sequencing (Hi-C) allows probing physical proximity between potentially any pair of genomic loci and has been widely adopted to characterize chromatin structure and function (<xref rid="btz808-B6" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>). Several Hi-C protocol variations and data analysis methods have been proposed (<xref rid="btz808-B4" ref-type="bibr">Forcato <italic>et al.</italic>, 2017</xref>). Moreover, a rapid escalation in the size and complexity of datasets has been causing challenges in data analysis (<xref rid="btz808-B10" ref-type="bibr">Pal <italic>et al.</italic>, 2019</xref>), data handling and interoperability (<xref rid="btz808-B8" ref-type="bibr">Marti-Renom <italic>et al.</italic>, 2018</xref>).</p>
    <p>Large high-resolution Hi-C datasets, such as mammalian genomes binned at Kb resolution (<xref rid="btz808-B1" ref-type="bibr">Bonev <italic>et al.</italic>, 2017</xref>; <xref rid="btz808-B11" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>), pose-specific challenges to computational biologists. First, there’s a lack of a standard data format for Hi-C contact matrices. The solutions adopted in literature and bioinformatic tools include text files with 2D matrices, sparse matrices represented in other tabular formats, as well as tool-specific binary formats such as ‘.mcool’ or ‘.hic’ (<xref rid="btz808-B3" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>). Second, recent tools designed to handle large mammalian datasets with Kb bin size resolution are mostly based on python, Java or C/C++ programs (<xref rid="btz808-B3" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>; <xref rid="btz808-B9" ref-type="bibr">Mendelson Cohen <italic>et al.</italic>, 2017</xref>). Although these informatic choices obtain good computing performances, they are not able to easily interact with other resources for biology. In particular, they are not easily incorporated in data analysis workflows based on Bioconductor, i.e. the large collaborative project that over the past 16 years has built a remarkable set of inter-operable tools for the computational genomics community (<xref rid="btz808-B5" ref-type="bibr">Gentleman <italic>et al.</italic>, 2004</xref>). Third, even the most sophisticated, comprehensive and user-friendly pipelines for Hi-C data analyses (<xref rid="btz808-B3" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>; <xref rid="btz808-B12" ref-type="bibr">Serra <italic>et al.</italic>, 2017</xref>; <xref rid="btz808-B14" ref-type="bibr">Wolff <italic>et al.</italic>, 2018</xref>) do not have functionalities allowing basic data manipulations on high-resolution datasets. Basic operations such as ‘access’, ‘subset’ or ‘merge’ are needed to perform additional downstream statistical analyses targeted to data subsets or to build custom pipelines.</p>
    <p>We present HiCBricks, a Bioconductor package providing an efficient, flexible and user-friendly framework for handling large high-resolution Hi-C data matrices. It provides R/Bioconductor users the fundamental bricks for custom Hi-C data analyses. HiCBricks allows importing data in various formats, storing and manipulating them for custom downstream statistical analyses (<xref ref-type="fig" rid="btz808-F1">Fig. 1A</xref>). The package is compliant with Bioconductor standards, thus minimizing compatibility issues and maximizing inter-operability with other tools.</p>
    <fig id="btz808-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>HiCBricks features and performances. (<bold>A</bold>) The cartoon shows HiCBricks framework main features. Input data can be 2D matrices text files or binary file formats (.cool or .mcool). The basic built-in data handling functions of HiCBricks provide the power and flexibility to perform custom analyses. The data accessors to retrieve interactions separated by a given distance allows retrieving diagonals that can be used for example to compute the interaction signal decay with distance. The data accessor functions can be used to build more complex analyses, as in the representative examples highlighting the function to retrieve sub-matrices that is leveraged in two proof of concept functions already included in HiCBricks. Namely functions for calling topological domain borders and sophisticated data visualization. (<bold>B</bold>) Maximum memory usage by HiCBricks and other tools when analyzing contact matrices of increasing size. The maximum memory usage is measured when computing the median interaction signal over 100 diagonals and reported on the y-axis (log scale) in megabytes (MB). The size of the matrices used as input is reported on the top axis as number (<italic>n</italic>) of data rows in an n x n matrix. The matrices are intra-chromosomal contact maps for either a Drosophila chr3R or human chr1. The matrix size corresponds to chromosomes binned at the resolution indicated on the x-axis. For larger matrices some data points are missing for specific tools that could not handle such large data structures in our test. (<bold>C</bold>) A representative data visualization plot that can be obtained with HiCBricks built-in functions. Two representative contact matrices (two samples) are shown in a bipartite (upper versus lower half) 45 degrees rotated heatmap of contact frequencies. A representative set of domain borders is over imposed on each sample</p>
      </caption>
      <graphic xlink:href="btz808f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>HiCBricks accepts contact matrices in multiple formats as input data, including plain text 2D matrices and ‘.mcool’ binary formats. HiCBricks then stores data in on-disk HDF files for efficient data access operations with a number of built-in functions. HiCBricks allows building complete data analysis pipelines, as well as drawing sophisticated plots. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for additional details on implementation.</p>
  </sec>
  <sec>
    <title>3 Test cases</title>
    <p>HiCBricks is the first Bioconductor package specifically designed for large high-resolution Hi-C contact matrices. Previous Bioconductor packages include also tools for Hi-C data analysis; however, their main purpose and functionalities are different from HiCBricks. For example, HiTC (<xref rid="btz808-B13" ref-type="bibr">Servant <italic>et al.</italic>, 2012</xref>) implements workflows for data normalization and visualization, but without HiCBricks flexibility for custom operations on data. InteractionSet (<xref rid="btz808-B7" ref-type="bibr">Lun <italic>et al.</italic>, 2016</xref>) provides instead lower level data accessors functions, but it is not designed for large high-resolution Hi-C matrices. To this concern, as a test case, we examined HiCBricks performance in loading a large contact matrix and computing median interaction signal over 100 diagonals, i.e. a common operation to assess the interaction signal decay with distance. We compared HiCBricks to R base functions and data structures (read.table and dataframe objects, respectively), as well as R packages designed for handling large data structures (bigmemory, data.table and tseries), in addition to InteractionSet. HiCBricks is superior to the other solutions in analyzing large Hi-C matrices in terms of lower memory footprint (<xref ref-type="fig" rid="btz808-F1">Fig. 1B</xref>). HiCBricks is actually the only one able to handle human data at a resolution of few Kb bin size, as the other R-based solutions could not handle the largest matrices in our test on a Linux server with 512 Gb RAM.</p>
    <p>As additional test cases, using the HiCBricks framework we implemented a topological domain borders calling procedure based on the directionality index (DI) originally proposed by (<xref rid="btz808-B2" ref-type="bibr">Dixon <italic>et al.</italic>, 2012</xref>), but adopting a local segmentation of DI, and complex data visualization functions (<xref ref-type="fig" rid="btz808-F1">Fig. 1C</xref>). These functionalities are showcased in the package vignette. These should be considered as proof of concept applications showing how complex analysis procedures can be easily implemented starting from HiCBricks functions.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>HiCBricks provides a framework useful for bioinformaticians who aim to build a custom analysis procedure for Hi-C data, or need to integrate Hi-C data analysis into pre-existing R/Bioconductor pipelines. On the other hand, biologists with specific questions that can’t be addressed by standard tools will find HiCBricks functionalities useful to perform targeted statistical analyses. HiCBricks enables easy assembling of custom pipelines, going from Hi-C matrices to rich graphical output plots.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>AIRC Start-up grant 2015 [16841 to F.F.] and AIRC fellowship [21012 to K.P.]</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz808_Supplementary_Data</label>
      <media xlink:href="btz808_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz808-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bonev</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>. <source>Cell</source>, <volume>171</volume>, <fpage>557</fpage>–<lpage>572.e524</lpage>.<pub-id pub-id-type="pmid">29053968</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dixon</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>, <volume>485</volume>, <fpage>376</fpage>–<lpage>380</lpage>.<pub-id pub-id-type="pmid">22495300</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>N.C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>95</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">27467249</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Forcato</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Comparison of computational methods for Hi-C data analysis</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>679</fpage>–<lpage>685</lpage>.<pub-id pub-id-type="pmid">28604721</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gentleman</surname><given-names>R.C.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biol</source>., <volume>5</volume>, <fpage>R80</fpage>. <pub-id pub-id-type="pmid">15461798</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lieberman-Aiden</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Infrastructure for genomic interactions: bioconductor classes for Hi-C, ChIA-PET and related experiments</article-title>. <source>F1000Res</source>, <volume>5</volume>, <fpage>950</fpage>.<pub-id pub-id-type="pmid">27303634</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marti-Renom</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Challenges and guidelines toward 4D nucleome data and model standards</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>1352</fpage>–<lpage>1358</lpage>.<pub-id pub-id-type="pmid">30262815</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Mendelson Cohen</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>SHAMAN: bin-free randomization, normalization and screening of Hi-C matrices</article-title>. <italic>bioRxiv</italic>,187203.</mixed-citation>
    </ref>
    <ref id="btz808-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pal</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Hi-C analysis: from data generation to integration</article-title>. <source>Biophys. Rev</source>., <bold>11</bold>, <fpage>67</fpage>–<lpage>78</lpage><pub-id pub-id-type="pmid">30570701</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>S.S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Serra</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Automatic analysis and 3D-modelling of Hi-C data using TADbit reveals structural features of the fly chromatin colors</article-title>. <source>PLoS Comput. Biol</source>., <volume>13</volume>, <fpage>e1005665</fpage>.<pub-id pub-id-type="pmid">28723903</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Servant</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>HiTC: exploration of high-throughput ‘C’ experiments</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2843</fpage>–<lpage>2844</lpage>.<pub-id pub-id-type="pmid">22923296</pub-id></mixed-citation>
    </ref>
    <ref id="btz808-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolff</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Galaxy HiCExplorer: a web server for reproducible Hi-C data analysis, quality control and visualization</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>W11</fpage>–<lpage>W16</lpage>.<pub-id pub-id-type="pmid">29901812</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
