<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870550</article-id>
    <article-id pub-id-type="pmid">28575171</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx346</article-id>
    <article-id pub-id-type="publisher-id">btx346</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>karyoploteR: an R/Bioconductor package to plot customizable genomes displaying arbitrary data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gel</surname>
          <given-names>Bernat</given-names>
        </name>
        <xref ref-type="aff" rid="btx346-aff1">1</xref>
        <xref ref-type="corresp" rid="btx346-cor1"/>
        <!--<email>bgel@igtp.cat</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Serra</surname>
          <given-names>Eduard</given-names>
        </name>
        <xref ref-type="aff" rid="btx346-aff1">1</xref>
        <xref ref-type="aff" rid="btx346-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx346-aff1"><label>1</label>Hereditary Cancer Group, Program for Predictive and Personalized Medicine of Cancer – Germans Trias i Pujol Research Institute (PMPPC-IGTP), Campus Can Ruti, Badalona, Spain</aff>
    <aff id="btx346-aff2"><label>2</label>CIBERONC</aff>
    <author-notes>
      <corresp id="btx346-cor1">To whom correspondence should be addressed. Email: <email>bgel@igtp.cat</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-29">
      <day>29</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>19</issue>
    <fpage>3088</fpage>
    <lpage>3090</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx346.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Data visualization is a crucial tool for data exploration, analysis and interpretation. For the visualization of genomic data there lacks a tool to create customizable non-circular plots of whole genomes from any species.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We have developed karyoploteR, an R/Bioconductor package to create linear chromosomal representations of any genome with genomic annotations and experimental data plotted along them. Plot creation process is inspired in R base graphics, with a main function creating karyoplots with no data and multiple additional functions, including custom functions written by the end-user, adding data and other graphical elements. This approach allows the creation of highly customizable plots from arbitrary data with complete freedom on data positioning and representation.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and implementation</title>
        <p>karyoploteR is released under Artistic-2.0 License. Source code and documentation are freely available through Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/karyoploteR">http://www.bioconductor.org/packages/karyoploteR</ext-link>) and at the examples and tutorial page at <ext-link ext-link-type="uri" xlink:href="https://bernatgel.github.io/karyoploter_tutorial">https://bernatgel.github.io/karyoploter_tutorial</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Data visualization is an important part of data analysis. It efficiently summarizes complex data, facilitates exploration and can reveal non-obvious patterns in the data. A natural representation for genomic data is positioned along the genome next to the ideograms of the different chromosomes. This type of representation is specially useful to identify the relation between different types of experimental data and genomic annotations. Various genomic visualization tools are available. Circos (<xref rid="btx346-B3" ref-type="bibr">Krzywinski <italic>et al.</italic>, 2009</xref>) produces highly customizable high quality circular plots, as does ites R counterpart RCircos (<xref rid="btx346-B7" ref-type="bibr">Zhang <italic>et al.</italic>, 2013</xref>). There are other R packages capable of plotting whole genome diagrams such as: ggbio (<xref rid="btx346-B6" ref-type="bibr">Yin <italic>et al.</italic>, 2012</xref>), based on the grammar of graphics that can produce different plot types including ideogram and karyogram plots; IdeoViz (<xref rid="btx346-B5" ref-type="bibr">Pai and Ren, 2014</xref>), to plot binned data along the genome either as lines or bars; or chromPlot (<xref rid="btx346-B4" ref-type="bibr">Oróstica and Verdugo, 2016</xref>), to plot up to four datasets given in a predefined format. These packages are either limited in the amount or type of data they can plot (IdeoViz and chromPlot) or have limited customization options (ggbio). In addition, the Bioconductor package Gviz (<xref rid="btx346-B2" ref-type="bibr">Hahne and Ivanek, 2016</xref>) is a powerful tool to create track-based plots of diverse biological data but it does not produce plots of the whole genome. There is a lack of a tool in R to create non-circular whole genome plots, able to plot arbitrary data in any organism and with ample customization capabilities.</p>
    <p>Here we present karyoploteR, an extendable and customizable R/Bioconductor package to plot genome ideograms and genomic data positioned along them. It’s inspired on the R base graphics, building plots with multiple successive calls to simple plotting functions.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <p>The interface of karyoploteR and the process to create a complete plot is very similar to that of base R graphics. We first create a simple or even empty plot with an initializing function and then add additional graphic elements with successive calls to other plotting functions. The first call creates and initializes the graphical device and returns a <italic>karyoplot</italic> object with all the information needed to add data to it. The <italic>karyoplot</italic> object contains a coordinate change function mapping genomic coordinates into plotting coordinates, which is used by all plotting functions. Plotting functions are classified into three groups: the ones adding non-data elements to the plot and two data plotting groups, low-level functions and high-level functions. karyoploteR also takes some ideas from Circos, such as not defining fixed tracks but leaving complete freedom to the user with respect to data positioning using the <italic>r0</italic> and <italic>r1</italic> parameters. All non-data elements in the karyoplot (main title, chromosome names, …) are drawn by specific functions. These functions accept standard graphical parameters but it’s also possible to swap them for custom functions if a higher level of customization is needed.</p>
    <sec>
      <title>2.1 Ideogram plotting</title>
      <p>Ideogram plotting is the basic functionality of karyoploteR. Default ideograms can be plotted with a single function call (<xref ref-type="fig" rid="btx346-F1">Fig. 1A</xref>). However, itwe possible to customize them: positioning the chromosomes in different arrangements, representing just a subset of chromosomes or change whether the cytobands are included and how they are represented. It is also possible to create different data plotting regions either above or below the ideograms as well as customizing all sizings and margins by changing the values stored in <italic>plot.params</italic>.
</p>
      <fig id="btx346-F1" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <p><bold>(A)</bold> The complete human GRCh38 genome. This plot is created with the single command ‘plotKaryotype(genome=“hg38”)’. <bold>(B)</bold> An example of a figure generated by karyoploteR representing different data types plotted in human chromosomes 1 and 2</p>
        </caption>
        <graphic xlink:href="btx346f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Not only human</title>
      <p>karyoploteR is not restricted to human data in any way. It is possible to specify other organisms when creating a karyoplot. Genome data for a small set of organisms is included with the package and it will use functionality from regioneR (<xref rid="btx346-B1" ref-type="bibr">Gel <italic>et al.</italic>, 2016</xref>) to get it from UCSC or Bioconductor for other genomes. If an organism is not available anywhere, it is possible to plot it providing its genome information. Therefore, if required, it’s possible to create custom genomes for specific purposes.</p>
    </sec>
    <sec>
      <title>2.3 Data plotting</title>
      <p>Data plotting functions are divided in two groups: low-level and high-level. Low-level data plotting functions plot graphical primitives such as points, lines and polygons. Except for the additional <italic>chr</italic> parameter, they mimic the behaviour of their base graphics counterparts including the usage of most of the standard graphical parameters. These plotting functions offer a flexible signature and are completely data agnostic: they know nothing about biological concepts, giving the user total freedom on how to use them. High-level functions, in contrast, are used to create more complex data representations. They understand some basic concepts such as ‘genomic region’ and they usually perform some kind of computation prior to data plotting (<xref ref-type="fig" rid="btx346-F1">Fig. 1B</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Customization and extensibility</title>
      <p>In addition to customizing sizings and margins and the using custom genomes, karyoploteR can be extended with custom plotting functions. All internal functions, including the main coordinate change function, are exported and documented in the package vignette. With this it is possible to create custom plotting functions adapted to specific data types and formats.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We have developed an R/Bioconductor package, karyoploteR, to plot arbitrary genomes with data positioned on them. It offers a flexible API inspired in R base graphics, with low-level functions to plot graphical primitives and high-level functions to plot complex data. The plots are highly customizable in data positioning and appearance and it is possible to extend the package functionality with custom plotting functions. karyoploteR requires R ≥ 3.4 and Bioconductor ≥ 3.5. More information and examples can be found at the package Bioconductor page and at <ext-link ext-link-type="uri" xlink:href="https://bernatgel.github.io/karyoploter_tutorial">https://bernatgel.github.io/karyoploter_tutorial</ext-link></p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Roberto Malinverni for his insightful comments and the IGTP HPC Core Facility and Iñaki Martínez de Ilarduya for his help.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by: the Spanish Ministry of Science and Innovation, Carlos III Health Institute (ISCIII) (PI11/1609; PI14/00577)(RTICC RD12/0036/008) Plan Estatal de I + D + I 2013–16, and co-financed by the FEDER program; the Government of Catalonia (2014 SGR 338); and the Spanish Association Against Cancer (AECC).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx346-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gel</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>regioneR: an R/Bioconductor package for the association analysis of genomic regions based on permutation tests</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>289</fpage>–<lpage>291</lpage>.<pub-id pub-id-type="pmid">26424858</pub-id></mixed-citation>
    </ref>
    <ref id="btx346-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hahne</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Ivanek</surname><given-names>R.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Visualizing genomic data using Gviz and bioconductor</article-title>. <source>Methods Mol. Biol</source>., <volume>1418</volume>, <fpage>335</fpage>–<lpage>351</lpage>.<pub-id pub-id-type="pmid">27008022</pub-id></mixed-citation>
    </ref>
    <ref id="btx346-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krzywinski</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Circos: an information aesthetic for comparative genomics</article-title>. <source>Genome Res</source>., <volume>19</volume>, <fpage>1639</fpage>–<lpage>1645</lpage>.<pub-id pub-id-type="pmid">19541911</pub-id></mixed-citation>
    </ref>
    <ref id="btx346-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oróstica</surname><given-names>K.Y.</given-names></name>, <name name-style="western"><surname>Verdugo</surname><given-names>R.A.</given-names></name></person-group> (<year>2016</year>) 
<article-title>ChromPlot: Visualization of genomic data in chromosomal context</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2366</fpage>–<lpage>2368</lpage>.<pub-id pub-id-type="pmid">27153580</pub-id></mixed-citation>
    </ref>
    <ref id="btx346-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Pai</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Ren</surname><given-names>J.</given-names></name></person-group> (<year>2014</year>) IdeoViz: Plots data (continuous/discrete) along chromosomal ideogram. <italic>R package version 1.8.0.</italic></mixed-citation>
    </ref>
    <ref id="btx346-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yin</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>ggbio: an R package for extending the grammar of graphics for genomic data</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>R77.</fpage><pub-id pub-id-type="pmid">22937822</pub-id></mixed-citation>
    </ref>
    <ref id="btx346-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>RCircos: an R package for Circos 2D track plots</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>244.</fpage><pub-id pub-id-type="pmid">23937229</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
