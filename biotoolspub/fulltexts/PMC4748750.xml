<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Syst. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">sysbio</journal-id>
    <journal-id journal-id-type="hwp">sysbio</journal-id>
    <journal-title-group>
      <journal-title>Systematic Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1063-5157</issn>
    <issn pub-type="epub">1076-836X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4748750</article-id>
    <article-id pub-id-type="doi">10.1093/sysbio/syv082</article-id>
    <article-id pub-id-type="publisher-id">syv082</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software for Systematics and Evolution</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>SimPhy</italic>: Phylogenomic Simulation of Gene, Locus, and Species Trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mallo</surname>
          <given-names>Diego</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Oliveira Martins</surname>
          <given-names>Leonardo</given-names>
        </name>
        <xref ref-type="corresp" rid="COR2">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Posada</surname>
          <given-names>David</given-names>
        </name>
      </contrib>
      <aff id="AFF1">Department of Biochemistry, Genetics and Immunology, University of Vigo, Vigo 36310, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">*Correspondence to be sent to: Department of Biochemistry, Genetics and Immunology, University of Vigo, Vigo 36310, Spain; E-mail: <email>dmallo@uvigo.es</email></corresp>
      <corresp id="COR2"><sup>†</sup>Present address: Department of Materials, Imperial College London, London SW7 2AZ, United Kingdom</corresp>
      <fn id="FN1">
        <p>Associate Editor: Laura Kubatko</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>3</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>65</volume>
    <issue>2</issue>
    <fpage>334</fpage>
    <lpage>344</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2015. Published by Oxford University Press, on behalf of the Society of Systematic Biologists.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We present a fast and flexible software package—SimPhy—for the simulation of multiple gene families evolving under incomplete lineage sorting, gene duplication and loss, horizontal gene transfer—all three potentially leading to species tree/gene tree discordance—and gene conversion. SimPhy implements a hierarchical phylogenetic model in which the evolution of species, locus, and gene trees is governed by global and local parameters (e.g., genome-wide, species-specific, locus-specific), that can be fixed or be sampled from a priori statistical distributions. SimPhy also incorporates comprehensive models of substitution rate variation among lineages (uncorrelated relaxed clocks) and the capability of simulating partitioned nucleotide, codon, and protein multilocus sequence alignments under a plethora of substitution models using the program INDELible. We validate SimPhy's output using theoretical expectations and other programs, and show that it scales extremely well with complex models and/or large trees, being an order of magnitude faster than the most similar program (DLCoal-Sim). In addition, we demonstrate how SimPhy can be useful to understand interactions among different evolutionary processes, conducting a simulation study to characterize the systematic overestimation of the duplication time when using standard reconciliation methods. SimPhy is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/adamallo/SimPhy">https://github.com/adamallo/SimPhy</ext-link>, where users can find the source code, precompiled executables, a detailed manual and example cases.</p>
    </abstract>
    <kwd-group>
      <kwd>Gene conversion</kwd>
      <kwd>gene duplication and loss</kwd>
      <kwd>gene family evolution</kwd>
      <kwd>horizontal gene transfer</kwd>
      <kwd>incomplete lineage sorting</kwd>
      <kwd>locus tree</kwd>
      <kwd>simulation</kwd>
      <kwd>species tree</kwd>
    </kwd-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Recent advances in sequencing technologies have enabled the expansion of genome-wide phylogenetic studies, unveiling not only extensive phylogenomic incongruence (<xref rid="B22" ref-type="bibr">Jeffroy et al. 2006</xref>; <xref rid="B43" ref-type="bibr">Salichos and Rokas 2013</xref>) but also reviving consideration of how ancestral polymorphisms sort within populations (<xref rid="B13" ref-type="bibr">Edwards 2009</xref>). Indeed, it is well known that gene and species phylogenies can be inconsistent due to evolutionary processes like incomplete lineage sorting (ILS), gene duplication and loss (GDL), and horizontal gene transfer (HGT) (<xref rid="B16" ref-type="bibr">Goodman et al. 1979</xref>; <xref rid="B38" ref-type="bibr">Pamilo and Nei 1988</xref>; <xref rid="B49" ref-type="bibr">Takahata 1989</xref>; <xref rid="B29" ref-type="bibr">Maddison 1997</xref>; <xref rid="B37" ref-type="bibr">Page and Charleston 1997</xref>). Not surprisingly, the gene tree/species tree “dilemma” has received a lot of attention in recent years, and consequently a plethora of species tree reconstruction methods have been published (<xref rid="B8" ref-type="bibr">Chaudhary et al. 2010</xref>; <xref rid="B19" ref-type="bibr">Heled and Drummond 2010</xref>; <xref rid="B28" ref-type="bibr">Liu et al. 2010</xref>; <xref rid="B6" ref-type="bibr">Boussau et al. 2013</xref>; <xref rid="B11" ref-type="bibr">De Oliveira Martins et al. 2014</xref>; see <xref rid="B31" ref-type="bibr">Mallo et al. 2014a</xref> for a review; <xref rid="B35" ref-type="bibr">Mirarab and Warnow 2015</xref>). Although several benchmarks of species tree methods have been carried out (<xref rid="B25" ref-type="bibr">Leache and Rannala 2011</xref>; <xref rid="B51" ref-type="bibr">Yang and Warnow 2011</xref>; <xref rid="B4" ref-type="bibr">Bayzid and Warnow 2013</xref>; <xref rid="B34" ref-type="bibr">Mirarab et al. 2014</xref>), they have generally focused on single causes of phylogenetic discordance. Nevertheless, ILS, GDL, and HGT can act simultaneously during genome evolution yielding synergistic evolutionary scenarios (<xref rid="B32" ref-type="bibr">Mallo et al. 2014b</xref>) and, therefore, it would be convenient to consider them all together. However, none of the state-of-the-art simulation programs is able to yield scenarios that consider these processes at once. Rather, they usually focus on single evolutionary processes, which partially explain why benchmarking studies have usually been restrictive in this regard. Thus, ILS is usually simulated with tools that implement different extensions of the multispecies coalescent model (MSC) (<xref rid="B40" ref-type="bibr">Rannala and Yang 2003</xref>), like Mesquite (<xref rid="B30" ref-type="bibr">Maddison and Maddison 2015</xref>), MCcoal (<xref rid="B40" ref-type="bibr">Rannala and Yang 2003</xref>), or GUMS (<xref rid="B18" ref-type="bibr">Heled et al. 2013</xref>). Moreover, for small species trees, structured coalescent simulators like ms (<xref rid="B21" ref-type="bibr">Hudson 2002</xref>), SGWE (<xref rid="B1" ref-type="bibr">Arenas and Posada 2014</xref>), or scrm (<xref rid="B45" ref-type="bibr">Staab et al. 2015</xref>) could be also used. Apart from standalone programs, there are also phylogenetic libraries like DendroPy (<xref rid="B47" ref-type="bibr">Sukumaran and Holder 2010</xref>) that include the simulation of ILS. GDL can be modeled using birth–death processes traversing the species tree like in <xref rid="B2" ref-type="bibr">Arvestad et al. (2003)</xref>, and HGT is usually simulated as a Poisson-distributed series of transfer events, like in HGT_simul (<xref rid="B15" ref-type="bibr">Galtier 2007</xref>). Nowadays, only very few tools are able to simulate phylogenies jointly considering multiple sources of phylogenomic incongruence, like PrIME-GenPhyloData (<xref rid="B44" ref-type="bibr">Sjostrand et al. 2013</xref>) and DLCoal_sim (<xref rid="B41" ref-type="bibr">Rasmussen and Kellis 2012</xref>). The former combines GDL and HGT, while the later considers GDL and ILS. In addition, there are also genome simulators like ALF-A (<xref rid="B9" ref-type="bibr">Dalquen et al. 2012</xref>) or EvolSimulator (<xref rid="B5" ref-type="bibr">Beiko and Charlebois 2007</xref>), that can integrate several evolutionary processes at the genomic level but do not consider population-level events, like ILS. Altogether, we are not aware of any tool able to simulate phylogenetic trees considering the joint action of ILS, GDL, and HGT.</p>
  <p>To facilitate more realistic simulations, we present here a fast and flexible simulation tool—<italic>SimPhy</italic>—that can simulate the evolution of multiple gene families under ILS, GDL, HGT (via homologous replacement), and gene conversion (GC). <italic>SimPhy</italic> implements a flexible hierarchical parameterization scheme that considers genome-wide and gene family-specific conditions, including different sources for evolutionary rate variation among lineages. Moreover, these parameters can be fixed or sampled from statistical distributions defined by the user. In addition, <italic>SimPhy</italic> does not only generate gene trees, but it is also able to produce multilocus sequence alignments in a subsequent step using INDELible (<xref rid="B14" ref-type="bibr">Fletcher and Yang 2009</xref>). These features make <italic>SimPhy</italic> a powerful tool to understand the interaction among ILS, GDL, HGT and GC or for a comprehensive benchmarking of phylogenomic methods.</p>
  <sec>
    <title>S<sc>imulation of</sc> G<sc>ene</sc>, L<sc>ocus, and</sc> S<sc>pecies</sc> T<sc>rees with</sc> S<sc>imphy</sc></title>
    <p><italic>SimPhy</italic> simulates the evolution of multiple gene families under a hierarchical phylogenomic model in which gene trees evolve inside locus trees, which in turn evolve along a single species tree (<xref ref-type="fig" rid="F1">Fig. 1</xref>). While the three-tree model was first proposed by <xref rid="B41" ref-type="bibr">Rasmussen and Kellis (2012)</xref>, who implemented it in the program DLCoal_sim, <italic>SimPhy</italic> extends this approach in multiple ways. Apart from ILS and GDL, <italic>SimPhy</italic> also jointly considers HGT and GC, plus species extinction. Furthermore, GDL, HGT, and GC rates are allowed to vary among gene families. <italic>SimPhy</italic> also relaxes the assumption of a strict molecular clock and implements different sources of rate heterogeneity among lineages at the species, gene family and gene tree level. Moreover, the generation time is allowed to vary along the species tree, incorporating an additional layer of rate variation. <italic>SimPhy</italic>'s simulation parameters can be sampled from user-specified distributions at the species, locus, and gene tree level, and in some cases made interdependent. This allows users to carry out simulations following a very flexible strategy in which each parameter is defined by a prior distribution that can represent specific, biologically relevant scenarios. Nevertheless, (classic) simulation studies based on combinations of fixed, discrete parameter values can also be easily implemented.</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>Three-tree model and evolutionary events simulated in <italic>SimPhy</italic>. The figure shows a species tree (thick light tree in the background) that embeds a locus tree (medium-thick lines) that includes a gene tree (thin dark lines with nodes represented by black dots). The sample consists of six gene copies (<inline-formula><mml:math id="I1"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I2"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mrow><mml:mo>β</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I3"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I4"><mml:mrow><mml:msub><mml:mtext>C</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I5"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="I6"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) that belong to two loci (<inline-formula><mml:math id="I7"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="I8"><mml:mo>β</mml:mo></mml:math></inline-formula>) in four different species (A, B, C and D) and five individuals (<inline-formula><mml:math id="I9"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I10"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I11"><mml:mrow><mml:msub><mml:mtext>C</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I12"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="I13"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). Letters in parenthesis indicate at which phylogenetic level an event takes place (S = species tree, L = locus tree, G = gene tree). Coalescent bounds generated by GDL, HGT, or GC events are indicated with an icon (duplication: square, HGT: arrow, GC: star). Dashed lines in the locus tree, generated by HGT and GC, link locus tree branches that are depicted apart for clarity. Lighter locus tree branches represent lost branches due to gene loss or locus replacement by HGT or GC. Dashed gene tree branches indicate lost/unsampled lineages in the original locus from the individual where the duplication took place.</p>
      </caption>
      <graphic xlink:href="syv082f1"/>
    </fig>
    <sec>
      <title>The Three-Tree Model</title>
      <p><italic>SimPhy</italic> implements and extends a hierarchical phylogenetic model (<xref rid="B41" ref-type="bibr">Rasmussen and Kellis 2012</xref>) that considers three different layers: species, locus, and gene trees.</p>
      <sec>
        <title>Species trees</title>
        <p>Depict the evolutionary history of the sampled organisms. Species tree nodes represent speciation events, while the branches reflect population history: branch length and width represent elapsed time and effective population size (Ne), respectively. Note that we consider species as a diverging interbreeding structure regardless of any taxonomic rank. Therefore, species trees might be equivalent to population trees when the organismal units of interest are conspecific populations.</p>
      </sec>
      <sec>
        <title>Locus trees</title>
        <p>Represent the evolutionary history of the sampled loci for a given gene family. Since the loci exist inside individuals evolving as part of a population, the locus tree is contained within the species tree. In a locus tree the nodes depict either genetic divergence due to speciation in the embedding species tree or locus-level events like duplication, loss, HGT, or GC, while branch lengths and widths represent time and Ne as before.</p>
      </sec>
      <sec>
        <title>Gene trees</title>
        <p>Represent the evolutionary history of the sampled gene copies, which evolve inside a locus tree. Gene tree nodes indicate coalescent events, which looking forward in time correspond to the process of DNA replication and divergence, and which in the absence of migration and HGT can only occur before the speciation time. The lengths of the gene tree branches represent the expected number of substitutions per site.</p>
      </sec>
    </sec>
    <sec>
      <title>Time Units</title>
      <p><italic>SimPhy</italic> simulates species, locus, and gene trees in continuous time. Species and locus trees are measured in number of generations, while gene trees are measured in expected number of substitutions per site. The number of generations can be related to absolute time if a generation time (in number of generations per time unit) is specified, while the number of substitutions per site can be related to the number of generations given a specific substitution rate (expected number of substitutions per generation). Thus, rates of events that take place on the species tree (e.g., speciations) are measured in number of events per absolute time unit, while locus-specific rates (e.g., duplications) are measured in number of events per generation.</p>
    </sec>
    <sec>
      <title>Evolutionary Processes Implemented</title>
      <p><italic>SimPhy</italic> defines and implements different evolutionary processes as follows:</p>
      <sec>
        <title>Speciation</title>
        <p>Separation of an ancestral species into two new species that do not interbreed. Speciation events are represented by nodes in the species tree, and can also be reflected in the locus tree.</p>
      </sec>
      <sec>
        <title>Extinction</title>
        <p>Disappearance of a species. Extinctions take place during the simulation of the species tree, affecting its final topology, but are not considered further.</p>
      </sec>
      <sec>
        <title>Gene duplication</title>
        <p>Copy of a locus into an unlinked location in the same genome. Gene duplication events generate nodes in the locus tree. We do not consider duplication polymorphisms (see below).</p>
      </sec>
      <sec>
        <title>Gene loss</title>
        <p>Deletion of a locus. Losses generate locus tree leaves that do not reach the present, and that are not considered during the gene tree simulation process. We do not consider loss polymorphisms.</p>
      </sec>
      <sec>
        <title>HGT</title>
        <p>Copy of a locus into a different, contemporary species. We assume that the homologous locus in the receiving species is replaced by the transferred locus (i.e., replacing HGT). Each transfer generates two nodes in the locus tree, one representing the loss of the replaced locus (receptor) and another showing the incorporation of the transferred lineage. We do not consider transfer polymorphisms. Transfers from extinct lineages (see e.g., <xref rid="B48" ref-type="bibr">Szollosi et al. 2013</xref>), or additive transfers (those generating a new locus in the receiving genome) are also not considered in the current version of the model.</p>
      </sec>
      <sec>
        <title>GC</title>
        <p>Replacement among homologs within a species. Each GC generates two nodes in the locus tree, one representing the loss of the replaced locus (receptor) and another showing the incorporation of the converted lineage. We do not consider GC polymorphisms.</p>
      </sec>
      <sec>
        <title>Lineage sorting</title>
        <p>Consideration of the coalescent history of the sampled gene copies, allowing their history to be incompatible with the species tree history. It is implicitly reflected at the gene tree level, and can be spotted when mapping locus and gene tree nodes.</p>
        <p>These evolutionary processes are modeled in <italic>SimPhy</italic> using a mixture of existing and original strategies. The <italic>species tree</italic> is simulated (or user-defined, see section `Simulation Process') by either a Yule (<xref rid="B53" ref-type="bibr">Yule 1925</xref>) or a birth–death (<xref rid="B23" ref-type="bibr">Kendall 1948</xref>) process, considering speciations and extinctions. At this point, <italic>SimPhy</italic> only considers extant species. Each <italic>locus tree</italic> is described by a constant-rate birth–death process that considers duplication and losses, coupled with another two pure-birth processes that describe the HGT and GC events. Regarding the last two, <italic>SimPhy</italic> incorporates two variants, one in which the receptor is randomly chosen from the candidates and another that takes into account the evolutionary distance between donors and candidate receptors—that is, with reception probability inversely proportional to the phylogenetic distance.</p>
        <p>Duplications, HGTs and GCs act as coalescent bounds for the subtree that corresponds to the new/replaced locus (the “bounded subtree”), since these events initially affect a single individual and only afterward may become fixed in the population (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Nevertheless, <italic>SimPhy</italic> does not consider locus polymorphisms. We assume instead that duplications, HGTs and GCs spread fast enough in the population so all descendant individuals in the sample carry them, or alternatively, that they drift away so quickly that are absent in the sample. The result of this assumption is that every sampled individual from a particular lineage and gene family carries the same number of gene copies. Otherwise, we would have been obligated to include a population genetics model for the evolution of gene copy polymorphisms, which seemed out of scope.</p>
        <fig id="F2" orientation="portrait" position="float">
          <label>Figure 2.</label>
          <caption>
            <p>Coalescent bound enforced by duplication. The figure represents the evolutionary relationships of four gene copies (<inline-formula><mml:math id="I14"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:mo>β</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I15"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I16"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I17"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mtext>1</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) belonging to two individuals (<inline-formula><mml:math id="I18"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I19"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) of the same species (A) with two loci (<inline-formula><mml:math id="I20"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="I21"><mml:mo>β</mml:mo></mml:math></inline-formula>). The locus <inline-formula><mml:math id="I22"><mml:mo>β</mml:mo></mml:math></inline-formula> was originated by duplication in the individual surrounded by a square. We assume that the duplication occurs initially in one individual, and afterward spreads throughout the whole sample. Thus, lineages coming from the <inline-formula><mml:math id="I23"><mml:mo>β</mml:mo></mml:math></inline-formula> lineage cannot exist below the duplication event, imposing a coalescent bound (i.e., they have to coalesce before the duplication event [above in this figure]). The three subfigures represent alternative views of the same scenario. Subfigure a) depicts the relationships of the whole population, while in subfigure b) only the sampled lineages are highlighted. Finally, subfigure c) shows the three-tree representation of the sample genealogy.</p>
          </caption>
          <graphic xlink:href="syv082f2"/>
        </fig>
        <p><italic>Gene trees</italic> modeled by the multilocus coalescent model (<xref rid="B41" ref-type="bibr">Rasmussen and Kellis 2012</xref>) are expanded to consider bounded subtrees generated by HGT and GC. This model is built upon the MSC (<xref rid="B40" ref-type="bibr">Rannala and Yang 2003</xref>) and, therefore, inherits the same assumptions: each branch of the container tree is composed of a perfect Wright–Fisher population (constant effective population size, non-overlapping generations, random mating, neutrality), no recombination within loci and free recombination between loci. Consequently, all of the evolutionary processes except speciation and extinction are considered independently for each gene family. Some of these assumptions might be relaxed in future versions of <italic>SimPhy</italic>, for example, allowing migration of individuals between species and/or recombination within loci.</p>
      </sec>
    </sec>
    <sec>
      <title>Simulation Process</title>
      <sec>
        <title>Species trees</title>
        <p>Sampled either using a pure-birth (Yule) model or a birth–death model, parameterized by birth (speciation) and death (extinction) rates (given in number of events per generation) and either number of leaves, tree height or both. The simple sampling approach algorithm (SSA) is used when the number of leaves is not specified, while the birth–death rate sampling approach (BDSA) algorithm is used otherwise (see <xref rid="B17" ref-type="bibr">Hartmann et al. 2010</xref> for more details). An out-group species can be added to the resulting species tree before the simulation of the locus trees.</p>
      </sec>
      <sec>
        <title>Locus trees</title>
        <p>Simulated using a SSA to sample a birth–death process—describing duplications and losses—coupled with two additional pure birth processes—describing HGTs and GCs—along each species tree branch, in a preorder fashion (from the root to the tips). This is followed by a second preorder traversal that samples receptors from contemporary candidates for each HGT/GC, completing the appropriate SPR branch rearrangement to generate the definitive locus tree.</p>
      </sec>
      <sec>
        <title>Gene trees</title>
        <p>Locus tree branches that do not pertain to bounded subtrees (i.e., representing the existing locus before any bounding duplication/HGT/GC event) are modeled by the multispecies coalescent, and, therefore, sampled by successive coalescent simulations along each branch of the locus tree, traversed in post-order in the opposite direction than the locus tree simulation. For each locus tree branch, a standard coalescent simulation starts with a number of lineages that enter the locus tree branch toward the root, terminating when the end of the locus branch is reached, or when there is only one lineage left. On the other hand, the simulation of gene trees along bounded locus subtrees implies a much more complex strategy, based on sampling the number of gene tree lineages going through every node of the locus tree, and obtaining the coalescent times conditioned on these numbers. This approach requires the calculation of gene tree lineage count probabilities for every branch of the these locus subtrees, for which <italic>SimPhy</italic> uses a dynamic programing algorithm modified from the one proposed by <xref rid="B41" ref-type="bibr">Rasmussen and Kellis (2012)</xref>. A pre-order traversal (from the root to the tips) is then conducted to sample the number of lineage counts going across every locus subtree branch, using the inverse transform sampling method with the cumulative distribution function (CDF) of the number of input gene tree lineages—those entering the locus tree branch towards the root—conditioned on the precalculated gene tree lineage count input probabilities, output lineage counts (those leaving the locus branch toward the root), effective population size, and branch length for every branch of the considered bounded locus subtree (Online Appendix 1 available as Supplementary Material on Dryad at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.707td">http://dx.doi.org/10.5061/dryad.707td</ext-link>). This procedure starts at the root of each bounded locus subtree, where the number of output lineages is fixed to one—because of the bound imposed by the duplication/HGT/GC event—and then samples the counts along the bounded locus subtree stopping at its leaves. With the lineage counts already set, the coalescent times are sampled using the inverse transform of the CDF of the coalescent times conditioned on lineage counts as in <xref rid="B41" ref-type="bibr">Rasmussen and Kellis (2012)</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>Distribution-Driven Parameterization</title>
      <p>While most simulation studies are parameterized using a grid consisting of combinations of discrete parameter values, <italic>SimPhy</italic> has the capability of sampling parameter values from prior statistical distributions (as in <xref rid="B10" ref-type="bibr">Darriba et al. 2012</xref>; see also <xref rid="B26" ref-type="bibr">Leigh and Bryant 2015</xref>). Such distributions are defined by the user, and currently include Uniform, Normal, Lognormal, Exponential, and Gamma plus the possibility of fixing parameter values. Different parameters are sampled through the different simulation layers (i.e., for each species, locus, or gene tree), with the possibility of specifying certain dependencies among parameters (i.e., with some parameters acting as hyper or hyper–hyper parameters) (<xref ref-type="fig" rid="F3">Fig. 3</xref>).</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Distribution-driven parameterization. For every simulation replicate parameter A is sampled from a given distribution. The sampled value of A will shape the distribution among gene families of our parameter of interest, <inline-formula><mml:math id="I24"><mml:mo>α</mml:mo></mml:math></inline-formula>, for that replicate (i.e., A acts a hyperparameter for <inline-formula><mml:math id="I25"><mml:mo>α</mml:mo></mml:math></inline-formula>). Then, for every gene family the <inline-formula><mml:math id="I26"><mml:mo>α</mml:mo></mml:math></inline-formula> parameter is sampled from the resulting distribution to determine its evolution. This particular schema can be applied to all gene family-specific parameters like duplication, loss, HGT and GC rates. Similar schemas with more or less layers can be applied to other simulation parameters. Different statistical distributions can be specified by the user (e.g., Uniform, Normal, Exponential, Gamma).</p>
        </caption>
        <graphic xlink:href="syv082f3"/>
      </fig>
      <p>Under the standard simulation workflow, <italic>SimPhy</italic> samples for each replicate genome-wide parameters, species-tree parameters, species-specific and gene family-specific rate variation parameters, and number of gene families. Genome-wide parameters control the expected distribution of duplications, losses, HGTs, and GC events across gene families. Species tree parameters include speciation and extinction rates, species tree height, number of taxa, relative distance of the out-group, number of individuals per species, effective population size, substitution rate, and generation time. For each gene family, specific duplication, loss, HGT, and GC rates are sampled from the distributions specified at the genome-wide level. The variation of the substitution rate across species, locus, and gene trees is also specified using statistical distributions at different levels, as detailed in the next section.</p>
    </sec>
    <sec>
      <title>Substitution Rate Variation</title>
      <p>The generative model of <italic>SimPhy</italic>, being based on coalescent and birth–death models, is in principle intrinsically ultrametric and, therefore, follows a strict molecular clock. However, it is well known that many real data sets deviate from a strict molecular clock (see <xref rid="B20" ref-type="bibr">Ho et al. 2011</xref>). We have, therefore, implemented in <italic>SimPhy</italic> different sources of rate variation among lineages—lineage-specific, gene family-specific and gene-by-lineage-specific (<xref ref-type="fig" rid="F4">Fig. 4</xref>)—which modify the branches of the gene trees. In all cases a rate multiplier is sampled from a Gamma distribution, whose mean is forced to be one to preserve the mean substitution rate, and that therefore can be parameterized by a single <italic>alpha</italic>-shape parameter. Since these multipliers are independently sampled, this approach is equivalent to the use of uncorrelated relaxed clocks (<xref rid="B12" ref-type="bibr">Drummond et al. 2006</xref>).</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Sources of substitution rate heterogeneity among lineages available in <italic>SimPhy</italic>. Each subfigure represents the same simulation scenario but with different types of rate variation. Branches affected by rate variation are highlighted with a different color. Each simulation scenario consists of two independent replicates (rows) of two gene families (columns) in three species (A, B, C) with five individuals (<inline-formula><mml:math id="I27"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I28"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I29"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I30"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I31"><mml:mrow><mml:msub><mml:mtext>C</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). Subfigure a) shows trees simulated without substitution rate heterogeneity—hence ultrametric—with topologies and branch lengths generated by the coalescent process. Subfigure b) depicts a case of species-specific heterogeneity, where changes in rate affect whole ancestral/contemporary species genome-wide (e.g., for every gene family in replicate 1 species A branches evolve faster and species C branches slower). Subfigure c) is an example of gene family-specific heterogeneity, where rate changes affect the total history of specific gene families (note that in this case ultrametricity still holds) (e.g., in replicate 1, gene family (<inline-formula><mml:math id="I32"><mml:mrow><mml:msub><mml:mtext>G</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) evolves much slower than gene family (<inline-formula><mml:math id="I33"><mml:mrow><mml:msub><mml:mtext>G</mml:mtext><mml:mn>n</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>)). Subfigure d) shows gene-by-lineage-specific heterogeneity, where changes in rate affect particular gene tree branches independently (e.g., in replicate 1, gene family (<inline-formula><mml:math id="I34"><mml:mrow><mml:msub><mml:mtext>G</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the ancestral A lineage evolves faster). In addition, the level of heterogeneity can also be modulated among replicates (e.g., in subfigure (c), replicate 1 shows much more heterogeneity than replicate n).</p>
        </caption>
        <graphic xlink:href="syv082f4"/>
      </fig>
      <sec>
        <title>Species-specific substitution rate heterogeneity</title>
        <p>A rate multiplier is sampled for each branch of the species tree, modeling how different species evolve at different speeds—for example, due to ecological conditions, metabolic rates (<xref rid="B33" ref-type="bibr">Martin and Palumbi 1993</xref>) or DNA repair efficiency (<xref rid="B7" ref-type="bibr">Britten 1986</xref>). The <italic>alpha</italic> parameter can be fixed or sampled <italic>de novo</italic> for each species tree (see section ‘Distribution-Driven Parameterization’).</p>
      </sec>
      <sec>
        <title>Gene family-specific substitution rate heterogeneity</title>
        <p>A rate multiplier is sampled for each locus tree (i.e., multiplying all the branches of a given locus tree), modeling how different gene families can evolve at a different pace—for example, due to functional constraints (<xref rid="B27" ref-type="bibr">Li 1997</xref>). The <italic>alpha</italic> parameter can be sampled independently for each species tree.</p>
      </sec>
      <sec>
        <title>Gene-by-lineage-specific substitution rate heterogeneity</title>
        <p>A rate multiplier is sampled for each branch of the gene tree, modeling how different gene tree branches evolve at different speeds due to gene–lineage interactions—for example, due to selective bursts (<xref rid="B50" ref-type="bibr">Wallis 1994</xref>). The <italic>alpha</italic> parameter can be fixed or hierarchically sampled across the different simulation layers (e.g., the most complex parameterization would sample a hyper–hyper parameter for each species tree, a hyper parameter for each locus tree and an alpha parameter per gene tree).</p>
        <p>The baseline substitution rate is measured in number of substitutions per site per generation. Nevertheless, <italic>SimPhy</italic> also takes into account absolute time units and, therefore, incorporates a generation time parameter. To increase flexibility, species-specific generation times can also be specified (see <xref rid="B24" ref-type="bibr">Kohne 1970</xref>).</p>
        <p>Note that if the final objective is the simulation of multiple sequence alignments, a fifth layer of rate variation, in this case among sites (<xref rid="B52" ref-type="bibr">Yang 1996</xref>), can be specified using INDELible.</p>
      </sec>
    </sec>
    <sec>
      <title>Input and Output</title>
      <p><italic>SimPhy</italic> has been implemented in C99 as a non-interactive command line program. Input parameters can be given in the command line or specified in a configuration file. Users can also provide their own species or locus trees in a Nexus file. The program will output more or less information depending on a verbosity level controlled by the user. Output files include a species tree file, a locus tree file with all the locus trees, and one gene tree file per locus tree (typically containing a single gene tree). Depending on the settings, the program can also print out the species tree/locus tree mappings and the locus tree/gene tree mappings. Moreover, <italic>SimPhy</italic> can also generate a SQLite3 database with all the simulation parameters per species, locus, and gene tree and some extra statistics. SimPhy's gene trees can be used to generate multiple sequence alignments in principle with any sequence simulator. To help in this task, the <italic>SimPhy</italic> package includes a script for directly running one of these simulators—INDELible (<xref rid="B14" ref-type="bibr">Fletcher and Yang 2009</xref>)—in a subsequent step.</p>
    </sec>
  </sec>
  <sec>
    <title>V<sc>alidation</sc></title>
    <p>We performed a series of validation experiments, described below, to test that <italic>SimPhy</italic>'s output fits different theoretical or numerical expectations. The entire validation was conducted using in-house Bash, Perl, and R scripts (using APE [<xref rid="B39" ref-type="bibr">Paradis et al. 2004</xref>] and phytools [<xref rid="B42" ref-type="bibr">Revell 2012</xref>]) available as Supplementary Material on Dryad at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.707td">http://dx.doi.org/10.5061/dryad.707td</ext-link>. In addition, the whole simulation process was also carefully checked by hand in the debugging developing stage on several simple scenarios.</p>
    <sec>
      <title>Species Tree Simulation</title>
      <p>For the SSA algorithm, we assayed the Yule process with 10 different birth rates (<inline-formula><mml:math id="I35"><mml:mo>λ</mml:mo></mml:math></inline-formula>) (from 2.67 to 6.67 speciations/1M generations) using 10,000 replicates per level and a fixed tree origin (<inline-formula><mml:math id="I36"><mml:mi>t</mml:mi></mml:math></inline-formula>) (1M generations), and compared the observed mean number of leaves with its theoretical expectation <inline-formula><mml:math id="I37"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>λ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref rid="B36" ref-type="bibr">Mooers et al. 2012</xref>; Supplementary Fig. S1 available as Supplementary Material on Dryad at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.707td">http://dx.doi.org/10.5061/dryad.707td</ext-link>). For the BDSA, we assayed 100 combinations of 10 different birth rates (from 2.67 to 6.67 speciations/1M generations) and 10 taxa sizes (from 50 to 500 species), using 10,000 replicates per combination, and compared the mean tree height with the one obtained using <italic>TreeSim</italic> (<xref rid="B46" ref-type="bibr">Stadler 2011</xref>; Supplementary Fig. S2).</p>
    </sec>
    <sec>
      <title>Locus Tree Simulation</title>
      <p>We validated the observed average gene family size –i.e., after discarding losses and superfluous branches, <inline-formula><mml:math id="I38"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>; <inline-formula><mml:math id="I39"><mml:mrow><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>λ</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We explored 125 parameter combinations of five duplication rates (<inline-formula><mml:math id="I40"><mml:mo>λ</mml:mo></mml:math></inline-formula>) (from 6.67 to 33.3 duplications/10000M generations), five loss rates (<inline-formula><mml:math id="I41"><mml:mo>μ</mml:mo></mml:math></inline-formula>) (from 0.5<inline-formula><mml:math id="I42"><mml:mo>λ</mml:mo></mml:math></inline-formula> to 0.167<inline-formula><mml:math id="I43"><mml:mo>λ</mml:mo></mml:math></inline-formula>) and five number of species (<inline-formula><mml:math id="I44"><mml:mi>l</mml:mi></mml:math></inline-formula>) (from 50 to 250 species), with a fixed species tree height (<inline-formula><mml:math id="I45"><mml:mi>t</mml:mi></mml:math></inline-formula>) (1000M generations) and 10000 replicates per combination (Supplementary Fig. S3). In addition, since gene family size is not affected by HGT or GC, we tested the expected number of HGT events <inline-formula><mml:math id="I46"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> under 25 parameter combinations of five different HGT rates (<inline-formula><mml:math id="I47"><mml:mi>h</mml:mi></mml:math></inline-formula>) (from one to 20 transfers/1M generations) and five locus tree lengths (<inline-formula><mml:math id="I48"><mml:mi>l</mml:mi></mml:math></inline-formula>) (from 42 to 260 M generations), with 10000 replicates per combination (Supplementary Fig. S4).</p>
    </sec>
    <sec>
      <title>Gene Tree Simulation</title>
      <p>We validated the simulation of the multispecies coalescent comparing the time to the most recent common ancestor (TMRCA) obtained with <italic>SimPhy</italic> and DendroPy (<xref rid="B47" ref-type="bibr">Sukumaran and Holder 2010</xref>) on 50 different scenarios (number of species sampled from a Uniform(50,500), speciation rate of one speciation/1M generations and effective population size sampled from a Lognormal(14,0.4)) with a total of 10,000 gene trees (Supplementary Fig. S5). The multilocus coalescent process was validated using a similar approach, comparing the average TMRCAs of the subtrees modeled by the bounded multispecies coalescent process obtained with <italic>SimPhy</italic> and DLCoal_sim (fixed species tree, five locus trees, duplication rate 0.2 duplications/1M generations and effective population size 1M individuals) with a total of 10,000 gene trees (Supplementary Fig. S6).</p>
      <p>All the validation checks were clearly successful, showing only negligible deviations from the expectations or when compared to other simulations programs in spite of the large variance induced by the different evolutionary processes implemented.</p>
    </sec>
  </sec>
  <sec>
    <title>B<sc>enchmarking</sc></title>
    <p>We carried out four experiments to characterize <italic>SimPhy</italic>'s computational efficiency and scalability, where central processing unit (CPU) time was defined as the sum of user and system time returned by the Berkeley Software Distribution (BSD) time command. For scenarios without HGT or GC, we also computed the running times of DLCoal_sim (<xref rid="B41" ref-type="bibr">Rasmussen and Kellis 2012</xref>). For simplicity we used a classic grid-like parameterization with 10 replicates per scenario and one individual per species. All the output options of <italic>SimPhy</italic> were active. Errors and running times over 300 seconds were treated as missing data. All the analyses were run in a MacBook Pro Intel Core i7 2.3Ghz, 8GB of RAM, and a Solid State Drive. A generalized linear model with a Gamma error distribution was fitted to the resulting data to assess the relationship between running times and the variables studied. All the scripts used to carry out this benchmarking are available as Supplementary Material on Dryad at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.707td">http://dx.doi.org/10.5061/dryad.707td</ext-link>.</p>
    <sec>
      <title>Benchmark 1</title>
      <p>The first benchmark was designed to check the general performance and scalability of <italic>SimPhy</italic> with an increasing number of gene trees simulated under the joint effect of ILS, GDL, HGT, and GC (<xref ref-type="fig" rid="F5">Fig. 5</xref>). We simulated 30 different scenarios under three different schemes (#species trees/#locus trees per species tree/#gene trees per locus tree): 1/1/100-1000, 1/100-1000/1 and 100-1000/1/1. For each scenario, we simulated 50-taxon species trees with a tree height of 1M generations, a speciation rate of 0.00001 speciations/generation, and an effective population size of 10000. We specified moderate but equal duplication, loss, HGT, and GC rates (0.5 events/1M generations). <italic>SimPhy</italic> is extremely fast and scales linearly with the number of trees (<xref ref-type="fig" rid="F5">Fig. 5</xref>). For example, it generates 1000 gene trees for 50 species under a complex model with ILS, GDL, HGT, and GC in less than 2 s.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p><italic>SimPhy</italic>'s running time against the number of gene trees simulated. A generalized linear model with a Gamma error distribution and the identity function as link was fitted to each data series. See section ‘Benchmark 1’ for the simulation details.</p>
        </caption>
        <graphic xlink:href="syv082f5"/>
      </fig>
    </sec>
    <sec>
      <title>Benchmark 2</title>
      <p>This benchmark was intended to compare <italic>SimPhy</italic> and DLCoal_sim   under a very simple model, with only moderate levels of ILS. We designed 10 scenarios with 10 numbers of species, varying from 50 to 500. For each scenario, we simulated a single species tree, assuming a speciation rate of 1 speciation/1M generations, an effective population size of 10,000, and generated 100 gene families. <italic>SimPhy</italic> scales linearly with the number of species, while DLCoal_sim only does the same for small species trees, being unable to complete simulations with more than 300 species (Supplementary Fig. S8). Remarkably, <italic>SimPhy</italic> was at least one order of magnitude faster than DLCoal_sim. This might be explained by the fact that <italic>SimPhy</italic> differentiates subtrees that can be modeled by the multispecies coalescent from those that require the bounded alternative, using a much faster and less error-prone algorithm for the former situation. Moreover, in the absence of GDL, HGT, or GC, locus trees and species trees are equivalent, so in these cases <italic>SimPhy</italic> directly uses the species trees as locus trees instead of simulating them <italic>de novo</italic>. In addition, <italic>SimPhy</italic> and <italic>DLCoal_sim</italic> also have important implementation differences—for example, data structures, coding language—which make <italic>SimPhy</italic> faster in most scenarios. Finally, <italic>SimPhy</italic> uses a multiple precision library for very complex scenarios to favor its scalability.</p>
    </sec>
    <sec>
      <title>Benchmark 3</title>
      <p>In this case, we characterized <italic>SimPhy</italic>'s and DLCoal_sim's running times for a model with moderate levels of ILS and GDL. We designed 30 scenarios, with 100, 200, and 300 species and 10 duplication rates from 1 to 3.25 duplications/1M generations. For each scenario, we simulated a single species tree, assuming a speciation rate of 0.1 speciations/1M generations an effective population size of 10,000, and generated 100 gene families. Logically, duplications increased the running time for both programs, but with <italic>SimPhy</italic> still being much faster than <italic>DLCoal_sim</italic> (Supplementary Fig. S9). Moreover, <italic>DLCoal_sim</italic> showed again important scalability problems, being unable to simulate trees with 300 species.</p>
    </sec>
    <sec>
      <title>Benchmark 4</title>
      <p>Here we aimed to evaluate the sampling efficiency of the multilocus coalescent model by exploring a model with various levels of GLD and ILS. We designed 30 scenarios with 10 effective population sizes—from 976 to 500,000 individuals—and three duplication rates—0, 1, and 2 duplications/1M generations. For each scenario we simulated a single 100-taxon species tree, assuming a speciation rate of 10 speciations/1M generations and a tree height of 0.5 M generations, and generated 100 gene families. For both programs we observed an important increase in execution time with higher ILS in the presence of duplications, and almost no effect in their absence (<xref ref-type="fig" rid="F6">Fig. 6</xref>). Importantly, <italic>SimPhy</italic> was again at least one order of magnitude faster and scales much better than <italic>DLCoal_sim</italic>. Several <italic>DLCoal_sim</italic> replicates were allowed to run beyond the 300 s limit but did not finish even after 24 h. This behavior is likely reflecting a problem in the rejection sampling algorithm that <italic>DLCoal_sim</italic> uses to sample the bounded multispecies coalescent (specifically the lineage counts), since this algorithm is prone to get stuck sampling highly improbable scenarios. On the other hand, <italic>SimPhy</italic> uses an alternative sampling strategy (see section ‘Simulation Process’ and Online Appendix 1) that seems to effectively mitigate this problem.</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Running time comparison between <italic>SimPhy</italic> and DLCoal_sim under a GDL+ILS model. Scatter plot of the time needed by the two simulators to generate 100 gene trees from 100 locus trees using three different duplication rates (duplications/1M generations) under different effective population sizes. A generalized linear model with a Gamma error distribution and the inverse function as link was fitted to each data series. DLCoal_sim's execution times over 150 s are not shown.</p>
        </caption>
        <graphic xlink:href="syv082f6"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>T<sc>est</sc>-C<sc>ase</sc> S<sc>tudy</sc>: D<sc>uplication</sc> T<sc>ime</sc> O<sc>verestimation of</sc> DL R<sc>econciliations</sc></title>
    <p>We have previously shown that the most recent common ancestor (MRCA) of a new gene originated by duplication and its paralog does not necessarily coincide with the individual where this duplication first occurred, generating a systematic overestimation of the duplication time for locus tree unaware reconciliation methods (<xref rid="B32" ref-type="bibr">Mallo et al. 2014b</xref>; <xref ref-type="fig" rid="F7">Fig. 7</xref>). Here we further explored this issue by quantifying this overestimation in more complex scenarios for which theoretical expectations are not available. To do so, we simulated 1,000,000 replicates with a number of species uniformly distributed from 25 to 200, with a fixed speciation rate (10 speciations / 1M time units), an effective population size uniformly distributed from 1000 to 10,000 individuals, and with just one gene family per genome. The locus tree simulation was parameterized with a duplication rate sampled from a Uniform distribution of 0.05 to 0.5 events/1M generation, and with a number of individuals per species uniformly ranging from one to five. To check the relationship between the simulated parameters and the overestimation bias, we performed a stepwise selection under the Akaike information criterion (AIC) of a generalized linear model with Gamma error distribution and inverse link on a linear combination of all the simulation parameters. As dependent variable we used the mean of the distance between the real duplication node (locus tree) and the first coalescence between lineages coming from the two different paralogs for all the duplications for each simulation replicate.</p>
    <fig id="F7" orientation="portrait" position="float">
      <label>Figure 7.</label>
      <caption>
        <p>Expected overestimation of the time of gene duplication induced by species tree/gene tree reconciliation methods that do not consider locus trees. The figure represents the evolutionary history and expected overestimation of the duplication time for two paralogous copies (<inline-formula><mml:math id="I49"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mo>α</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="I50"><mml:mrow><mml:msub><mml:mtext>A</mml:mtext><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>) in a single individual (A). The gene tree (thin black lines) evolves inside the locus tree (medium-thick lines) along a species tree branch (light gray shadow in the background). The duplication takes place in the gene copy represented by a square, whose lineage in the original locus does not reach the present (dashed line). For haploid populations, the expected overestimation is <italic>Ne</italic> generations.</p>
      </caption>
      <graphic xlink:href="syv082f7"/>
    </fig>
    <p>Our results show that the effective population size increases the overestimation bias, while the number of individuals per species and the duplication rate have the opposite effect, being the only three parameters retained in the best-fit linear model. That a larger effective population size increases the overestimation bias is expected, as the coalescent time of any two lineages grows with it. An increasing number of individuals per species should reduce this bias, as with more lineages going through the duplication node the time for the first coalescence among paralogs decreases. The effect of the duplication rate, inversely correlated with this bias, is less clear. Nevertheless, it can be tentatively explained by the coalescent bounds imposed by duplications. Expected coalescent times along a bounded subtree are shorter than along an unbounded subtree, since the probability of coalescence is scaled by the probability of the TMRCA being less or equal to the bound (i.e., we can think of the unbounded coalescent as a bounded coalescent with the bound in the infinite, and therefore scaled by one). Thus, the bigger the duplication rate, the bigger the probability of having duplications in bounded subtrees, and the bigger the reduction on the expected duplication time overestimation generated by the coalescent bounds.</p>
    <p>Interestingly, we can conclude that the expected overestimation for the simplest case—2Ne for one diploid individual with two paralogs; (<xref rid="B32" ref-type="bibr">Mallo et al. 2014b</xref>)—constitutes an upper bound, with a smaller bias expected in more complex scenarios (with duplications and multiple individuals per species). Finally, we also note that the size of the species tree did not seem to play a significant role in this case.</p>
  </sec>
  <sec>
    <title>C<sc>onclusion</sc></title>
    <p>We have introduced, validated, and benchmarked <italic>SimPhy</italic>, to our knowledge, the first software that simulates gene tree family evolution under the three main evolutionary processes that generates species tree/gene tree incongruence—ILS, GDL, and HGT. This, together with its comprehensive heterogeneity models and the parameter sampling strategy should help <italic>SimPhy</italic> becoming a powerful phylogenomic tool. We have also conducted a simple case study to show a potential application (duplication time overestimation), but we envision many more to come. In fact, <italic>SimPhy</italic> has been already used to validate at least three species tree reconstruction methods (<xref rid="B11" ref-type="bibr">De Oliveira Martins et al. 2014</xref>; <xref rid="B3" ref-type="bibr">Bayzid et al. 2015</xref>; <xref rid="B35" ref-type="bibr">Mirarab and Warnow 2015</xref>).</p>
  </sec>
  <sec>
    <title>A<sc>vailability</sc></title>
    <p><italic>SimPhy</italic> is distributed under the license GNU GPL v3. It is written in C and it relies on four libraries, the GNU Scientific Library (GSL), the GNU Multiple Precision Arithmetic Library (GMP), the GNU MPFR Library, and SQLite3. Users can find the source code, precompiled executables, a detailed manual and example cases on a GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/adamallo/SimPhy">https://github.com/adamallo/SimPhy</ext-link>, last accessed November 17, 2015). We provide two flavors of precompiled executables, for Linux—which passed 73 out of 74 tests for the 64 bits version and 84 out of 87 tests for the 32 bits version under the Linux Standard Base distribution checker—and MacOSX systems.</p>
  </sec>
</body>
<back>
  <ack>
    <title>A<sc>cknowledgments</sc></title>
    <p>We want to thank Tanja Stadler for her kind help in the early-stage development of <italic>SimPhy</italic> (birth–death process sampling algorithms), and Erick Matsen, Jeet Sukumaran, Bastien Boussau, Laura Kubatko, and Frank Anderson for their very helpful comments.</p>
  </ack>
  <sec>
    <title>S<sc>upplementary</sc> M<sc>aterial</sc></title>
    <p>Data available from the Dryad Digital Repository: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.707td">http://dx.doi.org/10.5061/dryad.707td</ext-link>.</p>
  </sec>
  <sec>
    <title>F<sc>unding</sc></title>
    <p>This work was supported by the <funding-source>European Research Council</funding-source> (<award-id>ERC-2007Stg 203161—PHYGENOM</award-id> to D. P.) and the <funding-source>Spanish Government</funding-source> (research grant <award-id>BFU2012-33038</award-id> to D. P. and FPI fellowship <award-id>BES-2010-031014</award-id> to D. M.).</p>
  </sec>
  <ref-list>
    <title>R<sc>eferences</sc></title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arenas</surname><given-names>M.</given-names></name><name><surname>Posada</surname><given-names>D.</given-names></name></person-group><year>2014</year><article-title>Simulation of genome-wide evolution under heterogeneous substitution models and complex multispecies coalescent histories</article-title>. <source>Mol. Biol. Evol.</source><volume>31</volume>:<fpage>1295</fpage>–<lpage>1301</lpage>.<pub-id pub-id-type="pmid">24557445</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arvestad</surname><given-names>L.</given-names></name><name><surname>Berglund</surname><given-names>A.C.</given-names></name><name><surname>Lagergren</surname><given-names>J.</given-names></name><name><surname>Sennblad</surname><given-names>B.</given-names></name></person-group><year>2003</year><article-title>Bayesian gene/species tree reconciliation and orthology analysis using mcmc</article-title>. <source>Bioinformatics</source><volume>19</volume> (<issue>1 Suppl</issue>):<fpage>i7</fpage>–<lpage>i15</lpage>.<pub-id pub-id-type="pmid">12855432</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayzid</surname><given-names>M.S.</given-names></name><name><surname>Mirarab</surname><given-names>S.</given-names></name><name><surname>Boussau</surname><given-names>B.</given-names></name><name><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2015</year><article-title>Weighted statistical binning: enabling statistically consistent genome-scale phylogenetic analyses</article-title>. <source>PLoS One</source><volume>10</volume>:<fpage>e0129183</fpage>.<pub-id pub-id-type="pmid">26086579</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayzid</surname><given-names>M.S.</given-names></name><name><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2013</year><article-title>Naive binning improves phylogenomic analyses</article-title>. <source>Bioinformatics</source>.</mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beiko</surname><given-names>R.G.</given-names></name><name><surname>Charlebois</surname><given-names>R.L.</given-names></name></person-group><year>2007</year><article-title>A simulation test bed for hypotheses of genome evolution</article-title>. <source>Bioinformatics</source><volume>23</volume>:<fpage>825</fpage>–<lpage>831</lpage>.<pub-id pub-id-type="pmid">17267425</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boussau</surname><given-names>B.</given-names></name><name><surname>Szollosi</surname><given-names>G.J.</given-names></name><name><surname>Duret</surname><given-names>L.</given-names></name><name><surname>Gouy</surname><given-names>M.</given-names></name><name><surname>Tannier</surname><given-names>E.</given-names></name><name><surname>Daubin</surname><given-names>V.</given-names></name></person-group><year>2013</year><article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res.</source><volume>23</volume>:<fpage>323</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britten</surname><given-names>R.J.</given-names></name></person-group><year>1986</year><article-title>Rates of DNA-sequence evolution differ between taxonomic groups</article-title>. <source>Science</source><volume>231</volume>:<fpage>1393</fpage>–<lpage>1398</lpage>.<pub-id pub-id-type="pmid">3082006</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaudhary</surname><given-names>R.</given-names></name><name><surname>Bansal</surname><given-names>M.S.</given-names></name><name><surname>Wehe</surname><given-names>A.</given-names></name><name><surname>Fernandez-Baca</surname><given-names>D.</given-names></name><name><surname>Eulenstein</surname><given-names>O.</given-names></name></person-group><year>2010</year><article-title>Igtp: a software package for large-scale gene tree parsimony analysis</article-title>. <source>BMC Bioinform.</source><volume>11</volume>:<fpage>574</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalquen</surname><given-names>D.A.</given-names></name><name><surname>Anisimova</surname><given-names>M.</given-names></name><name><surname>Gonnet</surname><given-names>G.H.</given-names></name><name><surname>Dessimoz</surname><given-names>C.</given-names></name></person-group><year>2012</year><article-title>Alf-a simulation framework for genome evolution</article-title>. <source>Mol. Biol. Evol.</source><volume>29</volume>:<fpage>1115</fpage>–<lpage>1123</lpage>.<pub-id pub-id-type="pmid">22160766</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darriba</surname><given-names>D.</given-names></name><name><surname>Taboada</surname><given-names>G.L.</given-names></name><name><surname>Doallo</surname><given-names>R.</given-names></name><name><surname>Posada</surname><given-names>D.</given-names></name></person-group><year>2012</year><article-title>Jmodeltest 2: more models, new heuristics and parallel computing</article-title>. <source>Nat. Methods</source><volume>9</volume>:<fpage>772</fpage>.<pub-id pub-id-type="pmid">22847109</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Oliveira Martins</surname><given-names>L.</given-names></name><name><surname>Mallo</surname><given-names>D.</given-names></name><name><surname>Posada</surname><given-names>D.</given-names></name></person-group><year>2014</year><article-title>A Bayesian supertree model for genome-wide species tree reconstruction</article-title>. <source>Syst. Biol.</source></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>A.J.</given-names></name><name><surname>Ho</surname><given-names>S.Y.</given-names></name><name><surname>Phillips</surname><given-names>M.J.</given-names></name><name><surname>Rambaut</surname><given-names>A.</given-names></name></person-group><year>2006</year><article-title>Relaxed phylogenetics and dating with confidence</article-title>. <source>PLoS Biol.</source><volume>4</volume>:<fpage>e88</fpage>.<pub-id pub-id-type="pmid">16683862</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>S.V.</given-names></name></person-group><year>2009</year><article-title>Is a new and general theory of molecular systematics emerging?</article-title><source>Evolution</source><volume>63</volume>:<fpage>1</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">19146594</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fletcher</surname><given-names>W.</given-names></name><name><surname>Yang</surname><given-names>Z.H.</given-names></name></person-group><year>2009</year><article-title>Indelible: a flexible simulator of biological sequence evolution</article-title>. <source>Mol. Biol. Evol.</source><volume>26</volume>:<fpage>1879</fpage>–<lpage>1888</lpage>.<pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galtier</surname><given-names>N.</given-names></name></person-group><year>2007</year><article-title>A model of horizontal gene transfer and the bacterial phylogeny problem</article-title>. <source>Syst. Biol.</source><volume>56</volume>:<fpage>633</fpage>–<lpage>642</lpage>.<pub-id pub-id-type="pmid">17661231</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodman</surname><given-names>M.</given-names></name><name><surname>Czelusniak</surname><given-names>J.</given-names></name><name><surname>Moore</surname><given-names>G.</given-names></name><name><surname>Romero-Herrera</surname><given-names>A.</given-names></name><name><surname>Matsuda</surname><given-names>G.</given-names></name></person-group><year>1979</year><article-title>Fitting the gene lineage into its species lineage, a parsimony strategy illustrated by cladograms constructed from globin sequences</article-title>. <source>Syst. Zool.</source><volume>28</volume>:<fpage>132</fpage>–<lpage>163</lpage>.</mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>K.</given-names></name><name><surname>Wong</surname><given-names>D.</given-names></name><name><surname>Stadler</surname><given-names>T.</given-names></name></person-group><year>2010</year><article-title>Sampling trees from evolutionary models</article-title>. <source>Syst. Biol.</source><volume>59</volume>:<fpage>465</fpage>–<lpage>476</lpage>.<pub-id pub-id-type="pmid">20547782</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heled</surname><given-names>J.</given-names></name><name><surname>Bryant</surname><given-names>D.</given-names></name><name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2013</year><article-title>Simulating gene trees under the multispecies coalescent and time-dependent migration</article-title>. <source>BMC Evol. Biol.</source><volume>13</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">23418788</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heled</surname><given-names>J.</given-names></name><name><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group><year>2010</year><article-title>Bayesian inference of species trees from multilocus data</article-title>. <source>Mol. Biol. Evol.</source><volume>27</volume>:<fpage>570</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">19906793</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ho</surname><given-names>S.Y.</given-names></name><name><surname>Lanfear</surname><given-names>R.</given-names></name><name><surname>Bromham</surname><given-names>L.</given-names></name><name><surname>Phillips</surname><given-names>M.J.</given-names></name><name><surname>Soubrier</surname><given-names>J.</given-names></name><name><surname>Rodrigo</surname><given-names>A.G.</given-names></name><name><surname>Cooper</surname><given-names>A.</given-names></name></person-group><year>2011</year><article-title>Time-dependent rates of molecular evolution</article-title>. <source>Mol. Ecol.</source><volume>20</volume>:<fpage>3087</fpage>–<lpage>3101</lpage>.<pub-id pub-id-type="pmid">21740474</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>R.R.</given-names></name></person-group><year>2002</year><article-title>Generating samples under a wright-fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source><volume>18</volume>:<fpage>337</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeffroy</surname><given-names>O.</given-names></name><name><surname>Brinkmann</surname><given-names>H.</given-names></name><name><surname>Delsuc</surname><given-names>F.</given-names></name><name><surname>Philippe</surname><given-names>H.</given-names></name></person-group><year>2006</year><article-title>Phylogenomics: the beginning of incongruence?</article-title><source>Trends Genet.</source><volume>22</volume>:<fpage>225</fpage>–<lpage>231</lpage>.<pub-id pub-id-type="pmid">16490279</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kendall</surname><given-names>D.G.</given-names></name></person-group><year>1948</year><article-title>On the generalized “birth-and-death” process</article-title>. <source>Ann. Math. Statist.</source><volume>19</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohne</surname><given-names>D.E.</given-names></name></person-group><year>1970</year><article-title>Evolution of higher-organism DNA</article-title>. <source>Q. Rev. Biophys.</source><volume>3</volume>:<fpage>327</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">4989149</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leache</surname><given-names>A.D.</given-names></name><name><surname>Rannala</surname><given-names>B.</given-names></name></person-group><year>2011</year><article-title>The accuracy of species tree estimation under simulation: a comparison of methods</article-title>. <source>Syst. Biol.</source><volume>60</volume>:<fpage>126</fpage>–<lpage>137</lpage>.<pub-id pub-id-type="pmid">21088009</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leigh</surname><given-names>J.W.</given-names></name><name><surname>Bryant</surname><given-names>D.</given-names></name></person-group><year>2015</year><article-title>Monte carlo strategies for selecting parameter values in simulation experiments</article-title>. <source>Syst. Biol.</source></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W.-H.</given-names></name></person-group><year>1997</year><source>Molecular evolution</source>. <publisher-loc>Sunderland, MA</publisher-loc>: <publisher-name>Sinauer Associates, Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>L.</given-names></name><name><surname>Yu</surname><given-names>L.</given-names></name><name><surname>Edwards</surname><given-names>S.V.</given-names></name></person-group><year>2010</year><article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>. <source>BMC Evol. Biol.</source><volume>10</volume>:<fpage>302</fpage>.<pub-id pub-id-type="pmid">20937096</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>W.</given-names></name></person-group><year>1997</year><article-title>Gene trees in species trees</article-title>. <source>Syst. Biol.</source><volume>46</volume>:<fpage>523</fpage>–<lpage>536</lpage>.</mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="other">Maddison, W.P., Maddison D.R. 2009. Mesquite: a modular system for evolutionary analysis. Version 2.7 <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org">http://mesquiteproject.org</ext-link></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mallo</surname><given-names>D.</given-names></name><name><surname>de Oliveira Martins</surname><given-names>L.</given-names></name><name><surname>Posada</surname><given-names>D.</given-names></name></person-group><year>2014a</year><source>Estimation of species trees. eLS</source>. <publisher-loc>Chichester</publisher-loc>: <publisher-name>John Wiley &amp; Sons Ltd</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallo</surname><given-names>D.</given-names></name><name><surname>De Oliveira Martins</surname><given-names>L.</given-names></name><name><surname>Posada</surname><given-names>D.</given-names></name></person-group><year>2014b</year><article-title>Unsorted homology within locus and species trees</article-title>. <source>Syst. Biol.</source><volume>63</volume>:<fpage>988</fpage>–<lpage>992</lpage>.<pub-id pub-id-type="pmid">25077514</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>A.P.</given-names></name><name><surname>Palumbi</surname><given-names>S.R.</given-names></name></person-group><year>1993</year><article-title>Body size, metabolic rate, generation time, and the molecular clock</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>90</volume>:<fpage>4087</fpage>–<lpage>4091</lpage>.<pub-id pub-id-type="pmid">8483925</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirarab</surname><given-names>S.</given-names></name><name><surname>Bayzid</surname><given-names>M.S.</given-names></name><name><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2014</year><article-title>Evaluating summary methods for multilocus species tree estimation in the presence of incomplete lineage sorting</article-title>. <source>Syst. Biol.</source></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirarab</surname><given-names>S.</given-names></name><name><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2015</year><article-title>Astral-ii: coalescent-based species tree estimation with many hundreds of taxa and thousands of genes</article-title>. <source>Bioinformatics</source><volume>31</volume>:<fpage>i44</fpage>–<lpage>i52</lpage>.<pub-id pub-id-type="pmid">26072508</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mooers</surname><given-names>A.</given-names></name><name><surname>Gascuel</surname><given-names>O.</given-names></name><name><surname>Stadler</surname><given-names>T.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Steel</surname><given-names>M.</given-names></name></person-group><year>2012</year><article-title>Branch lengths on birth-death trees and the expected loss of phylogenetic diversity</article-title>. <source>Syst. Biol.</source><volume>61</volume>:<fpage>195</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">21865336</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Page</surname><given-names>R.D.</given-names></name><name><surname>Charleston</surname><given-names>M.A.</given-names></name></person-group><year>1997</year><article-title>From gene to organismal phylogeny: reconciled trees and the gene tree/species tree problem</article-title>. <source>Mol. Phylogenet. Evol.</source><volume>7</volume>:<fpage>231</fpage>–<lpage>240</lpage>.<pub-id pub-id-type="pmid">9126565</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pamilo</surname><given-names>P.</given-names></name><name><surname>Nei</surname><given-names>M.</given-names></name></person-group><year>1988</year><article-title>Relationships between gene trees and species trees</article-title>. <source>Mol. Biol. Evol.</source><volume>5</volume>:<fpage>568</fpage>–<lpage>583</lpage>.<pub-id pub-id-type="pmid">3193878</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paradis</surname><given-names>E.</given-names></name><name><surname>Claude</surname><given-names>J.</given-names></name><name><surname>Strimmer</surname><given-names>K.</given-names></name></person-group><year>2004</year><article-title>Ape: Analyses of phylogenetics and evolution in r language</article-title>. <source>Bioinformatics</source><volume>20</volume>:<fpage>289</fpage>–<lpage>290</lpage>.<pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B.</given-names></name><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2003</year><article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title>. <source>Genetics</source><volume>164</volume>:<fpage>1645</fpage>–<lpage>1656</lpage>.<pub-id pub-id-type="pmid">12930768</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasmussen</surname><given-names>M.D.</given-names></name><name><surname>Kellis</surname><given-names>M.</given-names></name></person-group><year>2012</year><article-title>Unified modeling of gene duplication, loss, and coalescence using a locus tree</article-title>. <source>Genome Res.</source><volume>22</volume>:<fpage>755</fpage>–<lpage>765</lpage>.<pub-id pub-id-type="pmid">22271778</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Revell</surname><given-names>L.J.</given-names></name></person-group><year>2012</year><article-title>Phytools: An r package for phylogenetic comparative biology (and other things) Methods Ecol</article-title>. <source>Evol.</source><volume>3</volume>:<fpage>217</fpage>–<lpage>223</lpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salichos</surname><given-names>L.</given-names></name><name><surname>Rokas</surname><given-names>A.</given-names></name></person-group><year>2013</year><article-title>Inferring ancient divergences requires genes with strong phylogenetic signals</article-title>. <source>Nature</source><volume>497</volume>:<fpage>327</fpage>–<lpage>331</lpage>.<pub-id pub-id-type="pmid">23657258</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sjostrand</surname><given-names>J.</given-names></name><name><surname>Arvestad</surname><given-names>L.</given-names></name><name><surname>Lagergren</surname><given-names>J.</given-names></name><name><surname>Sennblad</surname><given-names>B.</given-names></name></person-group><year>2013</year><article-title>Genphylodata: Realistic simulation of gene family evolution</article-title>. <source>BMC Bioinform.</source><volume>14</volume>:<fpage>209</fpage>.</mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staab</surname><given-names>P.R.</given-names></name><name><surname>Zhu</surname><given-names>S.</given-names></name><name><surname>Metzler</surname><given-names>D.</given-names></name><name><surname>Lunter</surname><given-names>G.</given-names></name></person-group><year>2015</year><article-title>Scrm: efficiently simulating long sequences using the approximated coalescent with recombination</article-title>. <source>Bioinformatics</source><volume>31</volume>:<fpage>1680</fpage>–<lpage>1682</lpage>.<pub-id pub-id-type="pmid">25596205</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T.</given-names></name></person-group><year>2011</year><article-title>Simulating trees with a fixed number of extant species</article-title>. <source>Syst. Biol.</source><volume>60</volume>:<fpage>676</fpage>–<lpage>684</lpage>.<pub-id pub-id-type="pmid">21482552</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sukumaran</surname><given-names>J.</given-names></name><name><surname>Holder</surname><given-names>M.T.</given-names></name></person-group><year>2010</year><article-title>Dendropy: a python library for phylogenetic computing</article-title>. <source>Bioinformatics</source><volume>26</volume>:<fpage>1569</fpage>–<lpage>1571</lpage>.<pub-id pub-id-type="pmid">20421198</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szollosi</surname><given-names>G.J.</given-names></name><name><surname>Tannier</surname><given-names>E.</given-names></name><name><surname>Lartillot</surname><given-names>N.</given-names></name><name><surname>Daubin</surname><given-names>V.</given-names></name></person-group><year>2013</year><article-title>Lateral gene transfer from the dead</article-title>. <source>Syst. Biol.</source><volume>62</volume>:<fpage>386</fpage>–<lpage>397</lpage>.<pub-id pub-id-type="pmid">23355531</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahata</surname><given-names>N.</given-names></name></person-group><year>1989</year><article-title>Gene geneology in three related populations: consistency probability between gene and population trees</article-title>. <source>Genetics</source><volume>122</volume>:<fpage>957</fpage>–<lpage>966</lpage>.<pub-id pub-id-type="pmid">2759432</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallis</surname><given-names>M.</given-names></name></person-group><year>1994</year><article-title>Variable evolutionary rates in the molecular evolution of mammalian growth hormones</article-title>. <source>J. Mol. Evol.</source><volume>38</volume>:<fpage>619</fpage>–<lpage>627</lpage>.<pub-id pub-id-type="pmid">8083887</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J.</given-names></name><name><surname>Warnow</surname><given-names>T.</given-names></name></person-group><year>2011</year><article-title>Fast and accurate methods for phylogenomic analyses</article-title>. <source>BMC Bioinform.</source><volume>12</volume> (<issue>9 Suppl</issue>):<fpage>S4</fpage>.</mixed-citation>
    </ref>
    <ref id="B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1996</year><article-title>Among-site rate variation and its impact on phylogenetic analysis</article-title>. <source>Trends Ecol. Evol.</source><volume>11</volume>:<fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">21237881</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yule</surname><given-names>G.U.</given-names></name></person-group><year>1925</year><article-title>A mathematical theory of evolution, based on the conclusions of Dr. J. C. Willis, f.R.S</article-title>. <source>Phil. Trans. R. Soc. Lond. B</source><volume>213</volume>:<fpage>21</fpage>–<lpage>87</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
