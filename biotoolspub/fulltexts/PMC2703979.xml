<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub May-14-2009?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2703979</article-id>
    <article-id pub-id-type="pmid">19443440</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkp371</article-id>
    <article-id pub-id-type="publisher-id">gkp371</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>jpHMM: Improving the reliability of recombination prediction in HIV-1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schultz</surname>
          <given-names>Anne-Kathrin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Ming</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bulla</surname>
          <given-names>Ingo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leitner</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Korber</surname>
          <given-names>Bette</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morgenstern</surname>
          <given-names>Burkhard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stanke</surname>
          <given-names>Mario</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Institut für Mikrobiologie und Genetik, Abteilung für Bioinformatik, Georg-August-Universität Göttingen, Goldschmidtstr. 1, 37077, Göttingen, Germany, <sup>2</sup>T-6, Los Alamos National Laboratory, <sup>3</sup>Center for Nonlinear Studies, Los Alamos National Laboratory, Los Alamos, NM 87545 and <sup>4</sup>The Santa Fe Institute, Santa Fe, NM 87501, USA</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+49 551 3914926</phone>; Fax: <fax>+49 551 3914929</fax>; Email: <email>mstanke@gwdg.de</email>, <email>mario.stanke@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>5</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>37</volume>
    <issue>Web Server issue</issue>
    <fpage>W647</fpage>
    <lpage>W651</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Previously, we developed jumping profile hidden Markov model (jpHMM), a new method to detect recombinations in HIV-1 genomes. The jpHMM predicts recombination breakpoints in a query sequence and assigns to each position of the sequence one of the major HIV-1 subtypes. Since incorrect subtype assignment or recombination prediction may lead to wrong conclusions in epidemiological or vaccine research, information about the reliability of the predicted parental subtypes and breakpoint positions is valuable. For this reason, we extended the output of jpHMM to include such information in terms of ‘uncertainty’ regions in the recombination prediction and an interval estimate of the breakpoint. Both types of information are computed based on the posterior probabilities of the subtypes at each query sequence position. Our results show that this extension strongly improves the reliability of the jpHMM recombination prediction. The jpHMM is available online at <ext-link ext-link-type="uri" xlink:href="http://jphmm.gobics.de/">http://jphmm.gobics.de/</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Viruses of the so-called M (Major) Group of HIV-1 are mainly responsible for the HIV pandemic. This clade has been divided into nine genetic subtypes, A–D, F–H, J, K and four sub-subtypes (A1, A2, F1, F2) (<xref ref-type="bibr" rid="B1">1</xref>). Among these subtypes, recombination is extremely common (<xref ref-type="bibr" rid="B2">2</xref>). Recombinants that have been epidemiologically successful are called ‘circulating recombinant forms’ (CRF). Up to now, &gt;40 CRFs and many ‘unique recombinant forms’ (URF) have been identified and the number is increasing (<ext-link ext-link-type="uri" xlink:href="http://hiv.lanl.gov/">http://hiv.lanl.gov/</ext-link>). The accurate classification of HIV-1 genomes and the identification of recombinants, including precise breakpoint definitions, is important in many aspects, such as the design of potential vaccines and treatment strategies against HIV, as well as for epidemiological monitoring of HIV-1. For this challenging task, a wide variety of recombination detection tools has been developed. The most widely used HIV subtyping tool is Simplot (<xref ref-type="bibr" rid="B3">3</xref>), which has also been applied to many other viruses. For a query sequence it provides a graph reflecting the similarity of the sequence to a panel of reference sequences and predicts recombination breakpoints. RIP 3.0 (<ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/content/sequence/RIP/RIP.html">http://www.hiv.lanl.gov/content/sequence/RIP/RIP.html</ext-link>) also identifies recombination in a query sequence by calculating its similarity to a background alignment of HIV-1 sequences of different subtypes in a sliding window. Depending on how significantly better the ‘best matching’ background sequence is than the second best match, ‘uncertainty regions’ in the recombination prediction can be defined. The REGA HIV-1 subtyping tool (<xref ref-type="bibr" rid="B4">4</xref>) uses phylogenetic methods to identify the subtype of a query sequence and further analyses the sequence for recombination using bootscanning methods. Exact recombination breakpoint positions are not predicted, but the assignment to known CRFs is possible.</p>
    <p>Previously, we developed jpHMM (jumping profile hidden Markov model), a method to detect genomic recombinations in HIV-1 (<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>) and to accurately locate recombination breakpoints. The jpHMM is a probabilistic generalization of the jumping alignment algorithm proposed by Spang <italic>et al</italic>. (<xref ref-type="bibr" rid="B7">7</xref>). For an HIV-1 genomic sequence, jpHMM predicts whether it is a recombinant of different subtypes. If so, it estimates the recombination breakpoint positions and assigns to each segment in between two breakpoints a parental subtype among the major HIV-1 subtypes. The predicted recombination pattern is represented graphically in addition to a list of fragment coordinates and their HIV-1 subtypes. The jpHMM was previously tested on a large set of real and simulated HIV-1 data (<xref ref-type="bibr" rid="B5">5</xref>). The evaluation of its prediction accuracy showed that jpHMM is more accurate than competing methods for phylogenetic breakpoint detection.</p>
    <p>Nevertheless, it is indispensable to know how reliable the predicted recombination breakpoints and parental subtypes in a particular sequence or a particular region of a sequence are. For this reason, we extended the output of jpHMM to include a tagging of regions where the model is ‘uncertain’ about the predicted parental subtype and provide an ‘interval’ estimate for each predicted breakpoint in addition to predicting its precise position. Similar approaches to assess the robustness of predicted breakpoint positions and parental subtypes (or sequences) have been developed in other recombination detection tools: TOPALi v2 (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>) is a tool for the evolutionary analysis of multiple sequence alignments. It comprises three recombination detection tools, that look for changes in phylogenetic tree topologies moving along an alignment. Statistical significance is assessed by posterior probabilities assigned to each topology for each position in the alignment. The cBrother (<xref ref-type="bibr" rid="B10">10</xref>) estimates the recombinant structure of a query sequence and provides posterior support for each genotype at each query sequence position and each breakpoint position. Recco (<xref ref-type="bibr" rid="B11">11</xref>) provides a very good visualization tool for locating recombination breakpoints (or breakpoint intervals) in a query sequence. It identifies the parental sequences within a given set of sequences and indicates robust sequence positions.</p>
  </sec>
  <sec sec-type="methods">
    <title>METHODS</title>
    <sec>
      <title>jpHMM</title>
      <p>The recombination prediction of jpHMM is based on a pre-calculated multiple sequence alignment of the major HIV-1 subtypes. Each subtype in the alignment is modeled as a profile HMM (<xref ref-type="bibr" rid="B12">12</xref>). In addition to the usual state transitions within these profile HMMs, transitions, called ‘jumps’, between the different profile HMMs are allowed at almost any position in the alignment. Thus, the model can jump between states corresponding to different subtypes, depending on which subtype is locally most similar to the query sequence. The recombination prediction for a query sequence is then defined by a most probable path through the model that generates the sequence, the so-called Viterbi path. Since each state of the model only belongs to one profile HMM and each sequence position is generated by one state of the model, each position of the sequence is assigned to exactly one parental subtype. Positions of jumps between different subtypes define recombination breakpoints.</p>
    </sec>
    <sec>
      <title>Uncertainty regions and breakpoint intervals</title>
      <p>The new version of jpHMM presented here additionally calculates the so-called ‘posterior probability’ for each base of the query sequence and each subtype in the given alignment. This quantity denotes the probability that the base belongs to the subtype in our probabilistic recombinant model. The posterior probabilities are calculated using the well-known Forward and Backward algorithms (<xref ref-type="bibr" rid="B13">13</xref>). Based on these probabilities, ‘uncertainty regions’ in the recombination prediction and interval estimates of breakpoints, i.e. intervals where breakpoints can be expected to be located, are defined.</p>
      <sec>
        <title>Uncertainty region</title>
        <p>If at a certain position of the query sequence the posterior probability of the parental subtype, that was predicted by jpHMM for this position, is lower than a certain threshold 0 ≪ <italic>t</italic><sub>UR</sub> &lt; 1, this position is marked as ‘uncertain’ (<xref ref-type="fig" rid="F1">Figure 1</xref>). This classification accounts for the fact that there is a significant (≥1 − <italic>t</italic><sub>UR</sub>) probability that the predicted subtype is wrong according to the probabilistic model.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Part of the jpHMM web server output for an artificial recombinant containing alternating B/F1 fragments of lengths 1500/300 nt. Above the genome map of the predicted recombination is shown (drawn with the HIV Sequence Locator Tool, <ext-link ext-link-type="uri" xlink:href="http://hiv.lanl.gov/">http://hiv.lanl.gov/</ext-link>), below the posterior probabilities of the subtypes. Breakpoint intervals are shown by an interfingering of the colors of the two predicted subtypes, uncertainty regions by an interfingering of grey and the color of the predicted subtype. For the uncertainty region around position 3438 the posterior probabilities give a hint to the correct subtype F1.</p></caption><graphic xlink:href="gkp371f1"/></fig>
</p>
        <p>For uncertainty regions, no parental strain can confidently be determined. However, by examining the graph of the posterior probabilities, the user can see which subtypes are closest related in these regions. In the case that an uncertainty region is equally close to two subtypes, the user cannot distinguish whether the uncertainty region is close to both subtypes or far away from them. In this case, we recommend to use the branching index method (<xref ref-type="bibr" rid="B14">14</xref>), which quantifies how closely a query sequence clusters with a subtype clade.</p>
      </sec>
      <sec>
        <title>Breakpoint interval</title>
        <p>An interval estimate of a breakpoint, called ‘breakpoint interval’, is defined as an interval around a predicted breakpoint position where the posterior probabilities of the predicted subtypes to the left and to the right of the breakpoint, are lower than a certain threshold 0 ≪ <italic>t</italic><sub>BPI</sub> &lt; 1, but higher than the posterior probabilities of all other subtypes (<xref ref-type="fig" rid="F1">Figure 1</xref>). If the posterior probability of a third subtype is higher than the posterior probability of one of the two predicted subtypes in this region, the whole region is marked as ‘uncertain’, since this indicates the possibility of an undetected recombination segment.
</p>
        <p>The length of a predicted breakpoint interval depends on how precisely the breakpoint can be located reliably. A large interval is the consequence of the uncertainty of the model to locate the exact breakpoint position between two subtypes. Thus, the user can see which breakpoints can be located relative precisely or which breakpoints are approximate.</p>
      </sec>
    </sec>
    <sec>
      <title>Web server</title>
      <p>The jpHMM is available online at <ext-link ext-link-type="uri" xlink:href="http://jphmm.gobics.de/">http://jphmm.gobics.de/</ext-link>. The user can paste or upload up to five full-length HIV-1 genomic sequences or fragments at a time in FASTA format. A hyperlink to the results of the program run, which are stored on the server for 2 days, is returned to the user by e-mail. The result contains for each sequence the predicted recombination, including uncertainty regions and breakpoint intervals, in text format as well as a graphical representation of the predicted recombinant fragments within the HIV-1 genome. Additionally, the posterior probabilities of the subtypes for each sequence position are plotted. For uncertainty regions the originally predicted parental subtype is also provided. As thresholds for uncertainty regions and breakpoint intervals we use <italic>t</italic><sub>BPI</sub> = <italic>t</italic><sub>UR</sub> = 0.99. For each query sequence, the predicted recombination with precise breakpoint positions as well as the predicted recombination including uncertainty regions and breakpoint intervals, a list of the breakpoint intervals and uncertainty regions and the posterior probabilities of the subtypes can be downloaded. Additionally, the alignment of each input sequence to the HXB2 sequence (<xref ref-type="bibr" rid="B15">15</xref>), defined by jpHMM, is provided for download. HXB2 is the most commonly used HIV-1 reference sequence and is part of the multiple sequence alignment we use to build the model. <xref ref-type="fig" rid="F1">Figure 1</xref> shows an excerpt of the jpHMM output for an artificial recombinant HIV-1 sequence.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Extract of the jpHMM web server output for an artificial recombinant. The output contains a list of fragments from the input sequence that are assigned to different HIV-1 subtypes, including predicted breakpoint intervals and uncertainty regions. In the center, a graphical representation of the predicted recombinant fragments within the HIV-1 genome is given. At the bottom, the posterior probabilities of all HIV-1 subtypes are plotted.</p></caption><graphic xlink:href="gkp371f2"/></fig></p>
    </sec>
    <sec>
      <title>Evaluation</title>
      <p>The accuracy of the new extension of jpHMM was evaluated on 40 semi-artificial near full-length inter-subtype recombinant sequences. For evaluation, we considered the accuracy of the predicted breakpoint intervals and the accuracy of the predicted parental subtypes at positions outside uncertainty regions and breakpoint intervals. As customary, and in lack of real recombinant sequences with exactly known breakpoint positions, these test sequences are real HIV-1 sequences but with artificially introduced breakpoints. Each of the test sequences is a recombination of two ‘real-world’ parental sequences from two different HIV-1 (sub-)subtypes. Hereby, we chose every possible pair of the subtypes A1, B, C, D, F1, G and CRF01 as parental subtypes. To simulate unknown sequences that also differ by mutations from the known sequences, the parental sequences of all test sequences are not contained in the multiple sequence alignment we use to build the model.</p>
      <p>The parental sequence pairs were used in three different datasets. In the first dataset, we introduced breakpoints at every 1000th position in the sequences. So, segments of length 1000 nt of one subtype were interrupted by segments of length 1000 nt of another subtype. In the second and third datasets, we used simulated recombinants where alternating long segments (1500 nt) from one subtype are interrupted by short segments (500 and 300 nt, respectively) from another subtype. So, in total, jpHMM was tested for 120 artificial recombinant sequences, each having eight to ten recombination breakpoints.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <p>We determined for different thresholds <italic>t</italic><sub>BPI</sub> the number of real breakpoints detected by the predicted breakpoint intervals for each data set. A breakpoint is defined as ‘detected’, when the breakpoint interval contains the true breakpoint and the two neighboring subtypes are predicted correctly. In <xref ref-type="table" rid="T1">Table 1</xref>, the results are shown for the first dataset (1000/1000 nt fragments). For each threshold the average, the minimal and the maximal length of the predicted breakpoint intervals, and the percentage of detected breakpoints is given. For example for the default threshold <italic>t</italic><sub>BPI</sub> = 0.99, 92.50% of the real breakpoints could be detected (<xref ref-type="table" rid="T1">Table 1</xref>, column 4). The average length of the predicted breakpoint intervals for this threshold is 48.58 nt, the minimal length is 5 nt and the maximal length is 233 nt.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of the accuracy of breakpoint intervals (BPI) predicted by jpHMM and the accuracy of BPI of fixed length</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Threshold <italic>t</italic><sub>BPI</sub></th><th colspan="2" rowspan="1">BPI length<hr/></th><th align="center" colspan="2" rowspan="1">Percentage of BP found using<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Average</th><th align="right" rowspan="1" colspan="1">Minimum/ Maximum</th><th align="center" rowspan="1" colspan="1"><italic>P</italic><sub>post</sub></th><th rowspan="1" colspan="1">Fixed BPI length</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0.75</td><td rowspan="1" colspan="1">16.12</td><td align="right" rowspan="1" colspan="1">0/113</td><td align="center" rowspan="1" colspan="1"><bold>54.17</bold></td><td rowspan="1" colspan="1">50.28</td></tr><tr><td rowspan="1" colspan="1">0.85</td><td rowspan="1" colspan="1">22.46</td><td align="right" rowspan="1" colspan="1">0/121</td><td align="center" rowspan="1" colspan="1"><bold>68.06</bold></td><td rowspan="1" colspan="1">56.39</td></tr><tr><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">26.89</td><td align="right" rowspan="1" colspan="1">2/135</td><td align="center" rowspan="1" colspan="1"><bold>74.72</bold></td><td rowspan="1" colspan="1">59.44</td></tr><tr><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">34.05</td><td align="right" rowspan="1" colspan="1">2/202</td><td align="center" rowspan="1" colspan="1"><bold>81.11</bold></td><td rowspan="1" colspan="1">65.00</td></tr><tr><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">48.58</td><td align="right" rowspan="1" colspan="1">5/233</td><td align="center" rowspan="1" colspan="1"><bold>92.50</bold></td><td rowspan="1" colspan="1">71.94</td></tr><tr><td rowspan="1" colspan="1">0.9999</td><td rowspan="1" colspan="1">84.77</td><td align="right" rowspan="1" colspan="1">11/492</td><td align="center" rowspan="1" colspan="1"><bold>98.06</bold></td><td rowspan="1" colspan="1">81.39</td></tr></tbody></table><table-wrap-foot><fn><p>Results are shown for the first dataset. In column 1, the threshold <italic>t</italic><sub>BPI</sub> is given. The average length of the BPI defined by <italic>t</italic><sub>BPI</sub> is given in column 2, the minimal and maximal length in column 3. In column 4, the percentage of real breakpoints detected with these BPI is shown, in column 5 the percentage of breakpoints using the average length of the predicted BPI as fixed BPI length (naïve method). For each threshold the highest value is marked in bold face.</p></fn></table-wrap-foot></table-wrap></p>
    <p>Besides the accuracy of the predicted breakpoint intervals, we were also interested in the ability of jpHMM to predict the true recombination pattern, i.e. the correct sequence of subtypes. Please note, that the recombination pattern of a sequence can be predicted correctly, even if not all breakpoints were detected, according to our definition of a detected breakpoint. For the first dataset, for 39 of the 40 test sequences the recombination pattern was predicted correctly, only in one sequence one recombinant segment was not identified.</p>
    <p>For the test sequences containing segments of length 1500/500 nt, 82.72 % of all breakpoints could be detected (with an average breakpoint interval length of 43.73 nt), and for the sequences containing segments of length 1500/300 nt, 87.50% (average breakpoint interval length is 41.24 nt). The near full-length sequences used in the input multiple alignment are not always complete at the end regions, and therefore, the multiple sequence alignment we use is ‘frayed’ and less informative at the sequence ends. jpHMM is thus often not able to assign any subtype to positions located near the ends of the genome. For 33 of the 40 sequences containing segments of length 1500/500 nt, one short segment (500 nt) at the sequence end was not assigned to the correct subtype, since jpHMM was not able to assign any subtype in this region. So, 9.35% (33 out of 353) of the real breakpoints could not be detected, only because they were located within an unclassified region. Apart from these 33 breakpoints, the predicted recombination pattern was correct. In contrast, in eight sequences of the third dataset (1500/300 nt), in fact one short segment (300 nt) was not assigned to the correct subtype. Five of these eight segments were classified as uncertainty region, the other three segments were predicted to have the same subtype as their neighbors, i.e. they could not be identified as a recombinant segment. For the remaining 32 sequences the recombination pattern was also predicted correctly.</p>
    <p>Using <italic>t</italic><sub>UR</sub> = <italic>t</italic><sub>BPI</sub> as threshold for the uncertainty regions, for all given thresholds (0.75–0.9999), 92.44–92.68% of the positions outside breakpoint intervals and uncertainty regions were assigned a subtype and classified correctly. Additionally, 6.74% of the positions at the sequence ends were not assigned to any subtype, so the total percentage of positions outside breakpoint intervals and uncertainty regions that were classified incorrectly is only 0.58–0.82%. For precise recombination prediction with jpHMM, i.e. including precise breakpoint estimates and no uncertainty regions, this is 1.51%. For the other two datasets, 0.66–0.99% (1500/500 nt) and 0.75–1.08% (1500/300 nt) of those positions were predicted incorrectly, compared with 1.55% and 1.97 %, respectively, for precise jpHMM recombination prediction.</p>
    <sec>
      <title>Comparison to a naïve approach</title>
      <p>The accuracy of the predicted breakpoint intervals was compared with the accuracy of a naïve method, that predicts breakpoints in a symmetric interval of fixed length, centered around the predicted breakpoint position. This naïve approach is the most obvious method to define breakpoint intervals around predicted breakpoint positions, if no further information is provided. For a direct comparison, we used the average length of the predicted breakpoint intervals as the fixed interval length in the naïve method, rounded to the nearest even number.</p>
      <p><xref ref-type="table" rid="T1">Table 1</xref> shows that for all tested thresholds <italic>t</italic><sub>BPI</sub>, especially for high thresholds, the number of breakpoints detected with breakpoint intervals defined by the posterior probabilities is much higher than when using breakpoint intervals of fixed length (<xref ref-type="table" rid="T1">Table 1</xref>, column 5). For example, for the default threshold, only 71.94% of all breakpoints could be detected with the naïve method, compared with 92.50%. So, the sensitivity of our method is up to 20 percentage points higher than that of the naïve method. For the other two datasets, the results are similar. For the sequences containing segments of length 500 nt, for the default threshold only 62.04% of all breakpoints could be detected using breakpoint intervals of fixed length, compared with 82.72% with our method. For segments of length 300 nt this is 73.75% compared with 87.5%.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSIONS</title>
    <p>We extended the jpHMM output to include information about the reliability of the predicted recombination breakpoints and parental subtypes. Our results show that breakpoint intervals defined by the posterior probabilities of the subtypes are far more accurate than breakpoint intervals of fixed length as used in naïve approaches. Additionally, &lt;1% of all positions outside uncertainty regions and breakpoint intervals were classified incorrectly, so the user can now be more confident in the predicted parental subtypes outside these regions. The definition of uncertainty regions helps researchers to avoid drawing wrong conclusions based on doubtful, uninformative regions, such as the postulation of a new CRF.
</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>DFG (grants STA 1009/4-1 and STA 1009/5-1); NIH-DOE Interagency Agreement Y1-AI-8309. Funding for open access charge: Deptartment of Bioinformatics, Georg-August-Universität Göttingen.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Tilman Sauer for helpful discussions and comments on the user interface and the anonymous referees for their suggestions.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Bradac</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Foley</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Funkhouser</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Kalish</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Kuiken</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HIV-1 nomenclature proposal</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>288</volume>
        <fpage>55d</fpage>
        <pub-id pub-id-type="pmid">10766634</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoelscher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dowling</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Sanders-Buell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Thomschke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robb</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Birx</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>McCutchan</surname>
            <given-names>FE</given-names>
          </name>
        </person-group>
        <article-title>Detection of HIV-1 subtypes, recombinants, and dual infections in East Africa by a multi-region hybridization assay</article-title>
        <source>AIDS</source>
        <year>2002</year>
        <volume>16</volume>
        <fpage>2055</fpage>
        <lpage>2064</lpage>
        <pub-id pub-id-type="pmid">12370505</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lole</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Bollinger</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Paranjape</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Gadkari</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kulkarni</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Ingersoll</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Full-length human immunodeficiency virus type 1 genomes from subtype C-infected seroconverters in India, with evidence of intersubtype recombination</article-title>
        <source>J. Virology</source>
        <year>1999</year>
        <volume>73</volume>
        <fpage>152</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="pmid">9847317</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Oliveira</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Deforche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cassol</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Salminen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paraskevis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>See-bregts</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Snoeck</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Rensburg</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Wensing</surname>
            <given-names>AMJ</given-names>
          </name>
          <name>
            <surname>van de Vijver</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An automated genotyping system for analysis of HIV-1 and other microbial sequences</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3797</fpage>
        <lpage>3800</lpage>
        <pub-id pub-id-type="pmid">16076886</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schultz</surname>
            <given-names>A-K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leitner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kuiken</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Korber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A jumping profile hidden markov model and applications to recombination sites in HIV and HCV Genomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>265</fpage>
        <pub-id pub-id-type="pmid">16716226</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>A.-K</given-names>
          </name>
          <name>
            <surname>Calef</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kuiken</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leitner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Korber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>jpHMM at GOBICS: a web server to detect genomic recombinations in HIV-1</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>W463</fpage>
        <lpage>W465</lpage>
        <pub-id pub-id-type="pmid">16845050</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rehmsmeier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A novel approach to remote homology detection: jumping alignments</article-title>
        <source>J. Comp. Biol.</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>747</fpage>
        <lpage>760</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Milne</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Husmeier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McGuire</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TOPALi: software for automatic identication of recombinant sequences within DNA multiple alignments</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1806</fpage>
        <lpage>1807</lpage>
        <pub-id pub-id-type="pmid">14988107</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Milne</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lindner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bayer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Husmeier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McGuire</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>TOPALi v2: a rich graphical interface for evolutionary analyses of multiple alignments on HPC clusters and multi-core desktops</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>126</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="pmid">18984599</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Minin</surname>
            <given-names>VN</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Dorman</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>cBrother: relaxing parental tree assumptions for Bayesian recombination detection</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>507</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="pmid">17145740</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maydt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Recco: recombination analysis using cost optimization</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1064</fpage>
        <lpage>1071</lpage>
        <pub-id pub-id-type="pmid">16488909</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>755</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="pmid">9918945</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mitchison</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids.</source>
        <year>1998</year>
        <publisher-loc>Cambridge, UK</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hraber</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kuiken</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Waugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Geer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bruno</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Leitner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Classification of hepatitis C virus and human immunodeficiency virus-1 sequences with the branching index</article-title>
        <source>J. Gen. Virol</source>
        <year>2008</year>
        <volume>89</volume>
        <fpage>2098</fpage>
        <lpage>2107</lpage>
        <pub-id pub-id-type="pmid">18753218</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Korber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Foley</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kuiken</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pillai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sodroski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Numbering positions in HIV Relative to HXB2CG</article-title>
        <source>Human Retroviruses and AIDS 1998.</source>
        <year>1998</year>
        <publisher-loc>Los Alamos, NM</publisher-loc>
        <publisher-name>Theoretical Biology and Biophysics Group, Los Alamos National Laboratory</publisher-name>
        <fpage>102</fpage>
        <lpage>111</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
