<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4795615</article-id>
    <article-id pub-id-type="pmid">26545820</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv641</article-id>
    <article-id pub-id-type="publisher-id">btv641</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Probabilistic models of genetic variation in structured populations applied to global human studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hao</surname>
          <given-names>Wei</given-names>
        </name>
        <author-comment>
          <p><sup>†</sup>The authors wish it be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
        </author-comment>
        <xref ref-type="aff" rid="btv641-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Minsun</given-names>
        </name>
        <author-comment>
          <p><sup>†</sup>The authors wish it be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
        </author-comment>
        <author-comment>
          <p><sup>‡</sup>Present address: Department of Mathematics and Statistics, University of Nevada Reno, Reno, NV 89557, USA.</p>
        </author-comment>
        <xref ref-type="aff" rid="btv641-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Storey</surname>
          <given-names>John D.</given-names>
        </name>
        <xref ref-type="aff" rid="btv641-AFF1">1</xref>
        <xref ref-type="aff" rid="btv641-AFF2">2</xref>
        <xref ref-type="corresp" rid="btv641-COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="btv641-AFF1"><label><sup>1</sup></label>Lewis-Sigler Institute for Integrative Genomics and</aff>
    <aff id="btv641-AFF2"><label><sup>2</sup></label>Center for Statistics and Machine Learning, Princeton University, Princeton, NJ 08544, USA</aff>
    <author-notes>
      <corresp id="btv641-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv641-FN1">
        <p><sup>†</sup>The authors wish it be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btv641-FN2">
        <p><sup>‡</sup>Present address: Department of Mathematics and Statistics, University of Nevada Reno, Reno, NV 89557, USA.</p>
      </fn>
      <fn id="btv641-FN3">
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>3</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2015-11-06">
      <day>06</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>5</issue>
    <fpage>713</fpage>
    <lpage>721</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btv641.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><bold>Motivation:</bold> Modern population genetics studies typically involve genome-wide genotyping of individuals from a diverse network of ancestries. An important problem is how to formulate and estimate probabilistic models of observed genotypes that account for complex population structure. The most prominent work on this problem has focused on estimating a model of admixture proportions of ancestral populations for each individual. Here, we instead focus on modeling variation of the genotypes without requiring a higher-level admixture interpretation.</p>
      <p><bold>Results:</bold> We formulate two general probabilistic models, and we propose computationally efficient algorithms to estimate them. First, we show how principal component analysis can be utilized to estimate a general model that includes the well-known Pritchard–Stephens–Donnelly admixture model as a special case. Noting some drawbacks of this approach, we introduce a new ‘logistic factor analysis’ framework that seeks to directly model the logit transformation of probabilities underlying observed genotypes in terms of latent variables that capture population structure. We demonstrate these advances on data from the Human Genome Diversity Panel and 1000 Genomes Project, where we are able to identify SNPs that are highly differentiated with respect to structure while making minimal modeling assumptions.</p>
      <p><bold>Availability and Implementation:</bold> A Bioconductor R package called lfa is available at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/lfa.html">http://www.bioconductor.org/packages/release/bioc/html/lfa.html</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>jstorey@princeton.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>One of the most important goals of modern human genetics is to accurately model genome-wide genetic variation among individuals, as it plays a fundamental role in disease gene mapping and characterizing the evolutionary history of human populations. In this article, we develop latent variable probabilistic models and estimation methods of genetic variation that provide allele frequency estimates of each individual/SNP combination in the presence of arbitrarily complex population structure. Accurate estimates of allele frequencies in this setting allow for improved tests of genetic associations with complex traits and other population genetic analyses which do not rely on overly restricted models of population structure. For example, the models and methods developed here provide the key estimation step in the implementation of a new framework for association testing in the presence of arbitrarily complex structure (<xref rid="btv641-B35" ref-type="bibr">Song <italic>et</italic><italic>al.</italic>, 2015</xref>). Other applications we explore here are to identify loci differentiated with respect to structure, test for random mating in the presence of structure, generalize the estimation of <inline-formula><mml:math id="MM1"><mml:mrow><mml:msub><mml:mrow><mml:mtext>F</mml:mtext></mml:mrow><mml:mrow><mml:mrow><mml:mtext>ST</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and characterize the global distribution of allele frequencies of disease SNPs—all making minimal assumptions about the complexity and form of structure.</p>
    <p>A longstanding problem has been to provide well-estimated probabilistic models of observed genotypes in the presence of complex population structure (see <xref rid="btv641-B27" ref-type="bibr">Raj <italic>et</italic><italic>al</italic><italic>.</italic>, 2014</xref> and references therein). A series of influential publications have proposed methods to estimate a model of admixture, where the primary focus is on the admixture proportions themselves (<xref rid="btv641-B3" ref-type="bibr">Alexander <italic>et al.</italic>, 2009</xref>; <xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et</italic><italic>al.</italic>, 2000</xref>; <xref rid="btv641-B37" ref-type="bibr">Tang <italic>et</italic><italic>al.</italic>, 2005</xref>), which in turn may produce estimates of the allele frequencies of every genetic marker for each individual. Here, we significantly relax the assumptions made about the manifestation of structure to yield more general latent variable models of structure. Rather than targeting admixture proportions, we instead focus on the estimation of the <italic>individual-specific allele frequencies</italic>, and we show that we make significant gains over existing methods in the accuracy and computational efficiency in estimating these quantities. The individual-specific allele frequencies, rather than admixture proportions, are ultimately the key quantities that need to be estimated in the applications we discuss as well as in the association testing method of <xref rid="btv641-B35" ref-type="bibr">Song <italic>et</italic><italic>al.</italic> (2015)</xref>.</p>
    <p>We propose two flexible genome-wide models of individual-specific allele frequencies as well as methods to estimate them. First, we develop a model that includes as special cases the aforementioned models; specifically, the Balding–Nichols (BN) model (<xref rid="btv641-B6" ref-type="bibr">Balding and Nichols, 1995</xref>) and its extension to the Pritchard–Stephens–Donnelly (PSD) model (<xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et</italic><italic>al.</italic>, 2000</xref>). However, we identify some limitations of our method to estimate this model. We therefore propose a second model based on the log-likelihood of the data that allows for rapid estimation of allele frequencies while maintaining a valid probabilistic model of genotypes.</p>
    <p>The estimate of the first model is based on principal component analysis (PCA), which is a tool often applied to genome-wide data of genetic variation in order to uncover structure. One of the earliest applications of PCA to population genetic data was carried out by <xref rid="btv641-B23" ref-type="bibr">Menozzi <italic>et al.</italic> (1978)</xref>. Exploratory analysis of complex population structure with PCA has been thoroughly studied (<xref rid="btv641-B21" ref-type="bibr">Manni, 2010</xref>; <xref rid="btv641-B23" ref-type="bibr">Menozzi <italic>et</italic><italic>al.</italic>, 1978</xref>; <xref rid="btv641-B24" ref-type="bibr">Novembre and Stephens, 2008</xref>; <xref rid="btv641-B28" ref-type="bibr">Rendine <italic>et al.</italic>, 1999</xref>; <xref rid="btv641-B34" ref-type="bibr">Sokal <italic>et al.</italic>, 1999</xref>). We show that a particular application of PCA can also be used to estimate allele frequencies in highly structured populations, although we have to deal with the fact that PCA is a real-valued operation and is not guaranteed to produce allele frequency estimates that lie in the unit interval [0,1].</p>
    <p>The estimate of the second model is based on generalized factor analysis approaches that directly model latent structure in observed data, including categorical data (<xref rid="btv641-B8" ref-type="bibr">Bartholomew <italic>et</italic><italic>al.</italic>, 2011</xref>) in which genotypes are included. We utilize a factor model of population structure (<xref rid="btv641-B15" ref-type="bibr">Engelhardt and Stephens, 2010</xref>) in terms of non-parametric latent variables, and we propose a method called ‘logistic factor analysis’ (LFA) that extends the PCA perspective toward likelihood-based probabilistic models and statistical inference (<xref rid="btv641-B12" ref-type="bibr">Collins <italic>et</italic><italic>al.</italic>, 2002</xref>). LFA is shown to provide accurate and interpretable estimates of individual-specific allele frequencies for a wide range of population structures. At the same time, this proposed approach provides visualizations and numerical summaries of structure similar to that of PCA, building a convenient bridge from exploratory data analysis to probabilistic modeling. LFA plays a key role in the aforementioned new test of genome-wide association of <xref rid="btv641-B35" ref-type="bibr">Song <italic>et</italic><italic>al.</italic> (2015)</xref>, called the genotype-conditional association test.</p>
    <p>We compare our proposed methods with existing algorithms, ADMIXTURE (<xref rid="btv641-B3" ref-type="bibr">Alexander <italic>et</italic><italic>al.</italic>, 2009</xref>) and fastSTRUCTURE (<xref rid="btv641-B27" ref-type="bibr">Raj <italic>et</italic><italic>al.</italic>, 2014</xref>), and show that when the goal is to estimate all individual-specific allele frequencies, our proposed approaches are conclusively superior in both accuracy and computational speed. We apply the proposed methods to the Human Genome Diversity Project (HGDP) (<xref rid="btv641-B10" ref-type="bibr">Cann <italic>et</italic><italic>al.</italic>, 2002</xref>; <xref rid="btv641-B29" ref-type="bibr">Rosenberg <italic>et</italic><italic>al.</italic>, 2002</xref>, <xref rid="btv641-B30" ref-type="bibr">2005</xref>) and 1000 Genomes Project (TGP) (<xref rid="btv641-B1" ref-type="bibr">1000 Genomes Project Consortium, 2010</xref>) datasets, which allows us to estimate allele frequencies of every SNP in an individual-specific manner. Using LFA, we are also able to rank SNPs for differentiation according to population structure based on the likelihoods of the fitted models. In both datasets, the most differentiated SNP is proximal to <italic>SLC24A5</italic>, and the second most differentiated SNP is proximal to <italic>EDAR.</italic> Variation in both of these genes has been hypothesized to be under positive selection in humans. In the TGP dataset, the second most different SNP is rs3827760, which confers a missense mutation in <italic>EDAR</italic> and has been recently experimentally validated as having a functional role in determining a phenotype (<xref rid="btv641-B18" ref-type="bibr">Kamberov <italic>et</italic><italic>al.</italic>, 2013</xref>). We also identify several SNPs that are highly differentiated in these global human studies that have recently been associated with diseases such as cancer, obesity and asthma.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Models of Allele Frequencies</title>
      <p>It is often the case that human and other outbred populations are ‘structured’ in the sense that the genotype frequencies at a particular locus are not homogeneous throughout the population (<xref rid="btv641-B4" ref-type="bibr">Astle and Balding, 2009</xref>). Geographic characterizations of ancestry often explain differing genotype frequencies among subpopulations. For example, an individual of European ancestry may receive a particular genotype according to a probability different than an individual of Asian ancestry. This phenomenon has been observed not only across continents, but on very fine scales of geographic characterizations of ancestry. Recent studies have shown that population structure in human populations is quite complex, occurring more on a continuous rather than a discrete basis (<xref rid="btv641-B29" ref-type="bibr">Rosenberg <italic>et</italic><italic>al.</italic>, 2002</xref>). We can illustrate the spectrum of structural complexity with <xref ref-type="fig" rid="btv641-F1">Figure 1</xref>, which shows dendrograms of hierarchically clustered individuals from the HapMap (phase II), HGDP and TGP datasets. The HapMap samples strongly indicate explicit membership of each individual to one of three discrete subpopulations (due to the intended sampling scheme). On the other hand, the clusterings of the HGDP and TGP individuals show a very complex configuration, more representative of random sampling of global human populations.
</p>
      <fig id="btv641-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>A hierarchical clustering of individuals from the HapMap, HGDP and TGP datasets. A dendrogram was drawn from a hierarchical clustering using Ward distance based on SNP genotypes (MAF <inline-formula><mml:math id="MM2"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>). Whereas the HapMap project shows a definitive discrete population structure (by sampling design), the HGDP and TGP data show the complex structure of human populations</p>
        </caption>
        <graphic xlink:href="btv641f1p"/>
      </fig>
      <p>Let us introduce <inline-formula><mml:math id="MM3"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:math></inline-formula> as an unobserved variable capturing an individual’s structure, which we will estimate with dimension <italic>d.</italic> Let <italic>x<sub>ij</sub></italic> be the observed genotype for SNP <italic>i</italic> and individual <italic>j</italic> (<inline-formula><mml:math id="MM4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>), and assume that <italic>x<sub>ij</sub></italic> is coded to take the values 0, 1, 2. We call the observed <italic>m</italic> × <italic>n</italic> genotype matrix <inline-formula><mml:math id="MM5"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula>. For SNP <italic>i</italic>, the allele frequency can be viewed as a function of <inline-formula><mml:math id="MM6"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For a sampled individual <italic>j</italic> from an overall population, we have ‘individual-specific allele frequencies’ (<xref rid="btv641-B38" ref-type="bibr">Thornton <italic>et</italic><italic>al.</italic>, 2012</xref>) defined as <inline-formula><mml:math id="MM8"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at SNP <italic>i.</italic> Each value of <italic>π<sub>ij</sub></italic> informs us as to the expectation of that particular SNP/individual pair under the scenario we observed a new individual at that locus with the same structure, specifically as <inline-formula><mml:math id="MM9"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. If an observed SNP genotype <italic>x<sub>ij</sub></italic> is treated as a random variable, then we assume that <italic>π<sub>ij</sub></italic> serves to model <italic>x<sub>ij</sub></italic> as a Binomial parameter: <inline-formula><mml:math id="MM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. (We will drop the conditioning on <inline-formula><mml:math id="MM11"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:math></inline-formula> in the subsequent text for convenience.) This Binomial distribution assumption is also made in the PSD model (<xref rid="btv641-B3" ref-type="bibr">Alexander <italic>et</italic><italic>al.</italic>, 2009</xref>; <xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et</italic><italic>al.</italic>, 2000</xref>). The focus of this article is on the simultaneous estimation of the <italic>π<sub>ij</sub></italic> values (<inline-formula><mml:math id="MM12"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>).</p>
      <p>The flexible, accurate and computationally efficient estimation of individual-specific allele frequencies is important for population genetic analyses, illustrated by the following examples.<statement><title>Example 1</title><p><xref rid="btv641-B14" ref-type="bibr">Corona <italic>et al.</italic> (2013)</xref> recently showed that considering the worldwide distribution of allele frequencies of SNPs known to be associated with human diseases may be a fundamental component to understanding the relationship between ancestry and disease.</p></statement><statement><title>Example 2</title><p>We may use individual-specific allele frequency estimates to determine whether genotype data follow a probability distribution indicative of random mating, conditional on population structure. This involves verifying that <inline-formula><mml:math id="MM14"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Verifying this model can be viewed as testing for a version of Hardy–Weinberg equilibrium conditional on structure; it is also the probabilistic assumption underlying the STRUCTURE (<xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et</italic><italic>al.</italic>, 2000</xref>), ADMIXTURE and fastSTRUCTURE software packages that all fit the PSD model. Verifying this model assumption can be accomplished by assessing the goodness-of-fit of the model by testing whether the genotype frequencies for SNP <italic>i</italic> follow probabilities <inline-formula><mml:math id="MM15"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="MM16"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for all individuals <inline-formula><mml:math id="MM17"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>.</p></statement><statement><title>Example 3</title><p>It can be shown that an <inline-formula><mml:math id="MM18"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>ST</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>-related measure can be characterized for SNP <italic>i</italic> using values of <italic>π<sub>ij</sub></italic>, <inline-formula><mml:math id="MM19"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S5</xref>).</p></statement><statement><title>Example 4</title><p>We have recently developed a test of association that corrects for population structure and involves the estimation of <inline-formula><mml:math id="MM20"><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref rid="btv641-B35" ref-type="bibr">Song <italic>et</italic><italic>al.</italic>, 2015</xref>).</p><p>These examples demonstrate that flexible and well-behaved estimates of the individual-specific allele frequencies <italic>π<sub>ij</sub></italic> are needed for downstream population genetic analyses.</p></statement></p>
      <p>It is straightforward to write other models of population structure in terms of <inline-formula><mml:math id="MM21"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:math></inline-formula>. For the BN model, each individual is assigned to a population, thus <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> indicates individual <italic>j</italic>’s population assignment. For the PSD model, each individual is considered to be an admixture of a finite set of ancestral populations. Following the notation of <xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et al.</italic> (2000)</xref>, we can write <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as a vector with elements <italic>q<sub>kj</sub></italic>, where <italic>k</italic> indexes the ancestral populations, and we constrain <italic>q<sub>kj</sub></italic> to be between 0 and 1 subject to <inline-formula><mml:math id="MM24"><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. Assuming the PSD model allows us to write each <inline-formula><mml:math id="MM25"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> and leads to a matrix form: <inline-formula><mml:math id="MM26"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>=</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM27"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> is the <italic>m</italic> × <italic>n</italic> matrix of allele frequencies with (<italic>i</italic>, <italic>j</italic>) entry <italic>π<sub>ij</sub></italic>, <inline-formula><mml:math id="MM28"><mml:mi mathvariant="bold">P</mml:mi></mml:math></inline-formula> is the <italic>m</italic> × <italic>d</italic> matrix of ancestral population allele frequencies <italic>p<sub>ik</sub></italic> and <inline-formula><mml:math id="MM29"><mml:mi mathvariant="bold">Q</mml:mi></mml:math></inline-formula> is the <italic>d</italic> × <italic>n</italic> matrix of admixture proportions. The elements of <inline-formula><mml:math id="MM30"><mml:mi mathvariant="bold">P</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="MM31"><mml:mi mathvariant="bold">Q</mml:mi></mml:math></inline-formula> are explicitly restricted to the range <inline-formula><mml:math id="MM32"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The PSD model is primarily focused on the matrix <inline-formula><mml:math id="MM33"><mml:mi mathvariant="bold">Q</mml:mi></mml:math></inline-formula> and secondarily on the matrix <inline-formula><mml:math id="MM34"><mml:mi mathvariant="bold">P</mml:mi></mml:math></inline-formula>, which have standalone interpretations. We aim instead to estimate all <italic>π<sub>ij</sub></italic> quantities with a high level of accuracy and computational efficiency. Writing the structure of the allele frequency matrix <inline-formula><mml:math id="MM35"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> as a linear basis, we have:
<disp-formula id="btv641-M1"><label>(1)</label><mml:math id="MM36"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mstyle><mml:mo> </mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">F</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Γ</mml:mi><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM37"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> is <italic>m</italic> × <italic>d</italic> and <inline-formula><mml:math id="MM38"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> is <italic>d</italic> × <italic>n</italic> with <inline-formula><mml:math id="MM39"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, and the entries of both matrices are unrestricted real numbers. The <italic>d</italic> × <italic>n</italic> matrix <inline-formula><mml:math id="MM40"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> encapsulates the genetic population structure for these individuals since <bold>S</bold> is not SNP-specific. The <italic>m</italic> × <italic>d</italic> matrix <inline-formula><mml:math id="MM41"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> maps how the structure <inline-formula><mml:math id="MM42"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> is manifested in the allele frequencies. Operationally, each SNP’s allele frequencies are a linear combination of the rows of <inline-formula><mml:math id="MM43"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula>, where the linear weights for SNP <italic>i</italic> are contained in row <italic>i</italic> of <inline-formula><mml:math id="MM44"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula>. We define the dimension <italic>d</italic> so that <italic>d</italic> = 1 corresponds to the case of no structure: when <italic>d</italic> = 1, <inline-formula><mml:math id="MM45"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM46"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> is the column vector of marginal allele frequencies.</p>
      <p>This model is not necessarily the most effective way to estimate <italic>π<sub>ij</sub></italic> when working in the context of a probabilistic model or with the likelihood function given the data. Model 1 resembles linear regression, where the allele frequencies are treated as a real-valued response variable that is linearly dependent on the structure. A version of regression for the case of categorical response variables (e.g. genotypes) with underlying probability parameters is logistic regression. We developed an approach called logistic factor analysis (LFA), which is essentially an extension of non-parametric factor analysis to {0, 1, 2}-valued genotype data. The justification for LFA derives from that of generalized linear models (<xref rid="btv641-B22" ref-type="bibr">McCullagh and Nelder, 1989</xref>), where in our case observed covariates are instead replaced with unobserved latent variables that must also be estimated.</p>
      <p>The log-likelihood is the preferred mathematical framework for representing the information the data contain about unknown parameters (<xref rid="btv641-B20" ref-type="bibr">Lehmann and Casella, 1998</xref>). Suppose that the model assumption holds such that <inline-formula><mml:math id="MM47"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We can write the log-likelihood of the data for SNP <italic>i</italic> and individual <italic>j</italic> as:
<disp-formula><mml:math id="MM48"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
The log-likelihood of SNP <italic>i</italic> for all unrelated individuals is the sum: <inline-formula><mml:math id="MM49"><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. The term <inline-formula><mml:math id="MM50"><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the logit function and is written as <inline-formula><mml:math id="MM51"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="MM52"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is called the ‘natural parameter’ or ‘canonical parameter’ of the Binomial distribution and is the key component of logistic regression (<xref rid="btv641-B22" ref-type="bibr">McCullagh and Nelder, 1989</xref>). An immediate benefit of working with <inline-formula><mml:math id="MM53"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is that it is real valued, which allows us to directly model <inline-formula><mml:math id="MM54"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with a linear basis.</p>
      <p>Let <inline-formula><mml:math id="MM55"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula> be the <italic>m</italic> × <italic>n</italic> matrix with (<italic>i</italic>, <italic>j</italic>) entry equal to <inline-formula><mml:math id="MM56"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We form the following parameterization of <inline-formula><mml:math id="MM57"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula>:
<disp-formula id="btv641-M2"><label>(2)</label><mml:math id="MM58"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mstyle><mml:mo> </mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>2</mml:mn></mml:mstyle><mml:mo>:</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">L</mml:mi><mml:mo>=</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi><mml:mi>H</mml:mi></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM59"><mml:mi mathvariant="bold">A</mml:mi></mml:math></inline-formula> is <italic>m</italic> × <italic>d</italic> and <inline-formula><mml:math id="MM60"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula> is <italic>d</italic> × <italic>n</italic> with <inline-formula><mml:math id="MM61"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. In this case we can write
<disp-formula><mml:math id="MM62"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where all parameters are free to span the real numbers. We choose the value of <italic>d</italic> by identifying the one that provides the best goodness-of-fit (<xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S2</xref>).</p>
      <p>We call the rows of <inline-formula><mml:math id="MM64"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula> ‘logistic latent factors’ or just ‘logistic factors’ as they represent unobserved variables that explain the inter-individual differences in allele frequencies. In other words, the <inline-formula><mml:math id="MM65"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> of the vector of individual-specific allele frequencies for SNP <italic>i</italic> can be written as a linear combination of the rows of <inline-formula><mml:math id="MM66"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>:
<disp-formula><mml:math id="MM67"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM68"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic>k</italic>th row of <inline-formula><mml:math id="MM69"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>. Similarly, we can write:
<disp-formula><mml:math id="MM70"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The relationship between our proposed LFA approach and existing approaches of estimating latent variables in categorical data is detailed in <xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S6</xref>. Specifically, it should be noted that even though we propose calling the approach LFA, we do not make any assumptions about the distribution of the factors (which are often assumed to be normal). A technically more detailed name of the method is a ‘logistic nonparametric linear latent variable model for Binomial data.’</p>
    </sec>
    <sec>
      <title>2.2 Estimation algorithms</title>
      <p>The two models presented earlier make minimal assumptions as to the nature of the structure. For example, in Model 1, both <inline-formula><mml:math id="MM71"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="MM72"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> are permitted to be real valued. This allows us to apply a PCA-based algorithm directly to the genotype matrix <inline-formula><mml:math id="MM73"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula>, obtaining estimates of <inline-formula><mml:math id="MM74"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM75"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. In essence, <inline-formula><mml:math id="MM76"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is estimated by forming the projection of <inline-formula><mml:math id="MM77"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> onto the top <italic>d</italic> principal components of <inline-formula><mml:math id="MM78"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula> with an explicit intercept for the <italic>d</italic> = 1 case. One drawback of this approach is that because PCA is designed for continuous data, we have to take additional steps to constrain <inline-formula><mml:math id="MM79"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to be in the range <inline-formula><mml:math id="MM80"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. However, we show in Results that <inline-formula><mml:math id="MM81"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is still an extremely accurate estimate of the allele frequencies <inline-formula><mml:math id="MM82"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> for all formulations of <inline-formula><mml:math id="MM83"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> considered here, including the PSD model.<statement><title><bold>Algorithm 1:</bold> Estimating <inline-formula><mml:math id="MM84"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> from PCA</title><p><list list-type="order"><list-item><p>Let <inline-formula><mml:math id="MM85"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the sample mean of row <italic>i</italic> of <inline-formula><mml:math id="MM86"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula>. Set <inline-formula><mml:math id="MM87"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and let <inline-formula><mml:math id="MM88"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be the <italic>m</italic> × <italic>n</italic> matrix with (<italic>i</italic>, <italic>j</italic>) entry <inline-formula><mml:math id="MM89"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Perform singular value decomposition (SVD) on <inline-formula><mml:math id="MM90"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> which decomposes <inline-formula><mml:math id="MM91"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">Δ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Note that the rows of <inline-formula><mml:math id="MM92"><mml:mrow><mml:mi mathvariant="bold">Δ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are the <italic>n</italic> row-wise principal components of <inline-formula><mml:math id="MM93"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM94"><mml:mi mathvariant="bold">U</mml:mi></mml:math></inline-formula> are the principal component loadings.</p></list-item><list-item><p>Let <inline-formula><mml:math id="MM95"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the projection of <inline-formula><mml:math id="MM96"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> on the top <italic>d</italic> – 1 eigen-vectors of this SVD, <inline-formula><mml:math id="MM97"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Construct <inline-formula><mml:math id="MM98"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> by adding <inline-formula><mml:math id="MM99"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to row <italic>i</italic> of <inline-formula><mml:math id="MM100"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (for <inline-formula><mml:math id="MM101"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>) and multiplying the resulting matrix by 1/2. In mathematical terms, <inline-formula><mml:math id="MM102"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> where
<disp-formula><mml:math id="MM103"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo> </mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>…</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo> </mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
and <italic>δ<sub>i</sub></italic> is the <italic>i</italic>th diagonal entry of <inline-formula><mml:math id="MM104"><mml:mi mathvariant="bold">Δ</mml:mi></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM105"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to be the (<italic>i</italic>, <italic>j</italic>) entry of <inline-formula><mml:math id="MM106"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Since it may be the case that some <inline-formula><mml:math id="MM107"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are such that <inline-formula><mml:math id="MM108"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="MM109"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we truncate these. The final PCA based estimate of <inline-formula><mml:math id="MM110"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> is formed as <inline-formula><mml:math id="MM111"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> where the (<italic>i</italic>, <italic>j</italic>) entry <inline-formula><mml:math id="MM112"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is defined to be
<disp-formula><mml:math id="MM113"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
for some <inline-formula><mml:math id="MM114"><mml:mrow><mml:mi>C</mml:mi><mml:mo>≳</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. An estimate of <inline-formula><mml:math id="MM115"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula> can be formed as <inline-formula><mml:math id="MM116"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p>Here we used <inline-formula><mml:math id="MM117"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which is the minimum resolution of the data given 2<italic>n</italic> alleles are observed. In summary, <inline-formula><mml:math id="MM118"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is a projection of <inline-formula><mml:math id="MM119"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula> into its top principal components, scaled by 1/2, and truncated so that all values lie in the interval (0, 1).</p><p>For Model 2, we propose a method for estimating the latent variable <inline-formula><mml:math id="MM120"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>. Starting from the output of Algorithm 1, we apply the <inline-formula><mml:math id="MM121"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> transformation to the subset of rows that had no truncation, i.e. no values where <inline-formula><mml:math id="MM122"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="MM123"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>. We then extract the right singular vectors of this transformed subset. As long as the subset is large enough to span the same space as the row space of <inline-formula><mml:math id="MM124"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula>, this approach accurately estimates the basis of <inline-formula><mml:math id="MM125"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>. Next, we calculate the maximum likelihood estimation of <inline-formula><mml:math id="MM126"><mml:mi mathvariant="bold">A</mml:mi></mml:math></inline-formula> parameterized by <inline-formula><mml:math id="MM127"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to yield <inline-formula><mml:math id="MM128"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, and then set <inline-formula><mml:math id="MM129"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. This involves performing a logistic regression of each SNP’s data on <inline-formula><mml:math id="MM130"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. In order to estimate the individual-specific allele frequency matrix <inline-formula><mml:math id="MM131"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>, we calculate <inline-formula><mml:math id="MM132"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. An important property to note is that all <inline-formula><mml:math id="MM133"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> due to the fact that we are modeling the natural parameter.</p></statement><statement><title><bold>Algorithm 2:</bold> Estimating Logistic Factors</title><p><list list-type="order"><list-item><p>Apply steps 1–4 of Algorithm 1 to obtain the estimate <inline-formula><mml:math id="MM134"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> from Step 4.</p></list-item><list-item><p>Recalling that <inline-formula><mml:math id="MM135"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the (<italic>i</italic>, <italic>j</italic>) entry of <inline-formula><mml:math id="MM136"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, we choose some <inline-formula><mml:math id="MM137"><mml:mrow><mml:mi>C</mml:mi><mml:mtext>≳</mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and form
<disp-formula><mml:math id="MM138"><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><inline-formula><mml:math id="MM139"><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:math></inline-formula> identifies the rows of <inline-formula><mml:math id="MM140"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> where the <inline-formula><mml:math id="MM141"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> function can be applied stably. Here we use <inline-formula><mml:math id="MM142"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Define <inline-formula><mml:math id="MM143"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be the corresponding subset of rows of <inline-formula><mml:math id="MM144"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and calculate <inline-formula><mml:math id="MM145"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM146"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> be the row-wise mean centered and standard deviation scaled matrix <inline-formula><mml:math id="MM147"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Perform SVD on <inline-formula><mml:math id="MM148"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> resulting in <inline-formula><mml:math id="MM149"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mi mathvariant="bold">Λ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Set <inline-formula><mml:math id="MM150"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to be the <italic>d</italic> × <italic>n</italic> matrix composed of the top <italic>d</italic> – 1 right singular vectors of the SVD of <inline-formula><mml:math id="MM151"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi class="calligraphy" mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> stacked on the row <italic>n</italic>-vector <inline-formula><mml:math id="MM152"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula><mml:math id="MM153"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo> </mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mo> </mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo> </mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></list-item></list></p></statement><statement><title><bold>Algorithm 3:</bold> Estimating <inline-formula><mml:math id="MM154"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="MM155"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula> from LFA</title><p><list list-type="order"><list-item><p>Apply Algorithm 2 to <inline-formula><mml:math id="MM156"><mml:mi mathvariant="bold">X</mml:mi></mml:math></inline-formula> to obtain <inline-formula><mml:math id="MM157"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>For each SNP <italic>i</italic>, perform a logistic regression of the SNP genotypes <inline-formula><mml:math id="MM158"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> on the rows of <inline-formula><mml:math id="MM159"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, specifically by maximizing the log-likelihood
<disp-formula><mml:math id="MM160"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
under the constraint that <inline-formula><mml:math id="MM161"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. It should be noted that an intercept is included because <inline-formula><mml:math id="MM162"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="MM163"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> by construction.</p></list-item><list-item><p>Set <inline-formula><mml:math id="MM164"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM165"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>) to be equal to the maximum likelihood estimates from the above model fit, for each of <inline-formula><mml:math id="MM166"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM167"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="MM168"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the (<italic>i</italic>, <italic>j</italic>) entry of <inline-formula><mml:math id="MM169"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>:
<disp-formula><mml:math id="MM170"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list></p><p>PCA-based estimation of Model 1 requires one application of SVD and LFA requires two applications of SVD. We leverage the fact that <inline-formula><mml:math id="MM171"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≫</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> to utilize Lanczos bidiagonalization which is an iterative method for computing the SVD of a matrix (<xref rid="btv641-B5" ref-type="bibr">Baglama and Reichel, 2006</xref>). Lanczos bidiagonalization excels at computing a few of the largest singular values and corresponding singular vectors of a sparse matrix. While the sparsity of genotype matrices is fairly low, we find that in practice using this method to perform the above estimation algorithms is more effective than using methods that require the calculation of all the singular values and vectors. This results in a substantial reduction of the computational time needed for the implementation of our methods.</p></statement></p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We applied our methods to a comprehensive set of simulation studies and to the HGDP and TGP datasets.</p>
    <sec>
      <title>3.1 Simulation studies</title>
      <p>To directly evaluate the performance of the estimation methods (see Section 2.2), we devised a simulation study where we generated synthetic genotype data with varying levels of complexity in population structure. Genotypes were simulated based on allele frequencies subject to structure from the BN model, the PSD model, spatially structure populations and real datasets. For the first three types of simulations, the allele frequencies were parameterized by Model 1, while for the real-data simulations, the allele frequencies were taken from model fits on the data themselves.</p>
      <p>A key property to assess is how well the estimation methods capture the overall structure. One way to evaluate this is to determine how well <inline-formula><mml:math id="MM172"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> from the PCA-based method (Algorithm 1) estimates the true underlying <inline-formula><mml:math id="MM173"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula>, and similarly how well <inline-formula><mml:math id="MM174"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> from LFA estimates the true <inline-formula><mml:math id="MM175"><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>. Note that even though the genotype data were generated from the <inline-formula><mml:math id="MM176"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> of Model 1, we can evaluate <inline-formula><mml:math id="MM177"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> by converting with <inline-formula><mml:math id="MM178"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>=</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To evaluate PCA, we regressed each row of <inline-formula><mml:math id="MM179"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="MM180"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and calculated the average <italic>R</italic><sup>2</sup>; similarly, for LFA we regressed each row of <inline-formula><mml:math id="MM181"><mml:mi mathvariant="bold">L</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="MM182"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and calculated the average <italic>R</italic><sup>2</sup> value. The results are presented in <xref rid="btv641-T1" ref-type="table">Table 1</xref>. Both methods estimate the true latent structure well.
</p>
      <table-wrap id="btv641-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Accuracy in estimating linear bases for <inline-formula><mml:math id="MM183"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead align="left">
            <tr>
              <th colspan="1" rowspan="2">Scenario</th>
              <th align="center" colspan="2" rowspan="1">Mean <italic>R</italic><sup>2</sup><hr/></th>
            </tr>
            <tr>
              <th colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM184">
                    <mml:mrow>
                      <mml:mi mathvariant="bold">F</mml:mi>
                      <mml:mo>∼</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi mathvariant="bold">S</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="true">˜</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM185">
                    <mml:mrow>
                      <mml:mtext>logit</mml:mtext>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="bold">F</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>∼</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi mathvariant="bold">H</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="true">^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
            </tr>
          </thead>
          <tbody align="left">
            <tr>
              <td colspan="1" rowspan="1">TGP fit by PCA</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9998</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9722</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">TGP fit by LFA*</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9912</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9990</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">HGDP fit by PCA</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9996</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9614</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">HGDP fit by LFA*</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9835</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9983</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">BN</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9999</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9999</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">PSD <inline-formula><mml:math id="MM186"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula></td>
              <td align="char" char="." colspan="1" rowspan="1">0.9998</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9974</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">PSD <inline-formula><mml:math id="MM187"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula></td>
              <td align="char" char="." colspan="1" rowspan="1">0.9998</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9879</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">PSD <inline-formula><mml:math id="MM188"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula></td>
              <td align="char" char="." colspan="1" rowspan="1">0.9996</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9827</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">PSD <italic>α</italic> = 1</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9993</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9844</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">Spatial <italic>a</italic> = 0.1</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9999</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9964</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">Spatial <italic>a</italic> = 0.25</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9999</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9962</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">Spatial <italic>a</italic> = 0.5</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9999</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9964</td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">Spatial <italic>a</italic> = 1</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9998</td>
              <td align="char" char="." colspan="1" rowspan="1">0.9970</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="btv641-TF1">
            <p>Column 1 shows the scenario from which the data were simulated. Columns 2 and 3 display the estimation accuracy of the PCA-based method (Column 2) and LFA (Column 3). Column 2 shows the mean <italic>R</italic><sup>2</sup> value when regressing the true <inline-formula><mml:math id="MM189"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> on <inline-formula><mml:math id="MM190"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> from PCA, averaging across all SNPs. Column 3 shows the mean <italic>R</italic><sup>2</sup> value when regressing the true <inline-formula><mml:math id="MM191"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on <inline-formula><mml:math id="MM192"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> from LFA, averaging across all SNPs. All estimated standard errors fell between 10<sup>−6</sup> and 10<sup>−8</sup> so these are not shown. Note for each scenario, <italic>R</italic><sup>2</sup> values are higher for the method from which the true <inline-formula><mml:math id="MM193"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> matrix was generated. All but the two scenarios marked with an asterisk (*) are from Model 1, while the two marked scenarios are from Model 2, where we took <inline-formula><mml:math id="MM194"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:math></inline-formula></p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We specifically note that when the PSD model was utilized to simulate structure, we were able to recover the structure <inline-formula><mml:math id="MM195"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> very well (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>) without needing to employ the computationally intensive and assumption-heavy Bayesian model fitting techniques from <xref rid="btv641-B26" ref-type="bibr">Pritchard <italic>et</italic><italic>al</italic><italic>.</italic> (2000)</xref>. In addition, it seems that the <inline-formula><mml:math id="MM196"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> largely captures the geometry of <inline-formula><mml:math id="MM197"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> where it may be the case that <inline-formula><mml:math id="MM198"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> can be recovered with a high degree of accuracy by transforming <inline-formula><mml:math id="MM199"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> back into the simplex. By comparing the results on the real data (<xref ref-type="fig" rid="btv641-F2">Fig. 2</xref>) with the simulated data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>), one is able to visually assess how closely the assumptions of the PSD model resemble real datasets. When structure was simulated that differed substantially from the assumptions of the PSD model, our estimation methods were able to capture that structure just as well (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). This demonstrates the flexibility of the proposed approaches.
</p>
      <fig id="btv641-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Principal component and logistic factor biplots for the HGDP and TGP datasets. The top three principal components from each dataset are plotted in a pairwise fashion in the top panel. The top three logistic factors are plotted analogously in the bottom panel. It can be seen that both approaches yield similar visualizations of structure</p>
        </caption>
        <graphic xlink:href="btv641f2p"/>
      </fig>
      <p>We also compared PCA and LFA to two methods of fitting the PSD model, ADMIXTURE (<xref rid="btv641-B3" ref-type="bibr">Alexander <italic>et</italic><italic>al.</italic>, 2009</xref>) and fastSTRUCTURE (<xref rid="btv641-B27" ref-type="bibr">Raj <italic>et</italic><italic>al.</italic>, 2014</xref>), by determining how well the methods estimated the individual-specific allele frequencies <italic>π<sub>ij</sub>.</italic> A subset of results is shown in <xref rid="btv641-T2" ref-type="table">Table 2</xref>
, and the full set of results is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. For the real data scenarios, we simulated genotypes based on estimates of <inline-formula><mml:math id="MM220"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> from the four different methods, thus giving each method an opportunity to fit its own simulation. The methods were compared by computing three different error metrics with respect to the oracle <inline-formula><mml:math id="MM221"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>: Kullback–Leibler divergence, absolute error and root mean squared error (<xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S4</xref>). PCA and LFA significantly outperformed ADMIXTURE and fastSTRUCTURE, which confirms the intuitive understanding of the differences between the models: the goal of Models 1 and 2 is to estimate the allele frequencies <italic>π<sub>ij</sub></italic>, while the PSD model provides a probabilistic interpretation of the structure by modeling them as admixture proportions.</p>
      <table-wrap id="btv641-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>A comparison of accuracy in estimating <italic>π<sub>ij</sub></italic> parameters where data were simulated from the PSD model for varying <italic>α</italic></p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead align="left">
            <tr>
              <th colspan="1" rowspan="1"/>
              <th colspan="1" rowspan="1">PCA</th>
              <th colspan="1" rowspan="1">LFA</th>
              <th colspan="1" rowspan="1">ADX</th>
              <th colspan="1" rowspan="1">FS</th>
            </tr>
          </thead>
          <tbody align="left">
            <tr>
              <td colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM200">
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.01</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM201">
                    <mml:mrow>
                      <mml:mn>7.2</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM202">
                    <mml:mrow>
                      <mml:mn>7.6</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM203">
                    <mml:mrow>
                      <mml:mn>1.7</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM204">
                    <mml:mrow>
                      <mml:mn>1.7</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM205">
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.1</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM206">
                    <mml:mrow>
                      <mml:mn>7.2</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM207">
                    <mml:mrow>
                      <mml:mn>9.3</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM208">
                    <mml:mrow>
                      <mml:mn>2.4</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM209">
                    <mml:mrow>
                      <mml:mn>2.4</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM210">
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.5</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM211">
                    <mml:mrow>
                      <mml:mn>7.3</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM212">
                    <mml:mrow>
                      <mml:mn>9.0</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM213">
                    <mml:mrow>
                      <mml:mn>1.8</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM214">
                    <mml:mrow>
                      <mml:mn>1.8</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM215">
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1.0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM216">
                    <mml:mrow>
                      <mml:mn>7.4</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM217">
                    <mml:mrow>
                      <mml:mn>8.4</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM218">
                    <mml:mrow>
                      <mml:mn>2.2</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td align="char" char="." colspan="1" rowspan="1">
                <inline-formula>
                  <mml:math id="MM219">
                    <mml:mrow>
                      <mml:mn>2.2</mml:mn>
                      <mml:mo>×</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mn>10</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="btv641-TF2">
            <p>Methods used are the proposed PCA-based method (Algorithm 1) and LFA method (Algorithms 2 and 3), and two competing methods, ADMIXTURE (ADX) and fastSTRUCTURE (FS), that directly fit the PSD model. The values reported are root mean squared error in the <italic>π<sub>ij</sub></italic> parameter. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref> for more extensive comparisons</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The computational time required to perform the proposed methods was also significantly better than ADMIXTURE and fastSTRUCTURE. Both proposed methods completed calculations on average over 10 times faster than ADMIXTURE and fastSTRUCTURE, with some scenarios as high as 150 times faster. This is notable in that both ADMIXTURE and fastSTRUCTURE are described as computationally efficient implementations of methods to estimate the PSD model (<xref rid="btv641-B3" ref-type="bibr">Alexander <italic>et</italic><italic>al.</italic>, 2009</xref>; <xref rid="btv641-B27" ref-type="bibr">Raj <italic>et</italic><italic>al.</italic>, 2014</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Analysis of the HGDP and TGP data</title>
      <p>We analyzed the HGDP and TGP data using the proposed methods. The HGDP data consisted of <italic>n</italic> = 940 individuals and <italic>m</italic> = 431 345 SNPs, and the TGP data consisted of <italic>n</italic> = 1500 and <italic>m</italic> = 339 100 (see <xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S1</xref> for details). We first applied PCA and LFA to these datasets and made bi-plots of the top three PCs and top three LFs (<xref ref-type="fig" rid="btv641-F2">Fig. 2</xref>). It can be seen that PCA and LFA provide similar visualizations of the structure present in these data. In addition, the structures estimated by these methods are related, but not identical, to the population labels provided in the original studies. We next chose a dimension <italic>d</italic> for the LFA model (Model 2) for each dataset. This was done by identifying the value of <italic>d</italic> that provides the best overall goodness of fit (<xref ref-type="supplementary-material" rid="sup1">Supplementary materials, Section S2</xref>). We identified <italic>d</italic> = 15 for HGDP and <italic>d</italic> = 7 for TGP based on this criterion.</p>
      <p>One drawback of utilizing a PCA-based approach (Algorithm 1) for estimating the individual-specific allele frequencies <inline-formula><mml:math id="MM222"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> is that we are not guaranteed that all values of the estimates lie in <inline-formula><mml:math id="MM223"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, so some form of truncation is necessary. We found that 65.4% of the SNPs in the HGDP dataset and 26.5% in the TGP dataset resulted in at least one estimated individual-specific allele frequency &lt;0 or &gt;1 before the truncation was applied. Therefore, the truncation in forming the estimate <inline-formula><mml:math id="MM224"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is necessary when employing Algorithm 1 to estimate <inline-formula><mml:math id="MM225"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> from Model 1. On the other hand, due to the formulation of Model 2, all estimated allele frequencies fall in the valid range when applying LFA (Algorithms 2 and 3).</p>
      <p>The LFA framework provides a natural computational method for ranking SNPs according to how differentiated they are with respect to structure. Accurately ranking SNPs according to this differentiation is a technique often used to identify genetic polymorphisms that are strong candidates for instances of positive selection (<xref rid="btv641-B13" ref-type="bibr">Coop <italic>et</italic><italic>al.</italic>, 2009</xref>). Note that existing methods typically require one to first assign each individual to one of <italic>K</italic> discrete subpopulations (as done in <xref rid="btv641-B13" ref-type="bibr">Coop <italic>et</italic><italic>al</italic><italic>.</italic>, 2009</xref>) which may make unnecessary assumptions on modern datasets such as HGDP and TGP. In order to rank SNPs for differentiation, we calculate the deviance statistic when performing a logistic regression of the SNPs genotypes on the logistic factors. Specifically, we calculated the deviance by comparing the models <inline-formula><mml:math id="MM226"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM227"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, where the former model is intercept only (i.e. <italic>d</italic> = 1, no structure).</p>
      <p>Our application of LFA to identify SNPs with allele frequencies differentiated according to structure can be developed further. First, the recently proposed ‘jackstraw’ approach (<xref rid="btv641-B11" ref-type="bibr">Chung and Storey, 2015</xref>) provides a manner in which statistical significance can be assigned to these SNPs. Assigning statistical significance to the population differentiation of SNPs has traditionally been a difficult problem (<xref rid="btv641-B2" ref-type="bibr">Akey <italic>et</italic><italic>al.</italic>, 2002</xref>). Second, we found the deviance measure tends to have more extreme values for SNPs with larger minor allele frequencies (MAFs). Therefore, the ranking of SNPs may be made more informative if MAF is taken into account. Third, although this ranking is identifying differentiation and not specifically selection, it may provide a useful starting point in understanding methods that attempt to detect selection.</p>
      <p>The most differentiated SNPs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S2</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Data</xref>) reveal some noteworthy results, especially considering the flexible approach to forming the ranking. SNPs located within or very close to <italic>SLC24A5</italic> were the top ranked in both HGDP and TGP. This gene is well known to be involved in determining skin pigmentation in humans (<xref rid="btv641-B19" ref-type="bibr">Lamason <italic>et</italic><italic>al.</italic>, 2005</xref>) and is hypothesized to have been subject to positive selection (<xref rid="btv641-B31" ref-type="bibr">Sabeti <italic>et</italic><italic>al.</italic>, 2007</xref>). The next most highly ranked SNPs in both studies are located in <italic>EDAR</italic>, which plays a major role in distinguishing phenotypes (e.g. hair follicles) among Asians. SNP rs3827760 is the second most differentiated SNP in the TGP data, which has also been hypothesized to be under positive selection in humans and whose causal role in the hair follicle phenotype has been verified in a mouse model (<xref rid="btv641-B18" ref-type="bibr">Kamberov <italic>et</italic><italic>al.</italic>, 2013</xref>). SNPs corresponding to these two genes for both studies are plotted in increasing order of <inline-formula><mml:math id="MM228"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values, revealing subtle variation within each major ancestral group in addition to coarser differences in allele frequency (<xref ref-type="fig" rid="btv641-F3">Fig. 3</xref>). Other noteworthy genes with highly differentiated proximal SNPs include:
We have provided information on the 5000 most differentiated SNPs for both TGP and HGDP as <xref ref-type="supplementary-material" rid="sup1">Supplementary material files</xref>.
</p>
      <list list-type="bullet">
        <list-item>
          <p><italic>FOXP1</italic>, which is a candidate gene for involvement in tumor progression and plays an important regulatory role with <italic>FOXP2</italic> (<xref rid="btv641-B7" ref-type="bibr">Banham <italic>et</italic><italic>al.</italic>, 2001</xref>; <xref rid="btv641-B33" ref-type="bibr">Shigekawa <italic>et</italic><italic>al.</italic>, 2011</xref>);</p>
        </list-item>
        <list-item>
          <p><italic>TBC1D1</italic> in which genetic variation has been shown to confer risk for severe obesity in females (<xref rid="btv641-B36" ref-type="bibr">Stone <italic>et</italic><italic>al.</italic>, 2006</xref>);</p>
        </list-item>
        <list-item>
          <p><italic>KIF3C</italic>, a novel kinesin-like protein, which has been hypothesized to be involved in microtubule-based transport in neuronal cells (<xref rid="btv641-B32" ref-type="bibr">Sardella <italic>et</italic><italic>al.</italic>, 1998</xref>);</p>
        </list-item>
        <list-item>
          <p><italic>KCNMA1</italic>, a recently identified susceptibility locus for obesity (<xref rid="btv641-B16" ref-type="bibr">Jiao <italic>et</italic><italic>al.</italic>, 2011</xref>);</p>
        </list-item>
        <list-item>
          <p><italic>CTNNA3</italic> in which genetic variation has been shown to be associated with diisocyanate-induced occupational asthma (<xref rid="btv641-B9" ref-type="bibr">Bernstein <italic>et</italic><italic>al.</italic>, 2013</xref>);</p>
        </list-item>
        <list-item>
          <p><italic>PTK6</italic>, breast tumor kinase (Brk), which is known to function in cell-type and context-dependent processes governing normal differentiation (<xref rid="btv641-B25" ref-type="bibr">Ostrander <italic>et</italic><italic>al.</italic>, 2010</xref>).</p>
        </list-item>
      </list>
      <fig id="btv641-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>SNPs with highly differentiated allele frequencies with respect to structure. Two of the most highly different SNPs according to LFA are shown for the HGDP and TGP datasets. For each SNP, the <inline-formula><mml:math id="MM229"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values are ordered and they are colored according reported ancestry. The horizontal bars on the sides of the plots denote the usual allele frequency estimates formed within each ancestral group</p>
        </caption>
        <graphic xlink:href="btv641f3p"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have investigated two latent variable models of population structure to simultaneously estimate all individual-specific allele frequencies from genome-wide genotyping data. Model 1, a direct model of allele frequencies, can be estimated by using a modified PCA and Model 2, a model of the <inline-formula><mml:math id="MM230"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> transformation of allele frequencies, is estimated through a new approach we called LFA. For both models, the latent variables are estimated in a non-parametric fashion, meaning we do not make any assumptions about the underlying structure captured by the latent variables. These models are general in that they allow for each individual’s genotype to be generated from an allele frequency specific to that individual, which includes discretely structured populations, admixed populations and spatially structured populations. In LFA, we construct a model of the <inline-formula><mml:math id="MM231"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> of these allele frequencies in terms of underlying factors that capture the population structure. We have proposed a computationally efficient method to estimate this model that requires only two applications of SVD. This approach builds on the success of PCA in that we are able to capture population structure in terms of a low-dimensional basis. It improves on PCA in that the latent variables we estimate can be straightforwardly incorporated into downstream statistical inference procedures that require well-behaved estimates of allele frequencies. In particular, statistical inferences of Hardy–Weinberg equilibrium, <inline-formula><mml:math id="MM232"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>ST</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and marker-trait associations are amenable to complex population structures within our framework.</p>
    <p>We demonstrated our proposed approach on the HGDP and TGP datasets and several simulated datasets motivated by the HapMap, HGDP and TGP datasets as well as the PSD model and spatially distributed structures. It was shown that our method estimates the underlying logistic factors with a high degree of accuracy. We also showed that applying PCA to genotype data estimates a row basis of population structure on the original allele frequency scale to a high degree of accuracy. However, problems occur when trying to recover estimates of individual-specific allele frequencies because PCA is a real-valued model that does not always result in allele frequency estimates lying between 0 and 1.</p>
    <p>Although PCA has become very popular for genome-wide genotype data, it should be stressed that PCA is fundamentally a method for characterizing variance and special care should be taken when applying it to estimate latent variables. The authoritative treatment of PCA (<xref rid="btv641-B17" ref-type="bibr">Jolliffe, 2010</xref>) eloquently makes this point throughout the text and considers cases where factor analysis is more appropriate than PCA through examples reminiscent of the population structure problem. Here, we have shown that modeling and estimating population structure can be understood from the factor analysis perspective, leading to estimates of individual-specific allele frequencies through their natural parameter on the <inline-formula><mml:math id="MM233"><mml:mrow><mml:mtext>logit</mml:mtext></mml:mrow></mml:math></inline-formula> scale. At the same time, we have avoided some of the difficulties of traditional parametric factor analysis by maintaining the relevant non-parametric properties of PCA, specifically in making no assumptions about the underlying probability distributions of the logistic factors that capture population structure.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btv641_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Funding</title>
    <p>This research was supported in part by NIH grant R01 HG006448.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btv641-B1">
      <mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium</collab> (<year>2010</year>) <article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>, <volume>467</volume>, <fpage>1061</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akey</surname><given-names>J.M.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>Interrogating a high-density SNP map for signatures of natural selection</article-title>. <source>Genome Res.</source>, <volume>12</volume>, <fpage>1805</fpage>–<lpage>1814</lpage>.<pub-id pub-id-type="pmid">12466284</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>D.H.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title>. <source>Genome Res.</source>, <volume>19</volume>, <fpage>1655</fpage>–<lpage>1664</lpage>.<pub-id pub-id-type="pmid">19648217</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Astle</surname><given-names>W.</given-names></name><name><surname>Balding</surname><given-names>D.J.</given-names></name></person-group> (<year>2009</year>) <article-title>Population structure and cryptic relatedness in genetic association studies</article-title>. <source>Stat. Sci.</source>, <volume>24</volume>, <fpage>451</fpage>–<lpage>471</lpage>.</mixed-citation>
    </ref>
    <ref id="btv641-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baglama</surname><given-names>J.</given-names></name><name><surname>Reichel</surname><given-names>L.</given-names></name></person-group> (<year>2006</year>) <article-title>Restarted block Lanczos Bidiagonalization methods</article-title>. <source>Numer. Algorithms</source>, <volume>43</volume>, <fpage>251</fpage>–<lpage>272</lpage>.</mixed-citation>
    </ref>
    <ref id="btv641-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balding</surname><given-names>D.J.</given-names></name><name><surname>Nichols</surname><given-names>R.A.</given-names></name></person-group> (<year>1995</year>) <article-title>A method for quantifying differentiation between populations at multi-allelic loci and its implications for investigating identity and paternity</article-title>. <source>Genetica</source>, <volume>96</volume>, <fpage>3</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">7607457</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banham</surname><given-names>A.H.</given-names></name><etal/></person-group> (<year>2001</year>) <article-title>The foxp1 winged helix transcription factor is a novel candidate tumor suppressor gene on chromosome 3p</article-title>. <source>Cancer Res.</source>, <volume>61</volume>, <fpage>8820</fpage>–<lpage>8829</lpage>.<pub-id pub-id-type="pmid">11751404</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bartholomew</surname><given-names>D.J.</given-names></name><etal/></person-group> (<year>2011</year>) <source>Latent Variable Models and Factor Analysis: A Unified Approach</source>. <publisher-name>Wiley Series in Probability and Statistics</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btv641-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernstein</surname><given-names>D.I.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Ctnna3 (<italic>α</italic>-catenin) gene variants are associated with diisocyanate asthma: a replication study in a Caucasian worker population</article-title>. <source>Toxicol. Sci.</source><italic>, </italic><volume>131</volume>, <fpage>242</fpage>–<lpage>246</lpage>.<pub-id pub-id-type="pmid">22977168</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cann</surname><given-names>H.M.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>A human genome diversity cell line panel</article-title>. <source>Science</source>, <volume>296</volume>, <fpage>261</fpage>–<lpage>262</lpage>.<pub-id pub-id-type="pmid">11954565</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>N.C.</given-names></name><name><surname>Storey</surname><given-names>J.D.</given-names></name></person-group> (<year>2015</year>) <article-title>Statistical significance of variables driving systematic variation</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>545</fpage>–<lpage>554</lpage>.<pub-id pub-id-type="pmid">25336500</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B12">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>A generalization of principal component analysis to the exponential family</article-title>. In: <comment>Dietterich,T.G. <italic>et al</italic>. (eds), Proceedings of Advances in Neural Information Processing Systems (NIPS), MIT Press, vol. 14, pp. 617–624</comment>.</mixed-citation>
    </ref>
    <ref id="btv641-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coop</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>The role of geography in human adaptation</article-title>. <source>PLoS Genet.</source>, <volume>5</volume>, <fpage>e1000500</fpage>.<pub-id pub-id-type="pmid">19503611</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corona</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Analysis of the genetic basis of disease in the context of worldwide human relationships and migration</article-title>. <source>PLoS Genet.</source>, <volume>9</volume>, <fpage>e1003447</fpage>.<pub-id pub-id-type="pmid">23717210</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelhardt</surname><given-names>B.E.</given-names></name><name><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>) <article-title>Analysis of population structure: a unifying framework and novel methods based on sparse factor analysis</article-title>. <source>PLoS Genet.</source>, <volume>6</volume>, <fpage>e1001117</fpage>.<pub-id pub-id-type="pmid">20862358</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiao</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Genome wide association study identifies kcnma1 contributing to human obesity</article-title>. <source>BMC Med. Genom.</source>, <volume>4</volume>, <fpage>51</fpage>.</mixed-citation>
    </ref>
    <ref id="btv641-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jolliffe</surname><given-names>I.T.</given-names></name></person-group> (<year>2010</year>) <source>Principal Component Analysis</source>, <edition>2nd edn</edition>
<publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv641-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamberov</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Modeling recent human evolution in mice by expression of a selected EDAR variant</article-title>. <source>Cell</source>, <volume>152</volume>, <fpage>691</fpage>–<lpage>702</lpage>.<pub-id pub-id-type="pmid">23415220</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamason</surname><given-names>R.L.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Slc24a5, a putative cation exchanger, affects pigmentation in zebrafish and humans</article-title>. <source>Science</source>, <volume>310</volume>, <fpage>1782</fpage>–<lpage>1786</lpage>.<pub-id pub-id-type="pmid">16357253</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lehmann</surname><given-names>E.L.</given-names></name><name><surname>Casella</surname><given-names>G.</given-names></name></person-group> (<year>1998</year>) <source>Theory of Point Estimation</source>, <edition>2nd edn</edition>
<publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.,</mixed-citation>
    </ref>
    <ref id="btv641-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manni</surname><given-names>F.</given-names></name></person-group> (<year>2010</year>). <article-title>Interview with Luigi Luca Cavalli-Sforza: past research and directions for future investigations in human population genetics</article-title>. <source>Hum. Biol.</source>, <volume>82</volume>, <fpage>245</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">20649383</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>McCullagh</surname><given-names>P.</given-names></name><name><surname>Nelder</surname><given-names>J.A.</given-names></name></person-group> (<year>1989</year>) <source>Generalized Linear Models</source>. <publisher-name>Chapman and Hall</publisher-name>, <publisher-loc>London</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv641-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menozzi</surname><given-names>P.</given-names></name><etal/></person-group> (<year>1978</year>) <article-title>Synthetic maps of human gene frequencies in Europeans</article-title>. <source>Science</source>, <volume>201</volume>, <fpage>786</fpage>–<lpage>792</lpage>.<pub-id pub-id-type="pmid">356262</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novembre</surname><given-names>J.</given-names></name><name><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2008</year>) <article-title>Interpreting principal component analyses of spatial population genetic variation</article-title>. <source>Nat. Genet.</source>, <volume>40</volume>, <fpage>646</fpage>–<lpage>649</lpage>.<pub-id pub-id-type="pmid">18425127</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostrander</surname><given-names>J.H.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Brk/ptk6 signaling in normal and cancer cell models</article-title>. <source>Curr. Opin. Pharmacol.</source>, <volume>10</volume>, <fpage>662</fpage>–<lpage>669</lpage>.<pub-id pub-id-type="pmid">20832360</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>J.K.</given-names></name><etal/></person-group> (<year>2000</year>) <article-title>Inference of population structure using multilocus genotype data</article-title>. <source>Genetics</source>, <volume>155</volume>, <fpage>945</fpage>–<lpage>959</lpage>.<pub-id pub-id-type="pmid">10835412</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raj</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>fastSTRUCTURE: Variational inference of population structure in large SNP datasets</article-title>. <source>Genetics</source>, <volume>197</volume>, <fpage>573</fpage>–<lpage>589</lpage>.<pub-id pub-id-type="pmid">24700103</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rendine</surname><given-names>S.</given-names></name><etal/></person-group> (<year>1999</year>) <article-title>A problem with synthetic maps: Reply to Sokal et al</article-title>. <source>Hum. Biol.</source>, <volume>71</volume>, <fpage>15</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btv641-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>N.A.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>Genetic structure of human populations</article-title>. <source>Science</source>, <volume>298</volume>, <fpage>2381</fpage>–<lpage>2385</lpage>.<pub-id pub-id-type="pmid">12493913</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>N.A.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Clines, clusters, and the effect of study design on the inference of human population structure</article-title>. <source>PLoS Genet.</source>, <volume>1</volume>, <fpage>e70</fpage>.<pub-id pub-id-type="pmid">16355252</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sabeti</surname><given-names>P.C.</given-names></name><etal/></person-group> (<year>2007</year>) <article-title>Genome-wide detection and characterization of positive selection in human populations</article-title>. <source>Nature</source>, <volume>449</volume>, <fpage>913</fpage>–<lpage>918</lpage>.<pub-id pub-id-type="pmid">17943131</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sardella</surname><given-names>M.</given-names></name><etal/></person-group> (<year>1998</year>) <article-title>Kif3c, a novel member of the kinesin superfamily: sequence, expression, and mapping to human chromosome 2 at 2p23</article-title>. <source>Genomics</source>, <volume>47</volume>, <fpage>405</fpage>–<lpage>408</lpage>.<pub-id pub-id-type="pmid">9480755</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shigekawa</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Foxp1, an estrogen-inducible transcription factor, modulates cell proliferation in breast cancer cells and 5-year recurrence-free survival of patients with tamoxifen-treated breast cancer</article-title>. <source>Hormon. Cancer</source>, <volume>2</volume>, <fpage>286</fpage>–<lpage>297</lpage>.</mixed-citation>
    </ref>
    <ref id="btv641-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sokal</surname><given-names>R.R.</given-names></name><etal/></person-group> (<year>1999</year>). <article-title>A problem with synthetic maps</article-title>. <source>Hum. Biol.</source>, <volume>71</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">9972095</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Testing for genetic associations in arbitrarily structured populations</article-title>. <source>Nat. Genet.</source>, <volume>47</volume>, <fpage>550</fpage>–<lpage>554</lpage>.<pub-id pub-id-type="pmid">25822090</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2006</year>) <article-title>Tbc1d1 is a candidate for a severe obesity gene and evidence for a gene/gene interaction in obesity predisposition</article-title>. <source>Hum. Mol. Genet.</source>, <volume>15</volume>, <fpage>2709</fpage>–<lpage>2720</lpage>.<pub-id pub-id-type="pmid">16893906</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Estimation of individual admixture: analytical and study design considerations</article-title>. <source>Genet. Epidemiol.</source>, <volume>28</volume>, <fpage>289</fpage>–<lpage>301</lpage>.<pub-id pub-id-type="pmid">15712363</pub-id></mixed-citation>
    </ref>
    <ref id="btv641-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornton</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Estimating kinship in admixed populations</article-title>. <source>Am. J. Hum. Genet.</source>, <volume>91</volume>, <fpage>122</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">22748210</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
