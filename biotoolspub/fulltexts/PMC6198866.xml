<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6198866</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty427</article-id>
    <article-id pub-id-type="publisher-id">bty427</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MODE-TASK: large-scale protein motion tools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ross</surname>
          <given-names>Caroline</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff1">1</xref>
        <xref ref-type="author-notes" rid="bty427-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nizami</surname>
          <given-names>Bilal</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff1">1</xref>
        <xref ref-type="author-notes" rid="bty427-FM1"/>
        <xref ref-type="corresp" rid="bty427-cor2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glenister</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sheik Amamuddy</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Atilgan</surname>
          <given-names>Ali Rana</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Atilgan</surname>
          <given-names>Canan</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tastan Bishop</surname>
          <given-names>Özlem</given-names>
        </name>
        <xref ref-type="aff" rid="bty427-aff1">1</xref>
        <xref ref-type="corresp" rid="bty427-cor1"/>
        <!--<email>o.tastanbishop@ru.ac.za</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty427-aff1"><label>1</label>Research Unit in Bioinformatics (RUBi), Department of Biochemistry and Microbiology, Rhodes University, Grahamstown, South Africa</aff>
    <aff id="bty427-aff2"><label>2</label>Faculty of Engineering and Natural Sciences, Sabanci University, Tuzla, Turkey </aff>
    <author-notes>
      <fn id="bty427-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. </p>
      </fn>
      <corresp id="bty427-cor2">Present address: Institute of Materials and Environmental Chemistry, Research Centre for Natural Sciences, Hungarian Academy of Sciences, H-1117 Budapest, Magyar tudósok körútja 2, Hungary</corresp>
      <corresp id="bty427-cor1">To whom correspondence should be addressed. E-mail: <email>o.tastanbishop@ru.ac.za</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-29">
      <day>29</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>21</issue>
    <fpage>3759</fpage>
    <lpage>3763</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty427.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>MODE-TASK, a novel and versatile software suite, comprises Principal Component Analysis, Multidimensional Scaling, and t-Distributed Stochastic Neighbor Embedding techniques using Molecular Dynamics trajectories. MODE-TASK also includes a Normal Mode Analysis tool based on Anisotropic Network Model so as to provide a variety of ways to analyse and compare large-scale motions of protein complexes for which long MD simulations are prohibitive. Beside the command line function, a GUI has been developed as a PyMOL plugin.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>MODE-TASK is open source, and available for download from <ext-link ext-link-type="uri" xlink:href="https://github.com/RUBi-ZA/MODE-TASK">https://github.com/RUBi-ZA/MODE-TASK</ext-link>. It is implemented in Python and C++. It is compatible with Python 2.x and Python 3.x and can be installed by Conda.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup2">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Research Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100011512</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NRF</named-content>
          <named-content content-type="funder-identifier">10.13039/100007431</named-content>
        </funding-source>
        <award-id>93690</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Human Genome Research Institute</named-content>
          <named-content content-type="funder-identifier">10.13039/100000051</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NHGRI</named-content>
          <named-content content-type="funder-identifier">10.13039/100000051</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>U24HG006941</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Scientific and Technological Research Council of Turkey</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004410</named-content>
        </funding-source>
        <award-id>116F229</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Conventional analysis of Molecular Dynamics (MD) trajectories may not identify global motions of macromolecules. Normal Mode Analysis (NMA) and Principal Component Analysis (PCA) are two popular methods to quantify large-scale motions, and find the ‘essential motions’; and have been applied to problems such as drug resistant mutations (<xref rid="bty427-B9" ref-type="bibr">Nizami <italic>et al.</italic>, 2016</xref>) and viral capsid expansion (<xref rid="bty427-B5" ref-type="bibr">Hsieh <italic>et al.</italic>, 2016</xref>).</p>
    <p>MODE-TASK is an array of tools to analyse and compare protein dynamics obtained from MD simulations and/or coarse grained Elastic Network Models (ENMs). Users can perform standard PCA, kernel and incremental PCA (IPCA). Data reduction techniques [Multidimensional Scaling (MDS) and t-Distributed Stochastics Neighbor Embedding (t-SNE)] are implemented. This is the first set of tools with various extensions of PCA and other dimensionality reduction techniques for protein MD simulations. Users can also analyse normal modes by constructing ENMs of a protein complex. This tool forms the first complete set of scripts that have been developed specifically for NMA of biological assemblies. A novel coarse graining technique has been incorporated that allows the user to analyse the normal modes of a biological assembly without the use of high performance computers. The MODE-TASK coarse graining algorithm offers an alternative approach to the rotation-translation of blocks (RTB) method (<xref rid="bty427-B4" ref-type="bibr">Durand <italic>et al.</italic>, 1994</xref>; <xref rid="bty427-B15" ref-type="bibr">Tama <italic>et al.</italic>, 2000</xref>). The algorithm was recently validated in a virus study (<xref rid="bty427-B12" ref-type="bibr">Ross <italic>et al.</italic>, 2018</xref>).</p>
    <p>Beside the command line MODE-TASK, a GUI has been developed as a PyMOL plugin for easy access to all the rich and diverse functionality of MODE-TASK tools. This makes MODE-TASK and its associated pyMODE-TASK GUI a complete, unique and diverse package for analysing the large-scale motion of proteins and protein complexes.</p>
  </sec>
  <sec>
    <title>2 Materials and Methods</title>
    <sec>
      <title>2.1 Implementation</title>
      <p>MODE-TASK was developed using C++ and Python programming languages on Linux/Unix-based systems. The C++ scripts were wrapped and are accessible from Python, and all scripts are compatible with Python 2 and 3. Python libraries, including NumPy, SciPy, Matplotlib (<xref rid="bty427-B6" ref-type="bibr">Hunter, 2007</xref>), MDTraj (<xref rid="bty427-B8" ref-type="bibr">McGibbon <italic>et al.</italic>, 2015</xref>) and Scikit-learn (<xref rid="bty427-B10" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>), were used. The C++ ALGLIB (<ext-link ext-link-type="uri" xlink:href="http://www.alglib.net">www.alglib.net</ext-link>) was also utilized. MODE-TASK supports a wide variety of MD trajectory and topology formats including binpos (AMBER), LH5 (MSMBuilder2), PDB, XML (OpenMM, HOOMD-Blue), .arc (TINKER), .dcd (NAMD), .dtr (DESMOND), hdf5, NetCDF (AMBER), .trr (Gromacs), .xtc (Gromacs), .xyz (VMD), .mdcrd (AMBER) and LAMMPS. PyMODE-TASK – a PyMOL plugin was developed using Python, Tkinter and Pmw1.3 (Python megawidgets). Tkinter is a standard Python interface to Tk GUI toolkit. Tk is a cross platform, free and an open source library for creating a graphical user interface.</p>
    </sec>
    <sec>
      <title>2.2 Model analysis by elastic network models</title>
      <sec>
        <title>2.2.1 Mode calculation</title>
        <p>MODE-TASK employs the Anisotropic Network Model (ANM) (<xref rid="bty427-B1" ref-type="bibr">Atilgan <italic>et al.</italic>, 2001</xref>) to construct an ENM of the protein where all pairs of nodes separated by a defined cutoff are connected. For a given PDB file, the algorithm builds the Hessian matrix on the atomic co-ordinates of the <italic>C</italic><sub>α</sub> or <italic>C</italic><sub>β</sub> atoms of each residue in the complex. It incorporates the ALGLIB library to calculate the pseudoinverse of the Hessian by singular value decomposition. This process leads to the eigenvalues and eigenvectors associated with the normal modes.</p>
      </sec>
      <sec>
        <title>2.2.2 Coarse graining</title>
        <p>An elastic network of a macromolecular system gives rise to a Hessian matrix with dimensions that are too large for time-feasible decomposition. MODE-TASK implements a novel coarse graining algorithm that selects a sub-set of the carbon atoms that are evenly spaced across the structure of biological assemblies of macromolecules. The algorithm exploits the symmetry of the assembly by first identifying a sub-set of atoms from selected residues in an individual asymmetric unit, and then selecting the corresponding atoms from the identical residues in all other asymmetric units of the complex. In comparison to the RTB approach, the primary difference is that in MODE-TASK the criterion for selection is derived from the distance between the atoms in the structure; therefore, the coarse-grained model reflects the number of contacts between individual atoms, supporting the analysis of more localized motions. In the standard RTB approach the network is defined by a set of rigid blocks, where each block is based on the centre of mass of a single protein in the complex (<xref rid="bty427-B4" ref-type="bibr">Durand <italic>et al.</italic>, 1994</xref>; <xref rid="bty427-B15" ref-type="bibr">Tama <italic>et al.</italic>, 2000</xref>). This network only accounts for the connections between the proteins in the complex; while the higher level of intraprotein connectivity is lost. In contrast, the MODE-TASK network incorporates the interconnection of nodes within the individual proteins as well as across the protein-protein interfaces. This reduces the rigidity of the relative motions of the proteins that is enforced by the RTB method and may capture local motions within the proteins of the complex. The difference between the two networks has been depicted in <xref ref-type="supplementary-material" rid="sup2">Supplementary Figure S1</xref>.</p>
        <p>The MODE-TASK algorithm was validated in a previous study of the Enterovirus 71 (EV71) capsid (<xref rid="bty427-B12" ref-type="bibr">Ross <italic>et al.</italic>, 2018</xref>). The EV71 capsid is icosahedral with <italic>T </italic>=<italic> </italic>3 symmetry. NMA of symmetrical structures yield degenerate and non-degenerate modes. Degenerate modes present with identical eigenvalues and correspond to modes for which any spatial rotation will result in a valid representation of the mode with identical frequency (<xref rid="bty427-B17" ref-type="bibr">Yang <italic>et al.</italic>, 2009</xref>). As degenerate modes arise from symmetry, for any given structure there is a precise set of allowed degeneracies. The MODE-TASK algorithm was applied to the full EV71 capsid and to an individual pentamer of the capsid. The modes calculated for the coarse-grained capsid and pentamer presented with the allowed degeneracies defined for an icosahedron and pentagon, respectively. Moreover, such results were observed regardless of an increase in the level of coarse-graining. The NMA of the EV71 capsid, coarse grained at different levels, captured three modes that contributed to capsid expansion. Of these three modes, radial expansion of the capsid was reported. In a previous study, the RTB approach was used to investigate the normal modes of virus capsids comprising different quasi-equivalent symmetries (<xref rid="bty427-B16" ref-type="bibr">Tama and Brooks, 2005</xref>). Included in the study was the <italic>T </italic>=<italic> </italic>3 Cowpea Chlorotic Mottle Virus (CCMV). The RTB approach only captured a single dominant mode (radial expansion) for the CCMV capsid. It was suggested that the two additional modes captured by the MODE-TASK algorithm represent the local motions within a pentameric unit (<xref rid="bty427-B12" ref-type="bibr">Ross <italic>et al.</italic>, 2018</xref>).</p>
        <p>Pseudocode, describing the MODE-TASK algorithm has been included in <xref ref-type="supplementary-material" rid="sup2">Supplementary Appendix A1</xref>. The script, specifically developed for the analysis of proteins only, can accept a standard PDB file or a biological assembly of a protein complex (.pdb1). In the initial step, the algorithm selects the <italic>C</italic><sub>α</sub>/<italic>C</italic><sub>β</sub> atom from a starting residue defined by the user. The algorithm then determines the distance between this atom and every other <italic>C</italic><sub>α</sub>/<italic>C</italic><sub>β</sub> in a single asymmetric unit of the assembly. For a specified level of coarse graining, the algorithm selects the <italic>n</italic>th closest <italic>C</italic><sub>α</sub>/<italic>C</italic><sub>β</sub> to the starting point and defines a minimum distance as the distance between the initial and the selected <italic>n</italic>th closest atom. The algorithm then expands outwards and iteratively steps through the (<italic>n </italic>+<italic> </italic>1)<sup>th</sup> closest atom. The atom is selected only if the distance between all atoms that have already been selected is greater than the defined minimum distance, thus avoiding the selection of clustered atoms. If the atom is not selected it will be marked and excluded from possible selection in subsequent iterations. The algorithm stops when all atoms in a single asymmetric unit have been scanned for possible selection. For an assembly of multiple asymmetric units, the algorithm extends to select the <italic>C</italic><sub>α</sub>/<italic>C</italic><sub>β</sub> of residues in each unit that correspond to the selected atoms. As such, the symmetry of the assembly is retained and selected atoms are evenly distributed across the molecule.</p>
      </sec>
      <sec>
        <title>2.2.3 Analysis and visualisation</title>
        <p>MODE-TASK has an array of tools to extract and visualise individual modes. In comparison to other tools developed for NMA of proteins such as ProDy (<xref rid="bty427-B2" ref-type="bibr">Bakan <italic>et al.</italic>, 2011</xref>), MODE-TASK includes specialized algorithms for the extensive analysis of biological assemblies. MODE-TASK contains a tool to identify modes that act in the direction of a known conformational change between two crystal structures. The tool calculates the overlap and Pearson coefficient between a predicted displacement and an experimental conformational change. The calculation can be performed across the entire biological assembly, or the user can calculate the overlap/correlation per each asymmetric unit and each individual chain in the complex. This allows the user to determine which region of the complex contributes the most towards the conformational change for a given mode. MODE-TASK also contains a tool to plot covariance matrices for a given set of modes. The user may produce a plot that represents the complete assembly, or construct the covariance plots between a set of specified asymmetric units across the complex. For example, in the analysis of a virus capsid the user may analyse the covariance between protomers within a single pentamer, in comparison to protomers across the pentamer-pentamer interface. Basic tools to calculate the mean square fluctuations for each atom in the system for a given set of modes are also included. In addition, the user can compare fluctuations between two alternative models. This allows the user to compare two different protein structures or two models of the same complex that have been coarse grained to a different level.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Modal analysis by PCA</title>
      <sec>
        <title>2.3.1 Standard PCA</title>
        <p>MODE-TASK takes the MD trajectory and topology file as input and extracts the atomic coordinates of a set of atoms of the user’s choice. Before applying the PCA algorithm, frames are superimposed onto a reference structure of the user’s choice (first frame of trajectory by default). A matrix of atomic coordinates can be diagonalised by either Eigenvalue Decomposition (EVD) or Singular Value Decomposition (SVD) to obtain the collective modes (eigenvectors) and associated eigenvalues which characterize the motion of proteins during the MD simulation. The magnitude of an eigenvalue represents the variance of the data covered by its eigenvector. In the case of EVD, the most important motions are extracted by calculating the modes from a covariance/correlation matrix constructed from atomic coordinates which are ranked based on their ability to explain the variance in the data. MODE-TASK retains all the modes by default with an option for the user to select a subset of the components. The input trajectory is projected onto the selected modes. These projections are called Principal Components (PCs), which represent the dynamics of a protein in terms of a reduced set of orthonormal modes.</p>
        <p>Though computationally expensive in certain cases (<xref rid="bty427-B3" ref-type="bibr">David and Jacobs, 2014</xref>), the use of internal coordinates for PCA offers better qualitative insights, especially in protein folding (<xref rid="bty427-B14" ref-type="bibr">Sittel <italic>et al.</italic>, 2014</xref>). Moreover, it is also suggested to use Kernel PCA with internal coordinates. MODE-TASK has the tools to perform the PCA and Kernel PCA on the internal coordinates such as pairwise distance, 1–3 angles of the backbone atoms and torsion angles. Choice of internal coordinates removes the necessity for the pre-alignment of frames (<xref rid="bty427-B14" ref-type="bibr">Sittel <italic>et al.</italic>, 2014</xref>).</p>
      </sec>
      <sec>
        <title>2.3.2 Kernel PCA</title>
        <p>Standard PCA assumes that input data are linearly related. In cases where variables are not intrinsically linearly related, the user has an option to perform Kernel PCA, a nonlinear generalization of PCA, on an MD trajectory. MODE-TASK offers different choices for the kernel. In Kernel PCA, the input trajectory is raised to a higher dimension by a kernel function and PCA is performed on the elevated data. Kernel PCA should be used with caution as it is difficult to interpret the results, since the input trajectory is mapped to a different feature space than conformational space (<xref rid="bty427-B3" ref-type="bibr">David and Jacobs, 2014</xref>). Nevertheless, Kernel PCA could be an invaluable tool in studying structural mechanisms behind protein dynamics in cases where standard PCA is not helpful.</p>
      </sec>
      <sec>
        <title>2.3.3 Incremental PCA</title>
        <p>The speed of PCA calculation can be hindered by insufficient memory during loading of an MD trajectory. IPCA is a memory efficient variant of PCA that uses only the most substantial singular vectors to project the input data to a lower dimension. The IPCA algorithm uses a batch data loading approach and the incremental storage of various variables to achieve higher memory efficiency. MODE-TASK has implemented IPCA through scikit-learn Python library and the original algorithm (<xref rid="bty427-B10" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>; <xref rid="bty427-B11" ref-type="bibr">Ross <italic>et al.</italic>, 2008</xref>).</p>
      </sec>
      <sec>
        <title>2.3.4 Assessment of extent of sampling</title>
        <p>Assessment of the extent of sampling in an MD trajectory is crucial before performing PCA. One such measure of sampling is Kaiser–Meyer–Olkin (KMO) index (<xref rid="bty427-B13" ref-type="bibr">Sarmento and Costa, 2017</xref>), calculated by,
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mi>K</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
The value of KMO ranges between 0 and 1, where 1 indicates a perfect sampling. MODE-TASK also calculates the cosine content of the top three PCs. The cosine content is the measure of correlation between the <italic>T</italic> values of a PC and cosine function (cos(2<italic>πt</italic>/<italic>bT</italic>)), where 0 &lt; <italic>tT</italic> &lt;, <italic>b</italic> = <italic>n</italic>/2 and n is the index of PC. Cosine content values near 1 are an indicator that the simulation did not converge (<xref rid="bty427-B3" ref-type="bibr">David and Jacobs, 2014</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Other dimensionality reduction techniques</title>
      <p>MDS is a technique of dimensionality reduction where a measure of dissimilarity in a dataset is used. It places each input point in <italic>N</italic>-dimensional space while trying to preserve the original distance matrix. MODE-TASK implements metric and nonmetric types of MDS for the MD trajectory by using the scikit-learn library (<xref rid="bty427-B10" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>). The Euclidean distance between internal coordinates and pairwise RMSD between the MD frames are used as dissimilarity measures.t-SNE is another dimensionality reduction for high dimensional data (<xref rid="bty427-B7" ref-type="bibr">van der Maaten and Hinton, 2008</xref>). t-SNE has been implemented for protein MD trajectory in MODE-TASK. The dissimilarity measures used are the same as for MDS.</p>
    </sec>
    <sec>
      <title>2.5 Outputs</title>
      <p>Essential outputs from the ANM tool set include a coarse-grained PDB structure. The complete set of eigenvalues and eigenvectors, correlations to conformational changes, and the mean square fluctuations for specific modes are written in text file format. For visualisation, eigenvectors are projected onto the structure as a set of frames in which the vectors are added to the original atomic coordinates in increasing steps and corresponding arrows are given in a Tcl script. Useful information about the input trajectory is printed on the terminal. In case of PCA, a 2D plot of the first three PCs is written in a grace formatted text file. Additionally, a .png format 2D plot is also written; with each point color coded per time of trajectory. A screen plot of variance explained by 100 PCs is also written for evaluation purposes. The contribution of each residue towards a PC is visualized in MODE-TASK through RMSD mode plots in a grace formatted text file. In the case of MDS and t-SNE, 2D grace plots and .png files are constructed by MODE-TASK.</p>
    </sec>
    <sec>
      <title>2.6 User interface</title>
      <p>The MODE-TASK tool kit can be downloaded and run through the command line. A PyMOL plugin (pyMODE-TASK) has also been developed to make the functionality of the tool accessible from a GUI. PyMOL is a community-run, mixed source (source code is freely available to build) and widely used molecular visualization program. Availability of the MODE-TASK functionality to the large base of PyMOL users is crucial for the widespread reach of the unique capabilities and novel coarse graining algorithm of MODE-TASK. The plugin (<xref ref-type="supplementary-material" rid="sup2">Supplementary Fig. S2</xref>) is designed to be intuitive and user friendly with separate tabs for each step in the analysis. To help guide the users, the buttons and text fields have roll over help texts and appropriate warning and error messages. For each analysis step, the user also has the option to set the output directory where all the plots and results files are saved. Additionally, help pages including theory, usage and tutorials are accessible from the “Help” menu.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Performance</title>
    <table-wrap id="T" orientation="portrait" position="float">
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="left" rowspan="1" colspan="1">Main parameters</th>
            <th align="left" rowspan="1" colspan="1">Time</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td colspan="3" rowspan="1">
              <bold>NMA scripts</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">coarseGrain.py</td>
            <td rowspan="1" colspan="1">5C4W full capsid; Coarse grain level 4; C<sub>β</sub> atoms starting atom 3</td>
            <td rowspan="1" colspan="1">&lt;1 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ANM</td>
            <td rowspan="1" colspan="1">5C4W coarse-grained; Cut off 50 Å; 2460 nodes</td>
            <td rowspan="1" colspan="1">97 min</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">conformationMode.py</td>
            <td rowspan="1" colspan="1">4JGY full capsid; 5C4W coarse-grained</td>
            <td rowspan="1" colspan="1">26 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">combinationMode.py</td>
            <td rowspan="1" colspan="1">4JGY full capsid; 5C4W coarse-grained</td>
            <td rowspan="1" colspan="1">26 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">visualiseVector.py</td>
            <td rowspan="1" colspan="1">5C4W coarse-grained; mode 7</td>
            <td rowspan="1" colspan="1">1 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">assemblyCovariance.py</td>
            <td rowspan="1" colspan="1">5C4W coarse-grained; mode 7</td>
            <td rowspan="1" colspan="1">317 secs</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">meanSquareFluctuations.py</td>
            <td rowspan="1" colspan="1">4JGY coarse-grain level 9; 5C4W coarse-grained; mode 7</td>
            <td rowspan="1" colspan="1">275 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>Essential dynamics scripts</bold>
            </td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">pca.py</td>
            <td rowspan="1" colspan="1">SVD solver; 10 000 frames</td>
            <td rowspan="1" colspan="1">26 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">pca.py</td>
            <td rowspan="1" colspan="1">RBF kernel; 10 000 frames</td>
            <td rowspan="1" colspan="1">40 min</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">internal_pca.py</td>
            <td rowspan="1" colspan="1">Phi angles; 1 000 frames</td>
            <td rowspan="1" colspan="1">10 s</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">mds.py</td>
            <td rowspan="1" colspan="1">RMSD; 10 000 frames</td>
            <td rowspan="1" colspan="1">88 m</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">tsne.py</td>
            <td rowspan="1" colspan="1">10 000 frames</td>
            <td rowspan="1" colspan="1">68 min</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Tests were conducted on a PC running Ubuntu 16.04.2 LTS on an Intel Core i7-4790 CPU with a clock speed of 3.60 GHz with 32GB of physical memory.</p>
  </sec>
  <sec>
    <title>4 Applications</title>
    <sec>
      <title>4.1 NMA</title>
      <p>Coarse graining (level 4, start at residue 3) was performed along the C<sub>β</sub> atoms (C<sub>α</sub> for glycine) of the CAV-16 viral capsid (PDB: 5C4W; diameter ≈ 300 Å). The <italic>ANM.cpp</italic> then obtained the eigenvalues and eigenvectors of the respective modes. The cutoff distance was increased to 50 Å (default 15 Å) because of the capsid’s internal cavity. During host cell infection, the capsid expands for RNA-release (PDB: 4JGY). We used <italic>conformationMode.py, getEigenVector.cpp</italic> and <italic>visualiseVector.py</italic> to identify normal modes associated with the structural change. The mode with the largest overlap (0.86) to the conformational change is presented as a radial expansion (<xref ref-type="supplementary-material" rid="sup2">Supplementary Fig. S3</xref> and <xref ref-type="supplementary-material" rid="sup1">Movie S1</xref>). Instructions to generate similar images in VMD are given in the ANM Tutorial. A detailed analysis of the overlap across the respective asymmetric units and chains of the capsid has been included in <xref ref-type="supplementary-material" rid="sup2">Supplementary Figure S4</xref>.</p>
    </sec>
    <sec>
      <title>4.2 Essential dynamics</title>
      <p>P40L variation is disruptive to the stability of the renin-angiotensinogen system (RAS, 781 residues) (<xref rid="bty427-B151" ref-type="bibr">Brown <italic>et al.</italic>, 2017a</xref>). We explored the essential dynamics of the complex using standard PCA for the wild type versus the mutant RAS MD trajectories. PCA was performed on two separate 100 ns MD simulations, only CA atoms were selected. SVD was used for decomposition, with a linear kernel. <xref ref-type="fig" rid="bty427-F1">Figure 1</xref> depicts the shifts in the energy landscape of the protein upon mutation.
</p>
      <fig id="bty427-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>MODE-TASK visual outputs. Dimension reduction by PCA for WT (A.1) and mutant (A.2), presented per MD time point</p>
        </caption>
        <graphic xlink:href="bty427f1"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>Here, we present a novel and comprehensive downloadable software suite, MODE-TASK, which integrates a set of tools to analyse protein dynamics obtained from MD simulations as well as coarse grained elastic network models. Further, MODE-TASK is a sequel to MD-TASK (<xref rid="bty427-B152" ref-type="bibr">Brown <italic>et al.</italic>, 2017b</xref>) and can be used side by side.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>Research reported in this publication is supported by the National Research Foundation (NRF), South Africa, (grant number 93690) and the National Human Genome Research Institute (NHGRI), Office of the Director, National Institutes of Health (OD) under award number U24HG006941, and the Scientific and Technological Research Council of Turkey (grant number 116F229). The content is solely the responsibility of the authors and does not necessarily represent the official views of the funders. </p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary MovieS1</label>
      <media xlink:href="bty427_movies1.mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Material</label>
      <media xlink:href="bty427_supplementary_material.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty427-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Atilgan</surname><given-names>A.R.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Anisotropy of fluctuation dynamics of proteins with an elastic network model</article-title>. <source>Biophys. J</source>., <volume>80</volume>, <fpage>505</fpage>–<lpage>515</lpage>.<pub-id pub-id-type="pmid">11159421</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bakan</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>ProDy: protein dynamics inferred from theory and experiments</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1575</fpage>–<lpage>1577</lpage>.<pub-id pub-id-type="pmid">21471012</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B151">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>D.K.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>) 
<article-title>Structure-Based Analysis of single nucleotide variants in the Renin-Angiotensinogen complex</article-title>. <source>Glob. Heart.</source>, <volume>12</volume>, <fpage>121</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">28302554</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B152">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>D.K.</given-names></name></person-group><etal>et al</etal> (<year>2017b</year>) 
<article-title>MD-TASK: a software suite for analyzing molecular dynamics trajectories</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2768</fpage>–<lpage>2771</lpage>.<pub-id pub-id-type="pmid">28575169</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>David</surname><given-names>C.C.</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>D.J.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Principal component analysis: a method for determining the essential dynamics of proteins</article-title>. <source>Methods Mol. Biol</source>., <volume>1084</volume>, <fpage>193</fpage>–<lpage>226</lpage>.<pub-id pub-id-type="pmid">24061923</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>1994</year>) 
<article-title>A new approach for determining low-frequency normal modes in Macromolecules</article-title>. <source>Biopolymers</source>, <volume>34</volume>, <fpage>759</fpage>–<lpage>771</lpage>.</mixed-citation>
    </ref>
    <ref id="bty427-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hsieh</surname><given-names>Y.-C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Comparative normal mode analysis of the dynamics of DENV and ZIKV capsids</article-title>. <source>Front. Mol. Biosci</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">26870736</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hunter</surname><given-names>J.D.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Matplotlib: a 2D graphics environment</article-title>. <source>Comput. Sci. Eng</source>., <volume>9</volume>, <fpage>90</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="bty427-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van der Maaten</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="bty427-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McGibbon</surname><given-names>R.T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>MDTraj: a modern open library for the analysis of molecular dynamics trajectories</article-title>. <source>Biophys. J</source>., <volume>109</volume>, <fpage>1528</fpage>–<lpage>1532</lpage>.<pub-id pub-id-type="pmid">26488642</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nizami</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Molecular insight on the binding of NNRTI to K103N mutated HIV-1 RT: molecular dynamics simulations and dynamic pharmacophore analysis</article-title>. <source>Mol Biosyst</source>., <volume>12</volume>, <fpage>3385</fpage>–<lpage>3395</lpage>.<pub-id pub-id-type="pmid">27722739</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedregosa</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Scikit-learn: machine learning in python</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="bty427-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ross</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Incremental learning for robust visual tracking</article-title>. <source>Int. J. Comput. Vis</source>., <volume>77</volume>, <fpage>125</fpage>–<lpage>141</lpage>.</mixed-citation>
    </ref>
    <ref id="bty427-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ross</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Unravelling the motions behind Enterovirus 71 uncoating</article-title>. <source>Biophys. J</source>., <volume>114</volume>, <fpage>822</fpage>–<lpage>838</lpage>.<pub-id pub-id-type="pmid">29490244</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Sarmento</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Costa</surname><given-names>V.</given-names></name></person-group> (<year>2017</year>) <source>Comparative Approaches to Using R and Python for Statistical Data Analysis</source>. 
<publisher-name>IGI Global</publisher-name>, 
<publisher-loc>Hershey, PA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty427-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sittel</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Principal component analysis of molecular dynamics: on the use of Cartesian vs. internal coordinates</article-title>. <source>J. Chem. Phys</source>., <volume>141</volume>, <fpage>014111</fpage>.<pub-id pub-id-type="pmid">25005281</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tama</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>Building-block approach for determining low frequency normal modes of macromolecules</article-title>. <source>Proteins Struct. Funct. Genet</source>., <volume>41</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">10944387</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tama</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Brooks</surname><given-names>C.L.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Diversity and identity of mechanical properties of icosahedral viral capsids studied with elastic network normal mode analysis</article-title>. <source>J. Mol. Biol</source>., <volume>345</volume>, <fpage>299</fpage>–<lpage>314</lpage>.<pub-id pub-id-type="pmid">15571723</pub-id></mixed-citation>
    </ref>
    <ref id="bty427-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Vibrational dynamics of icosahedrally symmetric biomolecular assemblies compared with predictions based on continuum elasticity</article-title>. <source>Biophys. J</source>., <volume>96</volume>, <fpage>4438</fpage>–<lpage>4448</lpage>.<pub-id pub-id-type="pmid">19486668</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
