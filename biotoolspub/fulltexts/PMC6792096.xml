<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6792096</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz207</article-id>
    <article-id pub-id-type="publisher-id">btz207</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CliqueMS: a computational tool for annotating in-source metabolite ions from LC-MS untargeted metabolomics data based on a coelution similarity network</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Senan</surname>
          <given-names>Oriol</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aguilar-Mogas</surname>
          <given-names>Antoni</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Navarro</surname>
          <given-names>Miriam</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff2">2</xref>
        <xref ref-type="aff" rid="btz207-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Capellades</surname>
          <given-names>Jordi</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff2">2</xref>
        <xref ref-type="aff" rid="btz207-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noon</surname>
          <given-names>Luke</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff3">3</xref>
        <xref ref-type="aff" rid="btz207-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Burks</surname>
          <given-names>Deborah</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff3">3</xref>
        <xref ref-type="aff" rid="btz207-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-3695-7157</contrib-id>
        <name>
          <surname>Yanes</surname>
          <given-names>Oscar</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff2">2</xref>
        <xref ref-type="aff" rid="btz207-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3597-4310</contrib-id>
        <name>
          <surname>Guimerà</surname>
          <given-names>Roger</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff1">1</xref>
        <xref ref-type="aff" rid="btz207-aff5">5</xref>
        <xref ref-type="corresp" rid="btz207-cor1"/>
        <!--<email>roger.guimera@urv.cat</email>-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8140-6525</contrib-id>
        <name>
          <surname>Sales-Pardo</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="btz207-aff1">1</xref>
        <xref ref-type="corresp" rid="btz207-cor1"/>
        <!--<email>marta.sales@urv.cat</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz207-aff1"><label>1</label><institution>Department of Chemical Engineering, Universitat Rovira i Virgili</institution>, Tarragona, Spain</aff>
    <aff id="btz207-aff2"><label>2</label><institution>Department of Electronic Engineering, Metabolomics Platform, IISPV, Universitat Rovira i Virgili</institution>, Tarragona, Spain</aff>
    <aff id="btz207-aff3"><label>3</label><institution>CIBER of Diabetes and Associated Metabolic Diseases (CIBERDEM)</institution>, Madrid, Spain</aff>
    <aff id="btz207-aff4"><label>4</label><institution>Centro de Investigación Príncipe Felipe</institution>, Valencia, Spain</aff>
    <aff id="btz207-aff5"><label>5</label><institution>ICREA</institution>, Barcelona, Spain</aff>
    <author-notes>
      <corresp id="btz207-cor1">To whom correspondence should be addressed. <email>roger.guimera@urv.cat</email> or <email>marta.sales@urv.cat</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-03-23">
      <day>23</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>20</issue>
    <fpage>4089</fpage>
    <lpage>4097</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz207.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The analysis of biological samples in untargeted metabolomic studies using LC-MS yields tens of thousands of ion signals. Annotating these features is of the utmost importance for answering questions as fundamental as, e.g. how many metabolites are there in a given sample.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we introduce CliqueMS, a new algorithm for annotating in-source LC-MS1 data. CliqueMS is based on the similarity between coelution profiles and therefore, as opposed to most methods, allows for the annotation of a single spectrum. Furthermore, CliqueMS improves upon the state of the art in several dimensions: (i) it uses a more discriminatory feature similarity metric; (ii) it treats the similarities between features in a transparent way by means of a simple generative model; (iii) it uses a well-grounded maximum likelihood inference approach to group features; (iv) it uses empirical adduct frequencies to identify the parental mass and (v) it deals more flexibly with the identification of the parental mass by proposing and ranking alternative annotations. We validate our approach with simple mixtures of standards and with real complex biological samples. CliqueMS reduces the thousands of features typically obtained in complex samples to hundreds of metabolites, and it is able to correctly annotate more metabolites and adducts from a single spectrum than available tools.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cliqueMS">https://CRAN.R-project.org/package=cliqueMS</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/osenan/cliqueMS">https://github.com/osenan/cliqueMS</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Generalitat de Catalunya</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002809</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Ministry of Economy and Competitiveness of Spain</named-content>
        </funding-source>
        <award-id>FIS2013-47532-C3-1-P</award-id>
        <award-id>FIS2016-78904-C3-1-P</award-id>
        <award-id>BFU2014-57466-P</award-id>
        <award-id>BES-2012-052585</award-id>
        <award-id>SAF2011-30578</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Ministerio de Ciencia e Innovación</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004837</named-content>
        </funding-source>
        <award-id>SAF2011-28331</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Spanish Biomedical Research Centre in Diabetes and Associated Metabolic Disorders</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Instituto de Investigacion Carlos III</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The analysis of biological samples in untargeted metabolomic studies using liquid chromatography coupled to electrospray mass spectrometry results in tens of thousands of ion signals or features. It is now well accepted that this large number of features is an overestimation of the real number of different compounds in the sample, mainly because single metabolites can be detected as multiple ions of different mass in either positive or negative ionization mode. This redundancy of features is mostly due to in-source phenomena including cation adduction, multimerization and in-source fragmentation, plus contaminants. However, few studies have attempted to estimate which percentage of unique metabolites, out of the total number of detected features, are being profiled in an untargeted metabolomic experiment. These studies, in addition, have reported very disparate numbers (<xref rid="btz207-B6" ref-type="bibr">Brown <italic>et al.</italic>, 2009</xref>, <xref rid="btz207-B7" ref-type="bibr">2011</xref>; <xref rid="btz207-B17" ref-type="bibr">Jankevics <italic>et al.</italic>, 2012</xref>; <xref rid="btz207-B22" ref-type="bibr">Mahieu and Patti, 2017</xref>), ranging from as low as only 3% to more than 50% unique endogenous metabolites. This scenario reflects that the annotation of features, understood as their feature relationships in MS1 mode, is a challenging task and represents a serious obstacle for the real high-throughput analysis of metabolomics data. While computational solutions for the structural identification of metabolites from MS2 data (<xref rid="btz207-B1" ref-type="bibr">Aguilar-Mogas <italic>et al.</italic>, 2017</xref>; <xref rid="btz207-B2" ref-type="bibr">Allen <italic>et al.</italic>, 2014</xref>; <xref rid="btz207-B10" ref-type="bibr">Dührkop <italic>et al.</italic>, 2015</xref>; <xref rid="btz207-B14" ref-type="bibr">Heinonen <italic>et al.</italic>, 2012</xref>; <xref rid="btz207-B26" ref-type="bibr">Ridder <italic>et al.</italic>, 2014</xref>; <xref rid="btz207-B27" ref-type="bibr">Ruttkies <italic>et al.</italic>, 2016</xref>; <xref rid="btz207-B32" ref-type="bibr">Tsugawa <italic>et al.</italic>, 2016</xref>) have recently demonstrated substantial progress (<xref rid="btz207-B24" ref-type="bibr">Nishioka <italic>et al.</italic>, 2014</xref>; <xref rid="btz207-B30" ref-type="bibr">Schymanski <italic>et al.</italic>, 2017</xref>; <xref rid="btz207-B29" ref-type="bibr">Schymanski and Neumann, 2013</xref>), automated tools aimed at the complete exploitation of LC-MS1 data through the successful annotation of metabolite features have not reached the same maturity level.</p>
    <p>The two main grouping principles for detecting and annotating features related to a metabolite are chromatographic peak-shape similarity (i.e. coeluting features) and peak-abundance correlation, or a combination thereof. Pairwise intensity correlation analysis across multiple samples is the basis of computational tools such as AStream (<xref rid="btz207-B3" ref-type="bibr">Alonso <italic>et al.</italic>, 2011</xref>), MSClust (<xref rid="btz207-B31" ref-type="bibr">Tikunov <italic>et al.</italic>, 2012</xref>), RAMClust (<xref rid="btz207-B5" ref-type="bibr">Broeckling <italic>et al.</italic>, 2014</xref>), MS-FLO (<xref rid="btz207-B9" ref-type="bibr">DeFelice <italic>et al.</italic>, 2017</xref>), compMS2Miner (<xref rid="btz207-B11" ref-type="bibr">Edmands <italic>et al.</italic>, 2017</xref>), xMSannotator (<xref rid="btz207-B33" ref-type="bibr">Uppal <italic>et al.</italic>, 2017</xref>) or findMAIN (<xref rid="btz207-B16" ref-type="bibr">Jaeger <italic>et al.</italic>, 2017</xref>) among other similar approaches (<xref rid="btz207-B21" ref-type="bibr">Lee <italic>et al.</italic>, 2013</xref>; <xref rid="btz207-B36" ref-type="bibr">Zeng <italic>et al.</italic>, 2014</xref>). On the other hand, peak-shape similarity is used by CAMERA (<xref rid="btz207-B20" ref-type="bibr">Kuhl <italic>et al.</italic>, 2012</xref>) and MZmine2 (<xref rid="btz207-B25" ref-type="bibr">Pluskal <italic>et al.</italic>, 2010</xref>). MetAssign (<xref rid="btz207-B8" ref-type="bibr">Daly <italic>et al.</italic>, 2014</xref>) or xMSannotator (<xref rid="btz207-B33" ref-type="bibr">Uppal <italic>et al.</italic>, 2017</xref>) has also included a probabilistic score to measure the confidence in particular assignments based on statistical clustering. More recently knowledge-driven annotation tools have also been proposed by de la Fuente and collaborators (<xref rid="btz207-B12" ref-type="bibr">Gil de la Fuente <italic>et al.</italic>, 2018</xref>).</p>
    <p>To aid in the automatization of LC-MS1 data processing we have developed CliqueMS, a computational tool that annotates redundant LC-MS1 features using the similarity between coelution profiles and a calculated natural frequency of adduct formation observed in real complex biological samples and pure compounds. As a result, in contrast to the majority of existing tools, CliqueMS can produce accurate annotations for a single LC-MS1 spectrum.</p>
    <p>To do so, CliqueMS implements a novel mathematical approach to obtain the most plausible groupings of features according to a similarity network. Next, CliqueMS annotates features and ranks annotations using an estimated frequency of dominant adducts and in-source fragments in complex biological samples and from all available compounds in the National Institute of Standards and Technology 14 MS/MS library (<xref ref-type="fig" rid="btz207-F1">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). CliqueMS correctly identifies and annotates a larger number of adducts, leading to more correct parental ion neutral masses than existing available approaches such as CAMERA (<xref rid="btz207-B20" ref-type="bibr">Kuhl <italic>et al.</italic>, 2012</xref>), xMSannotator (<xref rid="btz207-B33" ref-type="bibr">Uppal <italic>et al.</italic>, 2017</xref>) and MS-FLO (<xref rid="btz207-B9" ref-type="bibr">DeFelice <italic>et al.</italic>, 2017</xref>).
</p>
    <fig id="btz207-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic representation of CliqueMS. CliqueMS identifies the features belonging to the same metabolite. CliqueMS uses as input LC-MS1 data in any format that can be converted into either an ‘<bold>xcmsSet</bold>’ or an ‘XCMSnExp’ object in R such as mzML, mzXML, mzData and NetCDF. First, CliqueMS determines peak-shape (i.e. coeluting) similarities between all pairs of features in the LC-MS1 spectrum. Then CliqueMS finds groups of features based on the network of similarities. The assumption is that the more similar a pair of features, the more likely they are to belong to the same group. Following a maximum likelihood procedure, CliqueMS finds the best division into fully connected groups of features (or cliques). Then, for each clique, CliqueMS proceeds to annotate each feature by establishing the parental ion neutral mass. Annotations are scores based on a table of empirically observed frequencies for each adduct. The final output is, for each feature, the five annotations with the highest score specifying the adducts/in-source fragment and its corresponding parental mass. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref> for a detailed description of the installation process, input and output formats as well as the parameters and modules within CliqueMS</p>
      </caption>
      <graphic xlink:href="btz207f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Description of CliqueMS</title>
      <p>Formally, CliqueMS addresses the following problem. Our spectral data are comprised of a set of features characterized by an <italic>m</italic>/<italic>z</italic> value and intensity vector <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> [note that the list of features is obtained by running the peak peaking algorithm available in XCMS (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material S2</xref>)]. For each feature <italic>i</italic>, we obtain the intensity vector discretizing the feature into <italic>K</italic> equal bins so that <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the measured intensity at retention time <italic>t<sub>k</sub></italic>, where <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (in our analysis, <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> depends on the mass detector operational parameters and the spectral data processing program). Given this data CliqueMS aims at providing a set of plausible annotations for complex samples based on the assumptions that: (i) features of the same metabolite corresponding to in-source phenomena, including adducts (e.g. Na, K) and fragments (e.g. loss of water), display similar chromatographic elution profiles and (ii) in-source phenomena (such as adducts or fragments) occur with a probability equal to the frequency with which they are observed in experiments.</p>
      <p>To achieve this goal, we have identified three main steps for annotating features (<xref ref-type="fig" rid="btz207-F1">Fig. 1</xref>): (i) the construction of a similarity network, where each node represents a feature and edges are weighted according to the similarity between features; (ii) the identification of the most plausible division of the similarity network into cliques (fully connected groups of features) and (iii) the annotation of the features corresponding to the same parental mass within each clique.</p>
      <p>
        <bold>Step 1: construction of a similarity network between features</bold>
      </p>
      <p>In order to provide meaningful annotations, first we need to group features so that features corresponding to the same metabolite are grouped together. CliqueMS is based on the expectation that all features resulting from in-source transformations of the same metabolite have a similar chromatographic retention pattern. A critical step is thus to select an appropriate measure of similarity between features that reflects our expectations and allows the construction of a similarity network to obtain reliable groups of features.</p>
      <p>A possible choice of similarity function is the Pearson correlation between intensity vectors as considered in CAMERA (<xref rid="btz207-B20" ref-type="bibr">Kuhl <italic>et al.</italic>, 2012</xref>). However, the caveat of the Pearson correlation coefficient is that it is only suited to detect similarity of features that are linearly growing/decreasing and therefore it is <italic>a priori</italic> not an optimal option when features are non-linear such as the spectral data we consider. To overcome this caveat, we propose to use the cosine similarity, a simple measure that assesses the alignment between intensity vectors:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. Note that the sum runs over all time bins, and therefore we are not restricting the comparison between features to a specific retention time window; we are considering the full window of retention times.</p>
      <p>To compare the ability of Pearson and cosine similarities to discriminate between features corresponding to the same metabolite from coeluting features corresponding to different metabolites, we performed a validation experiment in which we manually simulate the coelution of features (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). The results from this experiment show that the cosine similarity has a superior discriminatory power than the Pearson correlation, therefore justifying our choice for similarity metric.</p>
      <p>We then construct a weighted undirected similarity network <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> in which each node corresponds to a feature and the weight of each edge between nodes (<italic>i</italic>, <italic>j</italic>) corresponds to <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Note that this is not a fully connected network, because features that have non-overlapping intensity vectors are not connected (<italic>c<sub>ij</sub></italic> = 0).</p>
      <p>
        <bold>Step 2: principled identification of groups of features (cliques) in the similarity network</bold>
      </p>
      <p>Our next step is to identify groups of features that are similar. Because CliqueMS assumes that all features of the same metabolite must have <italic>c<sub>ij</sub></italic> &gt; 0, we aim at identifying cliques of features in the network, that is groups of features that are fully connected so that <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for any pair of features within a clique.</p>
      <p>Formally, the task of finding these groups is equivalent to a label assignment problem in which we want to assign a group label to each feature <italic>σ<sub>i</sub></italic> with the constraint that <italic>c<sub>ij</sub></italic> &gt; 0 for any pair of nodes with the same label. Note that this problem is different from the problem of community detection in complex networks in which nodes with the same group labels do not have to be necessarily connected (<xref rid="btz207-B13" ref-type="bibr">Guimerà and Amaral, 2005</xref>). For this reason, we cannot use community detection algorithms for this purpose. Instead, we follow a probabilistic approach to identify the most plausible label assignments (groupings) of features.</p>
      <p>To that end, we propose a generative model for node label assignments by noting that the cosine similarity between two features is a good proxy for how likely two features are to be adducts of the same metabolite. A plausible assumption is thus that the probability of two features (<italic>i</italic>, <italic>j</italic>) having the same group label (i.e. belonging to the same clique) given a certain similarity <italic>c<sub>ij</sub></italic> between intensity vectors is precisely a function of that similarity:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Conversely, the probability that two nodes (<italic>i</italic>, <italic>k</italic>) have different labels given their similarity <italic>c<sub>ik</sub></italic> is <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>To specify the precise dependency of <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> on <italic>c<sub>ij</sub></italic>, we note that <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> needs to fulfill the following conditions: (i) it has to be equal to zero if <italic>c<sub>ij</sub></italic> = 0 (i.e. two nodes whose intensity vectors do not overlap cannot belong to the same clique) and (ii) it has to be equal to one if <italic>c<sub>ij</sub></italic> = 1 (i.e. features with proportional intensity vectors, eg. similar peak shapes, have to belong to the same clique). Because in our sample <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, any power of the cosine similarity will satisfy these two conditions. Hence, we assume that
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msubsup><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></disp-formula>
where the proportionality is due to a necessary but irrelevant normalization constant and <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>Under these assumptions, we can express the probability of an assignment of group labels <inline-formula id="IE16"><mml:math id="IM16"><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:math></inline-formula> conditioned on the observed network of similarities <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> as
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo>σ</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mo>σ</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mo>σ</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mo>σ</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mo>σ</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mrow><mml:mo>σ</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Kronecker delta function. This conditional probability is the likelihood of the model.</p>
      <p>Assuming that we have no prior information about how labels are assigned to nodes, the most plausible group label assignment <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo>⋆</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is the one that maximizes <xref ref-type="disp-formula" rid="E4">Equation (4)</xref> or, equivalently, the log-likelihood <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To obtain this label assignment, we use the following algorithm:
<list list-type="roman-lower"><list-item><p>Start from a configuration in which each node has a different label.</p></list-item><list-item><p>Propose a new label assignment.</p></list-item><list-item><p>Accept the new label assignment if <inline-formula id="IE21"><mml:math id="IM21"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> increases.</p></list-item><list-item><p>Return to step (ii) and iterate until no more changes are accepted.</p></list-item></list></p>
      <p>In step (ii), in order to propose a new label assignment we use a combined strategy that alternates between: (i) merging existing cliques and (ii) moving nodes from one clique to another clique. In our implementation, we alternate these two possible configuration changes with a ratio of 10:1. To merge existing cliques, we follow the heuristic approach in <xref rid="btz207-B4" ref-type="bibr">Blondel <italic>et al.</italic> (2008)</xref> which is computationally fast. Specifically, we compute the mean-similarity between nodes within each pair of cliques. We then propose to merge the pair of cliques with the largest mean-similarity. To move a node (i.e. to change the label of that node to that of a different clique), we select the label assignment that produces the largest increase in <inline-formula id="IE22"><mml:math id="IM22"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula>. As a last step, when <inline-formula id="IE23"><mml:math id="IM23"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> cannot be increased by merging any pair of cliques in the network, we use the Kernighan–Lin algorithm (<xref rid="btz207-B18" ref-type="bibr">Kernighan and Lin, 1970</xref>) to propose single-node moves between cliques. The algorithm stops when we cannot further increase the log-likelihood with single-node switches. We set a lower bound (by default <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for the relative change in <inline-formula id="IE25"><mml:math id="IM25"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> necessary to consider that a change in node label assignments results in a significant increase in the log-likelihood.</p>
      <p>In order to estimate the best value for the parameter <italic>α</italic> in <xref ref-type="disp-formula" rid="E3">Equation (3)</xref>, we measure the accuracy of our algorithm at assigning group label to features that have similar retention time patterns.</p>
      <p>Specifically, starting from the spectral data for the mixture of 9 standards as in the validation of Step 1 (see Section 2.2 and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>), we simulated differences in the coelution of metabolites by manually displacing all the features of the same metabolite along the retention time axis. We then simulate the coelution of two, three and four compounds for different time shifts, and evaluate the accuracy of our algorithm at correctly labeling features using the adjusted mutual information (AMI) (<xref rid="btz207-B34" ref-type="bibr">Vinh <italic>et al.</italic>, 2010</xref>). The AMI measures the accuracy of the labeling by comparing the ‘true’ and the proposed assignment while taking into account the number of features associated to each metabolite. The AMI value is scaled, so that <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mtext>AMI</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for a random assignment of features to groups.</p>
      <p>In <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>, we show the accuracy of our algorithm for different values of <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> and 2. For reference, we also show the results obtained with the feature grouping algorithm in CAMERA, which is also network based [see <xref rid="btz207-B20" ref-type="bibr">Kuhl <italic>et al.</italic> (2012)</xref> for details]. We find that for any choice of <italic>α</italic>, our algorithm outperforms the feature grouping algorithm in CAMERA. This is because the feature grouping algorithm in CAMERA tends to produce a large number of groups of features and therefore the AMI is close to zero independently of the time shift. We also find that for our algorithm, larger values of <italic>α</italic> result into too many cliques when the coelution is not as accentuated, slightly decreasing the algorithm’s accuracy. Therefore, we use a value of <italic>α </italic>= 2 as a default in CliqueMS and in what follows.</p>
      <p>
        <bold>Step 3: Annotation of adducts by isotope and parental mass identification</bold>
      </p>
      <p>After obtaining the maximum likelihood configuration of label assignments to nodes <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo>⋆</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, we use the differences in <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> values for all the features within a clique to identify isotopes, and putative adducts and in-source fragments associated to the parental neutral mass of the metabolite.</p>
      <p>Consider we have a clique <italic>γ</italic> comprising Γ features <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mo>γ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>Γ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The first step is to identify features corresponding to isotopic variants of the same metabolite, as they can be determined by the exact mass difference between features and their relative intensities. Whenever the mass difference between two features corresponds to 1.003355<inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (Da), <italic>ϵ<sub>I</sub></italic> being the relative error of the isotope search, the two features are candidates for being isotopes. If their intensity ratios also correspond to the relative abundance of such isotopes, then these two features are considered to be two isotopic variants of the same metabolite Note that we take into account other differences in m/z between isotopes with z &gt; 1 (see details in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
      <p>For the remaining features <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>Γ</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <italic>N<sub>I</sub></italic> being the number of isotopes in the clique, our goal is to associate each one of the features to an adduct or fragment, and therefore to establish the mass of the corresponding neutral compound. In order to do that, CliqueMS considers a list of possible adducts and fragments <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>°</mml:mo></mml:mrow></mml:mrow><mml:mrow/></mml:msup></mml:mrow></mml:math></inline-formula> and their associated mass difference <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>°</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> taken from the NIST database (<xref rid="btz207-B23" ref-type="bibr">National Institute of Standards and Technology, 2014</xref>) spectra with positive and negative ionization (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>).</p>
      <p>First, we determine the possible annotations for each feature that are compatible with the observed mass differences. In what follows, for simplicity we refer to all possible annotations of features as adducts, but bear in mind that annotations can also correspond to metabolite in-source fragments considered in the previously mentioned list of mass differences. Specifically, for feature <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we obtain all the possible parental masses <italic>M<sub>k</sub></italic> that are compatible with feature <italic>i</italic> being adduct <italic>A<sub>k</sub></italic> (<inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>), i.e. those that fulfill 
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mtext>tol</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Note that in order to get <italic>m<sub>i</sub></italic>, we consider <italic>z<sub>i</sub></italic> to be the charge of adduct <italic>A<sub>k</sub></italic>: In our analysis, we set <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mtext>tol</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>ppm, but this parameter can be tuned by the user. For the remaining features <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>γ</mml:mo><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>, we establish that <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is compatible with being adduct <italic>A<sub>l</sub></italic> with parental neutral mass <italic>M<sub>k</sub></italic> if:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mtext>tol</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Following this procedure for all the features <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:math></inline-formula>, we obtain for clique <italic>γ</italic> all possible parental masses <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> that are compatible with at least two features being annotated. For each such parental mass <italic>M<sub>k</sub></italic>, we construct an adduct vector <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> in which each component <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> corresponds to the adduct annotation of feature <italic>i</italic> compatible with parental mass <italic>M<sub>k</sub></italic>. If there is no compatible annotation for feature <italic>i</italic> then <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">NULL</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>The second step is to assess the plausibility of each one of these annotations. In order to do this, we note two facts. First, we note that in manual annotation the observation of some adducts such as [M + H]<sup>+</sup> or [M+Na]<sup>+</sup> is more frequent than that of other adducts such as [M + H-OH]<sup>+</sup> or [2M+Na]<sup>+</sup>. As a result, the former couple of adducts are more commonly sought for in manual annotations than the latter couple of adducts. To formalize this intuition and quantify the plausibility of a specific annotation, CliqueMS uses observed frequencies of adducts and fragments from available LC-MS1 spectra for pure compounds available in the NIST database and biological in-house samples (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>). Specifically, for each <italic>M<sub>k</sub></italic> the log-plausibility <italic>s<sub>k</sub></italic> of annotation <inline-formula id="IE49"><mml:math id="IM45"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is then:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE50"><mml:math id="IM46"><mml:mrow><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the frequency of observation of adduct <italic>x</italic> and, <inline-formula id="IE51"><mml:math id="IM47"><mml:mrow><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">NULL</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula>. In our analysis, we set <inline-formula id="IE52"><mml:math id="IM48"><mml:mrow><mml:mo>ϵ</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, so that the frequency of a non-annotated feature is lower than that of the least common adduct or fragment in our database. Note that since available LC-MS1 spectra are likely to increase in the future, these parameters can be changed by the user as needed.</p>
      <p>Second, we note that, in the clique identification procedure, features corresponding to different metabolites that coelute sometimes are assigned to the same clique. Taking this into consideration, CliqueMS allows for the annotation of adducts corresponding to more than one parental neutral mass in the same clique. Therefore, given the set of parental masses <inline-formula id="IE53"><mml:math id="IM49"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and their associated annotations <inline-formula id="IE54"><mml:math id="IM50"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> we can in principle obtain complex annotations <inline-formula id="IE55"><mml:math id="IM51"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mo>φ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> with multiple compatible parental masses, so that <inline-formula id="IE56"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mo>φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mo>φ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> with <italic>M<sub>k</sub></italic> not necessarily equal to <inline-formula id="IE58"><mml:math id="IM54"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. These annotations are also subject to the constraint that we have at least two annotated features for each parental mass. Nonetheless, because we expect the number of metabolites in coelution to be low, we assume the plausibility of annotations with a large number of parental masses <italic>N<sub>M</sub></italic> to be low. To formalize this idea, the log-plausibility of such complex annotations <italic>s<sub>c</sub></italic> is then:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>ϕ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where we have introduced an exponential penalty if the number of parental masses is larger than one and <italic>a </italic>=<italic> </italic>10 in our analysis. While this may seem a rather large penalty, we note that the most common adducts have <inline-formula id="IE59"><mml:math id="IM55"><mml:mrow><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and rarest adducts have <inline-formula id="IE60"><mml:math id="IM56"><mml:mrow><mml:mo>ω</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Therefore, because our priority is to annotate large amounts of adducts or fragments (including rare ones) associated to the same parental mass rather than annotating the same features with two different parental masses and more common adducts, we need to introduce exponentially large penalties. On the other hand, the penalty has to be low enough to enable the use of more than one parental mass when no other annotations are possible. Using a value of <italic>a </italic>=<italic> </italic>10 strikes the balance between both undesirable situations.</p>
      <p>Unfortunately, the number of possible annotations grows very fast with the number of features in a clique, so that even for moderately small cliques (30 features) it is unfeasible to produce and score all annotations exhaustively. Because of this CliqueMS focuses on producing only a few annotations with the largest plausibilities. To that end, we follow a greedy procedure to produce complex annotations. Specifically, we limit the list of parental masses <inline-formula id="IE61"><mml:math id="IM57"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to include: (i) those masses that have the largest overall plausibilities <italic>s<sub>k</sub></italic> and (ii) consider the top scoring masses for annotating each feature <inline-formula id="IE62"><mml:math id="IM58"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:math></inline-formula>. In our analysis, we use <italic>M<sub>k</sub></italic>s with the 15 top overall <italic>s<sub>k</sub></italic>s and the most plausible <italic>M<sub>k</sub></italic> for each feature; these parameter choices show a good compromise between speed of the calculations for large cliques and the retrieval of the most plausible annotations obtained from exhaustive annotation searches.</p>
      <p>Finally, we rank annotations <inline-formula id="IE63"><mml:math id="IM59"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mo>φ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> according to their plausibility <inline-formula id="IE64"><mml:math id="IM60"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and produce for each clique the five most plausible annotations. In this way, unlike other methods which produce a unique annotation, CliqueMS allows researchers to compare alternative annotations. Note that annotation scores depend on the size of the clique/group of features, therefore annotation scores for different groups of features are not comparable.</p>
    </sec>
    <sec>
      <title>2.2 Spectral data acquisition</title>
      <p><bold>Mixture of standards:</bold> LC-MS1 spectrum of a mixture of the following standards in solution: (-)riboflavin, 1, 2-distearoyl-sn-glycero-3-phosphocholine, biotin, cholic acid, deoxycholic acid, L-methionine sulfoxide, thymine and uracil (see Supplementary Material for details on preparation and acquisition of LC-MS1 spectra). The mzXML file is available at Zenodo with id 1480659, doi: 10.5281/zenodo.1480659.</p>
      <p><bold>Complex sample 1:</bold> IRS2 KO—LC-MS1 spectra for retina samples from Irs-2-deficient mice [see <xref rid="btz207-B15" ref-type="bibr">Hennige <italic>et al.</italic> (2003)</xref>, <xref rid="btz207-B35" ref-type="bibr">Withers <italic>et al.</italic> (1998)</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for preparation, metabolite extraction and LC-MS1 spectra acquisition]. The mzXML file is available at Zenodo with id 1480659, doi: 10.5281/zenodo.1480659.</p>
      <p><bold>Complex sample 2:</bold> MTBLS103—LC-MS1 spectra of a subset of serum samples of young females within the control group in the study by <xref rid="btz207-B28" ref-type="bibr">Samino <italic>et al.</italic> (2015)</xref>, which are available at <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/metabolights/MTBLS103">https://www.ebi.ac.uk/metabolights/MTBLS103</ext-link>. We consider a subset of samples of both positive ionization C18 (18 samples) and HILIC (13 samples) found in MBTLS103 dataset; all samples belong to the control group.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <p>To validate the accuracy of CliqueMS we perform three kinds of experiments. First, we look at the accuracy at annotating a relatively simple sample corresponding to mixture of standards for which we have a manual MS1 annotation and the identity of the eluting standards was confirmed via MS2 fragmentation patterns. Second, we use CliqueMS to annotate a complex sample for which we also have manual MS1 annotations for metabolites confirmed via MS2 fragmentation (for the retina samples we provide the manual annotation of metabolites whose concentrations were significantly different from that of wild type animals). We look at the accuracy of CliqueMS at correctly annotating the identified compounds in the sample for LC-MS1 spectra obtained in positive and negative ionization modes separately. In these two cases, because we have a single LC-MS1 spectrum, we compare the accuracy of CliqueMS to annotate metabolites with that of CAMERA (<xref rid="btz207-B20" ref-type="bibr">Kuhl <italic>et al.</italic>, 2012</xref>), which is the only available tool that can annotate single LC-MS1 spectra. As a general result, we find that Clique MS groups feature in a smaller number of groups (cliques) than CAMERA (see <xref rid="btz207-T1" ref-type="table">Table 1</xref>); this makes CliqueMS able to annotate a larger number of adducts than CAMERA.
</p>
    <table-wrap id="btz207-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Summary of the full set of annotations for each sample</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Sample</th>
            <th align="left" rowspan="1" colspan="1">Tool</th>
            <th align="left" rowspan="1" colspan="1">Features</th>
            <th align="left" rowspan="1" colspan="1">Number of cliques/ groups/clusters</th>
            <th align="left" rowspan="1" colspan="1">Annotated unique parental masses</th>
            <th align="left" rowspan="1" colspan="1">Annotated features (%)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="2" colspan="1">Standards</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="2" colspan="1">275</td>
            <td rowspan="1" colspan="1">69</td>
            <td align="char" char="(" rowspan="1" colspan="1">49 (48)</td>
            <td align="char" char="(" rowspan="1" colspan="1">64 (55)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">164</td>
            <td align="center" rowspan="1" colspan="1">25</td>
            <td align="center" rowspan="1" colspan="1">32</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">Retina IRS2 KO(+ ionization)</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="2" colspan="1">8489</td>
            <td rowspan="1" colspan="1">606</td>
            <td align="char" char="(" rowspan="1" colspan="1">1231 (1512)</td>
            <td align="char" char="(" rowspan="1" colspan="1">70 (57)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">2836</td>
            <td align="center" rowspan="1" colspan="1">1303</td>
            <td align="center" rowspan="1" colspan="1">43</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">Retina IRS2 KO (− ionization)</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="2" colspan="1">3893</td>
            <td rowspan="1" colspan="1">349</td>
            <td align="char" char="(" rowspan="1" colspan="1">334 (494)</td>
            <td align="char" char="(" rowspan="1" colspan="1">44 (36)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">1083</td>
            <td align="center" rowspan="1" colspan="1">552</td>
            <td align="center" rowspan="1" colspan="1">32</td>
          </tr>
          <tr>
            <td rowspan="4" colspan="1">MTBLS103 HILIC</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td align="center" rowspan="1" colspan="1">16 160<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="center" rowspan="1" colspan="1">387<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="char" char="(" rowspan="1" colspan="1">3186 (3703)<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="char" char="(" rowspan="1" colspan="1">84 (68)<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="3" colspan="1">13 048</td>
            <td rowspan="1" colspan="1">488</td>
            <td align="center" rowspan="1" colspan="1">2947</td>
            <td align="center" rowspan="1" colspan="1">62</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">xMSannotator</td>
            <td rowspan="1" colspan="1">230</td>
            <td align="center" rowspan="1" colspan="1">5314</td>
            <td align="center" rowspan="1" colspan="1">46</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MS-FLO</td>
            <td rowspan="1" colspan="1">NA</td>
            <td align="center" rowspan="1" colspan="1">2875</td>
            <td align="center" rowspan="1" colspan="1">57</td>
          </tr>
          <tr>
            <td rowspan="4" colspan="1">MTBLS103 C18</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td align="center" rowspan="1" colspan="1">24 620<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="center" rowspan="1" colspan="1">927<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="char" char="(" rowspan="1" colspan="1">3980 (4769)<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
            <td align="char" char="(" rowspan="1" colspan="1">74 (61)<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="3" colspan="1">19 871</td>
            <td rowspan="1" colspan="1">1332</td>
            <td align="center" rowspan="1" colspan="1">13131</td>
            <td align="center" rowspan="1" colspan="1">58</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">xMSannotator</td>
            <td rowspan="1" colspan="1">540</td>
            <td align="center" rowspan="1" colspan="1">6226</td>
            <td align="center" rowspan="1" colspan="1">48</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MS-FLO</td>
            <td rowspan="1" colspan="1">NA</td>
            <td align="center" rowspan="1" colspan="1">3283</td>
            <td align="center" rowspan="1" colspan="1">41</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><italic>Note</italic>: For single spectrum datasets, we show the total number of features in the LC-MS1 spectrum. For MTBLS103 datasets, we report the number of features after sample alignment with XCMS. For single spectrum datasets, we report results for CliqueMS and CAMERA. For multiple spectrum datasets, we report the results for CliqueMS, CAMERA, xMSannotator and MS-FLO. We report the total number of groups identified by the algorithm, the number of unique parental neutral masses identified and the percentage of features each algorithm associated to a parental neutral mass. For single spectrum datasets, we consider the five annotations with the highest scores produces by CliqueMS and report: (i) the average number of unique parental masses over annotations, and, in parenthesis, the number of unique parental masses in the annotation with the best score; (ii) the percentage of features with at least one annotation within the five annotations with best scores, and, in parenthesis, the percentage of features annotated within the best ranked annotation.</p>
        </fn>
        <fn id="tblfn2">
          <label>a</label>
          <p>For MTBLS103 datasets, we run CliqueMS for each individual sample. For each dataset, we report the the average number of features and the average number of cliques obtained across samples. We also report: (i) the average number of unique parental neutral masses and, in parenthesis, the average number of unique parental masses in the top annotation and (ii) the average of the percentage of features with at least one annotation within the five top annotations and only considering the top annotation (in parenthesis).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Third, because other available methods need more than one spectrum to produce annotations, we also consider another two datasets with 13 and 18 LC-MS1 spectra from <xref rid="btz207-B28" ref-type="bibr">Samino <italic>et al.</italic> (2015)</xref>. We compare the performance of CliqueMS with that of CAMERA, xMSannotator (<xref rid="btz207-B33" ref-type="bibr">Uppal <italic>et al.</italic>, 2017</xref>) and MS-FLO (<xref rid="btz207-B9" ref-type="bibr">DeFelice <italic>et al.</italic>, 2017</xref>) (all other tools mentioned in the abstract were not in working condition at the time of our analysis). We find that CliqueMs is able to consistently provide better, more complete annotations than the other methods for the identified metabolites in the samples.</p>
    <p><bold>Mixture of standards:</bold><xref rid="btz207-T1" ref-type="table">Table 1</xref> and <xref ref-type="fig" rid="btz207-F2">Figure 2</xref> show that overall CliqueMS produces better annotations than CAMERA. CliqueMS is able to correctly identify more manually annotated metabolites, and correctly annotate more features associated to these metabolites by both correctly identifying adducts/in-source fragments and their isotopes. The reason for this superior performance is that CliqueMS identifies a smaller number of feature groups so that features associated to the same metabolite are in the same group (<xref ref-type="fig" rid="btz207-F2">Fig. 2a–b</xref>). By contrast, CAMERA generates a larger number of groups which results in assigning features corresponding to the same metabolite to different groups, usually annotating them as different metabolites or as non-annotated (<xref ref-type="fig" rid="btz207-F2">Fig. 2c</xref>).
</p>
    <fig id="btz207-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>Feature annotation for a mixture of standards. (<bold>a)</bold> Extracted ion chromatogram. The nine ionized metabolites were annotated with CliqueMS. We show features that are adducts of each metabolite in different colors (shades of grey), as annotated by CliqueMS in (<bold>c</bold>). (<bold>b)</bold> Cliques identified by CliqueMS in the same experiment, after computing cosine correlation and maximizing clique likelihood. The intensity of the link is proportional to the correlation, and the area of each node is proportional to feature intensity. The colors are the same as in (a). For each feature, we show the annotation given by CliqueMs as shown in (c). We denote isotopes by adding a subindex to <italic>M</italic>, so that <italic>M</italic><sub>0</sub> corresponds to the monoisotopic mass and <italic>M</italic><sub>1</sub> to the first isotope. (c<bold>)</bold> Feature annotation by CliqueMS and CAMERA. For each metabolite, we show the different adducts annotated and the total number of isotopic variants of that particular adduct. Correctly annotated features are shown in green; incorrectly annotated features are shown in red (darker shade of grey), with <inline-formula id="IE65"><mml:math id="IM61"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicating that the associated parental neutral mass was incorrect; non-annotated features are shown in white. For CliqueMS, we also show the ranking of the feature annotation that matches manual annotation. For CAMERA the * indicates those features for which the algorithm returned two possible annotations. DSPC stands for 1, 2-distearoyl-sn-glycero-3-phosphocholine. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for CliqueMS annotations</p>
      </caption>
      <graphic xlink:href="btz207f2"/>
    </fig>
    <p>Overall CliqueMS is able to correctly annotate all nine metabolites within the two most plausible annotations for each clique (since for each metabolite, CliqueMS provides the correct annotation for at least one adduct/in-source fragment and its corresponding isotopes within the two highest ranked annotations). The total number of annotated features corresponding to the standard compounds is 42 (of which 29 correspond to adducts/in-source fragments and 13 to isotopes). Instead CAMERA annotates correctly 5 metabolites and a total of 27 features. Note that even if we only considered the highest ranked annotation provided by CliqueMS, the number of correctly annotated metabolites (8) would be higher than for CAMERA (5).</p>
    <p>Note that overall CliqueMS identifies a number of unique parental neutral masses that is substantially larger than 9 (48 if we consider the best ranked annotation—see <xref rid="btz207-T1" ref-type="table">Table 1</xref>). The main reason for this is that during the process to obtain the LC-MS1 data, metabolites can break down into smaller fragments that can also become ionized. Because the fragments that one might expect are different for each metabolite in the annotation step, CliqueMS is not considering these effects in the annotation step, therefore these fragments are assigned different parental neutral masses. Despite this issue, the difference in the percentage of features for which a parental neutral mass is reported—64% (or 55% if we consider exclusively the annotation with the largest score) versus 32%—is substantial and is a direct effect of the aforementioned high quality feature grouping which leads to a more accurate adduct annotation.</p>
    <p><bold>Single spectrum from complex samples:</bold> To evaluate the capacity of CliqueMS to identify adducts in complex LC-MS1 data from a single spectrum, we analyze real retina samples from a mouse model in which the gene irs2 has been knocked out (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). We analyze spectral data with both positive and negative ionizations. The positive ionization spectrum contained 8489 features reduced to 606 cliques by CliqueMS, whereas the negative ionization spectrum comprised 3893 features reduced to 349 cliques. Instead, as for the previously studied sample, CAMERA identifies a much larger number of groups: 2836 for positive ionization spectra, and 1083 for the negative ionization spectra.</p>
    <p>CliqueMS groups the features into a smaller number of groups than CAMERA does. However, in contrast to the results for the mixture of standards, each clique is not necessarily associated to a single metabolite. In fact, because metabolite coelution is so frequent in samples with a large number of features, CliqueMS can group features corresponding to different metabolites within the same clique (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>).</p>
    <p>In <xref rid="btz207-T2" ref-type="table">Tables 2</xref> and <xref rid="btz207-T3" ref-type="table">3</xref> and in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>, we show that, overall, CliqueMS provides a better annotation than CAMERA; specifically, CliqueMS is able to annotate a larger number of the identified (via MS/MS) metabolites than CAMERA. Furthermore, CliqueMS is able to correctly annotate a larger number of features, including adducts, in-source fragments and isotopes.
</p>
    <table-wrap id="btz207-T2" orientation="portrait" position="float">
      <label>Table 2.</label>
      <caption>
        <p>Summary of the performance of different algorithms for complex samples</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="2" colspan="1">Sample</th>
            <th align="left" rowspan="2" colspan="1">Identified and annotated metabolites</th>
            <th align="left" rowspan="2" colspan="1">Tool</th>
            <th align="left" colspan="2" rowspan="1">Annotated metabolites<hr/></th>
            <th align="left" rowspan="2" colspan="1">Adducts/mass fragments</th>
            <th align="left" rowspan="2" colspan="1">Annotated features</th>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">Multiple adducts</th>
            <th align="left" rowspan="1" colspan="1">Single adduct</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="2" colspan="1">Retina IRS2 KO (+ ionization)</td>
            <td rowspan="2" colspan="1">20</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="1" colspan="1">15</td>
            <td rowspan="1" colspan="1">— </td>
            <td rowspan="1" colspan="1">50</td>
            <td rowspan="1" colspan="1">95</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">8</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">25</td>
            <td rowspan="1" colspan="1">45</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">Retina IRS2 KO (− ionization)</td>
            <td rowspan="2" colspan="1">18</td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">16</td>
            <td rowspan="1" colspan="1">35</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">14</td>
            <td rowspan="1" colspan="1">33</td>
          </tr>
          <tr>
            <td rowspan="4" colspan="1">MTBLS103 HILIC</td>
            <td rowspan="1" colspan="1">6 (78)<xref ref-type="table-fn" rid="tblfn4"><sup>a</sup></xref></td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="1" colspan="1">5/6/56<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">18/26/213<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
            <td rowspan="1" colspan="1">44/72/318<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
          </tr>
          <tr>
            <td rowspan="3" colspan="1">6</td>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">13</td>
            <td rowspan="1" colspan="1">21</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">xMSannotator</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">10</td>
            <td rowspan="1" colspan="1">10</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MS-FLO</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td rowspan="4" colspan="1"> MTBLS103 C18</td>
            <td rowspan="1" colspan="1">9 (162)<xref ref-type="table-fn" rid="tblfn4"><sup>a</sup></xref></td>
            <td rowspan="1" colspan="1">CliqueMS</td>
            <td rowspan="1" colspan="1">6/8/104<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">17/29/304<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
            <td rowspan="1" colspan="1">46/66/524<xref ref-type="table-fn" rid="tblfn5"><sup>b</sup></xref></td>
          </tr>
          <tr>
            <td rowspan="3" colspan="1">9</td>
            <td rowspan="1" colspan="1">CAMERA</td>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">11</td>
            <td rowspan="1" colspan="1">20</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">xMSannotator</td>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">13</td>
            <td rowspan="1" colspan="1">13</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MS-FLO</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1"> —</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">0</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn3">
          <p><italic>Note</italic>: For single spectrum samples (Retina IRS2 KO in positive and negative ionization mode), we report results for CAMERA and CliqueMS. For the datasets in MTBLS103 (<xref rid="btz207-B28" ref-type="bibr">Samino <italic>et al.</italic>, 2015</xref>), we report results for the chromatographic column operating in two different conditions: RP-C18 and HILIC. For the MTBLS103 datasets, we show results for CliqueMS, CAMERA, xMSAnnotator and MS-FLO. The multiple adduct and single adduct columns indicate the number of correctly annotated metabolites through the identification of at least two adducts with the same parental neutral mass, and the number of metabolites annotated through the annotation of a single adduct [annotated single adducts are assigned to (M + H)+ by xMSannotator].</p>
        </fn>
        <fn id="tblfn4">
          <label>a</label>
          <p>CliqueMS analyzes individual samples, therefore in parenthesis we show the total number of annotated metabolites in all samples.</p>
        </fn>
        <fn id="tblfn5">
          <label>b</label>
          <p>Because CliqueMS produces an individual annotation for each sample (13 for HILIC and 18 for RP-C18), we report three results <inline-formula id="IE67"><mml:math id="IM62"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>: <italic>r</italic><sub>1</sub> shows the number of unique metabolites/adducts/features that are correctly annotated in <inline-formula id="IE68"><mml:math id="IM63"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the samples; <italic>r</italic><sub>2</sub> shows the number of unique metabolites/adducts/features which are correctly annotated in at least one sample and <italic>r</italic><sub>3</sub> shows the aggregate numbers over samples.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="btz207-T3" orientation="portrait" position="float">
      <label>Table 3.</label>
      <caption>
        <p>Feature annotation for complex samples</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="2" colspan="1">Metabolite</th>
            <th colspan="3" align="center" rowspan="1">CliqueMS<hr/></th>
            <th align="center" colspan="2" rowspan="1">CAMERA<hr/></th>
          </tr>
          <tr>
            <th align="center" rowspan="1" colspan="1">Annotation</th>
            <th align="center" rowspan="1" colspan="1">Iso- topes</th>
            <th align="center" rowspan="1" colspan="1">Rank</th>
            <th align="center" rowspan="1" colspan="1">Annotation</th>
            <th align="center" rowspan="1" colspan="1">Iso- topes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="3" style="#FFCCCC" colspan="1">Uracil</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td rowspan="5" style="#FF99CC" colspan="1">Taurine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">2</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">3</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">2</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">2</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+Na)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M-H+2Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td rowspan="2" style="#FFCCFF" colspan="1">Adenine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+NH4)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td rowspan="6" style="#CC99FF" colspan="1">L-glutamic acid</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+NH4)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">— </td>
            <td rowspan="1" colspan="1">— </td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">3</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+H-H2O)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">3</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M-H+2Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">3</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+Na)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M-2H+3Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">3</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>-H+2Na)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td rowspan="3" style="#CCCCFF" colspan="1">Guanine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td rowspan="3" style="#99CCFF" colspan="1">Xanthine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">— </td>
            <td rowspan="1" colspan="1">—</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-NH3)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">—</td>
            <td rowspan="1" colspan="1">—</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">—</td>
            <td rowspan="1" colspan="1">— </td>
          </tr>
          <tr>
            <td rowspan="2" style="#CCFFFF4" colspan="1">L-2-aminoadipic acid</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">2</td>
            <td style="#CCFF99" rowspan="1" colspan="1">*(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">2</td>
            <td style="#CCFF99" rowspan="1" colspan="1">*(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td rowspan="2" style="#99FFCC" colspan="1">L-ascorbic acid</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td rowspan="3" style="#CCFFCC" colspan="1">PC</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+K)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+K-H2O)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+Na-H2O)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">— </td>
            <td rowspan="1" colspan="1">— </td>
          </tr>
          <tr>
            <td rowspan="5" style="#99CC66" colspan="1">Inosine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+K)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+K)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td rowspan="3" style="#99CC99" colspan="1">Guanosine</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(2M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td rowspan="3" style="#66CC99" colspan="1">Glutathione</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H-H2O)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td rowspan="3" style="#99CCCC" colspan="1">Oxigluthatione</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+Na)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+K)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+K)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td rowspan="3" style="#6699CC" colspan="1">NAD</td>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+Na)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+Na)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+2H)2+)</td>
            <td style="#CCFF99" rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td style="#CCFF99" rowspan="1" colspan="1">(M+H)+</td>
            <td style="#CCFF99" rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">1</td>
            <td style="#FF9999" rowspan="1" colspan="1">(2M<sub>2</sub>+H)+</td>
            <td style="#FF9999" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td colspan="6" rowspan="1"/>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn6">
          <p><italic>Note</italic>: Detail of the adducts and in-source fragments annotated by CliqueMS and CAMERA for the retina samples of IRS2 deficient mice (+ ionization). For each molecule, we show the different adducts and in-source fragments annotated; in parenthesis we show the total number of isotopic variants of that particular adduct/in-source fragment. Correctly annotated features are shown in green (light grey); incorrectly annotated features are shown in red (darker grey), with <inline-formula id="IE69"><mml:math id="IM64"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicating that the associated parental mass was incorrect; non-annotated features are shown in white. For CliqueMS, we also show the ranking of the feature annotation that matches manual annotation. For CAMERA the* indicates those features for which the algorithm returned two possible annotations (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for the complete results obtained for this sample using CliqueMS and for the complete list of manually annotated metabolites).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>The differences in number of metabolites and features annotated are specially remarkable for the positive ionization mode spectrum, in which the number of adducts is larger mainly due to the influence of mobile phase additives and organic solvents (<xref rid="btz207-B19" ref-type="bibr">Kruve and Kaupmees, 2017</xref>), and therefore more features can coelute. In this case CliqueMS is able to assign a parental neutral mass to 70% of the features overall (and 57% if we only consider the top-ranked annotation), whereas CAMERA only assigns a parental mass to 43% of the features. In the negative ionization mode, the number adducts is much smaller and therefore the differences between both algorithms are not as stark.</p>
    <p><bold>Multiple spectra from complex samples:</bold> In contrast to CAMERA, xMSannotator and MS-FLO, CliqueMS only produces annotations for each individual spectrum. Our results show that there is in fact an advantage to analyze individual spectra, since overall the performance of CliqueMS is consistently better than that of the other methods.</p>
    <p>CliqueMS is able to correctly annotate more metabolites than the other methods (see <xref rid="btz207-T2" ref-type="table">Table 2</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). The only exception is xMSannotator, which annotates correctly more metabolites for the C18 dataset because it annotates single features as (M + H)+ by default without having another adduct for the same parental neutral mass (<xref rid="btz207-B9" ref-type="bibr">DeFelice <italic>et al.</italic>, 2017</xref>). Remarkably, CliqueMS is consistently able to correctly annotate substantially more adducts and identify more isotopic variants than the other methods. As an illustration (see <xref rid="btz207-T2" ref-type="table">Table 2</xref>), CliqueMS correctly annotates 17 adducts in the majority of samples of the HILIC dataset (29 if we consider all correct unique annotations across samples), whereas CAMERA, xMSAnnotator and MS-FLO identify 13, 10 and 2 different adducts/in-source fragments, respectively.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>Annotating features in LC-MS1 metabolomic experiments is of the utmost importance. Without reliable annotation, however, questions as fundamental as, e.g. how many metabolites are there in a given sample or what is the best adduct for MS/MS experiments cannot be properly addressed. Here, we have shown that CliqueMS provides high quality annotations for biological samples from LC-MS1 single spectra. With simple and synthetic datasets we have provided evidence that explains the performance of CliqueMS: (i) it uses a highly discriminatory feature similarity metric; (ii) it treats the similarities between peaks in a transparent way by means of a simple generative model; (iii) it uses a well-grounded maximum likelihood inference approach to group features; (iv) it uses empirical adduct frequencies to identify the parental neutral mass and (v) it deals flexibly with the identification of the parental neutral mass by proposing and ranking alternative annotations. With real complex biological samples, we have demonstrated that annotating single spectra produces correct annotations for a larger number of features and metabolites than currently available tools for annotating both single and aligned spectra.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>We acknowledge the support of Generalitat de Catalunya [program FI-DGR 2014 to O.S.]; the Ministry of Economy and Competitiveness of Spain [grant numbers FIS2013-47532-C3-1-P, FIS2016-78904-C3-1-P to R.G. and M.S.-P., BFU2014-57466-P to O.Y. and BES-2012-052585 (SAF2011-30578) to M.N.]; and the Ministerio de Ciencia e Innovación [grant SAF2011-28331 to D.B. and L.N.]. O.Y., D.B. and L.N. also acknowledge the support of the Spanish Biomedical Research Centre in Diabetes and Associated Metabolic Disorders (CIBERDEM), an initiative of Instituto de Investigacion Carlos III (ISCIII).</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz207_Supplementary_Data</label>
      <media xlink:href="btz207_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="btz207-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aguilar-Mogas</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>iMet: a Network-Based Computational Tool To Assist in the Annotation of Metabolites from Tandem Mass Spectra</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>3474</fpage>–<lpage>3482</lpage>.<pub-id pub-id-type="pmid">28221024</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allen</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>CFM-ID: a web server for annotation, spectrum prediction and metabolite identification from tandem mass spectra</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>W94</fpage>–<lpage>W99</lpage>.<pub-id pub-id-type="pmid">24895432</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alonso</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>AStream: an R package for annotating LC/MS metabolomic data</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1339</fpage>–<lpage>1340</lpage>.<pub-id pub-id-type="pmid">21414990</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blondel</surname><given-names>V.D.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech. Theor. Exp</source>., <volume>2008</volume>, <fpage>P10008.</fpage></mixed-citation>
    </ref>
    <ref id="btz207-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Broeckling</surname><given-names>C.D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>RAMClust: a Novel Feature Clustering Method Enables Spectral-Matching-Based Annotation for Metabolomics Data</article-title>. <source>Anal. Chem</source>., <volume>86</volume>, <fpage>6812</fpage>–<lpage>6817</lpage>.<pub-id pub-id-type="pmid">24927477</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Mass spectrometry tools and metabolite-specific databases for molecular identification in metabolomics</article-title>. <source>Analyst</source>, <volume>134</volume>, <fpage>1322.</fpage><pub-id pub-id-type="pmid">19562197</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Automated workflows for accurate mass-based putative metabolite identification in LC/MS-derived metabolomic datasets</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1108.</fpage><pub-id pub-id-type="pmid">21325300</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Daly</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>MetAssign: probabilistic annotation of metabolites from LC-MS data using a Bayesian clustering approach</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2764</fpage>–<lpage>2771</lpage>.<pub-id pub-id-type="pmid">24916385</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DeFelice</surname><given-names>B.C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Mass Spectral Feature List Optimizer (MS-FLO): a tool to minimize false positive peak reports in untargeted liquid chromatography-mass spectroscopy (LC-MS) data processing</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>3250</fpage>–<lpage>3255</lpage>.<pub-id pub-id-type="pmid">28225594</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dührkop</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Searching molecular structure databases with tandem mass spectra using CSI: FingerID</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>112</volume>, <fpage>12580</fpage>–<lpage>12585</lpage>.<pub-id pub-id-type="pmid">26392543</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edmands</surname><given-names>W.M.B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>compMS2Miner: an Automatable Metabolite Identification, Visualization, and Data-Sharing R Package for High-Resolution LC-MS Data Sets</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>3919</fpage>–<lpage>3928</lpage>.<pub-id pub-id-type="pmid">28225587</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gil de la Fuente</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Knowledge-based metabolite annotation tool: CEU Mass Mediator</article-title>. <source>J. Pharm. Biomed. Anal</source>., <volume>154</volume>, <fpage>138</fpage>–<lpage>149</lpage>.<pub-id pub-id-type="pmid">29547800</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guimerà</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Amaral</surname><given-names>L.A.N.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Functional cartography of complex metabolic networks</article-title>. <source>Nature</source>, <volume>433</volume>, <fpage>895</fpage>–<lpage>900</lpage>.<pub-id pub-id-type="pmid">15729348</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heinonen</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Metabolite identification and molecular fingerprint prediction through machine learning</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2333</fpage>–<lpage>2341</lpage>.<pub-id pub-id-type="pmid">22815355</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hennige</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Upregulation of insulin receptor substrate-2 in pancreatic beta cells prevents diabetes</article-title>. <source>J. Clin. Invest</source>., <volume>112</volume>, <fpage>1521</fpage>–<lpage>1532</lpage>.<pub-id pub-id-type="pmid">14617753</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaeger</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Compound annotation in liquid chromatography/high-resolution mass spectrometry based metabolomics: robust adduct ion determination as a prerequisite to structure prediction in electrospray ionization mass spectra</article-title>. <source>Rapid. Commun. Mass Spectrom</source>., <volume>31</volume>, <fpage>1261</fpage>–<lpage>1266</lpage>.<pub-id pub-id-type="pmid">28499062</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jankevics</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Separating the wheat from the chaff: a prioritisation pipeline for the analysis of metabolomics datasets</article-title>. <source>Metabolomics</source>, <volume>8</volume>, <fpage>29</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">22593722</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kernighan</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>S.</given-names></name></person-group> (<year>1970</year>) 
<article-title>An efficient heuristic procedure for partitioning graphs</article-title>. <source>At&amp;T Tech. J</source>., <volume>49</volume>, <fpage>291</fpage>–<lpage>307</lpage>.</mixed-citation>
    </ref>
    <ref id="btz207-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kruve</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Kaupmees</surname><given-names>K.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Adduct formation in ESI/MS by mobile phase additives</article-title>. <source>J. Am. Soc. Mass Spectrom</source>., <volume>28</volume>, <fpage>887</fpage>–<lpage>894</lpage>.<pub-id pub-id-type="pmid">28299714</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuhl</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>. <source>Anal. Chem</source>., <volume>84</volume>, <fpage>283</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">22111785</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>T.S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Precursor mass prediction by clustering ionization products in LC-MS-based metabolomics</article-title>. <source>Metabolomics</source>, <volume>9</volume>, <fpage>1301</fpage>–<lpage>1310</lpage>.</mixed-citation>
    </ref>
    <ref id="btz207-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mahieu</surname><given-names>N.G.</given-names></name>, <name name-style="western"><surname>Patti</surname><given-names>G.J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Systems-Level Annotation of a Metabolomics Data Set Reduces 25000 Features to Fewer than 1000 Unique Metabolites</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>10397</fpage>–<lpage>10406</lpage>.<pub-id pub-id-type="pmid">28914531</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B23">
      <mixed-citation publication-type="book">National Institute of Standards and Technology (<year>2014</year>) <source>NIST/EPA/NIH Mass Spectral Library v2014.</source><publisher-name>US Secretary of Commerce</publisher-name>, 
<publisher-loc>Gaithersburg, MD, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz207-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nishioka</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Winners of CASMI2013: automated Tools and Challenge Data</article-title>. <source>Mass Spectrom</source>., <volume>3</volume>, <fpage>S0039.</fpage></mixed-citation>
    </ref>
    <ref id="btz207-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pluskal</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>395.</fpage><pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ridder</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>In silico prediction and automatic LC-MS<italic>n</italic> annotation of green tea metabolites in urine</article-title>. <source>Anal. Chem</source>., <volume>86</volume>, <fpage>4767</fpage>–<lpage>4774</lpage>.<pub-id pub-id-type="pmid">24779709</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ruttkies</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>MetFrag relaunched: incorporating strategies beyond in silico fragmentation</article-title>. <source>J. Cheminform</source>., <volume>8</volume>, <fpage>3.</fpage><pub-id pub-id-type="pmid">26834843</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Samino</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Metabolomics reveals impaired maturation of HDL particles in adolescents with hyperinsulinaemic androgen excess</article-title>. <source>Sci. Rep</source>., <volume>5</volume>, <fpage>11496</fpage>.<pub-id pub-id-type="pmid">26099471</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schymanski</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Neumann</surname><given-names>S.</given-names></name></person-group> (<year>2013</year>) 
<article-title>The Critical Assessment of Small Molecule Identification (CASMI): challenges and Solutions</article-title>. <source>Metabolites</source>, <volume>3</volume>, <fpage>517</fpage>–<lpage>538</lpage>.<pub-id pub-id-type="pmid">24958137</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schymanski</surname><given-names>E.L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Critical Assessment of Small Molecule Identification 2016: automated methods</article-title>. <source>J. Cheminformatics</source>, <volume>9</volume>, <fpage>22.</fpage></mixed-citation>
    </ref>
    <ref id="btz207-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tikunov</surname><given-names>Y.M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>MSClust: a tool for unsupervised mass spectra extraction of chromatography-mass spectrometry ion-wise aligned data</article-title>. <source>Metabolomics</source>, <volume>8</volume>, <fpage>714</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">22833709</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tsugawa</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Hydrogen rearrangement rules: computational MS/MS fragmentation and structure elucidation using MS-FINDER software</article-title>. <source>Anal. Chem</source>., <volume>88</volume>, <fpage>7946</fpage>–<lpage>7958</lpage>.<pub-id pub-id-type="pmid">27419259</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Uppal</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>xMSannotator: an R package for network-based annotation of high-resolution metabolomics data</article-title>. <source>Anal. Chem</source>., <volume>89</volume>, <fpage>1063</fpage>–<lpage>1067</lpage>.<pub-id pub-id-type="pmid">27977166</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vinh</surname><given-names>N.X.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Information theoretic measures for clusterings comparison: variants, properties, normalization and correction for chance</article-title>. <source>J. Mach. Learn. Res</source>., <volume>11</volume>, <fpage>2837</fpage>–<lpage>2854</lpage>.</mixed-citation>
    </ref>
    <ref id="btz207-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Withers</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Disruption of IRS-2 causes type 2 diabetes in mice</article-title>. <source>Nature</source>, <volume>391</volume>, <fpage>900</fpage>–<lpage>904</lpage>.<pub-id pub-id-type="pmid">9495343</pub-id></mixed-citation>
    </ref>
    <ref id="btz207-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zeng</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Ion fusion of high-resolution LC-MS-based metabolomics data to discover more reliable biomarkers</article-title>. <source>Anal. Chem</source>., <volume>86</volume>, <fpage>3793</fpage>–<lpage>3800</lpage>.<pub-id pub-id-type="pmid">24611595</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
