<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7218625</article-id>
    <article-id pub-id-type="publisher-id">3533</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-3533-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TAMA: improved metagenomic sequence classification through meta-analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sim</surname>
          <given-names>Mikang</given-names>
        </name>
        <address>
          <email>mg9022@konkuk.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jongin</given-names>
        </name>
        <address>
          <email>jongin33@konkuk.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Daehwan</given-names>
        </name>
        <address>
          <email>cjfcl@konkuk.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kwon</surname>
          <given-names>Daehong</given-names>
        </name>
        <address>
          <email>kwanyi01@konkuk.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2287-9760</contrib-id>
        <name>
          <surname>Kim</surname>
          <given-names>Jaebum</given-names>
        </name>
        <address>
          <email>jbkim@konkuk.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.258676.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0532 8339</institution-id><institution>Department of Biomedical Science and Engineering, </institution><institution>Konkuk University, </institution></institution-wrap>Seoul, 05029 Republic of Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>185</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Microorganisms are important occupants of many different environments. Identifying the composition of microbes and estimating their abundance promote understanding of interactions of microbes in environmental samples. To understand their environments more deeply, the composition of microorganisms in environmental samples has been studied using metagenomes, which are the collections of genomes of the microorganisms. Although many tools have been developed for taxonomy analysis based on different algorithms, variability of analysis outputs of existing tools from the same input metagenome datasets is the main obstacle for many researchers in this field.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present a novel meta-analysis tool for metagenome taxonomy analysis, called TAMA, by intelligently integrating outputs from three different taxonomy analysis tools. Using an integrated reference database, TAMA performs taxonomy assignment for input metagenome reads based on a meta-score by integrating scores of taxonomy assignment from different taxonomy classification tools. TAMA outperformed existing tools when evaluated using various benchmark datasets. It was also successfully applied to obtain relative species abundance profiles and difference in composition of microorganisms in two types of cheese metagenome and human gut metagenome.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">TAMA can be easily installed and used for metagenome read classification and the prediction of relative species abundance from multiple numbers and types of metagenome read samples. TAMA can be used to more accurately uncover the composition of microorganisms in metagenome samples collected from various environments, especially when the use of a single taxonomy analysis tool is unreliable. TAMA is an open source tool, and can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://github.com/jkimlab/TAMA">https://github.com/jkimlab/TAMA</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenome</kwd>
      <kwd>Taxonomy analysis</kwd>
      <kwd>Meta-analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002641</institution-id>
            <institution>Konkuk University</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par6">Microbes are essential occupants in an ecological system that interact with and affect their environment. In the sea, these microbes help recycle nutrients [<xref ref-type="bibr" rid="CR1">1</xref>]. In an alpine ecosystem, they compete for nitrogen with plants [<xref ref-type="bibr" rid="CR2">2</xref>]. They also live in animal organs. They are thought to be the cause of many diseases [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. They can affect the environment in various areas, such as animal development and biofuel production [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Although it is crucial to identify the ecosystem of the microorganism in its environment, it is still hard to decipher the composition and functions of microbes in an environment because most bacteria on Earth cannot be cultivated [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par7">Recently, the next-generation sequencing (NGS) technology has enabled studies of metagenomes [<xref ref-type="bibr" rid="CR9">9</xref>], which are the sets of whole genetic materials of microorganisms in an environmental sample. Whole-genome sequence-level analysis of metagenomes is useful to research microbes in an environmental sample, including unculturable microbes. Taxonomy analysis using metagenomic reads has been used to identify the composition and abundance of the microorganisms in an environmental sample. Several methods have been developed for this purpose, including the k-mer-based approach and the read mapping-based approach. In k-mer-based taxonomy analysis tools, such as CLARK [<xref ref-type="bibr" rid="CR10">10</xref>] and Kraken [<xref ref-type="bibr" rid="CR11">11</xref>], all k-mers, which are possible substrings with length k in sequences, are extracted from both reference sequences and metagenome reads. Metagenome reads are then classified to reference sequences with the most similar k-mer composition. Read mapping-based taxonomy classification tools such as Centrifuge [<xref ref-type="bibr" rid="CR12">12</xref>] assign metagenome reads to one or more taxons with the best mapping score against a compressed reference database.</p>
    <p id="Par8">Although there are many taxonomy classification tools, their results and performance are quite different, even with the same input metagenome read datasets [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Therefore, it is difficult to know which taxonomy classification tool is the best for a given metagenome data [<xref ref-type="bibr" rid="CR15">15</xref>]. In order to overcome such problem, meta-analysis approaches have recently been utilized to metagenome analysis [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. The concept of meta-analysis was originally used in the clinical field for systematic and integrated studies of multiple findings from different sources [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. In the metagenome analysis, the meta-analysis approach can be effectively used to remove both false positive and false negative analysis results, which can lead to the better understanding of the microbial community in environment. However, the application of the meta-analysis approaches to the metagenome analysis still lags behind.</p>
    <p id="Par9">Here, we present a novel taxonomy classification tool for metagenome NGS reads, called TAMA. TAMA performs the meta-analysis by integrating read assignment obtained from taxon ID classification with CLARK, Kraken, and Centrifuge using integrated reference database. A read classification profile is then generated by reassigning taxon ID(s) to each read based on the meta-analysis. Relative species abundance profile is next created using the read classification profile based on estimated genome size. TAMA outperformed existing taxonomy analysis tools in evaluation using simulated metagenome read datasets and the Critical Assessment of Metagenome Interpretation (CAMI) metagenome read datasets [<xref ref-type="bibr" rid="CR23">23</xref>]. Relative species abundance profiles for real metagenome samples from two different cheese and human gut were then obtained, and differences in composition and abundance were identified using TAMA. TAMA will contribute to more accurately uncovering of the composition of microorganisms in metagenome samples collected from various environments, especially when the use of a single taxonomy analysis tool is unreliable. TAMA can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://github.com/jkimlab/TAMA">https://github.com/jkimlab/TAMA</ext-link> together with an integrated reference database.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview of TAMA</title>
      <p id="Par10">TAMA is a meta-analysis tool for metagenome taxonomy analysis. Given multiple sets of metagenome reads, TAMA can perform taxonomy analysis by integrating analysis results from existing taxonomy analysis tools at user-specified target taxonomic rank (phylum, class, order, family, genus, or species). TAMA consists of three steps: read preprocessing, taxonomy analysis, and meta-analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the read preprocessing step, quality control of read sequences is performed. In the taxonomy analysis step, taxon IDs are assigned to reads using three taxonomy analysis tools, CLARK [<xref ref-type="bibr" rid="CR10">10</xref>], Kraken [<xref ref-type="bibr" rid="CR11">11</xref>], and Centrifuge [<xref ref-type="bibr" rid="CR12">12</xref>], based on an integrated database of bacterial genome sequences. These three tools were selected because their performance was good based on literature survey, and it was easy to use them and easy to customize their database. In the meta-analysis step, results from the three tools are calibrated and integrated to reassign a final taxon ID for each read, and a relative species abundance profile is produced. The details of each step are described in the following subsections.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of TAMA. In the read preprocessing step, low-quality input metagenome reads (single- or paired-end) are eliminated. Integrated database with identical set of reference genomes is also created. Initial taxonomy classification results, which has assigned taxon IDs for each read sequence, are generated by using CLARK, Kraken, and Centrifuge with the integrated database. In the meta-analysis process, results from the three tools are calibrated and integrated to produce a read classification and relative species abundance profile. The relative species abundance profile is generated only when the target taxonomic rank is species</p></caption><graphic xlink:href="12859_2020_3533_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Read preprocessing step</title>
      <p id="Par11">Trimmomatic (v0.36) [<xref ref-type="bibr" rid="CR24">24</xref>] and BayesHammer [<xref ref-type="bibr" rid="CR25">25</xref>] are used in this step to perform metagenome read quality control. Trimmomatic removes or trims low-quality reads, while BayesHammer corrects sequencing errors. TAMA supports both single- and paired-end reads.</p>
    </sec>
    <sec id="Sec5">
      <title>Taxonomy analysis step</title>
      <p id="Par12">Three taxonomy analysis tools (CLARK, Kraken, and Centrifuge) are used in each high-quality metagenome read to assign a single or multiple taxon ID(s) (per read in the case of a single-end read, and per read pair in the case of a paired-end read). Because each of the three tools needs to use a different type of database of bacterial genome sequences, a database is generated for each taxonomy analysis tool separately (collectively called the TAMA database) using the same set of bacterial reference genome sequences (total 111,029) downloaded from the NCBI RefSeq website (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/refseq/">https://www.ncbi.nlm.nih.gov/refseq/</ext-link>) in Nov. 2017. Supplementary Table S<xref rid="MOESM1" ref-type="media">1</xref> shows detailed information of reference sequences. The above three taxonomy analysis tools were executed with their default parameter values in this study.</p>
    </sec>
    <sec id="Sec6">
      <title>Meta-analysis step</title>
      <p id="Par13">The meta-analysis step integrates and reassigns all classified results from the three taxonomy analysis tools, followed by the creation of a read classification profile and a relative species abundance profile. The meta-analysis step has five sub-steps: taxonomic rank adjustment, score normalization, meta-score calculation, taxon ID determination, and relative species abundance estimation.</p>
      <p id="Par14">First, in the taxonomic rank adjustment step, initially assigned taxon IDs of a read from each taxonomy analysis tool are adjusted up to a user-provided target taxonomic rank based on taxonomic hierarchy information obtained from the NCBI taxonomy database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/taxonomy">https://www.ncbi.nlm.nih.gov/taxonomy</ext-link>). Because Kraken and Centrifuge automatically assign the best possible taxon IDs out of the six taxonomic ranks to a read instead of following a given target taxonomic rank, this step is applied only to the results of Kraken and Centrifuge. In the case of CLARK, this step is not used because it takes the target taxonomic rank as input, and generates results based on the target taxonomic rank. This taxonomic rank adjustment is possible only when the taxonomic rank of the initially assigned taxon ID is lower than the target taxonomic rank. Otherwise, because a specific taxon ID at a lower taxonomic rank cannot be determined, the initially assigned taxon ID is ignored and the corresponding read is labeled as unclassified. If a read does not have any assigned taxon ID in the previous taxonomy analysis step, it is also labeled as unclassified.</p>
      <p id="Par15">Because the scale of assignment confidence scores from these three tools is different, all taxon assignment scores for adjusted taxon IDs in a read are normalized with eq. (<xref rid="Equ1" ref-type="">1</xref>) in the score normalization step:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {S}_{r,i,t}={s}_{r,i.t}\ast \frac{N_{r,i,t}}{N_{r,i}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>S</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub> is the normalized taxon assignment score of an adjusted taxon <italic>t</italic> to a read <italic>r</italic> from the taxonomy analysis tool i ∈ {CLARK, Kraken, Centrifuge}, <italic>s</italic><sub><italic>r</italic>, <italic>i</italic>. <italic>t</italic></sub> is a min-max normalized score over the range [0,1] of the original assignment score of the adjusted taxon <italic>t</italic> obtained from the tool <italic>i</italic>, <italic>N</italic><sub><italic>r</italic>, <italic>i</italic></sub> is the total number of assigned taxon IDs to the read <italic>r</italic> obtained from the tool <italic>i</italic>, and <italic>N</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub> is the number of adjusted taxon ID <italic>t</italic> assigned to the read <italic>r</italic> obtained from the tool <italic>i</italic>. CLARK and Kraken always produce a single taxon ID for one read. Therefore, <italic>N</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub> and <italic>N</italic><sub><italic>r</italic>, <italic>i</italic></sub> are always 1. However, if their assignment scores are equally the best, Centrifuge can assign multiple taxon IDs to a single read. Therefore, originally assigned different taxon IDs can be adjusted to the same taxon at higher taxonomic rank, leading to multiple existence of the same taxon ID assigned to a single read (<italic>N</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub> &gt; 1). In this case, the last term <italic>N</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub>/<italic>N</italic><sub><italic>r</italic>, <italic>i</italic></sub> in equation (<xref rid="Equ1" ref-type="">1</xref>) contributes to distributing <italic>s</italic><sub><italic>r</italic>, <italic>i</italic>. <italic>t</italic></sub> to each differently adjusted taxon ID proportional to its fraction against <italic>N</italic><sub><italic>r</italic>, <italic>i</italic></sub>. This strategy is used to prevent overestimation of an assigned taxon resulting from (i) duplicate assignment of the same taxon to a single read or (ii) the nature of the final meta-score, which is the sum of taxon assignment scores from the three tools that will be described in the following subsection. For all “unclassified” reads in the previous taxonomy analysis step, <italic>S</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub> is set to 0.</p>
      <p id="Par16">Normalized scores (<italic>S</italic><sub><italic>r</italic>, <italic>i</italic>, <italic>t</italic></sub>) from the three tools are integrated to calculate the meta-score <italic>M</italic><sub><italic>r</italic>, <italic>t</italic></sub> shown in equation (<xref rid="Equ2" ref-type="">2</xref>) in the meta-score calculation step:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}_{r,t}=\frac{1}{F}\sum \limits_i\left({S}_{r,i,t}\ast {F}_i\right) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>F</italic><sub><italic>i</italic></sub> is the weight of a tool <italic>i</italic> representing the relative performance of the three tools, and <italic>F</italic> is the sum of all <italic>F</italic><sub><italic>i</italic></sub> s. Default values of <italic>F</italic><sub><italic>i</italic></sub> are set to 1 for all tools, but user can change those values. In the taxon ID determination step, taxon IDs with the highest <italic>M</italic><sub><italic>r</italic>, <italic>t</italic></sub> are reassigned, resulting in the generation of the read classification profile for each read.</p>
      <p id="Par17">Finally, when the target taxonomic rank is species, a relative species abundance profile is estimated by using the read classification profile. Before calculating the relative species abundance, additional filtering is performed by using the meta-score. For all assigned species, the average meta-score is computed and the species with an average meta-score less than 0.34 is ignored in abundance estimation. The default cutoff score of 0.34 was empirically estimated using simulated metagenome datasets, and can be changed by user. The estimated relative species abundance <italic>EA</italic><sub><italic>s</italic></sub> is calculated with equation (<xref rid="Equ3" ref-type="">3</xref>):
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {EA}_s=\left({RC}_s/{GS}_s\right)/\sum \limits_i\left({RC}_i/{GS}_i\right) $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi mathvariant="italic">EA</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="italic">RC</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="italic">GS</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="italic">RC</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="italic">GS</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where RC<sub><italic>s</italic></sub> and GS<sub><italic>s</italic></sub> represent the number of assigned reads to a species <italic>s</italic> and the average genome size of the species, respectively; while <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sum}_i\left({\mathrm{RC}}_i/{\mathrm{GS}}_i\right) $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>RC</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>GS</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3533_Article_IEq1.gif"/></alternatives></inline-formula> represents the sum of the number of reads over the genome size of all species with classified reads. Therefore, <italic>EA</italic><sub><italic>s</italic></sub> represents only the relative proportion among all species with classified reads. The average genome size of each species is calculated using all sub-strain and sub-species genomes in known reference genome sequences. This is because there can be many genome sequences with different genome sizes for the same species. For each reference genome, its genome size was calculated using both chromosome and plasmid sequences.</p>
    </sec>
    <sec id="Sec7">
      <title>Simulated metagenome read generation for performance evaluation</title>
      <p id="Par18">Metagenome read datasets were simulated to have two types of reads: (i) generated from bacterial genome sequences which were treated as true positive reads, and (ii) random reads simulated by using fabricated sequences from non-bacterial genome sequences which were treated as true negative reads. Specifically, metagenome profiles were first generated using different numbers of genomes (10, 50, and 100) to simulate bacterial read sequences of metagenome read datasets. For each dataset with a total of <italic>N</italic> genomes, Poisson distribution was utilized with different parameter values to create a diverse abundance of <italic>N</italic> genomes. For 10 genomes dataset, six different parameter values (0.1, 0.5, 1.25, 2.5, 3.75, and 5) were used to generate the abundance profile. For 50 and 100 genomes datasets, seven different parameter values of (0.1, 0.5, 2.5, 6.25, 12.5, 18.75, and 25) and (0.1, 0.5, 5, 12.5, 25, 37.5, and 50) were used, respectively (Supplementary Tables S<xref rid="MOESM1" ref-type="media">2</xref>–S<xref rid="MOESM1" ref-type="media">4</xref>). By randomly assigning species selected from the NCBI RefSeq bacterial genome sequences (a total of 2788 genomes downloaded in Dec. 2016) without replacement to those 20 abundance profiles five times, 100 different profiles of species abundance were generated.</p>
      <p id="Par19">Once species abundance profiles were created, read sequences were generated using the read simulation program ART [<xref ref-type="bibr" rid="CR26">26</xref>] based on the Illumina HiSeq 2500 sequencing platform with 101 bp read length and 500 bp insert size. In this read simulation, the number of simulated reads of each chosen species was calculated considering its assigned abundance and genome size as defined in equation (<xref rid="Equ4" ref-type="">4</xref>):
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {R}_s=\frac{\left({A}_s\ast {G}_s\right)\ast T}{\sum \limits_k\left({A}_k\ast {G}_k\right)} $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>∗</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>R</italic><sub><italic>s</italic></sub>, <italic>A</italic><sub><italic>s</italic></sub>, <italic>G</italic><sub><italic>s</italic></sub>, and <italic>T</italic> are the number of reads, the abundance, the genome size of species <italic>s</italic>, and the total number of reads (6,000,000 in this study), respectively.</p>
      <p id="Par20">Random reads were downloaded from a recent benchmarking study for metagenome analysis tools [<xref ref-type="bibr" rid="CR15">15</xref>]. From whole random read sequences, 100 different sets of 600,000 read sequences were randomly extracted and added into the simulated metagenome read datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluation of read classification performance</title>
      <p id="Par21">For each of the simulated metagenome read dataset, the assignment accuracy was measured using the recall, precision, and F1-score measures. To calculate recall and precision scores, numbers of true positive (TP), true negative (TN), false positive (FP), and false negative (FN) were counted from a read dataset as follows. When the taxon ID was correctly assigned for the simulated read, then the taxon ID was counted as TP, otherwise as FN. Also, when the taxon ID was precisely unassigned for the random read, then the taxon ID was counted as TN, otherwise as FP. In the case of Centrifuge, multiple taxon IDs can be assigned to a single read. Therefore, if a simulated read was assigned to several different taxon IDs and only some of them were right, proportions of right and wrong assignment were used as TP and FN, respectively. These four numbers were then used to calculate recall (TP/(TP + FN)) and precision (TP/(TP + FP)) scores, which were then used to calculate the F1-score with equation (<xref rid="Equ5" ref-type="">5</xref>):
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{F}1-\mathrm{score}=2\ast \frac{\mathrm{recall}\ast \mathrm{precision}}{\mathrm{recall}+\mathrm{precision}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi mathvariant="normal">F</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mfrac><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>∗</mml:mo><mml:mtext>precision</mml:mtext></mml:mrow><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>+</mml:mo><mml:mtext>precision</mml:mtext></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec9">
      <title>Evaluation of species prediction and abundance estimation</title>
      <p id="Par22">To assess the performance of species prediction, we compared the list of species in between the read simulation profile and the estimated relative species abundance profile for each simulated dataset. We measured the performance with recall, precision, and F1-score. In the predicted abundance profile from Centrifuge, some species were included in the profile with zero abundance (or ratio). We considered them as nonexistent species and ignored them for the comparison.</p>
      <p id="Par23">To evaluate the estimated relative species abundance, we calculated the sum of relative abundance difference compared to the true relative abundance profile. The sum of the relative abundance difference was calculated with equation (6):
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{SDra}=\sum {O}_x+\sum {T}_y+\sum {P}_z. $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtext>SDra</mml:mtext><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12859_2020_3533_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par24">where <italic>O</italic><sub><italic>x</italic></sub>, <italic>T</italic><sub><italic>y</italic></sub>, and <italic>P</italic><sub><italic>z</italic></sub> are relative abundance difference of species <italic>x</italic> which exists in both true relative abundance profile and the predicted abundance profile, the relative abundance of species <italic>y</italic> is only observed in the true relative abundance profile, and the relative abundance of species <italic>z</italic> is only present in the predicted abundance profile, respectively. When the set of predicted species and their relative abundance completely agree with the true answer, the SDra score becomes the minimum (the best) score of 0. When there is no overlap between species in the predicted and true relative abundance profile, it becomes the maximum (the worst) score of 2.</p>
    </sec>
    <sec id="Sec10">
      <title>Real metagenome read datasets</title>
      <p id="Par25">Real metagenome read datasets were downloaded from the EBI metagenome database (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/metagenomics">https://www.ebi.ac.uk/metagenomics</ext-link>). Two cheese metagenomes (artisanal cheese: ERP004234, cotija cheese: SRP059999) and one human gut metagenome (ERP002469) were collected (Supplementary Table S<xref rid="MOESM1" ref-type="media">5</xref>). Their compositions and relative species abundance were identified using TAMA.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Evaluation of TAMA using simulated metagenome datasets</title>
      <p id="Par26">The performance of TAMA was evaluated by comparing to the three initial taxonomy analysis tools (CLARK [<xref ref-type="bibr" rid="CR10">10</xref>], Kraken [<xref ref-type="bibr" rid="CR11">11</xref>], and Centrifuge [<xref ref-type="bibr" rid="CR12">12</xref>]) used in TAMA in terms of the accuracy of read classification, species prediction, and species abundance estimation using simulated datasets (Implementation).</p>
      <p id="Par27">Firstly, the performance of read classification was measured by calculating F1-score at species rank (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). For all three types of genome datasets, TAMA showed the best performance (the highest classification accuracy with the smallest variance) compared to the initial three taxonomy analysis tools. In the examination of recall and precision (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, c), TAMA successfully increased recall while preserving precision. These evaluations were also repeated for other taxonomic ranks, and similar performance of TAMA was observed (Supplementary Figs. S<xref rid="MOESM2" ref-type="media">1</xref>-S<xref rid="MOESM2" ref-type="media">5</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance evaluation results of read classification for the species rank. Boxplots indicate the distribution of (<bold>a</bold>) F1-score, (<bold>b</bold>) recall, and (<bold>c</bold>) precision of read classification in the 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). The Wilcoxon signed-rank test was used for pairwise comparison between TAMA and the others (s: <italic>p</italic>-value &lt;= 0.05, and ns: <italic>p</italic>-value &gt; 0.05)</p></caption><graphic xlink:href="12859_2020_3533_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par28">To assess the performance of TAMA in terms of species prediction, we compared simulated and predicted abundance profiles by the four tools, including TAMA, in terms of the F1-score, recall, and precision (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a-c). TAMA successfully improved the performance of species prediction for all types of datasets. Specifically, TAMA dramatically increased the precision with minor decrease of recall in all types of datasets. The recall of all tools was less variable and high (≥ 0.8), whereas their precision was highly variable (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Performances of initial taxonomy analysis tools and TAMA in species identification and abundance estimation. Boxplots indicate the distribution of (<bold>a</bold>) F1-score, (<bold>b</bold>) recall, and (<bold>c</bold>) precision of species prediction and (<bold>d</bold>) the sum of abundance differences of all species in the 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). The Wilcoxon signed-rank test was used for pairwise comparison between TAMA and the others (s: <italic>p</italic>-value &lt;= 0.05, and ns: <italic>p</italic>-value &gt; 0.05)</p></caption><graphic xlink:href="12859_2020_3533_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par29">Finally, the identified species by each tool were more deeply examined and compared in terms of relative species abundance. The abundance difference of each species was first calculated by comparing the predicted relative abundance of the species by each tool with the true answer in the simulated datasets. Abundance differences from all species were then added (see Implementation). Note that the relative species abundance of CLARK or Kraken was generated using the abundance estimation module of TAMA because neither CLARK nor Kraken could directly generate relative species abundance (they could only generate the proportion of reads for each assigned species). For all datasets, the overall performance of TAMA was superior to all three tools in all datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). More obvious performance gap was observed when the numbers of samples with the smallest abundance difference were compared (Table <xref rid="Tab1" ref-type="table">1</xref> and Supplementary Table S<xref rid="MOESM1" ref-type="media">6</xref>). For example, in the 50 genomes dataset, TAMA showed the smallest abundance difference in 21 out of total 35 samples, whereas the abundance was the smallest only in 8, 1, and 5 samples in the case of CLARK, Kraken, and Centrifuge respectively.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The number of samples with the minimum abundance difference</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>10 genomes</th><th>50 genomes</th><th>100 genomes</th></tr></thead><tbody><tr><td>No. of samples</td><td>30</td><td>35</td><td>35</td></tr><tr><td>CLARK</td><td>2</td><td>8</td><td>11</td></tr><tr><td>Kraken</td><td>2</td><td>1</td><td>1</td></tr><tr><td>Centrifuge</td><td>9</td><td>5</td><td>3</td></tr><tr><td>TAMA</td><td>17</td><td>21</td><td>20</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation of TAMA compared to another meta-analysis tool</title>
      <p id="Par30">We evaluated the performance of TAMA compared to another meta-analysis tool, MetaMeta [<xref ref-type="bibr" rid="CR16">16</xref>]. When we compared TAMA with MetaMeta, we used the original reference database of MetaMeta for comparison of MetaMeta and TAMA. Specifically, we used the Kraken database in MetaMeta as itself and created CLARK reference database using the list of reference genomes of CLARK from the MetaMeta database information. Taxonomy analysis tools that are overlapped with MetaMeta and TAMA are only CLARK and Kraken. Thus, we also created Centrifuge reference database for the integrated reference database by using the list of reference in CLARK. We used identical measures to previous evaluation of species prediction and abundance estimation using simulated metagenome datasets. TAMA performed better than MetaMeta in the case of the 10 genomes dataset, but showed slightly worse performance in the case of the 100 genomes dataset (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). However, TAMA achieved dramatically smaller abundance difference than MetaMeta for all the three datasets.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance of meta-analysis tools in species identification and abundance estimation. Boxplots indicate the distribution of (<bold>a</bold>) F1-score, (<bold>b</bold>) recall, and (<bold>c</bold>) precision of species prediction and (<bold>d</bold>) the sum of abundance differences of all species in the 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). The Wilcoxon signed-rank test was used for pairwise comparison between TAMA and MetaMeta (s: <italic>p</italic>-value &lt;= 0.05, and ns: <italic>p</italic>-value &gt; 0.05)</p></caption><graphic xlink:href="12859_2020_3533_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation of TAMA using CAMI metagenome datasets</title>
      <p id="Par31">Critical Assessment of Metagenome Interpretation (CAMI) data [<xref ref-type="bibr" rid="CR23">23</xref>] was used for separate evaluation at species rank. In this evaluation, one sample from each of low (only one sample exists), medium (the sample2 from total two samples), and high (the sample3 from total five samples) complexity dataset in CAMI was used to compare the performance for species identification and their abundance estimation of CLARK, Kraken, Centrifuge, and TAMA. The CAMI dataset provides the list of genomes, their corresponding taxon IDs, and their relative abundance that were used to simulate the datasets. However, there is no information of a true taxon ID for each read. Therefore, we only compared the performance in terms of species prediction and abundance estimation. As in the previous section, relative species abundances of CLARK and Kraken were created by using the abundance estimation module of TAMA.</p>
      <p id="Par32">Similar patterns to the previous evaluation were observed (Table <xref rid="Tab2" ref-type="table">2</xref>). In the performance of species prediction, TAMA showed similar recall values compared to other tools. However, it showed extremely higher precision values, leading to a dramatic increase of F1-score compared to other tools. Precision was increased more than ten times by using TAMA compared to the use of non-meta-analysis tools for all complexity datasets. We also obtained more than four times higher F1-score in species prediction with TAMA compared to the best of other tools. The performance of abundance difference of all tools was very similar.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance evaluation results using CAMI metagenome datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2" colspan="2">Sample</th><th colspan="3">Species prediction</th><th rowspan="2">Abundance difference</th></tr><tr><th>Precision</th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td rowspan="4">Low</td><td>CLARK</td><td>0.003</td><td>0.571</td><td>0.007</td><td>1.591</td></tr><tr><td>Kraken</td><td>0.003</td><td>0.524</td><td>0.007</td><td>1.620</td></tr><tr><td>Centrifuge</td><td>0.044</td><td>0.524</td><td>0.082</td><td>1.627</td></tr><tr><td>TAMA</td><td>0.917</td><td>0.524</td><td>0.667</td><td>1.620</td></tr><tr><td rowspan="4">Medium</td><td>CLARK</td><td>0.010</td><td>0.486</td><td>0.019</td><td>0.800</td></tr><tr><td>Kraken</td><td>0.010</td><td>0.486</td><td>0.019</td><td>0.800</td></tr><tr><td>Centrifuge</td><td>0.058</td><td>0.486</td><td>0.104</td><td>0.893</td></tr><tr><td>TAMA</td><td>0.652</td><td>0.429</td><td>0.517</td><td>0.826</td></tr><tr><td rowspan="4">High</td><td>CLARK</td><td>0.022</td><td>0.336</td><td>0.042</td><td>1.198</td></tr><tr><td>Kraken</td><td>0.022</td><td>0.336</td><td>0.042</td><td>1.198</td></tr><tr><td>Centrifuge</td><td>0.071</td><td>0.328</td><td>0.117</td><td>1.256</td></tr><tr><td>TAMA</td><td>0.720</td><td>0.320</td><td>0.443</td><td>1.207</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Application to cheese metagenomes</title>
      <p id="Par33">TAMA was applied to predict species and their relative abundance in two different cheese metagenomes (Artisanal and Cotija cheese). Highly variable relative abundance of different species was observed in different metagenome samples (Table <xref rid="Tab3" ref-type="table">3</xref> and Supplementary Tables S<xref rid="MOESM1" ref-type="media">7</xref>, S<xref rid="MOESM1" ref-type="media">8</xref>). The number and type of validated species between two cheese metagenome samples were very different. For example, the numbers of identified species for Artisanal cheese and Cotija cheese were 33 and 60, respectively. Moreover, among all predicted profiles, only eight species (<italic>Leuconostoc mesenteroides</italic>, <italic>Aerococcus viridans</italic>, <italic>Enterococcus faecium</italic>, <italic>Enterococcus italicus</italic>, <italic>Enterococcus faecalis</italic>, <italic>Lactococcus lactis</italic>, <italic>Streptococcus macedonicus</italic>, and <italic>Streptococcus thermophilus</italic>) were overlapped in both cheese metagenomes. To identify the distribution of relative abundance, we counted the number of species occupied more than 50% (P50) and more than 90% (P90). We found that both cheese metagenome had a few dominant species that occupied a large proportion of each sample. In the case of Artisanal cheese, <italic>Mycobacterium malmesburyense</italic> and <italic>Streptococcus macedonicus</italic> showed large relative abundances (more than 0.66 and 0.26 of the sample, respectively).
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary of metagenome profiles</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Artisanal cheese</th><th>Cotija cheese</th><th>Human gut</th></tr></thead><tbody><tr><td>No. of species</td><td>34</td><td>60</td><td>80</td></tr><tr><td>P50<sup>a</sup></td><td>1</td><td>3</td><td>7</td></tr><tr><td>P90<sup>b</sup></td><td>2</td><td>10</td><td>26</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The number of species occupied more than 50% of relative abundance</p><p><sup>b</sup>The number of species occupied more than 90% of relative abundance</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec16">
      <title>Application to human gut metagenome</title>
      <p id="Par34">We identified a metagenome profile of human gut sample using TAMA. In the human gut metagenome sample, 3,380,409 reads were classified to species in the reference database, 80 species were identified, and 7 species occupied more than 50% (Table <xref rid="Tab3" ref-type="table">3</xref> and Supplementary Table S<xref rid="MOESM1" ref-type="media">9</xref>). There was no species that had an occupancy of more than 15% in the sample. The most abundant species was <italic>Bacteroides uniformis</italic> (0.13), followed by <italic>Escherichia coli</italic> (0.09). We constructed a phylogenetic tree with 26 species that were included in P90 and indicated their relative abundances using iTOL [<xref ref-type="bibr" rid="CR27">27</xref>]. <italic>Bacteroidales</italic> and <italic>Clostridiales</italic> occupied approximately 33% and 41% of predicted species, respectively. Approximately 9 % of identified species were <italic>Escherichia coli</italic> in the human gut metagenome sample (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Phylogenetic tree of the identified human gut metagenome. It indicates 26 species included in P90 of identified species at leaf nodes and their upper groups (S: superkingdom, P: phylum, O: order, and F: family). The relative species abundance is represented the bar plot with the value shown at the right side</p></caption><graphic xlink:href="12859_2020_3533_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Discussion</title>
    <p id="Par35">TAMA is a novel meta-analysis tool for metagenome taxonomy analysis. TAMA provides classification results from the output of different taxonomy analysis tools by integrating taxon ID assignment of reads and generating an improved relative species abundance profile. Taxonomy classification can be performed for multiple types of sequence files from a sample and for multiple numbers of metagenome samples at once. To reduce any bias from reference databases in the classification for each taxonomy analysis tool, an integrated reference database was generated and embedded in each tool. We provide an integrated reference database with the NCBI RefSeq genome sequences. In addition, users can easily create the integrated database using their reference genome sequences. Taxonomy classification result can be obtained for one of six taxonomy ranks (phylum, class, order, family, genus, and species). A relative species abundance profile can be generated using the estimated genome size of each species for the species rank classification.</p>
    <p id="Par36">To evaluate TAMA, various types of simulated metagenome read datasets were generated. They were composed of various numbers of genomes and distributions of their relative abundance to cover as many different conditions of metagenome samples as possible. TAMA was compared to three non-meta-analysis tools (CLARK, Kraken, and Centrifuge) and one meta-analysis tool (MetaMeta). MetaMeta is based on six different taxonomy analysis tools (CLARK [<xref ref-type="bibr" rid="CR10">10</xref>], DUDes [<xref ref-type="bibr" rid="CR28">28</xref>], GOTTCHA [<xref ref-type="bibr" rid="CR29">29</xref>], Kaiju [<xref ref-type="bibr" rid="CR30">30</xref>], Kraken [<xref ref-type="bibr" rid="CR11">11</xref>], mOTUs [<xref ref-type="bibr" rid="CR31">31</xref>]), while two of them (CLARK and Kraken) overlap with TAMA. The reference database could not be fully customized for every tool used in MetaMeta. Therefore, a similar reference database to the one used in MetaMeta was created and used for fair evaluation.</p>
    <p id="Par37">The main difference between MetaMeta and TAMA is in the way of integrating results from different tools. TAMA uses an eager integration scheme in the sense that the read classification results from used tools are integrated which is followed by the prediction of species and their abundance. However, MetaMeta relies on a lazy integration scheme because it allows used tools to classify reads and predict species abundance separately, and then integrates the final results. In addition, whereas MetaMeta filters out only species with low abundance in the final integrated results, TAMA can remove reads with low confidence score before predicting species and their abundance. The eager integration scheme with the use of classified reads with high confidence may lead to higher performance of TAMA than MetaMeta especially in the estimation of species abundance, indicating that a result integration scheme may be a more important factor than the number of used tools in the meta-analysis.</p>
    <p id="Par38">In the evaluation with simulated metagenome datasets, we first examined each assignment of read. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, all initial taxonomy analysis tools and TAMA showed F1-score of more than 0.75. However, TAMA had the smallest variance and the highest median for all datasets. We performed the Wilcoxon signed-rank test to examine whether the performance of TAMA was significantly greater than performances of initial tools. From the analysis, we obtained significantly low <italic>p</italic>-value (&lt; 0.05 for all pairs by the Wilcoxon signed-rank test), indicating that statistically significant performance improvement was possible with TAMA. Additionally, because we provide all assigned taxon IDs in read classification profile with high accuracy and the score of meta-analysis, we believe that TAMA could be helpful in a following study utilizing classified read information.</p>
    <p id="Par39">The performance of TAMA was then examined in terms of the accuracy of predicting existing species in a metagenome dataset. We reduced many false positive species from the predicted species with meta-score of TAMA, indicating a degree of confidence for an integration. In the evaluation using the CAMI metagenome, non-meta-analysis tools had very low predictive precisions of species. This has been similarly observed in a previous study at species rank [<xref ref-type="bibr" rid="CR32">32</xref>]. However, TAMA was able to increase the precision more than ten times. A tiny amount of incorrectly assigned reads are one of the reasons for the generation of false positively predicted species. Another reason is that a part of the read sequence for a single genome could be generated from the common sequence region between different genomes. We could filter out assignments that have low confidence using the meta-score of TAMA by calculating the average meta-score of the predicted species and ignoring the unreliable prediction with the average. It is considered to be an advantage of meta-analysis because MetaMeta, another meta-analysis program, also shows similar performance in species prediction. Moreover, TAMA shows improved performance in the estimation of relative species abundance, in line with its read classification performance.</p>
    <p id="Par40">Finally, TAMA was applied to predict species and their abundances in real metagenome samples from various environments. In the investigation of three real metagenome samples, it was found that compositions and relative abundances of species were very different in different environments. In Artisanal cheese, there are dominantly existing species (the relative abundances of a species &gt; 0.5). However, other metagenome samples do not have such dominant species. TAMA could successfully identify three main bacterial genomes in the Cotija cheese sample, namely <italic>Lactobacillus plantarum</italic>, <italic>Weissella paramesenteroides</italic>, and <italic>Leuconostoc mesenteroides</italic> [<xref ref-type="bibr" rid="CR33">33</xref>]. There are some limitations to apply it to real metagenome datasets. There are still many unclassified read sequences because of the shallow coverage of the reference database (Supplementary Tables S<xref rid="MOESM1" ref-type="media">7</xref>-S<xref rid="MOESM1" ref-type="media">9</xref>). This is a common problem in taxonomy analysis based on a reference database. This will be alleviated as more and more new species are discovered and added into the reference database.</p>
    <p id="Par41">One drawback of TAMA is relatively long runtime because of the requirement of running multiple taxonomy analysis tools. However, we believe that it can be complemented by modern computing power, such as the capability of parallel computing, and superior performance of TAMA compared to other tools. As a future direction, TAMA will become more customizable to use any number of taxonomy analysis tools chosen by users, and the integrated reference sequence database in TAMA will be kept updated to reflect the changes of bacterial genome sequences in the NCBI database.</p>
  </sec>
  <sec id="Sec18">
    <title>Conclusion</title>
    <p id="Par42">TAMA is a meta-analysis tool for the taxonomy analysis of metagenome reads at the user selected taxonomic rank. TAMA can be used to improve the quality of taxonomy classification profiles, and to reduce many of the false positives. We believe that TAMA is the most accurate and easy-to-use existing meta-analysis tool based on evaluation results in comparison with other tools, and TAMA can contribute to more accurate metagenome analysis if more accurate and larger amounts of reference genomes are accumulated.</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p id="Par43">Project name: TAMA.</p>
    <p id="Par44">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/jkimlab/TAMA">https://github.com/jkimlab/TAMA</ext-link></p>
    <p id="Par45">Operating system: Linux.</p>
    <p id="Par46">Programming language: Perl.</p>
    <p id="Par47">Other requirements: Docker.</p>
    <p id="Par48">License: MIT.</p>
    <p id="Par49">Any restrictions to use by non-academics: License needed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3533_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Supplementary Table S1.</bold> The statistics of reference sequences used in the TAMA database. <bold>Supplementary Table S2.</bold> The relative abundance of 10 genomes generated using six different parameter values of the Poisson distribution. <bold>Supplementary Table S3.</bold> The relative abundance of 50 genomes generated using seven different parameter values of the Poisson distribution. <bold>Supplementary Table S4.</bold> The relative abundance of 100 genomes generated using seven different parameter values of the Poisson distribution. <bold>Supplementary Table S5.</bold> The statistics of read sequences in real metagenome datasets. <bold>Supplementary Table S6.</bold> The abundance difference of initial taxonomy analysis tools and TAMA for the simulated metagenome datasets. <bold>Supplementary Table S7.</bold> The abundance profile of Artisanal cheese metagenome. <bold>Supplementary Table S8.</bold> The abundance profile of Cotija cheese metagenome. <bold>Supplementary Table S9.</bold> The abundance profile of human gut metagenome.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3533_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2: Supplementary Figure S1.</bold> Performance evaluation results of read classification for the genus rank. Boxplots indicate the distribution of (A) F1-score, (B) recall and (C) precision of read classification in 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). <bold>Supplementary Figure S2.</bold> Performance evaluation results of read classification for the family rank. Boxplots indicate the distribution of (A) F1-score, (B) recall and (C) precision of read classification in 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). <bold>Supplementary Figure S3.</bold> Performance evaluation results of read classification for the order rank. Boxplots indicate the distribution of (A) F1-score, (B) recall and (C) precision of read classification in 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). <bold>Supplementary Figure S4.</bold> Performance evaluation results of read classification for the class rank. Boxplots indicate the distribution of (A) F1-score, (B) recall and (C) precision of read classification in 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right). <bold>Supplementary Figure S5.</bold> Performance evaluation results of read classification for the phylum rank. Boxplots indicate the distribution of (A) F1-score, (B) recall and (C) precision of read classification in 10 genomes dataset (left), 50 genomes dataset (center), and 100 genomes dataset (right).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CAMI</term>
        <def>
          <p id="Par4">Critical Assessment of Metagenomic Interpretation</p>
        </def>
      </def-item>
      <def-item>
        <term>TAMA</term>
        <def>
          <p id="Par5">Taxonomy Analysis pipeline for metagenome using Meta-Analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-3533-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JBK conceived and designed the research. MKS, JYK, and DHL implemented modules for existing taxonomy analysis tools. MKS and JIL designed and implemented a meta-analysis module and relative species abundance profile estimation module. DHL optimized each module, while DHK constructed a pipeline. MKS performed experiments, and MKS and JBK interpreted the analysis results. MKS drafted the manuscript, and JBK finalized the manuscript. All authors approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This paper was supported by Konkuk University in 2018. The funder did not play any role in this study.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The package presented in this manuscript is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jkimlab/TAMA">https://github.com/jkimlab/TAMA</ext-link>.</p>
    <p>The integrated databases and simulated metagenome datasets are available at: <ext-link ext-link-type="uri" xlink:href="http://bioinfo.konkuk.ac.kr/TAMA">http://bioinfo.konkuk.ac.kr/TAMA</ext-link>.</p>
    <p>The CAMI datasets are available at: <ext-link ext-link-type="uri" xlink:href="https://data.cami-challenge.org">https://data.cami-challenge.org</ext-link>.</p>
    <p>The real metagenome datasets are available at: <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/metagenomics">https://www.ebi.ac.uk/metagenomics</ext-link>. Project IDs are available at the Supplementary Table S<xref rid="MOESM1" ref-type="media">5</xref>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Azam F, Fenchel T, Field JG, Gray J, Meyer-Reil L, Thingstad F. The ecological role of water-column microbes in the sea. Mar Ecol Prog Ser. 1983:257–63.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaeger</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Monson</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Fisk</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>Seasonal partitioning of nitrogen by plants and soil microorganisms in an alpine ecosystem</article-title>
        <source>Ecology</source>
        <year>1999</year>
        <volume>80</volume>
        <issue>6</issue>
        <fpage>1883</fpage>
        <lpage>1891</lpage>
        <pub-id pub-id-type="doi">10.1890/0012-9658(1999)080[1883:SPONBP]2.0.CO;2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allison</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Maloy</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Matson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Inactivation of Clostridium botulinum toxin by ruminal microbes from cattle and sheep</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1976</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>685</fpage>
        <lpage>688</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.32.5.685-688.1976</pub-id>
        <?supplied-pmid 984838?>
        <pub-id pub-id-type="pmid">984838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neish</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Microbes in gastrointestinal health and disease</article-title>
        <source>Gastroenterology.</source>
        <year>2009</year>
        <volume>136</volume>
        <issue>1</issue>
        <fpage>65</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1053/j.gastro.2008.10.080</pub-id>
        <?supplied-pmid 19026645?>
        <pub-id pub-id-type="pmid">19026645</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome: at the interface of health and disease. Nature reviews</article-title>
        <source>Genetics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>260</fpage>
        <?supplied-pmid 22411464?>
        <pub-id pub-id-type="pmid">22411464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McFall-Ngai</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>The importance of microbes in animal development: lessons from the squid-vibrio symbiosis</article-title>
        <source>Annu Rev Microbiol</source>
        <year>2014</year>
        <volume>68</volume>
        <fpage>177</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-micro-091313-103654</pub-id>
        <?supplied-pmid 24995875?>
        <pub-id pub-id-type="pmid">24995875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mukhopadhyay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Redding</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Rutherford</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Keasling</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Importance of systems biology in engineering microbes for biofuel production</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2008</year>
        <volume>19</volume>
        <issue>3</issue>
        <fpage>228</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="doi">10.1016/j.copbio.2008.05.003</pub-id>
        <?supplied-pmid 18515068?>
        <pub-id pub-id-type="pmid">18515068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vartoukian</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Wade</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>Strategies for culture of ‘unculturable’bacteria</article-title>
        <source>FEMS Microbiol Lett</source>
        <year>2010</year>
        <volume>309</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 20487025?>
        <pub-id pub-id-type="pmid">20487025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scholz</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>Next generation sequencing and bioinformatic bottlenecks: the current state of metagenomic data analysis</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2012</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.copbio.2011.11.013</pub-id>
        <?supplied-pmid 22154470?>
        <pub-id pub-id-type="pmid">22154470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genom</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>R46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
        <?supplied-pmid 24580807?>
        <pub-id pub-id-type="pmid">24580807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Kim D, Song L, Breitwieser FP, Salzberg SL. Centrifuge: rapid and sensitive classification of metagenomic sequences. Genome Res. 2016;26(12):1721–9.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Breitwieser FP, Lu J, Salzberg SL. A review of methods and databases for metagenomic classification and assembly. Brief bioinform. 2019;20(4):1125–36.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>XC</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Morales</surname>
            <given-names>SE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying accurate metagenome and amplicon software via a meta-analysis of sequence to taxonomy benchmarking studies</article-title>
        <source>PeerJ.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>e6160</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.6160</pub-id>
        <?supplied-pmid 30631651?>
        <pub-id pub-id-type="pmid">30631651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Lindgreen S, Adair KL, Gardner PP. An evaluation of the accuracy and speed of metagenome analysis tools. Sci Rep. 2016;6:19233.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piro</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Matschkowski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
        </person-group>
        <article-title>MetaMeta: integrating metagenome analysis tools to improve taxonomic profiling</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>101</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0318-y</pub-id>
        <?supplied-pmid 28807044?>
        <pub-id pub-id-type="pmid">28807044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Uritskiy G, DiRuggiero J, Taylor J. MetaWRAP-a flexible pipeline for genome-resolved metagenomic data analysis. Microbiome. 2018;6. 10.1186/s40168-018-0541-1.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zakrzewski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bekel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pühler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rupp</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaSAMS--a novel software platform for taxonomic classification, functional annotation and comparative analysis of metagenome datasets</article-title>
        <source>J Biotechnol</source>
        <year>2013</year>
        <volume>167</volume>
        <issue>2</issue>
        <fpage>156</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiotec.2012.09.013</pub-id>
        <?supplied-pmid 23026555?>
        <pub-id pub-id-type="pmid">23026555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khoshdel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Attia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carney</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Basic concepts in meta-analysis: a primer for clinicians</article-title>
        <source>Int J Clin Pract</source>
        <year>2006</year>
        <volume>60</volume>
        <issue>10</issue>
        <fpage>1287</fpage>
        <lpage>1294</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1742-1241.2006.01078.x</pub-id>
        <?supplied-pmid 16981972?>
        <pub-id pub-id-type="pmid">16981972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haase</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bellomo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Devarajan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schlattmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Haase-Fielitz</surname>
            <given-names>A</given-names>
          </name>
          <collab>Group NM-aI</collab>
        </person-group>
        <article-title>Accuracy of neutrophil gelatinase-associated lipocalin (NGAL) in diagnosis and prognosis in acute kidney injury: a systematic review and meta-analysis</article-title>
        <source>Am J Kidney Dis</source>
        <year>2009</year>
        <volume>54</volume>
        <issue>6</issue>
        <fpage>1012</fpage>
        <lpage>1024</lpage>
        <pub-id pub-id-type="doi">10.1053/j.ajkd.2009.07.020</pub-id>
        <?supplied-pmid 19850388?>
        <pub-id pub-id-type="pmid">19850388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DerSimonian</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Meta-analysis in clinical trials</article-title>
        <source>Control Clin Trials</source>
        <year>1986</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>177</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1016/0197-2456(86)90046-2</pub-id>
        <pub-id pub-id-type="pmid">3802833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Group GM-aTG</collab>
        </person-group>
        <article-title>Chemotherapy in adult high-grade glioma: a systematic review and meta-analysis of individual patient data from 12 randomised trials</article-title>
        <source>Lancet</source>
        <year>2002</year>
        <volume>359</volume>
        <issue>9311</issue>
        <fpage>1011</fpage>
        <lpage>1018</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(02)08091-1</pub-id>
        <pub-id pub-id-type="pmid">11937180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Belmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Koslicki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of metagenome interpretation—a benchmark of metagenomics software</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>1063</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id>
        <?supplied-pmid 28967888?>
        <pub-id pub-id-type="pmid">28967888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 24695404?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikolenko</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Alekseyev</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>BayesHammer: Bayesian clustering for error correction in single-cell sequencing</article-title>
        <source>BMC Genom</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>S7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-S1-S7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive tree of life (iTOL) v4: recent updates and new developments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>W1</issue>
        <fpage>W256</fpage>
        <lpage>W2W9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id>
        <?supplied-pmid 30931475?>
        <pub-id pub-id-type="pmid">30931475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piro</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Lindner</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
        </person-group>
        <article-title>DUDes: a top-down taxonomic profiler for metagenomics</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>15</issue>
        <fpage>2272</fpage>
        <lpage>2280</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw150</pub-id>
        <?supplied-pmid 27153591?>
        <pub-id pub-id-type="pmid">27153591</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freitas</surname>
            <given-names>TAK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P-E</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>Accurate read-based metagenome characterization using a hierarchical suite of unique signatures</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>10</issue>
        <fpage>e69</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv180</pub-id>
        <?supplied-pmid 25765641?>
        <pub-id pub-id-type="pmid">25765641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11257</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11257</pub-id>
        <?supplied-pmid 27071849?>
        <pub-id pub-id-type="pmid">27071849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Izquierdo-Carrasco</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>1196</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2693</pub-id>
        <?supplied-pmid 24141494?>
        <pub-id pub-id-type="pmid">24141494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Meyer F, Bremges A, Belmann P, Janssen S, McHardy AC, Koslicki D. Assessing taxonomic metagenome profilers with OPAL. Genome Biol. 2019;20(1):51.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Escobar-Zepeda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanchez-Flores</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Quirasco</surname>
            <given-names>BM</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic analysis of a Mexican ripened cheese reveals a unique complex microbiota</article-title>
        <source>Food Microbiol</source>
        <year>2016</year>
        <volume>57</volume>
        <fpage>116</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1016/j.fm.2016.02.004</pub-id>
        <?supplied-pmid 27052710?>
        <pub-id pub-id-type="pmid">27052710</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
