<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6425654</article-id>
    <article-id pub-id-type="publisher-id">2703</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2703-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FitTetra 2.0 – improved genotype calling for tetraploids with multiple population and parental data support</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zych</surname>
          <given-names>Konrad</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gort</surname>
          <given-names>Gerrit</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maliepaard</surname>
          <given-names>Chris A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jansen</surname>
          <given-names>Ritsert C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4388-9244</contrib-id>
        <name>
          <surname>Voorrips</surname>
          <given-names>Roeland E.</given-names>
        </name>
        <address>
          <email>roeland.voorrips@wur.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0407 1981</institution-id><institution-id institution-id-type="GRID">grid.4830.f</institution-id><institution>Groningen Bioinformatics Centre, </institution><institution>University of Groningen, </institution></institution-wrap>Groningen, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0791 5666</institution-id><institution-id institution-id-type="GRID">grid.4818.5</institution-id><institution>Wageningen University and Research – Biometris, </institution></institution-wrap>Wageningen, The Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0791 5666</institution-id><institution-id institution-id-type="GRID">grid.4818.5</institution-id><institution>Wageningen University and Research - Plant Breeding, </institution></institution-wrap>Wageningen, The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>148</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>2</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genetic studies in tetraploids are lagging behind in comparison with studies of diploids as the complex genetics of tetraploids require much more elaborated computational methodologies. Recent advancements in development of molecular techniques and computational tools facilitate new methods for automated, high-throughput genotype calling in tetraploid species. We report on the upgrade of the widely-used fitTetra software aiming to improve its accuracy, which to date is hampered by technical artefacts in the data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Our upgrade of the fitTetra package is designed for a more accurate modelling of complex collections of samples. The package fits a mixture model where some parameters of the model are estimated separately for each sub-collection. When a full-sib family is analyzed, we use parental genotypes to predict the expected segregation in terms of allele dosages in the offspring. More accurate modelling and use of parental data increases the accuracy of dosage calling. We tested the package on data obtained with an Affymetrix Axiom 60 k array and compared its performance with the original version and the recently published ClusterCall tool, showing that at least 20% more SNPs could be called with our updated.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Our updated software package shows clearly improved performance in genotype calling accuracy. Estimation of mixing proportions of the underlying dosage distributions is separated for full-sib families (where mixture proportions can be estimated from the parental dosages and inheritance model) and unstructured populations (where they are based on the assumption of Hardy-Weinberg equilibrium). Additionally, as the distributions of signal ratios of the dosage classes can be assumed to be the same for all populations, including parental data for some subpopulations helps to improve fitting other populations as well. The R package fitTetra 2.0 is freely available under the GNU Public License as Additional file with this article.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2703-y) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genomics</kwd>
      <kwd>Genotyping</kwd>
      <kwd>Genotype calling</kwd>
      <kwd>Polyploids</kwd>
      <kwd>Autotetraploids</kwd>
      <kwd>fitPoly</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Dutch Carbohydrate Competence Center</institution>
        </funding-source>
        <award-id>CCC WP23</award-id>
        <award-id>CCC WP23</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zych</surname>
            <given-names>Konrad</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>Ritsert C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Dutch Topsector Horticulture &amp; Starting Materials</institution>
        </funding-source>
        <award-id>BO-26.03-002-001 and BO-26.03-009-004</award-id>
        <award-id>BO-26.03-002-001 and BO-26.03-009-004</award-id>
        <award-id>BO-26.03-002-001 and BO-26.03-009-004</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gort</surname>
            <given-names>Gerrit</given-names>
          </name>
          <name>
            <surname>Maliepaard</surname>
            <given-names>Chris A.</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>Roeland E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Genetic studies in tetraploid species are lagging behind those of diploids. This is mostly due to the more complex genetics of tetraploids. Tetraploids have four copies of each of their chromosomes. Alleles at a marker locus can therefore be present in five different dosages: 0 (nulliplex), 1 (simplex), 2 (duplex), 3 (triplex) and 4 (quadruplex). Dosage scoring of such markers is challenging and has been computationally approached only since 2011 [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par5">Automated dosage scoring is much needed in high-throughput genotyping technologies. In tetraploid species SNP arrays are the most widely used due to their cost efficiency [<xref ref-type="bibr" rid="CR5">5</xref>]. SNP arrays like Illumina Infinium [<xref ref-type="bibr" rid="CR6">6</xref>] or Affymetrix Axiom [<xref ref-type="bibr" rid="CR7">7</xref>] measure the fluorescence signals of two dyes generated by the two alleles of each SNP. The higher the dosage of an allele, the stronger the fluorescence signal of the dye that is tracking it. Ideally the signal intensities should fall into one of the five possible categories. However, in practice these values are continuous and need to be converted into discrete dosage categories. Automated dosage scoring in tetraploid has been approached with k-means clustering [<xref ref-type="bibr" rid="CR1">1</xref>] and hierarchical clustering [<xref ref-type="bibr" rid="CR4">4</xref>] on data translated into polar coordinates, or Bayesian clustering [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par6">The fitTetra software [<xref ref-type="bibr" rid="CR2">2</xref>] uses another approach. First, the ratio of one of the signals to the sum of both signals is calculated. Ratio data is then arcsine-square root transformed to obtain approximately constant variance for the component distributions. Next, a mixture of normal distributions is fitted to the continuous ratio data, using the EM algorithm, and the fitted model is used to obtain categorical assignments. Similar approaches have been used in genomic research for many purposes, e.g. in scoring of AFLP markers [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. This mixture model approach is computationally demanding but allows for automatic assignment of genotype categories by explicit modelling of the means of the distributions as a function of the allele ratios. The algorithm produces probabilities for each sample ratio to belong to the five distributions, and these can be used to assign a dosage to a specific class. This increases the reliability to deconvolute the distributions even if they overlap considerably. As a result, fitTetra is useful for automated dosage scoring in tetraploid species [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par7">Data in multiple individuals for a single SNP can be modelled with a mixture of five normal distributions (each corresponding to a dosage score which may range from 0 to 4). The ratio values are from 0 to 1 (which corresponds to 0 to π/2 on the transformed scale) and the five distributions could be expected to be equally spaced along this range. However, in practice it is observed that they often are non-equally spaced. Moreover, limits of the ratios data range are often shifted towards the middle from one side or both [<xref ref-type="bibr" rid="CR5">5</xref>]. These phenomena were accounted for in fitTetra [<xref ref-type="bibr" rid="CR2">2</xref>] and further extended in an updated version of the software (fitTetra 1.0) [<xref ref-type="bibr" rid="CR5">5</xref>]. That update added re-evaluation of the model if one of the extreme distributions is fitted with less than 2.5% of all samples and the adjacent distribution is fitted with more than 15% of samples. Such a situation is rarely expected. If the population under study is a full-sib family (FS), only one of the possible combinations of parental genotypes may result in a pattern close to such (Table <xref rid="Tab1" ref-type="table">1</xref> – AABB x AABB). Also for a collection of genotypes in Hardy-Weinberg equilibrium this is unlikely, as a low proportion of one of the extreme (nulli- or quadruplex) genotypes implies a low frequency of the corresponding allele and hence also a low proportion of the next (simplex or triplex) genotype. This re-evaluation strategy worked well for Illumina Infinium arrays [<xref ref-type="bibr" rid="CR5">5</xref>]. Our recent analysis showed that even with this update, fitTetra1 may be misguided when shifts are severe, and that the update was insufficient to efficiently call genotypes for our Affymetrix Axiom array.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Polysomic segregation ratios</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Parent 1</th><th/><th/><th colspan="2">Parent 2</th><th/></tr><tr><th>0 = nulliplex</th><th>1 = simplex</th><th>2 = duplex</th><th>3 = triplex</th><th>4 = quadruplex</th></tr></thead><tbody><tr><td>0 = nulliplex</td><td>1:0:0:0:0</td><td>1:1:0:0:0</td><td>1:4:1:0:0</td><td>0:1:1:0:0</td><td>0:0:1:0:0</td></tr><tr><td>1 = simplex</td><td>1:1:0:0:0</td><td>1:2:1:0:0</td><td>1:5:5:1:0</td><td>0:1:2:1:0</td><td>0:0:1:1:0</td></tr><tr><td>2 = duplex</td><td>1:4:1:0:0</td><td>1:5:5:1:0</td><td>1:8:18:8:1</td><td>0:1:5:5:1</td><td>0:0:1:4:1</td></tr><tr><td>3 = triplex</td><td>0:1:1:0:0</td><td>0:1:2:1:0</td><td>0:1:5:5:1</td><td>0:0:1:2:1</td><td>0:0:0:1:1</td></tr><tr><td>4 = quadruplex</td><td>0:0:1:0:0</td><td>0:0:1:1:0</td><td>0:0:1:4:1</td><td>0:0:0:1:1</td><td>0:0:0:0:1</td></tr></tbody></table><table-wrap-foot><p>Polysomic segregation ratios from random bivalent paring without double reduction for all possible combination of parental genotypes. For each parental combination the proportions of 0 (nulliplex): 1(simplex): 2 (duplex): 3 (triplex): 4(quadruplex) genotypes as expected in the offspring are shown</p></table-wrap-foot></table-wrap></p>
    <p id="Par8">In order to improve the performance of fitTetra we added the possibility to use additional information. We allowed to specify subpopulations among the samples, which may be FS families (the direct F1 progeny of a cross between outbred, heterozygous parents, including the parents themselves) or panels of accessions such as collections of tetraploid breeding germplasm. Additionally, we made it possible to specify known genotypes for the parents of the FS populations.</p>
    <p id="Par9">The accuracy of dosage scoring with fitTetra increases with the number of samples analyzed. However, a combined analysis of samples from different types of populations is not straightforward. Full-sib families, used routinely in breeding of cross-pollinating polyploid crops, have expected allele ratios determined by the allele dosages of the parents. Collections of cultivars and breeding germplasm often display genotype frequencies close to those expected under Hardy-Weinberg equilibrium. However, assumptions concerning the combined allele dosage ratios can only be made if the composition of a dataset consisting of several FS families and/or cultivar panels is considered. To address this problem, we updated fitTetra to allow some model parameters to be shared between the subpopulations when they can be assumed to be equal (e.g. means and variances of the distributions which correspond to the allele dosage classes) while the mixing proportions of the dosages are specific for each subpopulation and therefore estimated separately. These additions result in increased power as combined analyses can be done comprising all samples, while using the most realistic assumptions for each of the subpopulations.</p>
    <p id="Par10">If the parental genotypes of a FS family are known, it is possible to calculate expected allele dosage ratios for their progeny, which can be used as starting values for the mixing proportions for that family in the model. Additionally, these known parental genotypes can be used to estimate starting values for the means of the distributions. This helps to guide the algorithm towards a better result. With our update to fitTetra (fitTetra 2.0, Additional file <xref rid="MOESM1" ref-type="media">1</xref>) that incorporates these capabilities, we were able to increase the call of SNPs by more than 25%, compared to version 1.0 (full data not shown).</p>
    <p id="Par11">Recently, another tool for automated genotype calling in tetraploids was published. ClusterCall [<xref ref-type="bibr" rid="CR4">4</xref>] uses hierarchical clustering, with training and prediction phases. In the training phase, per probe, theta values (roughly equivalent to signal intensity ratios) from each of the FS families (offspring and parents) are clustered based on their intensity values, and dosages are assigned to the clusters based on expected FS segregation ratios. In the prediction phase, the theta values of the samples in the prediction set (e.g. a collection of breeding material) are clustered, and dosages are assigned by matching these clusters with those found in the training phase. A concordance metric, i.e. the proportion of training samples that were assigned the same dosage in training and test phase, is calculated and used for selection of reliable probes. The authors claim that ClusterCall is able to perform better than fitTetra 1.0 when multiple FS families are present. In our study we benchmarked ClusterCall against fitTetra 1.0 and fitTetra 2.0.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview of fitTetra</title>
      <p id="Par12">The R package fitTetra [<xref ref-type="bibr" rid="CR2">2</xref>] is a program for genotype calling of SNP markers in tetraploid species using normal mixture models. It consists of three main functions: 1) CodomMarker: the core function to fit a normal mixture model to a vector of transformed signal ratios of a single bi-allelic marker over all the samples; 2) fitTetra: a function to fit different normal mixture models to a single bi-allelic marker and select the optimal one; 3) saveMarkerModels: a function to fit mixture models for a series of markers and save the results to files. This suite of functions allows for automatic genotype calling for a collection of SNP markers. The normal mixture model is formulated for the response <italic>y</italic> = arcsine-square root transformed fraction s<sub>b</sub>/(s<sub>a</sub> + s<sub>b</sub>) where s<sub>a</sub> and s<sub>b</sub> are the fluorescence signal strengths for alleles a and b. The normal mixture density of the <italic>i</italic>-th response <italic>y</italic><sub><italic>i</italic></sub> is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f\left({y}_i\right)={\sum}_{j=1}^5{\pi}_j{f}_j\left({y}_i\right) $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msubsup><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2703_Article_IEq1.gif"/></alternatives></inline-formula> with <italic>f</italic><sub><italic>j</italic></sub>(<italic>y</italic><sub><italic>i</italic></sub>) the normal density with mean <italic>μ</italic><sub><italic>j</italic></sub> and common variance <italic>σ</italic><sup>2</sup>. The probabilities <italic>π</italic><sub><italic>j</italic></sub>, means <italic>μ</italic><sub><italic>j</italic></sub> and variance <italic>σ</italic><sup>2</sup> are estimated by maximum likelihood using the EM-algorithm. Starting values of the parameters can be provided by the user or are derived by the software through naïve clustering of the data. The genotype calling of observation <italic>y</italic><sub><italic>i</italic></sub> is based on the set of 5 values <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_{ij}={\pi}_j{f}_j\left({y}_i\right)/{\sum}_{j=1}^5{\pi}_j{f}_j\left({y}_i\right) $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>/</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msubsup><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2703_Article_IEq2.gif"/></alternatives></inline-formula> (<italic>j</italic> = 1,..,5) that describe the probabilities that a sample belongs to each of the five distributions. If one of the <italic>p</italic><sub><italic>ij</italic></sub> is larger than a user-defined threshold value (e.g. 0.9) the genotype will be called to be <italic>j-1</italic> (as the distribution for <italic>j = 1</italic> corresponds to a dosage score of 0).</p>
      <p id="Par13">The CodomMarker function allows restrictions to be placed on the <italic>μ</italic><sub><italic>j</italic></sub> and <italic>π</italic><sub><italic>j</italic></sub> parameters. Parameters <italic>π</italic><sub><italic>j</italic></sub> may be free or restricted to follow Hardy-Weinberg equilibrium. Parameters <italic>μ</italic><sub><italic>j</italic></sub> may be restricted such that 1) background signals for a and b (for the two SNP alleles) are equal or unequal; 2) the relationship between signal ratio and allele dosage is linear or quadratic. These restrictions allow the means <italic>μ</italic><sub><italic>j</italic></sub> to be asymmetrically positioned within the range 0 - π/2. An example of a histogram produced by fitTetra for a SNP for tetraploid potato is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The dark bars in the histogram represent ratios of diploid potato genotypes included in this study. The allele ratios for diploid homozygotes are equal to ratios for homozygotes (nulliplex and quadruplex) in tetraploids and the ratio for the diploid heterozygote is the same as the ratio for duplex genotypes in tetraploids. Therefore, the position of diploid distributions compared to tetraploid distribution may serve as an extra check for the quality of the calling.<fig id="Fig1"><label>Fig. 1</label><caption><p>Histogram of genotype calling for probe_1028 (from fitTetra 2.0 test dataset), an example where the results of fitTetra 2.0 are different from fitTetra 1.0. Two populations are present: an association panel labeled “PANEL” and a FS family with two parental genotypes (both replicated). The association panel is assumed to be in Hardy-Weinberg equilibrium. <italic>Right</italic>: Calling with fitTetra 2.0 (using parental genotype data). The parental genotypes are set to be duplex (2) and quadruplex (4), leading to the segregation pattern 0:0:1:4:1, which is shown in the upper panel. <italic>Left</italic>: Calling with fitTetra 1.0. Without information on population structure, parental samples are genotyped as simplex (1) and triplex (3). Such a combination should result in a 0:1:2:1:0 pattern in the FS family. However, if we just consider samples from the FS family, the results of the calling suggest a 0:1:4:1:0 pattern which does not match any parental combination</p></caption><graphic xlink:href="12859_2019_2703_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Extension to multiple populations</title>
      <p id="Par14">In fitTetra 2.0 multiple populations may be specified, whereas fitTetra 1.0 treated all observations as stemming from one single population. When multiple populations are used, the model parameters for the means <italic>μ</italic><sub><italic>j</italic></sub> (i.e. the positions of the peaks) and variance <italic>σ</italic><sup>2</sup> (i.e. the width of the peaks on arcsine-square root scale) are shared among the different populations, while the mixing proportions <italic>π</italic><sub><italic>j</italic></sub> may be different for each population.</p>
      <p id="Par15">In fitTetra 1.0 the CodomMarker function, performing calling of a single marker allowed for three types of restrictions on the mixing proportions <italic>π</italic><sub><italic>j</italic></sub>: 1) freely estimated (ptype = “p.free”), i.e. the only restriction is that <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sum}_{j=1}^5{\pi}_j=1 $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msubsup><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_2703_Article_IEq3.gif"/></alternatives></inline-formula>; 2) Hardy-Weinberg equilibrium (“p.HW”) where only the allele frequency is estimated and mixing proportions are a function of those based on Hardy-Weinberg equilibrium, which is often reasonable for association panels; 3) fixed proportions (“p.fixed”), i.e. the <italic>π</italic><sub><italic>j</italic></sub> are kept fixed at their given values during the EM-algorithm (used when values are known from another source).</p>
      <p id="Par16">In the new version of the program we added a new type of restriction on the mixing proportions, p.type = “p.F1”, for an F1 population. Given the parental genotypes estimated in the previous iteration of the EM algorithm, the “p.F1” proportions are calculated as the expected tetrasomic segregation ratios of the F1 progeny of these two parents. These segregation ratios assume random bivalent pairing and no double reduction and are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Double reduction is expected to occur in relatively low frequency even when there are occasionally multivalent pairings. The parental samples are specified as separate populations.</p>
      <p id="Par17">The EM-algorithm is used to find the maximum likelihood estimates of the parameters of the multi-population mixture model. In this algorithm E-steps (Expectation) and M-steps (Maximization) are repeatedly taken until the likelihood converges. In the E-step, given current estimates of the parameters, the probabilities for an observation to belong to each of the five mixture components are calculated. In the M-step, based on these calculated probabilities, new component means and variance are calculated over all observations. Then new mixing proportions are calculated per population depending on the type of restrictions on the mixing proportions, as discussed above.</p>
      <p id="Par18">In fitTetra 2.0, function “CodomMarker” (and, as a result the wrapper function “fitTetra” and the convenience function “saveMarkerModels”) produces the same type of output as fitTetra 1.0 with the exception of the output of probabilities of the five distributions, which are now population specific. Optionally, an array of histograms is plotted, showing per population (for association panels and for FS’s) the histogram of ratios with the fitted mixture model. Parental data are shown with separate coloured symbols in the histograms for the corresponding FS family (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Support for parental genotype data</title>
      <p id="Par19">When extra parental information is available, it can be used to further facilitate the genotype calling. Custom SNP arrays, the most popular means of genotyping tetraploids, are often based on discovery studies where parents of a population are sequenced in order to design the array for the population itself [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The user can supply this information and set the probability type to “p.fixed” for the parental populations. This will fix the mixing proportions for the parental populations through the run of the algorithm. The probabilities (segregation ratios) of the corresponding F1 progeny will be calculated accordingly. It is possible that parental genotypes are erroneous (e.g. if they were derived from RNA-Seq they might be affected by differential gene expression). To avoid losing markers just because of that, fitTetra 2.0 will always attempt fitting a model where “p.free” is used instead of “p.fixed” and model with better BIC score will be selected. If parental genotypes supplied by the user are correct, the run with the “p.fixed” should produce model at least as good as with “p.free”.</p>
      <p id="Par20">Moreover, if the parents were analyzed in the same run as the FS family their dosages are also used to assign starting means for one or two of the mixing components. When parents have different dosages, two starting means are known, and the remaining three are estimated using a simple linear regression model. This may not be completely accurate as the relationship between dosage and intensity is not necessarily linear, but in our experience it provides a better start than the naïve clustering of the samples.</p>
      <p id="Par21">When multiple populations are measured in the same run, the means of the five genotype/dosage distributions are shared between populations. Because fitTetra 2.0 has the ability to process multiple populations at once, using known dosages of parents benefits the genotype calling not only for their F1 offspring but also for all the other populations, even when they are not related to these parents.</p>
      <p id="Par22">However, the starting parental dosages may be incorrect and applying these data as starting values may result in incorrect calls, or in not fitting any model at all. An example of this is shown in our previous SNP discovery study [<xref ref-type="bibr" rid="CR5">5</xref>] in which we designed the array with RNA-Seq performance. When parental dosages are estimated from RNA-Seq data, they might be affected by differential expression of alleles (e.g. if the true parental genotype is AABB and allele A is expressed three times as much as allele B, the SNP array will report genotype AABB but the RNA-Seq read counts will suggest AAAB). In order to account for that, the algorithm fits a series of models both without and with parental dosage data; the best model (lowest value for Bayesian Information Criterion) is selected. For brevity, we will refer to fitTetra 2.0 without the use of parental data as fitTetra2NP and to fitTetra 2.0 where parental genotypes were used to fix the mixing proportions and calculate starting means as fitTetra2P later on.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p id="Par23">We compared the performance of fitTetra 2.0 to fitTetra 1.0 and to the recently published ClusterCall [<xref ref-type="bibr" rid="CR4">4</xref>] software based on two large datasets. One dataset was published as supplemental data for the ClusterCall manuscript. The other set is described in the section below.</p>
    <sec id="Sec7">
      <title>Test dataset</title>
      <p id="Par24">The test set (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) comprised of 1000 randomly selected SNPs (with R base sample function [<xref ref-type="bibr" rid="CR15">15</xref>]) from the STub, an Affymetrix Axiom 60 k SNP array. Parental genotypes were derived from the RNA-Seq SNP discovery study that led to the creation of the array. For the two parents, 12 and 13 replicate samples were used. The analysis of the test set is shown in the vignette accompanying the package. Analysis of the whole array with all the versions of fitTetra is not yet published.</p>
      <p id="Par25">In order to judge if genotype calling was performed correctly we made use of the fact that our collection comprises a FS family and its parents. For each SNP that was called, we compared the estimated genotype proportions in the offspring to the expected proportions from each possible combination of parental genotypes (using a chi-squared test for goodness-of-fit). If the parental combination that best matched the estimated proportions agreed with the parental genotypes that resulted from genotype calling we called the SNP “matching”. If this was not true, or not possible to assess (i.e. dosage not assigned to one or both of parents) the SNP was marked as “not matching”.</p>
    </sec>
    <sec id="Sec8">
      <title>Parameter selection</title>
      <p id="Par26">We compared the performance of fitTetra 2.0 to fitTetra 1.0 and to the ClusterCall [<xref ref-type="bibr" rid="CR4">4</xref>] software. Both fitTetra and ClusterCall are sensitive to parameters used to perform the calling. For fitTetra, all default parameter settings were used, except for call.threshold = 0.75 and peak.threshold = 0.9.</p>
      <p id="Par27">In ClusterCall, the parameter min.posterior corresponds to the peak.threshold parameter of fitTetra and was initially set to the same value, 0.9. We tested number of values for min.posterior and max.range parameters. Based on the results we decided to use two values for min.posterior: 0.5 and 0.9 and one for max.range: 0.5. The code used for the parameter selection is attached in a form of an R script (Additional file <xref rid="MOESM3" ref-type="media">3</xref>) to assure easy replication of our results.</p>
      <p id="Par28">For the data from the ClusterCall paper [<xref ref-type="bibr" rid="CR4">4</xref>] we followed the instructions in the package vignette. We again applied fitTetra with all default parameters, except for call.threshold = 0.75 and peak.threshold = 0.9. Since for these data no other source for the parental dosages was available, the corresponding capabilities of fitTetra2P could not be applied. The code used for the analysis is attached in a form of an R script (Additional file <xref rid="MOESM4" ref-type="media">4</xref>) to assure easy replication of our results.</p>
    </sec>
    <sec id="Sec9">
      <title>Comparison between fitTetra and ClusterCall</title>
      <p id="Par29">We benchmarked versions of fitTetra and ClusterCall by comparing total number of SNPs called and the number of called SNPs where genotypes of parents and offspring matched. Since we called parents together with the offspring we also checked the number of “matching” SNPs called.</p>
      <p id="Par30">When tested on the fitTetra2 test data, fitTetra2P was able to call more SNPs than other versions of fitTetra, and also more than ClusterCall with both parameter settings (Table <xref rid="Tab2" ref-type="table">2</xref>). ClusterCall with min.posterior set to 0.5 was able to call more SNPs, but with a much lower proportion of “matching” SNPs. For this Axiom test data set all versions of fitTetra called more “matching” SNPs than ClusterCall.<table-wrap id="Tab2"><label>Table 2</label><caption><p>results of genotype calling on the test set of fitTetra 2.0</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>fitTetra1</th><th>fitTetra2NP</th><th>fitTetra2P</th><th>ClusterCall min.posterior = 0.9</th><th>ClusterCall, min.posterior = 0.5</th></tr></thead><tbody><tr><td>Called</td><td>63.4%</td><td>66.0%</td><td>69.0%</td><td>41.3%</td><td>77.0%</td></tr><tr><td> Matching</td><td>50.9%</td><td>57.4%</td><td>63.2%</td><td>20.5%</td><td>27.9%</td></tr><tr><td> Not matching</td><td>12.5%</td><td>8.8%</td><td>6.0%</td><td>20.8%</td><td>48.9%</td></tr><tr><td> Matching rate</td><td>80.3%</td><td>86.7%</td><td>91.3%</td><td>49.6%</td><td>36.3%</td></tr><tr><td>Not called</td><td>36.6%</td><td>34.0%</td><td>31.0%</td><td>58.7%</td><td>23.0%</td></tr><tr><td>  &gt; 90% in single category</td><td>13.7%</td><td>10.2%</td><td>12.3%</td><td>5.5%</td><td>1.9%</td></tr><tr><td>  &gt; 25% NAs</td><td>7.9%</td><td>20.9%</td><td>7.5%</td><td>–</td><td>–</td></tr><tr><td> No model</td><td>15.0%</td><td>2.7%</td><td>11.0%</td><td>53.2%</td><td>21.3%</td></tr></tbody></table></table-wrap></p>
      <p id="Par31">ClusterCall performs training on separate FS families and uses the power of multiple FS’s to score dosage in unrelated collections [<xref ref-type="bibr" rid="CR4">4</xref>]. In the fitTetra dataset however, there is only one large FS family and ClusterCall therefore cannot use concordance between families, and it performs worse than fitTetra.</p>
      <p id="Par32">Results of genotype calling on the test set of 1000 randomly selected probes included with fitTetra2. For ClusterCall the model is not fitted and when clustering is unsuccessful, the probe is returned with all scores missing so those were classified into “&gt;25% samples unscorable” category.</p>
      <p id="Par33">When tested on the ClusterCall test data fitTetra2NP was able to call more SNPs and showed similar but higher accuracy to ClusterCall (Table <xref rid="Tab3" ref-type="table">3</xref>). The data consists of three families. In all three fitTetra2NP was able to call more “matching” SNPs than ClusterCall, but in all the cases ClusterCall showed a higher proportion of “matching” calls.<table-wrap id="Tab3"><label>Table 3</label><caption><p>results of genotype calling on the test set of ClusterCall</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="3">fitTetra2NP</th><th colspan="3">ClusterCall</th></tr><tr><th>Fam.AxS</th><th>Fam.RxP</th><th>Fam.WxL</th><th>Fam.AxS</th><th>Fam.RxP</th><th>Fam.WxL</th></tr></thead><tbody><tr><td>Called</td><td>87.5%</td><td>69.9%</td><td>88.9%</td><td>66.9%</td><td>51.5%</td><td>68.1%</td></tr><tr><td> Matching</td><td>73.2%</td><td>54.6%</td><td>71.2%</td><td>60.1%</td><td>45.2%</td><td>59.7%</td></tr><tr><td> Not matching</td><td>14.3%</td><td>15.3%</td><td>17.6%</td><td>6.8%</td><td>6.3%</td><td>8.5%</td></tr><tr><td>Not called</td><td>12.5%</td><td>30.1%</td><td>11.1%</td><td>33.1%</td><td>48.5%</td><td>31.9%</td></tr><tr><td>  &gt; 90% in single category</td><td>10.3%</td><td>27.9%</td><td>9.0%</td><td>6.1%</td><td>21.5%</td><td>4.8%</td></tr><tr><td>  &gt; 25% NAs</td><td>0.0%</td><td>0.0%</td><td>0.0%</td><td>0.0%</td><td>0.0%</td><td>0.0%</td></tr><tr><td> No model</td><td>2.2%</td><td>2.1%</td><td>2.1%</td><td>27.1%</td><td>27.1%</td><td>27.1%</td></tr><tr><td>Proportion of matching calls</td><td>83.7%</td><td>78.1%</td><td>80.2%</td><td>89.9%</td><td>87.8%</td><td>87.6%</td></tr><tr><td>Average proportion</td><td colspan="3">80.6%</td><td colspan="3">88.4%</td></tr><tr><td>Average “matching”</td><td colspan="3">66.3%</td><td colspan="3">55.0%</td></tr></tbody></table></table-wrap></p>
      <p id="Par34">Results of genotype calling on the test dataset of ClusterCall. The calling was assessed for each of the three FS families separately. A x S – Atlantic x Superior, R x P – Rio Grande Russet x Premier Russet, W x L – Wauseon x Lenape.</p>
      <p id="Par35">Apart from the numbers of markers genotyped it is important to know the correctness of the genotyping. This is not straightforward as the true allele dosages are not known. However the overall correctness has an effect on downstream applications such as linkage mapping or GWAS. In Additional file <xref rid="MOESM5" ref-type="media">5</xref> we present a comparison of GWAS results obtained with the fitTetra 2 test data as processed by ClusterCall and fitTetra 2.0. These results suggest that at least for some markers near the main QTL, the fitTetra scores are more accurate than those of ClusterCall.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <sec id="Sec11">
      <title>Improvement over the previous version</title>
      <p id="Par36">We updated fitTetra to support multiple populations, to model expected FS segregation ratios and to enable the use of parental dosage information to guide the calling. We tested fitTetra 2.0 against fitTetra 1.0, and showed a significant improvement in the performance. Since the previous version of fitTetra was used in a number of studies and proved useful and applicable in multiple data sets [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], this improvement is likely to benefit many researchers performing genetic analyses of polyploid species.</p>
    </sec>
    <sec id="Sec12">
      <title>Comparison with ClusterCall</title>
      <p id="Par37">We compared fitTetra 1.0 and fitTetra 2.0 with ClusterCall. In all the instances ClusterCall was able to perform the analysis much faster while fitTetra 2.0 was able to call the most SNPs with matching parental and progeny dosages. When tested on the ClusterCall test data, fitTetra 2.0 and ClusterCall showed similar performance. On the fitTetra 2.0 test data however, fitTetra 2.0 outperformed ClusterCall by far. This is not surprising as the main advantage of ClusterCall is the use of concordance between multiple FS. Therefore, where multiple FS are present ClusterCall is able to deliver accurate results swiftly. The mixture model based algorithm of fitTetra is computationally costly but able to perform reliably in more types of datasets.</p>
    </sec>
    <sec id="Sec13">
      <title>Using the match between the genotypes of parents and offspring for quality control</title>
      <p id="Par38">We showed that checking if genotypes of parents and offspring match is a valuable quality check. Non-matching parental and offspring dosages are an important warning. They can signify an erroneous calling procedure (e.g. convergence to sub-optimal results), technical artefacts in the data but also potential sample mix-ups/mis-labelling.</p>
      <p id="Par39">A limitation of the use of this approach is that some segregation patterns may be impossible to distinguish in smaller datasets (e.g. 1:8:18:8:1 and 0:1:2:1:0), so an apparent (non-)match between parents and offspring may not be completely certain.</p>
    </sec>
    <sec id="Sec14">
      <title>Extensions of fitTetra 2.0</title>
      <p id="Par40">The version of fitTetra presented here is only able to perform genotype calling in autotetraploids. An extension to any higher level of auto-polyploidy has in the meantime been implemented in a more advanced version of the package called fitPoly, available from CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=fitPoly">https://cran.r-project.org/package=fitPoly</ext-link>). The extension to allo-polyploids is less straightforward since some parental dosage combinations match with multiple segregation ratios.</p>
      <p id="Par41">Another possible extension would be the accommodation of (discrete) read count data from Next-Generation Sequencing, as opposed to (continuous) signal intensities from SNP arrays. This would involve a different model for the distribution of the data. However, recently several publications have already addressed this problem [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. In [<xref ref-type="bibr" rid="CR18">18</xref>] a comparison between the updog package and fitPoly was made. Not surprisingly fitPoly performed worse, as it was not designed to handle this type of data.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par42">The package fitTetra 2.0 provides the most robust approach for automated genotype calling in complex collections of autotetraploid samples. The tool is able to call large portion of SNPs correctly, even with strong confounding effects e.g. background signal, differences in performance between dyes or non-linear relationship between dosage and signal strength. Our tool is the most versatile and accurate solution for automated genotype calling in tetraploids.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p id="Par43">• Project name: fitTetra</p>
    <p id="Par44">• Operating system(s): Any platform for which the R [<xref ref-type="bibr" rid="CR15">15</xref>] software is implemented, including Microsoft Windows and Linux. The software is included as an R package in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <p id="Par45">• Programming language: R [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par46">• Other requirements: None.</p>
    <p id="Par47">• License: GNU General Public License, version 2.</p>
    <p id="Par48">• Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec id="Sec17">
    <title>Dataset</title>
    <p id="Par49">The test set comprises 1000 SNPs randomly selected from a custom Affymetrix Axiom 60 k SNP array. The population that was genotyped consisted of 1502 samples – 975 samples of the tetraploid FS population, 278 samples of the diploid FS population, parents of the tetraploid FS population in 12 and 13 replicates, parents of the diploid FS population in 3 and 2 replicates and 222 samples from a panel of breeding clones and market cultivars. The data set is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2703_MOESM1_ESM.gz">
            <label>Additional file 1:</label>
            <caption>
              <p>A tar archive containing fitTetra 2.0 package. (GZ 46494 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2703_MOESM2_ESM.zip">
            <label>Additional file 2:</label>
            <caption>
              <p>A zip archive containing all the data and code needed to run the comparisons. (ZIP 33420 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_2703_MOESM3_ESM.r">
            <label>Additional file 3:</label>
            <caption>
              <p>An R script containing all the code needed to run comparison between ClusterCall and fitTetra 2.0 on the dataset attached to fitTetra 2.0. (R 3 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_2703_MOESM4_ESM.r">
            <label>Additional file 4:</label>
            <caption>
              <p>An R script containing all the code needed to run comparison between ClusterCall and fitTetra 2.0 on the dataset attached to the ClusterCall manuscript. (R 6 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_2703_MOESM5_ESM.docx">
            <label>Additional file 5:</label>
            <caption>
              <p>A small report of a GWAS analyses to compare the correctness of dosage calls by ClusterCall and fitTetra 2.0. (DOCX 531 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the Dutch Carbohydrate Competence Center, which is co-financed by the European Regional Development Fund, the Dutch Ministry of Economic Affairs (as part of Pieken in de Delta, the government’s regional economic agenda), the Municipality of Groningen and the Province of Groningen [CCC WP23 to KZ and RCJ].</p>
    <p>Funding for GG, REV and CM was provided through the Dutch Topsector Horticulture &amp; Starting Materials (TKI) projects “A genetic analysis pipeline for polyploid crops”, project number BO-26.03-002-001 and “Novel genetic and genomic tools for polyploid crops”, project number BO-26.03-009-004.</p>
    <sec id="FPar1" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par50">The software package is included as Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The test data are included as Additional file <xref rid="MOESM2" ref-type="media">2</xref>. The R scripts for performing the tests and comparisons are included as Additional files <xref rid="MOESM3" ref-type="media">3</xref> and <xref rid="MOESM4" ref-type="media">4</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>REV and GG conceived the idea of the algorithm and wrote the code. KZ and RCJ added code for use of parental genotypes to guide the calling and provided the genotype data. KZ finalized the code and documentation of the package, analyzed the data and drafted the manuscript. All the authors contributed to the text of the manuscript, development of the algorithm and discussion. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar2">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar3">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gidskehaug</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Lien</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Genotype calling and mapping of multisite variants using an Atlantic salmon iSelect SNP array</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>303</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Gort</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vosman</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genotype calling in tetraploid species from bi-allelic marker data using mixture models</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>172</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-172</pub-id>
        <pub-id pub-id-type="pmid">21595880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serang</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Mollinari</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>AAF</given-names>
          </name>
        </person-group>
        <article-title>Efficient exact maximum a posteriori computation for bayesian SNP genotyping in polyploids</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e30906</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030906</pub-id>
        <pub-id pub-id-type="pmid">22363513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carley</surname>
            <given-names>CAS</given-names>
          </name>
          <name>
            <surname>Coombs</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Douches</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bethke</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Palta</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Novy</surname>
            <given-names>RG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated tetraploid genotype calling by hierarchical clustering</article-title>
        <source>Theor Appl Genet</source>
        <year>2017</year>
        <volume>130</volume>
        <fpage>717</fpage>
        <lpage>726</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-016-2845-5</pub-id>
        <pub-id pub-id-type="pmid">28070610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Vos PG, Uitdewilligen JGAML, Voorrips RE, Visser RGF, van Eck HJ. Development and analysis of a 20K SNP array for potato (Solanum tuberosum): an insight into the breeding history. TAG Theor Appl Genet Theor Angew Genet 2015.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Infinium iSelect Custom Genotyping Assays - technote_iselect_design.pdf. <ext-link ext-link-type="uri" xlink:href="https://www.illumina.com/content/dam/illumina-marketing/documents/products/technotes/technote_iselect_design.pdf">https://www.illumina.com/content/dam/illumina-marketing/documents/products/technotes/technote_iselect_design.pdf</ext-link>. Accessed 9 Oct 2017.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Axiom Genotyping Solution for Agrigenomics. <ext-link ext-link-type="uri" xlink:href="https://www.thermofisher.com/de/de/home/life-science/microarray-analysis/agrigenomics-solutions-microarrays-gbs/axiom-genotyping-solution-agrigenomics.html">https://www.thermofisher.com/de/de/home/life-science/microarray-analysis/agrigenomics-solutions-microarrays-gbs/axiom-genotyping-solution-agrigenomics.html</ext-link>. Accessed 8 Sep 2017.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piepho</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Codominant analysis of banding data from a dominant marker system by normal mixtures</article-title>
        <source>Genetics.</source>
        <year>2000</year>
        <volume>155</volume>
        <fpage>1459</fpage>
        <lpage>1468</lpage>
        <?supplied-pmid 10880503?>
        <pub-id pub-id-type="pmid">10880503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Geerlings</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Oeveren</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Van Schaik</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>A comment on codominant scoring of AFLP markers</article-title>
        <source>Genetics.</source>
        <year>2001</year>
        <volume>158</volume>
        <fpage>925</fpage>
        <lpage>926</lpage>
        <?supplied-pmid 11430354?>
        <pub-id pub-id-type="pmid">11430354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Gort G, van Eeuwijk FA. Codominant scoring of AFLP in association panels. TAG Theor Appl Genet Theor Angew Genet. 2010;121:337–351.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uitdewilligen</surname>
            <given-names>JGAML</given-names>
          </name>
          <name>
            <surname>Wolters</surname>
            <given-names>A-MA</given-names>
          </name>
          <name>
            <surname>D’hoop</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Borm</surname>
            <given-names>TJA</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>RGF</given-names>
          </name>
          <name>
            <surname>van Eck</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>A next-generation sequencing method for genotyping-by-sequencing of highly heterozygous autotetraploid potato</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e62355</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062355</pub-id>
        <pub-id pub-id-type="pmid">23667470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Obidiegwu</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Sanetomo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Flath</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tacke</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hofferbert</surname>
            <given-names>H-R</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic architecture of potato resistance to Synchytrium endobioticum disentangled using SSR markers and the 8.3k SolCAP SNP genotyping array</article-title>
        <source>BMC Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>38</fpage>
        <pub-id pub-id-type="doi">10.1186/s12863-015-0195-y</pub-id>
        <pub-id pub-id-type="pmid">25887883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourke</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Voorrips</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>RGF</given-names>
          </name>
          <name>
            <surname>Maliepaard</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The double-reduction landscape in tetraploid potato as revealed by a high-density linkage map</article-title>
        <source>Genetics.</source>
        <year>2015</year>
        <volume>201</volume>
        <fpage>853</fpage>
        <lpage>863</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.115.181008</pub-id>
        <pub-id pub-id-type="pmid">26377683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mosquera</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Jiménez-Gómez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Muktar</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Paulo</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Steinemann</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Targeted and untargeted approaches unravel novel candidate genes and diagnostic SNPs for quantitative resistance of the potato (Solanum tuberosum L.) to Phytophthora infestans causing the late blight disease</article-title>
        <source>PLoS One</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>e0156254</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0156254</pub-id>
        <pub-id pub-id-type="pmid">27281327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. 2016. R version 3.3.2.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maruki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genotype calling from population-genomic sequencing data</article-title>
        <source>G3</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1393</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.117.039008</pub-id>
        <pub-id pub-id-type="pmid">28108551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blischak</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Kubatko</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>SNP genotyping and parameter estimation in polyploids using low-coverage sequencing data</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>407</fpage>
        <lpage>415</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx587</pub-id>
        <pub-id pub-id-type="pmid">29028881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Gerard D, Ferrão LPV, Garcia AAF, Stephens M. Genotyping polyploids from messy sequencing data. Genetics. 2018:789–807.</mixed-citation>
    </ref>
  </ref-list>
</back>
