<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.2 20060430//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub May-5-2007?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1933196</article-id>
    <article-id pub-id-type="pmid">17483517</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkm265</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Gibbs Centroid Sampler</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thompson</surname>
          <given-names>William A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Newberg</surname>
          <given-names>Lee A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conlan</surname>
          <given-names>Sean</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McCue</surname>
          <given-names>Lee Ann</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawrence</surname>
          <given-names>Charles E.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Center for Computational Molecular Biology and the Division of Applied Mathematics, Brown University, Providence, RI 02912, USA, <sup>2</sup>The Wadsworth Center, New York State Department of Health, Albany, NY 12201, USA, <sup>3</sup>Department of Computer Science, Rensselaer Polytechnic Institute, Troy, NY 12180, USA, <sup>4</sup>Columbia University, New York, NY 10032, USA and <sup>5</sup>Pacific Northwest National Laboratory, Richland, WA 99352, USA</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed: <phone>+1-401-863-2048</phone><email>william_thompson_l@brown.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>5</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>5</month>
      <year>2007</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
						epub date downloaded from Highwire. -->
    <volume>35</volume>
    <issue>Web Server issue</issue>
    <fpage>W232</fpage>
    <lpage>W237</lpage>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2007</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>3</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2007 The Author(s)</copyright-statement>
      <copyright-year>2007</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The Gibbs Centroid Sampler is a software package designed for locating conserved elements in biopolymer sequences. The Gibbs Centroid Sampler reports a centroid alignment, i.e. an alignment that has the minimum total distance to the set of samples chosen from the <italic>a posteriori</italic> probability distribution of transcription factor binding-site alignments. In so doing, it garners information from the full ensemble of solutions, rather than only the single most probable point that is the target of many motif-finding algorithms, including its predecessor, the Gibbs Recursive Sampler. Centroid estimators have been shown to yield substantial improvements, in both sensitivity and positive predictive values, to the prediction of RNA secondary structure and motif finding. The Gibbs Centroid Sampler, along with interactive tutorials, an online user manual, and information on downloading the software, is available at: <ext-link ext-link-type="uri" xlink:href="http://bayesweb.wadsworth.org/gibbs/gibbs.html">http://bayesweb.wadsworth.org/gibbs/gibbs.html</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>The identification of transcription factor binding sites (TFBSs) in the promoters of genes is a critical step in the delineation of the genetic regulatory network of an organism. A number of motif discovery algorithms have been developed over the past decade and a half, for the detection of <italic>cis</italic>-regulatory sites (<xref ref-type="bibr" rid="B1">1</xref>). Most of these algorithms depend, in one way or another, on finding an optimal alignment of motif sites. In this article, we describe the web server for an improved motif discovery algorithm, the Gibbs Centroid Sampler, which finds a centroid alignment. The centroid alignment is the alignment that has the minimum total distance to the set of samples chosen from the <italic>a posteriori</italic> probability distribution of TFBS alignments. By focusing on the region of solution space containing the most posterior probability, rather than on the single solution that is most probable, this approach significantly enhances the predictive power of the algorithm. In computational experiments using simulated proteobacterial and yeast data (<xref ref-type="bibr" rid="B2">2</xref>), the centroid sampler showed improved specificity and positive predictive value over algorithms that report an optimal solution.</p>
    <p>The Gibbs Centroid Sampler is an improved version of the Gibbs Recursive Sampler (<xref ref-type="bibr" rid="B3">3</xref>), which has been used extensively in the identification of TFBSs (<xref ref-type="bibr" rid="B4 B5 B6 B7 B8">4–8</xref>), and has been available at our Web site for some time (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B9">9</xref>). The software currently available at the Web site retains all of the features of the previous versions, including searches for multiple motif types, multiple instances (sites) of a motif, palindromic motifs, motifs of varying widths and a heterogeneous background frequency model (see (<xref ref-type="bibr" rid="B3">3</xref>) for descriptions of these and other features). The users’ choices of options are entered through a web form, described below, and the output is returned to the user via e-mail. In addition to the new algorithmic features, the Web site has been updated to include extensive tutorials on the use of the Gibbs sampling software for prokaryotic phylogenetic footprinting and for the analysis of prokaryotic co-expression data.</p>
    <sec>
      <title>The Gibbs Centroid Sampler</title>
      <p>A key feature of most sequence-based Gibbs sampling and expectation maximization algorithms (<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>), is the use of a probabilistic score that is maximized. Typically, the alignment that has the maximum of this score is reported to the user. Previous versions of the Gibbs Sampler used the posterior probability of the alignment, called the MAP (maximum <italic>a posteriori</italic> probability) (<xref ref-type="bibr" rid="B12">12</xref>), as a measure of the quality of the alignment, and thus the alignment that produced the highest posterior probability (i.e. the MAP alignment) was returned. The reported MAP was calculated as the logarithm of the alignment probability minus the logarithm of an empty or background alignment. Thus, the reported value was a measure of the extent to which a particular alignment was better than background.</p>
      <p>The use of methods such as this, which seek to obtain global or local optimal solutions to inference problems, is common in computational biology. Typically, however, the probability of even the best arrangement of motif sites is extremely small. That is, since motif detection is a high-dimensional problem, from a Bayesian viewpoint, the data likelihood will contain an immense number of terms, of which the optimal solution is simply one. From this perspective, the question arises, ‘How representative is the optimum when its probability is very small compared to the overall probability mass?’</p>
      <p>It has been shown in RNA secondary structure prediction (<xref ref-type="bibr" rid="B13">13</xref>) and TFBS discovery algorithms (<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B14">14</xref>) that reliance on the optimal solution can be misleading and can adversely affect prediction accuracy. Specifically, Ding <italic>et al</italic>. (<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B15">15</xref>) showed that centroid estimates reduced errors in RNA secondary structure prediction by 30%, while simultaneously improving sensitivity, and Newberg <italic>et al</italic>. (<xref ref-type="bibr" rid="B2">2</xref>) showed similar substantial improvements over algorithms finding local optima for TFBS discovery in sequences from phylogenetically closely related species. Centroid solutions garner information from the full ensemble of solutions, while MAP solutions focus exclusively on the single most probable point.</p>
    </sec>
    <sec>
      <title>The centroid sampling algorithm</title>
      <p>The user supplies to the algorithm a collection of sequences in FASTA format and enters several parameters, such as motif widths, as described below. The centroid algorithm begins in a manner similar to previous Gibbs sampling algorithms. It is initialized with a, typically random, alignment. From this alignment, motif models are calculated (<xref ref-type="bibr" rid="B12">12</xref>). The sampling procedure then proceeds through the following steps:
<list list-type="roman-lower"><list-item><p>A sequence is selected, and the probability of each possible number of sites, up to the maximum specified by the user, is calculated based on the current model;</p></list-item><list-item><p>the number of sites is sampled;</p></list-item><list-item><p>the predicted positions and types of the sites are sampled based on their probabilities, calculated as described by Thompson <italic>et al</italic>. (<xref ref-type="bibr" rid="B3">3</xref>);</p></list-item><list-item><p>the motif models are updated based on the sampled sites in all sequences.</p></list-item></list></p>
      <p>An iteration of the algorithm consists of the completion of Steps 1–4 for each sequence. In previous versions, this process repeated until the MAP failed to increase for a fixed number of iterations. To obtain a sampling solution, we allow the algorithm to repeat the above procedure through a burn-in period, typically 2000 iterations. The burn-in period is required for the sampler to move away from transient effects of the particular initial conditions. After the burn-in period, the sampler proceeds, again through a fixed number of iterations (typically 8000). During this sampling process, the algorithm tracks each sampled position. The entire process (burn-in and sampling iterations) is repeated with a number of different random starting alignments called ‘seeds’. By default, 20 seeds are used. The samples from each seed are accumulated, and a centroid alignment solution is obtained from the accumulated samples; the centroid is the alignment that minimizes the sum of the pair-wise distances between it and each of the alignments in the collection. Thus, the centroid is defined in terms of a distance measure between pairs of proposed alignments. The centroid alignment is calculated via a dynamic programming algorithm.</p>
      <p>In previous versions of the sampler, the model update step (Step 4 above) was accomplished using the predictive update method (<xref ref-type="bibr" rid="B12">12</xref>). The centroid sampler performs the model update step by sampling a new model from the posterior Dirichlet distribution of motif or background models. Starting with the existing model Θ, the algorithm draws a new model, Θ<italic><sub>p</sub></italic>, using the motif or background counts from <italic>Dir</italic> (<italic>c</italic> + β), where <italic>Dir</italic> is the Dirichlet distribution, and <italic><bold>c</bold></italic> and <bold>β</bold> are the current count and pseudo-count vectors. While predictive update works when at most one new binding site is chosen between motif model updates, it is not entirely appropriate in the present context, where multiple binding sites are chosen between model updates. This new model update method is of greatest value in the identification of sites among aligned sequences derived from multiple phylogenetically related species (<xref ref-type="bibr" rid="B2">2</xref>).</p>
    </sec>
    <sec>
      <title>The Gibbs Sampler Web Site</title>
      <p>The Gibbs Sampler Web site consists of three layers, each offering an increasing number of options for control of the sampling process. The first page, shown in <xref ref-type="fig" rid="F1">Figure 1</xref>, allows the user to input sequences, select the version of the Gibbs Sampler, and control the basic motif parameters (<xref ref-type="bibr" rid="B16">16</xref>). While we continue to make earlier versions available for selection on this page, in most circumstances the centroid sampler should return better results (<xref ref-type="bibr" rid="B2">2</xref>). An e-mail address, a set of sequences in FASTA format, an optional initial guess of the total number of sites, the number of conserved positions in the motif sites, and the maximum allowable number of sites in any one sequence are entered on this page. The estimate of the number of sites affects the initial starting solution for the burn-in process. If it is not supplied, the default of one site for each motif type for each sequence is used. We have found this default adequate for most datasets, and the centroid sampler is relatively insensitive to reasonably small changes in this value. The number of conserved positions in the motif model(s) is a required parameter. This value sets the minimum width of the predicted sites, although sites may fragment to a greater width by the inclusion of non-conserved positions (<xref ref-type="bibr" rid="B12">12</xref>). Motif widths for multiple models can be entered, although it is best to use no more motif models than is reasonable given the number of expected TFBS types. Increasing the number of motif models beyond the number of relevant site types should not adversely affect the solutions, if the number of burn-in and sample iterations is adequate (described below), because extra models will not sample sites sufficiently to be included in the centroid. However, as the number of models increases, the program runtime increases (described below). The maximum number of sites in a single sequence is also a required parameter for the centroid sampler. The value entered for this parameter should be based on knowledge of the biological system under study. For example, when analyzing bacterial intergenic sequences for TFBSs, a value of two or three is typically used, whereas for eukaryotic data, this number is typically set higher. This parameter sets the maximum for the total sum of all motif sites in any one sequence. The sequence data can be pasted into the entry window or uploaded from a file. Each entry field has an associated hyperlink, which leads to a page describing the required data format. From this entry screen, default options will be automatically selected for the sampling parameters. The defaults for the centroid sampler include the use of a heterogeneous background model (<xref ref-type="bibr" rid="B16">16</xref>), 20 random seeds, a burn-in period of 2000 iterations and a sampling period of 8000 iterations.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>The basic Gibbs Centroid Sampler entry screen.</p></caption><graphic xlink:href="gkm265f1"/></fig></p>
    </sec>
    <sec>
      <title>Control of sampling parameters</title>
      <p>Selection of the ‘Show Advanced Options’ link opens a page with several more options (<xref ref-type="fig" rid="F2">Figure 2</xref>). Most of these, such as options for palindromic models, fragmentation, the Wilcoxon signed-rank test and the number of random seeds, are available for all sampling modes (site, motif, recursive and centroid) and have been described earlier (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B9">9</xref>) New options for controlling the behavior of the centroid sampler are now also presented on this page. The ‘Burn-in Period’ and ‘Samples’ fields control the numbers of burn-in and sampling iterations for each seed; these fields are disabled when non-centroid sampling modes are selected. Initially, when the centroid sampler is selected, the ‘Burn-in Period’ and ‘Samples’ fields contain default values. We have found the defaults of 2000 iterations for burn-in and 8000 sampling iterations to be broadly applicable for prokaryotic or eukaryotic data of modest size. However, for small datasets, in the order of 10 to 20 sequences, each of &lt;200 nucleotides, our experience has shown that the burn-in and sample iterations can be reduced (to 1000 and 4000, respectively) without adversely affecting the results. Conversely, for large datasets (&gt;50 sequences, each of 5000 to 10,000 nucleotides) where the TFBS are likely short and not well conserved, as is common in eukaryotic sequences, the number of iterations should be increased for both parameters.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>The Gibbs Centroid ‘Advanced options’ entry page.</p></caption><graphic xlink:href="gkm265f2"/></fig></p>
      <p>It is important to note a difficulty that can arise when the centroid sampler is used with multiple motif models; specifically, the non-indentifiability of models from finite mixtures, stemming from label switching (<xref ref-type="bibr" rid="B17">17</xref>) among the various restarts of the algorithm. Gibbs sampling is inherently a stochastic procedure; in order to avoid being trapped in regions of low probability, the sampling process is restarted a number of different times with different starting seeds. When multiple motif models are used, the separate seeds can converge to similar solutions, with different orderings of the motif models. For example, in the case of two motif models, a particular seed may converge to a set of sites for model A and sites for model B. Another seed may converge to the same overall collection of sites, but with the sites previously labeled as model A now labeled as model B, and sites previously labeled as model B now labeled as model A. The centroid solution is obtained by summing the number of times a given position (i.e. site) is sampled across all restarts and models, which means that sites from multiple models are not separated in the output. Furthermore, different fragmentation models (<xref ref-type="bibr" rid="B12">12</xref>) can be generated among the different seed runs, giving rise to a collection of centroid sites that differ in length, and making it difficult to visualize the TFBSs in a more traditional probability matrix representation.</p>
      <p>To address these two difficulties, the selection of the ‘Align Centroid Model’ option causes the Gibbs Centroid Sampler to use the Gibbs Recursive Sampler to align the collection of centroid sites. In the case of multiple models, this process will separate the sites into related groups, and thus aid identification of the different site types. This process can also give the user insight into which positions in the models are highly conserved. It is important to note that the resulting alignment is neither a MAP alignment nor a centroid alignment of the complete set of data sequences. It is provided only to lend additional insight into the centroid solution.</p>
    </sec>
    <sec>
      <title>Program output</title>
      <p>Program output is returned via e-mail. The initial portion of the Gibbs Centroid Sampler output is identical to that of the other versions of the sampler, simply providing a list of the options used for the current run, followed by a list of the FASTA headings for the input sequences (see (<xref ref-type="bibr" rid="B3">3</xref>) for an example). Following these is the list of the sites making up the centroid model. <xref ref-type="fig" rid="F3">Figure 3</xref> shows the results for a set of 18 <italic>Escherichia coli</italic> sequences; these sequences are well studied, known to contain binding sites for the cyclic AMP receptor protein (Crp) (<xref ref-type="bibr" rid="B11">11</xref>), and are provided as a test dataset when the Gibbs Sampler software is downloaded. The results in <xref ref-type="fig" rid="F3">Figure 3</xref> were generated using the centroid sampler with a motif width of 16, a palindromic motif model requirement, a maximum number of sites per sequence of two, heterogeneous background composition, the default number of restarts (20 seeds), the default burn-in (2000 iterations) and the default centroid sampling periods (8000 iterations). The motif models were allowed to fragment to a width of 24 bases.
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Output from the Gibbs Centroid Sampler.</p></caption><graphic xlink:href="gkm265f3a"/><graphic xlink:href="gkm265f3b"/></fig></p>
      <p>At the top of <xref ref-type="fig" rid="F3">Figure 3</xref> is the set of sites making up the centroid; the centroid sites are listed in upper case, and flanking positions are in lower case. The sites correspond well with the DNaseI footprinted sites for these sequences (<xref ref-type="bibr" rid="B11">11</xref>). The variation in the length of the sites is a result of different fragmentation models generated during the sampling periods (mentioned above). The dynamic program that calculates the centroid can be found elsewhere [see the supplementary material for (<xref ref-type="bibr" rid="B2">2</xref>)]. The legend below the list of sites identifies the various columns of the output. The probability column shows the sampling frequencies for these sites. These sampling frequencies are an estimate of the probabilities that the cognate transcription factors bind at the predicted sites.</p>
      <p>The second part of <xref ref-type="fig" rid="F3">Figure 3</xref> shows an alignment of the centroid sites. The program generates this alignment by taking the collection of sites in the centroid, plus their flanking sequences, and using the Gibbs Recursive Sampler to find the best alignment among this set of sites, with at most one site in each sequence. As such, this is neither a centroid nor an optimal alignment. It is provided simply to allow the user to identify different site types (when multiple motif models were used) and to visualize which positions are highly conserved in the centroid sites. The format of this alignment is identical to that of the Gibbs Recursive Sampler previously described in (<xref ref-type="bibr" rid="B3">3</xref>).</p>
    </sec>
    <sec>
      <title>Performance</title>
      <p>The underlying algorithm for the Gibbs Centroid Sampler and the Gibbs Recursive Sampler is a forward–backward algorithm (<xref ref-type="bibr" rid="B7">7</xref>). The forward step is the most compute intensive part of the algorithm, with runtime increasing as the square of the length of the individual sequences; thus, the most important factor affecting runtime is the length of the individual sequences. Other parameters, such as the number of sequences, the number of motif models, the number of seeds and the number of iterations, affect the runtime linearly. Therefore, due to the increased number of iterations for burn-in and sampling, the runtime of the centroid sampler is somewhat greater than that of the Gibbs Recursive Sampler. Additional parameters, such as the use of palindromic or direct repeat models, while not directly affecting the runtime of the centroid sampler, greatly improve its ability to discover realistic TFBS by taking into account the biological characteristics of the system under study. The program lists the total execution time for the program as the last line of the output.</p>
    </sec>
    <sec>
      <title>Web-based tutorials</title>
      <p>The Gibbs Sampler Web site contains tutorials for prokaryotic phylogenetic footprinting (<ext-link ext-link-type="uri" xlink:href="http://bayesweb.wadsworth.org/web_help.PF.html">http://bayesweb.wadsworth.org/web_help.PF.html</ext-link>) and for analysis of prokaryotic co-expression data from microarray and promoter fusion experiments (<ext-link ext-link-type="uri" xlink:href="http://bayesweb.wadsworth.org/web_help_text.CE.html">http://bayesweb.wadsworth.org/web_help_text.CE.html</ext-link>). Links to these pages are provided on the main Gibbs entry pages. The tutorials provide guidance to users for all the sampling modes available (site, motif, recursive and centroid), and for both the Gibbs Sampler web server and the stand-alone version of Gibbs. Specifically, the Gibbs Sampler offers a large array of options, some of which are used to model-specific aspects of biological sequences, while others are meant to control details of how the sampling is done. The tutorials focus on the options that are useful in modeling the biology of transcription regulation. The particular examples presented in the tutorials are drawn from the studies presented in (<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B18">18</xref>). Each tutorial gives the command line used to run the analysis, a description of each parameter and why its particular value was chosen, and a link that will automatically run the data on the Gibbs Web site with the Gibbs Centroid Sampler or with the Gibbs Recursive Sampler. The data from the examples can also be downloaded to be run with the stand-alone version. It is important to note that Gibbs sampling is a stochastic process, and thus results run from the links may differ slightly from the examples. In addition, although the examples in these interactive tutorials use prokaryotic sequence data, the principles described and the reasoning behind how to choose parameters are species-independent; all sampling modes, including the Gibbs Centroid Sampler, can be readily applied to the analysis of eukaryotic sequences.</p>
      <p>The tutorials, besides presenting detailed examples of the use of the Gibbs software, provide insights into the interpretation of, and biological reasoning behind, the computational experiments. The tutorial examples illustrate how solutions from MAP-based samplers sometimes include low probability sites in the solution. These sites increase the MAP slightly but may be false positive predictions. The centroid sampler avoids these low probability predictions and is thus less likely to make false positive predictions (<xref ref-type="bibr" rid="B2">2</xref>). This is illustrated in the tutorial example, ‘Co-expression data from a microarray study of <italic>M. tuberculosis</italic> genes’, where the data comes from microarray results (<xref ref-type="bibr" rid="B18">18</xref>) that report a set of co-expressed genes, a subset of which are likely co-regulated by a common transcription factor. When the Gibbs Recursive Sampler is used on the upstream sequences from these co-expressed genes, the results include several sites with low probability in the MAP solution, whereas the Gibbs Centroid Sampler avoids these low probability sites. The fully Bayesian sampling process that is performed by the Gibbs Centroid Sampler is more robust at eliminating these likely false-positive predictions (<xref ref-type="bibr" rid="B2">2</xref>) than the process employed in previous versions of the sampler, where, once a MAP solution was found, the sampler was allowed (as an option) to sample among high probability sites in order to find sites which were sampled reproducibly (i.e. the frequency solution) (<xref ref-type="bibr" rid="B3">3</xref>). Since we began using centroid estimates, we have discovered that the inclusion of steps that even partially increase focus on MAP (or near MAP) solutions have a detrimental impact on the correct identification of sites.</p>
    </sec>
    <sec>
      <title>Additional features</title>
      <p>The Gibbs Centroid Sampler can be used for the analysis of amino-acid sequences. The link from the main Gibbs Web site page leads to a page allowing the entry of amino-acid sequences. The Web site also contains a link to an online user guide, which describes the various parameters and their input formats, has detailed descriptions of the output and lists possible error messages and their causes. The Gibbs Sampler Web site allows a maximum of 1000 sequences of no longer than 10,000 nucleotides in length. Users with larger datasets are directed to use the stand-alone version of the Gibbs Sampler.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The research is supported by the United States Department of Energy grant DE-FG02-04ER63942 to C.E.L. and L.A.M., and the United States National Institutes of Health grants R01-HG01257 to CEL, 2P20-RR01-5578-06 to Walter Atwood, and K25-HG003291 to L.A.N. The assistance of the Wadsworth Center Bioinformatics Core Facility and the Brown University Center for Computational Molecular Biology is greatly appreciated. PNNL is operated by Battelle for the US Department of Energy under Contract DE-AC06-76RLO 1830. Funding to pay the Open Access publication charges for this article was provided by Department of Energy grant DE-FG02-04ER63942.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandve</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Drablos</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A survey of motif discovery methods in an integrated framework</article-title>
        <source>Biology Direct</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="pmid">16600018</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newberg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Conlan</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>A phylogenetic Gibbs sampler that yields centroid solutions for <italic>cis</italic> regulatory site prediction</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <comment>Accepted</comment>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rouchka</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Gibbs Recursive Sampler: finding transcription factor binding sites</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3580</fpage>
        <lpage>3585</lpage>
        <pub-id pub-id-type="pmid">12824370</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conlan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Rhodopseudomonas palustris Regulons Detected by Cross-Species Analysis of Alphaproteobacterial Genomes</article-title>
        <source>Appl. Environ. Microbiol</source>
        <year>2005</year>
        <volume>71</volume>
        <fpage>7442</fpage>
        <lpage>7452</lpage>
        <pub-id pub-id-type="pmid">16269786</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCue</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carmack</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Derbyshire</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic footprinting of transcription factor binding sites in proteobacterial genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>774</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="pmid">11160901</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Carmack</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Factors influencing the identification of transcription factor binding sites by cross-species comparison</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1523</fpage>
        <lpage>1532</lpage>
        <pub-id pub-id-type="pmid">12368244</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Palumbo</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Decoding Human Regulatory Circuits</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1967</fpage>
        <lpage>1974</lpage>
        <pub-id pub-id-type="pmid">15466295</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Florczyk</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Purkayastha</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Currenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wolin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>McDonough</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>A Family of acr-Coregulated Mycobacterium tuberculosis Genes Shares a Common DNA Motif and Requires Rv3133c (dosR or devR) for Expression</article-title>
        <source>Infect. Immun</source>
        <year>2003</year>
        <volume>71</volume>
        <fpage>5332</fpage>
        <lpage>5343</lpage>
        <pub-id pub-id-type="pmid">12933881</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Baxevanis</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Davison</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>RDM</given-names>
          </name>
          <name>
            <surname>Petsko</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <source>Current Protocols in Bioinformatics</source>
        <year>2005</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>John Wiley &amp; Sons, Inc</publisher-name>
        <fpage>2.8.1</fpage>
        <lpage>2.8.38</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Elkan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised Learning of Multiple Motifs in Biopolymers using EM</article-title>
        <source>Mach Learn</source>
        <year>1995</year>
        <volume>21</volume>
        <fpage>51</fpage>
        <lpage>80</lpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>An expectation maximization (EM) algorithm for the identification and characterization of common sites in unaligned biopolymer sequences</article-title>
        <source>Proteins: Struct. Funct. Genet</source>
        <year>1990</year>
        <volume>7</volume>
        <fpage>41</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="pmid">2184437</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neuwald</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Bayesian models for multiple local sequence alignment and Gibbs sampling strategies</article-title>
        <source>JASA</source>
        <year>1995</year>
        <volume>90, 432</volume>
        <fpage>1156</fpage>
        <lpage>1170</lpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>YE</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction by centroids in a Boltzmann weighted ensemble</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1157</fpage>
        <lpage>1166</lpage>
        <pub-id pub-id-type="pmid">16043502</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Conlan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bergman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <source>Methods in Molecular Biology, Comparative Genomics</source>
        <year>2007</year>
        <volume>1</volume>
        <publisher-name>Humana Press</publisher-name>
        <fpage>403</fpage>
        <lpage>423</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Clustering of RNA Secondary Structures with Application to Messenger RNAs</article-title>
        <source>J Mol. Biol</source>
        <year>2006</year>
        <volume>359</volume>
        <fpage>554</fpage>
        <pub-id pub-id-type="pmid">16631786</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference on biopolymer models</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>38</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="pmid">10068691</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Dealing with label switching in mixture models</article-title>
        <source>J. R. Stat. Soc.: Series B (Statistical Methodology)</source>
        <year>2000</year>
        <volume>62</volume>
        <fpage>795</fpage>
        <lpage>809</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherman</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Voskuil</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schnappinger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harrell</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Schoolnik</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Regulation of the Mycobacterium tuberculosis hypoxic response gene encoding alpha -crystallin</article-title>
        <source>PNAS</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>7534</fpage>
        <lpage>7539</lpage>
        <pub-id pub-id-type="pmid">11416222</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
