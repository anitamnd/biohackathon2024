<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9048669</article-id>
    <article-id pub-id-type="pmid">35274679</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac156</article-id>
    <article-id pub-id-type="publisher-id">btac156</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiCARN: resolution enhancement of Hi-C data using cascading residual networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hicks</surname>
          <given-names>Parker</given-names>
        </name>
        <aff><institution>Department of Biology, Concordia University Irvine</institution>, Irvine, CA 92612, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5264-2342</contrib-id>
        <name>
          <surname>Oluwadare</surname>
          <given-names>Oluwatosin</given-names>
        </name>
        <xref rid="btac156-cor1" ref-type="corresp"/>
        <aff><institution>Department of Computer Science, University of Colorado</institution>, Colorado Springs, CO 80918, <country country="US">USA</country></aff>
        <!--ooluwada@uccs.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac156-cor1">To whom correspondence should be addressed. <email>ooluwada@uccs.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-03-11">
      <day>11</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>9</issue>
    <fpage>2414</fpage>
    <lpage>2421</lpage>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>01</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac156.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>High throughput chromosome conformation capture (Hi-C) contact matrices are used to predict 3D chromatin structures in eukaryotic cells. High-resolution Hi-C data are less available than low-resolution Hi-C data due to sequencing costs but provide greater insight into the intricate details of 3D chromatin structures such as enhancer–promoter interactions and sub-domains. To provide a cost-effective solution to high-resolution Hi-C data collection, deep learning models are used to predict high-resolution Hi-C matrices from existing low-resolution matrices across multiple cell types.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present two Cascading Residual Networks called HiCARN-1 and HiCARN-2, a convolutional neural network and a generative adversarial network, that use a novel framework of cascading connections throughout the network for Hi-C contact matrix prediction from low-resolution data. Shown by image evaluation and Hi-C reproducibility metrics, both HiCARN models, overall, outperform state-of-the-art Hi-C resolution enhancement algorithms in predictive accuracy for both human and mouse 1/16, 1/32, 1/64 and 1/100 downsampled high-resolution Hi-C data. Also, validation by extracting topologically associating domains, chromosome 3D structure and chromatin loop predictions from the enhanced data shows that HiCARN can proficiently reconstruct biologically significant regions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>HiCARN can be accessed and utilized as an open-sourced software at: <ext-link xlink:href="https://github.com/OluwadareLab/HiCARN" ext-link-type="uri">https://github.com/OluwadareLab/HiCARN</ext-link> and is also available as a containerized application that can be run on any platform.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2050919</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Committee on Research and Creative Works (CRCW) Seed Grant funding from the University of Colorado</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Chromosome 3D conformation structures are important to consider when exploring genomic processes within eukaryotic cell nuclei. Hi-C is a biochemical technique that supports an all-versus-all mapping of the interaction of the fragments in a chromosome and a genome. This interaction between the pair read assays are further converted to an <italic toggle="yes">n</italic>×<italic toggle="yes">n</italic> interaction frequency (IF) contact matrix, where <italic toggle="yes">n</italic> is the number fragments in a chromosome or genome at a given Hi-C data resolution (<xref rid="btac156-B10" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>). Today, these data are used as the input to many algorithms for advanced understanding of the genome organization (<xref rid="btac156-B17" ref-type="bibr">Oluwadare <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>However, a major problem in understanding the genome organization is the lack of high-resolution (HR) data necessary for understanding inherent topologies in the human genome such as enhancer–promoter interactions or sub-domains (<xref rid="btac156-B24" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>), which are only discoverable at high resolutions such as ≤10 kb. Thus, the critical need in the chromatin genomics field is the development of a cost-effective method to increase the availability of HR Hi-C data for advanced study and an in-depth elucidation of the genome organization.</p>
    <p>Deep learning models are used to fill this demand by predicting the HR data from low-resolution data (LR) with great accuracy. Current models include HiCPlus (<xref rid="btac156-B24" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>), HiCNN (<xref rid="btac156-B11" ref-type="bibr">Liu and Wang, 2019a</xref>), hicGAN (<xref rid="btac156-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2019</xref>), Boost-HiC (<xref rid="btac156-B3" ref-type="bibr">Carron <italic toggle="yes">et al.</italic>, 2019</xref>), HiCSR (<xref rid="btac156-B5" ref-type="bibr">Dimmick <italic toggle="yes">et al.</italic>, 2020</xref>), SRHiC (<xref rid="btac156-B9" ref-type="bibr">Li and Dai, 2020</xref>), HiCNN-2 (<xref rid="btac156-B12" ref-type="bibr">Liu and Wang, 2019b</xref>), VEHiCLE (<xref rid="btac156-B7" ref-type="bibr">Highsmith and Cheng, 2021</xref>) and DeepHiC (<xref rid="btac156-B8" ref-type="bibr">Hong <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>These models are categorized into three groups based on their respective network architectures: convolutional neural networks (CNNs), autoencoders and generative adversarial networks (GANs).</p>
    <p>The first model used for Hi-C resolution enhancement was HiCPlus (<xref rid="btac156-B24" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>) which used a CNN to identify patterns of IFs from neighboring reference regions to generate HR Hi-C data from LR inputs. HiCNN improved the accuracy of Hi-C resolution enhancement with a network composed of 54 convolution (Conv) layers that consistently outperformed HiCPlus (<xref rid="btac156-B11" ref-type="bibr">Liu and Wang, 2019a</xref>). This was shortly followed by HiCNN-2 where three models were generated using a combination of one, two or three CNNs in HiCNN2-1, HiCNN2-2 and HiCNN2-3, respectively (<xref rid="btac156-B12" ref-type="bibr">Liu and Wang, 2019b</xref>).</p>
    <p>HiCSR is another notable model that uses a denoising autoencoder consisting of five Conv layers preceding five deconvolutional layers (<xref rid="btac156-B5" ref-type="bibr">Dimmick <italic toggle="yes">et al.</italic>, 2020</xref>). HiCSR outperformed VEHiCLE, another autoencoder-based model in overall GenomeDISCO, HiCRep and QuASAR-Rep scores on four tested chromosomes (<xref rid="btac156-B7" ref-type="bibr">Highsmith and Cheng, 2021</xref>).</p>
    <p>Alternative network architectures besides CNNs have also been utilized for Hi-C resolution enhancement. A GAN was used in the hicGAN model where a generator and discriminator were implemented to produce super-resolution Hi-C data and discriminate against real HR data and the super resolution data (<xref rid="btac156-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Another high-performing model, DeepHiC, is also a GAN. DeepHiC outperformed HiCPlus and HiCNN in SSIM score and Pearson Correlation (<xref rid="btac156-B8" ref-type="bibr">Hong <italic toggle="yes">et al.</italic>, 2020</xref>), while also outperforming VEHiCLE and HiCSR overall in the previously cited structural similarity scores (<xref rid="btac156-B7" ref-type="bibr">Highsmith and Cheng, 2021</xref>).</p>
    <p>Currently, each of the Hi-C enhancement models have their various strengths, but performance can still be improved. For example, although HiCNN-2 and HiCSR achieve competitive performance, they are burdened by their heavy frameworks. The varying combinations of HiCNN-2’s CNNs and HiCSR’s 15 ResNet blocks and DAE during training increase their predictive accuracies albeit at the cost of training speed as is described in this article. This is also the same problem that needs to be balanced for the GAN-based network (<xref rid="btac156-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2021</xref>). As shown by DeepHiC where the model performs well and is efficient during training, however the ratio between performance and training time can continue to improve. In this work, we provide a rationale for the need to develop a new and high-performing framework, like HiCARN, by also using biological and computational explanations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>). Hence, we developed HiCARN based on the CARN model, proposed by (<xref rid="btac156-B1" ref-type="bibr">Ahn <italic toggle="yes">et al.</italic>, 2018</xref>), for LR Hi-C data. HiCARN is a lightweight algorithm that achieves higher reproducibility and concordance scores in the GenomeDISCO (<xref rid="btac156-B21" ref-type="bibr">Ursu <italic toggle="yes">et al.</italic>, 2018</xref>) reproducibility metric and topologically associating domain (TAD) predictions, respectively, compared with existing enhancement approaches on publicly available Hi-C datasets.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Architecture</title>
      <p>Here, we propose two architectures for HiCARN: a CNN-based generator (HiCARN-1) and a GAN-based model with a CNN generator and a discriminator (HiCARN-2).</p>
      <p>Our base model, HiCARN-1, is a configuration of five cascading blocks that each contain three residual blocks and three 1×1 Conv layers (<xref rid="btac156-F1" ref-type="fig">Fig. 1A</xref>). Information from previous blocks is cascaded through the entire network via third dimension concatenations of each tensor. This process is perpetuated throughout each cascading block and the entire network.</p>
      <fig position="float" id="btac156-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Overview of the cascading block architecture. (<bold>A</bold>) Cascading block architecture with local and skip connections. Features extracted from previous layers are propagated through the end of the cascading block via concatenation. The features are then condensed into a single channel as the output. Optimal hyper-parameters for the batch size passed through the network were identified via a hyper parameter search (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). (<bold>B</bold>) Each residual block follows standard ResNet architecture; however, an additional skip connection from the input to the block output is added before the convolution. (<bold>C</bold>) Cascading residual network architecture with local and global cascading layers modified for application of Hi-C data. (<bold>D</bold>) HiCARN-2 GAN architecture with a cascading block generator and discriminator. LR images are passed through the generator where predicted HR images are created. The predicted HR images then are passed through the discriminator along with the real HR images where the discriminator attempts to classify them as real or fake</p>
        </caption>
        <graphic xlink:href="btac156f1" position="float"/>
      </fig>
      <p>HiCARN-1 and HiCARN-2's generators retain a similar architecture to CNNs, except each cascading block contains two residual network (ResNet) blocks with a 1×1 Conv layer between both ResNet blocks. Each ResNet block contains two 3×3 Convs and two ReLU activation functions with local skip connections (<xref rid="btac156-F1" ref-type="fig">Fig. 1B</xref>). Intermediate outputs from each block cascade into the concatenation function of the next block and parameters are shared between cascading blocks.</p>
      <p>HiCARN's overall generator network shares the same connection properties as a single cascading block (<xref rid="btac156-F1" ref-type="fig">Fig. 1C</xref>) which function to maintain and reintroduce features from multiple layers. This not only contributes to the performance of HiCARN, but the efficiency as well since the multi-level connections act as forward and backward propagation shortcuts (<xref rid="btac156-B1" ref-type="bibr">Ahn <italic toggle="yes">et al.</italic>, 2018</xref>), thus allowing for quick training and accurate predictions. Similarly to ResNet, the residual and cascading blocks of HiCARN use many skip connections as well as ReLU activation functions to solve the vanishing gradient problem.</p>
      <p>The discriminator of HiCARN-2 (<xref rid="btac156-F1" ref-type="fig">Fig. 1D</xref>) consists of a series of seven Convs, leaky ReLU’s, and batch normalizations preceded by a 3×3 Conv and leaky ReLU, followed by a 3×3 Conv, sigmoid activation and average pooling. There are no global or cascading connections between or within blocks.</p>
    </sec>
    <sec>
      <title>2.2 Loss functions</title>
      <p>The HiCARN-1 loss function (<xref rid="E1" ref-type="disp-formula">Equation 1</xref>), utilizes mean squared error (MSE) (<xref rid="E3" ref-type="disp-formula">Equation 3</xref>), perceptual loss from the pretrained VGG16 CNN(VGG) via MSE loss of its extracted features, and total variation (TV) loss (<xref rid="E5" ref-type="disp-formula">Equation 5</xref>). HiCARN-2 adds an additional adversarial (AD) loss (<xref rid="E4" ref-type="disp-formula">Equation 4</xref>), from the discriminator to the generator loss function (<xref rid="E2" ref-type="disp-formula">Equation 2</xref>); and uses the binary cross entropy (BCE) loss function (<xref rid="E9" ref-type="disp-formula">Equation 9</xref>) for the discriminator.</p>
      <p>Generator loss for HiCARN-1 and HiCARN-2 are, respectively, defined by the following equations (<xref rid="E1" ref-type="disp-formula">Equations 1</xref> and <xref rid="E2" ref-type="disp-formula">2</xref>) where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">and</mml:mi><mml:mo> </mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:math></inline-formula> are scalar weights ranging from 0 to 1:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>α</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">VGG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>β</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">VGG</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>β</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>γ</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">AD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>In <italic toggle="yes">L</italic><sub>G</sub>, both <italic toggle="yes">l</italic><sub>MSE</sub> and <italic toggle="yes">l</italic><sub>VGG</sub> compute MSE loss. MSE measures the cross entropy of the distributions of the generator HR output and the real HR image by computing the average squared difference between the two images (<xref rid="E3" ref-type="disp-formula">Equation 3</xref>), where <italic toggle="yes">y</italic> is a real HR matrix and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the predicted matrix.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mi mathvariant="normal">MSE</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>AD loss of the HiCARN discriminator represents the probability of discriminator classification error of the generated fake HR images and real HR images (<xref rid="E4" ref-type="disp-formula">Equation 4</xref>).
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">AD</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>TV loss functions to remove noise within the generated HR image. Total generator TV loss is defined by the following function (<xref rid="E5" ref-type="disp-formula">Equation 5</xref>), where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>ψ</mml:mo></mml:math></inline-formula> is a weight scalar, <italic toggle="yes">F</italic> is the number of filters in a tensor of dimensions [F, C, H, W], and <italic toggle="yes">h<sub>TV</sub></italic> (<xref rid="E6" ref-type="disp-formula">Equation 6</xref>), and <italic toggle="yes">w<sub>TV</sub></italic> (<xref rid="E7" ref-type="disp-formula">Equation 7</xref>), are the TV losses of the H and W dimensions, respectively:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>ψ</mml:mo><mml:mo>*</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p><italic toggle="yes">H</italic> and <italic toggle="yes">W</italic><sub>TV</sub> loss are calculated by the sum of the squared difference of the generator output matrix <italic toggle="yes">y</italic> divided by the respective dimensions of <italic toggle="yes">h</italic><sub>TV</sub> and <italic toggle="yes">w</italic><sub>TV</sub>. For <italic toggle="yes">h</italic><sub>TV</sub>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mtext>:</mml:mtext><mml:mi mathvariant="italic">i</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="italic">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the generator output with the first row removed and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi mathvariant="italic">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi mathvariant="italic">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the same output with the last row removed. A similar computation is repeated for <italic toggle="yes">w</italic><sub>TV</sub> where the first and last columns are removed.
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>*</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula>
 <disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TV</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>*</mml:mo><mml:mi>H</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The discriminator of HiCARN-2 utilizes the BCE loss function (<xref rid="E8" ref-type="disp-formula">Equation 8</xref>), to penalize the discriminator for misclassifying fake HR images from real HR images. Total discriminator loss is computed as the sum of the BCE losses for the classification of fake HRs images and real HR images (<xref rid="E9" ref-type="disp-formula">Equation 9</xref>).
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mi mathvariant="normal">*</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">*</mml:mi><mml:mi mathvariant="normal">log</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">real</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">fake</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.3 Hi-C data and preprocessing</title>
      <p>Hi-C data was collected from the Restructured Gene Expression Omnibus database. Data for the GM12878, K562, and CH12-LX cell lines was collected from <xref rid="btac156-B18" ref-type="bibr">Rao <italic toggle="yes">et al.</italic> (2014)</xref>, GEO accession code <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63525" ext-link-type="uri">GSE63525</ext-link>. Data for HCT-116 chromatin loop detections was collected from <xref rid="btac156-B19" ref-type="bibr">Rao <italic toggle="yes">et</italic> <italic toggle="yes">al</italic>. (2017)</xref>, GEO accession code <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi" ext-link-type="uri">GSE104334</ext-link>. The training dataset was obtained from the human GM12878 cell line, the most common training data across all Hi-C resolution enhancement models. All chromosomes from each dataset were randomly selected. From the GM12878 cell line, chromosomes 1, 3, 5, 7, 8, 9, 11, 13, 15, 17, 18, 19, 21 and 22 were used for training and chromosomes 2, 6, 10 and 12 were used for validation. The datasets used to test the HiCARN model were GM12878 chromosomes 4, 14, 16 and 20; and the human K562 cell line; and the CH12-LX mouse embryonic stem cell (mESC) line. The mESC data functioned to test the model's accuracy across species. A table displaying all training, validation and test sets is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. All datasets were preprocessed according to the method used by DeepHiC (<xref rid="btac156-B8" ref-type="bibr">Hong <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <p>The existing models tested in this work were trained on 40×40 sub-matrices as LR inputs. To ensure competitive fairness, HiCARN was trained on 40×40 sub-matrices divided by a window of 40 and stride of 40 with no overlap of sub-matrices.</p>
    </sec>
    <sec>
      <title>2.4 Enhancement pipeline</title>
      <p>For HiCARN-1, <italic toggle="yes">N</italic> 40×40 LR sub-matrices of batch size <italic toggle="yes">N</italic> are passed through the network, outputting a predicted HR contact map (<xref rid="btac156-F1" ref-type="fig">Fig. 1C</xref>). HiCARN-2 follows the same process; however, the predicted HR and real HR sub-matrices are passed through the discriminator where they are determined to be real or predicted contact maps (<xref rid="btac156-F1" ref-type="fig">Fig. 1D</xref>). A full diagram of HiCARN pipelines and hyper parameters is provided (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>).</p>
    </sec>
    <sec>
      <title>2.5 Existing model implementations</title>
      <p>All models were trained on our generated datasets for 1/16, 1/32, 1/64 and 1/100 downsampled inputs. Python source code for DeepHiC, from which we used their code for data preprocessing and network architecture, was obtained from <ext-link xlink:href="https://github.com/omegahh/DeepHiC" ext-link-type="uri">https://github.com/omegahh/DeepHiC</ext-link>. Source code for HiCSR, HiCNN-2 and HiCPlus were obtained from <ext-link xlink:href="https://github.com/PSI-Lab/HiCSR" ext-link-type="uri">https://github.com/PSI-Lab/HiCSR</ext-link>, <ext-link xlink:href="http://dna.cs.miami.edu/HiCNN2/" ext-link-type="uri">http://dna.cs.miami.edu/HiCNN2/</ext-link> and <ext-link xlink:href="https://github.com/wangjuan001/hicplus" ext-link-type="uri">https://github.com/wangjuan001/hicplus</ext-link>, respectively. To compare against HiCNN, we used HiCNN-2: an improved version of HiCNN (<xref rid="btac156-B12" ref-type="bibr">Liu and Wang, 2019b</xref>). Network parameters can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>.</p>
    </sec>
    <sec>
      <title>2.6 Evaluation and validation</title>
      <p>The model was trained and validated on the GM12878 cell line using a holdout cross validation method. Here, chromosomes 2, 6, 10 and 12 were used, according to <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, and were tested at the end of each training epoch to record the best Structural Similarity Index Measure (SSIM) scores over time</p>
      <p>During testing, Pearson Correlation Coefficient (PCC), Spearman Correlation Coefficient (SPC), MSE, SSIM and Peak Signal to Noise Ratio (PSNR) scores were calculated for each 40×40 sub-matrix predicted by HiCARN, DeepHiC, HiCSR, HiCNN-2 and HiCPlus. Novel Hi-C analysis metrics such as GenomeDISCO (<xref rid="btac156-B21" ref-type="bibr">Ursu <italic toggle="yes">et al.</italic>, 2018</xref>) and HiCRep (<xref rid="btac156-B23" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2017</xref>) were used to calculate the reproducibility of the generated 40×40 sub-matrices. The models were tested across four randomly selected chromosomes to compare the efficiency and accuracy of HiCARN to state-of-the-art models. To ensure generalizability of HiCARN, the human K562 and mESC cell lines were not seen by the model until training was complete.</p>
    </sec>
    <sec>
      <title>2.7 Image evaluation metrics</title>
      <p>The following equations define PCC, SCC, SSIM and PSNR where <italic toggle="yes">y</italic> denotes the real HR target and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> represents the enhanced LR input. For MSE see <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>.</p>
      <p>PCC calculates the correlation coefficient <italic toggle="yes">r</italic> of two matrices along the matrix diagonal (<xref rid="E10" ref-type="disp-formula">Equation 10</xref>).
<disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mi mathvariant="normal">PC</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo> </mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo> </mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>SCC is also calculated along the matrix diagonal and computes the strength and direction of the monotonic relationship between the two matrices <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo></mml:math></inline-formula>, whereas PCC is the linear relationship strength (<xref rid="E11" ref-type="disp-formula">Equation 11</xref>). Here, <italic toggle="yes">d</italic> represents the difference between two observation rankings and <italic toggle="yes">n</italic> is the number of observations.
<disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mi mathvariant="normal">SC</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>6</mml:mn><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>SSIM computes the similarity of two given images. We used DeepHiC's implementation of SSIM scoring (Hong <italic toggle="yes">et al.</italic>, 2020). The function (<xref rid="E12" ref-type="disp-formula">Equation 12</xref>), compares structure, contrast and luminance across the two images via a moving convolution window, extracting the values <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The values <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are computed by moving a convolution window across <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mi mathvariant="normal">and</mml:mi><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and subtracting their respective <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula> values. The constants <italic toggle="yes">C<sub>1</sub></italic> and <italic toggle="yes">C<sub>2</sub></italic> were set to 0.01<sup>2</sup> and 0.03<sup>2</sup>, respectively.
<disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mi mathvariant="normal">SSIM</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>PSNR measures the ratio of the maximum signal power to the power of corrupting noise in the image (<xref rid="E13" ref-type="disp-formula">Equation 13</xref>).
<disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mi mathvariant="normal">PSNR</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi mathvariant="normal">*</mml:mi><mml:mi mathvariant="normal">lo</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.8 Hi-C reproducibility metrics</title>
      <p>GenomeDISCO and HiCRep provide a more biologically significant analysis measure compared to standard image evaluation metrics. GenomeDISCO uses a random walk of <italic toggle="yes">t</italic> steps to denoise Hi-C contact matrices from which a difference vector is computed. The concordance score is calculated by subtracting the difference vector from 1 in the range [-1, 1], where larger values indicate increased similarity. We used the optimal step value <italic toggle="yes">t=</italic>3 as cited (<xref rid="btac156-B21" ref-type="bibr">Ursu <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <p>Similarly, HiCRep denoises the contact matrices prior to analysis. A Pearson correlation coefficient is calculated for each stratum. Coefficients are then combined via a weighted average producing a stratum adjusted correlation coefficient. Scores are in the range [-1, 1]. We used the R implementation of this method.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>HiCARN-1 and HiCARN-2 were trained on 40×40 sub-matrices in 100 epochs using the Adam optimizer with a batch size of 64 and an initial learning rate of 1.0×10<sup>−3</sup> based on a hyper parameter search (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) and hyper parameters from <xref rid="btac156-B1" ref-type="bibr">Ahn <italic toggle="yes">et al.</italic> (2018)</xref>. A variable learning rate was used and is defined by the following (<xref rid="E14" ref-type="disp-formula">Equation 14</xref>) where <italic toggle="yes">lr</italic><sub>n</sub> and <italic toggle="yes">E</italic><sub>n</sub> are the current learning rate and epoch, respectively:
<disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">*</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    <p>The variable learning rate allows for increased learning in early epochs after-which it stabilizes. Due to the lightweight framework of HiCARN, it learns and converges quicker than all other models in SSIM scores during validation for 1/16 downsampled data (<xref rid="btac156-F2" ref-type="fig">Fig. 2A</xref>). Validation SSIM scores for 1/32, 1/64 and 1/100 downsampled data are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
    <fig position="float" id="btac156-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>(<bold>A</bold>) Validation SSIM scores for 100 epochs of training. Results are shown for all tested models for 1/16 downsampled Hi-C data. HiCARN-1 and HiCARN-2 display the quickest convergence of SSIM validation scores. (<bold>B</bold>) SSIM test scores per model training time. (<bold>C</bold>) SSIM test scores per model memory usage during training (% gpu)</p>
      </caption>
      <graphic xlink:href="btac156f2" position="float"/>
    </fig>
    <p>All models were individually trained using an Nvidia Titan RTX GPU with 24219.0 Mb of memory. HiCARN’s lightweight network and quick convergence in validation is also reflected in its training time compared to other models. As shown in <xref rid="btac156-F2" ref-type="fig">Figure 2B and C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>, HiCARN maintains superior performance with efficient memory and time management.</p>
    <sec>
      <title>3.1 HiCARN frequently outperforms existing models in image-based and Hi-C biological-based metrics</title>
      <p>A visual comparison of predicted contact maps is provided for chromosome 4 from the GM12878 cell line (<xref rid="btac156-F3" ref-type="fig">Fig. 3</xref>). The most easily identifiable structures are TADs which appear as the high-contrast square regions along the contact map diagonal seen within the outlined square in the second row of <xref rid="btac156-F3" ref-type="fig">Figure 3</xref>. When zooming in on the 40.8–41.5 Mb region, it is observed that both HiCARN models are able to detect and replicate not only TADs, but subTADs as well, identified by the high contrast corners of the TADs that appear as ‘dots’. Within the GM12878 cell line, each of the models reconstructs a contact map fairly comparable to the HR target, however the robustness of each model is evident in the K562 and mESC cell lines. HiCARN-1 and HiCARN-2 produce nearly identical contact maps to each other that, overall, outperform all existing models which is confirmed by the image evaluation (<xref rid="btac156-T1" ref-type="table">Table 1</xref>) and Hi-C reproducibility metrics (<xref rid="btac156-F4" ref-type="fig">Fig. 4A and B</xref>). (See <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> for PCC and SCC scores.)</p>
      <fig position="float" id="btac156-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Heat map diagram of GM12878 chromosome 4 predictions from HiCARN and existing models. Three regions are displayed: 40–45 Mb (top), 40–41.5 Mb (middle) and 40.8–41.5 Mb (bottom). The outlined box in the target heat map indicates the 40–41.5 Mb region and the outlined box in the second row indicates 40.8–41.5 Mb. The bottom heatmap is the zoomed image of the blue box region</p>
        </caption>
        <graphic xlink:href="btac156f3" position="float"/>
      </fig>
      <fig position="float" id="btac156-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>(<bold>A</bold>) GenomeDISCO scores from chromosomes 4, 14, 16 and 20 from the GM12878 cell line for 1/16 downsampled data. HiCARN-1 achieves an average score (mean ± SD) of 0.9173 ± 0.0092 and HiCARN-2 achieves 0.9144 ± 0.0093. (<bold>B</bold>) HiCRep scores from the GM12878 cell line. HiCRep scores were calculated for the entire matrix. HiCARN-1 achieves an average score (mean ± SD) of 0.7338 ± 0.0997 and HiCARN-2 achieves 0.7299 ± 0.0978 across the chromosomes. (<bold>C</bold>) Average (mean ± SE) GenomeDISCO scores from chromosomes 4, 14, 16 and 20 from the GM12878 cell line across downsampling ratios 1/16, 1/32, 1/64 and 1/100</p>
        </caption>
        <graphic xlink:href="btac156f4" position="float"/>
      </fig>
      <table-wrap position="float" id="btac156-T1">
        <label>Table 1.</label>
        <caption>
          <p>Image evaluation metrics as averages across GM12878 test chromosomes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th rowspan="1" colspan="1">PSNR</th>
              <th rowspan="1" colspan="1">MSE</th>
              <th rowspan="1" colspan="1">SSIM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCSR</italic>
              </td>
              <td rowspan="1" colspan="1">30.7317</td>
              <td rowspan="1" colspan="1">0.0009</td>
              <td rowspan="1" colspan="1">0.9005</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">DeepHiC</italic>
              </td>
              <td rowspan="1" colspan="1">34.3431</td>
              <td rowspan="1" colspan="1">0.0004**</td>
              <td rowspan="1" colspan="1">0.8975</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCNN-2</italic>
              </td>
              <td rowspan="1" colspan="1">33.5231</td>
              <td rowspan="1" colspan="1">0.0005</td>
              <td rowspan="1" colspan="1">0.8988</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCPlus</italic>
              </td>
              <td rowspan="1" colspan="1">30.8278</td>
              <td rowspan="1" colspan="1">0.0008</td>
              <td rowspan="1" colspan="1">0.8752</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCARN-1</italic>
              </td>
              <td rowspan="1" colspan="1">35.0714*</td>
              <td rowspan="1" colspan="1">0.0003*</td>
              <td rowspan="1" colspan="1">0.9119*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCARN-2</italic>
              </td>
              <td rowspan="1" colspan="1">34.9109**</td>
              <td rowspan="1" colspan="1">0.0003*</td>
              <td rowspan="1" colspan="1">0.9069**</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: All scores were calculated from predicted 40×40 sub-matrices during testing. Top and second-best scores are represented by * and **, respectively.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Overall, HiCARN-1 produces the top results for PSNR, SSIM, MSE, PCC and GenomeDISCO. HiCARN-2 scores are quite close with very minimal difference. HiCSR achieved top scores in SCC and HiCRep.</p>
      <p>Downsampling ratios of 1/32, 1/64 and 1/100 were also tested. Average GenomeDISCO values for GM12878 are presented for each ratio (<xref rid="btac156-F4" ref-type="fig">Fig. 4C</xref>) where both HiCARN-1 and HiCSR achieved top scores and HiCARN-2 following throughout. HiCARN-1 and HiCARN-2, overall, persisted in maintaining state-of-the-art performance compared to all other models, although HiCSR maintained high competitiveness throughout (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
    <sec>
      <title>3.2 HiCARN performance across unseen cell lines</title>
      <p>HiCARN and existing models were tested on chromosomes 3, 11, 19 and 21 from the K562 human cell line and chromosomes 4, 9, 15 and 18 from the mESC cell line. GenomeDISCO scores are provided for K562 at 1/64 downsampling (<xref rid="btac156-F5" ref-type="fig">Fig. 5A</xref>) and mESC at 1/32 downsampling (<xref rid="btac156-F5" ref-type="fig">Fig. 5B</xref>) predictions. Overall, HiCARN-1 outperforms all other models for the K562 cell line and maintains competitiveness for the mESC cell line with HiCARN-2 following close behind. DeepHiC and HiCNN-2 also produced comparable results in reproducibility scores and image reconstruction HiCPlus scores for the 1/32 downsampled mESC cell line all converge to -1, therefore they are not represented in <xref rid="btac156-F5" ref-type="fig">Figure 5B</xref>.</p>
      <fig position="float" id="btac156-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>(<bold>A</bold>) GenomeDISCO scores for 1/64 downsampled K562 Hi-C data for chromosomes 3, 11, 19 and 21. HiCARN-1 achieves an average score (mean ± SD) of 0.8301 ± 0.0070 and HiCARN-2 achieves 0.8210 ± 0.0072. (<bold>B</bold>) GenomeDISCO scores for 1/32 downsampled mESC Hi-C data for chromosomes 4, 9, 15 and 18. HiCARN-1 achieves an average score (mean ± SD) of 0.5971 ± 0.0569 and HiCARN-2 achieves 0.5802 ± 0.0582. HiCPlus scores are not included for the 1/32 mESC results as they converge to −1, and thus interfere with the scaling of the graph. (<bold>C</bold>) GenomeDISCO scores from 1/64 downsampled chromosomes 3, 11, 19 and 21 from the K562 cell line across 5, 7 and 10 cascading blocks. (<bold>D</bold>) GenomeDISCO scores from 1/32 downsampled chromosomes 4, 9, 15 and 18 from the mESC cell line across 5, 7 and 10 cascading blocks</p>
        </caption>
        <graphic xlink:href="btac156f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Differences among varied cascading blocks quantities</title>
      <p>We also trained HiCARN with varying numbers of cascading blocks. Using five cascading blocks proved sufficient for outperforming state-of-the-art models, however when more blocks are added, almost all evaluation metric scores slightly increase, especially when predicting across unseen cell lines and species (<xref rid="btac156-F5" ref-type="fig">Fig. 5C and D</xref>). We tested the performance of 5, 7 and 10 cascading block networks. HiCARN with 10 cascading blocks outperformed all other architectures at the cost of training and predicting speed. Results for the GM12878 cell line are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>. A network of five cascading blocks was chosen to balance the added accuracy of higher block counts and reduced computational cost of lower block counts.</p>
    </sec>
    <sec>
      <title>3.4 TAD predictions</title>
      <p>TADs are regions on a chromosome generated by chromatin loop extrusions and are contained by boundaries formed from architectural proteins (<xref rid="btac156-B2" ref-type="bibr">Beagan and Phillips-Cremins, 2020</xref>; <xref rid="btac156-B6" ref-type="bibr">Dixon <italic toggle="yes">et al.</italic>, 2016</xref>). These structures are helpful for identifying biologically significant regions such as subTADs, microTADs and enhancer–promoter interactions. HiCARN's TAD reconstructions were analyzed using the TopDom TAD detection method (<xref rid="btac156-B20" ref-type="bibr">Shin <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <p>HiCARN is also able to closely retain the number (<xref rid="btac156-F6" ref-type="fig">Fig. 6A</xref>) and size (<xref rid="btac156-F6" ref-type="fig">Fig. 6B</xref>) of HR TADs. Average concordance scores for this region are reported in <xref rid="btac156-T2" ref-type="table">Table 2</xref>. Visualization of the real and predicted TADs within the 40–42.5 Mb region of chromosome 4 displays high overlap between the two (<xref rid="btac156-F7" ref-type="fig">Fig. 7</xref>).</p>
      <fig position="float" id="btac156-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Comparisons of the number (<bold>A</bold>) and size (<bold>B</bold>) of predicted chromosomes compared to the real HR data</p>
        </caption>
        <graphic xlink:href="btac156f6" position="float"/>
      </fig>
      <fig position="float" id="btac156-F7">
        <label>Fig. 8.</label>
        <caption>
          <p>3D reconstructions of 1/16 downsampled data, HiCARN-1 and HiCARN-2 contact matrices compared to the 3D reconstruction of real HR contact matrix. The real HR data 3D reconstruction is the centered reconstruction in each image. The region presented is from chromosome 4 (40–45Mb) from the GM12878 cell line</p>
        </caption>
        <graphic xlink:href="btac156f7" position="float"/>
      </fig>
      <table-wrap position="float" id="btac156-T2">
        <label>Table 2.</label>
        <caption>
          <p>Average TAD concordance score for chromosome 4 (40–42.5 Mb) of the GM12878 cell line</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th rowspan="1" colspan="1">Average concordance score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCSR</italic>
              </td>
              <td rowspan="1" colspan="1">0.7761</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">DeepHiC</italic>
              </td>
              <td rowspan="1" colspan="1">0.7834</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCNN-2</italic>
              </td>
              <td rowspan="1" colspan="1">0.7322</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCPlus</italic>
              </td>
              <td rowspan="1" colspan="1">0.7112</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCARN-1</italic>
              </td>
              <td rowspan="1" colspan="1">0.8697*</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">HiCARN-2</italic>
              </td>
              <td rowspan="1" colspan="1">0.84**</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Chromosome 3D structure reconstruction</title>
      <p>We also reconstructed 3D chromatin models using the GenomeFlow structure prediction tool. Models were generated for the 1/16 downsampled matrix, the real HR target, HiCARN-1 and HiCARN-2's predictions for every 5Mb of chromosome 4 (40–190 Mb) from the GM12878 cell line (<xref rid="btac156-F8" ref-type="fig">Fig. 8</xref>). PCC and SCC values of HiCARN-1's prediction to the HR target were calculated for each 5-Mb region (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). HiCARN can produce 3D conformations similar to those of the target contact maps.</p>
      <fig position="float" id="btac156-F8">
        <label>Fig. 7.</label>
        <caption>
          <p>Overlap comparison of Real HR TAD locations, HiCARN-1 and HiCARN-2's predictions from GM12878 chromosome 4 (40–42.5 Mb). HiCExplorer was used for this visualization</p>
        </caption>
        <graphic xlink:href="btac156f8" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 Chromatin loop detections</title>
      <p>Chromatin loops are key regulators in genome transcription (<xref rid="btac156-B4" ref-type="bibr">De Laat and Duboule, 2013</xref>), thus it is important for enhancement models to accurately detect and predict chromatin loops. At the anchors of these loops are two proteins CTCF and cohesion which have been shown to aid in the formation of loops (<xref rid="btac156-B15" ref-type="bibr">Merkenschlager and Nora, 2016</xref>).</p>
      <sec>
        <title>3.6.1 GM12878 loop detections</title>
        <p>Chromatin loops and CTCF anchors were detected for chromosomes 4, 14, 16 and 20 from the GM12878 cell line using the HiCExplorer software (<xref rid="btac156-B22" ref-type="bibr">Wolff <italic toggle="yes">et al.</italic>, 2020</xref>). We observed that HiCARN models do not overestimate the number of loops detected, thus, maintaining consistency with the number of detected loops in the HR dataset. <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S5–S8</xref> show that HiCARN achieved top performance across three of the four chromosomes tested and second-best performance in the fourth chromosome. Specifically, HiCARN detects &gt;2% of CTCF anchor matches compared to the next performing model on chromosomes 14 and 16, and &gt;1% for chromosome 20. For chromosome 4, HiCARN found 40% CTCF peaks for detected loops, second to HiCSR which found 43% CTCF anchor match. Overall, it was found that HiCARN maintained consistency with the high-resolution data for the number of loops and the percent CTCF matches compared to all other models.</p>
      </sec>
      <sec>
        <title>3.6.2 HCT-116 loop detections</title>
        <p>To see if our models were able to capture structural genomic differences, HICARN was also trained and tested on cohesion-depleted and untreated HCT-116 cells where cohesion-depleted cells were shown to eliminate loop domains (<xref rid="btac156-B19" ref-type="bibr">Rao <italic toggle="yes">et al.</italic>, 2017</xref>). After detecting chromatin loops and CTCF anchor matches, we found that HiCARN maintained consistency in the number of loops predicted with CTCF anchors for both cell groups compared to the HR data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S9–S12</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this work, we present a novel framework for HR Hi-C contact map predictions. Variations in the number of cascading blocks and the overall framework (CNN versus GAN) do not significantly hinder or improve the performance of HiCARN. However, if the user requires a quick training process, HiCARN-1 with five cascading blocks should be used to reduce computational load during training and predicting.</p>
    <p>We also demonstrated HiCARN's superior performance over most existing models in both image and Hi-C evaluation metrics for 1/16, 1/32, 1/64, 1/100 downsampled HR contact maps. The 1/100 downsample results particularly displayed the robustnesses of HiCARN-1, HiCARN-2 and HiCSR for predicting high fidelity images from very low-resolution data. The existing models performed well throughout; however, our network outperformed these models across all tested cell lines. To further confirm the performance consistency of our algorithm, we deliberately selected different chromosomes than our original training, validation and test sets—the chromosome selection for this second test are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>—and retrained all models. Our results show that HiCARN maintained superior performance, thus showing HiCARN’s robustness across datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
    <p>TAD, 3D genome structure, and chromatin loop predictions also confirm that HiCARN can proficiently reconstruct biologically significant regions. Overall, HiCARN contributes further to the development of high-fidelity predictions of HR Hi-C contact maps from state-of-the-art resolution enhancement models.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac156_Supplementary_Data</label>
      <media xlink:href="btac156_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the reviewers for their valuable and constructive comments. They also thank Sean Higgins and Dr Andrew Klocko for their assistance during the manuscript revision phase.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Science Foundation [2050919]. The APC was funded by the Committee on Research and Creative Works (CRCW) Seed Grant funding from the University of Colorado, Colorado Springs [to O.O.]. Any opinions, findings and conclusions or recommendations expressed in this work are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac156-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ahn</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) Fast, accurate, and lightweight super-resolution with cascading residual network. In: <italic toggle="yes">Proceedings of European Conference on Computer Vision (ECCV). ECCV 2018: Lecture Notes in Computer Science, </italic>Munich, Germany.</mixed-citation>
    </ref>
    <ref id="btac156-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beagan</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Phillips-Cremins</surname><given-names>J.E.</given-names></string-name></person-group> (<year>2020</year>) <article-title>On the existence and functionality of topologically associating domains</article-title>. <source>Nat. Genet</source>., <volume>52</volume>, <fpage>8</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">31925403</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carron</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Boost-HiC: computational enhancement of long-range contacts in chromosomal contact maps</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2724</fpage>–<lpage>2729</lpage>.<pub-id pub-id-type="pmid">30615061</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Laat</surname><given-names>W.</given-names></string-name>, <string-name><surname>Duboule</surname><given-names>D.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Topology of mammalian developmental enhancers and their regulatory landscapes</article-title>. <source>Nature</source>, <volume>502</volume>, <fpage>499</fpage>–<lpage>506</lpage>.<pub-id pub-id-type="pmid">24153303</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Dimmick</surname><given-names>M.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) HiCSR: a Hi-C super-resolution framework for producing highly realistic contact maps. PhD Thesis, University of Toronto, Toronto, ON, Canada.</mixed-citation>
    </ref>
    <ref id="btac156-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dixon</surname><given-names>J.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Chromatin domains: the unit of chromosome organization</article-title>. <source>Mol. Cell</source>, <volume>62</volume>, <fpage>668</fpage>–<lpage>680</lpage>.<pub-id pub-id-type="pmid">27259200</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Highsmith</surname><given-names>M.</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J.</given-names></string-name></person-group> (<year>2021</year>). <article-title>VEHiCLE: a variationally encoded Hi-C loss enhancement algorithm for improving and generating Hi-C data</article-title>. <source>Sci. Rep</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">33414495</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>DeepHiC: a generative adversarial network for enhancing Hi-C data resolution</article-title>. <source>PLoS Comput. Biol</source>., <volume>16</volume>, <fpage>e1007287</fpage>.<pub-id pub-id-type="pmid">32084131</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Dai</surname><given-names>Z.</given-names></string-name></person-group> (<year>2020</year>) <article-title>SRHiC: a deep learning model to enhance the resolution of Hi-C data</article-title>. <source>Front. Genet</source>., <volume>11</volume>, <fpage>353</fpage>.<pub-id pub-id-type="pmid">32322265</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>T.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Z.</given-names></string-name></person-group> (<year>2019a</year>) <article-title>HiCNN: a very deep convolutional neural network to better enhance the resolution of Hi-C data</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4222</fpage>–<lpage>4228</lpage>.<pub-id pub-id-type="pmid">31056636</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>T.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Z.</given-names></string-name></person-group> (<year>2019b</year>) <article-title>HiCNN2: enhancing the resolution of Hi-C data using an ensemble of convolutional neural networks</article-title>. <source>Genes</source>, <volume>10</volume>, <fpage>862</fpage>.<pub-id pub-id-type="pmid">31671634</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>hicGAN infers super resolution Hi-C data with generative adversarial networks</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i99</fpage>–<lpage>i107</lpage>.<pub-id pub-id-type="pmid">31510693</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) Towards faster and stabilized GAN training for high-fidelity few-shot image synthesis. In: <italic toggle="yes">International Conference on Learning Representations (ICLR),</italic> Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="btac156-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkenschlager</surname><given-names>M.</given-names></string-name>, <string-name><surname>Nora</surname><given-names>E.P.</given-names></string-name></person-group> (<year>2016</year>) <article-title>CTCF and cohesin in genome folding and transcriptional gene regulation</article-title>. <source>Annu. Rev. Genomics Hum. Genet</source>., <volume>17</volume>, <fpage>17</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">27089971</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B16">
      <mixed-citation publication-type="journal">Trieu,T. <italic toggle="yes">et al.</italic> (2019) GenomeFlow: a comprehensive graphical tool for modeling and analyzing 3D genome structure. <italic toggle="yes">Bioinformatics</italic>, <bold>35</bold>(8), 1416–1418.</mixed-citation>
    </ref>
    <ref id="btac156-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oluwadare</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>An overview of methods for reconstructing 3-D chromosome and genome structures from Hi-C data</article-title>. <source>Biol. Procedures Online</source>, <volume>21</volume>, <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="btac156-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>S.S.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>S.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Cohesin loss eliminates all loop domains</article-title>. <source>Cell</source>  <volume>171</volume>, <fpage>305</fpage>–<lpage>320</lpage>.<pub-id pub-id-type="pmid">28985562</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>TopDom: an efficient and deterministic method for identifying topological domains in genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>e70</fpage>.<pub-id pub-id-type="pmid">26704975</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ursu</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>GenomeDISCO: a concordance score for chromosome conformation capture experiments using random walks on contact map graphs</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2701</fpage>–<lpage>2707</lpage>.<pub-id pub-id-type="pmid">29554289</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B22">
      <mixed-citation publication-type="other">Wolff,J. <italic toggle="yes">et al.</italic> (2020) Galaxy HiCExplorer 3: a web server for reproducible Hi-C, capture Hi-C and single-cell Hi-C data analysis, quality control and visualization. <italic toggle="yes">Nucleic Acids Research</italic>, <bold>48</bold>(W1), W177–W184.</mixed-citation>
    </ref>
    <ref id="btac156-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1939</fpage>–<lpage>1949</lpage>.<pub-id pub-id-type="pmid">28855260</pub-id></mixed-citation>
    </ref>
    <ref id="btac156-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
