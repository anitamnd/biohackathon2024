<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7852108</article-id>
    <article-id pub-id-type="pmid">33522966</article-id>
    <article-id pub-id-type="publisher-id">990</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-020-00990-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Jiarong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bolduc</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zayed</surname>
          <given-names>Ahmed A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Varsani</surname>
          <given-names>Arvind</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dominguez-Huerta</surname>
          <given-names>Guillermo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Delmont</surname>
          <given-names>Tom O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pratama</surname>
          <given-names>Akbar Adjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazitúa</surname>
          <given-names>M. Consuelo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vik</surname>
          <given-names>Dean</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8398-8234</contrib-id>
        <name>
          <surname>Sullivan</surname>
          <given-names>Matthew B.</given-names>
        </name>
        <address>
          <email>sullivan.948@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Roux</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sroux@lbl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Microbiology, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.215654.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 2636</institution-id><institution>The Biodesign Center for Fundamental and Applied Microbiomics, Center for Evolution and Medicine, School of Life Sciences, </institution><institution>Arizona State University, </institution></institution-wrap>Tempe, AZ 85287 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7836.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 1151</institution-id><institution>Structural Biology Research Unit, Department of Integrative Biomedical Sciences, </institution><institution>University of Cape Town, </institution></institution-wrap>Observatory, Cape Town, 7701 South Africa </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.460789.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 4910 6535</institution-id><institution>Génomique Métabolique, Genoscope, Institut François Jacob, CEA, CNRS, Univ Evry, </institution><institution>Université Paris-Saclay, </institution></institution-wrap>91057 Evry, France </aff>
      <aff id="Aff5"><label>5</label>Viromica, 7870582 Santiago, Chile </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Civil, Environmental and Geodetic Engineering, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Center of Microbiome Science, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.184769.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2231 4551</institution-id><institution>DOE Joint Genome Institute, Lawrence Berkeley National Laboratory, </institution></institution-wrap>Berkeley, CA 94720 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>37</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Viruses are a significant player in many biosphere and human ecosystems, but most signals remain “hidden” in metagenomic/metatranscriptomic sequence datasets due to the lack of universal gene markers, database representatives, and insufficiently advanced identification tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce VirSorter2, a DNA and RNA virus identification tool that leverages genome-informed database advances across a collection of customized automatic classifiers to improve the accuracy and range of virus sequence detection. When benchmarked against genomes from both isolated and uncultivated viruses, VirSorter2 uniquely performed consistently with high accuracy (F1-score &gt; 0.8) across viral diversity, while all other tools under-detected viruses outside of the group most represented in reference databases (i.e., those in the order <italic>Caudovirales</italic>). Among the tools evaluated, VirSorter2 was also uniquely able to minimize errors associated with atypical cellular sequences including eukaryotic genomes and plasmids. Finally, as the virosphere exploration unravels novel viral sequences, VirSorter2’s modular design makes it inherently able to expand to new types of viruses via the design of new classifiers to maintain maximal sensitivity and specificity.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">With multi-classifier and modular design, VirSorter2 demonstrates higher overall accuracy across major viral groups and will advance our knowledge of virus evolution, diversity, and virus-microbe interaction in various ecosystems. Source code of VirSorter2 is freely available (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/virsorter2">https://bitbucket.org/MAVERICLab/virsorter2</ext-link>), and VirSorter2 is also available both on bioconda and as an iVirus app on CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>).</p>
        <p id="Par4">
          <media xlink:href="40168_2020_990_MOESM1_ESM.mp4" id="MOESM1">
            <caption>
              <p>Video abstract</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-020-00990-y.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>OCE1829831</award-id>
        <award-id>ABI1758974</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0020173</award-id>
        <award-id>DE-AC02-05CH11231</award-id>
        <principal-award-recipient>
          <name>
            <surname>Roux</surname>
            <given-names>Simon</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Gordon and Betty Moore Foundation (US)</institution>
        </funding-source>
        <award-id>#3790</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par5">Microbes are now widely recognized as driving nutrient and energy cycles that fuel marine and terrestrial ecosystems [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], directly influencing human health and disease, and controlling the output of engineered ecosystems [<xref ref-type="bibr" rid="CR3">3</xref>]. This explosive paradigm shift of our perspective of microbes is derived in large part from an ability to identify the “unculturable majority.” As high-throughput gene marker and metagenomic sequencing technologies have advanced, the true taxonomic and functional diversity of microbial communities could progressively be better explored [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Discovery and identification of viral sequences was at the forefront of the metagenomic revolution [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], but early studies were plagued by the lack of marker genes and an inability to “count” appropriate units in viral sequence space [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Fortunately, relevant “units” of viral diversity, at least for dsDNA viruses, are now routinely accessible through the de novo assembly of viral genomes from metagenomes. Thus the estimated 10<sup>31</sup> viruses on the planet [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] are being rapidly surveyed across soil, ocean, and human microbiomes, commonly yielding thousands to hundreds of thousands of dsDNA viruses in a single study [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. These large-scale surveys have helped implicate viruses as key microbiome regulators infecting ecologically critical microbes, impacting biogeochemical cycles, and altering evolutionary trajectories through horizontal gene transfer [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Beyond viruses of bacteria and archaea, vast stores of previously unidentified viruses that infect eukaryotes including ssDNA viruses [<xref ref-type="bibr" rid="CR22">22</xref>], RNA viruses [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>], and giant viruses (the phylum <italic>Nucleocytoviricota</italic>, also known as NucleoCytoplasmic Large DNA Viruses [NCLDV]) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] are being identified, but are still in need of analytical approaches for systematic identification.</p>
    <p id="Par6">Given the sheer magnitude and significant importance of the virosphere across diverse ecosystems, establishing a broad genomic catalog of Earth’s viral diversity is critical. These efforts will rely on automated detection of viral genomes across a broad range of sequencing datasets [<xref ref-type="bibr" rid="CR9">9</xref>]. Currently, two general computational approaches exist to identifying viral sequences. One set of tools rely on a combination of gene content and genomic structural features to distinguish viral from microbial sequences, including Prophinder [<xref ref-type="bibr" rid="CR27">27</xref>], PhiSpy [<xref ref-type="bibr" rid="CR28">28</xref>], VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], the Earth’s Virome pipeline [<xref ref-type="bibr" rid="CR17">17</xref>], PHASTER [<xref ref-type="bibr" rid="CR30">30</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. These genomic features are either statistically compared to a null model (Prophinder, VirSorter, PHASTER), or more recently have been used as input for automatic machine-learning classifiers (MARVEL and VIBRANT). The other approach uses the frequencies of DNA “words” (i.e., k-mers) found in known viral and cellular genomes as signatures to train machine-learning classifiers to recognize new viral and microbial sequences (e.g., VirFinder and DeepVirFinder [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]). Both approaches efficiently detect common viruses that are well represented in databases, such as dsDNA bacteriophages from the <italic>Caudovirales</italic> order [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], but they struggle with less well-documented viruses like ssDNA viruses [<xref ref-type="bibr" rid="CR35">35</xref>], RNA viruses [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>], and viruses that infect archaea [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. One reason for this is that current approaches consider viruses as a single cohesive group for detection purposes, which is potentially problematic given the varied ecological and evolutionary rules that govern the diversity and evolution of different viral genomes [<xref ref-type="bibr" rid="CR40">40</xref>]. While some features may span the virosphere (e.g., enrichment of uncharacterized genes, relative to microbes), others are group-specific (e.g., hallmark genes, specific genomic structure, or the presence of metabolic genes). Though machine learning approaches based on nucleotide composition would not suffer as much from viral database representation, they tend to confuse any unusual sequence as viral (e.g., plasmids or eukaryotic genome fragments [<xref ref-type="bibr" rid="CR39">39</xref>]). Together, these observations call for the field to move beyond a single model to represent the virosphere for virus identification.</p>
    <p id="Par7">Here, we develop and introduce a new viral sequence identification tool, VirSorter2, which leverages recent sequencing efforts for under-represented viral groups to develop customized automatic classifiers that improve detection of viruses in the order <italic>Caudovirales</italic> (the focus of the original VirSorter tool [<xref ref-type="bibr" rid="CR29">29</xref>]), while also identifying other major virus groups across a broad range of hosts, genome lengths, and genome complexity. VirSorter2 is designed modularly, enabling easy update of reference databases and individual classifiers as new viral groups are progressively described and characterized.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>The VirSorter2 framework</title>
      <p id="Par8">Viral sequence identification in VirSorter2 occurs via three steps: (i) input sequences are automatically annotated and relevant features are extracted, (ii) each sequence is scored independently using a set of classifiers customized for individual viral groups, and (iii) these scores are aggregated into a single prediction provided to the user (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Annotation of the input sequences follows current standards in the field [<xref ref-type="bibr" rid="CR9">9</xref>] including coding sequence (CDS) identification with Prodigal (version 2.6.3) [<xref ref-type="bibr" rid="CR41">41</xref>], and annotation of predicted CDS using HMMER3 (version 3.3) [<xref ref-type="bibr" rid="CR42">42</xref>] against Pfam (release 32.0) [<xref ref-type="bibr" rid="CR43">43</xref>] and a custom comprehensive viral HMM database including Xfams (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from the JGI Earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>]. Within this custom viral HMM database, profiles corresponding to viral hallmark genes were manually identified based on functional annotation and distribution across viral and microbial genomes for different viral groups. These include structural genes such as major capsid protein (MCP) or terminase large subunit for viruses in the order <italic>Caudovirales</italic> (as done in the original VirSorter); RNA-dependent RNA polymerase (RdRP) for the viral kingdom <italic>Orthornavirae</italic> (RNA viruses); MCP for viruses in the family <italic>Microviridae</italic>; replication-associated protein for viruses in the phylum <italic>Cressdnaviricota</italic> [<xref ref-type="bibr" rid="CR44">44</xref>]; ATPase for viruses in the family <italic>Inoviridae</italic>; MCP, pATPase, primase, transcription elongation factor (TFIIS), and viral late gene transcription factor (VLTF3) for viruses in the phylum <italic>Nucleocytoviricota</italic> (i.e., nucleocytoplasmic large DNA viruses; NCLDVs); and MCP for viruses in the family <italic>Lavidaviridae</italic> (virophages) [<xref ref-type="bibr" rid="CR40">40</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the VirSorter2 framework. Schematic of the viral prediction pipeline used in VirSorter2. “hmmDB” represents databases of HMM profiles including viral HMMs from Xfam (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from JGI Earth’s Virome [<xref ref-type="bibr" rid="CR17">17</xref>], and cellular HMMs (archaeal, bacterial, eukaryotic) as well as “mixed” HMMs (not specific to either virus or cellular organisms) from Pfam [<xref ref-type="bibr" rid="CR43">43</xref>]. A default cutoff of 30 is used for the HMM searches. “Classifiers” refers to random forest classifiers trained on known viral genomes and cellular genomes from different viral groups (see “<xref rid="Sec12" ref-type="sec">Training classifiers</xref>” section in “Methods”). The default max score cutoff is set to 0.5</p></caption><graphic xlink:href="40168_2020_990_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par9">Different features were extracted from these annotations (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These features were then used as input for five distinct random forest classifiers, each associated with a different major type of viral group. These classifiers were trained on reference virus sequences from NCBI RefSeq and high quality genomes from new unpublished isolates (ssDNA) [<xref ref-type="bibr" rid="CR22">22</xref>], metagenomes [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>], and proviruses, i.e., viral genomes residing in bacteria or archaeal host cell [<xref ref-type="bibr" rid="CR48">48</xref>] (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Each classifier yields a “viralness” score, which can be used to determine the likelihood of the input sequence to represent a partial or complete genome from the corresponding viral group.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Features used in Virsorter2, VirSorter, and MARVEL. Detailed explanation of each feature is provided in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section. In VirSorter, features 3 to 6 are summed up as one feature (% of Pfam affiliated genes)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>VirSorter2</th><th>VirSorter</th><th>MARVEL</th></tr></thead><tbody><tr><td>1. Hallmark gene count</td><td>x</td><td>x</td><td/></tr><tr><td>2. % of viral genes</td><td>x</td><td>x</td><td>x</td></tr><tr><td>3. % of archaeal genes</td><td>x</td><td rowspan="4">x</td><td/></tr><tr><td>4. % of bacterial genes</td><td>x</td><td/></tr><tr><td>5. % of eukaryotic genes</td><td>x</td><td/></tr><tr><td>6. % of mixed genes</td><td>x</td><td/></tr><tr><td>7. % of unaligned genes</td><td>x</td><td>x</td><td/></tr><tr><td>8. Average gene size</td><td>x</td><td>x</td><td>x</td></tr><tr><td>9. Gene overlapping frequency</td><td>x</td><td/><td/></tr><tr><td>10. Gene density</td><td>x</td><td>x</td><td>x</td></tr><tr><td>11. Strand switching frequency</td><td>x</td><td>x</td><td>x</td></tr><tr><td>12. % of ATG as starting codon</td><td>x</td><td/><td>x</td></tr><tr><td>13. % of GTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>14. % of TTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>15. Mean of GC content</td><td>x</td><td/><td/></tr><tr><td>16. SD of GC content</td><td>x</td><td/><td/></tr><tr><td>17–27. % of RBS motifs</td><td>x</td><td/><td/></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>Boxplot of different features across non-viral and viral groups. “Nonviral” includes bacteria and archaea, fungi and protozoa, and plasmids. A subset of 100 random genome fragments were used for each group. “% of viral gene” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “% of bacterial gene” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “Strand switch frequency” is the percent of genes located on a different strand from the upstream gene (scanning from 5′ to 3′ in the + strand); “Gene density” is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiplied by 1000); “Average GC content of genes” is the mean of GC content of all genes in a contig; “TATATA_3-6 motif frequency” is the percent of ribosomal binding sites (RBS) with “TATATA_3-6” motif</p></caption><graphic xlink:href="40168_2020_990_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">To train the different classifiers, reference genomes for each viral group were split into training and testing sets with a 9 to 1 ratio, respectively, and 5 random fragments were generated from each genome starting at a random position and with size ranging from 1 kb to complete genomes. Separate classifiers were trained for the following viral groups (i) caudovirids (<italic>Caudovirales</italic>) and comparable dsDNA phages (e.g., corticovirids), (ii) NCLDVs, (iii) RNA viruses, (iv) ssDNA viruses, and (v) lavivirids (<italic>Lavidaviridae</italic>). Separately, a negative (non-viral) dataset was generated from genomes of three groups: (i) bacteria and archaea, (ii) eukaryotes (fungi and protozoa), and (iii) plasmids. The training and testing sets for non-viral genomes were generated the same way as the viral set described above.</p>
      <p id="Par11">For each input sequence to be classified, all random forest classifiers are first applied to the entire sequence. If the score obtained with one or more of the classifiers is above the cutoff set by the user (the default was 0.5, as used in the classifier training step), the score is considered significant and the sequence was considered as entirely or near-entirely viral. To identify potential host regions on the edge of these contigs, sub-sequences of the input sequence with 0 to 5 genes or 10% of total genes (whichever larger) trimmed in 5′ and/or 3′ processed with the same classifiers, and selected if the viralness score increased compared to the full sequence. If no score was significant when analyzing the complete sequence, the same classifiers are applied to sliding windows across the input sequence. The size of the sliding window was determined separately for each classifier as the minimal size of a genome from the corresponding viral group (Table <xref rid="MOESM2" ref-type="media">S1</xref>). The sliding window starts from the 5′ edge of a contig and shifts one gene at a time while there is no significant score. For each window yielding a significant score, this window is extended one CDS at a time in 3′ as long as the score stays significant. Eventually, overlapping regions identified by different classifiers are compared and the longest prediction is retained.</p>
    </sec>
    <sec id="Sec4">
      <title>Expanded and manually curated databases enable a robust detection of viruses in the order <italic>Caudovirales</italic></title>
      <p id="Par12">We first evaluated the new VirSorter2 approach on genomes in the order <italic>Caudovirales</italic>. As described above, test sequences included both phage isolate sequences from NCBI Viral RefSeq [<xref ref-type="bibr" rid="CR49">49</xref>] and uncultivated phage genomes obtained from metagenomes or identified as proviruses in bacterial and archaeal whole genome shotgun sequencing ([<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR48">48</xref>], see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Test sequences also did not overlap with the references used to train the classifier. As negative control, the same number of sequences from the non-viral testing set were included. The same test sequences were also processed with established viral sequence detection tools including VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], VirFinder [<xref ref-type="bibr" rid="CR33">33</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. The overall performance of each tool was evaluated using the F1 score, which represents the harmonic mean of precision and recall [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par13">Overall, all tools performed well in the identification of viral sequences in the order <italic>Caudovirales</italic> from RefSeq, as they all displayed F-score ≥ 0.8 with sequences 5 kb and longer (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). As previously observed [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], all approaches also displayed a decreased accuracy with shorter sequences, especially when reaching lengths of ~ 1–2 kb (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). While increased accuracy with sequence length was also observed when evaluating the same tools with uncultivated viral sequences of the order <italic>Caudovirales</italic>, the overall performance of several tools was lower (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). Specifically, the performance of VirSorter, VirFinder, DeepVirFinder, and MARVEL was decreased by 10–30%, while VIBRANT and VirSorter2 displayed F-score comparable to those when evaluated with the RefSeq sequences (± 5%), likely due to their larger reference database and their ability to use hallmark genes to identify viruses only distantly related to RefSeq genomes. Similar results were obtained when analyzing viral sequences, either from RefSeq or uncultivated, for which &lt; 25% of the genes were annotated as viral based on the custom HMM database (Fig. <xref rid="MOESM2" ref-type="media">S3</xref>), confirming that the differences in tool performances were mostly due to the ability to identify novel viruses. To verify that the VirSorter2 approach was similarly efficient for integrated proviruses, we processed bacterial genomes from a gold-standard set of 51 microbial genomes [<xref ref-type="bibr" rid="CR51">51</xref>] for which 82 integrated proviruses have been manually curated. As for viral contigs, VirSorter2 recall and precision was comparable or higher to all other tools (Table <xref rid="Tab2" ref-type="table">2</xref>). Overall, the approach used by VirSorter2 to identify <italic>Caudovirales</italic> is thus on par or more efficient than other recently published tools for both isolate and environmental sequences, across a broad range of contig length, and for sequences both entirely and partially viral. The only exception was for viral contigs of &lt; 3 kb that have representation in NCBI RefSeq, which were better recovered by kmer-based methods such as VirFinder and DeepVirFinder (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Tool performances on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (<italic>x</italic>-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (<bold>a</bold>), proviruses extracted from microbial genomes in NCBI RefSeq (<bold>b</bold>) [<xref ref-type="bibr" rid="CR48">48</xref>], and other sources (<bold>c</bold>) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). F1 score is used as the metric (<italic>y</italic>-axis) to compare tools, while detailed recall and precision results are available in Figs. <xref rid="MOESM4" ref-type="media">S1</xref> and <xref rid="MOESM4" ref-type="media">S2</xref>. The dotted line is <italic>y</italic> = 0.8</p></caption><graphic xlink:href="40168_2020_990_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of VirSorter2 and previously published prophage identification tools when calling proviruses from the standard dataset described in Casjens [<xref ref-type="bibr" rid="CR51">51</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>PHAST (all categories)</th><th>PHAST (no questionable)</th><th>PhiSpy</th><th>Phage Finder</th><th>VirSorter (categories 1 and 2)</th><th>Virsorter (ll categories)</th><th>VirSorter2</th></tr></thead><tbody><tr><td>Recall</td><td>84.27%</td><td>70.04%</td><td>78.28%</td><td>64.42%</td><td>73.41%</td><td>79.30%</td><td>94.38%</td></tr><tr><td>Precision</td><td>83.03%</td><td>82.74%</td><td>73.59%</td><td>79.26%</td><td>92.89%</td><td>72.24%</td><td>73.04%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Dedicated custom models allow identification of diverse viral sequences</title>
      <p id="Par14">We next reasoned that, since different viral groups have different defining characteristics, a single model was unlikely to efficiently handle the entire viral diversity. Hence, just as viral taxonomists have to use different characteristics to classify viruses across the known virosphere [<xref ref-type="bibr" rid="CR52">52</xref>], different rules would be needed to robustly identify different types of viruses in nature instead of the single model used by all other tools available to date, including the original VirSorter. To demonstrate the effectiveness of this multi-classifier approach, we focused our efforts on four major virus groups outside the order <italic>Caudovirales</italic> where significant data and expertise have accumulated—ssDNA viruses, RNA viruses, NCLDV, and lavidavirids (virophages)—as described above.</p>
      <p id="Par15">Comparing the range and median value of each feature between groups confirmed that features such as gene density or percentage of viral gene could clearly differ between groups (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The relative importance of each feature in individual classifiers was also variable between different groups, confirming fundamental differences in genome organization and content between viruses (Fig. <xref rid="MOESM2" ref-type="media">S4</xref>). Comparing the performance of VirSorter2 to other existing approaches on these non-<italic>Caudovirales</italic> viruses demonstrated that most of the tools evaluated were not able to consistently identify these sequences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Overall, current virus detection tools typically struggled with at least one type of non-<italic>Caudovirales</italic> virus, and also showed reduced performance for sequences not currently part of NCBI Viral RefSeq, i.e., more distantly related to known references. Meanwhile, VirSorter2 was the only tool which displayed F1-scores &gt; 0.8 across all groups for contigs 5 kb and longer, and always had the highest F-score for all contigs ≥ 3 kb except for RNA viruses from RefSeq where DeepVirfinder performed better. Through its modular framework, VirSorter2 is thus uniquely able to reliably detect different types of non-<italic>Caudovirales</italic> viruses. Importantly however, VirSorter2’s F1-score substantially decreased for sequences &lt; 3 kb, as previously observed for the viruses in the order <italic>Caudovirales</italic>, due to loss of sensitivity (Figs. <xref rid="MOESM2" ref-type="media">S5</xref> and <xref rid="MOESM2" ref-type="media">S6</xref>). Thus, the VirSorter2 approach is currently not optimal for short (&lt; 3 kb) contigs.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Tool performances on different viral groups (other than dsDNA phage) from different data sources. VirSorter2 consistently outperforms existing tools in identifying viral groups outside dsDNA phages Genome fragments of different lengths (<italic>x</italic>-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. “RNA-non-refseq*” is a collection of ssRNA phage genomes [<xref ref-type="bibr" rid="CR45">45</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (<italic>y</italic>-axis) to compare tools. The dotted horizontal line is <italic>y</italic> = 0.8. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par16">The decrease in F1-score between VirSorter2 and the next best tool varied between groups and lengths, from 4.4% for the ssDNA to 31.8% for NCLDV on average with sequences longer than 5 kb, highlighting that some groups benefited from a separate classifier more than others (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Pragmatically, this means that lavidavirid gene content and genome structure may be close enough to the “extended <italic>Caudovirales</italic>” group that it could potentially be included in the same classifier, whereas NCLDV and ssDNA viruses are better identified when considered separately. VirSorter2 was thus designed modularly to enable modification and addition of new classifiers as our knowledge of viral sequence space increases.</p>
    </sec>
    <sec id="Sec6">
      <title>Plasmids and eukaryotic genomes represent unique challenges for viral detection tools</title>
      <p id="Par17">While initial tests were performed using random fragments of bacterial and archaeal genomes as non-virus sequences, previous studies showed that eukaryotic genome and plasmid fragments were especially prone to be mis-identified as a putative viral sequence [<xref ref-type="bibr" rid="CR39">39</xref>]. We thus evaluated how VirSorter2 and other tools handled both eukaryotic and plasmid sequences, by processing datasets entirely composed of eukaryotic genome fragments or plasmid fragments and measuring at which frequency these would be wrongly considered as viral (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>False positives comparison of tools on eukaryotes and plasmids. Genome fragments (50) of different lengths (<italic>x</italic>-axis) were generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral is used as the metric (<italic>y</italic>-axis) to compare tools. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par18">For eukaryotic genomes, both MARVEL and VirSorter showed high specificity with 2.4% and 0.1% false positives on average respectively, while VirSorter2 and VIBRANT displayed on average 12.1% and 20.9% of false positives respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). The error rate was consistent across sequence length for all tools except for VirSorter2, where this error rate decreased quickly when sequence length increased, to reach &lt; 1% for fragments ≥ 20 kb. These differences in specificity are consistent with the original scope of the tools: both VirSorter and MARVEL were designed to identify bacteriophages and archaeoviruses [<xref ref-type="bibr" rid="CR29">29</xref>]. While they do not mistake eukaryotic sequences as viral, they also poorly detect eukaryotic viruses such as NCLDV (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). VirSorter2 and VIBRANT are both able to recover eukaryotic virus sequences, such as NCLDV, and RNA viruses, but do so at the cost of a specificity loss that is relatively similar across the two tools. However, VirSorter2’s modular framework can be leveraged by users interested in particular subsets of viruses to reduce these losses. For example, to target viruses of bacteria and archaea, users can omit the NCLDV, <italic>Lavidaviridae</italic>, and RNA virus classifiers to drop VirSorter2 error rate associated with eukaryotic genomes, as demonstrated by a reduction in false-positive rate to &lt; 1.5% for all fragment lengths on average (Fig. <xref rid="MOESM2" ref-type="media">S7</xref>). Finally, both VirFinder and DeepVirFinder were most likely to mistake eukaryotic sequences as viruses as they had more than double the false positive rate of VirSorter2 (21.7% for VirFinder, 32.1% for DeepVirFinder on average). This high eukaryote-for-virus error rate for k-mer-based methods, including for large (20 kb) sequences, is a known limitation of these approaches [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par19">In contrast to eukaryotic genome sequences, no tool performed well against plasmid sequences (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). This included both gene-content and k-mer based tools, and stayed true even for large plasmid fragments (e.g., ≥ 20 kb) for which the error rate ranged between 6.4 and 42.0% for all tools. This highlights how plasmid sequences cannot be entirely distinguished from viruses using current approaches and suggests that alternative methods need to be designed for this purpose. Given the growing list of examples of how plasmid and viral sequence space are intertwined [<xref ref-type="bibr" rid="CR54">54</xref>–<xref ref-type="bibr" rid="CR57">57</xref>], significant work in this area will presumably be required, including possibly the incorporation of a dedicated tool for plasmid detection in VirSorter2 modular framework.</p>
    </sec>
    <sec id="Sec7">
      <title>VirSorter2 is easily available and can be scaled to handle large-scale datasets</title>
      <p id="Par20">Beyond accurate and sensitive virus identification, scalability to process large (&gt; 100,000 sequences) datasets and broad availability for users regardless of their knowledge of command-line or scripting are desirable traits in virus sequence detection tools. For the former, VirSorter2 can process an input dataset of 100,000 sequences totaling 4.2 Gb in 28.6 h using 32 threads. Its memory usage stays nearly constant with increasing data size, and scales nearly linearly with threads used (Figs. <xref rid="MOESM2" ref-type="media">S8</xref> &amp; <xref rid="MOESM2" ref-type="media">S9</xref>). Its total CPU time is higher than other tools (typically 2–10× higher, Fig. <xref rid="MOESM2" ref-type="media">S8</xref>), but VirSorter2’s internal processes are highly parallelizable, and written with snakemake, a cutting-edge pipeline management tool designed for computer clusters [<xref ref-type="bibr" rid="CR58">58</xref>]. VirSorter2 is thus able to utilize multiple cores in the same node and across multiple nodes efficiently, so that compute time would not be a limiting factor even for (ultra)large-scale datasets if state-of-the-art computing cluster resources are available (Fig. <xref rid="MOESM2" ref-type="media">S9</xref>). Further, this increased CPU time is mostly due to the annotation step with larger viral HMM database (&gt; 90% of CPU time) and not to the use of several distinct classifiers, suggesting that additional viral groups and classifiers could be added to the VirSorter2 framework with minimal impact on performance. Finally, users can explore the annotation and per-model score computed by VirSorter2 for each individual sequence, and can generate new output files using different options and cutoffs based on an existing VirSorter2 directory without having to re-compute the annotation step. To illustrate this and other differences between VirSorter and VirSorter2, we provide a detailed analysis of viral sequence detection from an ocean virome using both VirSorter and VirSorter2 (<xref rid="MOESM3" ref-type="media">Supplementary Text</xref>, Fig. <xref rid="MOESM2" ref-type="media">S10</xref>, Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>).</p>
      <p id="Par21">In order to make VirSorter2 useful for the largest community possible, we provide it through multiple implementations and accompanied with extended documentation. Specifically, VirSorter2 is freely available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>), as an App on the CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>), and available for local installation through a bioconda package (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). In addition, we provide an extensive step-by-step tutorial on how to run VirSorter2 and how to design new classifiers for additional viral groups and integrate this within a local VirSorter2 instance on protocols.io/VERVENET (<ext-link ext-link-type="uri" xlink:href="https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e">https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e</ext-link>).</p>
    </sec>
    <sec id="Sec8">
      <title>Current limitations and future developments</title>
      <p id="Par22">Together, these benchmark experiments demonstrate that by integrating multiple classifiers, each customized for a specific viral group, VirSorter2 vastly improves the diversity of viruses that can be automatically detected from environmental sequence data. However, we note several limitations that will benefit from future improvements in our understanding of the virosphere and technical capabilities.</p>
      <p id="Par23">First, while separating the global viral diversity in different groups clearly improved viral sequence detection, there is currently no automated process to optimally group reference viral sequences into different viral classifiers. If the viral groups selected are too large and/or diverse, the corresponding classifier would likely suffer from the same flaw as previous tools, whereby rare members would be under-detected. Conversely, classifiers designed for groups lacking diverse representation will show reduced accuracy, due to an under-trained random forest classifier being unable to extract meaningful identifying features for the group. Thus, further virosphere exploration and systematic classification is critical to provide the training data needed to optimize detection.</p>
      <p id="Par24">Second, some viral groups may require additional references and/or features to achieve a systematic and robust identification. The limits associated with reference sequences are shared by all viral sequence identification tools: as new viral genomes and groups are discovered, e.g., high-quality genomes assembled from metagenomes [<xref ref-type="bibr" rid="CR59">59</xref>], these need to be integrated into virus detection approach to keep these up-to-date. This iterative process is now facilitated by the modular framework of VirSorter2, for which we provide a detailed step-by-step protocol to add additional viral groups and classifiers. The addition of other features would also be a possible avenue for extending the range and/or accuracy of VirSorter2. Contrary to the addition of new viral groups, integrating new feature(s) would require substantial modification of VirSorter2 code, and would thus be only associated with the release of new versions of the tool.</p>
      <p id="Par25">Finally, while run times and computational resources required by VirSorter2 are compatible with modern omics datasets, the size of these datasets will likely keep increasing over the next few years, and may eventually limit the usefulness of VirSorter2. Given that most of the computation time is currently dedicated to the annotation step, this issue will require integration of scalable and improved sequence comparison tools (e.g., MMSeqs2 [<xref ref-type="bibr" rid="CR60">60</xref>], HHBlits [<xref ref-type="bibr" rid="CR61">61</xref>]) and/or new versions of the tools currently used.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par26">The automatic extraction of viral sequences from large-scale sequencing data is now a cornerstone of the current viral ecogenomics toolkit. Identifying viral genomes from omics data enables unprecedented studies of viral taxonomic diversity [<xref ref-type="bibr" rid="CR62">62</xref>], viral population distribution and associated eco-evolutionary constraints [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR47">47</xref>], and viral potential for microbial metabolic reprogramming [<xref ref-type="bibr" rid="CR20">20</xref>]. While current tools typically detect known and “standard” viruses, i.e., viruses in the order <italic>Caudovirales</italic>, pretty well, the approaches available to date remain challenged by novel and/or unusual viral groups. VirSorter2 now provides a framework to go beyond the detection of viruses in the order <italic>Caudovirales</italic> and enables robust detection of all types of viruses in sequencing data. By defining subgroups of viruses with consistent genome features and unique markers, the VirSorter2 framework is designed to grow as databases do such that new viral diversity can be readily detected in large-scale datasets. This will in turn enable researchers to investigate the role(s) played by all viruses across Earth’s biomes, and better understand how these viruses constrain fundamental microbial processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Viral HMM database</title>
      <p id="Par27">The viral HMM database includes viral HMMs from viral protein families (VPF) of JGI earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>] and Xfams (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm">https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm</ext-link>). Xfams were generated from a large collection of viral sequences from the Global Ocean Viromes 2.0 (GOV 2.0) [<xref ref-type="bibr" rid="CR16">16</xref>] and the Stordalen Mire Viromes (SMV) [<xref ref-type="bibr" rid="CR63">63</xref>]. Briefly, viral contigs were identified by VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], and MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>]. The intersection between the three tools (Category 1 in VirSorter with “--virome” mode, score ≥ 90% in Marvel, and a score of ≥ 0.9 with a <italic>p</italic> value of &lt; 0.05 in DeepVirFinder), were kept. Open reading frames (ORF) were predicted using prodigal with “--meta” mode [<xref ref-type="bibr" rid="CR41">41</xref>], filtered by removing ones with ≥ 95% similarity to RefSeq’s bacterial and archaeal proteins, and then clustered by ClusterONE [<xref ref-type="bibr" rid="CR64">64</xref>] to get rid of singletons (-d 0.3 -s 0.2 --max-overlap 0.8). Multiple sequence alignments were generated for each cluster by MUSCLE (--maxiters 4) [<xref ref-type="bibr" rid="CR65">65</xref>], and then made into HMMs by hmmbuild in HMMER3 package [<xref ref-type="bibr" rid="CR66">66</xref>]. More details of Xfams can be found at iVirus in CyVerse’s Discovery Environment (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de/</ext-link>): /iplant/home/shared/iVirus/Xfams/version_0.5/Xfams-XC.</p>
    </sec>
    <sec id="Sec12">
      <title>Training classifiers</title>
      <p id="Par28">NCBI RefSeq genomes including archaea, bacteria, protists, fungi, and virus were downloaded from NCBI (ftp://<ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nlm.nih.gov/genomes/refseq">ftp.ncbi.nlm.nih.gov/genomes/refseq</ext-link>) on 2020-01-12. Viral genomes from the order <italic>Caudovirales</italic> were used for dsDNA phage; genomes from the families <italic>Mimiviridae</italic>, <italic>Phycodnaviridae</italic>, <italic>Faustoviridae</italic>, <italic>Iridoviridae</italic>, <italic>Marseilleviridae</italic>, <italic>Ascoviridae</italic>, <italic>Pithoviridae</italic>, <italic>Poxviridae</italic>, and <italic>Pandoraviridae</italic> were used for NCLDV; genomes from the realm <italic>Riboviria</italic> were used for RNA viruses; genomes from the families <italic>Bacilladnaviridae</italic>, <italic>Circoviridae</italic>, <italic>Geminiviridae</italic>, <italic>Nanoviridae Genomoviridae</italic>, <italic>Parvoviridae</italic>, <italic>Microviridae</italic>, <italic>Smacoviridae</italic>, <italic>Alphasatellitidae</italic>, <italic>Tolecusatellitidae</italic>, <italic>Anelloviridae</italic>, <italic>Bidnaviridae</italic>, <italic>Pleolipoviridae</italic>, <italic>Spiraviridae</italic>, and <italic>Inoviridae</italic> were used for ssDNA viruses; genomes from the family <italic>Lavidaviridae</italic> were used for <italic>Lavidaviridae</italic> classifier. Other than NCBI RefSeq genomes, a set of high-quality genomes was also obtained from the literature [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>] and unpublished ssDNA virus genome data (Varsani, unpublished data). These genomes were identified based on VirSorter1, VirFinder, or using custom pipelines, and were further analyzed and manually curated as part of their respective publication. Hence, they represent useful examples of “novel” viruses, often distantly related to RefSeq reference genomes. The genomes of all viral and non-viral groups were split into “training” and “testing” sets with a 9 to 1 ratio, respectively. The “training” sets from RefSeq and non-RefSeq sources were combined. For viral genomes, five fragments were generated starting at a random genome position with length ranging from 1000 bp to the maximal length (extending to the end of genome). For bacteria, archaea, and eukaryotes, five fragments were generated from a representative genome from each genus in the same way as described above; for plasmids, because no systematic global classification is available and the total number of plasmids in the input dataset [<xref ref-type="bibr" rid="CR67">67</xref>] was only 6642 sequences, five fragments were generated from each sequence. The generated fragments from each of the three non-viral groups (bacteria and archaea, eukaryotes, and plasmids) were subsampled to the minimum within these three negative groups (bacterial and archaea, eukaryotes, and plasmids) and combined as a final “negative set.” For each viral group, the viral “training set” and the non-viral “training set” were evenly subsampled to the smaller size between the two, and then used for training the classifier. Then the following 27 features were extracted from each sequence fragment:
<list list-type="order"><list-item><p id="Par29">“Hallmark gene count” is the count of hallmark genes in a viral sequence</p></list-item><list-item><p id="Par30">“% of viral genes” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes</p></list-item><list-item><p id="Par31">“% of archaeal genes” is calculated as the percent of genes annotated as archaeal (best hit to archaeal HMMs) of all genes</p></list-item><list-item><p id="Par32">“% of bacterial genes” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes</p></list-item><list-item><p id="Par33">“% of eukaryotic genes” is calculated as the percent of genes annotated as eukaryotic (best hit to eukaryotic HMMs) of all genes</p></list-item><list-item><p id="Par34">“% of mixed genes” is calculated as the percent of genes with best hit to HMMs shared between viruses and cells</p></list-item><list-item><p id="Par35">“% of unaligned genes” is calculated as the percent of genes with no hits to HMMs in the VirSorter2 HMM database (bit score cutoff 30)</p></list-item><list-item><p id="Par36">“Average gene size” is the mean of gene sizes in a viral sequence</p></list-item><list-item><p id="Par37">“Gene overlapping frequency” is the percent of consecutive genes that are on the same strand and overlap when scanning from 5′ to 3′ on the + strand</p></list-item><list-item><p id="Par38">“Gene density” is the average number of genes in every 1000 bp sequence window (total number of genes divided by contig length and then multiplied by 1000)</p></list-item><list-item><p id="Par39">“Strand switching frequency” is the percent of genes located on the opposite strand from the gene upstream (scanning from 5′ to 3′ in the + strand)</p></list-item><list-item><p id="Par40">“% of ATG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par41">“% of GTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par42">“% of TTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par43">“Mean of GC content” is the mean of GC content of all genes in a sequence</p></list-item><list-item><p id="Par44">“SD of GC content” is the standard deviation of GC content of all genes in a sequence</p></list-item><list-item><p id="Par45">“% of RBS motifs” is percent of ribosomal binding sites (RBS) with a specific motif. There are 11 types of motifs included: SD_Canonical, SD_Bacteroidetes, TATATA_3-6, OnlyA, OnlyT, DoubleA, DoubleT, Other_GA, NoA, Other, and None (no motif found) [<xref ref-type="bibr" rid="CR19">19</xref>].</p></list-item></list></p>
      <p id="Par46">Features 8–27 are all extracted from the gff output from prodigal [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par47">With the above features, “RandomForestClassifier” in scikit-learn package [<xref ref-type="bibr" rid="CR50">50</xref>] was used to train the random forest classifier. “MinMax” scaler was used to scale all the feature data, and “GridSearchCV” was used to find optimal parameter sets among “n_estimators” of 20, 50, 100, 150, 200, and “criterion” of gini or entropy.</p>
    </sec>
    <sec id="Sec13">
      <title>Accuracy</title>
      <p id="Par48">To compare the accuracy of VirSorter2 to other viral identification tools, datasets with equal number (50) of viral and non-viral random DNA fragments were generated from the testing set created above and with different lengths (1.5, 3, 5, 10, and 20 kb) to discern the impact of sequence length on accuracy. VirSorter2 (version 2.0.beta) was run with “--include-groups dsDNAphage, NCLDV, RNA, ssDNA, lavidaviridae, --min-score 0.5,” and sequences in “final-viral-combined.fa” were considered as viral. VirSorter (version 1.1.0) was run with “--db 2 --virome –diamond,” and sequences in categories 1, 2, 4 and 5 were considered as viral; VIBRANT (version 1.2.1) was run with “--virome -f nucl”, and sequences in “VIBRANT_*/VIBRANT_phages_*/*.phages_combined.fna” were considered as viral; VirFinder (version 1.1) was run with VF.pred function within R as described in (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/VirFinder">https://github.com/jessieren/VirFinder</ext-link>); DeepVirFinder was installed directly from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/DeepVirFinder">https://github.com/jessieren/DeepVirFinder</ext-link>) with last commit ID of ddb4a9433132febe5cda39548cb9332669e11427 and was run with default parameters; for both VirFinder and DeepVirFinder, sequences with p value &lt; 0.05 were chosen as viral. Since MARVEL (version 0.2) required each viral genome as a separate file, input sequences were first split so that each sequence was an individual sequence file, and then default parameters were used, and the sequences in “results/phage_bins” were considered as viral. F1 score (harmonic mean of recall and precision) was used as a metric for tool accuracy comparisons. For measuring false positives on eukaryotic and plasmid sequences, the fraction of eukaryotic or plasmid sequences classified as viral were calculated. To test performance on provirus detection, 54 bacterial genomes with known provirus boundary [<xref ref-type="bibr" rid="CR51">51</xref>] were used. VirSorter2 was run with the “--include-groups all, --min-score 0.5” flag. If a provirus has ≥ 50% of its genome recovered, it was considered as a true positive, and the VirSorter2 identified viral sequences without any true positives identified in them were considered as false positives. Recall and precision of other tools [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR68">68</xref>, <xref ref-type="bibr" rid="CR69">69</xref>] were retrieved from the original VirSorter benchmarking experiments [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Computational efficiency</title>
      <p id="Par49">To measure how tools scale with input data size, datasets with 10, 100, and 1000 sequences of 10 kb in length were generated in the same way as in accuracy benchmarking described above. To measure multithreading efficiency, datasets with 1000 sequences of 10 kb were generated and used as an input for VirSorter2, VirSorter, MARVEL, and VIBRANT were run with 1, 2, 4, 8, 16, 32 threads. VirFinder was not included since it did not have a multi-threading option. DeepVirFinder had unexpected behavior with its multi-threading option (“-c”), i.e., the “-c” option could not control thread number, so was also not included. CPU time and run time was measured with “/usr/bin/time -v” command available in the Linux operating system and peak memory was measure with “memusg” script (<ext-link ext-link-type="uri" xlink:href="https://gist.github.com/netj/526585">https://gist.github.com/netj/526585</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2020_990_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Recall comparisons of tools on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Recall is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S2.</bold> Precision comparisons of tools on dsDNA phages from different data sources. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Precision is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S3.</bold> Tool performances with viral sequences having &lt; 25% of the genes annotated as viral. Genome fragments of different lengths (x-axis) were generated from <italic>Caudovirales</italic> genomes from both NCBI RefSeq genomes and other sources. Only data sources with &gt; 10 viral sequences that have &lt; 25% genes annotated as viral were kept. Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (y-axis) to compare tools. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S4.</bold> Importance of different features for viral sequence identification across viral groups. The y-axis shows the relative contribution of individual features in separating the training viral and nonviral (bacterial and archaea, fungi and protozoa, and plasmid) data (total is 1), provided by the Random Forest classifier after processing training data, and based on the F1 score. Top four features from each viral group (10 in total) are shown. In the features (color), “vir” (% of viral genes) is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “bac” (% of bacterial genes) is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “hallmark” (hallmark gene count) is the count of hallmark genes in a viral sequence; “mix” (% of mixed genes) is calculated as the percent of genes with best hit to HMMs not specific to virus or non-virus; “Strand_switch_perc” (Strand switching frequency) is the percent of genes located on a different strand from the previous gene (scanning from 5′ to 3′ in the + strand); “density” (Gene density) is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiply by 1000); “gc_mean” (Mean GC content) is the mean of GC content of all genes in a contig; “atg_perc” (% of ATG as start codon) is the percent of genes with ATG as a starting codon; “rbs_None” is the percent of ribosomal binding sites (RBS) with no motif detected; “rbs_TATATA_3-6” is the percent of RBS with “TATATA_3-6” motif. <bold>Figure S5.</bold> Recall comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Recall was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S6.</bold> Precision comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Precision was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S7.</bold> False positives by VirSorter2 on eukaryotes and plasmids. Genome fragments (50) of different lengths (x-axis) are generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral was used as the metric (y-axis) to evaluate tools. Plot A and C show contribution of each classifier (color) to total false positives in VirSorter2 (as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>) for eukaryotes and plasmid respectively. Plot B and D show the total false positive in VirSorter2 after excluding NCLDV, RNA, and <italic>Lavidaviridae</italic> classifiers. vs2 = VirSorter2. <bold>Figure S8.</bold> CPU time and peak memory comparison among tools across data sizes. Tools were run on different input sizes of 10, 100, 1000 sequences with 10 kb in length. Plot (A) shows all tools scale nearly linearly with data size, and (B) shows peak memory usage of all tools are &lt;1 GB. VirSorter2 and VirFinder peak memory usage stay nearly constant. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S9.</bold> Multi-threading efficiency comparison among tools. Tools were run on 1000 sequences with 10 kb in length. Plot (A) shows VirSorter2 and VIBRANT have the best multi-threading efficiency, i.e. total run time decreases nearly linearly with the number of threads used. VirSorter can not use more than four threads. MARVEL’s multi-threading option does not significantly reduce run time. Plot (B) shows VirSorter2, VirSorter and VIBRANT memory usage increases with the number of threads used, with VirSorter2 and VIBRANT increasing at a higher rate than VirSorter. MARVEL’s memory usage stayed constant. vs2 = VirSorter2; vs1 = VirSorter; mv = MARVEL; vb = VIBRANT. <bold>Figure S10.</bold> Overview of VirSorter2 results for <italic>Tara</italic> Oceans virome 85_SRF. A. Detection of viral contigs via VirSorter 1.0.4 and VirSorter 2.0.beta by contig size. The top panel displays the total number of viral contigs identified in each size class, while the bottom panel indicates the overlap between these predictions. B. Distribution of VirSorter 2.0.beta score (maximum score across all 5 classifiers, y-axis) for <italic>Tara</italic> Oceans virome 85_SRF sequences, according to the confidence category estimated by VirSorter1 (x-axis). “NA” indicates contigs that were not detected as viral by VirSorter1. VirSorter 2.0.beta detections were based on a minimum score cutoff of 0.5. C. Proportion of sequences from Tara Oceans virome 85_SRF detected as viral based on the dsDNAphage, RNA, and/or ssDNA model(s) (red) or detected based on the NCLDV or <italic>Lavidaviridae</italic> classifiers only, by size class (x-axis). <bold>Table S1.</bold> Summary statistics of the genomes used for training VirSorter2 classifiers of different viral groups from RefSeq and non-RefSeq sources. “Genome #” is the number of genomes. “Min size”, “Median size”, and “Max size” are the minimum, median, and maximum of genome sizes per each viral group.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2020_990_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>Case-study: identifying viral contig from a Tara Oceans virome dataset </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2020_990_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3.</bold> First 20 rows of the “final-viral-score.tsv” VirSorter2 output file for Tara Oceans virome 85_SRF. VirSorter 2.0.beta was used with default parameters, including all classifiers and a minimum score cutoff of 0.5. The columns include first the sequence name, the score for each of the 5 classifiers, the maximum score for this sequence, the group yielding this maximum score, the sequence length, the number of hallmark gene(s) for the maximum score group, and the percentage of viral and cellular genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="40168_2020_990_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Manual inspection of contigs newly identified by VirSorter2 in Tara Oceans virome 85_SRF. The spreadsheet includes four tabs, including the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs ≥ 5kb - Manual inspection”), the DRAM-v annotation of these contigs (“Contigs ≥ 5kb - DRAM-v annotation”), the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs &lt; 5kb - Manual inspection”), and their DRAM-v annotation (“Contigs &lt; 5kb - DRAM-v annotation”). For the manual inspection tabs, column headers correspond to the standard output of VirSorter2 (“final-viral-score.tsv”), i.e. sequence name, score for each of the 5 classifiers, maximum score for this sequence, group yielding this maximum score, sequence length, number of hallmark gene(s) for the maximum score group, percentage of viral and cellular genes, along with an additional column (“Manual inspection notes”) indicating the conclusions from the expert curators. The DRAM-v annotation tabs column headers correspond to the default DRAM-v output.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Sullivan Lab for feedback on design and implementation of VirSorter2, as well as comments on the manuscript. We also thank Ohio Supercomputer Center (OSC) [<xref ref-type="bibr" rid="CR70">70</xref>] for providing computing resources.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MBS, SR, and JG designed the experiment. JG, SR, and BB implemented the tool. SR, AAZ, AV, GDH, TOD, and DV provided hallmark gene sequences and HMMs, and curated the non-RefSeq genomes for different viral groups. JG and SR performed benchmark test and data analyses. SR, DV, MCG, AAP, and JG performed the manual curation of newly identified viral sequences by VirSorter2 in an ocean virome sample. All contributed to writing the manuscript with SR, MBS, and JG as major contributors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Funding was provided by NSF (#OCE1829831, #ABI1758974), the U.S. Department of Energy (#DE-SC0020173), and the Gordon and Betty Moore Foundation (#3790) to MBS. The work conducted by the U.S. Department of Energy Joint Genome Institute is supported by the Office of Science of the U.S. Department of Energy under contract no. DE-AC02-05CH11231.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source code of VirSorter2 is available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>). VirSorter2 can be installed via bioconda [<xref ref-type="bibr" rid="CR71">71</xref>] (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). A web version can be accessed at CyVerse/iVirus (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>). The databases used in VirSorter2, high quality non-RefSeq genomes used for training classifier and benchmark (except for ssDNA viral genomes [Varsani, unpublished data]), benchmark result tables (recall, precision, and F1 score), and ocean virome contig data used for manual curation and its VirSorter2 and VirSorter results are available at zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4297575;">https://zenodo.org/record/4297575;</ext-link> see instruction in README file). The VirSorter2 database can be automatically downloaded through VirSorter2 “setup” subcommand.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falkowski</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Fenchel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>The microbial engines that drive Earth’s biogeochemical cycles</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1034</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1153213</pub-id>
        <?supplied-pmid 18497287?>
        <pub-id pub-id-type="pmid">18497287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Embracing the unknown: disentangling the complexities of the soil microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>579</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2017.87</pub-id>
        <?supplied-pmid 28824177?>
        <pub-id pub-id-type="pmid">28824177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The ancestral and industrialized gut microbiota and implications for human health</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>383</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0191-8</pub-id>
        <?supplied-pmid 31089293?>
        <pub-id pub-id-type="pmid">31089293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Metagenome-wide association studies: fine-mining the microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2016</year>
        <volume>14</volume>
        <fpage>508</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2016.83</pub-id>
        <?supplied-pmid 27396567?>
        <pub-id pub-id-type="pmid">27396567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics, from sampling to analysis</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>833</fpage>
        <lpage>844</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id>
        <?supplied-pmid 28898207?>
        <pub-id pub-id-type="pmid">28898207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmon-Smith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>TBK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum information about a single amplified genome (MISAG) and a metagenome-assembled genome (MIMAG) of bacteria and archaea</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>725</fpage>
        <lpage>731</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3893</pub-id>
        <?supplied-pmid 6436528?>
        <pub-id pub-id-type="pmid">28787424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Semenkovich</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Whiteson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>607</fpage>
        <lpage>617</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id>
        <?supplied-pmid 22864264?>
        <pub-id pub-id-type="pmid">22864264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>From deep sequencing to viral tagging: Recent advances in viral metagenomics</article-title>
        <source>BioEssays</source>
        <year>2013</year>
        <volume>35</volume>
        <fpage>436</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200174</pub-id>
        <?supplied-pmid 23450659?>
        <pub-id pub-id-type="pmid">23450659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Kropinski</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum Information about an Uncultivated Virus Genome (MIUViG)</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4306</pub-id>
        <?supplied-pmid 30556814?>
        <pub-id pub-id-type="pmid">30556814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Viral metagenomics</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>504</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1163</pub-id>
        <?supplied-pmid 15886693?>
        <pub-id pub-id-type="pmid">15886693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viromes, not gene markers, for studying double-stranded DNA virus communities</article-title>
        <source>J Virol</source>
        <year>2015</year>
        <volume>89</volume>
        <fpage>2459</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.03289-14</pub-id>
        <?supplied-pmid 25540374?>
        <pub-id pub-id-type="pmid">25540374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ignacio-Espinoza</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doulcier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Acinas</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and ecological drivers of ocean viral communities</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261498</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261498</pub-id>
        <pub-id pub-id-type="pmid">25999515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendrix</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>MCM</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hatfull</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary relationships among diverse bacteriophages and prophages: all the world’s a phage</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1999</year>
        <volume>96</volume>
        <fpage>2192</fpage>
        <lpage>2197</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.96.5.2192</pub-id>
        <?supplied-pmid 10051617?>
        <pub-id pub-id-type="pmid">10051617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mushegian</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Are there 1031 virus particles on earth, or more, or fewer?</article-title>
        <source>J Bacteriol</source>
        <year>2020</year>
        <volume>202</volume>
        <issue>9</issue>
        <fpage>e00052</fpage>
        <lpage>e00020</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00052-20</pub-id>
        <?supplied-pmid 32071093?>
        <pub-id pub-id-type="pmid">32071093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duhaime</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Loy</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ecogenomics and potential biogeochemical impacts of globally abundant ocean viruses</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>537</volume>
        <fpage>689</fpage>
        <lpage>693</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19366</pub-id>
        <?supplied-pmid 27654921?>
        <pub-id pub-id-type="pmid">27654921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregory</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Zayed</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Conceição-Neto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Temperton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Marine DNA viral macro- and microdiversity from pole to pole</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1109</fpage>
        <lpage>1123.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.03.040</pub-id>
        <?supplied-pmid 31031001?>
        <pub-id pub-id-type="pmid">31031001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eloe-Fadrosh</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Huntemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mikhailova</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Uncovering Earth’s virome</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>536</volume>
        <fpage>425</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19094</pub-id>
        <?supplied-pmid 27533034?>
        <pub-id pub-id-type="pmid">27533034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>I-MA</given-names>
          </name>
          <name>
            <surname>Palaniappan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ratner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMG/VR v.2.0: an integrated data management and analysis system for cultivated and environmental viral genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D678</fpage>
        <lpage>D686</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1127</pub-id>
        <?supplied-pmid 30407573?>
        <pub-id pub-id-type="pmid">30407573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jungbluth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Denef</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giant virus diversity and host interactions through global metagenomics</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>432</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1957-x</pub-id>
        <?supplied-pmid 31968354?>
        <pub-id pub-id-type="pmid">31968354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitbart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bonnain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Malki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sawaya</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Phage puppet masters of the marine microbial realm</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>754</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0166-y</pub-id>
        <?supplied-pmid 29867096?>
        <pub-id pub-id-type="pmid">29867096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ofir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sorek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Contemporary phage biology: from classic models to new insights</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1260</fpage>
        <lpage>1270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.045</pub-id>
        <?supplied-pmid 29522746?>
        <pub-id pub-id-type="pmid">29522746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Tisza MJ, Pastrana DV, Welch NL, Stewart B, Peretti A, Starrett GJ, et al. Discovery of several thousand highly diverse circular DNA viruses. eLife. 9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Li C-X, Shi M, Tian J-H, Lin X-D, Kang Y-J, Chen L-J, et al. Unprecedented genomic diversity of RNA viruses in arthropods reveals the ancestry of negative-sense RNA viruses. eLife. 4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Redefining the invertebrate RNA virosphere</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>540</volume>
        <fpage>539</fpage>
        <lpage>543</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20167</pub-id>
        <?supplied-pmid 27880757?>
        <pub-id pub-id-type="pmid">27880757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolutionary history of vertebrate RNA viruses</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>197</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0012-7</pub-id>
        <?supplied-pmid 29618816?>
        <pub-id pub-id-type="pmid">29618816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moniruzzaman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Gutierrez</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Weinheimer</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Aylward</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Dynamic genome evolution and complex virocell metabolism of globally-distributed giant viruses</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1710</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15507-2</pub-id>
        <?supplied-pmid 32249765?>
        <pub-id pub-id-type="pmid">32249765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lima-Mendez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Helden</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Toussaint</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leplae</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Prophinder: a computational tool for prophage prediction in prokaryotic genomes</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>863</fpage>
        <lpage>865</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akhter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aziz</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>PhiSpy: a novel algorithm for finding prophages in bacterial genomes that combines similarity- and composition-based strategies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e126</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks406</pub-id>
        <?supplied-pmid 22584627?>
        <pub-id pub-id-type="pmid">22584627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e985</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.985</pub-id>
        <?supplied-pmid 26038737?>
        <pub-id pub-id-type="pmid">26038737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arndt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sajed</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W16</fpage>
        <lpage>W21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw387</pub-id>
        <?supplied-pmid 27141966?>
        <pub-id pub-id-type="pmid">27141966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Amgarten D, Braga LPP, da Silva AM, Setubal JC. MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins. Front Genet. 2018;9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Kieft K, Zhou Z, Anantharaman K. VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of virome function from genomic sequences. Bioinformatics. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/855387">http://biorxiv.org/lookup/doi/10.1101/855387</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0283-5</pub-id>
        <?supplied-pmid 28683828?>
        <pub-id pub-id-type="pmid">28683828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying viruses from metagenomic data using deep learning</article-title>
        <source>Quant Biol</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>64</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1007/s40484-019-0187-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>
        <source>Nat Microbiol</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>1895</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-019-0510-x</pub-id>
        <?supplied-pmid 31332386?>
        <pub-id pub-id-type="pmid">31332386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Rising to the challenge: accelerated pace of discovery transforms marine virology</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>147</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3404</pub-id>
        <?supplied-pmid 25639680?>
        <pub-id pub-id-type="pmid">25639680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Emerson JB, et al. mSystems. 2019;4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vik</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Padilla</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Putative archaeal viruses from the mesopelagic ocean</article-title>
        <source>PeerJ</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>e3428</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.3428</pub-id>
        <?supplied-pmid 28630803?>
        <pub-id pub-id-type="pmid">28630803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Ponsero AJ, Hurwitz BL. The promises and pitfalls of machine learning for detecting viruses in aquatic metagenomes. Front Microbiol. 2019;10 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Koonin EV, Dolja VV, Krupovic M, Varsani A, Wolf YI, Yutin N, et al. Global organization and proposed megataxonomy of the virus world. Microbiol Mol Biol Rev. 2020;84(2):e00061-19. doi: 10.1128/MMBR.00061-19. </mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>LoCascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <?supplied-pmid 20211023?>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated profile HMM searches</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
        <?supplied-pmid 22039361?>
        <pub-id pub-id-type="pmid">22039361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Gebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database in 2019</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D427</fpage>
        <lpage>D432</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky995</pub-id>
        <?supplied-pmid 30357350?>
        <pub-id pub-id-type="pmid">30357350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Krupovic M, Varsani A, Kazlauskas D, Breitbart M, Delwart E, Rosario K, et al. Cressdnaviricota: a virus phylum unifying seven families of rep-encoding viruses with single-stranded, circular DNA genomes. J Virol. 2020;94 American Society for Microbiology Journals. Available from: <ext-link ext-link-type="uri" xlink:href="https://jvi.asm.org/content/94/12/e00582-20">https://jvi.asm.org/content/94/12/e00582-20</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callanan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stockdale</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Shkoporov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Expansion of known ssRNA phage genomes: from tens to over a thousand</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <fpage>eaay5981</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aay5981</pub-id>
        <?supplied-pmid 32083183?>
        <pub-id pub-id-type="pmid">32083183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>L-K</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmstrom</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Ecogenomics of virophages and their giant virus hosts assessed through time series metagenomics</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>858</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01086-2</pub-id>
        <?supplied-pmid 29021524?>
        <pub-id pub-id-type="pmid">29021524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity, evolution, and classification of virophages uncovered through global metagenomics</article-title>
        <source>Microbiome</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>157</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-019-0768-5</pub-id>
        <?supplied-pmid 31823797?>
        <pub-id pub-id-type="pmid">31823797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hallam</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viral dark matter and virus-host interactions resolved from publicly available microbial genomes</article-title>
        <source>eLife</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>e08490</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.08490</pub-id>
        <?supplied-pmid 4533152?>
        <pub-id pub-id-type="pmid">4533152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casjens</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Prophages and bacterial genomics: what have we learned so far?</article-title>
        <source>Mol Microbiol</source>
        <year>2003</year>
        <volume>49</volume>
        <fpage>277</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-2958.2003.03580.x</pub-id>
        <?supplied-pmid 12886937?>
        <pub-id pub-id-type="pmid">12886937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Dempsey</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Orton</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Siddell</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D708</fpage>
        <lpage>D717</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id>
        <?supplied-pmid 29040670?>
        <pub-id pub-id-type="pmid">29040670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Moniruzzaman M, Martinez-Gutierrez CA, Weinheimer AR, Aylward FO. Dynamic genome evolution and blueprint of complex virocell metabolism in globally-distributed giant viruses. Microbiology. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/836445">http://biorxiv.org/lookup/doi/10.1101/836445</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Recombination between RNA viruses and plasmids might have played a central role in the origin and evolution of small DNA viruses</article-title>
        <source>BioEssays News Rev Mol Cell Dev Biol</source>
        <year>2012</year>
        <volume>34</volume>
        <fpage>867</fpage>
        <lpage>870</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ravantti</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Geminiviruses: a tale of a plasmid becoming a virus</article-title>
        <source>BMC Evol Biol</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>112</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-9-112</pub-id>
        <?supplied-pmid 19460138?>
        <pub-id pub-id-type="pmid">19460138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zillig</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Prangishvilli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schleper</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elferink</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Holz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viruses, plasmids and other genetic elements of thermophilic and hyperthermophilic Archaea</article-title>
        <source>FEMS Microbiol Rev</source>
        <year>1996</year>
        <volume>18</volume>
        <fpage>225</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6976.1996.tb00239.x</pub-id>
        <?supplied-pmid 8639330?>
        <pub-id pub-id-type="pmid">8639330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soler</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gaudin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marguet</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forterre</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Plasmids, viruses and virus-like membrane vesicles from Thermococcales</article-title>
        <source>Biochem Soc Trans</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1042/BST0390036</pub-id>
        <?supplied-pmid 21265744?>
        <pub-id pub-id-type="pmid">21265744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <?supplied-pmid 22908215?>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Nayfach S, Camargo AP, Eloe-Fadrosh E, Roux S, Kyrpides N. CheckV: assessing the quality of metagenome-assembled viral genomes. Bioinformatics. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778">http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id>
        <?supplied-pmid 29035372?>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vöhringer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Haunsberger</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>473</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3019-7</pub-id>
        <?supplied-pmid 31521110?>
        <pub-id pub-id-type="pmid">31521110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bin Jang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zablocki</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic assignment of uncultivated prokaryotic virus genomes is enabled by gene-sharing networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>632</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0100-8</pub-id>
        <?supplied-pmid 31061483?>
        <pub-id pub-id-type="pmid">31061483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>HB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host-linked soil viral ecology along a permafrost thaw gradient</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>870</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0190-y</pub-id>
        <?supplied-pmid 30013236?>
        <pub-id pub-id-type="pmid">30013236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nepusz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Paccanaro</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Detecting overlapping protein complexes in protein-protein interaction networks</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>471</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1938</pub-id>
        <?supplied-pmid 22426491?>
        <pub-id pub-id-type="pmid">22426491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <?supplied-pmid 15034147?>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A new generation of homology search tools based on probabilistic inference</article-title>
        <source>Genome Inf</source>
        <year>2009</year>
        <volume>23</volume>
        <fpage>205</fpage>
        <lpage>211</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Brooks L, Kaze M, Sistrom M. A curated, comprehensive database of plasmid sequences. Microbiol Resour Announc. 2019;8 American Society for Microbiology. Available from: <ext-link ext-link-type="uri" xlink:href="https://mra.asm.org/content/8/1/e01325-18">https://mra.asm.org/content/8/1/e01325-18</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>PHAST: a fast phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W347</fpage>
        <lpage>W352</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr485</pub-id>
        <?supplied-pmid 21672955?>
        <pub-id pub-id-type="pmid">21672955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fouts</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>Phage_Finder: automated identification and classification of prophage regions in complete bacterial genome sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>5839</fpage>
        <lpage>5851</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl732</pub-id>
        <?supplied-pmid 17062630?>
        <pub-id pub-id-type="pmid">17062630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Ohio Supercomputer Center. 1987. Ohio Supercomputer Center. Columbus OH: Ohio Supercomputer Center. viewed 4 July 2020. http://osc.edu/ark:/19495/f5s1ph73.</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sjödin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>475</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
        <?supplied-pmid 29967506?>
        <pub-id pub-id-type="pmid">29967506</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7852108</article-id>
    <article-id pub-id-type="pmid">33522966</article-id>
    <article-id pub-id-type="publisher-id">990</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-020-00990-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Jiarong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bolduc</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zayed</surname>
          <given-names>Ahmed A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Varsani</surname>
          <given-names>Arvind</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dominguez-Huerta</surname>
          <given-names>Guillermo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Delmont</surname>
          <given-names>Tom O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pratama</surname>
          <given-names>Akbar Adjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazitúa</surname>
          <given-names>M. Consuelo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vik</surname>
          <given-names>Dean</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8398-8234</contrib-id>
        <name>
          <surname>Sullivan</surname>
          <given-names>Matthew B.</given-names>
        </name>
        <address>
          <email>sullivan.948@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Roux</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sroux@lbl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Microbiology, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.215654.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 2636</institution-id><institution>The Biodesign Center for Fundamental and Applied Microbiomics, Center for Evolution and Medicine, School of Life Sciences, </institution><institution>Arizona State University, </institution></institution-wrap>Tempe, AZ 85287 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7836.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 1151</institution-id><institution>Structural Biology Research Unit, Department of Integrative Biomedical Sciences, </institution><institution>University of Cape Town, </institution></institution-wrap>Observatory, Cape Town, 7701 South Africa </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.460789.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 4910 6535</institution-id><institution>Génomique Métabolique, Genoscope, Institut François Jacob, CEA, CNRS, Univ Evry, </institution><institution>Université Paris-Saclay, </institution></institution-wrap>91057 Evry, France </aff>
      <aff id="Aff5"><label>5</label>Viromica, 7870582 Santiago, Chile </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Civil, Environmental and Geodetic Engineering, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Center of Microbiome Science, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.184769.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2231 4551</institution-id><institution>DOE Joint Genome Institute, Lawrence Berkeley National Laboratory, </institution></institution-wrap>Berkeley, CA 94720 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>37</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Viruses are a significant player in many biosphere and human ecosystems, but most signals remain “hidden” in metagenomic/metatranscriptomic sequence datasets due to the lack of universal gene markers, database representatives, and insufficiently advanced identification tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce VirSorter2, a DNA and RNA virus identification tool that leverages genome-informed database advances across a collection of customized automatic classifiers to improve the accuracy and range of virus sequence detection. When benchmarked against genomes from both isolated and uncultivated viruses, VirSorter2 uniquely performed consistently with high accuracy (F1-score &gt; 0.8) across viral diversity, while all other tools under-detected viruses outside of the group most represented in reference databases (i.e., those in the order <italic>Caudovirales</italic>). Among the tools evaluated, VirSorter2 was also uniquely able to minimize errors associated with atypical cellular sequences including eukaryotic genomes and plasmids. Finally, as the virosphere exploration unravels novel viral sequences, VirSorter2’s modular design makes it inherently able to expand to new types of viruses via the design of new classifiers to maintain maximal sensitivity and specificity.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">With multi-classifier and modular design, VirSorter2 demonstrates higher overall accuracy across major viral groups and will advance our knowledge of virus evolution, diversity, and virus-microbe interaction in various ecosystems. Source code of VirSorter2 is freely available (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/virsorter2">https://bitbucket.org/MAVERICLab/virsorter2</ext-link>), and VirSorter2 is also available both on bioconda and as an iVirus app on CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>).</p>
        <p id="Par4">
          <media xlink:href="40168_2020_990_MOESM1_ESM.mp4" id="MOESM1">
            <caption>
              <p>Video abstract</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-020-00990-y.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>OCE1829831</award-id>
        <award-id>ABI1758974</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0020173</award-id>
        <award-id>DE-AC02-05CH11231</award-id>
        <principal-award-recipient>
          <name>
            <surname>Roux</surname>
            <given-names>Simon</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Gordon and Betty Moore Foundation (US)</institution>
        </funding-source>
        <award-id>#3790</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par5">Microbes are now widely recognized as driving nutrient and energy cycles that fuel marine and terrestrial ecosystems [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], directly influencing human health and disease, and controlling the output of engineered ecosystems [<xref ref-type="bibr" rid="CR3">3</xref>]. This explosive paradigm shift of our perspective of microbes is derived in large part from an ability to identify the “unculturable majority.” As high-throughput gene marker and metagenomic sequencing technologies have advanced, the true taxonomic and functional diversity of microbial communities could progressively be better explored [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Discovery and identification of viral sequences was at the forefront of the metagenomic revolution [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], but early studies were plagued by the lack of marker genes and an inability to “count” appropriate units in viral sequence space [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Fortunately, relevant “units” of viral diversity, at least for dsDNA viruses, are now routinely accessible through the de novo assembly of viral genomes from metagenomes. Thus the estimated 10<sup>31</sup> viruses on the planet [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] are being rapidly surveyed across soil, ocean, and human microbiomes, commonly yielding thousands to hundreds of thousands of dsDNA viruses in a single study [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. These large-scale surveys have helped implicate viruses as key microbiome regulators infecting ecologically critical microbes, impacting biogeochemical cycles, and altering evolutionary trajectories through horizontal gene transfer [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Beyond viruses of bacteria and archaea, vast stores of previously unidentified viruses that infect eukaryotes including ssDNA viruses [<xref ref-type="bibr" rid="CR22">22</xref>], RNA viruses [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>], and giant viruses (the phylum <italic>Nucleocytoviricota</italic>, also known as NucleoCytoplasmic Large DNA Viruses [NCLDV]) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] are being identified, but are still in need of analytical approaches for systematic identification.</p>
    <p id="Par6">Given the sheer magnitude and significant importance of the virosphere across diverse ecosystems, establishing a broad genomic catalog of Earth’s viral diversity is critical. These efforts will rely on automated detection of viral genomes across a broad range of sequencing datasets [<xref ref-type="bibr" rid="CR9">9</xref>]. Currently, two general computational approaches exist to identifying viral sequences. One set of tools rely on a combination of gene content and genomic structural features to distinguish viral from microbial sequences, including Prophinder [<xref ref-type="bibr" rid="CR27">27</xref>], PhiSpy [<xref ref-type="bibr" rid="CR28">28</xref>], VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], the Earth’s Virome pipeline [<xref ref-type="bibr" rid="CR17">17</xref>], PHASTER [<xref ref-type="bibr" rid="CR30">30</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. These genomic features are either statistically compared to a null model (Prophinder, VirSorter, PHASTER), or more recently have been used as input for automatic machine-learning classifiers (MARVEL and VIBRANT). The other approach uses the frequencies of DNA “words” (i.e., k-mers) found in known viral and cellular genomes as signatures to train machine-learning classifiers to recognize new viral and microbial sequences (e.g., VirFinder and DeepVirFinder [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]). Both approaches efficiently detect common viruses that are well represented in databases, such as dsDNA bacteriophages from the <italic>Caudovirales</italic> order [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], but they struggle with less well-documented viruses like ssDNA viruses [<xref ref-type="bibr" rid="CR35">35</xref>], RNA viruses [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>], and viruses that infect archaea [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. One reason for this is that current approaches consider viruses as a single cohesive group for detection purposes, which is potentially problematic given the varied ecological and evolutionary rules that govern the diversity and evolution of different viral genomes [<xref ref-type="bibr" rid="CR40">40</xref>]. While some features may span the virosphere (e.g., enrichment of uncharacterized genes, relative to microbes), others are group-specific (e.g., hallmark genes, specific genomic structure, or the presence of metabolic genes). Though machine learning approaches based on nucleotide composition would not suffer as much from viral database representation, they tend to confuse any unusual sequence as viral (e.g., plasmids or eukaryotic genome fragments [<xref ref-type="bibr" rid="CR39">39</xref>]). Together, these observations call for the field to move beyond a single model to represent the virosphere for virus identification.</p>
    <p id="Par7">Here, we develop and introduce a new viral sequence identification tool, VirSorter2, which leverages recent sequencing efforts for under-represented viral groups to develop customized automatic classifiers that improve detection of viruses in the order <italic>Caudovirales</italic> (the focus of the original VirSorter tool [<xref ref-type="bibr" rid="CR29">29</xref>]), while also identifying other major virus groups across a broad range of hosts, genome lengths, and genome complexity. VirSorter2 is designed modularly, enabling easy update of reference databases and individual classifiers as new viral groups are progressively described and characterized.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>The VirSorter2 framework</title>
      <p id="Par8">Viral sequence identification in VirSorter2 occurs via three steps: (i) input sequences are automatically annotated and relevant features are extracted, (ii) each sequence is scored independently using a set of classifiers customized for individual viral groups, and (iii) these scores are aggregated into a single prediction provided to the user (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Annotation of the input sequences follows current standards in the field [<xref ref-type="bibr" rid="CR9">9</xref>] including coding sequence (CDS) identification with Prodigal (version 2.6.3) [<xref ref-type="bibr" rid="CR41">41</xref>], and annotation of predicted CDS using HMMER3 (version 3.3) [<xref ref-type="bibr" rid="CR42">42</xref>] against Pfam (release 32.0) [<xref ref-type="bibr" rid="CR43">43</xref>] and a custom comprehensive viral HMM database including Xfams (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from the JGI Earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>]. Within this custom viral HMM database, profiles corresponding to viral hallmark genes were manually identified based on functional annotation and distribution across viral and microbial genomes for different viral groups. These include structural genes such as major capsid protein (MCP) or terminase large subunit for viruses in the order <italic>Caudovirales</italic> (as done in the original VirSorter); RNA-dependent RNA polymerase (RdRP) for the viral kingdom <italic>Orthornavirae</italic> (RNA viruses); MCP for viruses in the family <italic>Microviridae</italic>; replication-associated protein for viruses in the phylum <italic>Cressdnaviricota</italic> [<xref ref-type="bibr" rid="CR44">44</xref>]; ATPase for viruses in the family <italic>Inoviridae</italic>; MCP, pATPase, primase, transcription elongation factor (TFIIS), and viral late gene transcription factor (VLTF3) for viruses in the phylum <italic>Nucleocytoviricota</italic> (i.e., nucleocytoplasmic large DNA viruses; NCLDVs); and MCP for viruses in the family <italic>Lavidaviridae</italic> (virophages) [<xref ref-type="bibr" rid="CR40">40</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the VirSorter2 framework. Schematic of the viral prediction pipeline used in VirSorter2. “hmmDB” represents databases of HMM profiles including viral HMMs from Xfam (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from JGI Earth’s Virome [<xref ref-type="bibr" rid="CR17">17</xref>], and cellular HMMs (archaeal, bacterial, eukaryotic) as well as “mixed” HMMs (not specific to either virus or cellular organisms) from Pfam [<xref ref-type="bibr" rid="CR43">43</xref>]. A default cutoff of 30 is used for the HMM searches. “Classifiers” refers to random forest classifiers trained on known viral genomes and cellular genomes from different viral groups (see “<xref rid="Sec12" ref-type="sec">Training classifiers</xref>” section in “Methods”). The default max score cutoff is set to 0.5</p></caption><graphic xlink:href="40168_2020_990_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par9">Different features were extracted from these annotations (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These features were then used as input for five distinct random forest classifiers, each associated with a different major type of viral group. These classifiers were trained on reference virus sequences from NCBI RefSeq and high quality genomes from new unpublished isolates (ssDNA) [<xref ref-type="bibr" rid="CR22">22</xref>], metagenomes [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>], and proviruses, i.e., viral genomes residing in bacteria or archaeal host cell [<xref ref-type="bibr" rid="CR48">48</xref>] (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Each classifier yields a “viralness” score, which can be used to determine the likelihood of the input sequence to represent a partial or complete genome from the corresponding viral group.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Features used in Virsorter2, VirSorter, and MARVEL. Detailed explanation of each feature is provided in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section. In VirSorter, features 3 to 6 are summed up as one feature (% of Pfam affiliated genes)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>VirSorter2</th><th>VirSorter</th><th>MARVEL</th></tr></thead><tbody><tr><td>1. Hallmark gene count</td><td>x</td><td>x</td><td/></tr><tr><td>2. % of viral genes</td><td>x</td><td>x</td><td>x</td></tr><tr><td>3. % of archaeal genes</td><td>x</td><td rowspan="4">x</td><td/></tr><tr><td>4. % of bacterial genes</td><td>x</td><td/></tr><tr><td>5. % of eukaryotic genes</td><td>x</td><td/></tr><tr><td>6. % of mixed genes</td><td>x</td><td/></tr><tr><td>7. % of unaligned genes</td><td>x</td><td>x</td><td/></tr><tr><td>8. Average gene size</td><td>x</td><td>x</td><td>x</td></tr><tr><td>9. Gene overlapping frequency</td><td>x</td><td/><td/></tr><tr><td>10. Gene density</td><td>x</td><td>x</td><td>x</td></tr><tr><td>11. Strand switching frequency</td><td>x</td><td>x</td><td>x</td></tr><tr><td>12. % of ATG as starting codon</td><td>x</td><td/><td>x</td></tr><tr><td>13. % of GTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>14. % of TTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>15. Mean of GC content</td><td>x</td><td/><td/></tr><tr><td>16. SD of GC content</td><td>x</td><td/><td/></tr><tr><td>17–27. % of RBS motifs</td><td>x</td><td/><td/></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>Boxplot of different features across non-viral and viral groups. “Nonviral” includes bacteria and archaea, fungi and protozoa, and plasmids. A subset of 100 random genome fragments were used for each group. “% of viral gene” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “% of bacterial gene” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “Strand switch frequency” is the percent of genes located on a different strand from the upstream gene (scanning from 5′ to 3′ in the + strand); “Gene density” is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiplied by 1000); “Average GC content of genes” is the mean of GC content of all genes in a contig; “TATATA_3-6 motif frequency” is the percent of ribosomal binding sites (RBS) with “TATATA_3-6” motif</p></caption><graphic xlink:href="40168_2020_990_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">To train the different classifiers, reference genomes for each viral group were split into training and testing sets with a 9 to 1 ratio, respectively, and 5 random fragments were generated from each genome starting at a random position and with size ranging from 1 kb to complete genomes. Separate classifiers were trained for the following viral groups (i) caudovirids (<italic>Caudovirales</italic>) and comparable dsDNA phages (e.g., corticovirids), (ii) NCLDVs, (iii) RNA viruses, (iv) ssDNA viruses, and (v) lavivirids (<italic>Lavidaviridae</italic>). Separately, a negative (non-viral) dataset was generated from genomes of three groups: (i) bacteria and archaea, (ii) eukaryotes (fungi and protozoa), and (iii) plasmids. The training and testing sets for non-viral genomes were generated the same way as the viral set described above.</p>
      <p id="Par11">For each input sequence to be classified, all random forest classifiers are first applied to the entire sequence. If the score obtained with one or more of the classifiers is above the cutoff set by the user (the default was 0.5, as used in the classifier training step), the score is considered significant and the sequence was considered as entirely or near-entirely viral. To identify potential host regions on the edge of these contigs, sub-sequences of the input sequence with 0 to 5 genes or 10% of total genes (whichever larger) trimmed in 5′ and/or 3′ processed with the same classifiers, and selected if the viralness score increased compared to the full sequence. If no score was significant when analyzing the complete sequence, the same classifiers are applied to sliding windows across the input sequence. The size of the sliding window was determined separately for each classifier as the minimal size of a genome from the corresponding viral group (Table <xref rid="MOESM2" ref-type="media">S1</xref>). The sliding window starts from the 5′ edge of a contig and shifts one gene at a time while there is no significant score. For each window yielding a significant score, this window is extended one CDS at a time in 3′ as long as the score stays significant. Eventually, overlapping regions identified by different classifiers are compared and the longest prediction is retained.</p>
    </sec>
    <sec id="Sec4">
      <title>Expanded and manually curated databases enable a robust detection of viruses in the order <italic>Caudovirales</italic></title>
      <p id="Par12">We first evaluated the new VirSorter2 approach on genomes in the order <italic>Caudovirales</italic>. As described above, test sequences included both phage isolate sequences from NCBI Viral RefSeq [<xref ref-type="bibr" rid="CR49">49</xref>] and uncultivated phage genomes obtained from metagenomes or identified as proviruses in bacterial and archaeal whole genome shotgun sequencing ([<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR48">48</xref>], see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Test sequences also did not overlap with the references used to train the classifier. As negative control, the same number of sequences from the non-viral testing set were included. The same test sequences were also processed with established viral sequence detection tools including VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], VirFinder [<xref ref-type="bibr" rid="CR33">33</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. The overall performance of each tool was evaluated using the F1 score, which represents the harmonic mean of precision and recall [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par13">Overall, all tools performed well in the identification of viral sequences in the order <italic>Caudovirales</italic> from RefSeq, as they all displayed F-score ≥ 0.8 with sequences 5 kb and longer (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). As previously observed [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], all approaches also displayed a decreased accuracy with shorter sequences, especially when reaching lengths of ~ 1–2 kb (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). While increased accuracy with sequence length was also observed when evaluating the same tools with uncultivated viral sequences of the order <italic>Caudovirales</italic>, the overall performance of several tools was lower (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). Specifically, the performance of VirSorter, VirFinder, DeepVirFinder, and MARVEL was decreased by 10–30%, while VIBRANT and VirSorter2 displayed F-score comparable to those when evaluated with the RefSeq sequences (± 5%), likely due to their larger reference database and their ability to use hallmark genes to identify viruses only distantly related to RefSeq genomes. Similar results were obtained when analyzing viral sequences, either from RefSeq or uncultivated, for which &lt; 25% of the genes were annotated as viral based on the custom HMM database (Fig. <xref rid="MOESM2" ref-type="media">S3</xref>), confirming that the differences in tool performances were mostly due to the ability to identify novel viruses. To verify that the VirSorter2 approach was similarly efficient for integrated proviruses, we processed bacterial genomes from a gold-standard set of 51 microbial genomes [<xref ref-type="bibr" rid="CR51">51</xref>] for which 82 integrated proviruses have been manually curated. As for viral contigs, VirSorter2 recall and precision was comparable or higher to all other tools (Table <xref rid="Tab2" ref-type="table">2</xref>). Overall, the approach used by VirSorter2 to identify <italic>Caudovirales</italic> is thus on par or more efficient than other recently published tools for both isolate and environmental sequences, across a broad range of contig length, and for sequences both entirely and partially viral. The only exception was for viral contigs of &lt; 3 kb that have representation in NCBI RefSeq, which were better recovered by kmer-based methods such as VirFinder and DeepVirFinder (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Tool performances on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (<italic>x</italic>-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (<bold>a</bold>), proviruses extracted from microbial genomes in NCBI RefSeq (<bold>b</bold>) [<xref ref-type="bibr" rid="CR48">48</xref>], and other sources (<bold>c</bold>) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). F1 score is used as the metric (<italic>y</italic>-axis) to compare tools, while detailed recall and precision results are available in Figs. <xref rid="MOESM4" ref-type="media">S1</xref> and <xref rid="MOESM4" ref-type="media">S2</xref>. The dotted line is <italic>y</italic> = 0.8</p></caption><graphic xlink:href="40168_2020_990_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of VirSorter2 and previously published prophage identification tools when calling proviruses from the standard dataset described in Casjens [<xref ref-type="bibr" rid="CR51">51</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>PHAST (all categories)</th><th>PHAST (no questionable)</th><th>PhiSpy</th><th>Phage Finder</th><th>VirSorter (categories 1 and 2)</th><th>Virsorter (ll categories)</th><th>VirSorter2</th></tr></thead><tbody><tr><td>Recall</td><td>84.27%</td><td>70.04%</td><td>78.28%</td><td>64.42%</td><td>73.41%</td><td>79.30%</td><td>94.38%</td></tr><tr><td>Precision</td><td>83.03%</td><td>82.74%</td><td>73.59%</td><td>79.26%</td><td>92.89%</td><td>72.24%</td><td>73.04%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Dedicated custom models allow identification of diverse viral sequences</title>
      <p id="Par14">We next reasoned that, since different viral groups have different defining characteristics, a single model was unlikely to efficiently handle the entire viral diversity. Hence, just as viral taxonomists have to use different characteristics to classify viruses across the known virosphere [<xref ref-type="bibr" rid="CR52">52</xref>], different rules would be needed to robustly identify different types of viruses in nature instead of the single model used by all other tools available to date, including the original VirSorter. To demonstrate the effectiveness of this multi-classifier approach, we focused our efforts on four major virus groups outside the order <italic>Caudovirales</italic> where significant data and expertise have accumulated—ssDNA viruses, RNA viruses, NCLDV, and lavidavirids (virophages)—as described above.</p>
      <p id="Par15">Comparing the range and median value of each feature between groups confirmed that features such as gene density or percentage of viral gene could clearly differ between groups (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The relative importance of each feature in individual classifiers was also variable between different groups, confirming fundamental differences in genome organization and content between viruses (Fig. <xref rid="MOESM2" ref-type="media">S4</xref>). Comparing the performance of VirSorter2 to other existing approaches on these non-<italic>Caudovirales</italic> viruses demonstrated that most of the tools evaluated were not able to consistently identify these sequences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Overall, current virus detection tools typically struggled with at least one type of non-<italic>Caudovirales</italic> virus, and also showed reduced performance for sequences not currently part of NCBI Viral RefSeq, i.e., more distantly related to known references. Meanwhile, VirSorter2 was the only tool which displayed F1-scores &gt; 0.8 across all groups for contigs 5 kb and longer, and always had the highest F-score for all contigs ≥ 3 kb except for RNA viruses from RefSeq where DeepVirfinder performed better. Through its modular framework, VirSorter2 is thus uniquely able to reliably detect different types of non-<italic>Caudovirales</italic> viruses. Importantly however, VirSorter2’s F1-score substantially decreased for sequences &lt; 3 kb, as previously observed for the viruses in the order <italic>Caudovirales</italic>, due to loss of sensitivity (Figs. <xref rid="MOESM2" ref-type="media">S5</xref> and <xref rid="MOESM2" ref-type="media">S6</xref>). Thus, the VirSorter2 approach is currently not optimal for short (&lt; 3 kb) contigs.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Tool performances on different viral groups (other than dsDNA phage) from different data sources. VirSorter2 consistently outperforms existing tools in identifying viral groups outside dsDNA phages Genome fragments of different lengths (<italic>x</italic>-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. “RNA-non-refseq*” is a collection of ssRNA phage genomes [<xref ref-type="bibr" rid="CR45">45</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (<italic>y</italic>-axis) to compare tools. The dotted horizontal line is <italic>y</italic> = 0.8. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par16">The decrease in F1-score between VirSorter2 and the next best tool varied between groups and lengths, from 4.4% for the ssDNA to 31.8% for NCLDV on average with sequences longer than 5 kb, highlighting that some groups benefited from a separate classifier more than others (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Pragmatically, this means that lavidavirid gene content and genome structure may be close enough to the “extended <italic>Caudovirales</italic>” group that it could potentially be included in the same classifier, whereas NCLDV and ssDNA viruses are better identified when considered separately. VirSorter2 was thus designed modularly to enable modification and addition of new classifiers as our knowledge of viral sequence space increases.</p>
    </sec>
    <sec id="Sec6">
      <title>Plasmids and eukaryotic genomes represent unique challenges for viral detection tools</title>
      <p id="Par17">While initial tests were performed using random fragments of bacterial and archaeal genomes as non-virus sequences, previous studies showed that eukaryotic genome and plasmid fragments were especially prone to be mis-identified as a putative viral sequence [<xref ref-type="bibr" rid="CR39">39</xref>]. We thus evaluated how VirSorter2 and other tools handled both eukaryotic and plasmid sequences, by processing datasets entirely composed of eukaryotic genome fragments or plasmid fragments and measuring at which frequency these would be wrongly considered as viral (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>False positives comparison of tools on eukaryotes and plasmids. Genome fragments (50) of different lengths (<italic>x</italic>-axis) were generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral is used as the metric (<italic>y</italic>-axis) to compare tools. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par18">For eukaryotic genomes, both MARVEL and VirSorter showed high specificity with 2.4% and 0.1% false positives on average respectively, while VirSorter2 and VIBRANT displayed on average 12.1% and 20.9% of false positives respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). The error rate was consistent across sequence length for all tools except for VirSorter2, where this error rate decreased quickly when sequence length increased, to reach &lt; 1% for fragments ≥ 20 kb. These differences in specificity are consistent with the original scope of the tools: both VirSorter and MARVEL were designed to identify bacteriophages and archaeoviruses [<xref ref-type="bibr" rid="CR29">29</xref>]. While they do not mistake eukaryotic sequences as viral, they also poorly detect eukaryotic viruses such as NCLDV (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). VirSorter2 and VIBRANT are both able to recover eukaryotic virus sequences, such as NCLDV, and RNA viruses, but do so at the cost of a specificity loss that is relatively similar across the two tools. However, VirSorter2’s modular framework can be leveraged by users interested in particular subsets of viruses to reduce these losses. For example, to target viruses of bacteria and archaea, users can omit the NCLDV, <italic>Lavidaviridae</italic>, and RNA virus classifiers to drop VirSorter2 error rate associated with eukaryotic genomes, as demonstrated by a reduction in false-positive rate to &lt; 1.5% for all fragment lengths on average (Fig. <xref rid="MOESM2" ref-type="media">S7</xref>). Finally, both VirFinder and DeepVirFinder were most likely to mistake eukaryotic sequences as viruses as they had more than double the false positive rate of VirSorter2 (21.7% for VirFinder, 32.1% for DeepVirFinder on average). This high eukaryote-for-virus error rate for k-mer-based methods, including for large (20 kb) sequences, is a known limitation of these approaches [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par19">In contrast to eukaryotic genome sequences, no tool performed well against plasmid sequences (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). This included both gene-content and k-mer based tools, and stayed true even for large plasmid fragments (e.g., ≥ 20 kb) for which the error rate ranged between 6.4 and 42.0% for all tools. This highlights how plasmid sequences cannot be entirely distinguished from viruses using current approaches and suggests that alternative methods need to be designed for this purpose. Given the growing list of examples of how plasmid and viral sequence space are intertwined [<xref ref-type="bibr" rid="CR54">54</xref>–<xref ref-type="bibr" rid="CR57">57</xref>], significant work in this area will presumably be required, including possibly the incorporation of a dedicated tool for plasmid detection in VirSorter2 modular framework.</p>
    </sec>
    <sec id="Sec7">
      <title>VirSorter2 is easily available and can be scaled to handle large-scale datasets</title>
      <p id="Par20">Beyond accurate and sensitive virus identification, scalability to process large (&gt; 100,000 sequences) datasets and broad availability for users regardless of their knowledge of command-line or scripting are desirable traits in virus sequence detection tools. For the former, VirSorter2 can process an input dataset of 100,000 sequences totaling 4.2 Gb in 28.6 h using 32 threads. Its memory usage stays nearly constant with increasing data size, and scales nearly linearly with threads used (Figs. <xref rid="MOESM2" ref-type="media">S8</xref> &amp; <xref rid="MOESM2" ref-type="media">S9</xref>). Its total CPU time is higher than other tools (typically 2–10× higher, Fig. <xref rid="MOESM2" ref-type="media">S8</xref>), but VirSorter2’s internal processes are highly parallelizable, and written with snakemake, a cutting-edge pipeline management tool designed for computer clusters [<xref ref-type="bibr" rid="CR58">58</xref>]. VirSorter2 is thus able to utilize multiple cores in the same node and across multiple nodes efficiently, so that compute time would not be a limiting factor even for (ultra)large-scale datasets if state-of-the-art computing cluster resources are available (Fig. <xref rid="MOESM2" ref-type="media">S9</xref>). Further, this increased CPU time is mostly due to the annotation step with larger viral HMM database (&gt; 90% of CPU time) and not to the use of several distinct classifiers, suggesting that additional viral groups and classifiers could be added to the VirSorter2 framework with minimal impact on performance. Finally, users can explore the annotation and per-model score computed by VirSorter2 for each individual sequence, and can generate new output files using different options and cutoffs based on an existing VirSorter2 directory without having to re-compute the annotation step. To illustrate this and other differences between VirSorter and VirSorter2, we provide a detailed analysis of viral sequence detection from an ocean virome using both VirSorter and VirSorter2 (<xref rid="MOESM3" ref-type="media">Supplementary Text</xref>, Fig. <xref rid="MOESM2" ref-type="media">S10</xref>, Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>).</p>
      <p id="Par21">In order to make VirSorter2 useful for the largest community possible, we provide it through multiple implementations and accompanied with extended documentation. Specifically, VirSorter2 is freely available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>), as an App on the CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>), and available for local installation through a bioconda package (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). In addition, we provide an extensive step-by-step tutorial on how to run VirSorter2 and how to design new classifiers for additional viral groups and integrate this within a local VirSorter2 instance on protocols.io/VERVENET (<ext-link ext-link-type="uri" xlink:href="https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e">https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e</ext-link>).</p>
    </sec>
    <sec id="Sec8">
      <title>Current limitations and future developments</title>
      <p id="Par22">Together, these benchmark experiments demonstrate that by integrating multiple classifiers, each customized for a specific viral group, VirSorter2 vastly improves the diversity of viruses that can be automatically detected from environmental sequence data. However, we note several limitations that will benefit from future improvements in our understanding of the virosphere and technical capabilities.</p>
      <p id="Par23">First, while separating the global viral diversity in different groups clearly improved viral sequence detection, there is currently no automated process to optimally group reference viral sequences into different viral classifiers. If the viral groups selected are too large and/or diverse, the corresponding classifier would likely suffer from the same flaw as previous tools, whereby rare members would be under-detected. Conversely, classifiers designed for groups lacking diverse representation will show reduced accuracy, due to an under-trained random forest classifier being unable to extract meaningful identifying features for the group. Thus, further virosphere exploration and systematic classification is critical to provide the training data needed to optimize detection.</p>
      <p id="Par24">Second, some viral groups may require additional references and/or features to achieve a systematic and robust identification. The limits associated with reference sequences are shared by all viral sequence identification tools: as new viral genomes and groups are discovered, e.g., high-quality genomes assembled from metagenomes [<xref ref-type="bibr" rid="CR59">59</xref>], these need to be integrated into virus detection approach to keep these up-to-date. This iterative process is now facilitated by the modular framework of VirSorter2, for which we provide a detailed step-by-step protocol to add additional viral groups and classifiers. The addition of other features would also be a possible avenue for extending the range and/or accuracy of VirSorter2. Contrary to the addition of new viral groups, integrating new feature(s) would require substantial modification of VirSorter2 code, and would thus be only associated with the release of new versions of the tool.</p>
      <p id="Par25">Finally, while run times and computational resources required by VirSorter2 are compatible with modern omics datasets, the size of these datasets will likely keep increasing over the next few years, and may eventually limit the usefulness of VirSorter2. Given that most of the computation time is currently dedicated to the annotation step, this issue will require integration of scalable and improved sequence comparison tools (e.g., MMSeqs2 [<xref ref-type="bibr" rid="CR60">60</xref>], HHBlits [<xref ref-type="bibr" rid="CR61">61</xref>]) and/or new versions of the tools currently used.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par26">The automatic extraction of viral sequences from large-scale sequencing data is now a cornerstone of the current viral ecogenomics toolkit. Identifying viral genomes from omics data enables unprecedented studies of viral taxonomic diversity [<xref ref-type="bibr" rid="CR62">62</xref>], viral population distribution and associated eco-evolutionary constraints [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR47">47</xref>], and viral potential for microbial metabolic reprogramming [<xref ref-type="bibr" rid="CR20">20</xref>]. While current tools typically detect known and “standard” viruses, i.e., viruses in the order <italic>Caudovirales</italic>, pretty well, the approaches available to date remain challenged by novel and/or unusual viral groups. VirSorter2 now provides a framework to go beyond the detection of viruses in the order <italic>Caudovirales</italic> and enables robust detection of all types of viruses in sequencing data. By defining subgroups of viruses with consistent genome features and unique markers, the VirSorter2 framework is designed to grow as databases do such that new viral diversity can be readily detected in large-scale datasets. This will in turn enable researchers to investigate the role(s) played by all viruses across Earth’s biomes, and better understand how these viruses constrain fundamental microbial processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Viral HMM database</title>
      <p id="Par27">The viral HMM database includes viral HMMs from viral protein families (VPF) of JGI earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>] and Xfams (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm">https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm</ext-link>). Xfams were generated from a large collection of viral sequences from the Global Ocean Viromes 2.0 (GOV 2.0) [<xref ref-type="bibr" rid="CR16">16</xref>] and the Stordalen Mire Viromes (SMV) [<xref ref-type="bibr" rid="CR63">63</xref>]. Briefly, viral contigs were identified by VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], and MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>]. The intersection between the three tools (Category 1 in VirSorter with “--virome” mode, score ≥ 90% in Marvel, and a score of ≥ 0.9 with a <italic>p</italic> value of &lt; 0.05 in DeepVirFinder), were kept. Open reading frames (ORF) were predicted using prodigal with “--meta” mode [<xref ref-type="bibr" rid="CR41">41</xref>], filtered by removing ones with ≥ 95% similarity to RefSeq’s bacterial and archaeal proteins, and then clustered by ClusterONE [<xref ref-type="bibr" rid="CR64">64</xref>] to get rid of singletons (-d 0.3 -s 0.2 --max-overlap 0.8). Multiple sequence alignments were generated for each cluster by MUSCLE (--maxiters 4) [<xref ref-type="bibr" rid="CR65">65</xref>], and then made into HMMs by hmmbuild in HMMER3 package [<xref ref-type="bibr" rid="CR66">66</xref>]. More details of Xfams can be found at iVirus in CyVerse’s Discovery Environment (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de/</ext-link>): /iplant/home/shared/iVirus/Xfams/version_0.5/Xfams-XC.</p>
    </sec>
    <sec id="Sec12">
      <title>Training classifiers</title>
      <p id="Par28">NCBI RefSeq genomes including archaea, bacteria, protists, fungi, and virus were downloaded from NCBI (ftp://<ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nlm.nih.gov/genomes/refseq">ftp.ncbi.nlm.nih.gov/genomes/refseq</ext-link>) on 2020-01-12. Viral genomes from the order <italic>Caudovirales</italic> were used for dsDNA phage; genomes from the families <italic>Mimiviridae</italic>, <italic>Phycodnaviridae</italic>, <italic>Faustoviridae</italic>, <italic>Iridoviridae</italic>, <italic>Marseilleviridae</italic>, <italic>Ascoviridae</italic>, <italic>Pithoviridae</italic>, <italic>Poxviridae</italic>, and <italic>Pandoraviridae</italic> were used for NCLDV; genomes from the realm <italic>Riboviria</italic> were used for RNA viruses; genomes from the families <italic>Bacilladnaviridae</italic>, <italic>Circoviridae</italic>, <italic>Geminiviridae</italic>, <italic>Nanoviridae Genomoviridae</italic>, <italic>Parvoviridae</italic>, <italic>Microviridae</italic>, <italic>Smacoviridae</italic>, <italic>Alphasatellitidae</italic>, <italic>Tolecusatellitidae</italic>, <italic>Anelloviridae</italic>, <italic>Bidnaviridae</italic>, <italic>Pleolipoviridae</italic>, <italic>Spiraviridae</italic>, and <italic>Inoviridae</italic> were used for ssDNA viruses; genomes from the family <italic>Lavidaviridae</italic> were used for <italic>Lavidaviridae</italic> classifier. Other than NCBI RefSeq genomes, a set of high-quality genomes was also obtained from the literature [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>] and unpublished ssDNA virus genome data (Varsani, unpublished data). These genomes were identified based on VirSorter1, VirFinder, or using custom pipelines, and were further analyzed and manually curated as part of their respective publication. Hence, they represent useful examples of “novel” viruses, often distantly related to RefSeq reference genomes. The genomes of all viral and non-viral groups were split into “training” and “testing” sets with a 9 to 1 ratio, respectively. The “training” sets from RefSeq and non-RefSeq sources were combined. For viral genomes, five fragments were generated starting at a random genome position with length ranging from 1000 bp to the maximal length (extending to the end of genome). For bacteria, archaea, and eukaryotes, five fragments were generated from a representative genome from each genus in the same way as described above; for plasmids, because no systematic global classification is available and the total number of plasmids in the input dataset [<xref ref-type="bibr" rid="CR67">67</xref>] was only 6642 sequences, five fragments were generated from each sequence. The generated fragments from each of the three non-viral groups (bacteria and archaea, eukaryotes, and plasmids) were subsampled to the minimum within these three negative groups (bacterial and archaea, eukaryotes, and plasmids) and combined as a final “negative set.” For each viral group, the viral “training set” and the non-viral “training set” were evenly subsampled to the smaller size between the two, and then used for training the classifier. Then the following 27 features were extracted from each sequence fragment:
<list list-type="order"><list-item><p id="Par29">“Hallmark gene count” is the count of hallmark genes in a viral sequence</p></list-item><list-item><p id="Par30">“% of viral genes” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes</p></list-item><list-item><p id="Par31">“% of archaeal genes” is calculated as the percent of genes annotated as archaeal (best hit to archaeal HMMs) of all genes</p></list-item><list-item><p id="Par32">“% of bacterial genes” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes</p></list-item><list-item><p id="Par33">“% of eukaryotic genes” is calculated as the percent of genes annotated as eukaryotic (best hit to eukaryotic HMMs) of all genes</p></list-item><list-item><p id="Par34">“% of mixed genes” is calculated as the percent of genes with best hit to HMMs shared between viruses and cells</p></list-item><list-item><p id="Par35">“% of unaligned genes” is calculated as the percent of genes with no hits to HMMs in the VirSorter2 HMM database (bit score cutoff 30)</p></list-item><list-item><p id="Par36">“Average gene size” is the mean of gene sizes in a viral sequence</p></list-item><list-item><p id="Par37">“Gene overlapping frequency” is the percent of consecutive genes that are on the same strand and overlap when scanning from 5′ to 3′ on the + strand</p></list-item><list-item><p id="Par38">“Gene density” is the average number of genes in every 1000 bp sequence window (total number of genes divided by contig length and then multiplied by 1000)</p></list-item><list-item><p id="Par39">“Strand switching frequency” is the percent of genes located on the opposite strand from the gene upstream (scanning from 5′ to 3′ in the + strand)</p></list-item><list-item><p id="Par40">“% of ATG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par41">“% of GTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par42">“% of TTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par43">“Mean of GC content” is the mean of GC content of all genes in a sequence</p></list-item><list-item><p id="Par44">“SD of GC content” is the standard deviation of GC content of all genes in a sequence</p></list-item><list-item><p id="Par45">“% of RBS motifs” is percent of ribosomal binding sites (RBS) with a specific motif. There are 11 types of motifs included: SD_Canonical, SD_Bacteroidetes, TATATA_3-6, OnlyA, OnlyT, DoubleA, DoubleT, Other_GA, NoA, Other, and None (no motif found) [<xref ref-type="bibr" rid="CR19">19</xref>].</p></list-item></list></p>
      <p id="Par46">Features 8–27 are all extracted from the gff output from prodigal [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par47">With the above features, “RandomForestClassifier” in scikit-learn package [<xref ref-type="bibr" rid="CR50">50</xref>] was used to train the random forest classifier. “MinMax” scaler was used to scale all the feature data, and “GridSearchCV” was used to find optimal parameter sets among “n_estimators” of 20, 50, 100, 150, 200, and “criterion” of gini or entropy.</p>
    </sec>
    <sec id="Sec13">
      <title>Accuracy</title>
      <p id="Par48">To compare the accuracy of VirSorter2 to other viral identification tools, datasets with equal number (50) of viral and non-viral random DNA fragments were generated from the testing set created above and with different lengths (1.5, 3, 5, 10, and 20 kb) to discern the impact of sequence length on accuracy. VirSorter2 (version 2.0.beta) was run with “--include-groups dsDNAphage, NCLDV, RNA, ssDNA, lavidaviridae, --min-score 0.5,” and sequences in “final-viral-combined.fa” were considered as viral. VirSorter (version 1.1.0) was run with “--db 2 --virome –diamond,” and sequences in categories 1, 2, 4 and 5 were considered as viral; VIBRANT (version 1.2.1) was run with “--virome -f nucl”, and sequences in “VIBRANT_*/VIBRANT_phages_*/*.phages_combined.fna” were considered as viral; VirFinder (version 1.1) was run with VF.pred function within R as described in (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/VirFinder">https://github.com/jessieren/VirFinder</ext-link>); DeepVirFinder was installed directly from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/DeepVirFinder">https://github.com/jessieren/DeepVirFinder</ext-link>) with last commit ID of ddb4a9433132febe5cda39548cb9332669e11427 and was run with default parameters; for both VirFinder and DeepVirFinder, sequences with p value &lt; 0.05 were chosen as viral. Since MARVEL (version 0.2) required each viral genome as a separate file, input sequences were first split so that each sequence was an individual sequence file, and then default parameters were used, and the sequences in “results/phage_bins” were considered as viral. F1 score (harmonic mean of recall and precision) was used as a metric for tool accuracy comparisons. For measuring false positives on eukaryotic and plasmid sequences, the fraction of eukaryotic or plasmid sequences classified as viral were calculated. To test performance on provirus detection, 54 bacterial genomes with known provirus boundary [<xref ref-type="bibr" rid="CR51">51</xref>] were used. VirSorter2 was run with the “--include-groups all, --min-score 0.5” flag. If a provirus has ≥ 50% of its genome recovered, it was considered as a true positive, and the VirSorter2 identified viral sequences without any true positives identified in them were considered as false positives. Recall and precision of other tools [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR68">68</xref>, <xref ref-type="bibr" rid="CR69">69</xref>] were retrieved from the original VirSorter benchmarking experiments [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Computational efficiency</title>
      <p id="Par49">To measure how tools scale with input data size, datasets with 10, 100, and 1000 sequences of 10 kb in length were generated in the same way as in accuracy benchmarking described above. To measure multithreading efficiency, datasets with 1000 sequences of 10 kb were generated and used as an input for VirSorter2, VirSorter, MARVEL, and VIBRANT were run with 1, 2, 4, 8, 16, 32 threads. VirFinder was not included since it did not have a multi-threading option. DeepVirFinder had unexpected behavior with its multi-threading option (“-c”), i.e., the “-c” option could not control thread number, so was also not included. CPU time and run time was measured with “/usr/bin/time -v” command available in the Linux operating system and peak memory was measure with “memusg” script (<ext-link ext-link-type="uri" xlink:href="https://gist.github.com/netj/526585">https://gist.github.com/netj/526585</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2020_990_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Recall comparisons of tools on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Recall is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S2.</bold> Precision comparisons of tools on dsDNA phages from different data sources. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Precision is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S3.</bold> Tool performances with viral sequences having &lt; 25% of the genes annotated as viral. Genome fragments of different lengths (x-axis) were generated from <italic>Caudovirales</italic> genomes from both NCBI RefSeq genomes and other sources. Only data sources with &gt; 10 viral sequences that have &lt; 25% genes annotated as viral were kept. Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (y-axis) to compare tools. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S4.</bold> Importance of different features for viral sequence identification across viral groups. The y-axis shows the relative contribution of individual features in separating the training viral and nonviral (bacterial and archaea, fungi and protozoa, and plasmid) data (total is 1), provided by the Random Forest classifier after processing training data, and based on the F1 score. Top four features from each viral group (10 in total) are shown. In the features (color), “vir” (% of viral genes) is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “bac” (% of bacterial genes) is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “hallmark” (hallmark gene count) is the count of hallmark genes in a viral sequence; “mix” (% of mixed genes) is calculated as the percent of genes with best hit to HMMs not specific to virus or non-virus; “Strand_switch_perc” (Strand switching frequency) is the percent of genes located on a different strand from the previous gene (scanning from 5′ to 3′ in the + strand); “density” (Gene density) is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiply by 1000); “gc_mean” (Mean GC content) is the mean of GC content of all genes in a contig; “atg_perc” (% of ATG as start codon) is the percent of genes with ATG as a starting codon; “rbs_None” is the percent of ribosomal binding sites (RBS) with no motif detected; “rbs_TATATA_3-6” is the percent of RBS with “TATATA_3-6” motif. <bold>Figure S5.</bold> Recall comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Recall was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S6.</bold> Precision comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Precision was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S7.</bold> False positives by VirSorter2 on eukaryotes and plasmids. Genome fragments (50) of different lengths (x-axis) are generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral was used as the metric (y-axis) to evaluate tools. Plot A and C show contribution of each classifier (color) to total false positives in VirSorter2 (as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>) for eukaryotes and plasmid respectively. Plot B and D show the total false positive in VirSorter2 after excluding NCLDV, RNA, and <italic>Lavidaviridae</italic> classifiers. vs2 = VirSorter2. <bold>Figure S8.</bold> CPU time and peak memory comparison among tools across data sizes. Tools were run on different input sizes of 10, 100, 1000 sequences with 10 kb in length. Plot (A) shows all tools scale nearly linearly with data size, and (B) shows peak memory usage of all tools are &lt;1 GB. VirSorter2 and VirFinder peak memory usage stay nearly constant. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S9.</bold> Multi-threading efficiency comparison among tools. Tools were run on 1000 sequences with 10 kb in length. Plot (A) shows VirSorter2 and VIBRANT have the best multi-threading efficiency, i.e. total run time decreases nearly linearly with the number of threads used. VirSorter can not use more than four threads. MARVEL’s multi-threading option does not significantly reduce run time. Plot (B) shows VirSorter2, VirSorter and VIBRANT memory usage increases with the number of threads used, with VirSorter2 and VIBRANT increasing at a higher rate than VirSorter. MARVEL’s memory usage stayed constant. vs2 = VirSorter2; vs1 = VirSorter; mv = MARVEL; vb = VIBRANT. <bold>Figure S10.</bold> Overview of VirSorter2 results for <italic>Tara</italic> Oceans virome 85_SRF. A. Detection of viral contigs via VirSorter 1.0.4 and VirSorter 2.0.beta by contig size. The top panel displays the total number of viral contigs identified in each size class, while the bottom panel indicates the overlap between these predictions. B. Distribution of VirSorter 2.0.beta score (maximum score across all 5 classifiers, y-axis) for <italic>Tara</italic> Oceans virome 85_SRF sequences, according to the confidence category estimated by VirSorter1 (x-axis). “NA” indicates contigs that were not detected as viral by VirSorter1. VirSorter 2.0.beta detections were based on a minimum score cutoff of 0.5. C. Proportion of sequences from Tara Oceans virome 85_SRF detected as viral based on the dsDNAphage, RNA, and/or ssDNA model(s) (red) or detected based on the NCLDV or <italic>Lavidaviridae</italic> classifiers only, by size class (x-axis). <bold>Table S1.</bold> Summary statistics of the genomes used for training VirSorter2 classifiers of different viral groups from RefSeq and non-RefSeq sources. “Genome #” is the number of genomes. “Min size”, “Median size”, and “Max size” are the minimum, median, and maximum of genome sizes per each viral group.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2020_990_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>Case-study: identifying viral contig from a Tara Oceans virome dataset </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2020_990_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3.</bold> First 20 rows of the “final-viral-score.tsv” VirSorter2 output file for Tara Oceans virome 85_SRF. VirSorter 2.0.beta was used with default parameters, including all classifiers and a minimum score cutoff of 0.5. The columns include first the sequence name, the score for each of the 5 classifiers, the maximum score for this sequence, the group yielding this maximum score, the sequence length, the number of hallmark gene(s) for the maximum score group, and the percentage of viral and cellular genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="40168_2020_990_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Manual inspection of contigs newly identified by VirSorter2 in Tara Oceans virome 85_SRF. The spreadsheet includes four tabs, including the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs ≥ 5kb - Manual inspection”), the DRAM-v annotation of these contigs (“Contigs ≥ 5kb - DRAM-v annotation”), the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs &lt; 5kb - Manual inspection”), and their DRAM-v annotation (“Contigs &lt; 5kb - DRAM-v annotation”). For the manual inspection tabs, column headers correspond to the standard output of VirSorter2 (“final-viral-score.tsv”), i.e. sequence name, score for each of the 5 classifiers, maximum score for this sequence, group yielding this maximum score, sequence length, number of hallmark gene(s) for the maximum score group, percentage of viral and cellular genes, along with an additional column (“Manual inspection notes”) indicating the conclusions from the expert curators. The DRAM-v annotation tabs column headers correspond to the default DRAM-v output.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Sullivan Lab for feedback on design and implementation of VirSorter2, as well as comments on the manuscript. We also thank Ohio Supercomputer Center (OSC) [<xref ref-type="bibr" rid="CR70">70</xref>] for providing computing resources.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MBS, SR, and JG designed the experiment. JG, SR, and BB implemented the tool. SR, AAZ, AV, GDH, TOD, and DV provided hallmark gene sequences and HMMs, and curated the non-RefSeq genomes for different viral groups. JG and SR performed benchmark test and data analyses. SR, DV, MCG, AAP, and JG performed the manual curation of newly identified viral sequences by VirSorter2 in an ocean virome sample. All contributed to writing the manuscript with SR, MBS, and JG as major contributors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Funding was provided by NSF (#OCE1829831, #ABI1758974), the U.S. Department of Energy (#DE-SC0020173), and the Gordon and Betty Moore Foundation (#3790) to MBS. The work conducted by the U.S. Department of Energy Joint Genome Institute is supported by the Office of Science of the U.S. Department of Energy under contract no. DE-AC02-05CH11231.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source code of VirSorter2 is available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>). VirSorter2 can be installed via bioconda [<xref ref-type="bibr" rid="CR71">71</xref>] (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). A web version can be accessed at CyVerse/iVirus (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>). The databases used in VirSorter2, high quality non-RefSeq genomes used for training classifier and benchmark (except for ssDNA viral genomes [Varsani, unpublished data]), benchmark result tables (recall, precision, and F1 score), and ocean virome contig data used for manual curation and its VirSorter2 and VirSorter results are available at zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4297575;">https://zenodo.org/record/4297575;</ext-link> see instruction in README file). The VirSorter2 database can be automatically downloaded through VirSorter2 “setup” subcommand.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falkowski</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Fenchel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>The microbial engines that drive Earth’s biogeochemical cycles</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1034</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1153213</pub-id>
        <?supplied-pmid 18497287?>
        <pub-id pub-id-type="pmid">18497287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Embracing the unknown: disentangling the complexities of the soil microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>579</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2017.87</pub-id>
        <?supplied-pmid 28824177?>
        <pub-id pub-id-type="pmid">28824177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The ancestral and industrialized gut microbiota and implications for human health</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>383</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0191-8</pub-id>
        <?supplied-pmid 31089293?>
        <pub-id pub-id-type="pmid">31089293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Metagenome-wide association studies: fine-mining the microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2016</year>
        <volume>14</volume>
        <fpage>508</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2016.83</pub-id>
        <?supplied-pmid 27396567?>
        <pub-id pub-id-type="pmid">27396567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics, from sampling to analysis</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>833</fpage>
        <lpage>844</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id>
        <?supplied-pmid 28898207?>
        <pub-id pub-id-type="pmid">28898207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmon-Smith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>TBK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum information about a single amplified genome (MISAG) and a metagenome-assembled genome (MIMAG) of bacteria and archaea</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>725</fpage>
        <lpage>731</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3893</pub-id>
        <?supplied-pmid 6436528?>
        <pub-id pub-id-type="pmid">28787424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Semenkovich</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Whiteson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>607</fpage>
        <lpage>617</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id>
        <?supplied-pmid 22864264?>
        <pub-id pub-id-type="pmid">22864264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>From deep sequencing to viral tagging: Recent advances in viral metagenomics</article-title>
        <source>BioEssays</source>
        <year>2013</year>
        <volume>35</volume>
        <fpage>436</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200174</pub-id>
        <?supplied-pmid 23450659?>
        <pub-id pub-id-type="pmid">23450659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Kropinski</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum Information about an Uncultivated Virus Genome (MIUViG)</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4306</pub-id>
        <?supplied-pmid 30556814?>
        <pub-id pub-id-type="pmid">30556814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Viral metagenomics</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>504</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1163</pub-id>
        <?supplied-pmid 15886693?>
        <pub-id pub-id-type="pmid">15886693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viromes, not gene markers, for studying double-stranded DNA virus communities</article-title>
        <source>J Virol</source>
        <year>2015</year>
        <volume>89</volume>
        <fpage>2459</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.03289-14</pub-id>
        <?supplied-pmid 25540374?>
        <pub-id pub-id-type="pmid">25540374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ignacio-Espinoza</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doulcier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Acinas</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and ecological drivers of ocean viral communities</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261498</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261498</pub-id>
        <pub-id pub-id-type="pmid">25999515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendrix</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>MCM</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hatfull</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary relationships among diverse bacteriophages and prophages: all the world’s a phage</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1999</year>
        <volume>96</volume>
        <fpage>2192</fpage>
        <lpage>2197</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.96.5.2192</pub-id>
        <?supplied-pmid 10051617?>
        <pub-id pub-id-type="pmid">10051617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mushegian</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Are there 1031 virus particles on earth, or more, or fewer?</article-title>
        <source>J Bacteriol</source>
        <year>2020</year>
        <volume>202</volume>
        <issue>9</issue>
        <fpage>e00052</fpage>
        <lpage>e00020</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00052-20</pub-id>
        <?supplied-pmid 32071093?>
        <pub-id pub-id-type="pmid">32071093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duhaime</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Loy</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ecogenomics and potential biogeochemical impacts of globally abundant ocean viruses</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>537</volume>
        <fpage>689</fpage>
        <lpage>693</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19366</pub-id>
        <?supplied-pmid 27654921?>
        <pub-id pub-id-type="pmid">27654921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregory</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Zayed</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Conceição-Neto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Temperton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Marine DNA viral macro- and microdiversity from pole to pole</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1109</fpage>
        <lpage>1123.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.03.040</pub-id>
        <?supplied-pmid 31031001?>
        <pub-id pub-id-type="pmid">31031001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eloe-Fadrosh</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Huntemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mikhailova</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Uncovering Earth’s virome</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>536</volume>
        <fpage>425</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19094</pub-id>
        <?supplied-pmid 27533034?>
        <pub-id pub-id-type="pmid">27533034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>I-MA</given-names>
          </name>
          <name>
            <surname>Palaniappan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ratner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMG/VR v.2.0: an integrated data management and analysis system for cultivated and environmental viral genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D678</fpage>
        <lpage>D686</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1127</pub-id>
        <?supplied-pmid 30407573?>
        <pub-id pub-id-type="pmid">30407573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jungbluth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Denef</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giant virus diversity and host interactions through global metagenomics</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>432</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1957-x</pub-id>
        <?supplied-pmid 31968354?>
        <pub-id pub-id-type="pmid">31968354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitbart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bonnain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Malki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sawaya</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Phage puppet masters of the marine microbial realm</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>754</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0166-y</pub-id>
        <?supplied-pmid 29867096?>
        <pub-id pub-id-type="pmid">29867096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ofir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sorek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Contemporary phage biology: from classic models to new insights</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1260</fpage>
        <lpage>1270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.045</pub-id>
        <?supplied-pmid 29522746?>
        <pub-id pub-id-type="pmid">29522746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Tisza MJ, Pastrana DV, Welch NL, Stewart B, Peretti A, Starrett GJ, et al. Discovery of several thousand highly diverse circular DNA viruses. eLife. 9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Li C-X, Shi M, Tian J-H, Lin X-D, Kang Y-J, Chen L-J, et al. Unprecedented genomic diversity of RNA viruses in arthropods reveals the ancestry of negative-sense RNA viruses. eLife. 4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Redefining the invertebrate RNA virosphere</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>540</volume>
        <fpage>539</fpage>
        <lpage>543</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20167</pub-id>
        <?supplied-pmid 27880757?>
        <pub-id pub-id-type="pmid">27880757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolutionary history of vertebrate RNA viruses</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>197</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0012-7</pub-id>
        <?supplied-pmid 29618816?>
        <pub-id pub-id-type="pmid">29618816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moniruzzaman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Gutierrez</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Weinheimer</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Aylward</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Dynamic genome evolution and complex virocell metabolism of globally-distributed giant viruses</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1710</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15507-2</pub-id>
        <?supplied-pmid 32249765?>
        <pub-id pub-id-type="pmid">32249765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lima-Mendez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Helden</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Toussaint</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leplae</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Prophinder: a computational tool for prophage prediction in prokaryotic genomes</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>863</fpage>
        <lpage>865</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akhter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aziz</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>PhiSpy: a novel algorithm for finding prophages in bacterial genomes that combines similarity- and composition-based strategies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e126</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks406</pub-id>
        <?supplied-pmid 22584627?>
        <pub-id pub-id-type="pmid">22584627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e985</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.985</pub-id>
        <?supplied-pmid 26038737?>
        <pub-id pub-id-type="pmid">26038737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arndt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sajed</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W16</fpage>
        <lpage>W21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw387</pub-id>
        <?supplied-pmid 27141966?>
        <pub-id pub-id-type="pmid">27141966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Amgarten D, Braga LPP, da Silva AM, Setubal JC. MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins. Front Genet. 2018;9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Kieft K, Zhou Z, Anantharaman K. VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of virome function from genomic sequences. Bioinformatics. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/855387">http://biorxiv.org/lookup/doi/10.1101/855387</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0283-5</pub-id>
        <?supplied-pmid 28683828?>
        <pub-id pub-id-type="pmid">28683828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying viruses from metagenomic data using deep learning</article-title>
        <source>Quant Biol</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>64</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1007/s40484-019-0187-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>
        <source>Nat Microbiol</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>1895</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-019-0510-x</pub-id>
        <?supplied-pmid 31332386?>
        <pub-id pub-id-type="pmid">31332386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Rising to the challenge: accelerated pace of discovery transforms marine virology</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>147</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3404</pub-id>
        <?supplied-pmid 25639680?>
        <pub-id pub-id-type="pmid">25639680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Emerson JB, et al. mSystems. 2019;4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vik</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Padilla</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Putative archaeal viruses from the mesopelagic ocean</article-title>
        <source>PeerJ</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>e3428</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.3428</pub-id>
        <?supplied-pmid 28630803?>
        <pub-id pub-id-type="pmid">28630803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Ponsero AJ, Hurwitz BL. The promises and pitfalls of machine learning for detecting viruses in aquatic metagenomes. Front Microbiol. 2019;10 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Koonin EV, Dolja VV, Krupovic M, Varsani A, Wolf YI, Yutin N, et al. Global organization and proposed megataxonomy of the virus world. Microbiol Mol Biol Rev. 2020;84(2):e00061-19. doi: 10.1128/MMBR.00061-19. </mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>LoCascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <?supplied-pmid 20211023?>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated profile HMM searches</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
        <?supplied-pmid 22039361?>
        <pub-id pub-id-type="pmid">22039361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Gebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database in 2019</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D427</fpage>
        <lpage>D432</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky995</pub-id>
        <?supplied-pmid 30357350?>
        <pub-id pub-id-type="pmid">30357350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Krupovic M, Varsani A, Kazlauskas D, Breitbart M, Delwart E, Rosario K, et al. Cressdnaviricota: a virus phylum unifying seven families of rep-encoding viruses with single-stranded, circular DNA genomes. J Virol. 2020;94 American Society for Microbiology Journals. Available from: <ext-link ext-link-type="uri" xlink:href="https://jvi.asm.org/content/94/12/e00582-20">https://jvi.asm.org/content/94/12/e00582-20</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callanan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stockdale</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Shkoporov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Expansion of known ssRNA phage genomes: from tens to over a thousand</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <fpage>eaay5981</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aay5981</pub-id>
        <?supplied-pmid 32083183?>
        <pub-id pub-id-type="pmid">32083183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>L-K</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmstrom</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Ecogenomics of virophages and their giant virus hosts assessed through time series metagenomics</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>858</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01086-2</pub-id>
        <?supplied-pmid 29021524?>
        <pub-id pub-id-type="pmid">29021524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity, evolution, and classification of virophages uncovered through global metagenomics</article-title>
        <source>Microbiome</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>157</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-019-0768-5</pub-id>
        <?supplied-pmid 31823797?>
        <pub-id pub-id-type="pmid">31823797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hallam</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viral dark matter and virus-host interactions resolved from publicly available microbial genomes</article-title>
        <source>eLife</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>e08490</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.08490</pub-id>
        <?supplied-pmid 4533152?>
        <pub-id pub-id-type="pmid">4533152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casjens</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Prophages and bacterial genomics: what have we learned so far?</article-title>
        <source>Mol Microbiol</source>
        <year>2003</year>
        <volume>49</volume>
        <fpage>277</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-2958.2003.03580.x</pub-id>
        <?supplied-pmid 12886937?>
        <pub-id pub-id-type="pmid">12886937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Dempsey</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Orton</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Siddell</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D708</fpage>
        <lpage>D717</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id>
        <?supplied-pmid 29040670?>
        <pub-id pub-id-type="pmid">29040670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Moniruzzaman M, Martinez-Gutierrez CA, Weinheimer AR, Aylward FO. Dynamic genome evolution and blueprint of complex virocell metabolism in globally-distributed giant viruses. Microbiology. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/836445">http://biorxiv.org/lookup/doi/10.1101/836445</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Recombination between RNA viruses and plasmids might have played a central role in the origin and evolution of small DNA viruses</article-title>
        <source>BioEssays News Rev Mol Cell Dev Biol</source>
        <year>2012</year>
        <volume>34</volume>
        <fpage>867</fpage>
        <lpage>870</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ravantti</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Geminiviruses: a tale of a plasmid becoming a virus</article-title>
        <source>BMC Evol Biol</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>112</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-9-112</pub-id>
        <?supplied-pmid 19460138?>
        <pub-id pub-id-type="pmid">19460138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zillig</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Prangishvilli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schleper</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elferink</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Holz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viruses, plasmids and other genetic elements of thermophilic and hyperthermophilic Archaea</article-title>
        <source>FEMS Microbiol Rev</source>
        <year>1996</year>
        <volume>18</volume>
        <fpage>225</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6976.1996.tb00239.x</pub-id>
        <?supplied-pmid 8639330?>
        <pub-id pub-id-type="pmid">8639330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soler</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gaudin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marguet</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forterre</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Plasmids, viruses and virus-like membrane vesicles from Thermococcales</article-title>
        <source>Biochem Soc Trans</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1042/BST0390036</pub-id>
        <?supplied-pmid 21265744?>
        <pub-id pub-id-type="pmid">21265744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <?supplied-pmid 22908215?>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Nayfach S, Camargo AP, Eloe-Fadrosh E, Roux S, Kyrpides N. CheckV: assessing the quality of metagenome-assembled viral genomes. Bioinformatics. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778">http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id>
        <?supplied-pmid 29035372?>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vöhringer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Haunsberger</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>473</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3019-7</pub-id>
        <?supplied-pmid 31521110?>
        <pub-id pub-id-type="pmid">31521110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bin Jang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zablocki</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic assignment of uncultivated prokaryotic virus genomes is enabled by gene-sharing networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>632</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0100-8</pub-id>
        <?supplied-pmid 31061483?>
        <pub-id pub-id-type="pmid">31061483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>HB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host-linked soil viral ecology along a permafrost thaw gradient</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>870</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0190-y</pub-id>
        <?supplied-pmid 30013236?>
        <pub-id pub-id-type="pmid">30013236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nepusz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Paccanaro</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Detecting overlapping protein complexes in protein-protein interaction networks</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>471</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1938</pub-id>
        <?supplied-pmid 22426491?>
        <pub-id pub-id-type="pmid">22426491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <?supplied-pmid 15034147?>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A new generation of homology search tools based on probabilistic inference</article-title>
        <source>Genome Inf</source>
        <year>2009</year>
        <volume>23</volume>
        <fpage>205</fpage>
        <lpage>211</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Brooks L, Kaze M, Sistrom M. A curated, comprehensive database of plasmid sequences. Microbiol Resour Announc. 2019;8 American Society for Microbiology. Available from: <ext-link ext-link-type="uri" xlink:href="https://mra.asm.org/content/8/1/e01325-18">https://mra.asm.org/content/8/1/e01325-18</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>PHAST: a fast phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W347</fpage>
        <lpage>W352</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr485</pub-id>
        <?supplied-pmid 21672955?>
        <pub-id pub-id-type="pmid">21672955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fouts</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>Phage_Finder: automated identification and classification of prophage regions in complete bacterial genome sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>5839</fpage>
        <lpage>5851</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl732</pub-id>
        <?supplied-pmid 17062630?>
        <pub-id pub-id-type="pmid">17062630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Ohio Supercomputer Center. 1987. Ohio Supercomputer Center. Columbus OH: Ohio Supercomputer Center. viewed 4 July 2020. http://osc.edu/ark:/19495/f5s1ph73.</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sjödin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>475</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
        <?supplied-pmid 29967506?>
        <pub-id pub-id-type="pmid">29967506</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7852108</article-id>
    <article-id pub-id-type="pmid">33522966</article-id>
    <article-id pub-id-type="publisher-id">990</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-020-00990-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Jiarong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bolduc</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zayed</surname>
          <given-names>Ahmed A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Varsani</surname>
          <given-names>Arvind</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dominguez-Huerta</surname>
          <given-names>Guillermo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Delmont</surname>
          <given-names>Tom O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pratama</surname>
          <given-names>Akbar Adjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazitúa</surname>
          <given-names>M. Consuelo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vik</surname>
          <given-names>Dean</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8398-8234</contrib-id>
        <name>
          <surname>Sullivan</surname>
          <given-names>Matthew B.</given-names>
        </name>
        <address>
          <email>sullivan.948@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Roux</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sroux@lbl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Microbiology, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.215654.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 2636</institution-id><institution>The Biodesign Center for Fundamental and Applied Microbiomics, Center for Evolution and Medicine, School of Life Sciences, </institution><institution>Arizona State University, </institution></institution-wrap>Tempe, AZ 85287 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7836.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 1151</institution-id><institution>Structural Biology Research Unit, Department of Integrative Biomedical Sciences, </institution><institution>University of Cape Town, </institution></institution-wrap>Observatory, Cape Town, 7701 South Africa </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.460789.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 4910 6535</institution-id><institution>Génomique Métabolique, Genoscope, Institut François Jacob, CEA, CNRS, Univ Evry, </institution><institution>Université Paris-Saclay, </institution></institution-wrap>91057 Evry, France </aff>
      <aff id="Aff5"><label>5</label>Viromica, 7870582 Santiago, Chile </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Civil, Environmental and Geodetic Engineering, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Center of Microbiome Science, </institution><institution>Ohio State University, </institution></institution-wrap>Columbus, OH 43210 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.184769.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2231 4551</institution-id><institution>DOE Joint Genome Institute, Lawrence Berkeley National Laboratory, </institution></institution-wrap>Berkeley, CA 94720 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>37</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Viruses are a significant player in many biosphere and human ecosystems, but most signals remain “hidden” in metagenomic/metatranscriptomic sequence datasets due to the lack of universal gene markers, database representatives, and insufficiently advanced identification tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce VirSorter2, a DNA and RNA virus identification tool that leverages genome-informed database advances across a collection of customized automatic classifiers to improve the accuracy and range of virus sequence detection. When benchmarked against genomes from both isolated and uncultivated viruses, VirSorter2 uniquely performed consistently with high accuracy (F1-score &gt; 0.8) across viral diversity, while all other tools under-detected viruses outside of the group most represented in reference databases (i.e., those in the order <italic>Caudovirales</italic>). Among the tools evaluated, VirSorter2 was also uniquely able to minimize errors associated with atypical cellular sequences including eukaryotic genomes and plasmids. Finally, as the virosphere exploration unravels novel viral sequences, VirSorter2’s modular design makes it inherently able to expand to new types of viruses via the design of new classifiers to maintain maximal sensitivity and specificity.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">With multi-classifier and modular design, VirSorter2 demonstrates higher overall accuracy across major viral groups and will advance our knowledge of virus evolution, diversity, and virus-microbe interaction in various ecosystems. Source code of VirSorter2 is freely available (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/virsorter2">https://bitbucket.org/MAVERICLab/virsorter2</ext-link>), and VirSorter2 is also available both on bioconda and as an iVirus app on CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>).</p>
        <p id="Par4">
          <media xlink:href="40168_2020_990_MOESM1_ESM.mp4" id="MOESM1">
            <caption>
              <p>Video abstract</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-020-00990-y.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>OCE1829831</award-id>
        <award-id>ABI1758974</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0020173</award-id>
        <award-id>DE-AC02-05CH11231</award-id>
        <principal-award-recipient>
          <name>
            <surname>Roux</surname>
            <given-names>Simon</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Gordon and Betty Moore Foundation (US)</institution>
        </funding-source>
        <award-id>#3790</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par5">Microbes are now widely recognized as driving nutrient and energy cycles that fuel marine and terrestrial ecosystems [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], directly influencing human health and disease, and controlling the output of engineered ecosystems [<xref ref-type="bibr" rid="CR3">3</xref>]. This explosive paradigm shift of our perspective of microbes is derived in large part from an ability to identify the “unculturable majority.” As high-throughput gene marker and metagenomic sequencing technologies have advanced, the true taxonomic and functional diversity of microbial communities could progressively be better explored [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Discovery and identification of viral sequences was at the forefront of the metagenomic revolution [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], but early studies were plagued by the lack of marker genes and an inability to “count” appropriate units in viral sequence space [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Fortunately, relevant “units” of viral diversity, at least for dsDNA viruses, are now routinely accessible through the de novo assembly of viral genomes from metagenomes. Thus the estimated 10<sup>31</sup> viruses on the planet [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] are being rapidly surveyed across soil, ocean, and human microbiomes, commonly yielding thousands to hundreds of thousands of dsDNA viruses in a single study [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. These large-scale surveys have helped implicate viruses as key microbiome regulators infecting ecologically critical microbes, impacting biogeochemical cycles, and altering evolutionary trajectories through horizontal gene transfer [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Beyond viruses of bacteria and archaea, vast stores of previously unidentified viruses that infect eukaryotes including ssDNA viruses [<xref ref-type="bibr" rid="CR22">22</xref>], RNA viruses [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>], and giant viruses (the phylum <italic>Nucleocytoviricota</italic>, also known as NucleoCytoplasmic Large DNA Viruses [NCLDV]) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] are being identified, but are still in need of analytical approaches for systematic identification.</p>
    <p id="Par6">Given the sheer magnitude and significant importance of the virosphere across diverse ecosystems, establishing a broad genomic catalog of Earth’s viral diversity is critical. These efforts will rely on automated detection of viral genomes across a broad range of sequencing datasets [<xref ref-type="bibr" rid="CR9">9</xref>]. Currently, two general computational approaches exist to identifying viral sequences. One set of tools rely on a combination of gene content and genomic structural features to distinguish viral from microbial sequences, including Prophinder [<xref ref-type="bibr" rid="CR27">27</xref>], PhiSpy [<xref ref-type="bibr" rid="CR28">28</xref>], VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], the Earth’s Virome pipeline [<xref ref-type="bibr" rid="CR17">17</xref>], PHASTER [<xref ref-type="bibr" rid="CR30">30</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. These genomic features are either statistically compared to a null model (Prophinder, VirSorter, PHASTER), or more recently have been used as input for automatic machine-learning classifiers (MARVEL and VIBRANT). The other approach uses the frequencies of DNA “words” (i.e., k-mers) found in known viral and cellular genomes as signatures to train machine-learning classifiers to recognize new viral and microbial sequences (e.g., VirFinder and DeepVirFinder [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]). Both approaches efficiently detect common viruses that are well represented in databases, such as dsDNA bacteriophages from the <italic>Caudovirales</italic> order [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], but they struggle with less well-documented viruses like ssDNA viruses [<xref ref-type="bibr" rid="CR35">35</xref>], RNA viruses [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>], and viruses that infect archaea [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. One reason for this is that current approaches consider viruses as a single cohesive group for detection purposes, which is potentially problematic given the varied ecological and evolutionary rules that govern the diversity and evolution of different viral genomes [<xref ref-type="bibr" rid="CR40">40</xref>]. While some features may span the virosphere (e.g., enrichment of uncharacterized genes, relative to microbes), others are group-specific (e.g., hallmark genes, specific genomic structure, or the presence of metabolic genes). Though machine learning approaches based on nucleotide composition would not suffer as much from viral database representation, they tend to confuse any unusual sequence as viral (e.g., plasmids or eukaryotic genome fragments [<xref ref-type="bibr" rid="CR39">39</xref>]). Together, these observations call for the field to move beyond a single model to represent the virosphere for virus identification.</p>
    <p id="Par7">Here, we develop and introduce a new viral sequence identification tool, VirSorter2, which leverages recent sequencing efforts for under-represented viral groups to develop customized automatic classifiers that improve detection of viruses in the order <italic>Caudovirales</italic> (the focus of the original VirSorter tool [<xref ref-type="bibr" rid="CR29">29</xref>]), while also identifying other major virus groups across a broad range of hosts, genome lengths, and genome complexity. VirSorter2 is designed modularly, enabling easy update of reference databases and individual classifiers as new viral groups are progressively described and characterized.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>The VirSorter2 framework</title>
      <p id="Par8">Viral sequence identification in VirSorter2 occurs via three steps: (i) input sequences are automatically annotated and relevant features are extracted, (ii) each sequence is scored independently using a set of classifiers customized for individual viral groups, and (iii) these scores are aggregated into a single prediction provided to the user (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Annotation of the input sequences follows current standards in the field [<xref ref-type="bibr" rid="CR9">9</xref>] including coding sequence (CDS) identification with Prodigal (version 2.6.3) [<xref ref-type="bibr" rid="CR41">41</xref>], and annotation of predicted CDS using HMMER3 (version 3.3) [<xref ref-type="bibr" rid="CR42">42</xref>] against Pfam (release 32.0) [<xref ref-type="bibr" rid="CR43">43</xref>] and a custom comprehensive viral HMM database including Xfams (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from the JGI Earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>]. Within this custom viral HMM database, profiles corresponding to viral hallmark genes were manually identified based on functional annotation and distribution across viral and microbial genomes for different viral groups. These include structural genes such as major capsid protein (MCP) or terminase large subunit for viruses in the order <italic>Caudovirales</italic> (as done in the original VirSorter); RNA-dependent RNA polymerase (RdRP) for the viral kingdom <italic>Orthornavirae</italic> (RNA viruses); MCP for viruses in the family <italic>Microviridae</italic>; replication-associated protein for viruses in the phylum <italic>Cressdnaviricota</italic> [<xref ref-type="bibr" rid="CR44">44</xref>]; ATPase for viruses in the family <italic>Inoviridae</italic>; MCP, pATPase, primase, transcription elongation factor (TFIIS), and viral late gene transcription factor (VLTF3) for viruses in the phylum <italic>Nucleocytoviricota</italic> (i.e., nucleocytoplasmic large DNA viruses; NCLDVs); and MCP for viruses in the family <italic>Lavidaviridae</italic> (virophages) [<xref ref-type="bibr" rid="CR40">40</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the VirSorter2 framework. Schematic of the viral prediction pipeline used in VirSorter2. “hmmDB” represents databases of HMM profiles including viral HMMs from Xfam (described in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section) and viral protein families (VPF) from JGI Earth’s Virome [<xref ref-type="bibr" rid="CR17">17</xref>], and cellular HMMs (archaeal, bacterial, eukaryotic) as well as “mixed” HMMs (not specific to either virus or cellular organisms) from Pfam [<xref ref-type="bibr" rid="CR43">43</xref>]. A default cutoff of 30 is used for the HMM searches. “Classifiers” refers to random forest classifiers trained on known viral genomes and cellular genomes from different viral groups (see “<xref rid="Sec12" ref-type="sec">Training classifiers</xref>” section in “Methods”). The default max score cutoff is set to 0.5</p></caption><graphic xlink:href="40168_2020_990_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par9">Different features were extracted from these annotations (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These features were then used as input for five distinct random forest classifiers, each associated with a different major type of viral group. These classifiers were trained on reference virus sequences from NCBI RefSeq and high quality genomes from new unpublished isolates (ssDNA) [<xref ref-type="bibr" rid="CR22">22</xref>], metagenomes [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>], and proviruses, i.e., viral genomes residing in bacteria or archaeal host cell [<xref ref-type="bibr" rid="CR48">48</xref>] (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Each classifier yields a “viralness” score, which can be used to determine the likelihood of the input sequence to represent a partial or complete genome from the corresponding viral group.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Features used in Virsorter2, VirSorter, and MARVEL. Detailed explanation of each feature is provided in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section. In VirSorter, features 3 to 6 are summed up as one feature (% of Pfam affiliated genes)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>VirSorter2</th><th>VirSorter</th><th>MARVEL</th></tr></thead><tbody><tr><td>1. Hallmark gene count</td><td>x</td><td>x</td><td/></tr><tr><td>2. % of viral genes</td><td>x</td><td>x</td><td>x</td></tr><tr><td>3. % of archaeal genes</td><td>x</td><td rowspan="4">x</td><td/></tr><tr><td>4. % of bacterial genes</td><td>x</td><td/></tr><tr><td>5. % of eukaryotic genes</td><td>x</td><td/></tr><tr><td>6. % of mixed genes</td><td>x</td><td/></tr><tr><td>7. % of unaligned genes</td><td>x</td><td>x</td><td/></tr><tr><td>8. Average gene size</td><td>x</td><td>x</td><td>x</td></tr><tr><td>9. Gene overlapping frequency</td><td>x</td><td/><td/></tr><tr><td>10. Gene density</td><td>x</td><td>x</td><td>x</td></tr><tr><td>11. Strand switching frequency</td><td>x</td><td>x</td><td>x</td></tr><tr><td>12. % of ATG as starting codon</td><td>x</td><td/><td>x</td></tr><tr><td>13. % of GTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>14. % of TTG as starting codon</td><td>x</td><td/><td/></tr><tr><td>15. Mean of GC content</td><td>x</td><td/><td/></tr><tr><td>16. SD of GC content</td><td>x</td><td/><td/></tr><tr><td>17–27. % of RBS motifs</td><td>x</td><td/><td/></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>Boxplot of different features across non-viral and viral groups. “Nonviral” includes bacteria and archaea, fungi and protozoa, and plasmids. A subset of 100 random genome fragments were used for each group. “% of viral gene” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “% of bacterial gene” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “Strand switch frequency” is the percent of genes located on a different strand from the upstream gene (scanning from 5′ to 3′ in the + strand); “Gene density” is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiplied by 1000); “Average GC content of genes” is the mean of GC content of all genes in a contig; “TATATA_3-6 motif frequency” is the percent of ribosomal binding sites (RBS) with “TATATA_3-6” motif</p></caption><graphic xlink:href="40168_2020_990_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">To train the different classifiers, reference genomes for each viral group were split into training and testing sets with a 9 to 1 ratio, respectively, and 5 random fragments were generated from each genome starting at a random position and with size ranging from 1 kb to complete genomes. Separate classifiers were trained for the following viral groups (i) caudovirids (<italic>Caudovirales</italic>) and comparable dsDNA phages (e.g., corticovirids), (ii) NCLDVs, (iii) RNA viruses, (iv) ssDNA viruses, and (v) lavivirids (<italic>Lavidaviridae</italic>). Separately, a negative (non-viral) dataset was generated from genomes of three groups: (i) bacteria and archaea, (ii) eukaryotes (fungi and protozoa), and (iii) plasmids. The training and testing sets for non-viral genomes were generated the same way as the viral set described above.</p>
      <p id="Par11">For each input sequence to be classified, all random forest classifiers are first applied to the entire sequence. If the score obtained with one or more of the classifiers is above the cutoff set by the user (the default was 0.5, as used in the classifier training step), the score is considered significant and the sequence was considered as entirely or near-entirely viral. To identify potential host regions on the edge of these contigs, sub-sequences of the input sequence with 0 to 5 genes or 10% of total genes (whichever larger) trimmed in 5′ and/or 3′ processed with the same classifiers, and selected if the viralness score increased compared to the full sequence. If no score was significant when analyzing the complete sequence, the same classifiers are applied to sliding windows across the input sequence. The size of the sliding window was determined separately for each classifier as the minimal size of a genome from the corresponding viral group (Table <xref rid="MOESM2" ref-type="media">S1</xref>). The sliding window starts from the 5′ edge of a contig and shifts one gene at a time while there is no significant score. For each window yielding a significant score, this window is extended one CDS at a time in 3′ as long as the score stays significant. Eventually, overlapping regions identified by different classifiers are compared and the longest prediction is retained.</p>
    </sec>
    <sec id="Sec4">
      <title>Expanded and manually curated databases enable a robust detection of viruses in the order <italic>Caudovirales</italic></title>
      <p id="Par12">We first evaluated the new VirSorter2 approach on genomes in the order <italic>Caudovirales</italic>. As described above, test sequences included both phage isolate sequences from NCBI Viral RefSeq [<xref ref-type="bibr" rid="CR49">49</xref>] and uncultivated phage genomes obtained from metagenomes or identified as proviruses in bacterial and archaeal whole genome shotgun sequencing ([<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR48">48</xref>], see “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Test sequences also did not overlap with the references used to train the classifier. As negative control, the same number of sequences from the non-viral testing set were included. The same test sequences were also processed with established viral sequence detection tools including VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], VirFinder [<xref ref-type="bibr" rid="CR33">33</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>], and VIBRANT [<xref ref-type="bibr" rid="CR32">32</xref>]. The overall performance of each tool was evaluated using the F1 score, which represents the harmonic mean of precision and recall [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par13">Overall, all tools performed well in the identification of viral sequences in the order <italic>Caudovirales</italic> from RefSeq, as they all displayed F-score ≥ 0.8 with sequences 5 kb and longer (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). As previously observed [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], all approaches also displayed a decreased accuracy with shorter sequences, especially when reaching lengths of ~ 1–2 kb (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). While increased accuracy with sequence length was also observed when evaluating the same tools with uncultivated viral sequences of the order <italic>Caudovirales</italic>, the overall performance of several tools was lower (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c, Figs. <xref rid="MOESM2" ref-type="media">S1</xref> &amp; <xref rid="MOESM2" ref-type="media">S2</xref>). Specifically, the performance of VirSorter, VirFinder, DeepVirFinder, and MARVEL was decreased by 10–30%, while VIBRANT and VirSorter2 displayed F-score comparable to those when evaluated with the RefSeq sequences (± 5%), likely due to their larger reference database and their ability to use hallmark genes to identify viruses only distantly related to RefSeq genomes. Similar results were obtained when analyzing viral sequences, either from RefSeq or uncultivated, for which &lt; 25% of the genes were annotated as viral based on the custom HMM database (Fig. <xref rid="MOESM2" ref-type="media">S3</xref>), confirming that the differences in tool performances were mostly due to the ability to identify novel viruses. To verify that the VirSorter2 approach was similarly efficient for integrated proviruses, we processed bacterial genomes from a gold-standard set of 51 microbial genomes [<xref ref-type="bibr" rid="CR51">51</xref>] for which 82 integrated proviruses have been manually curated. As for viral contigs, VirSorter2 recall and precision was comparable or higher to all other tools (Table <xref rid="Tab2" ref-type="table">2</xref>). Overall, the approach used by VirSorter2 to identify <italic>Caudovirales</italic> is thus on par or more efficient than other recently published tools for both isolate and environmental sequences, across a broad range of contig length, and for sequences both entirely and partially viral. The only exception was for viral contigs of &lt; 3 kb that have representation in NCBI RefSeq, which were better recovered by kmer-based methods such as VirFinder and DeepVirFinder (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Tool performances on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (<italic>x</italic>-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (<bold>a</bold>), proviruses extracted from microbial genomes in NCBI RefSeq (<bold>b</bold>) [<xref ref-type="bibr" rid="CR48">48</xref>], and other sources (<bold>c</bold>) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). F1 score is used as the metric (<italic>y</italic>-axis) to compare tools, while detailed recall and precision results are available in Figs. <xref rid="MOESM4" ref-type="media">S1</xref> and <xref rid="MOESM4" ref-type="media">S2</xref>. The dotted line is <italic>y</italic> = 0.8</p></caption><graphic xlink:href="40168_2020_990_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of VirSorter2 and previously published prophage identification tools when calling proviruses from the standard dataset described in Casjens [<xref ref-type="bibr" rid="CR51">51</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>PHAST (all categories)</th><th>PHAST (no questionable)</th><th>PhiSpy</th><th>Phage Finder</th><th>VirSorter (categories 1 and 2)</th><th>Virsorter (ll categories)</th><th>VirSorter2</th></tr></thead><tbody><tr><td>Recall</td><td>84.27%</td><td>70.04%</td><td>78.28%</td><td>64.42%</td><td>73.41%</td><td>79.30%</td><td>94.38%</td></tr><tr><td>Precision</td><td>83.03%</td><td>82.74%</td><td>73.59%</td><td>79.26%</td><td>92.89%</td><td>72.24%</td><td>73.04%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Dedicated custom models allow identification of diverse viral sequences</title>
      <p id="Par14">We next reasoned that, since different viral groups have different defining characteristics, a single model was unlikely to efficiently handle the entire viral diversity. Hence, just as viral taxonomists have to use different characteristics to classify viruses across the known virosphere [<xref ref-type="bibr" rid="CR52">52</xref>], different rules would be needed to robustly identify different types of viruses in nature instead of the single model used by all other tools available to date, including the original VirSorter. To demonstrate the effectiveness of this multi-classifier approach, we focused our efforts on four major virus groups outside the order <italic>Caudovirales</italic> where significant data and expertise have accumulated—ssDNA viruses, RNA viruses, NCLDV, and lavidavirids (virophages)—as described above.</p>
      <p id="Par15">Comparing the range and median value of each feature between groups confirmed that features such as gene density or percentage of viral gene could clearly differ between groups (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The relative importance of each feature in individual classifiers was also variable between different groups, confirming fundamental differences in genome organization and content between viruses (Fig. <xref rid="MOESM2" ref-type="media">S4</xref>). Comparing the performance of VirSorter2 to other existing approaches on these non-<italic>Caudovirales</italic> viruses demonstrated that most of the tools evaluated were not able to consistently identify these sequences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Overall, current virus detection tools typically struggled with at least one type of non-<italic>Caudovirales</italic> virus, and also showed reduced performance for sequences not currently part of NCBI Viral RefSeq, i.e., more distantly related to known references. Meanwhile, VirSorter2 was the only tool which displayed F1-scores &gt; 0.8 across all groups for contigs 5 kb and longer, and always had the highest F-score for all contigs ≥ 3 kb except for RNA viruses from RefSeq where DeepVirfinder performed better. Through its modular framework, VirSorter2 is thus uniquely able to reliably detect different types of non-<italic>Caudovirales</italic> viruses. Importantly however, VirSorter2’s F1-score substantially decreased for sequences &lt; 3 kb, as previously observed for the viruses in the order <italic>Caudovirales</italic>, due to loss of sensitivity (Figs. <xref rid="MOESM2" ref-type="media">S5</xref> and <xref rid="MOESM2" ref-type="media">S6</xref>). Thus, the VirSorter2 approach is currently not optimal for short (&lt; 3 kb) contigs.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Tool performances on different viral groups (other than dsDNA phage) from different data sources. VirSorter2 consistently outperforms existing tools in identifying viral groups outside dsDNA phages Genome fragments of different lengths (<italic>x</italic>-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. “RNA-non-refseq*” is a collection of ssRNA phage genomes [<xref ref-type="bibr" rid="CR45">45</xref>]. An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (<italic>y</italic>-axis) to compare tools. The dotted horizontal line is <italic>y</italic> = 0.8. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par16">The decrease in F1-score between VirSorter2 and the next best tool varied between groups and lengths, from 4.4% for the ssDNA to 31.8% for NCLDV on average with sequences longer than 5 kb, highlighting that some groups benefited from a separate classifier more than others (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Figs. <xref rid="MOESM2" ref-type="media">S5</xref> &amp; <xref rid="MOESM2" ref-type="media">S6</xref>). Pragmatically, this means that lavidavirid gene content and genome structure may be close enough to the “extended <italic>Caudovirales</italic>” group that it could potentially be included in the same classifier, whereas NCLDV and ssDNA viruses are better identified when considered separately. VirSorter2 was thus designed modularly to enable modification and addition of new classifiers as our knowledge of viral sequence space increases.</p>
    </sec>
    <sec id="Sec6">
      <title>Plasmids and eukaryotic genomes represent unique challenges for viral detection tools</title>
      <p id="Par17">While initial tests were performed using random fragments of bacterial and archaeal genomes as non-virus sequences, previous studies showed that eukaryotic genome and plasmid fragments were especially prone to be mis-identified as a putative viral sequence [<xref ref-type="bibr" rid="CR39">39</xref>]. We thus evaluated how VirSorter2 and other tools handled both eukaryotic and plasmid sequences, by processing datasets entirely composed of eukaryotic genome fragments or plasmid fragments and measuring at which frequency these would be wrongly considered as viral (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>False positives comparison of tools on eukaryotes and plasmids. Genome fragments (50) of different lengths (<italic>x</italic>-axis) were generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral is used as the metric (<italic>y</italic>-axis) to compare tools. <italic>vs2</italic> VirSorter2, <italic>vs1</italic> VirSorter, <italic>vf</italic> VirFinder, <italic>dvf</italic> DeepVirFinder, <italic>mv</italic> MARVEL, <italic>vb</italic> VIBRANT</p></caption><graphic xlink:href="40168_2020_990_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par18">For eukaryotic genomes, both MARVEL and VirSorter showed high specificity with 2.4% and 0.1% false positives on average respectively, while VirSorter2 and VIBRANT displayed on average 12.1% and 20.9% of false positives respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). The error rate was consistent across sequence length for all tools except for VirSorter2, where this error rate decreased quickly when sequence length increased, to reach &lt; 1% for fragments ≥ 20 kb. These differences in specificity are consistent with the original scope of the tools: both VirSorter and MARVEL were designed to identify bacteriophages and archaeoviruses [<xref ref-type="bibr" rid="CR29">29</xref>]. While they do not mistake eukaryotic sequences as viral, they also poorly detect eukaryotic viruses such as NCLDV (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). VirSorter2 and VIBRANT are both able to recover eukaryotic virus sequences, such as NCLDV, and RNA viruses, but do so at the cost of a specificity loss that is relatively similar across the two tools. However, VirSorter2’s modular framework can be leveraged by users interested in particular subsets of viruses to reduce these losses. For example, to target viruses of bacteria and archaea, users can omit the NCLDV, <italic>Lavidaviridae</italic>, and RNA virus classifiers to drop VirSorter2 error rate associated with eukaryotic genomes, as demonstrated by a reduction in false-positive rate to &lt; 1.5% for all fragment lengths on average (Fig. <xref rid="MOESM2" ref-type="media">S7</xref>). Finally, both VirFinder and DeepVirFinder were most likely to mistake eukaryotic sequences as viruses as they had more than double the false positive rate of VirSorter2 (21.7% for VirFinder, 32.1% for DeepVirFinder on average). This high eukaryote-for-virus error rate for k-mer-based methods, including for large (20 kb) sequences, is a known limitation of these approaches [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par19">In contrast to eukaryotic genome sequences, no tool performed well against plasmid sequences (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). This included both gene-content and k-mer based tools, and stayed true even for large plasmid fragments (e.g., ≥ 20 kb) for which the error rate ranged between 6.4 and 42.0% for all tools. This highlights how plasmid sequences cannot be entirely distinguished from viruses using current approaches and suggests that alternative methods need to be designed for this purpose. Given the growing list of examples of how plasmid and viral sequence space are intertwined [<xref ref-type="bibr" rid="CR54">54</xref>–<xref ref-type="bibr" rid="CR57">57</xref>], significant work in this area will presumably be required, including possibly the incorporation of a dedicated tool for plasmid detection in VirSorter2 modular framework.</p>
    </sec>
    <sec id="Sec7">
      <title>VirSorter2 is easily available and can be scaled to handle large-scale datasets</title>
      <p id="Par20">Beyond accurate and sensitive virus identification, scalability to process large (&gt; 100,000 sequences) datasets and broad availability for users regardless of their knowledge of command-line or scripting are desirable traits in virus sequence detection tools. For the former, VirSorter2 can process an input dataset of 100,000 sequences totaling 4.2 Gb in 28.6 h using 32 threads. Its memory usage stays nearly constant with increasing data size, and scales nearly linearly with threads used (Figs. <xref rid="MOESM2" ref-type="media">S8</xref> &amp; <xref rid="MOESM2" ref-type="media">S9</xref>). Its total CPU time is higher than other tools (typically 2–10× higher, Fig. <xref rid="MOESM2" ref-type="media">S8</xref>), but VirSorter2’s internal processes are highly parallelizable, and written with snakemake, a cutting-edge pipeline management tool designed for computer clusters [<xref ref-type="bibr" rid="CR58">58</xref>]. VirSorter2 is thus able to utilize multiple cores in the same node and across multiple nodes efficiently, so that compute time would not be a limiting factor even for (ultra)large-scale datasets if state-of-the-art computing cluster resources are available (Fig. <xref rid="MOESM2" ref-type="media">S9</xref>). Further, this increased CPU time is mostly due to the annotation step with larger viral HMM database (&gt; 90% of CPU time) and not to the use of several distinct classifiers, suggesting that additional viral groups and classifiers could be added to the VirSorter2 framework with minimal impact on performance. Finally, users can explore the annotation and per-model score computed by VirSorter2 for each individual sequence, and can generate new output files using different options and cutoffs based on an existing VirSorter2 directory without having to re-compute the annotation step. To illustrate this and other differences between VirSorter and VirSorter2, we provide a detailed analysis of viral sequence detection from an ocean virome using both VirSorter and VirSorter2 (<xref rid="MOESM3" ref-type="media">Supplementary Text</xref>, Fig. <xref rid="MOESM2" ref-type="media">S10</xref>, Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>).</p>
      <p id="Par21">In order to make VirSorter2 useful for the largest community possible, we provide it through multiple implementations and accompanied with extended documentation. Specifically, VirSorter2 is freely available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>), as an App on the CyVerse (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>), and available for local installation through a bioconda package (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). In addition, we provide an extensive step-by-step tutorial on how to run VirSorter2 and how to design new classifiers for additional viral groups and integrate this within a local VirSorter2 instance on protocols.io/VERVENET (<ext-link ext-link-type="uri" xlink:href="https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e">https://www.protocols.io/view/getting-started-with-virsorter2-bhdij24e</ext-link>).</p>
    </sec>
    <sec id="Sec8">
      <title>Current limitations and future developments</title>
      <p id="Par22">Together, these benchmark experiments demonstrate that by integrating multiple classifiers, each customized for a specific viral group, VirSorter2 vastly improves the diversity of viruses that can be automatically detected from environmental sequence data. However, we note several limitations that will benefit from future improvements in our understanding of the virosphere and technical capabilities.</p>
      <p id="Par23">First, while separating the global viral diversity in different groups clearly improved viral sequence detection, there is currently no automated process to optimally group reference viral sequences into different viral classifiers. If the viral groups selected are too large and/or diverse, the corresponding classifier would likely suffer from the same flaw as previous tools, whereby rare members would be under-detected. Conversely, classifiers designed for groups lacking diverse representation will show reduced accuracy, due to an under-trained random forest classifier being unable to extract meaningful identifying features for the group. Thus, further virosphere exploration and systematic classification is critical to provide the training data needed to optimize detection.</p>
      <p id="Par24">Second, some viral groups may require additional references and/or features to achieve a systematic and robust identification. The limits associated with reference sequences are shared by all viral sequence identification tools: as new viral genomes and groups are discovered, e.g., high-quality genomes assembled from metagenomes [<xref ref-type="bibr" rid="CR59">59</xref>], these need to be integrated into virus detection approach to keep these up-to-date. This iterative process is now facilitated by the modular framework of VirSorter2, for which we provide a detailed step-by-step protocol to add additional viral groups and classifiers. The addition of other features would also be a possible avenue for extending the range and/or accuracy of VirSorter2. Contrary to the addition of new viral groups, integrating new feature(s) would require substantial modification of VirSorter2 code, and would thus be only associated with the release of new versions of the tool.</p>
      <p id="Par25">Finally, while run times and computational resources required by VirSorter2 are compatible with modern omics datasets, the size of these datasets will likely keep increasing over the next few years, and may eventually limit the usefulness of VirSorter2. Given that most of the computation time is currently dedicated to the annotation step, this issue will require integration of scalable and improved sequence comparison tools (e.g., MMSeqs2 [<xref ref-type="bibr" rid="CR60">60</xref>], HHBlits [<xref ref-type="bibr" rid="CR61">61</xref>]) and/or new versions of the tools currently used.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par26">The automatic extraction of viral sequences from large-scale sequencing data is now a cornerstone of the current viral ecogenomics toolkit. Identifying viral genomes from omics data enables unprecedented studies of viral taxonomic diversity [<xref ref-type="bibr" rid="CR62">62</xref>], viral population distribution and associated eco-evolutionary constraints [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR47">47</xref>], and viral potential for microbial metabolic reprogramming [<xref ref-type="bibr" rid="CR20">20</xref>]. While current tools typically detect known and “standard” viruses, i.e., viruses in the order <italic>Caudovirales</italic>, pretty well, the approaches available to date remain challenged by novel and/or unusual viral groups. VirSorter2 now provides a framework to go beyond the detection of viruses in the order <italic>Caudovirales</italic> and enables robust detection of all types of viruses in sequencing data. By defining subgroups of viruses with consistent genome features and unique markers, the VirSorter2 framework is designed to grow as databases do such that new viral diversity can be readily detected in large-scale datasets. This will in turn enable researchers to investigate the role(s) played by all viruses across Earth’s biomes, and better understand how these viruses constrain fundamental microbial processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Viral HMM database</title>
      <p id="Par27">The viral HMM database includes viral HMMs from viral protein families (VPF) of JGI earth’s virome project [<xref ref-type="bibr" rid="CR17">17</xref>] and Xfams (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm">https://de.cyverse.org/dl/d/6489360D-1126-413B-A667-D18E39D5F2F1/viral_db_default.hmm</ext-link>). Xfams were generated from a large collection of viral sequences from the Global Ocean Viromes 2.0 (GOV 2.0) [<xref ref-type="bibr" rid="CR16">16</xref>] and the Stordalen Mire Viromes (SMV) [<xref ref-type="bibr" rid="CR63">63</xref>]. Briefly, viral contigs were identified by VirSorter [<xref ref-type="bibr" rid="CR29">29</xref>], DeepVirFinder [<xref ref-type="bibr" rid="CR34">34</xref>], and MARVEL [<xref ref-type="bibr" rid="CR31">31</xref>]. The intersection between the three tools (Category 1 in VirSorter with “--virome” mode, score ≥ 90% in Marvel, and a score of ≥ 0.9 with a <italic>p</italic> value of &lt; 0.05 in DeepVirFinder), were kept. Open reading frames (ORF) were predicted using prodigal with “--meta” mode [<xref ref-type="bibr" rid="CR41">41</xref>], filtered by removing ones with ≥ 95% similarity to RefSeq’s bacterial and archaeal proteins, and then clustered by ClusterONE [<xref ref-type="bibr" rid="CR64">64</xref>] to get rid of singletons (-d 0.3 -s 0.2 --max-overlap 0.8). Multiple sequence alignments were generated for each cluster by MUSCLE (--maxiters 4) [<xref ref-type="bibr" rid="CR65">65</xref>], and then made into HMMs by hmmbuild in HMMER3 package [<xref ref-type="bibr" rid="CR66">66</xref>]. More details of Xfams can be found at iVirus in CyVerse’s Discovery Environment (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de/</ext-link>): /iplant/home/shared/iVirus/Xfams/version_0.5/Xfams-XC.</p>
    </sec>
    <sec id="Sec12">
      <title>Training classifiers</title>
      <p id="Par28">NCBI RefSeq genomes including archaea, bacteria, protists, fungi, and virus were downloaded from NCBI (ftp://<ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nlm.nih.gov/genomes/refseq">ftp.ncbi.nlm.nih.gov/genomes/refseq</ext-link>) on 2020-01-12. Viral genomes from the order <italic>Caudovirales</italic> were used for dsDNA phage; genomes from the families <italic>Mimiviridae</italic>, <italic>Phycodnaviridae</italic>, <italic>Faustoviridae</italic>, <italic>Iridoviridae</italic>, <italic>Marseilleviridae</italic>, <italic>Ascoviridae</italic>, <italic>Pithoviridae</italic>, <italic>Poxviridae</italic>, and <italic>Pandoraviridae</italic> were used for NCLDV; genomes from the realm <italic>Riboviria</italic> were used for RNA viruses; genomes from the families <italic>Bacilladnaviridae</italic>, <italic>Circoviridae</italic>, <italic>Geminiviridae</italic>, <italic>Nanoviridae Genomoviridae</italic>, <italic>Parvoviridae</italic>, <italic>Microviridae</italic>, <italic>Smacoviridae</italic>, <italic>Alphasatellitidae</italic>, <italic>Tolecusatellitidae</italic>, <italic>Anelloviridae</italic>, <italic>Bidnaviridae</italic>, <italic>Pleolipoviridae</italic>, <italic>Spiraviridae</italic>, and <italic>Inoviridae</italic> were used for ssDNA viruses; genomes from the family <italic>Lavidaviridae</italic> were used for <italic>Lavidaviridae</italic> classifier. Other than NCBI RefSeq genomes, a set of high-quality genomes was also obtained from the literature [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR53">53</xref>] and unpublished ssDNA virus genome data (Varsani, unpublished data). These genomes were identified based on VirSorter1, VirFinder, or using custom pipelines, and were further analyzed and manually curated as part of their respective publication. Hence, they represent useful examples of “novel” viruses, often distantly related to RefSeq reference genomes. The genomes of all viral and non-viral groups were split into “training” and “testing” sets with a 9 to 1 ratio, respectively. The “training” sets from RefSeq and non-RefSeq sources were combined. For viral genomes, five fragments were generated starting at a random genome position with length ranging from 1000 bp to the maximal length (extending to the end of genome). For bacteria, archaea, and eukaryotes, five fragments were generated from a representative genome from each genus in the same way as described above; for plasmids, because no systematic global classification is available and the total number of plasmids in the input dataset [<xref ref-type="bibr" rid="CR67">67</xref>] was only 6642 sequences, five fragments were generated from each sequence. The generated fragments from each of the three non-viral groups (bacteria and archaea, eukaryotes, and plasmids) were subsampled to the minimum within these three negative groups (bacterial and archaea, eukaryotes, and plasmids) and combined as a final “negative set.” For each viral group, the viral “training set” and the non-viral “training set” were evenly subsampled to the smaller size between the two, and then used for training the classifier. Then the following 27 features were extracted from each sequence fragment:
<list list-type="order"><list-item><p id="Par29">“Hallmark gene count” is the count of hallmark genes in a viral sequence</p></list-item><list-item><p id="Par30">“% of viral genes” is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes</p></list-item><list-item><p id="Par31">“% of archaeal genes” is calculated as the percent of genes annotated as archaeal (best hit to archaeal HMMs) of all genes</p></list-item><list-item><p id="Par32">“% of bacterial genes” is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes</p></list-item><list-item><p id="Par33">“% of eukaryotic genes” is calculated as the percent of genes annotated as eukaryotic (best hit to eukaryotic HMMs) of all genes</p></list-item><list-item><p id="Par34">“% of mixed genes” is calculated as the percent of genes with best hit to HMMs shared between viruses and cells</p></list-item><list-item><p id="Par35">“% of unaligned genes” is calculated as the percent of genes with no hits to HMMs in the VirSorter2 HMM database (bit score cutoff 30)</p></list-item><list-item><p id="Par36">“Average gene size” is the mean of gene sizes in a viral sequence</p></list-item><list-item><p id="Par37">“Gene overlapping frequency” is the percent of consecutive genes that are on the same strand and overlap when scanning from 5′ to 3′ on the + strand</p></list-item><list-item><p id="Par38">“Gene density” is the average number of genes in every 1000 bp sequence window (total number of genes divided by contig length and then multiplied by 1000)</p></list-item><list-item><p id="Par39">“Strand switching frequency” is the percent of genes located on the opposite strand from the gene upstream (scanning from 5′ to 3′ in the + strand)</p></list-item><list-item><p id="Par40">“% of ATG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par41">“% of GTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par42">“% of TTG as starting codon” is the percent of gene with ATG as starting codon</p></list-item><list-item><p id="Par43">“Mean of GC content” is the mean of GC content of all genes in a sequence</p></list-item><list-item><p id="Par44">“SD of GC content” is the standard deviation of GC content of all genes in a sequence</p></list-item><list-item><p id="Par45">“% of RBS motifs” is percent of ribosomal binding sites (RBS) with a specific motif. There are 11 types of motifs included: SD_Canonical, SD_Bacteroidetes, TATATA_3-6, OnlyA, OnlyT, DoubleA, DoubleT, Other_GA, NoA, Other, and None (no motif found) [<xref ref-type="bibr" rid="CR19">19</xref>].</p></list-item></list></p>
      <p id="Par46">Features 8–27 are all extracted from the gff output from prodigal [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par47">With the above features, “RandomForestClassifier” in scikit-learn package [<xref ref-type="bibr" rid="CR50">50</xref>] was used to train the random forest classifier. “MinMax” scaler was used to scale all the feature data, and “GridSearchCV” was used to find optimal parameter sets among “n_estimators” of 20, 50, 100, 150, 200, and “criterion” of gini or entropy.</p>
    </sec>
    <sec id="Sec13">
      <title>Accuracy</title>
      <p id="Par48">To compare the accuracy of VirSorter2 to other viral identification tools, datasets with equal number (50) of viral and non-viral random DNA fragments were generated from the testing set created above and with different lengths (1.5, 3, 5, 10, and 20 kb) to discern the impact of sequence length on accuracy. VirSorter2 (version 2.0.beta) was run with “--include-groups dsDNAphage, NCLDV, RNA, ssDNA, lavidaviridae, --min-score 0.5,” and sequences in “final-viral-combined.fa” were considered as viral. VirSorter (version 1.1.0) was run with “--db 2 --virome –diamond,” and sequences in categories 1, 2, 4 and 5 were considered as viral; VIBRANT (version 1.2.1) was run with “--virome -f nucl”, and sequences in “VIBRANT_*/VIBRANT_phages_*/*.phages_combined.fna” were considered as viral; VirFinder (version 1.1) was run with VF.pred function within R as described in (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/VirFinder">https://github.com/jessieren/VirFinder</ext-link>); DeepVirFinder was installed directly from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/jessieren/DeepVirFinder">https://github.com/jessieren/DeepVirFinder</ext-link>) with last commit ID of ddb4a9433132febe5cda39548cb9332669e11427 and was run with default parameters; for both VirFinder and DeepVirFinder, sequences with p value &lt; 0.05 were chosen as viral. Since MARVEL (version 0.2) required each viral genome as a separate file, input sequences were first split so that each sequence was an individual sequence file, and then default parameters were used, and the sequences in “results/phage_bins” were considered as viral. F1 score (harmonic mean of recall and precision) was used as a metric for tool accuracy comparisons. For measuring false positives on eukaryotic and plasmid sequences, the fraction of eukaryotic or plasmid sequences classified as viral were calculated. To test performance on provirus detection, 54 bacterial genomes with known provirus boundary [<xref ref-type="bibr" rid="CR51">51</xref>] were used. VirSorter2 was run with the “--include-groups all, --min-score 0.5” flag. If a provirus has ≥ 50% of its genome recovered, it was considered as a true positive, and the VirSorter2 identified viral sequences without any true positives identified in them were considered as false positives. Recall and precision of other tools [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR68">68</xref>, <xref ref-type="bibr" rid="CR69">69</xref>] were retrieved from the original VirSorter benchmarking experiments [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Computational efficiency</title>
      <p id="Par49">To measure how tools scale with input data size, datasets with 10, 100, and 1000 sequences of 10 kb in length were generated in the same way as in accuracy benchmarking described above. To measure multithreading efficiency, datasets with 1000 sequences of 10 kb were generated and used as an input for VirSorter2, VirSorter, MARVEL, and VIBRANT were run with 1, 2, 4, 8, 16, 32 threads. VirFinder was not included since it did not have a multi-threading option. DeepVirFinder had unexpected behavior with its multi-threading option (“-c”), i.e., the “-c” option could not control thread number, so was also not included. CPU time and run time was measured with “/usr/bin/time -v” command available in the Linux operating system and peak memory was measure with “memusg” script (<ext-link ext-link-type="uri" xlink:href="https://gist.github.com/netj/526585">https://gist.github.com/netj/526585</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2020_990_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Recall comparisons of tools on dsDNA phages from different data sources. VirSorter2 consistently has comparable or better performance than existing tools in identifying dsDNA phages. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Recall is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S2.</bold> Precision comparisons of tools on dsDNA phages from different data sources. Genome fragments of different lengths (x-axis) are generated from genomes in the order <italic>Caudovirales</italic> in NCBI Viral RefSeq (A), proviruses extracted from microbial genomes in NCBI RefSeq (B) and other sources (C) (described in the “<xref rid="Sec12" ref-type="sec">Training classifier</xref>” part of the Method section). An equal number (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. Error bars show 95% confidence intervals over five replicates (100 sequences each as described above). Precision is used as the metric (y-axis) to compare tools. The dotted line is y = 0.8. <bold>Figure S3.</bold> Tool performances with viral sequences having &lt; 25% of the genes annotated as viral. Genome fragments of different lengths (x-axis) were generated from <italic>Caudovirales</italic> genomes from both NCBI RefSeq genomes and other sources. Only data sources with &gt; 10 viral sequences that have &lt; 25% genes annotated as viral were kept. Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as an input for the tested tools. F1 score is used as the metric (y-axis) to compare tools. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S4.</bold> Importance of different features for viral sequence identification across viral groups. The y-axis shows the relative contribution of individual features in separating the training viral and nonviral (bacterial and archaea, fungi and protozoa, and plasmid) data (total is 1), provided by the Random Forest classifier after processing training data, and based on the F1 score. Top four features from each viral group (10 in total) are shown. In the features (color), “vir” (% of viral genes) is calculated as the percent of genes annotated as viral (best hit to viral HMMs) of all genes; “bac” (% of bacterial genes) is calculated as the percent of genes annotated as bacterial (best hit to bacterial HMMs) of all genes; “hallmark” (hallmark gene count) is the count of hallmark genes in a viral sequence; “mix” (% of mixed genes) is calculated as the percent of genes with best hit to HMMs not specific to virus or non-virus; “Strand_switch_perc” (Strand switching frequency) is the percent of genes located on a different strand from the previous gene (scanning from 5′ to 3′ in the + strand); “density” (Gene density) is the average number of genes in every 1000 bp sequence (total number of genes divided by contig length and then multiply by 1000); “gc_mean” (Mean GC content) is the mean of GC content of all genes in a contig; “atg_perc” (% of ATG as start codon) is the percent of genes with ATG as a starting codon; “rbs_None” is the percent of ribosomal binding sites (RBS) with no motif detected; “rbs_TATATA_3-6” is the percent of RBS with “TATATA_3-6” motif. <bold>Figure S5.</bold> Recall comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Recall was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S6.</bold> Precision comparisons of tools on different viral groups (other than dsDNA phage) from different data sources. Genome fragments of different lengths (x-axis) are generated from NCBI RefSeq (“refseq”) genomes in each viral group and other sources (“non-refseq”). Then equal numbers (50) of viral and non-viral (archaea and bacteria, fungi and protozoa, and plasmids) genome fragments were combined as input for tools. Precision was used as the metric (y-axis) to compare tools. The dotted horizontal line is y = 0.8. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S7.</bold> False positives by VirSorter2 on eukaryotes and plasmids. Genome fragments (50) of different lengths (x-axis) are generated from eukaryotic genomes (fungi and protozoa) in NCBI RefSeq, and plasmids. Percent of genome fragments classified as viral was used as the metric (y-axis) to evaluate tools. Plot A and C show contribution of each classifier (color) to total false positives in VirSorter2 (as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>) for eukaryotes and plasmid respectively. Plot B and D show the total false positive in VirSorter2 after excluding NCLDV, RNA, and <italic>Lavidaviridae</italic> classifiers. vs2 = VirSorter2. <bold>Figure S8.</bold> CPU time and peak memory comparison among tools across data sizes. Tools were run on different input sizes of 10, 100, 1000 sequences with 10 kb in length. Plot (A) shows all tools scale nearly linearly with data size, and (B) shows peak memory usage of all tools are &lt;1 GB. VirSorter2 and VirFinder peak memory usage stay nearly constant. vs2 = VirSorter2; vs1 = VirSorter; vf = VirFinder; dvf = DeepVirFinder; mv = MARVEL; vb = VIBRANT. <bold>Figure S9.</bold> Multi-threading efficiency comparison among tools. Tools were run on 1000 sequences with 10 kb in length. Plot (A) shows VirSorter2 and VIBRANT have the best multi-threading efficiency, i.e. total run time decreases nearly linearly with the number of threads used. VirSorter can not use more than four threads. MARVEL’s multi-threading option does not significantly reduce run time. Plot (B) shows VirSorter2, VirSorter and VIBRANT memory usage increases with the number of threads used, with VirSorter2 and VIBRANT increasing at a higher rate than VirSorter. MARVEL’s memory usage stayed constant. vs2 = VirSorter2; vs1 = VirSorter; mv = MARVEL; vb = VIBRANT. <bold>Figure S10.</bold> Overview of VirSorter2 results for <italic>Tara</italic> Oceans virome 85_SRF. A. Detection of viral contigs via VirSorter 1.0.4 and VirSorter 2.0.beta by contig size. The top panel displays the total number of viral contigs identified in each size class, while the bottom panel indicates the overlap between these predictions. B. Distribution of VirSorter 2.0.beta score (maximum score across all 5 classifiers, y-axis) for <italic>Tara</italic> Oceans virome 85_SRF sequences, according to the confidence category estimated by VirSorter1 (x-axis). “NA” indicates contigs that were not detected as viral by VirSorter1. VirSorter 2.0.beta detections were based on a minimum score cutoff of 0.5. C. Proportion of sequences from Tara Oceans virome 85_SRF detected as viral based on the dsDNAphage, RNA, and/or ssDNA model(s) (red) or detected based on the NCLDV or <italic>Lavidaviridae</italic> classifiers only, by size class (x-axis). <bold>Table S1.</bold> Summary statistics of the genomes used for training VirSorter2 classifiers of different viral groups from RefSeq and non-RefSeq sources. “Genome #” is the number of genomes. “Min size”, “Median size”, and “Max size” are the minimum, median, and maximum of genome sizes per each viral group.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2020_990_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>Case-study: identifying viral contig from a Tara Oceans virome dataset </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2020_990_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3.</bold> First 20 rows of the “final-viral-score.tsv” VirSorter2 output file for Tara Oceans virome 85_SRF. VirSorter 2.0.beta was used with default parameters, including all classifiers and a minimum score cutoff of 0.5. The columns include first the sequence name, the score for each of the 5 classifiers, the maximum score for this sequence, the group yielding this maximum score, the sequence length, the number of hallmark gene(s) for the maximum score group, and the percentage of viral and cellular genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="40168_2020_990_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Manual inspection of contigs newly identified by VirSorter2 in Tara Oceans virome 85_SRF. The spreadsheet includes four tabs, including the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs ≥ 5kb - Manual inspection”), the DRAM-v annotation of these contigs (“Contigs ≥ 5kb - DRAM-v annotation”), the list and characteristics of contigs ≥ 5kb selected for manual inspection (“Contigs &lt; 5kb - Manual inspection”), and their DRAM-v annotation (“Contigs &lt; 5kb - DRAM-v annotation”). For the manual inspection tabs, column headers correspond to the standard output of VirSorter2 (“final-viral-score.tsv”), i.e. sequence name, score for each of the 5 classifiers, maximum score for this sequence, group yielding this maximum score, sequence length, number of hallmark gene(s) for the maximum score group, percentage of viral and cellular genes, along with an additional column (“Manual inspection notes”) indicating the conclusions from the expert curators. The DRAM-v annotation tabs column headers correspond to the default DRAM-v output.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Sullivan Lab for feedback on design and implementation of VirSorter2, as well as comments on the manuscript. We also thank Ohio Supercomputer Center (OSC) [<xref ref-type="bibr" rid="CR70">70</xref>] for providing computing resources.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MBS, SR, and JG designed the experiment. JG, SR, and BB implemented the tool. SR, AAZ, AV, GDH, TOD, and DV provided hallmark gene sequences and HMMs, and curated the non-RefSeq genomes for different viral groups. JG and SR performed benchmark test and data analyses. SR, DV, MCG, AAP, and JG performed the manual curation of newly identified viral sequences by VirSorter2 in an ocean virome sample. All contributed to writing the manuscript with SR, MBS, and JG as major contributors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Funding was provided by NSF (#OCE1829831, #ABI1758974), the U.S. Department of Energy (#DE-SC0020173), and the Gordon and Betty Moore Foundation (#3790) to MBS. The work conducted by the U.S. Department of Energy Joint Genome Institute is supported by the Office of Science of the U.S. Department of Energy under contract no. DE-AC02-05CH11231.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source code of VirSorter2 is available at bitbucket (<ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MAVERICLab/vcontact2/src/master/">https://bitbucket.org/MAVERICLab/VirSorter2</ext-link>). VirSorter2 can be installed via bioconda [<xref ref-type="bibr" rid="CR71">71</xref>] (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/virsorter">https://anaconda.org/bioconda/virsorter</ext-link>). A web version can be accessed at CyVerse/iVirus (<ext-link ext-link-type="uri" xlink:href="https://de.cyverse.org/de/">https://de.cyverse.org/de</ext-link>). The databases used in VirSorter2, high quality non-RefSeq genomes used for training classifier and benchmark (except for ssDNA viral genomes [Varsani, unpublished data]), benchmark result tables (recall, precision, and F1 score), and ocean virome contig data used for manual curation and its VirSorter2 and VirSorter results are available at zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4297575;">https://zenodo.org/record/4297575;</ext-link> see instruction in README file). The VirSorter2 database can be automatically downloaded through VirSorter2 “setup” subcommand.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falkowski</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Fenchel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>The microbial engines that drive Earth’s biogeochemical cycles</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1034</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1153213</pub-id>
        <?supplied-pmid 18497287?>
        <pub-id pub-id-type="pmid">18497287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Embracing the unknown: disentangling the complexities of the soil microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>579</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2017.87</pub-id>
        <?supplied-pmid 28824177?>
        <pub-id pub-id-type="pmid">28824177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The ancestral and industrialized gut microbiota and implications for human health</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>383</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0191-8</pub-id>
        <?supplied-pmid 31089293?>
        <pub-id pub-id-type="pmid">31089293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Metagenome-wide association studies: fine-mining the microbiome</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2016</year>
        <volume>14</volume>
        <fpage>508</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro.2016.83</pub-id>
        <?supplied-pmid 27396567?>
        <pub-id pub-id-type="pmid">27396567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics, from sampling to analysis</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>833</fpage>
        <lpage>844</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id>
        <?supplied-pmid 28898207?>
        <pub-id pub-id-type="pmid">28898207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmon-Smith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>TBK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum information about a single amplified genome (MISAG) and a metagenome-assembled genome (MIMAG) of bacteria and archaea</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>725</fpage>
        <lpage>731</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3893</pub-id>
        <?supplied-pmid 6436528?>
        <pub-id pub-id-type="pmid">28787424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Semenkovich</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Whiteson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Going viral: next-generation sequencing applied to phage populations in the human gut</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>607</fpage>
        <lpage>617</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2853</pub-id>
        <?supplied-pmid 22864264?>
        <pub-id pub-id-type="pmid">22864264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>From deep sequencing to viral tagging: Recent advances in viral metagenomics</article-title>
        <source>BioEssays</source>
        <year>2013</year>
        <volume>35</volume>
        <fpage>436</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200174</pub-id>
        <?supplied-pmid 23450659?>
        <pub-id pub-id-type="pmid">23450659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Kropinski</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum Information about an Uncultivated Virus Genome (MIUViG)</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4306</pub-id>
        <?supplied-pmid 30556814?>
        <pub-id pub-id-type="pmid">30556814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Viral metagenomics</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>504</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1163</pub-id>
        <?supplied-pmid 15886693?>
        <pub-id pub-id-type="pmid">15886693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viromes, not gene markers, for studying double-stranded DNA virus communities</article-title>
        <source>J Virol</source>
        <year>2015</year>
        <volume>89</volume>
        <fpage>2459</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.03289-14</pub-id>
        <?supplied-pmid 25540374?>
        <pub-id pub-id-type="pmid">25540374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ignacio-Espinoza</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doulcier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Acinas</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and ecological drivers of ocean viral communities</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261498</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261498</pub-id>
        <pub-id pub-id-type="pmid">25999515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendrix</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>MCM</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Hatfull</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary relationships among diverse bacteriophages and prophages: all the world’s a phage</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1999</year>
        <volume>96</volume>
        <fpage>2192</fpage>
        <lpage>2197</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.96.5.2192</pub-id>
        <?supplied-pmid 10051617?>
        <pub-id pub-id-type="pmid">10051617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mushegian</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Are there 1031 virus particles on earth, or more, or fewer?</article-title>
        <source>J Bacteriol</source>
        <year>2020</year>
        <volume>202</volume>
        <issue>9</issue>
        <fpage>e00052</fpage>
        <lpage>e00020</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00052-20</pub-id>
        <?supplied-pmid 32071093?>
        <pub-id pub-id-type="pmid">32071093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duhaime</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Loy</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ecogenomics and potential biogeochemical impacts of globally abundant ocean viruses</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>537</volume>
        <fpage>689</fpage>
        <lpage>693</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19366</pub-id>
        <?supplied-pmid 27654921?>
        <pub-id pub-id-type="pmid">27654921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregory</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Zayed</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Conceição-Neto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Temperton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Marine DNA viral macro- and microdiversity from pole to pole</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1109</fpage>
        <lpage>1123.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.03.040</pub-id>
        <?supplied-pmid 31031001?>
        <pub-id pub-id-type="pmid">31031001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eloe-Fadrosh</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Huntemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mikhailova</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Uncovering Earth’s virome</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>536</volume>
        <fpage>425</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19094</pub-id>
        <?supplied-pmid 27533034?>
        <pub-id pub-id-type="pmid">27533034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>I-MA</given-names>
          </name>
          <name>
            <surname>Palaniappan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ratner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMG/VR v.2.0: an integrated data management and analysis system for cultivated and environmental viral genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D678</fpage>
        <lpage>D686</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1127</pub-id>
        <?supplied-pmid 30407573?>
        <pub-id pub-id-type="pmid">30407573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jungbluth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Denef</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giant virus diversity and host interactions through global metagenomics</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>432</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1957-x</pub-id>
        <?supplied-pmid 31968354?>
        <pub-id pub-id-type="pmid">31968354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitbart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bonnain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Malki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sawaya</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Phage puppet masters of the marine microbial realm</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>754</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0166-y</pub-id>
        <?supplied-pmid 29867096?>
        <pub-id pub-id-type="pmid">29867096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ofir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sorek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Contemporary phage biology: from classic models to new insights</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1260</fpage>
        <lpage>1270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.045</pub-id>
        <?supplied-pmid 29522746?>
        <pub-id pub-id-type="pmid">29522746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Tisza MJ, Pastrana DV, Welch NL, Stewart B, Peretti A, Starrett GJ, et al. Discovery of several thousand highly diverse circular DNA viruses. eLife. 9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7000223/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Li C-X, Shi M, Tian J-H, Lin X-D, Kang Y-J, Chen L-J, et al. Unprecedented genomic diversity of RNA viruses in arthropods reveals the ancestry of negative-sense RNA viruses. eLife. 4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4384744/</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Redefining the invertebrate RNA virosphere</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>540</volume>
        <fpage>539</fpage>
        <lpage>543</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20167</pub-id>
        <?supplied-pmid 27880757?>
        <pub-id pub-id-type="pmid">27880757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X-D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolutionary history of vertebrate RNA viruses</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>197</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0012-7</pub-id>
        <?supplied-pmid 29618816?>
        <pub-id pub-id-type="pmid">29618816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moniruzzaman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martinez-Gutierrez</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Weinheimer</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Aylward</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Dynamic genome evolution and complex virocell metabolism of globally-distributed giant viruses</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1710</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15507-2</pub-id>
        <?supplied-pmid 32249765?>
        <pub-id pub-id-type="pmid">32249765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lima-Mendez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Helden</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Toussaint</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leplae</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Prophinder: a computational tool for prophage prediction in prokaryotic genomes</article-title>
        <source>Bioinforma Oxf Engl</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>863</fpage>
        <lpage>865</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akhter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aziz</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>PhiSpy: a novel algorithm for finding prophages in bacterial genomes that combines similarity- and composition-based strategies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e126</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks406</pub-id>
        <?supplied-pmid 22584627?>
        <pub-id pub-id-type="pmid">22584627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e985</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.985</pub-id>
        <?supplied-pmid 26038737?>
        <pub-id pub-id-type="pmid">26038737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arndt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sajed</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W16</fpage>
        <lpage>W21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw387</pub-id>
        <?supplied-pmid 27141966?>
        <pub-id pub-id-type="pmid">27141966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Amgarten D, Braga LPP, da Silva AM, Setubal JC. MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins. Front Genet. 2018;9 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6090037/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Kieft K, Zhou Z, Anantharaman K. VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of virome function from genomic sequences. Bioinformatics. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/855387">http://biorxiv.org/lookup/doi/10.1101/855387</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0283-5</pub-id>
        <?supplied-pmid 28683828?>
        <pub-id pub-id-type="pmid">28683828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying viruses from metagenomic data using deep learning</article-title>
        <source>Quant Biol</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>64</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1007/s40484-019-0187-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>
        <source>Nat Microbiol</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>1895</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-019-0510-x</pub-id>
        <?supplied-pmid 31332386?>
        <pub-id pub-id-type="pmid">31332386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Rising to the challenge: accelerated pace of discovery transforms marine virology</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>147</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro3404</pub-id>
        <?supplied-pmid 25639680?>
        <pub-id pub-id-type="pmid">25639680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Emerson JB, et al. mSystems. 2019;4 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6584876/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vik</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Padilla</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Putative archaeal viruses from the mesopelagic ocean</article-title>
        <source>PeerJ</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>e3428</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.3428</pub-id>
        <?supplied-pmid 28630803?>
        <pub-id pub-id-type="pmid">28630803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Ponsero AJ, Hurwitz BL. The promises and pitfalls of machine learning for detecting viruses in aquatic metagenomes. Front Microbiol. 2019;10 Available from: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6477088/</ext-link>. Cited 2020 May 24.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Koonin EV, Dolja VV, Krupovic M, Varsani A, Wolf YI, Yutin N, et al. Global organization and proposed megataxonomy of the virus world. Microbiol Mol Biol Rev. 2020;84(2):e00061-19. doi: 10.1128/MMBR.00061-19. </mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>LoCascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <?supplied-pmid 20211023?>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated profile HMM searches</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
        <?supplied-pmid 22039361?>
        <pub-id pub-id-type="pmid">22039361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Gebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database in 2019</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D427</fpage>
        <lpage>D432</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky995</pub-id>
        <?supplied-pmid 30357350?>
        <pub-id pub-id-type="pmid">30357350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Krupovic M, Varsani A, Kazlauskas D, Breitbart M, Delwart E, Rosario K, et al. Cressdnaviricota: a virus phylum unifying seven families of rep-encoding viruses with single-stranded, circular DNA genomes. J Virol. 2020;94 American Society for Microbiology Journals. Available from: <ext-link ext-link-type="uri" xlink:href="https://jvi.asm.org/content/94/12/e00582-20">https://jvi.asm.org/content/94/12/e00582-20</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callanan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stockdale</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Shkoporov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Expansion of known ssRNA phage genomes: from tens to over a thousand</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <fpage>eaay5981</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aay5981</pub-id>
        <?supplied-pmid 32083183?>
        <pub-id pub-id-type="pmid">32083183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>L-K</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmstrom</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Ecogenomics of virophages and their giant virus hosts assessed through time series metagenomics</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>858</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01086-2</pub-id>
        <?supplied-pmid 29021524?>
        <pub-id pub-id-type="pmid">29021524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity, evolution, and classification of virophages uncovered through global metagenomics</article-title>
        <source>Microbiome</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>157</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-019-0768-5</pub-id>
        <?supplied-pmid 31823797?>
        <pub-id pub-id-type="pmid">31823797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hallam</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Viral dark matter and virus-host interactions resolved from publicly available microbial genomes</article-title>
        <source>eLife</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>e08490</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.08490</pub-id>
        <?supplied-pmid 4533152?>
        <pub-id pub-id-type="pmid">4533152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casjens</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Prophages and bacterial genomics: what have we learned so far?</article-title>
        <source>Mol Microbiol</source>
        <year>2003</year>
        <volume>49</volume>
        <fpage>277</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-2958.2003.03580.x</pub-id>
        <?supplied-pmid 12886937?>
        <pub-id pub-id-type="pmid">12886937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Dempsey</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Orton</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Siddell</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Virus taxonomy: the database of the International Committee on Taxonomy of Viruses (ICTV)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D708</fpage>
        <lpage>D717</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx932</pub-id>
        <?supplied-pmid 29040670?>
        <pub-id pub-id-type="pmid">29040670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Moniruzzaman M, Martinez-Gutierrez CA, Weinheimer AR, Aylward FO. Dynamic genome evolution and blueprint of complex virocell metabolism in globally-distributed giant viruses. Microbiology. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/836445">http://biorxiv.org/lookup/doi/10.1101/836445</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Recombination between RNA viruses and plasmids might have played a central role in the origin and evolution of small DNA viruses</article-title>
        <source>BioEssays News Rev Mol Cell Dev Biol</source>
        <year>2012</year>
        <volume>34</volume>
        <fpage>867</fpage>
        <lpage>870</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.201200083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krupovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ravantti</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Geminiviruses: a tale of a plasmid becoming a virus</article-title>
        <source>BMC Evol Biol</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>112</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-9-112</pub-id>
        <?supplied-pmid 19460138?>
        <pub-id pub-id-type="pmid">19460138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zillig</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Prangishvilli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schleper</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elferink</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Holz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viruses, plasmids and other genetic elements of thermophilic and hyperthermophilic Archaea</article-title>
        <source>FEMS Microbiol Rev</source>
        <year>1996</year>
        <volume>18</volume>
        <fpage>225</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6976.1996.tb00239.x</pub-id>
        <?supplied-pmid 8639330?>
        <pub-id pub-id-type="pmid">8639330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soler</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gaudin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marguet</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forterre</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Plasmids, viruses and virus-like membrane vesicles from Thermococcales</article-title>
        <source>Biochem Soc Trans</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1042/BST0390036</pub-id>
        <?supplied-pmid 21265744?>
        <pub-id pub-id-type="pmid">21265744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <?supplied-pmid 22908215?>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Nayfach S, Camargo AP, Eloe-Fadrosh E, Roux S, Kyrpides N. CheckV: assessing the quality of metagenome-assembled viral genomes. Bioinformatics. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778">http://biorxiv.org/lookup/doi/10.1101/2020.05.06.081778</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id>
        <?supplied-pmid 29035372?>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vöhringer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Haunsberger</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>473</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3019-7</pub-id>
        <?supplied-pmid 31521110?>
        <pub-id pub-id-type="pmid">31521110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bin Jang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zablocki</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adriaenssens</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic assignment of uncultivated prokaryotic virus genomes is enabled by gene-sharing networks</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>632</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0100-8</pub-id>
        <?supplied-pmid 31061483?>
        <pub-id pub-id-type="pmid">31061483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brum</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolduc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>HB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host-linked soil viral ecology along a permafrost thaw gradient</article-title>
        <source>Nat Microbiol</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>870</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0190-y</pub-id>
        <?supplied-pmid 30013236?>
        <pub-id pub-id-type="pmid">30013236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nepusz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Paccanaro</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Detecting overlapping protein complexes in protein-protein interaction networks</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>471</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1938</pub-id>
        <?supplied-pmid 22426491?>
        <pub-id pub-id-type="pmid">22426491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <?supplied-pmid 15034147?>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A new generation of homology search tools based on probabilistic inference</article-title>
        <source>Genome Inf</source>
        <year>2009</year>
        <volume>23</volume>
        <fpage>205</fpage>
        <lpage>211</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Brooks L, Kaze M, Sistrom M. A curated, comprehensive database of plasmid sequences. Microbiol Resour Announc. 2019;8 American Society for Microbiology. Available from: <ext-link ext-link-type="uri" xlink:href="https://mra.asm.org/content/8/1/e01325-18">https://mra.asm.org/content/8/1/e01325-18</ext-link>. Cited 2020 Jun 13.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>PHAST: a fast phage search tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W347</fpage>
        <lpage>W352</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr485</pub-id>
        <?supplied-pmid 21672955?>
        <pub-id pub-id-type="pmid">21672955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fouts</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>Phage_Finder: automated identification and classification of prophage regions in complete bacterial genome sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>5839</fpage>
        <lpage>5851</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl732</pub-id>
        <?supplied-pmid 17062630?>
        <pub-id pub-id-type="pmid">17062630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Ohio Supercomputer Center. 1987. Ohio Supercomputer Center. Columbus OH: Ohio Supercomputer Center. viewed 4 July 2020. http://osc.edu/ark:/19495/f5s1ph73.</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sjödin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>475</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
        <?supplied-pmid 29967506?>
        <pub-id pub-id-type="pmid">29967506</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
