<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10644574</article-id>
    <article-id pub-id-type="publisher-id">5525</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05525-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>G-Aligner: a graph-based feature alignment method for untargeted LC–MS-based metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ruimin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Miaoshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Shaowei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jinyin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Changbin</given-names>
        </name>
        <address>
          <email>yu_lab@sdfmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013q1eq08</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>Fudan University, </institution></institution-wrap>Shanghai, 200433 Shanghai China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Engineering, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05jb9pq57</institution-id><institution-id institution-id-type="GRID">grid.410587.f</institution-id><institution>Shandong First Medical University and Shandong Academy of Medical Sciences, </institution></institution-wrap>Jinan, 250021 Shandong China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 310058 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Life Sciences, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>431</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Liquid chromatography–mass spectrometry is widely used in untargeted metabolomics for composition profiling. In multi-run analysis scenarios, features of each run are aligned into consensus features by feature alignment algorithms to observe the intensity variations across runs. However, most of the existing feature alignment methods focus more on accurate retention time correction, while underestimating the importance of feature matching. None of the existing methods can comprehensively consider feature correspondences among all runs and achieve optimal matching.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To comprehensively analyze feature correspondences among runs, we propose G-Aligner, a graph-based feature alignment method for untargeted LC–MS data. In the feature matching stage, G-Aligner treats features and potential correspondences as nodes and edges in a multipartite graph, considers the multi-run feature matching problem an unbalanced multidimensional assignment problem, and provides three combinatorial optimization algorithms to find optimal matching solutions. In comparison with the feature alignment methods in OpenMS, MZmine2 and XCMS on three public metabolomics benchmark datasets, G-Aligner achieved the best feature alignment performance on all the three datasets with up to 9.8% and 26.6% increase in accurately aligned features and analytes, and helped all comparison software obtain more accurate results on their self-extracted features by integrating G-Aligner to their analysis workflow. G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license. Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner comprehensively considered potential feature correspondences between all runs, converting the feature matching problem as a multidimensional assignment problem (MAP). In evaluations on three public metabolomics benchmark datasets, G-Aligner achieved the highest alignment accuracy on manual annotated and popular software extracted features, proving the effectiveness and robustness of the algorithm.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05525-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>LC–MS</kwd>
      <kwd>Feature alignment</kwd>
      <kwd>Multidimensional assignment problem</kwd>
      <kwd>Combinatorial optimization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007129</institution-id>
            <institution>Natural Science Foundation of Shandong Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022HWYQ-081</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Academic promotion project of Shandong First Medical University</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Funding from Jinan City</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par25">Liquid chromatography–mass spectrometry (LC–MS) is widely used in the discovery of unknown compounds in untargeted metabolomics [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] In an analysis of multiple LC–MS runs, features of each run are first detected and quantified from raw data by feature extraction algorithms, and features of multiple related LC–MS runs are then combined into one consensus result map by feature alignment algorithms [<xref ref-type="bibr" rid="CR3">3</xref>]. The accuracy of feature alignment directly determines the rationality and credibility of subsequent statistical and biological analysis. However, features have nonlinear retention time (RT) drifts between runs due to unavoidable slight changes in chromatogram conditions [<xref ref-type="bibr" rid="CR4">4</xref>], such as column temperature, column aging and contamination, which greatly increases the difficulty of aligning consensus features.</p>
    <p id="Par26">To perform accurate feature alignment, researchers have proposed dozens of methods in the last decades [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The feature alignment methods can be divided into two categories according to the alignment steps, retention time alignment and feature matching. Retention time alignment methods, such as DTW [<xref ref-type="bibr" rid="CR6">6</xref>], PTW [<xref ref-type="bibr" rid="CR7">7</xref>] and GTW [<xref ref-type="bibr" rid="CR8">8</xref>], align retention times of multiple runs to a common space by fitting linear or nonlinear warping functions between runs to correct retention shifts and make features of the same analyte have closer elution time. Feature matching methods group features of different runs to consensus feature groups by distances in m/z and RT dimensions. Each consensus feature group represents the predicted corresponding features of the same analyte.</p>
    <p id="Par27">Most existing methods rely heavily on retention time alignment and only use naive nearest neighbor search in feature matching. The representative one is MZmine2 [<xref ref-type="bibr" rid="CR9">9</xref>]. After aligning retention time with RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>], MZmine2 selects a reference run and performs pairwise nearest matching to match features of other runs to the reference. However, retention time alignment methods can only describe the drifting trend between runs but cannot accurately correct the retention time of each feature. The retention time of analytes has different drift trends and offsets according to different physical and chemical properties, and elution order may swap when features of different analytes are sufficiently close. To perform more accurate feature matching, LWBmatch [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] considers feature matching between runs as an unbalanced weighted bipartite matching problem and solves the multi-run feature alignment problem by pairwise feature matching. To solve the feature matching problem more comprehensively, OpenMS [<xref ref-type="bibr" rid="CR13">13</xref>] and XCMS [<xref ref-type="bibr" rid="CR14">14</xref>] consider the multi-run feature matching problem a clustering problem. OpenMS finds a cluster of the nearest features for each feature among all runs and then chooses the tightest cluster iteratively to get the feature matching results. XCMS first separates features of all runs by m/z bins, then calculates the feature density curve in RT dimension for each bin, and groups the features according to the RT ranges of peaks in the density curve. However, the OpenMS method uses centralized nearest matching, which is prone to fall into local optimum, and the XCMS grouping is only based on dimensionality reduced RT distribution of features, which leads to lower accuracy and limited performance on feature matchings of close analytes.</p>
    <p id="Par28">To improve feature matching performance, in this paper, we propose G-Aligner (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), a graph-based feature alignment method for untargeted LC–MS-based metabolomics. G-Aligner is the first method enabling non-centric comprehensive analysis of all potential feature correspondences among multiple LC–MS runs. In the retention time alignment stage, G-Aligner uses the existing RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>] and OBI-Warp [<xref ref-type="bibr" rid="CR15">15</xref>] algorithms to perform stable coarse registration between runs. In the feature matching stage, G-Aligner formats the potential correspondences between all features as a multipartite graph, and solves the multi-run feature matching problem as an unbalanced multidimensional assignment problem [<xref ref-type="bibr" rid="CR16">16</xref>] with three combinatorial optimization methods. In comparison with feature alignment methods in OpenMS, MZmine2 and XCMS, G-Aligner showed significant improvements in feature alignment accuracy and helped all comparison software obtain more accurate results by integrating G-Aligner into their workflow.<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of G-Aligner. G-Aligner performs feature alignment in three main steps: feature list input, retention time alignment and feature matching. After loading features of multiple samples, G-Aligner first roughly aligns the retention time of features between samples. Then, in the feature matching step, G-Aligner builds multipartite graphs to represent potential matching relationship among features, and utilizes combinatorial optimization to obtain optimal matchings</p></caption><graphic xlink:href="12859_2023_5525_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Evaluation datasets</title>
      <p id="Par29">We used the two public metabolomics benchmark datasets in [<xref ref-type="bibr" rid="CR17">17</xref>], named as the TripleTOF 6600 dataset and the QE HF dataset. Both datasets were acquired with the full-scan method. The TripleTOF 6600 dataset was acquired by AB SCIEX TripleTOF 6600 interfaced with Shimazu L30A UPLC, and the QE HF dataset was acquired by Thermo Q Exactive HF with Dionex UltiMate 3000 HPLC. A pair of standard mixtures (SA, SB) were prepared for both datasets, which were composed of seven differential groups of drugs and metabolites (Gd1, Gd2, Gd3, Gm, Gd4, Gd5, Gd6) prepared at different relative concentration ratios of (1/16, 1/4, 1/2, 1/1, 2/1, 4/1, 16/1) in SB: SA. The TripleTOF 6600 dataset had four replicates for each mixture, with a total of eight runs. The QE HF dataset had five replicates for each mixture, with a total of ten runs. Benchmark libraries were provided along with the datasets, containing 970 and 836 analytes in the TripleTOF 6600 and the QE HF datasets. We further screened the benchmark libraries to remove duplicates and obtained 924 and 835 analytes, respectively. In both benchmark datasets, the retention times of mixed compounds have different drift trends due to large differences in physical and chemical properties (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Even after retention time alignment across runs, the retention times of analyte features still had wide shifts, which increased the difficulty of feature alignment and made the dataset more suitable for feature alignment evaluation.</p>
      <p id="Par30">Furthermore, to evaluate the performance of feature alignment methods on a bigger dataset, we used the dataset published in Metabolights MTBLS562 [<xref ref-type="bibr" rid="CR18">18</xref>]. The MTBLS562 dataset was acquired with DDA method and acquired by AB SCIEX TripleTOF 6600 with Agilent 1290 UHPLC system. The MTBLS562 dataset contains 40 LC–MS runs of 40 mice (C57BL/6J strain, SPF level) at 5 different ages (4, 12, 24, 32 to 52 weeks, n=8 in each group). Benchmark library was provided along with the dataset, containing 245 analytes. We further screened the benchmark library to remove duplicates and noises and obtained 207 analytes. Some analytes in the library have low abundance in samples with feature intensity heights on the order of hundreds.</p>
    </sec>
    <sec id="Sec4">
      <title>Input preparation</title>
      <p id="Par31">G-Aligner requires users to provide a list of extracted features for each LC–MS run. G-Aligner supports feature extraction results in csv and tsv formats, which can be exported from untargeted metabolomics software. As a general method, G-Aligner only requires users to provide basic feature information, including m/z, retention time and intensity. In case of using profile-based retention time alignment methods that require raw files (such as OBI-Warp), users need to convert raw files to mzML format by MSConvert [<xref ref-type="bibr" rid="CR19">19</xref>] or aird format by AirdPro [<xref ref-type="bibr" rid="CR20">20</xref>] for G-Aligner analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Retention time alignment</title>
      <p id="Par32">To correct retention time drift and reduce the difficulty of subsequent feature matching, G-Aligner provides a feature-based retention time alignment method RANSAC (RANdom SAmple Consensus) and a profile-based method OBI-Warp (Ordered Bijective Interpolated Warping). RANSAC is an iterative method for fitting a model to data and is robust to outliers. In each iteration, the RANSAC method selects a random subset of points from the input data and fits a linear or nonlinear model to these points. The remaining points are then classified into inliers or outliers based on their consistency with the model. Among the iterations, the best-fitting model with the largest number of inliers is selected as the alignment result. OBI-Warp is an extension of dynamic time warping (DTW) for nonlinear retention time warping. For pairs of runs that need to be aligned, OBI-Warp first uses DTW to analyze the spectral similarity and obtain the optimal bijective warping function by dynamic programming. OBI-Warp combines the warping function output from DTW with piecewise cubic Hermitian interpolation and produces smooth warped functions. G-Aligner implemented OBI-Warp in Python for the first time and separated it as an independent installation package for importing by other Python-based software. These two algorithms were also applied in MZmine2 and XCMS, respectively, and their effectiveness and stability have been proven in long-term use. G-Aligner uses linear RANSAC as the default retention time alignment algorithm because it does not require additional raw file import and is faster and more stable.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature matching</title>
      <sec id="Sec7">
        <title>Graph building</title>
        <p id="Par33">Instead of matching features iteratively to a real or virtual reference run, G-Aligner comprehensively considers potential feature correspondences between all LC–MS runs and performs combinatorial optimization to obtain optimal solutions. After retention time coarse registration, the corresponding features of each analyte in different runs are relatively close in m/z and retention time coordinates. To find potential correspondences among all runs, G-Aligner superimposes the retention time aligned features in all runs on the same coordinate system consisting of m/z and retention time dimensions, searches neighborhoods for each feature according to the m/z and retention time tolerances set by the user, and builds an undirected relation graph containing features of all runs. Each node in the graph represents a feature, and each edge represents a potential feature correspondence between neighbor features.</p>
      </sec>
      <sec id="Sec8">
        <title>Graph splitting</title>
        <p id="Par34">After graph building, spatially close feature nodes are connected into many connected components, which are maximal connected subgraphs of the relation graph. A connected component is the largest set of potentially corresponding features for each contained analyte and can be treated as the smallest computing unit for combinatorial optimization. G-Aligner splits the relation graph into connected components and performs combinatorial optimization on each connected component to divide and conquer the feature matching problem. The edge weights in each connected component are calculated by the weighted sum of normalized differences in m/z, retention time and intensity. The m/z and retention time differences are normalized by user-specified m/z and retention time tolerances, and the intensity difference is the deviation in intensity normalized by the largest feature intensity in the same connected component in each run. The edge weight is calculated as Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref> and Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} normed\ area= &amp; {} \frac{area}{maximum\ area\ in\ the\ partite} \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">area</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} edge\ weight= &amp; {} \frac{1}{3} \times \left( \frac{|\Delta m/z|}{m/z\ tolerance} + \frac{|\Delta RT|}{RT\ tolerance} + \left( 1-\frac{\min (normed\ area)}{\max (normed\ area)} \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec9">
        <title>Assignment solving</title>
        <p id="Par35">In graph theory, a multipartite graph is a type of graph in which the nodes can be divided into multiple independent sets. Each set of nodes is called a partite, and each edge connects a pair of nodes from different partites. After graph splitting, each connected component is a multipartite graph where edges do not connect feature nodes of the same run but different runs. To find the optimal correspondence solution, G-Aligner treats the feature matching problem on the multipartite subgraph as an unbalanced multidimensional assignment problem (MAP), in which the feature number differs in partites. MAP is a fundamental combinatorial optimization problem to find optimal matchings in a weighted multipartite graph, in which the sum of weights of the edges is minimum.</p>
        <p id="Par36">In G-Aligner, we comprehensively considered the neighborhood distribution of features in all runs and defined the unbalanced MAP of the feature matching as follows. For a multipartite graph <italic>G</italic> which contained feature nodes <italic>F</italic> from <italic>M</italic> runs (Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>), let <italic>F</italic>(<italic>k</italic>) represent the feature set of the <italic>k</italic>-th LC–MS run, and <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{ik}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq1.gif"/></alternatives></inline-formula> represent the <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_k$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq2.gif"/></alternatives></inline-formula>-th feature node in the <italic>k</italic>-th LC–MS run (Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref>). <italic>F</italic>(<italic>k</italic>) contains <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_k$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq3.gif"/></alternatives></inline-formula> deduplicated feature nodes <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{f^k_0,\dots ,f^k_{n_k-1}\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq4.gif"/></alternatives></inline-formula> and a placeholder node <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq5.gif"/></alternatives></inline-formula>. We define a linkage (M-partite matching) of features as <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq6.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ5" ref-type="disp-formula">5</xref>), which contains one feature node from each run. Each linkage represents a possible combination of related features of an analyte. When linkage <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq7.gif"/></alternatives></inline-formula> contains a placeholder node <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq8.gif"/></alternatives></inline-formula>, it means no feature from the <italic>k</italic>-th run was matched in the linkage. Accordingly, we recorded the empty linkage containing placeholder nodes of all runs as <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{n_1 \dots n_M}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq9.gif"/></alternatives></inline-formula>. The feasible solutions <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma$$\end{document}</tex-math><mml:math id="M24"><mml:mi>Γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq10.gif"/></alternatives></inline-formula> of MAP should satisfy the following constraints (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>, <xref rid="Equ7" ref-type="disp-formula">7</xref>, <xref rid="Equ8" ref-type="disp-formula">8</xref>, <xref rid="Equ9" ref-type="disp-formula">9</xref>). Equation <xref rid="Equ6" ref-type="disp-formula">6</xref> states that each solution <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M26"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq11.gif"/></alternatives></inline-formula> contains <italic>p</italic> matchings, where <italic>p</italic> is the max node number (containing placeholder node) in each feature set. Equation <xref rid="Equ7" ref-type="disp-formula">7</xref> states that each matching uniquely corresponds to a distinct linkage. Equation <xref rid="Equ8" ref-type="disp-formula">8</xref> states that different matchings in the same solution do not contain shared non-placeholder feature nodes. Equation <xref rid="Equ9" ref-type="disp-formula">9</xref> states that each feasible solution contains all feature nodes. A figure of feature nodes, linkages and matchings in a feasible solution is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F= &amp; {} \{F(1), \ldots , F(M)\} \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">{</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F(k)= &amp; {} \left\{ f_{i_k}^k \mid i_k=0, \ldots , n_k\right\} , \text{ for } k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>∣</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_{i_1 \ldots i_M}= &amp; {} \left\{ f_{i_1}^1, \ldots , f_{i_M}^M\right\} , \text{ for } i_k=0, \ldots , n_k, k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>M</mml:mi></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \gamma= &amp; {} \left\{ \gamma _1, \ldots , \gamma _p\right\} , p=\max \left( n_1, \ldots , n_M\right) +1 \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall \gamma _j: \gamma _j= &amp; {} L_{i_1 \ldots i_M} \exists ! {\text {tuple}}\left( i_1, \ldots , i_M\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∃</mml:mo><mml:mo>!</mml:mo><mml:mtext>tuple</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} \gamma _i \cap \gamma _j \subset L_{n_1 \ldots n_M}, \text{ for } i \ne j \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} F=U_{j=1}^p \gamma _j \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption><p>Visual representation of feature nodes, linkages and matchings in a feasible solution</p></caption><graphic xlink:href="12859_2023_5525_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par37">In order to measure the quality of solutions, we calculated the cost of each solution and selected the one with the lowest cost as the optimal solution. Let <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\gamma$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq12.gif"/></alternatives></inline-formula> represents the cost of solution <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M44"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq13.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq14.gif"/></alternatives></inline-formula> represents the cost of matching <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq15.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ10" ref-type="disp-formula">10</xref>). The cost of a solution is the total cost of all matchings contained. <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq16.gif"/></alternatives></inline-formula> consists of distribution cost <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq17.gif"/></alternatives></inline-formula>, connectivity cost <inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{connectivity}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq18.gif"/></alternatives></inline-formula>, missing node cost <inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{missing}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq19.gif"/></alternatives></inline-formula> and full match bonus <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{full\_match}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq20.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ11" ref-type="disp-formula">11</xref>).</p>
        <p id="Par38">The distribution cost in a matching describes the dispersion of matched nodes. For matching <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq21.gif"/></alternatives></inline-formula>, we first extract the subgraph <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq22.gif"/></alternatives></inline-formula> from the multipartite graph <italic>G</italic>, which contains all feature nodes and interconnected edges in <inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq23.gif"/></alternatives></inline-formula>. Then, we calculated the minimum spanning tree (MST) of <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq24.gif"/></alternatives></inline-formula> to find the minimum total weight of the edge subsets connecting all nodes, and used the total weight as the distribution cost <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq25.gif"/></alternatives></inline-formula> for matching <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq26.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ12" ref-type="disp-formula">12</xref>). In matchings with placeholder nodes and far unconnected clusters, the number of edges in MST is lower than expected <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M-1$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq27.gif"/></alternatives></inline-formula>, resulting in undesired lower distribution cost and affecting matching priorities. Hence, we introduce the missing node cost and the connectivity cost to penalize the missing edges (Eq. <xref rid="Equ13" ref-type="disp-formula">13</xref>, <xref rid="Equ14" ref-type="disp-formula">14</xref>). In matchings with placeholder nodes, the edge number reduction equals the number of placeholder nodes. We calculate the missing node cost by multiplying the placeholder node number <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_p$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq28.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_p$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq29.gif"/></alternatives></inline-formula>. In far matchings, feature nodes are far apart and form multiple clusters, which results in missing edges between clusters. The missed number of edges is equal to the number of connected subgraphs in <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq30.gif"/></alternatives></inline-formula>. Similarly, we calculate the connectivity cost by multiplying the number of connected subgraphs <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_c$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq31.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_c$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq32.gif"/></alternatives></inline-formula>. Besides, we believe matchings with more feature nodes have greater matching priority. Appropriate incentives should be given to full matchings when competing for nodes with others. For connected full matchings, we introduce a bonus factor <italic>b</italic> and subtract it from the matching cost (Eq. <xref rid="Equ15" ref-type="disp-formula">15</xref>). All factors are optimized as built-in parameters and do not require user modification.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_\gamma= &amp; {} \sum _{j=1}^p C_{\gamma _j} \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{\gamma _j}= &amp; {} C_{distribution}+C_{connectivity}+C_{missing}-B_{full\_match} \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{distribution}= &amp; {} \sum _{e \in E(T)} W(e), T={\text {MST}}\left( G_{\gamma _i}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext>MST</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{connectivity}= &amp; {} w_c * N_c \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{missing}= &amp; {} w_p * N_p \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B_{full\_match}= &amp; {} b \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>However, the multidimensional assignment problem is a well-known NP-Hard problem at three or higher dimensions. There is no known algorithm for finding the optimal solution in polynomial time. To solve MAP efficiently, G-Aligner proposed three solvers: the Gurobi solver, the Greedy solver and the VLSNS solver.</p>
        <p id="Par39">The Gurobi solver converts the multidimensional assignment problem to an integer linear programming problem and uses the state-of-the-art commercial Gurobi optimizer to find the global optimal solution. By inputting matching costs, feasible solution rules and optimization objectives into the model, the Gurobi optimizer can efficiently calculate optimization results, much faster than other linear programming solvers such as the OR-Tools developed by Google. The pseudocode of the Gurobi solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1.</p>
        <p id="Par40">The Greedy solver pays more attention to the quality of a single matching than the solution. In each iteration, the Greedy solver finds the minimum cost matching, adds the matching to the solution, and sets the corresponding costs of matched features to infinite to avoid generating infeasible solutions. In this way, the Greedy solver does not sacrifice the best matchings for a lower cost of solutions. The pseudocode of the Greedy solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S2.</p>
        <p id="Par41">However, the Gurobi and Greedy solver must compute the matching costs for all permutations before running. For faster calculations, we propose the VLSNS solver to solve the unbalanced MAPs, which calculates costs as needed during optimization. The VLSNS solver used a recent metaheuristic approach, known as the very large-scale neighborhood search (VLSNS) [<xref ref-type="bibr" rid="CR21">21</xref>], which finds near-optimal solutions to the MAP by iteratively transforming the current solution into a better solution in the neighborhood. The VLSNS solver converts the multidimensional assignment problem to linear (two-dimensional) assignment problems (LAP) between each partite and the others. In each iteration, the VLSNS solver finds an optimal permutation for each partite and updates the solution permutation in the best-improved partite until no lower cost can be obtained. The pseudocode of the VLSNS solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S3.</p>
        <p id="Par42">Since the solution space is not fully searched, VLSNS is not guaranteed to obtain global optimal results and is prone to fall into local optimum. As compensation, multiple start solutions are provided to the solver for parallel optimization, and the optimized solution with the lowest cost is used as the final result. We provide two solution initialization methods: the MSR method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.1) and the MSG method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.2). The MSR (multi-solution random) method generates multiple solutions at random. The MSG (multi-solution grid) method generates random solutions first and then equidistantly rolls the permutation order in each partite into multiple grid solutions for each random solution. By adopting the multi-start strategy, the VLSNS solver ensures the computation accuracy and is able to obtain near global optimal results while having a faster calculation speed.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Big graph acceleration</title>
      <p id="Par43">In cases of dense feature distribution and insufficient accuracy of retention time alignment, some connected components may contain a large number of nodes. As the number of nodes increases, the computing time increases polynomially. For efficient analysis of big graphs, we proposed a graph segmentation method to divide big graphs into multiple small subgraphs, and a result merging method to combine solutions of small graphs to a final result. The graph splitting method iteratively divides the graph into two subgraphs by LC–MS run according to the preset node number limit. Nodes in runs with adjacent acquisition time are segmented into the same subgraphs, and the total number of nodes in the two subgraphs is similar. After splitting, G-Aligner performs the optimization methods described above to obtain optimal solutions for each subgraph. Then, G-Aligner assembles the solutions of multiple subgraphs with the result merging method. The result merging method first computes the minimum weight of the edges between each pair of matchings as their distance. Then, matchings are iteratively merged in ascending order of distance when they do not contain nodes from the same LC–MS run.</p>
      <p id="Par44">Besides, G-Aligner can be recursively executed to meet diverse alignment requirements. By default, G-Aligner scans the directory of the feature extraction result folder provided by the user and recursively aligns the results in each subfolder from bottom to top according to the folder structure. For example, in the scenario where each sample has multiple technical replicates, users can put all replicates of each sample in the same subfolder, so that G-Aligner will first align the technical replicates of each sample, and then align samples according to the mean feature m/z and retention time among replicates. Optionally, this recursive align method provides more sample relation information for the algorithm, facilitating better results and faster analysis in large cohort alignments.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Evaluation workflow</title>
      <p id="Par45">We compared G-Aligner with the feature alignment methods in three popular untargeted metabolomics software: MZmine2 (version 2.53), OpenMS (version 2.7.0), and XCMS (version 3.18.0), as representatives of local nearest matching of paired runs, multi-run centric matching and multi-run non-centric matching respectively, on the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset. Moreover, since we had problems running LWBmatch, we implemented a local bipartite solver for comparison, as a representative of bipartite pairwise matching methods. After selecting the LC–MS run with the most features as a reference run, the local bipartite solver matched other LC–MS runs iteratively in descending order of feature numbers to the reference run. The local bipartite solver treats feature matching as a weighted bipartite assignment problem and uses a modified Jonker-Volgenant algorithm [<xref ref-type="bibr" rid="CR22">22</xref>] to find the maximum cardinality matching with a minimum sum of matching distances.</p>
      <p id="Par46">In evaluations of G-Aligner and other methods, we first manually annotated features of library analytes for each dataset and conducted a comprehensive assessment of the feature alignment algorithms on the same manually annotated feature set to exclude differences in feature extraction. Then, we integrated G-Aligner into the workflow of each software to evaluate the improvement on their self-extracted features. In parameter settings, we first manually selected a set of reasonable parameters based on the distribution of the data, and then manually fine-tuned them to obtain the best parameters to achieve the highest detection rate and alignment performance of features corresponding to the compounds in the library. The fine-tuned parameters of compared software were summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2 and S3. Notably, the differences in feature extraction parameter settings may lead to different distributions on extracted features and result in different difficulties in feature alignment. However, the parameter settings for feature extraction are less important to the evaluation results, we only need to evaluate G-Aligner and other methods on the same set of feature extraction results under the same alignment difficulty.</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation on manually annotated features</title>
      <p id="Par47">To perform a comprehensive evaluation for feature alignment algorithms, all algorithms should be evaluated on the same set of features to control the variable in feature distribution. To create a feature dataset with standard alignment results for each dataset, we extracted and annotated features of library analytes with the MetaPro [<xref ref-type="bibr" rid="CR23">23</xref>] batch inspection tool. For each analyte in library, we extracted features close to the m/z and RT coordinates in each run, in which at most one feature was manually annotated as the corresponding feature. All of the extracted nearby features were added to the feature datasets. Each feature was represented by its apex m/z (the apex m/z of the spectral peak at apex RT), apex RT and integrated area. The annotation procedure was detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix S1.</p>
      <p id="Par48">We utilized the annotated results as references to evaluate the accuracy of feature alignment algorithms. When importing the manually annotated features into the comparison software, we directly accessed the source code of the compared software in Python, Java, and R environments, and assembled or re-extracted the features into supported memory objects, since all comparison software lacked external feature import capabilities or only supported specific feature formats. The m/z and retention time ranges of each feature used in re-extraction were kept the same as MetaPro extracted features, which ensured the consistency of evaluation datasets.</p>
      <p id="Par49">To benchmark the performance of the feature alignment, we compare the predicted matchings with the manual annotation results (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For each analyte, the predicted matching with the most common features with the annotated matching was considered its corresponding matching, while the contained features were considered its corresponding features. The corresponding feature of each analyte in each sample may differ between the predicted and annotated matchings. For each analyte, the alignment in a sample was considered true positive (TP) when the corresponding feature was present in both aligned and annotated results, false positive (FP) when the corresponding feature was only present in the aligned results, true negative (TN) when there was no corresponding feature in the aligned and annotated results, and false negative (FN) when the corresponding feature was only present in the annotated results. Then, we counted the feature alignment status of all compared methods and calculated the precision (P), recall (R), F1 score (F), feature accuracy (F_ACC), and analyte accuracy (A_ACC) accordingly on each dataset.<fig id="Fig3"><label>Fig. 3</label><caption><p>Definitions of evaluation metrics. In the example matching of 7 samples, numbers in matching vectors are the index numbers of matched features in the feature lists of corresponding samples</p></caption><graphic xlink:href="12859_2023_5525_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par50">In evaluation of the feature alignment accuracy, we compared G-Aligner with other methods on the manually annotated features of each dataset and summarized the results in Table <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref>. The combinatorial optimization methods in G-Aligner outperformed other comparison methods and achieved the best performance on all datasets with the most TP and FP and the least FP and FN, proving the necessity of multi-run analysis. Among the combinatorial optimization solvers, the Greedy solver obtained less accurate results than the Gurobi solver and VLSNS solver. The Greedy solver focused only on local optimal matchings and ignored corresponding suboptimal matches in the greedy search, which illustrates the importance of global optimization. The Gurobi solver and VLSNS solver were too slow and were skipped in evaluations of the MTBLS562 dataset. G-Aligner achieved the best result on all datasets, with F1 scores at 0.999, 0.998 and 1.000, feature accuracy at 0.999, 0.997 and 0.999, and analyte accuracy at 0.990, 0.989 and 0.981, respectively, in the TripleTOF 6600, QE HF and MTBLS562 dataset. Compared to the best-performed OpenMS method, G-Aligner achieved 1.1%, 1.9% and 0.6% higher feature accuracy and 5.3%, 8.7% and 14.0% higher analyte accuracy, respectively.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Evaluation results on manually annotated feature sets of the TripleTOF 6600dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7163</td><td align="left">77</td><td align="left">0</td><td align="left">152</td><td align="left">0.989</td><td align="left">0.979</td><td align="left">0.984</td><td align="left">0.969</td><td align="left">0.883</td></tr><tr><td align="left">OpenMS QT</td><td align="left">7303</td><td align="left">64</td><td align="left">0</td><td align="left">25</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left">0.988</td><td align="left">0.937</td></tr><tr><td align="left">XCMS Group</td><td align="left">6916</td><td align="left">228</td><td align="left">0</td><td align="left">248</td><td align="left">0.968</td><td align="left">0.965</td><td align="left">0.967</td><td align="left">0.936</td><td align="left">0.837</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6797</td><td align="left">253</td><td align="left">0</td><td align="left">342</td><td align="left">0.964</td><td align="left">0.952</td><td align="left">0.958</td><td align="left">0.920</td><td align="left">0.777</td></tr><tr><td align="left">Local bipartite</td><td align="left">7150</td><td align="left">75</td><td align="left">0</td><td align="left">167</td><td align="left">0.990</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7381</td><td align="left">4</td><td align="left">0</td><td align="left">7</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Evaluation results on manually annotated feature sets of the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7982</td><td align="left">103</td><td align="left">0</td><td align="left">265</td><td align="left">0.987</td><td align="left">0.968</td><td align="left">0.977</td><td align="left">0.956</td><td align="left">0.831</td></tr><tr><td align="left">OpenMS</td><td align="left">8167</td><td align="left">146</td><td align="left">0</td><td align="left">37</td><td align="left">0.982</td><td align="left">0.995</td><td align="left">0.989</td><td align="left">0.978</td><td align="left">0.902</td></tr><tr><td align="left">XCMS Group</td><td align="left">6812</td><td align="left">629</td><td align="left">0</td><td align="left">909</td><td align="left">0.915</td><td align="left">0.882</td><td align="left">0.899</td><td align="left">0.816</td><td align="left">0.715</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6749</td><td align="left">677</td><td align="left">0</td><td align="left">924</td><td align="left">0.909</td><td align="left">0.880</td><td align="left">0.894</td><td align="left">0.808</td><td align="left">0.667</td></tr><tr><td align="left">Local bipartite</td><td align="left">8019</td><td align="left">78</td><td align="left">0</td><td align="left">253</td><td align="left">0.990</td><td align="left">0.969</td><td align="left">0.980</td><td align="left">0.960</td><td align="left">0.884</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8320</td><td align="left">12</td><td align="left">0</td><td align="left">18</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left">0.996</td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Evaluation results on manually annotated feature sets of the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7822</td><td align="left">25</td><td align="left">0</td><td align="left">433</td><td align="left">0.997</td><td align="left">0.948</td><td align="left">0.972</td><td align="left">0.945</td><td align="left">0.744</td></tr><tr><td align="left">OpenMS</td><td align="left">8221</td><td align="left">34</td><td align="left">0</td><td align="left">25</td><td align="left">0.996</td><td align="left">0.997</td><td align="left">0.996</td><td align="left">0.993</td><td align="left">0.841</td></tr><tr><td align="left">XCMS Group</td><td align="left">6115</td><td align="left">847</td><td align="left">0</td><td align="left">1318</td><td align="left">0.878</td><td align="left">0.823</td><td align="left">0.850</td><td align="left">0.739</td><td align="left">0.145</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6230</td><td align="left">868</td><td align="left">0</td><td align="left">1182</td><td align="left">0.878</td><td align="left">0.841</td><td align="left">0.859</td><td align="left">0.752</td><td align="left">0.169</td></tr><tr><td align="left">Local bipartite</td><td align="left">8173</td><td align="left">1</td><td align="left">0</td><td align="left">106</td><td align="left">1.000</td><td align="left">0.987</td><td align="left">0.993</td><td align="left">0.987</td><td align="left">0.937</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8269</td><td align="left">3</td><td align="left">0</td><td align="left">8</td><td align="left">1.000</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left">0.976</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation on software self-extracted features</title>
      <p id="Par51">Since the distribution of all untargeted extracted features was more complicated than the manually annotated feature datasets, we further evaluated the performance of G-Aligner on full untargeted extracted features. Considering that there may be implicit correlations between the alignment methods and their analysis pipeline, we integrated G-Aligner into the workflow of each software and compared G-Aligner with their original alignment methods in the native environment. To obtain benchmarks for alignment, we used the manually annotated results to infer the correct alignment of untargeted extracted features for each software. Since the feature of each analyte corresponds to the same LC–MS signal in each file, the corresponding features extracted by different software should be extremely near. We matched the untargeted extracted features to the manually annotated features with m/z and retention time tolerances at (0.01Da, 0.1min) on the TripleTOF 6600 dataset, (0.005Da, 0.1min) on the QE HF dataset and (0.015Da, 0.1min) on the MTBLS562 dataset. If more than one feature was matched within the tolerances, the closest was selected as the inferred corresponding feature. The distance between features was the squared sum of m/z and retention time deviations normalized by the inverse of the tolerance. To benchmark the feature alignment performance on untargeted extracted features, we used the same evaluation metrics as on manually annotated features by matching alignment results to inferred annotation results. For each software, we compared G-Aligner with the native feature alignment methods on the alignment performance of all analytes on all datasets, including match status, precision, recall, F1 score, feature accuracy and analyte accuracy.</p>
      <p id="Par52">In evaluation results on untargeted extracted features of the three software (Tables <xref rid="Tab4" ref-type="table">4</xref>, <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref>), all evaluation methods achieved less accurate results than on the manually annotated features, which was mainly due to the increase in complexity in feature distributions. Different from manually annotated data, false detections and missing detections always happens in untargeted feature extraction, causing more interference to the alignment algorithms. In the evaluation of software self-extracted features, the combinatorial optimization methods in G-Aligner achieved obviously better performance than local pairwise and native methods of all software on all datasets. G-Aligner proved its robustness on untargted extracted features of the three software with different qualities; OpenMS had the most missing features, MZmine2 had fewer, and XCMS had the least. The Gurobi and VLSNS solver achieved the best performance in most feature sets, but was less accurate than the Greedy solver on the OpenMS features of the TripleTOF 6600 dataset. Although the Greedy solver only performs local optimization and always inferior to the Gurobi and VLSNS solver in most cases, the strategy of finding local optimum matching could be less disturbed for feature sets with insufficient quality. In most evaluations on the complex distributed untargted extracted features, the VLSNS solver with the MSG solution initialization method showed higher accuracy than with the MSR method, which indicated that the MSR method might generate less dispersed initial solutions compared due to excessive dependence on randomness, and it was more prone to lead the VLSNS solver into suboptimal solutions. G-Aligner achieved the best performance on untargeted extracted features on all datasets, with 1.7%, 9.0% and 0.5% higher feature accuracy, 5.8%, 26.6% and 7.7% higher analyte accuracy than MZmine2, 2.4%, 1.5% and 1.7% higher feature accuracy, 13.5%, 10.6% and 18.4% higher analyte accuracy than OpenMS, 9.8%, 2.6% and 9.4% higher feature accuracy, 24.5%, 11.4% and 24.7% higher analyte accuracy than XCMS, respectively on the TripleTOF 6600, QE HF and MTBLS562 dataset.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Evaluation results on software self-extracted features on the TripleTOF 6600 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6716</td><td align="left">129</td><td align="left">422</td><td align="left">125</td><td align="left">0.981</td><td align="left">0.982</td><td align="left">0.981</td><td align="left">0.966</td><td align="left">0.869</td></tr><tr><td align="left">Local bipartite</td><td align="left">6688</td><td align="left">122</td><td align="left">413</td><td align="left">169</td><td align="left">0.982</td><td align="left">0.975</td><td align="left">0.979</td><td align="left">0.961</td><td align="left">0.882</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">6847</td><td align="left">98</td><td align="left">403</td><td align="left">44</td><td align="left">0.986</td><td align="left">0.994</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.925</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">6859</td><td align="left">84</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left">0.982</td><td align="left">0.926</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6846</td><td align="left">89</td><td align="left">403</td><td align="left">54</td><td align="left">0.987</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.922</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6862</td><td align="left">81</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left"><bold>0.983</bold></td><td align="left"><bold>0.927</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">5771</td><td align="left">336</td><td align="left">1204</td><td align="left">81</td><td align="left">0.945</td><td align="left">0.986</td><td align="left">0.965</td><td align="left">0.944</td><td align="left">0.741</td></tr><tr><td align="left">Local bipartite</td><td align="left">5355</td><td align="left">338</td><td align="left">1248</td><td align="left">451</td><td align="left">0.941</td><td align="left">0.922</td><td align="left">0.931</td><td align="left">0.893</td><td align="left">0.697</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">5922</td><td align="left">140</td><td align="left">1230</td><td align="left">100</td><td align="left">0.977</td><td align="left">0.983</td><td align="left"><bold>0.980</bold></td><td align="left"><bold>0.968</bold></td><td align="left">0.874</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5906</td><td align="left">156</td><td align="left">1233</td><td align="left">97</td><td align="left">0.974</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left">0.873</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">6567</td><td align="left">251</td><td align="left">38</td><td align="left">536</td><td align="left">0.963</td><td align="left">0.925</td><td align="left">0.943</td><td align="left">0.894</td><td align="left">0.712</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6173</td><td align="left">293</td><td align="left">39</td><td align="left">887</td><td align="left">0.955</td><td align="left">0.874</td><td align="left">0.913</td><td align="left">0.840</td><td align="left">0.600</td></tr><tr><td align="left">Local bipartite</td><td align="left">6939</td><td align="left">152</td><td align="left">51</td><td align="left">250</td><td align="left">0.979</td><td align="left">0.965</td><td align="left">0.972</td><td align="left">0.946</td><td align="left">0.866</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7281</td><td align="left">52</td><td align="left">47</td><td align="left">12</td><td align="left">0.993</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.956</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7270</td><td align="left">51</td><td align="left">47</td><td align="left">24</td><td align="left">0.993</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.951</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Evaluation results on software self-extracted features on the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6995</td><td align="left">11</td><td align="left">566</td><td align="left">778</td><td align="left">0.998</td><td align="left">0.900</td><td align="left">0.947</td><td align="left">0.906</td><td align="left">0.721</td></tr><tr><td align="left">Local bipartite</td><td align="left">7705</td><td align="left">6</td><td align="left">563</td><td align="left">76</td><td align="left">0.999</td><td align="left">0.990</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.975</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7746</td><td align="left">5</td><td align="left">563</td><td align="left">36</td><td align="left">0.999</td><td align="left">0.995</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.986</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">7039</td><td align="left">20</td><td align="left">1166</td><td align="left">125</td><td align="left">0.997</td><td align="left">0.983</td><td align="left">0.990</td><td align="left">0.983</td><td align="left">0.887</td></tr><tr><td align="left">Local bipartite</td><td align="left">7092</td><td align="left">8</td><td align="left">1169</td><td align="left">81</td><td align="left">0.999</td><td align="left">0.989</td><td align="left">0.994</td><td align="left">0.989</td><td align="left">0.972</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">7934</td><td align="left">99</td><td align="left">134</td><td align="left">183</td><td align="left">0.988</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.966</td><td align="left">0.846</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">7940</td><td align="left">70</td><td align="left">135</td><td align="left">205</td><td align="left">0.991</td><td align="left">0.975</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.846</td></tr><tr><td align="left">Local bipartite</td><td align="left">8057</td><td align="left">36</td><td align="left">148</td><td align="left">109</td><td align="left">0.996</td><td align="left">0.987</td><td align="left">0.991</td><td align="left">0.983</td><td align="left">0.938</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8131</td><td align="left">20</td><td align="left">148</td><td align="left">51</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.957</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Evaluation results on software self-extracted features on the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">5751</td><td align="left">106</td><td align="left">2398</td><td align="left">25</td><td align="left">0.982</td><td align="left">0.996</td><td align="left">0.989</td><td align="left">0.984</td><td align="left">0.768</td></tr><tr><td align="left">Local bipartite</td><td align="left">5719</td><td align="left">58</td><td align="left">2448</td><td align="left">55</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.986</td><td align="left">0.845</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5744</td><td align="left">67</td><td align="left">2435</td><td align="left">34</td><td align="left">0.988</td><td align="left">0.994</td><td align="left">0.991</td><td align="left">0.988</td><td align="left"><bold>0.850</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5758</td><td align="left">66</td><td align="left">2434</td><td align="left">22</td><td align="left">0.989</td><td align="left">0.996</td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.989</bold></td><td align="left">0.845</td></tr><tr><td align="left">OpenMS QT</td><td align="left">3916</td><td align="left">139</td><td align="left">4182</td><td align="left">43</td><td align="left">0.966</td><td align="left">0.989</td><td align="left">0.977</td><td align="left">0.978</td><td align="left">0.715</td></tr><tr><td align="left">Local bipartite</td><td align="left">3933</td><td align="left">32</td><td align="left">4277</td><td align="left">38</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.991</td><td align="left">0.992</td><td align="left">0.894</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">3961</td><td align="left">34</td><td align="left">4275</td><td align="left">10</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">3966</td><td align="left">35</td><td align="left">4275</td><td align="left">4</td><td align="left">0.991</td><td align="left">0.999</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">5786</td><td align="left">386</td><td align="left">1671</td><td align="left">437</td><td align="left">0.937</td><td align="left">0.930</td><td align="left">0.934</td><td align="left">0.901</td><td align="left">0.676</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">5756</td><td align="left">437</td><td align="left">1671</td><td align="left">416</td><td align="left">0.929</td><td align="left">0.933</td><td align="left">0.931</td><td align="left">0.897</td><td align="left">0.652</td></tr><tr><td align="left">Local bipartite</td><td align="left">6425</td><td align="left">37</td><td align="left">1807</td><td align="left">11</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left"><bold>0.923</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6425</td><td align="left">38</td><td align="left">1807</td><td align="left">10</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6431</td><td align="left">37</td><td align="left">1807</td><td align="left">5</td><td align="left">0.994</td><td align="left">0.999</td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.923</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Analysis time</title>
      <p id="Par53">We measured the time costs of G-Aligner and all comparison software on a Windows 11 computer with an Intel(R)_Core(TM)_i9-12900KS CPU (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S4, S5). In evaluation of the manually annotated features, G-Aligner took 1.5 min, 3 min, 0.8 min, respectively on the TripleTOF 6600, QE HF, MTBLS562 dataset. In evaluation on software-extracted features, G-Aligner took 0.6 to 3 min per file on the TripleTOF 6600 dataset, 0.4 to 1 min per file on the QE HF dataset and 1 to 8 min per file on the MTBLS562 dataset. Due to the comprehensive analysis on all potential feature correspondences, combinatorial methods in G-Aligner spent more time than other compared methods. Among the solvers in G-Aligner, the VLSNS solver was up to 9.6 times faster than the Gurobi and Greedy solver and empowered G-Aligner to achieve more accurate feature alignment in acceptable time.</p>
    </sec>
    <sec id="Sec16">
      <title>Discussion</title>
      <p id="Par54">In comparison with popular feature alignment methods in OpenMS, MZmine2 and XCMS, all combinatorial optimization methods in G-Aligner showed significant improvement on the manually annotated and untargeted extracted features of all datasets. The solvers of G-Aligner had different optimization strategies. The Greedy solver is a local optimization method that finds minimum cost matchings iteratively, and the Gurobi and VLSNS solvers aim to find a global optimal solution that minimizes the sum of matching costs. The Gurobi solver and the VLSNS solver achieved equal or better feature alignment accuracy than the Greedy solver in most comparisons, proving the general superiority of global optimization. In global optimization methods, the Gurobi solver treated the MAPs as integer linear programming problems and guaranteed to find global optimal results, while the VLSNS solver was designed to find near-optimal results in less time. With the assistance of the MSG solution initialization method, the VLSNS solver achieved the same global optimal results as the Gurobi solver in all evaluations with less computation time. As a general feature alignment method, G-Aligner helped all evaluated software achieve more accurate feature alignment results and proved its generality and robustness.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par55">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner considered features of all runs as graph nodes and potential correspondences between features as edges. By treating the feature matching problem as multidimensional assignment problems on multipartite graphs, G-Aligner achieved non-centric analysis of all potential correspondences between features of all runs for the first time. Due to the comprehensive analysis of feature distribution, G-Aligner showed obvious advantages in feature matching accuracy. Compared to popular methods, G-Aligner achieved the highest feature alignment accuracy on all benchmark datasets with reasonable computational time.</p>
    <p id="Par56">The main limitation of G-Aligner is the lack of computing speed. To comprehensively consider all potential feature correspondences, G-Aligner modeled the feature matching problem to a multidimensional assignment problem, which was NP-Hard and inevitably requires a lot of computing time. Although we provided two acceleration methods to keep the running time within an acceptable range, there was still a gap between painless application. There are two ways to promote the comprehensive analysis of all potential feature correspondences. The first way is to introduce GPU acceleration to speed up the parallel calculations in G-Aligner. Another way is to go down to the basis principle of retention time drifting. Analyzing massive amount of potential correlations is inevitable in phenomena analysis. Instead, using the phenomena data to estimate the principle of drifting such as retention modeling may be a new efficient way for untargted feature alignment. Furthermore, G-Aligner will be integrated into MetaPro for feature alignment in the untargeted analysis module.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec160">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5525_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary information of this study; <bold>Algorithm S1</bold>, Pseudocode of the Gurobi solver; <bold>Algorithm S2</bold>, Pseudocode of the Greedy solver; <bold>Algorithm S3</bold>, Pseudocode of the VLSNS solver; <bold>Algorithm S4</bold>, Pseudocode of the solution initialization methods of the VLSNS solver; <bold>Figure S1</bold>, The RT drift distribution of library analytes on the TripleTOF 6600 dataset and the QE HF dataset; <bold>Table S1</bold>, Optimized parameters used in the TripleTOF 6600 dataset evaluation; <bold>Table S2</bold>, Optimized parameters used in the QE HF dataset evaluation; <bold>Table S3</bold>, Optimized parameters used in the MTBLS562 dataset evaluation; <bold>Table S4</bold>, Time cost on manually annotated feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Table S5</bold>, Time cost on software self-extracted feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Appendix S1</bold>. Data annotation procedure in MetaPro.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>LC–MS</term>
        <def>
          <p id="Par4">Liquid chromatography–mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>m/z</term>
        <def>
          <p id="Par5">Mass to charge</p>
        </def>
      </def-item>
      <def-item>
        <term>RT</term>
        <def>
          <p id="Par6">Retention rime</p>
        </def>
      </def-item>
      <def-item>
        <term>RANSAC</term>
        <def>
          <p id="Par7">RANdom SAmple Consensus</p>
        </def>
      </def-item>
      <def-item>
        <term>OBI-Warp</term>
        <def>
          <p id="Par8">Ordered bijective interpolated warping</p>
        </def>
      </def-item>
      <def-item>
        <term>DTW</term>
        <def>
          <p id="Par9">Dynamic time warping</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p id="Par10">Multidimensional assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par11">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>VLSNS</term>
        <def>
          <p id="Par12">Very large-scale neighborhood search</p>
        </def>
      </def-item>
      <def-item>
        <term>LAP</term>
        <def>
          <p id="Par13">Linear assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MSR</term>
        <def>
          <p id="Par14">Multi-solution randoms</p>
        </def>
      </def-item>
      <def-item>
        <term>MSG</term>
        <def>
          <p id="Par15">Multi-solution grid</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p id="Par16">True positive</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p id="Par17">False positive</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p id="Par18">True negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p id="Par19">False negative</p>
        </def>
      </def-item>
      <def-item>
        <term>P</term>
        <def>
          <p id="Par20">Precision score</p>
        </def>
      </def-item>
      <def-item>
        <term>R</term>
        <def>
          <p id="Par21">Recall score</p>
        </def>
      </def-item>
      <def-item>
        <term>F</term>
        <def>
          <p id="Par22">F1 score</p>
        </def>
      </def-item>
      <def-item>
        <term>F_ACC</term>
        <def>
          <p id="Par23">Feature accuracy</p>
        </def>
      </def-item>
      <def-item>
        <term>A_ACC</term>
        <def>
          <p id="Par24">Analyte accuracy</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the editors and anonymous reviewers for their valuable suggestions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RW and CY designed the study. RW designed and implemented G-Aligner, performed evaluations, and wrote the manuscript. RW, ML, SA and JW annotated the evaluation datasets. CY reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Natural Science Foundation of Shandong Province (2022HWYQ-081). Academic promotion project of Shandong First Medical University, and funding from Jinan City.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par59">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics—the link between genotypes and phenotypes</article-title>
        <source>Plant Mol Biol</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
        <?supplied-pmid 11860207?>
        <pub-id pub-id-type="pmid">11860207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Emerging applications of metabolomics in drug discovery and precision medicine</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>473</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2016.32</pub-id>
        <?supplied-pmid 26965202?>
        <pub-id pub-id-type="pmid">26965202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>LC–MS alignment in theory and practice: a comprehensive algorithmic review</article-title>
        <source>Brief Bioinform</source>
        <year>2013</year>
        <volume>16</volume>
        <fpage>104</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt080</pub-id>
        <?supplied-pmid 24273217?>
        <pub-id pub-id-type="pmid">24273217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomasi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>FVD</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Correlation optimized warping and dynamic time warping as preprocessing methods for chromatographic data</article-title>
        <source>J Chemom</source>
        <year>2004</year>
        <volume>18</volume>
        <fpage>231</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Liu Y, Chang C, Zhu Y. Advances of chromatogram retention time alignment algorithms in proteomics. 10.13345/j.cjb.210271</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakoe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chiba</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>
        <source>IEEE Trans Acoust Speech Signal Process</source>
        <year>1978</year>
        <volume>26</volume>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1109/TASSP.1978.1163055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PHC</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
        <?supplied-pmid 14719890?>
        <pub-id pub-id-type="pmid">14719890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wang Y, Miller DJ, Poskanzer K, Wang Y, Tian L, Yu G. Graphical time warping for joint alignment of multiple curves. Adv Neural Inf Process Syst. 2016;3655–3663.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Pluskal T, Castillo S, Villar-Briones A, Ore M. Mzmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data. BMC Bioinform. 2010. 10.1186/1471-2105-11-395</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischler</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bolles</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title>
        <source>Commun ACM</source>
        <year>1981</year>
        <volume>24</volume>
        <fpage>381</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1145/358669.358692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Graph-based peak alignment algorithms for multiple liquid chromatography-mass spectrometry datasets</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2469</fpage>
        <lpage>2476</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt435</pub-id>
        <?supplied-pmid 23904508?>
        <pub-id pub-id-type="pmid">23904508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Amon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A hybrid retention time alignment algorithm for SWATH-MS data</article-title>
        <source>Proteomics</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>2272</fpage>
        <lpage>2283</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201500511</pub-id>
        <?supplied-pmid 27302277?>
        <pub-id pub-id-type="pmid">27302277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rást</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aiche</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bielow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weisser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aicheler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Gutenbrunner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kenar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nilse</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pfeuffer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosenberger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rurik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Veit</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wojnar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wolski</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Malmstrém</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>OpenMS: a flexible open-source software platform for mass spectrometry data analysis</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>741</fpage>
        <lpage>748</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3959</pub-id>
        <pub-id pub-id-type="pmid">27575624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <?supplied-pmid 16448051?>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment of ESI-LC-MS proteomics data sets by ordered bijective interpolated warping</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>6140</fpage>
        <lpage>6152</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0605344</pub-id>
        <?supplied-pmid 16944896?>
        <pub-id pub-id-type="pmid">16944896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierskalla</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Letter to the editors-the multidimensional assignment problem</article-title>
        <source>Oper Res</source>
        <year>1968</year>
        <volume>16</volume>
        <fpage>422</fpage>
        <lpage>431</lpage>
        <pub-id pub-id-type="doi">10.1287/opre.16.2.422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shui</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of untargeted metabolomics data processing software in feature detection, quantification and discriminating marker selection</article-title>
        <source>Anal Chim Acta</source>
        <year>2018</year>
        <volume>1029</volume>
        <fpage>50</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2018.05.001</pub-id>
        <?supplied-pmid 29907290?>
        <pub-id pub-id-type="pmid">29907290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Carnitine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cholesteryl</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Absolute quantitative lipidomics reveals lipidome-wide alterations in aging brain</article-title>
        <source>Metabolomics</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1007/s11306-017-1304-x</pub-id>
        <?supplied-pmid 30830343?>
        <pub-id pub-id-type="pmid">30830343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>MacLean</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amodei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ruderman</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Egertson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoff</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tasman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shulman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Frewen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Brusniak</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Paulse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Flashner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moulding</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seymour</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Nuwaysir</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kuhlmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roark</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rainer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Detlev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hemenway</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huhmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langridge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Connolly</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chadick</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Eckels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Agus</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tabb</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>918</fpage>
        <lpage>920</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>
        <?supplied-pmid 23051804?>
        <pub-id pub-id-type="pmid">23051804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Aird: a computation-oriented mass spectrometry data format enables a higher compression ratio and less decoding time</article-title>
        <source>BMC Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04490-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kammerdiner</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Very large-scale neighborhood search for the multidimensional assignment problem</article-title>
        <source>Optim Methods Appl</source>
        <year>2017</year>
        <volume>130</volume>
        <fpage>251</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-68640-0_12</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crouse</surname>
            <given-names>DF</given-names>
          </name>
        </person-group>
        <article-title>On implementing 2D rectangular assignment algorithms</article-title>
        <source>IEEE Trans Aerosp Electron Syst</source>
        <year>2016</year>
        <volume>52</volume>
        <fpage>1679</fpage>
        <lpage>1696</lpage>
        <pub-id pub-id-type="doi">10.1109/TAES.2016.140952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">An S, Wang R, Lu M, Zhang C, Liu H, Wang J, Xie C, Yu C. Metapro: a web-based metabolomics application for LC–MS data batch inspection and library curation. Metabolomics 2023. 10.1007/s11306-023-02018-6</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10644574</article-id>
    <article-id pub-id-type="publisher-id">5525</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05525-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>G-Aligner: a graph-based feature alignment method for untargeted LC–MS-based metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ruimin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Miaoshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Shaowei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jinyin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Changbin</given-names>
        </name>
        <address>
          <email>yu_lab@sdfmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013q1eq08</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>Fudan University, </institution></institution-wrap>Shanghai, 200433 Shanghai China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Engineering, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05jb9pq57</institution-id><institution-id institution-id-type="GRID">grid.410587.f</institution-id><institution>Shandong First Medical University and Shandong Academy of Medical Sciences, </institution></institution-wrap>Jinan, 250021 Shandong China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 310058 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Life Sciences, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>431</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Liquid chromatography–mass spectrometry is widely used in untargeted metabolomics for composition profiling. In multi-run analysis scenarios, features of each run are aligned into consensus features by feature alignment algorithms to observe the intensity variations across runs. However, most of the existing feature alignment methods focus more on accurate retention time correction, while underestimating the importance of feature matching. None of the existing methods can comprehensively consider feature correspondences among all runs and achieve optimal matching.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To comprehensively analyze feature correspondences among runs, we propose G-Aligner, a graph-based feature alignment method for untargeted LC–MS data. In the feature matching stage, G-Aligner treats features and potential correspondences as nodes and edges in a multipartite graph, considers the multi-run feature matching problem an unbalanced multidimensional assignment problem, and provides three combinatorial optimization algorithms to find optimal matching solutions. In comparison with the feature alignment methods in OpenMS, MZmine2 and XCMS on three public metabolomics benchmark datasets, G-Aligner achieved the best feature alignment performance on all the three datasets with up to 9.8% and 26.6% increase in accurately aligned features and analytes, and helped all comparison software obtain more accurate results on their self-extracted features by integrating G-Aligner to their analysis workflow. G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license. Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner comprehensively considered potential feature correspondences between all runs, converting the feature matching problem as a multidimensional assignment problem (MAP). In evaluations on three public metabolomics benchmark datasets, G-Aligner achieved the highest alignment accuracy on manual annotated and popular software extracted features, proving the effectiveness and robustness of the algorithm.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05525-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>LC–MS</kwd>
      <kwd>Feature alignment</kwd>
      <kwd>Multidimensional assignment problem</kwd>
      <kwd>Combinatorial optimization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007129</institution-id>
            <institution>Natural Science Foundation of Shandong Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022HWYQ-081</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Academic promotion project of Shandong First Medical University</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Funding from Jinan City</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par25">Liquid chromatography–mass spectrometry (LC–MS) is widely used in the discovery of unknown compounds in untargeted metabolomics [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] In an analysis of multiple LC–MS runs, features of each run are first detected and quantified from raw data by feature extraction algorithms, and features of multiple related LC–MS runs are then combined into one consensus result map by feature alignment algorithms [<xref ref-type="bibr" rid="CR3">3</xref>]. The accuracy of feature alignment directly determines the rationality and credibility of subsequent statistical and biological analysis. However, features have nonlinear retention time (RT) drifts between runs due to unavoidable slight changes in chromatogram conditions [<xref ref-type="bibr" rid="CR4">4</xref>], such as column temperature, column aging and contamination, which greatly increases the difficulty of aligning consensus features.</p>
    <p id="Par26">To perform accurate feature alignment, researchers have proposed dozens of methods in the last decades [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The feature alignment methods can be divided into two categories according to the alignment steps, retention time alignment and feature matching. Retention time alignment methods, such as DTW [<xref ref-type="bibr" rid="CR6">6</xref>], PTW [<xref ref-type="bibr" rid="CR7">7</xref>] and GTW [<xref ref-type="bibr" rid="CR8">8</xref>], align retention times of multiple runs to a common space by fitting linear or nonlinear warping functions between runs to correct retention shifts and make features of the same analyte have closer elution time. Feature matching methods group features of different runs to consensus feature groups by distances in m/z and RT dimensions. Each consensus feature group represents the predicted corresponding features of the same analyte.</p>
    <p id="Par27">Most existing methods rely heavily on retention time alignment and only use naive nearest neighbor search in feature matching. The representative one is MZmine2 [<xref ref-type="bibr" rid="CR9">9</xref>]. After aligning retention time with RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>], MZmine2 selects a reference run and performs pairwise nearest matching to match features of other runs to the reference. However, retention time alignment methods can only describe the drifting trend between runs but cannot accurately correct the retention time of each feature. The retention time of analytes has different drift trends and offsets according to different physical and chemical properties, and elution order may swap when features of different analytes are sufficiently close. To perform more accurate feature matching, LWBmatch [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] considers feature matching between runs as an unbalanced weighted bipartite matching problem and solves the multi-run feature alignment problem by pairwise feature matching. To solve the feature matching problem more comprehensively, OpenMS [<xref ref-type="bibr" rid="CR13">13</xref>] and XCMS [<xref ref-type="bibr" rid="CR14">14</xref>] consider the multi-run feature matching problem a clustering problem. OpenMS finds a cluster of the nearest features for each feature among all runs and then chooses the tightest cluster iteratively to get the feature matching results. XCMS first separates features of all runs by m/z bins, then calculates the feature density curve in RT dimension for each bin, and groups the features according to the RT ranges of peaks in the density curve. However, the OpenMS method uses centralized nearest matching, which is prone to fall into local optimum, and the XCMS grouping is only based on dimensionality reduced RT distribution of features, which leads to lower accuracy and limited performance on feature matchings of close analytes.</p>
    <p id="Par28">To improve feature matching performance, in this paper, we propose G-Aligner (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), a graph-based feature alignment method for untargeted LC–MS-based metabolomics. G-Aligner is the first method enabling non-centric comprehensive analysis of all potential feature correspondences among multiple LC–MS runs. In the retention time alignment stage, G-Aligner uses the existing RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>] and OBI-Warp [<xref ref-type="bibr" rid="CR15">15</xref>] algorithms to perform stable coarse registration between runs. In the feature matching stage, G-Aligner formats the potential correspondences between all features as a multipartite graph, and solves the multi-run feature matching problem as an unbalanced multidimensional assignment problem [<xref ref-type="bibr" rid="CR16">16</xref>] with three combinatorial optimization methods. In comparison with feature alignment methods in OpenMS, MZmine2 and XCMS, G-Aligner showed significant improvements in feature alignment accuracy and helped all comparison software obtain more accurate results by integrating G-Aligner into their workflow.<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of G-Aligner. G-Aligner performs feature alignment in three main steps: feature list input, retention time alignment and feature matching. After loading features of multiple samples, G-Aligner first roughly aligns the retention time of features between samples. Then, in the feature matching step, G-Aligner builds multipartite graphs to represent potential matching relationship among features, and utilizes combinatorial optimization to obtain optimal matchings</p></caption><graphic xlink:href="12859_2023_5525_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Evaluation datasets</title>
      <p id="Par29">We used the two public metabolomics benchmark datasets in [<xref ref-type="bibr" rid="CR17">17</xref>], named as the TripleTOF 6600 dataset and the QE HF dataset. Both datasets were acquired with the full-scan method. The TripleTOF 6600 dataset was acquired by AB SCIEX TripleTOF 6600 interfaced with Shimazu L30A UPLC, and the QE HF dataset was acquired by Thermo Q Exactive HF with Dionex UltiMate 3000 HPLC. A pair of standard mixtures (SA, SB) were prepared for both datasets, which were composed of seven differential groups of drugs and metabolites (Gd1, Gd2, Gd3, Gm, Gd4, Gd5, Gd6) prepared at different relative concentration ratios of (1/16, 1/4, 1/2, 1/1, 2/1, 4/1, 16/1) in SB: SA. The TripleTOF 6600 dataset had four replicates for each mixture, with a total of eight runs. The QE HF dataset had five replicates for each mixture, with a total of ten runs. Benchmark libraries were provided along with the datasets, containing 970 and 836 analytes in the TripleTOF 6600 and the QE HF datasets. We further screened the benchmark libraries to remove duplicates and obtained 924 and 835 analytes, respectively. In both benchmark datasets, the retention times of mixed compounds have different drift trends due to large differences in physical and chemical properties (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Even after retention time alignment across runs, the retention times of analyte features still had wide shifts, which increased the difficulty of feature alignment and made the dataset more suitable for feature alignment evaluation.</p>
      <p id="Par30">Furthermore, to evaluate the performance of feature alignment methods on a bigger dataset, we used the dataset published in Metabolights MTBLS562 [<xref ref-type="bibr" rid="CR18">18</xref>]. The MTBLS562 dataset was acquired with DDA method and acquired by AB SCIEX TripleTOF 6600 with Agilent 1290 UHPLC system. The MTBLS562 dataset contains 40 LC–MS runs of 40 mice (C57BL/6J strain, SPF level) at 5 different ages (4, 12, 24, 32 to 52 weeks, n=8 in each group). Benchmark library was provided along with the dataset, containing 245 analytes. We further screened the benchmark library to remove duplicates and noises and obtained 207 analytes. Some analytes in the library have low abundance in samples with feature intensity heights on the order of hundreds.</p>
    </sec>
    <sec id="Sec4">
      <title>Input preparation</title>
      <p id="Par31">G-Aligner requires users to provide a list of extracted features for each LC–MS run. G-Aligner supports feature extraction results in csv and tsv formats, which can be exported from untargeted metabolomics software. As a general method, G-Aligner only requires users to provide basic feature information, including m/z, retention time and intensity. In case of using profile-based retention time alignment methods that require raw files (such as OBI-Warp), users need to convert raw files to mzML format by MSConvert [<xref ref-type="bibr" rid="CR19">19</xref>] or aird format by AirdPro [<xref ref-type="bibr" rid="CR20">20</xref>] for G-Aligner analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Retention time alignment</title>
      <p id="Par32">To correct retention time drift and reduce the difficulty of subsequent feature matching, G-Aligner provides a feature-based retention time alignment method RANSAC (RANdom SAmple Consensus) and a profile-based method OBI-Warp (Ordered Bijective Interpolated Warping). RANSAC is an iterative method for fitting a model to data and is robust to outliers. In each iteration, the RANSAC method selects a random subset of points from the input data and fits a linear or nonlinear model to these points. The remaining points are then classified into inliers or outliers based on their consistency with the model. Among the iterations, the best-fitting model with the largest number of inliers is selected as the alignment result. OBI-Warp is an extension of dynamic time warping (DTW) for nonlinear retention time warping. For pairs of runs that need to be aligned, OBI-Warp first uses DTW to analyze the spectral similarity and obtain the optimal bijective warping function by dynamic programming. OBI-Warp combines the warping function output from DTW with piecewise cubic Hermitian interpolation and produces smooth warped functions. G-Aligner implemented OBI-Warp in Python for the first time and separated it as an independent installation package for importing by other Python-based software. These two algorithms were also applied in MZmine2 and XCMS, respectively, and their effectiveness and stability have been proven in long-term use. G-Aligner uses linear RANSAC as the default retention time alignment algorithm because it does not require additional raw file import and is faster and more stable.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature matching</title>
      <sec id="Sec7">
        <title>Graph building</title>
        <p id="Par33">Instead of matching features iteratively to a real or virtual reference run, G-Aligner comprehensively considers potential feature correspondences between all LC–MS runs and performs combinatorial optimization to obtain optimal solutions. After retention time coarse registration, the corresponding features of each analyte in different runs are relatively close in m/z and retention time coordinates. To find potential correspondences among all runs, G-Aligner superimposes the retention time aligned features in all runs on the same coordinate system consisting of m/z and retention time dimensions, searches neighborhoods for each feature according to the m/z and retention time tolerances set by the user, and builds an undirected relation graph containing features of all runs. Each node in the graph represents a feature, and each edge represents a potential feature correspondence between neighbor features.</p>
      </sec>
      <sec id="Sec8">
        <title>Graph splitting</title>
        <p id="Par34">After graph building, spatially close feature nodes are connected into many connected components, which are maximal connected subgraphs of the relation graph. A connected component is the largest set of potentially corresponding features for each contained analyte and can be treated as the smallest computing unit for combinatorial optimization. G-Aligner splits the relation graph into connected components and performs combinatorial optimization on each connected component to divide and conquer the feature matching problem. The edge weights in each connected component are calculated by the weighted sum of normalized differences in m/z, retention time and intensity. The m/z and retention time differences are normalized by user-specified m/z and retention time tolerances, and the intensity difference is the deviation in intensity normalized by the largest feature intensity in the same connected component in each run. The edge weight is calculated as Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref> and Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} normed\ area= &amp; {} \frac{area}{maximum\ area\ in\ the\ partite} \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">area</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} edge\ weight= &amp; {} \frac{1}{3} \times \left( \frac{|\Delta m/z|}{m/z\ tolerance} + \frac{|\Delta RT|}{RT\ tolerance} + \left( 1-\frac{\min (normed\ area)}{\max (normed\ area)} \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec9">
        <title>Assignment solving</title>
        <p id="Par35">In graph theory, a multipartite graph is a type of graph in which the nodes can be divided into multiple independent sets. Each set of nodes is called a partite, and each edge connects a pair of nodes from different partites. After graph splitting, each connected component is a multipartite graph where edges do not connect feature nodes of the same run but different runs. To find the optimal correspondence solution, G-Aligner treats the feature matching problem on the multipartite subgraph as an unbalanced multidimensional assignment problem (MAP), in which the feature number differs in partites. MAP is a fundamental combinatorial optimization problem to find optimal matchings in a weighted multipartite graph, in which the sum of weights of the edges is minimum.</p>
        <p id="Par36">In G-Aligner, we comprehensively considered the neighborhood distribution of features in all runs and defined the unbalanced MAP of the feature matching as follows. For a multipartite graph <italic>G</italic> which contained feature nodes <italic>F</italic> from <italic>M</italic> runs (Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>), let <italic>F</italic>(<italic>k</italic>) represent the feature set of the <italic>k</italic>-th LC–MS run, and <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{ik}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq1.gif"/></alternatives></inline-formula> represent the <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_k$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq2.gif"/></alternatives></inline-formula>-th feature node in the <italic>k</italic>-th LC–MS run (Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref>). <italic>F</italic>(<italic>k</italic>) contains <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_k$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq3.gif"/></alternatives></inline-formula> deduplicated feature nodes <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{f^k_0,\dots ,f^k_{n_k-1}\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq4.gif"/></alternatives></inline-formula> and a placeholder node <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq5.gif"/></alternatives></inline-formula>. We define a linkage (M-partite matching) of features as <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq6.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ5" ref-type="disp-formula">5</xref>), which contains one feature node from each run. Each linkage represents a possible combination of related features of an analyte. When linkage <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq7.gif"/></alternatives></inline-formula> contains a placeholder node <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq8.gif"/></alternatives></inline-formula>, it means no feature from the <italic>k</italic>-th run was matched in the linkage. Accordingly, we recorded the empty linkage containing placeholder nodes of all runs as <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{n_1 \dots n_M}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq9.gif"/></alternatives></inline-formula>. The feasible solutions <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma$$\end{document}</tex-math><mml:math id="M24"><mml:mi>Γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq10.gif"/></alternatives></inline-formula> of MAP should satisfy the following constraints (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>, <xref rid="Equ7" ref-type="disp-formula">7</xref>, <xref rid="Equ8" ref-type="disp-formula">8</xref>, <xref rid="Equ9" ref-type="disp-formula">9</xref>). Equation <xref rid="Equ6" ref-type="disp-formula">6</xref> states that each solution <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M26"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq11.gif"/></alternatives></inline-formula> contains <italic>p</italic> matchings, where <italic>p</italic> is the max node number (containing placeholder node) in each feature set. Equation <xref rid="Equ7" ref-type="disp-formula">7</xref> states that each matching uniquely corresponds to a distinct linkage. Equation <xref rid="Equ8" ref-type="disp-formula">8</xref> states that different matchings in the same solution do not contain shared non-placeholder feature nodes. Equation <xref rid="Equ9" ref-type="disp-formula">9</xref> states that each feasible solution contains all feature nodes. A figure of feature nodes, linkages and matchings in a feasible solution is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F= &amp; {} \{F(1), \ldots , F(M)\} \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">{</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F(k)= &amp; {} \left\{ f_{i_k}^k \mid i_k=0, \ldots , n_k\right\} , \text{ for } k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>∣</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_{i_1 \ldots i_M}= &amp; {} \left\{ f_{i_1}^1, \ldots , f_{i_M}^M\right\} , \text{ for } i_k=0, \ldots , n_k, k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>M</mml:mi></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \gamma= &amp; {} \left\{ \gamma _1, \ldots , \gamma _p\right\} , p=\max \left( n_1, \ldots , n_M\right) +1 \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall \gamma _j: \gamma _j= &amp; {} L_{i_1 \ldots i_M} \exists ! {\text {tuple}}\left( i_1, \ldots , i_M\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∃</mml:mo><mml:mo>!</mml:mo><mml:mtext>tuple</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} \gamma _i \cap \gamma _j \subset L_{n_1 \ldots n_M}, \text{ for } i \ne j \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} F=U_{j=1}^p \gamma _j \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption><p>Visual representation of feature nodes, linkages and matchings in a feasible solution</p></caption><graphic xlink:href="12859_2023_5525_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par37">In order to measure the quality of solutions, we calculated the cost of each solution and selected the one with the lowest cost as the optimal solution. Let <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\gamma$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq12.gif"/></alternatives></inline-formula> represents the cost of solution <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M44"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq13.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq14.gif"/></alternatives></inline-formula> represents the cost of matching <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq15.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ10" ref-type="disp-formula">10</xref>). The cost of a solution is the total cost of all matchings contained. <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq16.gif"/></alternatives></inline-formula> consists of distribution cost <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq17.gif"/></alternatives></inline-formula>, connectivity cost <inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{connectivity}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq18.gif"/></alternatives></inline-formula>, missing node cost <inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{missing}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq19.gif"/></alternatives></inline-formula> and full match bonus <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{full\_match}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq20.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ11" ref-type="disp-formula">11</xref>).</p>
        <p id="Par38">The distribution cost in a matching describes the dispersion of matched nodes. For matching <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq21.gif"/></alternatives></inline-formula>, we first extract the subgraph <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq22.gif"/></alternatives></inline-formula> from the multipartite graph <italic>G</italic>, which contains all feature nodes and interconnected edges in <inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq23.gif"/></alternatives></inline-formula>. Then, we calculated the minimum spanning tree (MST) of <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq24.gif"/></alternatives></inline-formula> to find the minimum total weight of the edge subsets connecting all nodes, and used the total weight as the distribution cost <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq25.gif"/></alternatives></inline-formula> for matching <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq26.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ12" ref-type="disp-formula">12</xref>). In matchings with placeholder nodes and far unconnected clusters, the number of edges in MST is lower than expected <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M-1$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq27.gif"/></alternatives></inline-formula>, resulting in undesired lower distribution cost and affecting matching priorities. Hence, we introduce the missing node cost and the connectivity cost to penalize the missing edges (Eq. <xref rid="Equ13" ref-type="disp-formula">13</xref>, <xref rid="Equ14" ref-type="disp-formula">14</xref>). In matchings with placeholder nodes, the edge number reduction equals the number of placeholder nodes. We calculate the missing node cost by multiplying the placeholder node number <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_p$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq28.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_p$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq29.gif"/></alternatives></inline-formula>. In far matchings, feature nodes are far apart and form multiple clusters, which results in missing edges between clusters. The missed number of edges is equal to the number of connected subgraphs in <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq30.gif"/></alternatives></inline-formula>. Similarly, we calculate the connectivity cost by multiplying the number of connected subgraphs <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_c$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq31.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_c$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq32.gif"/></alternatives></inline-formula>. Besides, we believe matchings with more feature nodes have greater matching priority. Appropriate incentives should be given to full matchings when competing for nodes with others. For connected full matchings, we introduce a bonus factor <italic>b</italic> and subtract it from the matching cost (Eq. <xref rid="Equ15" ref-type="disp-formula">15</xref>). All factors are optimized as built-in parameters and do not require user modification.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_\gamma= &amp; {} \sum _{j=1}^p C_{\gamma _j} \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{\gamma _j}= &amp; {} C_{distribution}+C_{connectivity}+C_{missing}-B_{full\_match} \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{distribution}= &amp; {} \sum _{e \in E(T)} W(e), T={\text {MST}}\left( G_{\gamma _i}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext>MST</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{connectivity}= &amp; {} w_c * N_c \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{missing}= &amp; {} w_p * N_p \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B_{full\_match}= &amp; {} b \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>However, the multidimensional assignment problem is a well-known NP-Hard problem at three or higher dimensions. There is no known algorithm for finding the optimal solution in polynomial time. To solve MAP efficiently, G-Aligner proposed three solvers: the Gurobi solver, the Greedy solver and the VLSNS solver.</p>
        <p id="Par39">The Gurobi solver converts the multidimensional assignment problem to an integer linear programming problem and uses the state-of-the-art commercial Gurobi optimizer to find the global optimal solution. By inputting matching costs, feasible solution rules and optimization objectives into the model, the Gurobi optimizer can efficiently calculate optimization results, much faster than other linear programming solvers such as the OR-Tools developed by Google. The pseudocode of the Gurobi solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1.</p>
        <p id="Par40">The Greedy solver pays more attention to the quality of a single matching than the solution. In each iteration, the Greedy solver finds the minimum cost matching, adds the matching to the solution, and sets the corresponding costs of matched features to infinite to avoid generating infeasible solutions. In this way, the Greedy solver does not sacrifice the best matchings for a lower cost of solutions. The pseudocode of the Greedy solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S2.</p>
        <p id="Par41">However, the Gurobi and Greedy solver must compute the matching costs for all permutations before running. For faster calculations, we propose the VLSNS solver to solve the unbalanced MAPs, which calculates costs as needed during optimization. The VLSNS solver used a recent metaheuristic approach, known as the very large-scale neighborhood search (VLSNS) [<xref ref-type="bibr" rid="CR21">21</xref>], which finds near-optimal solutions to the MAP by iteratively transforming the current solution into a better solution in the neighborhood. The VLSNS solver converts the multidimensional assignment problem to linear (two-dimensional) assignment problems (LAP) between each partite and the others. In each iteration, the VLSNS solver finds an optimal permutation for each partite and updates the solution permutation in the best-improved partite until no lower cost can be obtained. The pseudocode of the VLSNS solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S3.</p>
        <p id="Par42">Since the solution space is not fully searched, VLSNS is not guaranteed to obtain global optimal results and is prone to fall into local optimum. As compensation, multiple start solutions are provided to the solver for parallel optimization, and the optimized solution with the lowest cost is used as the final result. We provide two solution initialization methods: the MSR method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.1) and the MSG method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.2). The MSR (multi-solution random) method generates multiple solutions at random. The MSG (multi-solution grid) method generates random solutions first and then equidistantly rolls the permutation order in each partite into multiple grid solutions for each random solution. By adopting the multi-start strategy, the VLSNS solver ensures the computation accuracy and is able to obtain near global optimal results while having a faster calculation speed.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Big graph acceleration</title>
      <p id="Par43">In cases of dense feature distribution and insufficient accuracy of retention time alignment, some connected components may contain a large number of nodes. As the number of nodes increases, the computing time increases polynomially. For efficient analysis of big graphs, we proposed a graph segmentation method to divide big graphs into multiple small subgraphs, and a result merging method to combine solutions of small graphs to a final result. The graph splitting method iteratively divides the graph into two subgraphs by LC–MS run according to the preset node number limit. Nodes in runs with adjacent acquisition time are segmented into the same subgraphs, and the total number of nodes in the two subgraphs is similar. After splitting, G-Aligner performs the optimization methods described above to obtain optimal solutions for each subgraph. Then, G-Aligner assembles the solutions of multiple subgraphs with the result merging method. The result merging method first computes the minimum weight of the edges between each pair of matchings as their distance. Then, matchings are iteratively merged in ascending order of distance when they do not contain nodes from the same LC–MS run.</p>
      <p id="Par44">Besides, G-Aligner can be recursively executed to meet diverse alignment requirements. By default, G-Aligner scans the directory of the feature extraction result folder provided by the user and recursively aligns the results in each subfolder from bottom to top according to the folder structure. For example, in the scenario where each sample has multiple technical replicates, users can put all replicates of each sample in the same subfolder, so that G-Aligner will first align the technical replicates of each sample, and then align samples according to the mean feature m/z and retention time among replicates. Optionally, this recursive align method provides more sample relation information for the algorithm, facilitating better results and faster analysis in large cohort alignments.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Evaluation workflow</title>
      <p id="Par45">We compared G-Aligner with the feature alignment methods in three popular untargeted metabolomics software: MZmine2 (version 2.53), OpenMS (version 2.7.0), and XCMS (version 3.18.0), as representatives of local nearest matching of paired runs, multi-run centric matching and multi-run non-centric matching respectively, on the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset. Moreover, since we had problems running LWBmatch, we implemented a local bipartite solver for comparison, as a representative of bipartite pairwise matching methods. After selecting the LC–MS run with the most features as a reference run, the local bipartite solver matched other LC–MS runs iteratively in descending order of feature numbers to the reference run. The local bipartite solver treats feature matching as a weighted bipartite assignment problem and uses a modified Jonker-Volgenant algorithm [<xref ref-type="bibr" rid="CR22">22</xref>] to find the maximum cardinality matching with a minimum sum of matching distances.</p>
      <p id="Par46">In evaluations of G-Aligner and other methods, we first manually annotated features of library analytes for each dataset and conducted a comprehensive assessment of the feature alignment algorithms on the same manually annotated feature set to exclude differences in feature extraction. Then, we integrated G-Aligner into the workflow of each software to evaluate the improvement on their self-extracted features. In parameter settings, we first manually selected a set of reasonable parameters based on the distribution of the data, and then manually fine-tuned them to obtain the best parameters to achieve the highest detection rate and alignment performance of features corresponding to the compounds in the library. The fine-tuned parameters of compared software were summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2 and S3. Notably, the differences in feature extraction parameter settings may lead to different distributions on extracted features and result in different difficulties in feature alignment. However, the parameter settings for feature extraction are less important to the evaluation results, we only need to evaluate G-Aligner and other methods on the same set of feature extraction results under the same alignment difficulty.</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation on manually annotated features</title>
      <p id="Par47">To perform a comprehensive evaluation for feature alignment algorithms, all algorithms should be evaluated on the same set of features to control the variable in feature distribution. To create a feature dataset with standard alignment results for each dataset, we extracted and annotated features of library analytes with the MetaPro [<xref ref-type="bibr" rid="CR23">23</xref>] batch inspection tool. For each analyte in library, we extracted features close to the m/z and RT coordinates in each run, in which at most one feature was manually annotated as the corresponding feature. All of the extracted nearby features were added to the feature datasets. Each feature was represented by its apex m/z (the apex m/z of the spectral peak at apex RT), apex RT and integrated area. The annotation procedure was detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix S1.</p>
      <p id="Par48">We utilized the annotated results as references to evaluate the accuracy of feature alignment algorithms. When importing the manually annotated features into the comparison software, we directly accessed the source code of the compared software in Python, Java, and R environments, and assembled or re-extracted the features into supported memory objects, since all comparison software lacked external feature import capabilities or only supported specific feature formats. The m/z and retention time ranges of each feature used in re-extraction were kept the same as MetaPro extracted features, which ensured the consistency of evaluation datasets.</p>
      <p id="Par49">To benchmark the performance of the feature alignment, we compare the predicted matchings with the manual annotation results (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For each analyte, the predicted matching with the most common features with the annotated matching was considered its corresponding matching, while the contained features were considered its corresponding features. The corresponding feature of each analyte in each sample may differ between the predicted and annotated matchings. For each analyte, the alignment in a sample was considered true positive (TP) when the corresponding feature was present in both aligned and annotated results, false positive (FP) when the corresponding feature was only present in the aligned results, true negative (TN) when there was no corresponding feature in the aligned and annotated results, and false negative (FN) when the corresponding feature was only present in the annotated results. Then, we counted the feature alignment status of all compared methods and calculated the precision (P), recall (R), F1 score (F), feature accuracy (F_ACC), and analyte accuracy (A_ACC) accordingly on each dataset.<fig id="Fig3"><label>Fig. 3</label><caption><p>Definitions of evaluation metrics. In the example matching of 7 samples, numbers in matching vectors are the index numbers of matched features in the feature lists of corresponding samples</p></caption><graphic xlink:href="12859_2023_5525_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par50">In evaluation of the feature alignment accuracy, we compared G-Aligner with other methods on the manually annotated features of each dataset and summarized the results in Table <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref>. The combinatorial optimization methods in G-Aligner outperformed other comparison methods and achieved the best performance on all datasets with the most TP and FP and the least FP and FN, proving the necessity of multi-run analysis. Among the combinatorial optimization solvers, the Greedy solver obtained less accurate results than the Gurobi solver and VLSNS solver. The Greedy solver focused only on local optimal matchings and ignored corresponding suboptimal matches in the greedy search, which illustrates the importance of global optimization. The Gurobi solver and VLSNS solver were too slow and were skipped in evaluations of the MTBLS562 dataset. G-Aligner achieved the best result on all datasets, with F1 scores at 0.999, 0.998 and 1.000, feature accuracy at 0.999, 0.997 and 0.999, and analyte accuracy at 0.990, 0.989 and 0.981, respectively, in the TripleTOF 6600, QE HF and MTBLS562 dataset. Compared to the best-performed OpenMS method, G-Aligner achieved 1.1%, 1.9% and 0.6% higher feature accuracy and 5.3%, 8.7% and 14.0% higher analyte accuracy, respectively.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Evaluation results on manually annotated feature sets of the TripleTOF 6600dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7163</td><td align="left">77</td><td align="left">0</td><td align="left">152</td><td align="left">0.989</td><td align="left">0.979</td><td align="left">0.984</td><td align="left">0.969</td><td align="left">0.883</td></tr><tr><td align="left">OpenMS QT</td><td align="left">7303</td><td align="left">64</td><td align="left">0</td><td align="left">25</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left">0.988</td><td align="left">0.937</td></tr><tr><td align="left">XCMS Group</td><td align="left">6916</td><td align="left">228</td><td align="left">0</td><td align="left">248</td><td align="left">0.968</td><td align="left">0.965</td><td align="left">0.967</td><td align="left">0.936</td><td align="left">0.837</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6797</td><td align="left">253</td><td align="left">0</td><td align="left">342</td><td align="left">0.964</td><td align="left">0.952</td><td align="left">0.958</td><td align="left">0.920</td><td align="left">0.777</td></tr><tr><td align="left">Local bipartite</td><td align="left">7150</td><td align="left">75</td><td align="left">0</td><td align="left">167</td><td align="left">0.990</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7381</td><td align="left">4</td><td align="left">0</td><td align="left">7</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Evaluation results on manually annotated feature sets of the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7982</td><td align="left">103</td><td align="left">0</td><td align="left">265</td><td align="left">0.987</td><td align="left">0.968</td><td align="left">0.977</td><td align="left">0.956</td><td align="left">0.831</td></tr><tr><td align="left">OpenMS</td><td align="left">8167</td><td align="left">146</td><td align="left">0</td><td align="left">37</td><td align="left">0.982</td><td align="left">0.995</td><td align="left">0.989</td><td align="left">0.978</td><td align="left">0.902</td></tr><tr><td align="left">XCMS Group</td><td align="left">6812</td><td align="left">629</td><td align="left">0</td><td align="left">909</td><td align="left">0.915</td><td align="left">0.882</td><td align="left">0.899</td><td align="left">0.816</td><td align="left">0.715</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6749</td><td align="left">677</td><td align="left">0</td><td align="left">924</td><td align="left">0.909</td><td align="left">0.880</td><td align="left">0.894</td><td align="left">0.808</td><td align="left">0.667</td></tr><tr><td align="left">Local bipartite</td><td align="left">8019</td><td align="left">78</td><td align="left">0</td><td align="left">253</td><td align="left">0.990</td><td align="left">0.969</td><td align="left">0.980</td><td align="left">0.960</td><td align="left">0.884</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8320</td><td align="left">12</td><td align="left">0</td><td align="left">18</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left">0.996</td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Evaluation results on manually annotated feature sets of the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7822</td><td align="left">25</td><td align="left">0</td><td align="left">433</td><td align="left">0.997</td><td align="left">0.948</td><td align="left">0.972</td><td align="left">0.945</td><td align="left">0.744</td></tr><tr><td align="left">OpenMS</td><td align="left">8221</td><td align="left">34</td><td align="left">0</td><td align="left">25</td><td align="left">0.996</td><td align="left">0.997</td><td align="left">0.996</td><td align="left">0.993</td><td align="left">0.841</td></tr><tr><td align="left">XCMS Group</td><td align="left">6115</td><td align="left">847</td><td align="left">0</td><td align="left">1318</td><td align="left">0.878</td><td align="left">0.823</td><td align="left">0.850</td><td align="left">0.739</td><td align="left">0.145</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6230</td><td align="left">868</td><td align="left">0</td><td align="left">1182</td><td align="left">0.878</td><td align="left">0.841</td><td align="left">0.859</td><td align="left">0.752</td><td align="left">0.169</td></tr><tr><td align="left">Local bipartite</td><td align="left">8173</td><td align="left">1</td><td align="left">0</td><td align="left">106</td><td align="left">1.000</td><td align="left">0.987</td><td align="left">0.993</td><td align="left">0.987</td><td align="left">0.937</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8269</td><td align="left">3</td><td align="left">0</td><td align="left">8</td><td align="left">1.000</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left">0.976</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation on software self-extracted features</title>
      <p id="Par51">Since the distribution of all untargeted extracted features was more complicated than the manually annotated feature datasets, we further evaluated the performance of G-Aligner on full untargeted extracted features. Considering that there may be implicit correlations between the alignment methods and their analysis pipeline, we integrated G-Aligner into the workflow of each software and compared G-Aligner with their original alignment methods in the native environment. To obtain benchmarks for alignment, we used the manually annotated results to infer the correct alignment of untargeted extracted features for each software. Since the feature of each analyte corresponds to the same LC–MS signal in each file, the corresponding features extracted by different software should be extremely near. We matched the untargeted extracted features to the manually annotated features with m/z and retention time tolerances at (0.01Da, 0.1min) on the TripleTOF 6600 dataset, (0.005Da, 0.1min) on the QE HF dataset and (0.015Da, 0.1min) on the MTBLS562 dataset. If more than one feature was matched within the tolerances, the closest was selected as the inferred corresponding feature. The distance between features was the squared sum of m/z and retention time deviations normalized by the inverse of the tolerance. To benchmark the feature alignment performance on untargeted extracted features, we used the same evaluation metrics as on manually annotated features by matching alignment results to inferred annotation results. For each software, we compared G-Aligner with the native feature alignment methods on the alignment performance of all analytes on all datasets, including match status, precision, recall, F1 score, feature accuracy and analyte accuracy.</p>
      <p id="Par52">In evaluation results on untargeted extracted features of the three software (Tables <xref rid="Tab4" ref-type="table">4</xref>, <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref>), all evaluation methods achieved less accurate results than on the manually annotated features, which was mainly due to the increase in complexity in feature distributions. Different from manually annotated data, false detections and missing detections always happens in untargeted feature extraction, causing more interference to the alignment algorithms. In the evaluation of software self-extracted features, the combinatorial optimization methods in G-Aligner achieved obviously better performance than local pairwise and native methods of all software on all datasets. G-Aligner proved its robustness on untargted extracted features of the three software with different qualities; OpenMS had the most missing features, MZmine2 had fewer, and XCMS had the least. The Gurobi and VLSNS solver achieved the best performance in most feature sets, but was less accurate than the Greedy solver on the OpenMS features of the TripleTOF 6600 dataset. Although the Greedy solver only performs local optimization and always inferior to the Gurobi and VLSNS solver in most cases, the strategy of finding local optimum matching could be less disturbed for feature sets with insufficient quality. In most evaluations on the complex distributed untargted extracted features, the VLSNS solver with the MSG solution initialization method showed higher accuracy than with the MSR method, which indicated that the MSR method might generate less dispersed initial solutions compared due to excessive dependence on randomness, and it was more prone to lead the VLSNS solver into suboptimal solutions. G-Aligner achieved the best performance on untargeted extracted features on all datasets, with 1.7%, 9.0% and 0.5% higher feature accuracy, 5.8%, 26.6% and 7.7% higher analyte accuracy than MZmine2, 2.4%, 1.5% and 1.7% higher feature accuracy, 13.5%, 10.6% and 18.4% higher analyte accuracy than OpenMS, 9.8%, 2.6% and 9.4% higher feature accuracy, 24.5%, 11.4% and 24.7% higher analyte accuracy than XCMS, respectively on the TripleTOF 6600, QE HF and MTBLS562 dataset.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Evaluation results on software self-extracted features on the TripleTOF 6600 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6716</td><td align="left">129</td><td align="left">422</td><td align="left">125</td><td align="left">0.981</td><td align="left">0.982</td><td align="left">0.981</td><td align="left">0.966</td><td align="left">0.869</td></tr><tr><td align="left">Local bipartite</td><td align="left">6688</td><td align="left">122</td><td align="left">413</td><td align="left">169</td><td align="left">0.982</td><td align="left">0.975</td><td align="left">0.979</td><td align="left">0.961</td><td align="left">0.882</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">6847</td><td align="left">98</td><td align="left">403</td><td align="left">44</td><td align="left">0.986</td><td align="left">0.994</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.925</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">6859</td><td align="left">84</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left">0.982</td><td align="left">0.926</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6846</td><td align="left">89</td><td align="left">403</td><td align="left">54</td><td align="left">0.987</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.922</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6862</td><td align="left">81</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left"><bold>0.983</bold></td><td align="left"><bold>0.927</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">5771</td><td align="left">336</td><td align="left">1204</td><td align="left">81</td><td align="left">0.945</td><td align="left">0.986</td><td align="left">0.965</td><td align="left">0.944</td><td align="left">0.741</td></tr><tr><td align="left">Local bipartite</td><td align="left">5355</td><td align="left">338</td><td align="left">1248</td><td align="left">451</td><td align="left">0.941</td><td align="left">0.922</td><td align="left">0.931</td><td align="left">0.893</td><td align="left">0.697</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">5922</td><td align="left">140</td><td align="left">1230</td><td align="left">100</td><td align="left">0.977</td><td align="left">0.983</td><td align="left"><bold>0.980</bold></td><td align="left"><bold>0.968</bold></td><td align="left">0.874</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5906</td><td align="left">156</td><td align="left">1233</td><td align="left">97</td><td align="left">0.974</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left">0.873</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">6567</td><td align="left">251</td><td align="left">38</td><td align="left">536</td><td align="left">0.963</td><td align="left">0.925</td><td align="left">0.943</td><td align="left">0.894</td><td align="left">0.712</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6173</td><td align="left">293</td><td align="left">39</td><td align="left">887</td><td align="left">0.955</td><td align="left">0.874</td><td align="left">0.913</td><td align="left">0.840</td><td align="left">0.600</td></tr><tr><td align="left">Local bipartite</td><td align="left">6939</td><td align="left">152</td><td align="left">51</td><td align="left">250</td><td align="left">0.979</td><td align="left">0.965</td><td align="left">0.972</td><td align="left">0.946</td><td align="left">0.866</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7281</td><td align="left">52</td><td align="left">47</td><td align="left">12</td><td align="left">0.993</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.956</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7270</td><td align="left">51</td><td align="left">47</td><td align="left">24</td><td align="left">0.993</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.951</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Evaluation results on software self-extracted features on the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6995</td><td align="left">11</td><td align="left">566</td><td align="left">778</td><td align="left">0.998</td><td align="left">0.900</td><td align="left">0.947</td><td align="left">0.906</td><td align="left">0.721</td></tr><tr><td align="left">Local bipartite</td><td align="left">7705</td><td align="left">6</td><td align="left">563</td><td align="left">76</td><td align="left">0.999</td><td align="left">0.990</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.975</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7746</td><td align="left">5</td><td align="left">563</td><td align="left">36</td><td align="left">0.999</td><td align="left">0.995</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.986</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">7039</td><td align="left">20</td><td align="left">1166</td><td align="left">125</td><td align="left">0.997</td><td align="left">0.983</td><td align="left">0.990</td><td align="left">0.983</td><td align="left">0.887</td></tr><tr><td align="left">Local bipartite</td><td align="left">7092</td><td align="left">8</td><td align="left">1169</td><td align="left">81</td><td align="left">0.999</td><td align="left">0.989</td><td align="left">0.994</td><td align="left">0.989</td><td align="left">0.972</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">7934</td><td align="left">99</td><td align="left">134</td><td align="left">183</td><td align="left">0.988</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.966</td><td align="left">0.846</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">7940</td><td align="left">70</td><td align="left">135</td><td align="left">205</td><td align="left">0.991</td><td align="left">0.975</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.846</td></tr><tr><td align="left">Local bipartite</td><td align="left">8057</td><td align="left">36</td><td align="left">148</td><td align="left">109</td><td align="left">0.996</td><td align="left">0.987</td><td align="left">0.991</td><td align="left">0.983</td><td align="left">0.938</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8131</td><td align="left">20</td><td align="left">148</td><td align="left">51</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.957</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Evaluation results on software self-extracted features on the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">5751</td><td align="left">106</td><td align="left">2398</td><td align="left">25</td><td align="left">0.982</td><td align="left">0.996</td><td align="left">0.989</td><td align="left">0.984</td><td align="left">0.768</td></tr><tr><td align="left">Local bipartite</td><td align="left">5719</td><td align="left">58</td><td align="left">2448</td><td align="left">55</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.986</td><td align="left">0.845</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5744</td><td align="left">67</td><td align="left">2435</td><td align="left">34</td><td align="left">0.988</td><td align="left">0.994</td><td align="left">0.991</td><td align="left">0.988</td><td align="left"><bold>0.850</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5758</td><td align="left">66</td><td align="left">2434</td><td align="left">22</td><td align="left">0.989</td><td align="left">0.996</td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.989</bold></td><td align="left">0.845</td></tr><tr><td align="left">OpenMS QT</td><td align="left">3916</td><td align="left">139</td><td align="left">4182</td><td align="left">43</td><td align="left">0.966</td><td align="left">0.989</td><td align="left">0.977</td><td align="left">0.978</td><td align="left">0.715</td></tr><tr><td align="left">Local bipartite</td><td align="left">3933</td><td align="left">32</td><td align="left">4277</td><td align="left">38</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.991</td><td align="left">0.992</td><td align="left">0.894</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">3961</td><td align="left">34</td><td align="left">4275</td><td align="left">10</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">3966</td><td align="left">35</td><td align="left">4275</td><td align="left">4</td><td align="left">0.991</td><td align="left">0.999</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">5786</td><td align="left">386</td><td align="left">1671</td><td align="left">437</td><td align="left">0.937</td><td align="left">0.930</td><td align="left">0.934</td><td align="left">0.901</td><td align="left">0.676</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">5756</td><td align="left">437</td><td align="left">1671</td><td align="left">416</td><td align="left">0.929</td><td align="left">0.933</td><td align="left">0.931</td><td align="left">0.897</td><td align="left">0.652</td></tr><tr><td align="left">Local bipartite</td><td align="left">6425</td><td align="left">37</td><td align="left">1807</td><td align="left">11</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left"><bold>0.923</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6425</td><td align="left">38</td><td align="left">1807</td><td align="left">10</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6431</td><td align="left">37</td><td align="left">1807</td><td align="left">5</td><td align="left">0.994</td><td align="left">0.999</td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.923</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Analysis time</title>
      <p id="Par53">We measured the time costs of G-Aligner and all comparison software on a Windows 11 computer with an Intel(R)_Core(TM)_i9-12900KS CPU (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S4, S5). In evaluation of the manually annotated features, G-Aligner took 1.5 min, 3 min, 0.8 min, respectively on the TripleTOF 6600, QE HF, MTBLS562 dataset. In evaluation on software-extracted features, G-Aligner took 0.6 to 3 min per file on the TripleTOF 6600 dataset, 0.4 to 1 min per file on the QE HF dataset and 1 to 8 min per file on the MTBLS562 dataset. Due to the comprehensive analysis on all potential feature correspondences, combinatorial methods in G-Aligner spent more time than other compared methods. Among the solvers in G-Aligner, the VLSNS solver was up to 9.6 times faster than the Gurobi and Greedy solver and empowered G-Aligner to achieve more accurate feature alignment in acceptable time.</p>
    </sec>
    <sec id="Sec16">
      <title>Discussion</title>
      <p id="Par54">In comparison with popular feature alignment methods in OpenMS, MZmine2 and XCMS, all combinatorial optimization methods in G-Aligner showed significant improvement on the manually annotated and untargeted extracted features of all datasets. The solvers of G-Aligner had different optimization strategies. The Greedy solver is a local optimization method that finds minimum cost matchings iteratively, and the Gurobi and VLSNS solvers aim to find a global optimal solution that minimizes the sum of matching costs. The Gurobi solver and the VLSNS solver achieved equal or better feature alignment accuracy than the Greedy solver in most comparisons, proving the general superiority of global optimization. In global optimization methods, the Gurobi solver treated the MAPs as integer linear programming problems and guaranteed to find global optimal results, while the VLSNS solver was designed to find near-optimal results in less time. With the assistance of the MSG solution initialization method, the VLSNS solver achieved the same global optimal results as the Gurobi solver in all evaluations with less computation time. As a general feature alignment method, G-Aligner helped all evaluated software achieve more accurate feature alignment results and proved its generality and robustness.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par55">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner considered features of all runs as graph nodes and potential correspondences between features as edges. By treating the feature matching problem as multidimensional assignment problems on multipartite graphs, G-Aligner achieved non-centric analysis of all potential correspondences between features of all runs for the first time. Due to the comprehensive analysis of feature distribution, G-Aligner showed obvious advantages in feature matching accuracy. Compared to popular methods, G-Aligner achieved the highest feature alignment accuracy on all benchmark datasets with reasonable computational time.</p>
    <p id="Par56">The main limitation of G-Aligner is the lack of computing speed. To comprehensively consider all potential feature correspondences, G-Aligner modeled the feature matching problem to a multidimensional assignment problem, which was NP-Hard and inevitably requires a lot of computing time. Although we provided two acceleration methods to keep the running time within an acceptable range, there was still a gap between painless application. There are two ways to promote the comprehensive analysis of all potential feature correspondences. The first way is to introduce GPU acceleration to speed up the parallel calculations in G-Aligner. Another way is to go down to the basis principle of retention time drifting. Analyzing massive amount of potential correlations is inevitable in phenomena analysis. Instead, using the phenomena data to estimate the principle of drifting such as retention modeling may be a new efficient way for untargted feature alignment. Furthermore, G-Aligner will be integrated into MetaPro for feature alignment in the untargeted analysis module.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec160">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5525_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary information of this study; <bold>Algorithm S1</bold>, Pseudocode of the Gurobi solver; <bold>Algorithm S2</bold>, Pseudocode of the Greedy solver; <bold>Algorithm S3</bold>, Pseudocode of the VLSNS solver; <bold>Algorithm S4</bold>, Pseudocode of the solution initialization methods of the VLSNS solver; <bold>Figure S1</bold>, The RT drift distribution of library analytes on the TripleTOF 6600 dataset and the QE HF dataset; <bold>Table S1</bold>, Optimized parameters used in the TripleTOF 6600 dataset evaluation; <bold>Table S2</bold>, Optimized parameters used in the QE HF dataset evaluation; <bold>Table S3</bold>, Optimized parameters used in the MTBLS562 dataset evaluation; <bold>Table S4</bold>, Time cost on manually annotated feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Table S5</bold>, Time cost on software self-extracted feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Appendix S1</bold>. Data annotation procedure in MetaPro.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>LC–MS</term>
        <def>
          <p id="Par4">Liquid chromatography–mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>m/z</term>
        <def>
          <p id="Par5">Mass to charge</p>
        </def>
      </def-item>
      <def-item>
        <term>RT</term>
        <def>
          <p id="Par6">Retention rime</p>
        </def>
      </def-item>
      <def-item>
        <term>RANSAC</term>
        <def>
          <p id="Par7">RANdom SAmple Consensus</p>
        </def>
      </def-item>
      <def-item>
        <term>OBI-Warp</term>
        <def>
          <p id="Par8">Ordered bijective interpolated warping</p>
        </def>
      </def-item>
      <def-item>
        <term>DTW</term>
        <def>
          <p id="Par9">Dynamic time warping</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p id="Par10">Multidimensional assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par11">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>VLSNS</term>
        <def>
          <p id="Par12">Very large-scale neighborhood search</p>
        </def>
      </def-item>
      <def-item>
        <term>LAP</term>
        <def>
          <p id="Par13">Linear assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MSR</term>
        <def>
          <p id="Par14">Multi-solution randoms</p>
        </def>
      </def-item>
      <def-item>
        <term>MSG</term>
        <def>
          <p id="Par15">Multi-solution grid</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p id="Par16">True positive</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p id="Par17">False positive</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p id="Par18">True negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p id="Par19">False negative</p>
        </def>
      </def-item>
      <def-item>
        <term>P</term>
        <def>
          <p id="Par20">Precision score</p>
        </def>
      </def-item>
      <def-item>
        <term>R</term>
        <def>
          <p id="Par21">Recall score</p>
        </def>
      </def-item>
      <def-item>
        <term>F</term>
        <def>
          <p id="Par22">F1 score</p>
        </def>
      </def-item>
      <def-item>
        <term>F_ACC</term>
        <def>
          <p id="Par23">Feature accuracy</p>
        </def>
      </def-item>
      <def-item>
        <term>A_ACC</term>
        <def>
          <p id="Par24">Analyte accuracy</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the editors and anonymous reviewers for their valuable suggestions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RW and CY designed the study. RW designed and implemented G-Aligner, performed evaluations, and wrote the manuscript. RW, ML, SA and JW annotated the evaluation datasets. CY reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Natural Science Foundation of Shandong Province (2022HWYQ-081). Academic promotion project of Shandong First Medical University, and funding from Jinan City.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par59">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics—the link between genotypes and phenotypes</article-title>
        <source>Plant Mol Biol</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
        <?supplied-pmid 11860207?>
        <pub-id pub-id-type="pmid">11860207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Emerging applications of metabolomics in drug discovery and precision medicine</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>473</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2016.32</pub-id>
        <?supplied-pmid 26965202?>
        <pub-id pub-id-type="pmid">26965202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>LC–MS alignment in theory and practice: a comprehensive algorithmic review</article-title>
        <source>Brief Bioinform</source>
        <year>2013</year>
        <volume>16</volume>
        <fpage>104</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt080</pub-id>
        <?supplied-pmid 24273217?>
        <pub-id pub-id-type="pmid">24273217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomasi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>FVD</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Correlation optimized warping and dynamic time warping as preprocessing methods for chromatographic data</article-title>
        <source>J Chemom</source>
        <year>2004</year>
        <volume>18</volume>
        <fpage>231</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Liu Y, Chang C, Zhu Y. Advances of chromatogram retention time alignment algorithms in proteomics. 10.13345/j.cjb.210271</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakoe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chiba</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>
        <source>IEEE Trans Acoust Speech Signal Process</source>
        <year>1978</year>
        <volume>26</volume>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1109/TASSP.1978.1163055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PHC</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
        <?supplied-pmid 14719890?>
        <pub-id pub-id-type="pmid">14719890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wang Y, Miller DJ, Poskanzer K, Wang Y, Tian L, Yu G. Graphical time warping for joint alignment of multiple curves. Adv Neural Inf Process Syst. 2016;3655–3663.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Pluskal T, Castillo S, Villar-Briones A, Ore M. Mzmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data. BMC Bioinform. 2010. 10.1186/1471-2105-11-395</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischler</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bolles</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title>
        <source>Commun ACM</source>
        <year>1981</year>
        <volume>24</volume>
        <fpage>381</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1145/358669.358692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Graph-based peak alignment algorithms for multiple liquid chromatography-mass spectrometry datasets</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2469</fpage>
        <lpage>2476</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt435</pub-id>
        <?supplied-pmid 23904508?>
        <pub-id pub-id-type="pmid">23904508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Amon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A hybrid retention time alignment algorithm for SWATH-MS data</article-title>
        <source>Proteomics</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>2272</fpage>
        <lpage>2283</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201500511</pub-id>
        <?supplied-pmid 27302277?>
        <pub-id pub-id-type="pmid">27302277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rást</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aiche</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bielow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weisser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aicheler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Gutenbrunner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kenar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nilse</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pfeuffer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosenberger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rurik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Veit</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wojnar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wolski</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Malmstrém</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>OpenMS: a flexible open-source software platform for mass spectrometry data analysis</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>741</fpage>
        <lpage>748</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3959</pub-id>
        <pub-id pub-id-type="pmid">27575624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <?supplied-pmid 16448051?>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment of ESI-LC-MS proteomics data sets by ordered bijective interpolated warping</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>6140</fpage>
        <lpage>6152</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0605344</pub-id>
        <?supplied-pmid 16944896?>
        <pub-id pub-id-type="pmid">16944896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierskalla</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Letter to the editors-the multidimensional assignment problem</article-title>
        <source>Oper Res</source>
        <year>1968</year>
        <volume>16</volume>
        <fpage>422</fpage>
        <lpage>431</lpage>
        <pub-id pub-id-type="doi">10.1287/opre.16.2.422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shui</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of untargeted metabolomics data processing software in feature detection, quantification and discriminating marker selection</article-title>
        <source>Anal Chim Acta</source>
        <year>2018</year>
        <volume>1029</volume>
        <fpage>50</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2018.05.001</pub-id>
        <?supplied-pmid 29907290?>
        <pub-id pub-id-type="pmid">29907290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Carnitine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cholesteryl</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Absolute quantitative lipidomics reveals lipidome-wide alterations in aging brain</article-title>
        <source>Metabolomics</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1007/s11306-017-1304-x</pub-id>
        <?supplied-pmid 30830343?>
        <pub-id pub-id-type="pmid">30830343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>MacLean</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amodei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ruderman</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Egertson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoff</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tasman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shulman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Frewen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Brusniak</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Paulse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Flashner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moulding</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seymour</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Nuwaysir</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kuhlmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roark</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rainer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Detlev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hemenway</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huhmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langridge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Connolly</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chadick</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Eckels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Agus</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tabb</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>918</fpage>
        <lpage>920</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>
        <?supplied-pmid 23051804?>
        <pub-id pub-id-type="pmid">23051804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Aird: a computation-oriented mass spectrometry data format enables a higher compression ratio and less decoding time</article-title>
        <source>BMC Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04490-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kammerdiner</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Very large-scale neighborhood search for the multidimensional assignment problem</article-title>
        <source>Optim Methods Appl</source>
        <year>2017</year>
        <volume>130</volume>
        <fpage>251</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-68640-0_12</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crouse</surname>
            <given-names>DF</given-names>
          </name>
        </person-group>
        <article-title>On implementing 2D rectangular assignment algorithms</article-title>
        <source>IEEE Trans Aerosp Electron Syst</source>
        <year>2016</year>
        <volume>52</volume>
        <fpage>1679</fpage>
        <lpage>1696</lpage>
        <pub-id pub-id-type="doi">10.1109/TAES.2016.140952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">An S, Wang R, Lu M, Zhang C, Liu H, Wang J, Xie C, Yu C. Metapro: a web-based metabolomics application for LC–MS data batch inspection and library curation. Metabolomics 2023. 10.1007/s11306-023-02018-6</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10644574</article-id>
    <article-id pub-id-type="publisher-id">5525</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05525-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>G-Aligner: a graph-based feature alignment method for untargeted LC–MS-based metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ruimin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Miaoshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Shaowei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jinyin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yu</surname>
          <given-names>Changbin</given-names>
        </name>
        <address>
          <email>yu_lab@sdfmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013q1eq08</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>Fudan University, </institution></institution-wrap>Shanghai, 200433 Shanghai China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Engineering, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05jb9pq57</institution-id><institution-id institution-id-type="GRID">grid.410587.f</institution-id><institution>Shandong First Medical University and Shandong Academy of Medical Sciences, </institution></institution-wrap>Jinan, 250021 Shandong China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 310058 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05hfa4n20</institution-id><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Life Sciences, </institution><institution>Westlake University, </institution></institution-wrap>Hangzhou, 310030 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>431</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Liquid chromatography–mass spectrometry is widely used in untargeted metabolomics for composition profiling. In multi-run analysis scenarios, features of each run are aligned into consensus features by feature alignment algorithms to observe the intensity variations across runs. However, most of the existing feature alignment methods focus more on accurate retention time correction, while underestimating the importance of feature matching. None of the existing methods can comprehensively consider feature correspondences among all runs and achieve optimal matching.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To comprehensively analyze feature correspondences among runs, we propose G-Aligner, a graph-based feature alignment method for untargeted LC–MS data. In the feature matching stage, G-Aligner treats features and potential correspondences as nodes and edges in a multipartite graph, considers the multi-run feature matching problem an unbalanced multidimensional assignment problem, and provides three combinatorial optimization algorithms to find optimal matching solutions. In comparison with the feature alignment methods in OpenMS, MZmine2 and XCMS on three public metabolomics benchmark datasets, G-Aligner achieved the best feature alignment performance on all the three datasets with up to 9.8% and 26.6% increase in accurately aligned features and analytes, and helped all comparison software obtain more accurate results on their self-extracted features by integrating G-Aligner to their analysis workflow. G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license. Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner comprehensively considered potential feature correspondences between all runs, converting the feature matching problem as a multidimensional assignment problem (MAP). In evaluations on three public metabolomics benchmark datasets, G-Aligner achieved the highest alignment accuracy on manual annotated and popular software extracted features, proving the effectiveness and robustness of the algorithm.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05525-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>LC–MS</kwd>
      <kwd>Feature alignment</kwd>
      <kwd>Multidimensional assignment problem</kwd>
      <kwd>Combinatorial optimization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007129</institution-id>
            <institution>Natural Science Foundation of Shandong Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022HWYQ-081</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Academic promotion project of Shandong First Medical University</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Funding from Jinan City</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par25">Liquid chromatography–mass spectrometry (LC–MS) is widely used in the discovery of unknown compounds in untargeted metabolomics [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] In an analysis of multiple LC–MS runs, features of each run are first detected and quantified from raw data by feature extraction algorithms, and features of multiple related LC–MS runs are then combined into one consensus result map by feature alignment algorithms [<xref ref-type="bibr" rid="CR3">3</xref>]. The accuracy of feature alignment directly determines the rationality and credibility of subsequent statistical and biological analysis. However, features have nonlinear retention time (RT) drifts between runs due to unavoidable slight changes in chromatogram conditions [<xref ref-type="bibr" rid="CR4">4</xref>], such as column temperature, column aging and contamination, which greatly increases the difficulty of aligning consensus features.</p>
    <p id="Par26">To perform accurate feature alignment, researchers have proposed dozens of methods in the last decades [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The feature alignment methods can be divided into two categories according to the alignment steps, retention time alignment and feature matching. Retention time alignment methods, such as DTW [<xref ref-type="bibr" rid="CR6">6</xref>], PTW [<xref ref-type="bibr" rid="CR7">7</xref>] and GTW [<xref ref-type="bibr" rid="CR8">8</xref>], align retention times of multiple runs to a common space by fitting linear or nonlinear warping functions between runs to correct retention shifts and make features of the same analyte have closer elution time. Feature matching methods group features of different runs to consensus feature groups by distances in m/z and RT dimensions. Each consensus feature group represents the predicted corresponding features of the same analyte.</p>
    <p id="Par27">Most existing methods rely heavily on retention time alignment and only use naive nearest neighbor search in feature matching. The representative one is MZmine2 [<xref ref-type="bibr" rid="CR9">9</xref>]. After aligning retention time with RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>], MZmine2 selects a reference run and performs pairwise nearest matching to match features of other runs to the reference. However, retention time alignment methods can only describe the drifting trend between runs but cannot accurately correct the retention time of each feature. The retention time of analytes has different drift trends and offsets according to different physical and chemical properties, and elution order may swap when features of different analytes are sufficiently close. To perform more accurate feature matching, LWBmatch [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] considers feature matching between runs as an unbalanced weighted bipartite matching problem and solves the multi-run feature alignment problem by pairwise feature matching. To solve the feature matching problem more comprehensively, OpenMS [<xref ref-type="bibr" rid="CR13">13</xref>] and XCMS [<xref ref-type="bibr" rid="CR14">14</xref>] consider the multi-run feature matching problem a clustering problem. OpenMS finds a cluster of the nearest features for each feature among all runs and then chooses the tightest cluster iteratively to get the feature matching results. XCMS first separates features of all runs by m/z bins, then calculates the feature density curve in RT dimension for each bin, and groups the features according to the RT ranges of peaks in the density curve. However, the OpenMS method uses centralized nearest matching, which is prone to fall into local optimum, and the XCMS grouping is only based on dimensionality reduced RT distribution of features, which leads to lower accuracy and limited performance on feature matchings of close analytes.</p>
    <p id="Par28">To improve feature matching performance, in this paper, we propose G-Aligner (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), a graph-based feature alignment method for untargeted LC–MS-based metabolomics. G-Aligner is the first method enabling non-centric comprehensive analysis of all potential feature correspondences among multiple LC–MS runs. In the retention time alignment stage, G-Aligner uses the existing RANSAC [<xref ref-type="bibr" rid="CR10">10</xref>] and OBI-Warp [<xref ref-type="bibr" rid="CR15">15</xref>] algorithms to perform stable coarse registration between runs. In the feature matching stage, G-Aligner formats the potential correspondences between all features as a multipartite graph, and solves the multi-run feature matching problem as an unbalanced multidimensional assignment problem [<xref ref-type="bibr" rid="CR16">16</xref>] with three combinatorial optimization methods. In comparison with feature alignment methods in OpenMS, MZmine2 and XCMS, G-Aligner showed significant improvements in feature alignment accuracy and helped all comparison software obtain more accurate results by integrating G-Aligner into their workflow.<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of G-Aligner. G-Aligner performs feature alignment in three main steps: feature list input, retention time alignment and feature matching. After loading features of multiple samples, G-Aligner first roughly aligns the retention time of features between samples. Then, in the feature matching step, G-Aligner builds multipartite graphs to represent potential matching relationship among features, and utilizes combinatorial optimization to obtain optimal matchings</p></caption><graphic xlink:href="12859_2023_5525_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Evaluation datasets</title>
      <p id="Par29">We used the two public metabolomics benchmark datasets in [<xref ref-type="bibr" rid="CR17">17</xref>], named as the TripleTOF 6600 dataset and the QE HF dataset. Both datasets were acquired with the full-scan method. The TripleTOF 6600 dataset was acquired by AB SCIEX TripleTOF 6600 interfaced with Shimazu L30A UPLC, and the QE HF dataset was acquired by Thermo Q Exactive HF with Dionex UltiMate 3000 HPLC. A pair of standard mixtures (SA, SB) were prepared for both datasets, which were composed of seven differential groups of drugs and metabolites (Gd1, Gd2, Gd3, Gm, Gd4, Gd5, Gd6) prepared at different relative concentration ratios of (1/16, 1/4, 1/2, 1/1, 2/1, 4/1, 16/1) in SB: SA. The TripleTOF 6600 dataset had four replicates for each mixture, with a total of eight runs. The QE HF dataset had five replicates for each mixture, with a total of ten runs. Benchmark libraries were provided along with the datasets, containing 970 and 836 analytes in the TripleTOF 6600 and the QE HF datasets. We further screened the benchmark libraries to remove duplicates and obtained 924 and 835 analytes, respectively. In both benchmark datasets, the retention times of mixed compounds have different drift trends due to large differences in physical and chemical properties (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Even after retention time alignment across runs, the retention times of analyte features still had wide shifts, which increased the difficulty of feature alignment and made the dataset more suitable for feature alignment evaluation.</p>
      <p id="Par30">Furthermore, to evaluate the performance of feature alignment methods on a bigger dataset, we used the dataset published in Metabolights MTBLS562 [<xref ref-type="bibr" rid="CR18">18</xref>]. The MTBLS562 dataset was acquired with DDA method and acquired by AB SCIEX TripleTOF 6600 with Agilent 1290 UHPLC system. The MTBLS562 dataset contains 40 LC–MS runs of 40 mice (C57BL/6J strain, SPF level) at 5 different ages (4, 12, 24, 32 to 52 weeks, n=8 in each group). Benchmark library was provided along with the dataset, containing 245 analytes. We further screened the benchmark library to remove duplicates and noises and obtained 207 analytes. Some analytes in the library have low abundance in samples with feature intensity heights on the order of hundreds.</p>
    </sec>
    <sec id="Sec4">
      <title>Input preparation</title>
      <p id="Par31">G-Aligner requires users to provide a list of extracted features for each LC–MS run. G-Aligner supports feature extraction results in csv and tsv formats, which can be exported from untargeted metabolomics software. As a general method, G-Aligner only requires users to provide basic feature information, including m/z, retention time and intensity. In case of using profile-based retention time alignment methods that require raw files (such as OBI-Warp), users need to convert raw files to mzML format by MSConvert [<xref ref-type="bibr" rid="CR19">19</xref>] or aird format by AirdPro [<xref ref-type="bibr" rid="CR20">20</xref>] for G-Aligner analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Retention time alignment</title>
      <p id="Par32">To correct retention time drift and reduce the difficulty of subsequent feature matching, G-Aligner provides a feature-based retention time alignment method RANSAC (RANdom SAmple Consensus) and a profile-based method OBI-Warp (Ordered Bijective Interpolated Warping). RANSAC is an iterative method for fitting a model to data and is robust to outliers. In each iteration, the RANSAC method selects a random subset of points from the input data and fits a linear or nonlinear model to these points. The remaining points are then classified into inliers or outliers based on their consistency with the model. Among the iterations, the best-fitting model with the largest number of inliers is selected as the alignment result. OBI-Warp is an extension of dynamic time warping (DTW) for nonlinear retention time warping. For pairs of runs that need to be aligned, OBI-Warp first uses DTW to analyze the spectral similarity and obtain the optimal bijective warping function by dynamic programming. OBI-Warp combines the warping function output from DTW with piecewise cubic Hermitian interpolation and produces smooth warped functions. G-Aligner implemented OBI-Warp in Python for the first time and separated it as an independent installation package for importing by other Python-based software. These two algorithms were also applied in MZmine2 and XCMS, respectively, and their effectiveness and stability have been proven in long-term use. G-Aligner uses linear RANSAC as the default retention time alignment algorithm because it does not require additional raw file import and is faster and more stable.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature matching</title>
      <sec id="Sec7">
        <title>Graph building</title>
        <p id="Par33">Instead of matching features iteratively to a real or virtual reference run, G-Aligner comprehensively considers potential feature correspondences between all LC–MS runs and performs combinatorial optimization to obtain optimal solutions. After retention time coarse registration, the corresponding features of each analyte in different runs are relatively close in m/z and retention time coordinates. To find potential correspondences among all runs, G-Aligner superimposes the retention time aligned features in all runs on the same coordinate system consisting of m/z and retention time dimensions, searches neighborhoods for each feature according to the m/z and retention time tolerances set by the user, and builds an undirected relation graph containing features of all runs. Each node in the graph represents a feature, and each edge represents a potential feature correspondence between neighbor features.</p>
      </sec>
      <sec id="Sec8">
        <title>Graph splitting</title>
        <p id="Par34">After graph building, spatially close feature nodes are connected into many connected components, which are maximal connected subgraphs of the relation graph. A connected component is the largest set of potentially corresponding features for each contained analyte and can be treated as the smallest computing unit for combinatorial optimization. G-Aligner splits the relation graph into connected components and performs combinatorial optimization on each connected component to divide and conquer the feature matching problem. The edge weights in each connected component are calculated by the weighted sum of normalized differences in m/z, retention time and intensity. The m/z and retention time differences are normalized by user-specified m/z and retention time tolerances, and the intensity difference is the deviation in intensity normalized by the largest feature intensity in the same connected component in each run. The edge weight is calculated as Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref> and Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} normed\ area= &amp; {} \frac{area}{maximum\ area\ in\ the\ partite} \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">area</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} edge\ weight= &amp; {} \frac{1}{3} \times \left( \frac{|\Delta m/z|}{m/z\ tolerance} + \frac{|\Delta RT|}{RT\ tolerance} + \left( 1-\frac{\min (normed\ area)}{\max (normed\ area)} \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>z</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec9">
        <title>Assignment solving</title>
        <p id="Par35">In graph theory, a multipartite graph is a type of graph in which the nodes can be divided into multiple independent sets. Each set of nodes is called a partite, and each edge connects a pair of nodes from different partites. After graph splitting, each connected component is a multipartite graph where edges do not connect feature nodes of the same run but different runs. To find the optimal correspondence solution, G-Aligner treats the feature matching problem on the multipartite subgraph as an unbalanced multidimensional assignment problem (MAP), in which the feature number differs in partites. MAP is a fundamental combinatorial optimization problem to find optimal matchings in a weighted multipartite graph, in which the sum of weights of the edges is minimum.</p>
        <p id="Par36">In G-Aligner, we comprehensively considered the neighborhood distribution of features in all runs and defined the unbalanced MAP of the feature matching as follows. For a multipartite graph <italic>G</italic> which contained feature nodes <italic>F</italic> from <italic>M</italic> runs (Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>), let <italic>F</italic>(<italic>k</italic>) represent the feature set of the <italic>k</italic>-th LC–MS run, and <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{ik}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq1.gif"/></alternatives></inline-formula> represent the <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_k$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq2.gif"/></alternatives></inline-formula>-th feature node in the <italic>k</italic>-th LC–MS run (Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref>). <italic>F</italic>(<italic>k</italic>) contains <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_k$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq3.gif"/></alternatives></inline-formula> deduplicated feature nodes <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{f^k_0,\dots ,f^k_{n_k-1}\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq4.gif"/></alternatives></inline-formula> and a placeholder node <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq5.gif"/></alternatives></inline-formula>. We define a linkage (M-partite matching) of features as <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq6.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ5" ref-type="disp-formula">5</xref>), which contains one feature node from each run. Each linkage represents a possible combination of related features of an analyte. When linkage <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i_1 \dots i_M}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq7.gif"/></alternatives></inline-formula> contains a placeholder node <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^k_{n_k}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq8.gif"/></alternatives></inline-formula>, it means no feature from the <italic>k</italic>-th run was matched in the linkage. Accordingly, we recorded the empty linkage containing placeholder nodes of all runs as <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{n_1 \dots n_M}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq9.gif"/></alternatives></inline-formula>. The feasible solutions <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varGamma$$\end{document}</tex-math><mml:math id="M24"><mml:mi>Γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq10.gif"/></alternatives></inline-formula> of MAP should satisfy the following constraints (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>, <xref rid="Equ7" ref-type="disp-formula">7</xref>, <xref rid="Equ8" ref-type="disp-formula">8</xref>, <xref rid="Equ9" ref-type="disp-formula">9</xref>). Equation <xref rid="Equ6" ref-type="disp-formula">6</xref> states that each solution <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M26"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq11.gif"/></alternatives></inline-formula> contains <italic>p</italic> matchings, where <italic>p</italic> is the max node number (containing placeholder node) in each feature set. Equation <xref rid="Equ7" ref-type="disp-formula">7</xref> states that each matching uniquely corresponds to a distinct linkage. Equation <xref rid="Equ8" ref-type="disp-formula">8</xref> states that different matchings in the same solution do not contain shared non-placeholder feature nodes. Equation <xref rid="Equ9" ref-type="disp-formula">9</xref> states that each feasible solution contains all feature nodes. A figure of feature nodes, linkages and matchings in a feasible solution is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F= &amp; {} \{F(1), \ldots , F(M)\} \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo stretchy="false">{</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F(k)= &amp; {} \left\{ f_{i_k}^k \mid i_k=0, \ldots , n_k\right\} , \text{ for } k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>∣</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_{i_1 \ldots i_M}= &amp; {} \left\{ f_{i_1}^1, \ldots , f_{i_M}^M\right\} , \text{ for } i_k=0, \ldots , n_k, k=1, \ldots , M \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mi>M</mml:mi></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \gamma= &amp; {} \left\{ \gamma _1, \ldots , \gamma _p\right\} , p=\max \left( n_1, \ldots , n_M\right) +1 \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfenced close="}" open="{"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \forall \gamma _j: \gamma _j= &amp; {} L_{i_1 \ldots i_M} \exists ! {\text {tuple}}\left( i_1, \ldots , i_M\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∃</mml:mo><mml:mo>!</mml:mo><mml:mtext>tuple</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} \gamma _i \cap \gamma _j \subset L_{n_1 \ldots n_M}, \text{ for } i \ne j \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} F=U_{j=1}^p \gamma _j \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption><p>Visual representation of feature nodes, linkages and matchings in a feasible solution</p></caption><graphic xlink:href="12859_2023_5525_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par37">In order to measure the quality of solutions, we calculated the cost of each solution and selected the one with the lowest cost as the optimal solution. Let <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\gamma$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq12.gif"/></alternatives></inline-formula> represents the cost of solution <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M44"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq13.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq14.gif"/></alternatives></inline-formula> represents the cost of matching <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq15.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ10" ref-type="disp-formula">10</xref>). The cost of a solution is the total cost of all matchings contained. <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\gamma _i}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq16.gif"/></alternatives></inline-formula> consists of distribution cost <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq17.gif"/></alternatives></inline-formula>, connectivity cost <inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{connectivity}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq18.gif"/></alternatives></inline-formula>, missing node cost <inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{missing}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq19.gif"/></alternatives></inline-formula> and full match bonus <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{full\_match}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq20.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ11" ref-type="disp-formula">11</xref>).</p>
        <p id="Par38">The distribution cost in a matching describes the dispersion of matched nodes. For matching <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq21.gif"/></alternatives></inline-formula>, we first extract the subgraph <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq22.gif"/></alternatives></inline-formula> from the multipartite graph <italic>G</italic>, which contains all feature nodes and interconnected edges in <inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq23.gif"/></alternatives></inline-formula>. Then, we calculated the minimum spanning tree (MST) of <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq24.gif"/></alternatives></inline-formula> to find the minimum total weight of the edge subsets connecting all nodes, and used the total weight as the distribution cost <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{distribution}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq25.gif"/></alternatives></inline-formula> for matching <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _i$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq26.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ12" ref-type="disp-formula">12</xref>). In matchings with placeholder nodes and far unconnected clusters, the number of edges in MST is lower than expected <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M-1$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq27.gif"/></alternatives></inline-formula>, resulting in undesired lower distribution cost and affecting matching priorities. Hence, we introduce the missing node cost and the connectivity cost to penalize the missing edges (Eq. <xref rid="Equ13" ref-type="disp-formula">13</xref>, <xref rid="Equ14" ref-type="disp-formula">14</xref>). In matchings with placeholder nodes, the edge number reduction equals the number of placeholder nodes. We calculate the missing node cost by multiplying the placeholder node number <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_p$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq28.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_p$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq29.gif"/></alternatives></inline-formula>. In far matchings, feature nodes are far apart and form multiple clusters, which results in missing edges between clusters. The missed number of edges is equal to the number of connected subgraphs in <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{\gamma _i}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq30.gif"/></alternatives></inline-formula>. Similarly, we calculate the connectivity cost by multiplying the number of connected subgraphs <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_c$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq31.gif"/></alternatives></inline-formula> by a penalty factor <inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_c$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5525_Article_IEq32.gif"/></alternatives></inline-formula>. Besides, we believe matchings with more feature nodes have greater matching priority. Appropriate incentives should be given to full matchings when competing for nodes with others. For connected full matchings, we introduce a bonus factor <italic>b</italic> and subtract it from the matching cost (Eq. <xref rid="Equ15" ref-type="disp-formula">15</xref>). All factors are optimized as built-in parameters and do not require user modification.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_\gamma= &amp; {} \sum _{j=1}^p C_{\gamma _j} \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{\gamma _j}= &amp; {} C_{distribution}+C_{connectivity}+C_{missing}-B_{full\_match} \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{distribution}= &amp; {} \sum _{e \in E(T)} W(e), T={\text {MST}}\left( G_{\gamma _i}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">distribution</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mtext>MST</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{connectivity}= &amp; {} w_c * N_c \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">connectivity</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{missing}= &amp; {} w_p * N_p \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">missing</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B_{full\_match}= &amp; {} b \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>_</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5525_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>However, the multidimensional assignment problem is a well-known NP-Hard problem at three or higher dimensions. There is no known algorithm for finding the optimal solution in polynomial time. To solve MAP efficiently, G-Aligner proposed three solvers: the Gurobi solver, the Greedy solver and the VLSNS solver.</p>
        <p id="Par39">The Gurobi solver converts the multidimensional assignment problem to an integer linear programming problem and uses the state-of-the-art commercial Gurobi optimizer to find the global optimal solution. By inputting matching costs, feasible solution rules and optimization objectives into the model, the Gurobi optimizer can efficiently calculate optimization results, much faster than other linear programming solvers such as the OR-Tools developed by Google. The pseudocode of the Gurobi solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1.</p>
        <p id="Par40">The Greedy solver pays more attention to the quality of a single matching than the solution. In each iteration, the Greedy solver finds the minimum cost matching, adds the matching to the solution, and sets the corresponding costs of matched features to infinite to avoid generating infeasible solutions. In this way, the Greedy solver does not sacrifice the best matchings for a lower cost of solutions. The pseudocode of the Greedy solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S2.</p>
        <p id="Par41">However, the Gurobi and Greedy solver must compute the matching costs for all permutations before running. For faster calculations, we propose the VLSNS solver to solve the unbalanced MAPs, which calculates costs as needed during optimization. The VLSNS solver used a recent metaheuristic approach, known as the very large-scale neighborhood search (VLSNS) [<xref ref-type="bibr" rid="CR21">21</xref>], which finds near-optimal solutions to the MAP by iteratively transforming the current solution into a better solution in the neighborhood. The VLSNS solver converts the multidimensional assignment problem to linear (two-dimensional) assignment problems (LAP) between each partite and the others. In each iteration, the VLSNS solver finds an optimal permutation for each partite and updates the solution permutation in the best-improved partite until no lower cost can be obtained. The pseudocode of the VLSNS solver is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S3.</p>
        <p id="Par42">Since the solution space is not fully searched, VLSNS is not guaranteed to obtain global optimal results and is prone to fall into local optimum. As compensation, multiple start solutions are provided to the solver for parallel optimization, and the optimized solution with the lowest cost is used as the final result. We provide two solution initialization methods: the MSR method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.1) and the MSG method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S4.2). The MSR (multi-solution random) method generates multiple solutions at random. The MSG (multi-solution grid) method generates random solutions first and then equidistantly rolls the permutation order in each partite into multiple grid solutions for each random solution. By adopting the multi-start strategy, the VLSNS solver ensures the computation accuracy and is able to obtain near global optimal results while having a faster calculation speed.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Big graph acceleration</title>
      <p id="Par43">In cases of dense feature distribution and insufficient accuracy of retention time alignment, some connected components may contain a large number of nodes. As the number of nodes increases, the computing time increases polynomially. For efficient analysis of big graphs, we proposed a graph segmentation method to divide big graphs into multiple small subgraphs, and a result merging method to combine solutions of small graphs to a final result. The graph splitting method iteratively divides the graph into two subgraphs by LC–MS run according to the preset node number limit. Nodes in runs with adjacent acquisition time are segmented into the same subgraphs, and the total number of nodes in the two subgraphs is similar. After splitting, G-Aligner performs the optimization methods described above to obtain optimal solutions for each subgraph. Then, G-Aligner assembles the solutions of multiple subgraphs with the result merging method. The result merging method first computes the minimum weight of the edges between each pair of matchings as their distance. Then, matchings are iteratively merged in ascending order of distance when they do not contain nodes from the same LC–MS run.</p>
      <p id="Par44">Besides, G-Aligner can be recursively executed to meet diverse alignment requirements. By default, G-Aligner scans the directory of the feature extraction result folder provided by the user and recursively aligns the results in each subfolder from bottom to top according to the folder structure. For example, in the scenario where each sample has multiple technical replicates, users can put all replicates of each sample in the same subfolder, so that G-Aligner will first align the technical replicates of each sample, and then align samples according to the mean feature m/z and retention time among replicates. Optionally, this recursive align method provides more sample relation information for the algorithm, facilitating better results and faster analysis in large cohort alignments.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Evaluation workflow</title>
      <p id="Par45">We compared G-Aligner with the feature alignment methods in three popular untargeted metabolomics software: MZmine2 (version 2.53), OpenMS (version 2.7.0), and XCMS (version 3.18.0), as representatives of local nearest matching of paired runs, multi-run centric matching and multi-run non-centric matching respectively, on the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset. Moreover, since we had problems running LWBmatch, we implemented a local bipartite solver for comparison, as a representative of bipartite pairwise matching methods. After selecting the LC–MS run with the most features as a reference run, the local bipartite solver matched other LC–MS runs iteratively in descending order of feature numbers to the reference run. The local bipartite solver treats feature matching as a weighted bipartite assignment problem and uses a modified Jonker-Volgenant algorithm [<xref ref-type="bibr" rid="CR22">22</xref>] to find the maximum cardinality matching with a minimum sum of matching distances.</p>
      <p id="Par46">In evaluations of G-Aligner and other methods, we first manually annotated features of library analytes for each dataset and conducted a comprehensive assessment of the feature alignment algorithms on the same manually annotated feature set to exclude differences in feature extraction. Then, we integrated G-Aligner into the workflow of each software to evaluate the improvement on their self-extracted features. In parameter settings, we first manually selected a set of reasonable parameters based on the distribution of the data, and then manually fine-tuned them to obtain the best parameters to achieve the highest detection rate and alignment performance of features corresponding to the compounds in the library. The fine-tuned parameters of compared software were summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2 and S3. Notably, the differences in feature extraction parameter settings may lead to different distributions on extracted features and result in different difficulties in feature alignment. However, the parameter settings for feature extraction are less important to the evaluation results, we only need to evaluate G-Aligner and other methods on the same set of feature extraction results under the same alignment difficulty.</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation on manually annotated features</title>
      <p id="Par47">To perform a comprehensive evaluation for feature alignment algorithms, all algorithms should be evaluated on the same set of features to control the variable in feature distribution. To create a feature dataset with standard alignment results for each dataset, we extracted and annotated features of library analytes with the MetaPro [<xref ref-type="bibr" rid="CR23">23</xref>] batch inspection tool. For each analyte in library, we extracted features close to the m/z and RT coordinates in each run, in which at most one feature was manually annotated as the corresponding feature. All of the extracted nearby features were added to the feature datasets. Each feature was represented by its apex m/z (the apex m/z of the spectral peak at apex RT), apex RT and integrated area. The annotation procedure was detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix S1.</p>
      <p id="Par48">We utilized the annotated results as references to evaluate the accuracy of feature alignment algorithms. When importing the manually annotated features into the comparison software, we directly accessed the source code of the compared software in Python, Java, and R environments, and assembled or re-extracted the features into supported memory objects, since all comparison software lacked external feature import capabilities or only supported specific feature formats. The m/z and retention time ranges of each feature used in re-extraction were kept the same as MetaPro extracted features, which ensured the consistency of evaluation datasets.</p>
      <p id="Par49">To benchmark the performance of the feature alignment, we compare the predicted matchings with the manual annotation results (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For each analyte, the predicted matching with the most common features with the annotated matching was considered its corresponding matching, while the contained features were considered its corresponding features. The corresponding feature of each analyte in each sample may differ between the predicted and annotated matchings. For each analyte, the alignment in a sample was considered true positive (TP) when the corresponding feature was present in both aligned and annotated results, false positive (FP) when the corresponding feature was only present in the aligned results, true negative (TN) when there was no corresponding feature in the aligned and annotated results, and false negative (FN) when the corresponding feature was only present in the annotated results. Then, we counted the feature alignment status of all compared methods and calculated the precision (P), recall (R), F1 score (F), feature accuracy (F_ACC), and analyte accuracy (A_ACC) accordingly on each dataset.<fig id="Fig3"><label>Fig. 3</label><caption><p>Definitions of evaluation metrics. In the example matching of 7 samples, numbers in matching vectors are the index numbers of matched features in the feature lists of corresponding samples</p></caption><graphic xlink:href="12859_2023_5525_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par50">In evaluation of the feature alignment accuracy, we compared G-Aligner with other methods on the manually annotated features of each dataset and summarized the results in Table <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref>. The combinatorial optimization methods in G-Aligner outperformed other comparison methods and achieved the best performance on all datasets with the most TP and FP and the least FP and FN, proving the necessity of multi-run analysis. Among the combinatorial optimization solvers, the Greedy solver obtained less accurate results than the Gurobi solver and VLSNS solver. The Greedy solver focused only on local optimal matchings and ignored corresponding suboptimal matches in the greedy search, which illustrates the importance of global optimization. The Gurobi solver and VLSNS solver were too slow and were skipped in evaluations of the MTBLS562 dataset. G-Aligner achieved the best result on all datasets, with F1 scores at 0.999, 0.998 and 1.000, feature accuracy at 0.999, 0.997 and 0.999, and analyte accuracy at 0.990, 0.989 and 0.981, respectively, in the TripleTOF 6600, QE HF and MTBLS562 dataset. Compared to the best-performed OpenMS method, G-Aligner achieved 1.1%, 1.9% and 0.6% higher feature accuracy and 5.3%, 8.7% and 14.0% higher analyte accuracy, respectively.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Evaluation results on manually annotated feature sets of the TripleTOF 6600dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7163</td><td align="left">77</td><td align="left">0</td><td align="left">152</td><td align="left">0.989</td><td align="left">0.979</td><td align="left">0.984</td><td align="left">0.969</td><td align="left">0.883</td></tr><tr><td align="left">OpenMS QT</td><td align="left">7303</td><td align="left">64</td><td align="left">0</td><td align="left">25</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left">0.988</td><td align="left">0.937</td></tr><tr><td align="left">XCMS Group</td><td align="left">6916</td><td align="left">228</td><td align="left">0</td><td align="left">248</td><td align="left">0.968</td><td align="left">0.965</td><td align="left">0.967</td><td align="left">0.936</td><td align="left">0.837</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6797</td><td align="left">253</td><td align="left">0</td><td align="left">342</td><td align="left">0.964</td><td align="left">0.952</td><td align="left">0.958</td><td align="left">0.920</td><td align="left">0.777</td></tr><tr><td align="left">Local bipartite</td><td align="left">7150</td><td align="left">75</td><td align="left">0</td><td align="left">167</td><td align="left">0.990</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7381</td><td align="left">4</td><td align="left">0</td><td align="left">7</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7382</td><td align="left">3</td><td align="left">0</td><td align="left">7</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.990</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Evaluation results on manually annotated feature sets of the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7982</td><td align="left">103</td><td align="left">0</td><td align="left">265</td><td align="left">0.987</td><td align="left">0.968</td><td align="left">0.977</td><td align="left">0.956</td><td align="left">0.831</td></tr><tr><td align="left">OpenMS</td><td align="left">8167</td><td align="left">146</td><td align="left">0</td><td align="left">37</td><td align="left">0.982</td><td align="left">0.995</td><td align="left">0.989</td><td align="left">0.978</td><td align="left">0.902</td></tr><tr><td align="left">XCMS Group</td><td align="left">6812</td><td align="left">629</td><td align="left">0</td><td align="left">909</td><td align="left">0.915</td><td align="left">0.882</td><td align="left">0.899</td><td align="left">0.816</td><td align="left">0.715</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6749</td><td align="left">677</td><td align="left">0</td><td align="left">924</td><td align="left">0.909</td><td align="left">0.880</td><td align="left">0.894</td><td align="left">0.808</td><td align="left">0.667</td></tr><tr><td align="left">Local bipartite</td><td align="left">8019</td><td align="left">78</td><td align="left">0</td><td align="left">253</td><td align="left">0.990</td><td align="left">0.969</td><td align="left">0.980</td><td align="left">0.960</td><td align="left">0.884</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8320</td><td align="left">12</td><td align="left">0</td><td align="left">18</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left">0.996</td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8323</td><td align="left">7</td><td align="left">0</td><td align="left">20</td><td align="left">0.999</td><td align="left">0.998</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.989</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Evaluation results on manually annotated feature sets of the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">7822</td><td align="left">25</td><td align="left">0</td><td align="left">433</td><td align="left">0.997</td><td align="left">0.948</td><td align="left">0.972</td><td align="left">0.945</td><td align="left">0.744</td></tr><tr><td align="left">OpenMS</td><td align="left">8221</td><td align="left">34</td><td align="left">0</td><td align="left">25</td><td align="left">0.996</td><td align="left">0.997</td><td align="left">0.996</td><td align="left">0.993</td><td align="left">0.841</td></tr><tr><td align="left">XCMS Group</td><td align="left">6115</td><td align="left">847</td><td align="left">0</td><td align="left">1318</td><td align="left">0.878</td><td align="left">0.823</td><td align="left">0.850</td><td align="left">0.739</td><td align="left">0.145</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6230</td><td align="left">868</td><td align="left">0</td><td align="left">1182</td><td align="left">0.878</td><td align="left">0.841</td><td align="left">0.859</td><td align="left">0.752</td><td align="left">0.169</td></tr><tr><td align="left">Local bipartite</td><td align="left">8173</td><td align="left">1</td><td align="left">0</td><td align="left">106</td><td align="left">1.000</td><td align="left">0.987</td><td align="left">0.993</td><td align="left">0.987</td><td align="left">0.937</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8269</td><td align="left">3</td><td align="left">0</td><td align="left">8</td><td align="left">1.000</td><td align="left">0.999</td><td align="left">0.999</td><td align="left"><bold>0.999</bold></td><td align="left">0.976</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8272</td><td align="left">3</td><td align="left">0</td><td align="left">5</td><td align="left">1.000</td><td align="left">0.999</td><td align="left"><bold>1.000</bold></td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.981</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation on software self-extracted features</title>
      <p id="Par51">Since the distribution of all untargeted extracted features was more complicated than the manually annotated feature datasets, we further evaluated the performance of G-Aligner on full untargeted extracted features. Considering that there may be implicit correlations between the alignment methods and their analysis pipeline, we integrated G-Aligner into the workflow of each software and compared G-Aligner with their original alignment methods in the native environment. To obtain benchmarks for alignment, we used the manually annotated results to infer the correct alignment of untargeted extracted features for each software. Since the feature of each analyte corresponds to the same LC–MS signal in each file, the corresponding features extracted by different software should be extremely near. We matched the untargeted extracted features to the manually annotated features with m/z and retention time tolerances at (0.01Da, 0.1min) on the TripleTOF 6600 dataset, (0.005Da, 0.1min) on the QE HF dataset and (0.015Da, 0.1min) on the MTBLS562 dataset. If more than one feature was matched within the tolerances, the closest was selected as the inferred corresponding feature. The distance between features was the squared sum of m/z and retention time deviations normalized by the inverse of the tolerance. To benchmark the feature alignment performance on untargeted extracted features, we used the same evaluation metrics as on manually annotated features by matching alignment results to inferred annotation results. For each software, we compared G-Aligner with the native feature alignment methods on the alignment performance of all analytes on all datasets, including match status, precision, recall, F1 score, feature accuracy and analyte accuracy.</p>
      <p id="Par52">In evaluation results on untargeted extracted features of the three software (Tables <xref rid="Tab4" ref-type="table">4</xref>, <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref>), all evaluation methods achieved less accurate results than on the manually annotated features, which was mainly due to the increase in complexity in feature distributions. Different from manually annotated data, false detections and missing detections always happens in untargeted feature extraction, causing more interference to the alignment algorithms. In the evaluation of software self-extracted features, the combinatorial optimization methods in G-Aligner achieved obviously better performance than local pairwise and native methods of all software on all datasets. G-Aligner proved its robustness on untargted extracted features of the three software with different qualities; OpenMS had the most missing features, MZmine2 had fewer, and XCMS had the least. The Gurobi and VLSNS solver achieved the best performance in most feature sets, but was less accurate than the Greedy solver on the OpenMS features of the TripleTOF 6600 dataset. Although the Greedy solver only performs local optimization and always inferior to the Gurobi and VLSNS solver in most cases, the strategy of finding local optimum matching could be less disturbed for feature sets with insufficient quality. In most evaluations on the complex distributed untargted extracted features, the VLSNS solver with the MSG solution initialization method showed higher accuracy than with the MSR method, which indicated that the MSR method might generate less dispersed initial solutions compared due to excessive dependence on randomness, and it was more prone to lead the VLSNS solver into suboptimal solutions. G-Aligner achieved the best performance on untargeted extracted features on all datasets, with 1.7%, 9.0% and 0.5% higher feature accuracy, 5.8%, 26.6% and 7.7% higher analyte accuracy than MZmine2, 2.4%, 1.5% and 1.7% higher feature accuracy, 13.5%, 10.6% and 18.4% higher analyte accuracy than OpenMS, 9.8%, 2.6% and 9.4% higher feature accuracy, 24.5%, 11.4% and 24.7% higher analyte accuracy than XCMS, respectively on the TripleTOF 6600, QE HF and MTBLS562 dataset.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Evaluation results on software self-extracted features on the TripleTOF 6600 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6716</td><td align="left">129</td><td align="left">422</td><td align="left">125</td><td align="left">0.981</td><td align="left">0.982</td><td align="left">0.981</td><td align="left">0.966</td><td align="left">0.869</td></tr><tr><td align="left">Local bipartite</td><td align="left">6688</td><td align="left">122</td><td align="left">413</td><td align="left">169</td><td align="left">0.982</td><td align="left">0.975</td><td align="left">0.979</td><td align="left">0.961</td><td align="left">0.882</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">6847</td><td align="left">98</td><td align="left">403</td><td align="left">44</td><td align="left">0.986</td><td align="left">0.994</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.925</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">6859</td><td align="left">84</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left">0.982</td><td align="left">0.926</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6846</td><td align="left">89</td><td align="left">403</td><td align="left">54</td><td align="left">0.987</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.981</td><td align="left">0.922</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6862</td><td align="left">81</td><td align="left">403</td><td align="left">46</td><td align="left">0.988</td><td align="left">0.993</td><td align="left"><bold>0.991</bold></td><td align="left"><bold>0.983</bold></td><td align="left"><bold>0.927</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">5771</td><td align="left">336</td><td align="left">1204</td><td align="left">81</td><td align="left">0.945</td><td align="left">0.986</td><td align="left">0.965</td><td align="left">0.944</td><td align="left">0.741</td></tr><tr><td align="left">Local bipartite</td><td align="left">5355</td><td align="left">338</td><td align="left">1248</td><td align="left">451</td><td align="left">0.941</td><td align="left">0.922</td><td align="left">0.931</td><td align="left">0.893</td><td align="left">0.697</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">5922</td><td align="left">140</td><td align="left">1230</td><td align="left">100</td><td align="left">0.977</td><td align="left">0.983</td><td align="left"><bold>0.980</bold></td><td align="left"><bold>0.968</bold></td><td align="left">0.874</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5906</td><td align="left">156</td><td align="left">1233</td><td align="left">97</td><td align="left">0.974</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left">0.873</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5910</td><td align="left">152</td><td align="left">1233</td><td align="left">97</td><td align="left">0.975</td><td align="left">0.984</td><td align="left">0.979</td><td align="left">0.966</td><td align="left"><bold>0.876</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">6567</td><td align="left">251</td><td align="left">38</td><td align="left">536</td><td align="left">0.963</td><td align="left">0.925</td><td align="left">0.943</td><td align="left">0.894</td><td align="left">0.712</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">6173</td><td align="left">293</td><td align="left">39</td><td align="left">887</td><td align="left">0.955</td><td align="left">0.874</td><td align="left">0.913</td><td align="left">0.840</td><td align="left">0.600</td></tr><tr><td align="left">Local bipartite</td><td align="left">6939</td><td align="left">152</td><td align="left">51</td><td align="left">250</td><td align="left">0.979</td><td align="left">0.965</td><td align="left">0.972</td><td align="left">0.946</td><td align="left">0.866</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7281</td><td align="left">52</td><td align="left">47</td><td align="left">12</td><td align="left">0.993</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.956</td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7270</td><td align="left">51</td><td align="left">47</td><td align="left">24</td><td align="left">0.993</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.951</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7283</td><td align="left">47</td><td align="left">47</td><td align="left">15</td><td align="left">0.994</td><td align="left">0.998</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.957</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Evaluation results on software self-extracted features on the QE HF dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">6995</td><td align="left">11</td><td align="left">566</td><td align="left">778</td><td align="left">0.998</td><td align="left">0.900</td><td align="left">0.947</td><td align="left">0.906</td><td align="left">0.721</td></tr><tr><td align="left">Local bipartite</td><td align="left">7705</td><td align="left">6</td><td align="left">563</td><td align="left">76</td><td align="left">0.999</td><td align="left">0.990</td><td align="left">0.995</td><td align="left">0.990</td><td align="left">0.975</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7746</td><td align="left">5</td><td align="left">563</td><td align="left">36</td><td align="left">0.999</td><td align="left">0.995</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.986</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7751</td><td align="left">5</td><td align="left">563</td><td align="left">31</td><td align="left">0.999</td><td align="left">0.996</td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.987</bold></td></tr><tr><td align="left">OpenMS QT</td><td align="left">7039</td><td align="left">20</td><td align="left">1166</td><td align="left">125</td><td align="left">0.997</td><td align="left">0.983</td><td align="left">0.990</td><td align="left">0.983</td><td align="left">0.887</td></tr><tr><td align="left">Local bipartite</td><td align="left">7092</td><td align="left">8</td><td align="left">1169</td><td align="left">81</td><td align="left">0.999</td><td align="left">0.989</td><td align="left">0.994</td><td align="left">0.989</td><td align="left">0.972</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">7161</td><td align="left">2</td><td align="left">1169</td><td align="left">18</td><td align="left">1.000</td><td align="left">0.997</td><td align="left"><bold>0.999</bold></td><td align="left"><bold>0.998</bold></td><td align="left"><bold>0.993</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">7934</td><td align="left">99</td><td align="left">134</td><td align="left">183</td><td align="left">0.988</td><td align="left">0.977</td><td align="left">0.983</td><td align="left">0.966</td><td align="left">0.846</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">7940</td><td align="left">70</td><td align="left">135</td><td align="left">205</td><td align="left">0.991</td><td align="left">0.975</td><td align="left">0.983</td><td align="left">0.967</td><td align="left">0.846</td></tr><tr><td align="left">Local bipartite</td><td align="left">8057</td><td align="left">36</td><td align="left">148</td><td align="left">109</td><td align="left">0.996</td><td align="left">0.987</td><td align="left">0.991</td><td align="left">0.983</td><td align="left">0.938</td></tr><tr><td align="left">G-Aligner Greedy</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner Gurobi</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">8131</td><td align="left">20</td><td align="left">148</td><td align="left">51</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left">0.991</td><td align="left">0.957</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">8141</td><td align="left">15</td><td align="left">148</td><td align="left">46</td><td align="left">0.998</td><td align="left">0.994</td><td align="left"><bold>0.996</bold></td><td align="left"><bold>0.993</bold></td><td align="left"><bold>0.960</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Evaluation results on software self-extracted features on the MTBLS562 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">TP</th><th align="left">FP</th><th align="left">TN</th><th align="left">FN</th><th align="left">P</th><th align="left">R</th><th align="left">F</th><th align="left">F_ACC</th><th align="left">A_ACC</th></tr></thead><tbody><tr><td align="left">MZmine2 RANSAC</td><td align="left">5751</td><td align="left">106</td><td align="left">2398</td><td align="left">25</td><td align="left">0.982</td><td align="left">0.996</td><td align="left">0.989</td><td align="left">0.984</td><td align="left">0.768</td></tr><tr><td align="left">Local bipartite</td><td align="left">5719</td><td align="left">58</td><td align="left">2448</td><td align="left">55</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.990</td><td align="left">0.986</td><td align="left">0.845</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">5744</td><td align="left">67</td><td align="left">2435</td><td align="left">34</td><td align="left">0.988</td><td align="left">0.994</td><td align="left">0.991</td><td align="left">0.988</td><td align="left"><bold>0.850</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">5758</td><td align="left">66</td><td align="left">2434</td><td align="left">22</td><td align="left">0.989</td><td align="left">0.996</td><td align="left"><bold>0.992</bold></td><td align="left"><bold>0.989</bold></td><td align="left">0.845</td></tr><tr><td align="left">OpenMS QT</td><td align="left">3916</td><td align="left">139</td><td align="left">4182</td><td align="left">43</td><td align="left">0.966</td><td align="left">0.989</td><td align="left">0.977</td><td align="left">0.978</td><td align="left">0.715</td></tr><tr><td align="left">Local bipartite</td><td align="left">3933</td><td align="left">32</td><td align="left">4277</td><td align="left">38</td><td align="left">0.992</td><td align="left">0.990</td><td align="left">0.991</td><td align="left">0.992</td><td align="left">0.894</td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">3961</td><td align="left">34</td><td align="left">4275</td><td align="left">10</td><td align="left">0.991</td><td align="left">0.997</td><td align="left">0.994</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">3966</td><td align="left">35</td><td align="left">4275</td><td align="left">4</td><td align="left">0.991</td><td align="left">0.999</td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.899</bold></td></tr><tr><td align="left">XCMS Group</td><td align="left">5786</td><td align="left">386</td><td align="left">1671</td><td align="left">437</td><td align="left">0.937</td><td align="left">0.930</td><td align="left">0.934</td><td align="left">0.901</td><td align="left">0.676</td></tr><tr><td align="left">XCMS OBI-Warp</td><td align="left">5756</td><td align="left">437</td><td align="left">1671</td><td align="left">416</td><td align="left">0.929</td><td align="left">0.933</td><td align="left">0.931</td><td align="left">0.897</td><td align="left">0.652</td></tr><tr><td align="left">Local bipartite</td><td align="left">6425</td><td align="left">37</td><td align="left">1807</td><td align="left">11</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left"><bold>0.923</bold></td></tr><tr><td align="left">G-Aligner VLSNS_MSR</td><td align="left">6425</td><td align="left">38</td><td align="left">1807</td><td align="left">10</td><td align="left">0.994</td><td align="left">0.998</td><td align="left">0.996</td><td align="left">0.994</td><td align="left">0.918</td></tr><tr><td align="left">G-Aligner VLSNS_MSG</td><td align="left">6431</td><td align="left">37</td><td align="left">1807</td><td align="left">5</td><td align="left">0.994</td><td align="left">0.999</td><td align="left"><bold>0.997</bold></td><td align="left"><bold>0.995</bold></td><td align="left"><bold>0.923</bold></td></tr></tbody></table><table-wrap-foot><p>The results with the highest performance in the comparison are indicated in bold</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Analysis time</title>
      <p id="Par53">We measured the time costs of G-Aligner and all comparison software on a Windows 11 computer with an Intel(R)_Core(TM)_i9-12900KS CPU (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S4, S5). In evaluation of the manually annotated features, G-Aligner took 1.5 min, 3 min, 0.8 min, respectively on the TripleTOF 6600, QE HF, MTBLS562 dataset. In evaluation on software-extracted features, G-Aligner took 0.6 to 3 min per file on the TripleTOF 6600 dataset, 0.4 to 1 min per file on the QE HF dataset and 1 to 8 min per file on the MTBLS562 dataset. Due to the comprehensive analysis on all potential feature correspondences, combinatorial methods in G-Aligner spent more time than other compared methods. Among the solvers in G-Aligner, the VLSNS solver was up to 9.6 times faster than the Gurobi and Greedy solver and empowered G-Aligner to achieve more accurate feature alignment in acceptable time.</p>
    </sec>
    <sec id="Sec16">
      <title>Discussion</title>
      <p id="Par54">In comparison with popular feature alignment methods in OpenMS, MZmine2 and XCMS, all combinatorial optimization methods in G-Aligner showed significant improvement on the manually annotated and untargeted extracted features of all datasets. The solvers of G-Aligner had different optimization strategies. The Greedy solver is a local optimization method that finds minimum cost matchings iteratively, and the Gurobi and VLSNS solvers aim to find a global optimal solution that minimizes the sum of matching costs. The Gurobi solver and the VLSNS solver achieved equal or better feature alignment accuracy than the Greedy solver in most comparisons, proving the general superiority of global optimization. In global optimization methods, the Gurobi solver treated the MAPs as integer linear programming problems and guaranteed to find global optimal results, while the VLSNS solver was designed to find near-optimal results in less time. With the assistance of the MSG solution initialization method, the VLSNS solver achieved the same global optimal results as the Gurobi solver in all evaluations with less computation time. As a general feature alignment method, G-Aligner helped all evaluated software achieve more accurate feature alignment results and proved its generality and robustness.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par55">In this study, we proposed G-Aligner to improve feature matching accuracy for untargeted metabolomics LC–MS data. G-Aligner considered features of all runs as graph nodes and potential correspondences between features as edges. By treating the feature matching problem as multidimensional assignment problems on multipartite graphs, G-Aligner achieved non-centric analysis of all potential correspondences between features of all runs for the first time. Due to the comprehensive analysis of feature distribution, G-Aligner showed obvious advantages in feature matching accuracy. Compared to popular methods, G-Aligner achieved the highest feature alignment accuracy on all benchmark datasets with reasonable computational time.</p>
    <p id="Par56">The main limitation of G-Aligner is the lack of computing speed. To comprehensively consider all potential feature correspondences, G-Aligner modeled the feature matching problem to a multidimensional assignment problem, which was NP-Hard and inevitably requires a lot of computing time. Although we provided two acceleration methods to keep the running time within an acceptable range, there was still a gap between painless application. There are two ways to promote the comprehensive analysis of all potential feature correspondences. The first way is to introduce GPU acceleration to speed up the parallel calculations in G-Aligner. Another way is to go down to the basis principle of retention time drifting. Analyzing massive amount of potential correlations is inevitable in phenomena analysis. Instead, using the phenomena data to estimate the principle of drifting such as retention modeling may be a new efficient way for untargted feature alignment. Furthermore, G-Aligner will be integrated into MetaPro for feature alignment in the untargeted analysis module.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec160">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5525_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary information of this study; <bold>Algorithm S1</bold>, Pseudocode of the Gurobi solver; <bold>Algorithm S2</bold>, Pseudocode of the Greedy solver; <bold>Algorithm S3</bold>, Pseudocode of the VLSNS solver; <bold>Algorithm S4</bold>, Pseudocode of the solution initialization methods of the VLSNS solver; <bold>Figure S1</bold>, The RT drift distribution of library analytes on the TripleTOF 6600 dataset and the QE HF dataset; <bold>Table S1</bold>, Optimized parameters used in the TripleTOF 6600 dataset evaluation; <bold>Table S2</bold>, Optimized parameters used in the QE HF dataset evaluation; <bold>Table S3</bold>, Optimized parameters used in the MTBLS562 dataset evaluation; <bold>Table S4</bold>, Time cost on manually annotated feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Table S5</bold>, Time cost on software self-extracted feature sets of the TripleTOF 6600 dataset, the QE HF dataset and the MTBLS562 dataset; <bold>Appendix S1</bold>. Data annotation procedure in MetaPro.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>LC–MS</term>
        <def>
          <p id="Par4">Liquid chromatography–mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>m/z</term>
        <def>
          <p id="Par5">Mass to charge</p>
        </def>
      </def-item>
      <def-item>
        <term>RT</term>
        <def>
          <p id="Par6">Retention rime</p>
        </def>
      </def-item>
      <def-item>
        <term>RANSAC</term>
        <def>
          <p id="Par7">RANdom SAmple Consensus</p>
        </def>
      </def-item>
      <def-item>
        <term>OBI-Warp</term>
        <def>
          <p id="Par8">Ordered bijective interpolated warping</p>
        </def>
      </def-item>
      <def-item>
        <term>DTW</term>
        <def>
          <p id="Par9">Dynamic time warping</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p id="Par10">Multidimensional assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par11">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>VLSNS</term>
        <def>
          <p id="Par12">Very large-scale neighborhood search</p>
        </def>
      </def-item>
      <def-item>
        <term>LAP</term>
        <def>
          <p id="Par13">Linear assignment problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MSR</term>
        <def>
          <p id="Par14">Multi-solution randoms</p>
        </def>
      </def-item>
      <def-item>
        <term>MSG</term>
        <def>
          <p id="Par15">Multi-solution grid</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p id="Par16">True positive</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p id="Par17">False positive</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p id="Par18">True negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p id="Par19">False negative</p>
        </def>
      </def-item>
      <def-item>
        <term>P</term>
        <def>
          <p id="Par20">Precision score</p>
        </def>
      </def-item>
      <def-item>
        <term>R</term>
        <def>
          <p id="Par21">Recall score</p>
        </def>
      </def-item>
      <def-item>
        <term>F</term>
        <def>
          <p id="Par22">F1 score</p>
        </def>
      </def-item>
      <def-item>
        <term>F_ACC</term>
        <def>
          <p id="Par23">Feature accuracy</p>
        </def>
      </def-item>
      <def-item>
        <term>A_ACC</term>
        <def>
          <p id="Par24">Analyte accuracy</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the editors and anonymous reviewers for their valuable suggestions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>RW and CY designed the study. RW designed and implemented G-Aligner, performed evaluations, and wrote the manuscript. RW, ML, SA and JW annotated the evaluation datasets. CY reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Natural Science Foundation of Shandong Province (2022HWYQ-081). Academic promotion project of Shandong First Medical University, and funding from Jinan City.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Benchmark datasets, manual annotation results, evaluation methods and results are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.8313034">https://doi.org/10.5281/zenodo.8313034</ext-link></p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>G-Aligner is open-source and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CSi-Studio/G-Aligner">https://github.com/CSi-Studio/G-Aligner</ext-link> under a permissive license.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par59">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics—the link between genotypes and phenotypes</article-title>
        <source>Plant Mol Biol</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
        <?supplied-pmid 11860207?>
        <pub-id pub-id-type="pmid">11860207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Emerging applications of metabolomics in drug discovery and precision medicine</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>473</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2016.32</pub-id>
        <?supplied-pmid 26965202?>
        <pub-id pub-id-type="pmid">26965202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>LC–MS alignment in theory and practice: a comprehensive algorithmic review</article-title>
        <source>Brief Bioinform</source>
        <year>2013</year>
        <volume>16</volume>
        <fpage>104</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt080</pub-id>
        <?supplied-pmid 24273217?>
        <pub-id pub-id-type="pmid">24273217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomasi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>FVD</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Correlation optimized warping and dynamic time warping as preprocessing methods for chromatographic data</article-title>
        <source>J Chemom</source>
        <year>2004</year>
        <volume>18</volume>
        <fpage>231</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Liu Y, Chang C, Zhu Y. Advances of chromatogram retention time alignment algorithms in proteomics. 10.13345/j.cjb.210271</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakoe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chiba</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>
        <source>IEEE Trans Acoust Speech Signal Process</source>
        <year>1978</year>
        <volume>26</volume>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1109/TASSP.1978.1163055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PHC</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
        <?supplied-pmid 14719890?>
        <pub-id pub-id-type="pmid">14719890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wang Y, Miller DJ, Poskanzer K, Wang Y, Tian L, Yu G. Graphical time warping for joint alignment of multiple curves. Adv Neural Inf Process Syst. 2016;3655–3663.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Pluskal T, Castillo S, Villar-Briones A, Ore M. Mzmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data. BMC Bioinform. 2010. 10.1186/1471-2105-11-395</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischler</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bolles</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title>
        <source>Commun ACM</source>
        <year>1981</year>
        <volume>24</volume>
        <fpage>381</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1145/358669.358692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Graph-based peak alignment algorithms for multiple liquid chromatography-mass spectrometry datasets</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2469</fpage>
        <lpage>2476</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt435</pub-id>
        <?supplied-pmid 23904508?>
        <pub-id pub-id-type="pmid">23904508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Amon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A hybrid retention time alignment algorithm for SWATH-MS data</article-title>
        <source>Proteomics</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>2272</fpage>
        <lpage>2283</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201500511</pub-id>
        <?supplied-pmid 27302277?>
        <pub-id pub-id-type="pmid">27302277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rást</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aiche</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bielow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weisser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aicheler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Gutenbrunner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kenar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nilse</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pfeuffer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosenberger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rurik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Veit</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wojnar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wolski</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Malmstrém</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>OpenMS: a flexible open-source software platform for mass spectrometry data analysis</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>741</fpage>
        <lpage>748</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3959</pub-id>
        <pub-id pub-id-type="pmid">27575624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <?supplied-pmid 16448051?>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prince</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment of ESI-LC-MS proteomics data sets by ordered bijective interpolated warping</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>6140</fpage>
        <lpage>6152</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0605344</pub-id>
        <?supplied-pmid 16944896?>
        <pub-id pub-id-type="pmid">16944896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierskalla</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Letter to the editors-the multidimensional assignment problem</article-title>
        <source>Oper Res</source>
        <year>1968</year>
        <volume>16</volume>
        <fpage>422</fpage>
        <lpage>431</lpage>
        <pub-id pub-id-type="doi">10.1287/opre.16.2.422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shui</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of untargeted metabolomics data processing software in feature detection, quantification and discriminating marker selection</article-title>
        <source>Anal Chim Acta</source>
        <year>2018</year>
        <volume>1029</volume>
        <fpage>50</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2018.05.001</pub-id>
        <?supplied-pmid 29907290?>
        <pub-id pub-id-type="pmid">29907290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Carnitine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cholesteryl</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Absolute quantitative lipidomics reveals lipidome-wide alterations in aging brain</article-title>
        <source>Metabolomics</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1007/s11306-017-1304-x</pub-id>
        <?supplied-pmid 30830343?>
        <pub-id pub-id-type="pmid">30830343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>MacLean</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amodei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ruderman</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gatto</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Egertson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoff</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tasman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shulman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Frewen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Brusniak</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Paulse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Flashner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moulding</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seymour</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Nuwaysir</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kuhlmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roark</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rainer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Detlev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hemenway</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huhmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langridge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Connolly</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chadick</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Eckels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Agus</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tabb</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>918</fpage>
        <lpage>920</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>
        <?supplied-pmid 23051804?>
        <pub-id pub-id-type="pmid">23051804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Aird: a computation-oriented mass spectrometry data format enables a higher compression ratio and less decoding time</article-title>
        <source>BMC Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04490-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kammerdiner</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Very large-scale neighborhood search for the multidimensional assignment problem</article-title>
        <source>Optim Methods Appl</source>
        <year>2017</year>
        <volume>130</volume>
        <fpage>251</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-68640-0_12</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crouse</surname>
            <given-names>DF</given-names>
          </name>
        </person-group>
        <article-title>On implementing 2D rectangular assignment algorithms</article-title>
        <source>IEEE Trans Aerosp Electron Syst</source>
        <year>2016</year>
        <volume>52</volume>
        <fpage>1679</fpage>
        <lpage>1696</lpage>
        <pub-id pub-id-type="doi">10.1109/TAES.2016.140952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">An S, Wang R, Lu M, Zhang C, Liu H, Wang J, Xie C, Yu C. Metapro: a web-based metabolomics application for LC–MS data batch inspection and library curation. Metabolomics 2023. 10.1007/s11306-023-02018-6</mixed-citation>
    </ref>
  </ref-list>
</back>
