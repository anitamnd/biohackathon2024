<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.3 20210610//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1-3.dtd?>
<?SourceDTD.Version 1.3?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Metabolites</journal-id>
    <journal-id journal-id-type="iso-abbrev">Metabolites</journal-id>
    <journal-id journal-id-type="publisher-id">metabolites</journal-id>
    <journal-title-group>
      <journal-title>Metabolites</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2218-1989</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9144304</article-id>
    <article-id pub-id-type="doi">10.3390/metabo12050435</article-id>
    <article-id pub-id-type="publisher-id">metabolites-12-00435</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Normalizing and Correcting Variable and Complex LC–MS Metabolomic Data with the R Package pseudoDrift</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8693-1022</contrib-id>
        <name>
          <surname>Rodriguez</surname>
          <given-names>Jonas</given-names>
        </name>
        <xref rid="af1-metabolites-12-00435" ref-type="aff">1</xref>
        <xref rid="c1-metabolites-12-00435" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gomez-Cano</surname>
          <given-names>Lina</given-names>
        </name>
        <xref rid="af2-metabolites-12-00435" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4720-7290</contrib-id>
        <name>
          <surname>Grotewold</surname>
          <given-names>Erich</given-names>
        </name>
        <xref rid="af2-metabolites-12-00435" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Leon</surname>
          <given-names>Natalia</given-names>
        </name>
        <xref rid="af1-metabolites-12-00435" ref-type="aff">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Comte</surname>
          <given-names>Gilles</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-metabolites-12-00435"><label>1</label>Department of Agronomy, University of Wisconsin-Madison, Madison, WI 53706, USA; <email>ndeleongatti@wisc.edu</email></aff>
    <aff id="af2-metabolites-12-00435"><label>2</label>Department of Biochemistry and Molecular Biology, Michigan State University, East Lansing, MI 48824, USA; <email>gomezca5@msu.edu</email> (L.G.-C.); <email>grotewol@msu.edu</email> (E.G.)</aff>
    <author-notes>
      <corresp id="c1-metabolites-12-00435"><label>*</label>Correspondence: <email>jorod550@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <issue>5</issue>
    <elocation-id>435</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 by the authors.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In biological research domains, liquid chromatography–mass spectroscopy (LC-MS) has prevailed as the preferred technique for generating high quality metabolomic data. However, even with advanced instrumentation and established data acquisition protocols, technical errors are still routinely encountered and can pose a significant challenge to unveiling biologically relevant information. In large-scale studies, signal drift and batch effects are how technical errors are most commonly manifested. We developed pseudoDrift, an R package with capabilities for data simulation and outlier detection, and a new training and testing approach that is implemented to capture and to optionally correct for technical errors in LC–MS metabolomic data. Using data simulation, we demonstrate here that our approach performs equally as well as existing methods and offers increased flexibility to the researcher. As part of our study, we generated a targeted LC–MS dataset that profiled 33 phenolic compounds from seedling stem tissue in 602 genetically diverse non-transgenic maize inbred lines. This dataset provides a unique opportunity to investigate the dynamics of specialized metabolism in plants.</p>
    </abstract>
    <kwd-group>
      <kwd>maize</kwd>
      <kwd>metabolomics</kwd>
      <kwd>LC–MS</kwd>
      <kwd>signal drift</kwd>
      <kwd>data normalization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>National Science Foundation</funding-source>
        <award-id>1733633</award-id>
      </award-group>
      <award-group>
        <funding-source>University of Wisconsin-Madison SciMed GRS fellowship</funding-source>
      </award-group>
      <award-group>
        <funding-source>Graduate School, part of the Office of Vice Chancellor for Research and Graduate Education at the University of Wisconsin-Madison</funding-source>
      </award-group>
      <award-group>
        <funding-source>Wisconsin Alumni Research Foundation</funding-source>
      </award-group>
      <award-group>
        <funding-source>Michigan State University under the Training Program in Plant Biotechnology for Health and Sustainability</funding-source>
        <award-id>T32-GM110523</award-id>
      </award-group>
      <funding-statement>This work was supported by the National Science Foundation under Grant No. 1733633. J.R. was supported by a University of Wisconsin-Madison SciMed GRS fellowship. Support for this fellowship is provided by the Graduate School, part of the Office of Vice Chancellor for Research and Graduate Education at the University of Wisconsin-Madison, with funding from the Wisconsin Alumni Research Foundation. L.G.-C. was supported by a fellowship from Michigan State University under the Training Program in Plant Biotechnology for Health and Sustainability (T32-GM110523).</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-metabolites-12-00435">
    <title>1. Introduction</title>
    <p>Metabolomics concerns the study of small molecular compounds or metabolites (&lt;1500 Da) and is essential for advancements in metabolism research in biological systems [<xref rid="B1-metabolites-12-00435" ref-type="bibr">1</xref>]. The metabolome is influenced by complex interactions between the genome, proteome, and transcriptome with the environment [<xref rid="B2-metabolites-12-00435" ref-type="bibr">2</xref>], and evoking changes to the metabolome and the associated effects on metabolic pathways has direct applications to pharmacology, drug development, and improvements to plant productivity, composition, and resilience [<xref rid="B3-metabolites-12-00435" ref-type="bibr">3</xref>,<xref rid="B4-metabolites-12-00435" ref-type="bibr">4</xref>]. Maize is among the most productive and economically important crops, with an annual production of over 700 million metric tons globally [<xref rid="B5-metabolites-12-00435" ref-type="bibr">5</xref>]. Many tools and technologies have facilitated previous maize improvement efforts, and future improvements will benefit from metabolomics-based research [<xref rid="B6-metabolites-12-00435" ref-type="bibr">6</xref>]. In particular, valuable insights are likely to come from larger scale metabolomic experiments and evaluations.</p>
    <p>A metabolomic analysis involves identifying and/or quantifying many metabolites simultaneously either by targeted (metabolite identity known) or untargeted (metabolite identity unknown) methods [<xref rid="B1-metabolites-12-00435" ref-type="bibr">1</xref>]. Liquid chromatography coupled with tandem mass spectrometry (LC–MS) is currently the dominant technique used in biological research due to its high sensitivity and selectivity [<xref rid="B7-metabolites-12-00435" ref-type="bibr">7</xref>,<xref rid="B8-metabolites-12-00435" ref-type="bibr">8</xref>]. However, metabolic profiles from extracts obtained from genetically identical individuals, or even from the same biological sample can have significant variability, the sources of which can be traced to extraction efficiency, changes in the injection volume, inlet interference contamination, column contamination (due to the complex matrices), or drift in ionization efficiency [<xref rid="B8-metabolites-12-00435" ref-type="bibr">8</xref>]. Despite taking appropriate actions during the data acquisition phase to minimize unwanted sources of variation, obtaining repeatable measurements across different instruments, and even on the same instrument, remains a challenging task. Furthermore, these challenges can be compounded in large-scale studies where LC–MS runs are often split into several analytical batches, each potentially containing a unique combination of technical variability [<xref rid="B9-metabolites-12-00435" ref-type="bibr">9</xref>].</p>
    <p>Combining data across batches in large-scale studies is imperative for increasing the statistical power of downstream analyses and interpretation. Therefore, several strategies have emerged to capture and correct for systematic errors in metabolomics data [<xref rid="B10-metabolites-12-00435" ref-type="bibr">10</xref>]. The most robust methods rely on regularly interspersed quality control (QC) samples included within and between batches [<xref rid="B11-metabolites-12-00435" ref-type="bibr">11</xref>], which are meant to capture temporal signal drift trends and detect any additional technical errors. QC data points can then be used to apply a computationally efficient correction to the entire dataset, for instance, with a QC-Robust Spline Correction (QC-RSC) [<xref rid="B12-metabolites-12-00435" ref-type="bibr">12</xref>]. However, there is no universally applicable approach to predetermine QC sample composition or the frequency at which QC samples should be included along the LC–MS run sequence; these are typically influenced by practical and experiment-specific considerations. While a high frequency of QC sample inclusion may be useful for thoroughly capturing systematic errors, these samples occupy LC–MS run slots that might otherwise be allocated to experimental samples, increasing the size of the experiment and subsequently increasing the opportunity for error. To this end, non-QC-based correction approaches have been attempted [<xref rid="B8-metabolites-12-00435" ref-type="bibr">8</xref>,<xref rid="B13-metabolites-12-00435" ref-type="bibr">13</xref>,<xref rid="B14-metabolites-12-00435" ref-type="bibr">14</xref>]. However, the benefits from increased experimental throughput come at the expense of a potentially reduced ability to detect and correct for systematic errors.</p>
    <p>Here, we present pseudoDrift, a new R package that combines the beneficial aspects of QC- and non-QC-based technical error correction methods. pseudoDrift relies on a training and testing procedure to estimate non-observed QC data points (pseudoQC) from metabolomics data with partial QC (trueQC) representation. pseudoDrift is not a correction method per se, but rather offers a strategy for estimating pseudoQC reference points that can be used to make data corrections using other already existing methods. By default, pseudoDrift uses the QC-RSC correction method [<xref rid="B12-metabolites-12-00435" ref-type="bibr">12</xref>]. However, the non-adjusted data containing pseudoQC estimations are also returned and can be exported if alternative correction methods are preferred by the user. Additional functionality of pseudoDrift comes in the form of simulation and outlier detection capabilities. Compared to currently available LC–MS simulation tools [<xref rid="B15-metabolites-12-00435" ref-type="bibr">15</xref>,<xref rid="B16-metabolites-12-00435" ref-type="bibr">16</xref>,<xref rid="B17-metabolites-12-00435" ref-type="bibr">17</xref>,<xref rid="B18-metabolites-12-00435" ref-type="bibr">18</xref>], which aim to simulate raw data that need to subsequently be processed before generating manipulatable peak matrices, pseudoDrift allows for direct simulation of peak matrices based on metadata gathered from online databases such as the MassBank of North America [<xref rid="B19-metabolites-12-00435" ref-type="bibr">19</xref>]. The outlier detection method implemented in pseudoDrift relies on absolute differences between sample replicates to generate an expected tailed distribution, which is used to identify potential outliers. The pseudoDrift package is publicly available at <uri xlink:href="https://github.com/jrod55/pseudoDrift">https://github.com/jrod55/pseudoDrift</uri> (accessed on 11 April 2022). In this study, the main objectives were to demonstrate the utility of pseudoDrift using simulated data and to apply the workflow to a newly generated large-scale maize seedling LC–MS phenolic profiling dataset. Although the metabolites extracted and analyzed were from maize, the development and assessment of this tool are applicable to any specific organism. We selected maize because of its importance as a crop and the availability of a well-studied diversity panel [<xref rid="B20-metabolites-12-00435" ref-type="bibr">20</xref>,<xref rid="B21-metabolites-12-00435" ref-type="bibr">21</xref>].</p>
  </sec>
  <sec sec-type="results" id="sec2-metabolites-12-00435">
    <title>2. Results and Discussion</title>
    <sec id="sec2dot1-metabolites-12-00435">
      <title>2.1. Simulating Data with pseudoDrift</title>
      <p>To compare each of the analysis workflow functions from pseudoDrift with existing approaches, we used data produced with the ‘simulate_data()’ function, assuming three batches with sample sizes of 100, 200, and 300, respectively (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S1</xref>). We set the QC frequency to have each 25th sample represent a trueQC, and used the default effect severity settings (slope and batch magnitude set to 1.25). The simulated data corresponded to the phenolic compound tricin, which we queried using the MoNA [<xref rid="B19-metabolites-12-00435" ref-type="bibr">19</xref>] accession ID FIO00738. From the simulated data output, we retained the type 4 signal drift effect data for analysis, and as a control, the data without any signal drift effects (see Materials and Methods). As a reference, and to depict the inputs and outputs of ‘simulate_data()’, we included a visual representation of a simple example of three batches that we did not use in our analysis (<xref rid="metabolites-12-00435-f001" ref-type="fig">Figure 1</xref>).</p>
    </sec>
    <sec id="sec2dot2-metabolites-12-00435">
      <title>2.2. Performance Evaluation of the pseudoDrift Analysis Workflow</title>
      <p>For outlier detection, we compared ‘pw_outlier()’ to the commonly used 1.5*Interquartile Range (IQR) method, and a formal statistical testing approach with an iterative evaluation of the Grubbs test statistic [<xref rid="B22-metabolites-12-00435" ref-type="bibr">22</xref>] with a 0.05 type 1 error rate. With ‘pw_outlier‘, we used the default 0.95 quantile threshold (<xref rid="metabolites-12-00435-f002" ref-type="fig">Figure 2</xref>), and we observed the expected tailed distribution in each batch of the simulated data (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S2</xref>).</p>
      <p>Between outlier detection methods tested, ‘pw_outlier()’ identified a total of 24 potential outliers, IQR detected 7, and the iterative Grubbs test identified a single point (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S3</xref>). Although ‘pw_outlier()’ detected the largest number of possible outliers, they were not all necessarily at the extremes of the peak area distribution. The distinguishing feature of ‘pw_outlier()’, compared to the two conventional outlier detection methods tested, was that it accounted for the experimental unit (set of three observations) as opposed to treating the distribution of all observations as a whole. This was particularly relevant given that extreme observations, when consistent between replicate measures, could represent biological anomalies that may warrant further investigation. Treating all samples as a whole and basing outlier detection on their distribution would not necessarily have captured the within experimental unit variability as ‘pw_outlier()’ did. A noteworthy characteristic of ‘pw_outlier()’ is that the number of potential outliers returned will always be a function of the quantile threshold set. In our simulated data, the 24 potential outliers represented 5% (1-quantile threshold) of non-QC observations from each batch. Therefore, the user should take this into consideration when applying ‘pw_outlier()’ and interpreting the results.</p>
      <p>We assessed the performance of ‘pseudo_sdc()’ by using the simulated data batch with the largest sample size as the training batch and then comparing the coefficient of determination (R<sup>2</sup>) and root mean squared error (RMSE) from 10-fold cross-validation between signal drift corrected data and the control. Here, the comparison we made was between using either pseudoQC or trueQC samples to correct for signal drift with the QC-RSC [<xref rid="B12-metabolites-12-00435" ref-type="bibr">12</xref>] method. As a reference, we included a visual representation of parameters optimized by ‘pseudo_sdc()’ and an example of how the process was carried out (<xref rid="metabolites-12-00435-f003" ref-type="fig">Figure 3</xref>).</p>
      <p>Gauging the performance of ‘pseudo_sdc()’ solely on its ability to reduce the variability among the simulated trueQC samples would have underestimated the ability of pseudoQC samples to capture and correct for signal drift (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S4</xref>). However, the benefit of using simulated data was that each observation effectively served as a QC sample since we knew the originally simulated value. Regressing the signal drift corrected data on the originally simulated values, we found that using pseudoQCs to correct the data resulted in a correction (R<sup>2</sup> = 0.7404; RMSE = 3810) which was on par with the performance of a trueQC-based correction (R<sup>2</sup> = 0.7499; RMSE = 3744) (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S5</xref>). Our data-driven approach, which took advantage of the data variability while training a model on trueQCs as anchors in the training batch, also reduced systematic bias in how the signal drift correction was applied. The trueQC correction more effectively corrected a portion of batch 3 in the simulated data compared to other batches (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S5</xref>), whereas the pseudoQC correction appeared to have an equal performance across batches (<xref rid="app1-metabolites-12-00435" ref-type="app">Figure S5</xref>). The bias reduction with the pseudoQC correction was likely due to the differences between how trueQC and pseudoQC samples captured the signal drift trend. The trueQC samples were independent of the data as a whole and were able to capture sharp changes in signal drift, while pseudoQC provided a more general representation of the trend and captured more subtle signal drift patterns with information from the data variability.</p>
    </sec>
    <sec id="sec2dot3-metabolites-12-00435">
      <title>2.3. Maize LC–MS Phenolic Data Analysis with pseudoDrift</title>
      <p>Prior to applying the pseudoDrift analysis workflow to the normalized maize LC–MS dataset consisting of peak areas for 33 phenolic compounds (<xref rid="app1-metabolites-12-00435" ref-type="app">Table S1</xref>), we identified five compounds (apigenidin, dihydrokaempferol, luteolin 7-<italic toggle="yes">O</italic>-glucoside, syringic acid, and syringol) with limits of detection (LOD) threshold values greater than 25% of all experimental samples across sub-batches. The LOD for each compound varied by sub-batch (<xref rid="app1-metabolites-12-00435" ref-type="app">Table S1</xref>), and, therefore, so did the proportion of experimental samples above the LOD. To avoid a large proportion of missing data for apigenidin, dihydrokaempferol, luteolin 7-<italic toggle="yes">O</italic>-glucoside, syringic acid, and syringol, they were completely excluded from downstream analyses. The remaining compounds were independently analyzed with the ‘pw_outlier()’ function with default arguments. This identified the top 5% of observations per batch as possible outliers. Importantly, with the conservative action of omitting all observations identified with ‘pw_outlier()’, no single inbred line was removed completely from the data. The ‘pw_outlier()’ cleaned data were subsequently processed with ‘pseudo_sdc()’ with batch 4 used as the training batch. The optimal parameters to estimate pseudoQC samples were determined for each compound (<xref rid="app1-metabolites-12-00435" ref-type="app">Table S2</xref>) and used to apply the signal drift correction across batches (<xref rid="app1-metabolites-12-00435" ref-type="app">File S2</xref>). Each compound had distinct signal drift patterns, although the batch-to-batch effect was substantially more pronounced for some compounds. For example, caffeic acid and 4-chlorogenic acid in batch 2 were considerably lower than in other batches (<xref rid="app1-metabolites-12-00435" ref-type="app">File S2</xref>). However, since ‘pseudo_sdc()’ calculated pseudoQC samples based on quantiles determined in the training batch, we were able to capture this batch-to-batch effect along with the signal drift trends.</p>
      <p>With existing QC-based signal drift and batch correction methods such as QC-RSC [<xref rid="B12-metabolites-12-00435" ref-type="bibr">12</xref>], we would have been restricted to analyzing the data from batch 4 alone since it was the sole batch with trueQC samples represented (<xref rid="metabolites-12-00435-t001" ref-type="table">Table 1</xref>). Compared to the two non-QC-based methods tested, combatting batch effects (ComBat) [<xref rid="B23-metabolites-12-00435" ref-type="bibr">23</xref>,<xref rid="B24-metabolites-12-00435" ref-type="bibr">24</xref>] and batch effect removal (ber) [<xref rid="B25-metabolites-12-00435" ref-type="bibr">25</xref>], pseudoDrift substantially reduced the maximum distance between any two trueQC points when plotted along the first and second principal components (PCs) (<xref rid="metabolites-12-00435-f004" ref-type="fig">Figure 4</xref>). Thus, suggesting an overall improved correction across compounds.</p>
      <p>Independently, even for compounds with severe batch-to-batch effects, such as caffeic acid and 4-chlorogenic acid (<xref rid="app1-metabolites-12-00435" ref-type="app">File S2</xref>), there were no major differences in the inter-batch corrections between pseudoDrift and the ComBat and ber methods (<xref rid="metabolites-12-00435-f005" ref-type="fig">Figure 5</xref>). However, as demonstrated by a flatter line among trueQC points in batch 4, pseudoDrift performed best at simultaneously correcting for intra-batch signal drift effects as well. Together, these results highlight the improvements to signal drift and batch corrections, which pseudoDrift achieved by coalescing QC and non-QC approaches into a new correction method.</p>
    </sec>
  </sec>
  <sec id="sec3-metabolites-12-00435">
    <title>3. Materials and Methods</title>
    <sec id="sec3dot1-metabolites-12-00435">
      <title>3.1. Plant Material and Experimental Design</title>
      <p>We grew a set of 602 genetically diverse maize inbred lines in a controlled environment room under high-intensity light emitting diode (LED) lights at the Wisconsin Crop Innovation Center. Our experiment consisted of a completely randomized design (CRD), with three replications per inbred line, with independent randomization applied per set of 602 lines. We recorded instances where seeds failed to germinate in any of the first three replicates and re-planted these in a fourth replication. In all replications, we sowed seeds into 32-cell flats and hand watered them every other day for the first 7 days. On the 8th day, we transitioned to a daily watering with an automated flood fertigation watering system, which was programmed to submerge the 32-cell flats for 5 min per day. A total of 21 days passed from planting to harvest. During the growing period, we maintained the temperature at 28 °C and artificially controlled the photoperiod by supplying 16 h of light followed by 8 h of darkness. At harvest, we used 15 mL conical Falcon tubes to collect the basal 6 cm of seedling stem tissue and immediately placed samples into liquid nitrogen prior to lyophilizing.</p>
    </sec>
    <sec id="sec3dot2-metabolites-12-00435">
      <title>3.2. Reagents for Stock and Working Solutions</title>
      <p>We procured the reagents used in this study from Sigma-Aldrich (Burlington, MA, USA) Cayman Chemical (Ann Arbor, MI, USA), Indofine chemical (Hillsborough, NJ, USA), and ChromaDex (Irvine, CA, USA) except apimaysin, maysin, and rhamnosylisoorientin, which were provided by Michael McMullen (USDA-ARS) and Maurice Snook (Iowa State University), and when performing dilutions, we used ultrapure (&gt;18 Ω) water generated through a Milli-Q system. The metabolites we profiled included 33 phenolic compounds with available chemical standards (<xref rid="app1-metabolites-12-00435" ref-type="app">Table S1</xref>). For each compound, we prepared 1 mM stock solutions by reconstituting them in 80% (<italic toggle="yes">v</italic>/<italic toggle="yes">v</italic>) HPLC grade methanol or 100% dimethyl sulfoxide (DMSO). We prepared a pooled mixture containing all 33 standards, each at 1 μM, and through serial dilution produced samples with concentrations between 1000 nM and 1.7 nM that we used as external standards. Following the same procedure, but with a final concentration of 50 nM, we prepared an internal standard (8-prenylnaringenin). For sample preparation, we used an extraction solvent consisting of 80% (<italic toggle="yes">v</italic>/<italic toggle="yes">v</italic>) HPLC grade methanol and 0.1% (<italic toggle="yes">v</italic>/<italic toggle="yes">v</italic>) formic acid.</p>
    </sec>
    <sec id="sec3dot3-metabolites-12-00435">
      <title>3.3. Preparation of Stem Tissue Extracts and QC Samples</title>
      <p>The sample preparation occurred in four separate batches, each including a different number of experimental samples (<xref rid="metabolites-12-00435-t001" ref-type="table">Table 1</xref>). Batch 1 was the smallest with 165 samples, followed by batch 2 with 198 samples, batch 3 with 663 samples, and batch 4 with 1008 samples. We homogenized the maize seedling stems using liquid nitrogen and PVC tubes containing a metal bead which a paint shaker (5G-HD Harbil 5-Gallon Shaker model 37600) agitated for 2 min at 60 Hz. To avoid cross-contamination, we washed the PVC tubes and metal beads with distilled water and soap between samples. We then transferred a ~50 mg subset of the homogenized plant material to a 2 mL Eppendorf tube and combined it with the extraction solvent. Batch 4 included the 8-prenylnaringenin internal standard, which was added at the same time that we combined the extraction solvent and the plant material. Our extraction protocol consisted of a 12 h incubation at 4 °C, followed by reconstitution by vortexing for 20 s, centrifugation for 5 min at 15,000× <italic toggle="yes">g</italic> at room temperature, and recovery of the supernatant for analysis by LC–MS. We prepared a QC sample from 100 randomly selected samples and included it in the analysis for batch 4 alone.</p>
    </sec>
    <sec id="sec3dot4-metabolites-12-00435">
      <title>3.4. LC–MS Data Acquisition</title>
      <p>The instrument used for data acquisition was a Waters ACQUITY TQD Tandem Quadrupole UPLC/MS/MS (Waters Corporation, Milford, MA, USA). We created a 10 min targeted multiple reaction monitoring (MRM) method for detecting 33 phenolic compounds (<xref rid="app1-metabolites-12-00435" ref-type="app">Table S1</xref>) and ran samples in accordance with their corresponding preparation batch. The method was based on a modification of the MRM method previously described [<xref rid="B26-metabolites-12-00435" ref-type="bibr">26</xref>] Within batches, we designated samples to sub-batches based on the preceding external standards set (<xref rid="metabolites-12-00435-f006" ref-type="fig">Figure 6</xref>). Across the four batches, we ran a total of 13 external standards sets. For each inbred maize line, we ran the three biological replicates consecutively of one another (e.g., Line 1 rep1, then Line 1 rep2, Line 1 rep 3, Line 2 rep1, etc.). While in the queue, samples and external standards remained at −10 °C in an autosampler. The instrument used a 10 μL injection volume, and the liquid chromatographic separation occurred at 30 °C using a reverse phase Waters Symmetry C18 column (4.6 × 75 mm; 3 μm) with a Symmetry C18 prep-column (3.9 × 20 mm; 5 μm) (Waters Corporation, Milford, MA, USA). We integrated peak areas for all compounds using MassLynx (v 4.2) with vendor-specific data files (.raw) to produce the raw peak area matrix.</p>
    </sec>
    <sec id="sec3dot5-metabolites-12-00435">
      <title>3.5. PseudoDrift Workflow</title>
      <p>The pseudoDrift R package consisted of three main functions, including ‘simulate_data()’, ‘pw_outlier()’, and ‘pseudo_sdc()’. We wrote these functions to run independently of one another, although here we defined the analysis workflow as applying the ‘pw_outlier()’, and ‘pseudo_sdc()’ functions in sequential order.</p>
      <p>We wrote the ‘simulate_data()’ function to accept a structure-data file (SDF) as input, such as those obtained from the MassBank of North America (MoNA) [<xref rid="B19-metabolites-12-00435" ref-type="bibr">19</xref>], and to return the queried compound metadata as output, along with a simulated peak area matrix, and four distinct signal drift and batch effect types applied to the simulated data. The simulated peak area patterns among QC samples were used to define the four effect types. A monotonic increase or decrease was characteristic of a type 1 effect, a type 2 effect described changes in magnitude occurring between batches, a type 3 effect was random, and a type 4 effect consisted of a combination of type 1 and type 2 effects and represented what is most commonly encountered in metabolomics datasets. To provide user flexibility and ensure reproducible simulation results, we included arguments for seed setting, QC frequency, batch size, and effect type severity.</p>
      <p>The first analysis function we developed was ‘pw_outlier()’, which served as an outlier detection method to accommodate common features of metabolomic data, including skewed distributions and limited biological or technical replication. Our approach relied on assessing pairwise absolute differences within and between replicate measures of samples. To illustrate, we considered a hypothetical metabolite or feature and a single sample with three biological replicates. The ‘pw_outlier()’ function computed the pairwise differences between replicates as |rep1-rep2|, |rep1-rep3|, and |rep2-rep3| and then extended this computation to each sample within a given batch. This generated a distribution of pairwise differences, which we assumed to be positively skewed with observations at the upper tail representing potential outliers. The default threshold, which we set for ‘pw_outlier‘ to use, was the 0.95 quantile of all sample pairwise differences in a batch. We included arguments allowing the user to have flexibility over the quantile threshold and grouping factor used for calculations.</p>
      <p>We developed the second analysis function, ‘pseudo_sdc()’, to work with a variable representation of trueQC samples across batches. Using data corresponding to the batch where trueQC samples were most represented, or the batch designated as the training batch, ‘pseudo_sdc()’ optimized four parameters that were used to calculate pseudoQC points that effectively captured the signal drift pattern in the training batch. To effectively capture signal drift in this context meant to minimize the criterion set by the user, which, by default, we set to use the mean squared error (MSE) between the trueQC samples and the estimated pseudoQC points in the training batch. The four parameters, which ‘pseudo_sdc()’ optimized, concerned the range of values used in the calculation (quantile.increment), the number of equally sized breaks to divide the batch into (test.breaks), the window size to calculate a rolling median over (test.window), and the positional offset (test.index) of pseudoQCs, relative to test.window. With the optimized parameters from the training batch, ‘pseudo_sdc()’ applied the same parameters to the remaining batches to estimate the pseudoQC points from the data variability. We integrated the QC-RSC [<xref rid="B12-metabolites-12-00435" ref-type="bibr">12</xref>] method into ‘pseudo_sdc()’ with an auxiliary function from the pmp R package [<xref rid="B27-metabolites-12-00435" ref-type="bibr">27</xref>] to perform the data correction with pseudoQC samples in lieu of the trueQC samples.</p>
      <p>To illustrate the functionality of pseudoDrift, we included a tutorial (<xref rid="app1-metabolites-12-00435" ref-type="app">File S1</xref>), where we walked through each of the analysis functions of pseudoDrift. In the tutorial, we used several additional R packages, including ChemmineR [<xref rid="B28-metabolites-12-00435" ref-type="bibr">28</xref>] for SDF file indexing, ggpubr [<xref rid="B29-metabolites-12-00435" ref-type="bibr">29</xref>] and cowplot [<xref rid="B30-metabolites-12-00435" ref-type="bibr">30</xref>] for plotting, data.table [<xref rid="B31-metabolites-12-00435" ref-type="bibr">31</xref>] and tidyverse [<xref rid="B32-metabolites-12-00435" ref-type="bibr">32</xref>] for data manipulation, and caret [<xref rid="B33-metabolites-12-00435" ref-type="bibr">33</xref>] for regression modeling.</p>
    </sec>
    <sec id="sec3dot6-metabolites-12-00435">
      <title>3.6. LC–MS Data Normalization and Processing with pseudoDrift</title>
      <p>We set the limits of detection (LOD) for each phenolic compound as three times the peak area of the blank (extraction solvent alone) and established the thresholds on a per compound and sub-batch basis, with the blank reference value for each compound calculated as the mean peak area across blank samples within the corresponding sub-batch. If cumulatively across sub-batches more than 25% of samples were below the respective compound LOD thresholds, we removed the compounds from the data matrix and completely excluded them from the downstream analyses. Rather than using absolute values, we opted for relative peak area values to ensure compounds were uniformly analyzed, including those that accumulated at high levels in maize stem tissues (outside the upper range of external standards). We normalized the data by the weight of each sample to provide arbitrary units of area (AUA) and removed blanks and external standards from the data matrix prior to analyzing with the pseudoDrift workflow. When applying the analysis workflow, we processed one compound at a time, first with ‘pw_outlier()’, then with ‘pseudo_sdc()’ using batch 4 as the training batch to estimate pseudoQC samples across all batches, and to correct for signal drift and batch effects in the data. We tested two additional non-QC correction methods, specifically the ComBat [<xref rid="B23-metabolites-12-00435" ref-type="bibr">23</xref>,<xref rid="B24-metabolites-12-00435" ref-type="bibr">24</xref>] and ber [<xref rid="B25-metabolites-12-00435" ref-type="bibr">25</xref>] methods implemented in the dbnorm R package [<xref rid="B14-metabolites-12-00435" ref-type="bibr">14</xref>], and compared the data corrections based on the maximum distance of trueQC points (maxDist) along the first two PCs calculated from the full peak area matrix. A smaller maxDist indicated trueQC samples had less variability, and thus, a better correction of technical errors.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4-metabolites-12-00435">
    <title>4. Conclusions</title>
    <p>The number and impact of MS-based metabolomics studies in the biological sciences are likely to rise as methods improve and accessibility to instrumentation by researchers increases. This is particularly true for systems biology, which now has a plethora of complementary omics tools available to investigate previously unexplored areas of research. In metabolomics, however, there are still currently various limitations, which, if not addressed, result in abnormally noisy data. Here, we developed a simulation and analysis tool for applying statistical techniques in a training and testing framework, to calculate and correct for technical errors in a dataset and to identify potential outliers. We applied this analysis tool to maize phenolic compounds, including phenylpropanoids and flavonoids, since they play important functions in the interaction of maize with the environment and provide health benefits to humans [<xref rid="B34-metabolites-12-00435" ref-type="bibr">34</xref>,<xref rid="B35-metabolites-12-00435" ref-type="bibr">35</xref>,<xref rid="B36-metabolites-12-00435" ref-type="bibr">36</xref>]. The here-developed tool has numerous applications, such as combining datasets across studies with differing levels of trueQC sample representation, identifying irregular observations in data, and as an experiment planning resource. An advantage of pseudoDrift is that it is written in R and includes an extensive tutorial (<xref rid="app1-metabolites-12-00435" ref-type="app">File S1</xref>), which makes it accessible to all users, including those without extensive programming experience. Since pseudoDrift uses a train–test procedure, a disadvantage might come from users attempting to apply the method to estimate pseudoQC points from small training batches. To offer the greatest flexibility to users, pseudoDrift does not have any batch restrictions, but rather we include a warning to users within the software documentation in R. While the focus of our study was on a targeted LC–MS method applied to samples prepared from a very large number of maize seedlings, the methods described can be broadly applied to other metabolomics datasets, or any temporally variable data prone to technical errors.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank the Michigan State University Mass Spectrometry and Metabolomics Core Facility for technical assistance in the LC–MS data acquisition. Additionally, we thank Alexander Silva and Summer Blanco for their assistance with sample preparation and processing.</p>
  </ack>
  <fn-group>
    <fn>
      <p><bold>Publisher’s Note:</bold> MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <app-group>
    <app id="app1-metabolites-12-00435">
      <title>Supplementary Materials</title>
      <p>The following supporting information can be downloaded at: <uri xlink:href="https://www.mdpi.com/article/10.3390/metabo12050435/s1">https://www.mdpi.com/article/10.3390/metabo12050435/s1</uri>, File S1: Tutorial for pseudoDrift and accompanying supplementary figures corresponding to simulated data and analyses conducted with pseudoDrift functions. File S2: Signal drift trends for all compounds retained after data cleaning. In each plot, arbitrary units of area (AUA) are plotted against the injection order. On each page, (A) is the data before applying the signal drift and batch correction with pseudoQCs, and (B) is the plot after applying the correction. Table S1: Targeted multiple reaction monitoring (MRM) method for 33 phenolic compounds investigated in maize seedling (21-day-old) stem tissue. Included for each compound are the name, CAS Registry Number, retention time, polarity mode used during data acquisition, MS/MS (+/−) fragments, and the molecular weight. Additional columns designate the limit of detection (LOD) determined for each sub-batch. Table S2: Parameters solved for ‘pseudo_sdc()’ when applied to the maize seedling (21-day-old) data, which minimize the mean squared error between pseudoQC and trueQC samples when using batch 4 (B4) as the training batch.</p>
      <supplementary-material id="metabolites-12-00435-s001" position="float" content-type="local-data">
        <media xlink:href="metabolites-12-00435-s001.zip">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, E.G. and N.d.L.; methodology, J.R. and L.G.-C.; software, J.R.; validation, J.R.; formal analysis, J.R.; investigation, J.R. and L.G.-C.; resources, E.G. and N.d.L.; data curation, J.R.; writing—original draft preparation, J.R.; writing—review and editing, J.R., L.G.-C., E.G. and N.d.L.; visualization, J.R.; supervision, E.G. and N.d.L.; project administration, E.G. and N.d.L.; funding acquisition, E.G. and N.d.L. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Institutional Review Board Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Informed Consent Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The data underlying this study, including raw data files, intermediate and final peak area matrices are openly available through the CyVerse Data Commons at <uri xlink:href="https://doi.org/10.25739/e1bq-kh07">https://doi.org/10.25739/e1bq-kh07</uri> (accessed on 11 April 2022). The code used for normalizing and applying the pseudoDrift workflow to the maize phenolic LC–MS data is available at <uri xlink:href="https://github.com/jrod55/m_lcms">https://github.com/jrod55/m_lcms</uri> (accessed on 11 April 2022).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-metabolites-12-00435">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>L.D.</given-names>
          </name>
          <name>
            <surname>Souza</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Gerszten</surname>
            <given-names>R.E.</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>C.B.</given-names>
          </name>
        </person-group>
        <article-title>Targeted Metabolomics</article-title>
        <source>Curr. Protoc. Mol. Biol.</source>
        <year>2012</year>
        <volume>98</volume>
        <fpage>30.2.1</fpage>
        <lpage>30.2.24</lpage>
        <pub-id pub-id-type="doi">10.1002/0471142727.mb3002s98</pub-id>
        <?supplied-pmid 22470063?>
        <pub-id pub-id-type="pmid">22470063</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-metabolites-12-00435">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Saand</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Abdelaal</surname>
            <given-names>W.B.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sirohi</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Applications of Multi-Omics Technologies for Crop Improvement</article-title>
        <source>Front. Plant Sci.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1846</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2021.563953</pub-id>
        <?supplied-pmid 34539683?>
        <pub-id pub-id-type="pmid">34539683</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-metabolites-12-00435">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzoni</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kia</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Vandrovcova</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>N.W.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Genome, Transcriptome and Proteome: The Rise of Omics Data and Their Integration in Biomedical Sciences</article-title>
        <source>Brief. Bioinform.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>286</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbw114</pub-id>
        <?supplied-pmid 27881428?>
        <pub-id pub-id-type="pmid">27881428</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-metabolites-12-00435">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bohra</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Pandey</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Pandey</surname>
            <given-names>M.K.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics for Plant Improvement: Status and Prospects</article-title>
        <source>Front. Plant Sci.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1302</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2017.01302</pub-id>
        <pub-id pub-id-type="pmid">28824660</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-metabolites-12-00435">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ranum</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Peña-Rosas</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Garcia-Casal</surname>
            <given-names>M.N.</given-names>
          </name>
        </person-group>
        <article-title>Global Maize Production, Utilization, and Consumption</article-title>
        <source>Ann. N. Y. Acad. Sci.</source>
        <year>2014</year>
        <volume>1312</volume>
        <fpage>105</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="doi">10.1111/nyas.12396</pub-id>
        <pub-id pub-id-type="pmid">24650320</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-metabolites-12-00435">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medeiros</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Brotman</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>The Utility of Metabolomics as a Tool to Inform Maize Biology</article-title>
        <source>Plant Commun.</source>
        <year>2021</year>
        <volume>2</volume>
        <fpage>100187</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xplc.2021.100187</pub-id>
        <pub-id pub-id-type="pmid">34327322</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-metabolites-12-00435">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sánchez-Illana</surname>
            <given-names>Á.</given-names>
          </name>
          <name>
            <surname>Piñeiro-Ramos</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Sanjuan-Herráez</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Vento</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Quintás</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Kuligowski</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of Batch Effect Elimination Using Quality Control Replicates in LC-MS Metabolite Profiling</article-title>
        <source>Anal. Chim. Acta</source>
        <year>2018</year>
        <volume>1019</volume>
        <fpage>38</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2018.02.053</pub-id>
        <pub-id pub-id-type="pmid">29625683</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-metabolites-12-00435">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wehrens</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hageman</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>van Eeuwijk</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kooke</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Flood</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Wijnker</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Keurentjes</surname>
            <given-names>J.J.B.</given-names>
          </name>
          <name>
            <surname>Lommen</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>van Eekelen</surname>
            <given-names>H.D.L.M.</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>R.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved Batch Correction in Untargeted MS-Based Metabolomics</article-title>
        <source>Metabolomics</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>88</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-016-1015-8</pub-id>
        <pub-id pub-id-type="pmid">27073351</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-metabolites-12-00435">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuligowski</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sánchez-Illana</surname>
            <given-names>Á.</given-names>
          </name>
          <name>
            <surname>Sanjuán-Herráez</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Vento</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Quintás</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Intra-Batch Effect Correction in Liquid Chromatography-Mass Spectrometry Using Quality Control Samples and Support Vector Regression (QC-SVRC)</article-title>
        <source>Analyst</source>
        <year>2015</year>
        <volume>140</volume>
        <fpage>7810</fpage>
        <lpage>7817</lpage>
        <pub-id pub-id-type="doi">10.1039/C5AN01638J</pub-id>
        <pub-id pub-id-type="pmid">26462549</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-metabolites-12-00435">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Evaluating and Minimizing Batch Effects in Metabolomics</article-title>
        <source>Mass Spectrom. Rev.</source>
        <year>2020</year>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1002/mas.21672</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-metabolites-12-00435">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broadhurst</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Goodacre</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Reinke</surname>
            <given-names>S.N.</given-names>
          </name>
          <name>
            <surname>Kuligowski</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>I.D.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>W.B.</given-names>
          </name>
        </person-group>
        <article-title>Guidelines and Considerations for the Use of System Suitability and Quality Control Samples in Mass Spectrometry Assays Applied in Untargeted Clinical Metabolomic Studies</article-title>
        <source>Metabolomics</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>72</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-018-1367-3</pub-id>
        <?supplied-pmid 29805336?>
        <pub-id pub-id-type="pmid">29805336</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-metabolites-12-00435">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirwan</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Broadhurst</surname>
            <given-names>D.I.</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Viant</surname>
            <given-names>M.R.</given-names>
          </name>
        </person-group>
        <article-title>Characterising and Correcting Batch Variation in an Automated Direct Infusion Mass Spectrometry (DIMS) Metabolomics Workflow</article-title>
        <source>Anal. Bioanal. Chem.</source>
        <year>2013</year>
        <volume>405</volume>
        <fpage>5147</fpage>
        <lpage>5157</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-013-6856-7</pub-id>
        <?supplied-pmid 23455646?>
        <pub-id pub-id-type="pmid">23455646</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-metabolites-12-00435">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rusilowicz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Dickinson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Charlton</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>O’Keefe</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>A Batch Correction Method for Liquid Chromatography–Mass Spectrometry Data That Does Not Depend on Quality Control Samples</article-title>
        <source>Metabolomics</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-016-0972-2</pub-id>
        <pub-id pub-id-type="pmid">27069441</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-metabolites-12-00435">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bararpour</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Gilardi</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Carmeli</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sidibe</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ivanisevic</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Caputo</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Augsburger</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Grabherr</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Desvergne</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Guex</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DBnorm as an R Package for the Comparison and Selection of Appropriate Statistical Methods for Batch Effect Correction in Metabolomic Studies</article-title>
        <source>Sci. Rep.</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>5657</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-021-84824-3</pub-id>
        <?supplied-pmid 33707505?>
        <pub-id pub-id-type="pmid">33707505</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-metabolites-12-00435">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz-Trieglaff</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Pfeifer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Gröpl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>LC-MSsim – a Simulation Software for Liquid Chromatography Mass Spectrometry Data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <elocation-id>423</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-423</pub-id>
        <?supplied-pmid 18842122?>
        <pub-id pub-id-type="pmid">18842122</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-metabolites-12-00435">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kösters</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Leufken</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Leidel</surname>
            <given-names>S.A.</given-names>
          </name>
        </person-group>
        <article-title>SMITER-A Python Library for the Simulation of LC-MS/MS Experiments</article-title>
        <source>Genes</source>
        <year>2021</year>
        <volume>12</volume>
        <elocation-id>396</elocation-id>
        <pub-id pub-id-type="doi">10.3390/genes12030396</pub-id>
        <pub-id pub-id-type="pmid">33799543</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-metabolites-12-00435">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bielow</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Aiche</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>MSSimulator: Simulation of Mass Spectrometry Data</article-title>
        <source>J. Proteome Res.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>2922</fpage>
        <lpage>2929</lpage>
        <pub-id pub-id-type="doi">10.1021/pr200155f</pub-id>
        <pub-id pub-id-type="pmid">21526843</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-metabolites-12-00435">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noyce</surname>
            <given-names>A.B.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Dalgleish</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>K.C.</given-names>
          </name>
          <name>
            <surname>Okuda</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>Mspire-Simulator: LC-MS Shotgun Proteomic Simulator for Creating Realistic Gold Standard Data</article-title>
        <source>J. Proteome Res.</source>
        <year>2013</year>
        <volume>12</volume>
        <fpage>5742</fpage>
        <lpage>5749</lpage>
        <pub-id pub-id-type="doi">10.1021/pr400727e</pub-id>
        <pub-id pub-id-type="pmid">24090032</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-metabolites-12-00435">
      <label>19.</label>
      <element-citation publication-type="webpage">
        <article-title>MassBank of North America</article-title>
        <comment>Available online: <ext-link xlink:href="https://mona.fiehnlab.ucdavis.edu/" ext-link-type="uri">https://mona.fiehnlab.ucdavis.edu/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-01-08">(accessed on 8 January 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B20-metabolites-12-00435">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansey</surname>
            <given-names>C.N.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Sekhon</surname>
            <given-names>R.S.</given-names>
          </name>
          <name>
            <surname>Kaeppler</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>de Leon</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Genetic Diversity of a Maize Association Population with Restricted Phenology</article-title>
        <source>Crop Sci.</source>
        <year>2011</year>
        <volume>51</volume>
        <fpage>704</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2010.03.0178</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-metabolites-12-00435">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazaheri</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Heckwolf</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Vaillancourt</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Gage</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Burdo</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Heckwolf</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lipzen</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Kono</surname>
            <given-names>T.J.Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-Wide Association Analysis of Stalk Biomass and Anatomical Traits in Maize</article-title>
        <source>BMC Plant Biol.</source>
        <year>2019</year>
        <volume>19</volume>
        <elocation-id>45</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12870-019-1653-x</pub-id>
        <pub-id pub-id-type="pmid">30704393</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-metabolites-12-00435">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grubbs</surname>
            <given-names>F.E.</given-names>
          </name>
        </person-group>
        <article-title>Sample Criteria for Testing Outlying Observations</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1950</year>
        <volume>21</volume>
        <fpage>27</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177729885</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-metabolites-12-00435">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>W.E.</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>H.S.</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J.D.</given-names>
          </name>
        </person-group>
        <article-title>The Sva Package for Removing Batch Effects and Other Unwanted Variation in High-Throughput Experiments</article-title>
        <source>Bioinforma. Oxf. Engl.</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>882</fpage>
        <lpage>883</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id>
        <?supplied-pmid 22257669?>
        <pub-id pub-id-type="pmid">22257669</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-metabolites-12-00435">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>W.E.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Adjusting Batch Effects in Microarray Expression Data Using Empirical Bayes Methods</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id>
        <?supplied-pmid 16632515?>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="B25-metabolites-12-00435">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giordan</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A Two-Stage Procedure for the Removal of Batch Effects in Microarray Studies</article-title>
        <source>Stat. Biosci.</source>
        <year>2014</year>
        <volume>6</volume>
        <fpage>73</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1007/s12561-013-9081-1</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-metabolites-12-00435">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cocuron</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Casas</surname>
            <given-names>M.I.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Grotewold</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Alonso</surname>
            <given-names>A.P.</given-names>
          </name>
        </person-group>
        <article-title>Beyond the Wall: High-Throughput Quantification of Plant Soluble and Cell-Wall Bound Phenolics by Liquid Chromatography Tandem Mass Spectrometry</article-title>
        <source>J. Chromatogr. A</source>
        <year>2019</year>
        <volume>1589</volume>
        <fpage>93</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2018.12.059</pub-id>
        <pub-id pub-id-type="pmid">30626504</pub-id>
      </element-citation>
    </ref>
    <ref id="B27-metabolites-12-00435">
      <label>27.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Jankevics</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>R.J.M.</given-names>
          </name>
        </person-group>
        <article-title>Pmp: Peak Matrix Processing and Signal Batch Correction for Metabolomics Datasets</article-title>
        <comment>Available online: <ext-link xlink:href="https://bioconductor.org/packages/pmp/" ext-link-type="uri">https://bioconductor.org/packages/pmp/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-01-06">(accessed on 6 January 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B28-metabolites-12-00435">
      <label>28.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>Y.E.</given-names>
          </name>
          <name>
            <surname>Horan</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Backman</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Girke</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>ChemmineR: Cheminformatics Toolkit for R</article-title>
        <comment>Available online: <ext-link xlink:href="https://bioconductor.org/packages/ChemmineR/" ext-link-type="uri">https://bioconductor.org/packages/ChemmineR/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-03-24">(accessed on 24 March 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B29-metabolites-12-00435">
      <label>29.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Kassambara</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Ggpubr: “ggplot2” Based Publication Ready Plots</article-title>
        <comment>Available online: <ext-link xlink:href="https://CRAN.R-project.org/package=ggpubr" ext-link-type="uri">https://CRAN.R-project.org/package=ggpubr</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-03-24">(accessed on 24 March 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B30-metabolites-12-00435">
      <label>30.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Wilke</surname>
            <given-names>C.O.</given-names>
          </name>
        </person-group>
        <article-title>Cowplot: Streamlined Plot Theme and Plot Annotations for “Ggplot2”</article-title>
        <comment>Available online: <ext-link xlink:href="https://CRAN.R-project.org/package=cowplot" ext-link-type="uri">https://CRAN.R-project.org/package=cowplot</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-03-24">(accessed on 24 March 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B31-metabolites-12-00435">
      <label>31.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Dowle</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gorecki</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chirico</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Stetsenko</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Short</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Lianoglou</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Antonyan</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bonsch</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Parsonage</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data. Table: Extension of “Data.Frame”</article-title>
        <comment>Available online: <ext-link xlink:href="https://CRAN.R-project.org/package=data.table" ext-link-type="uri">https://CRAN.R-project.org/package=data.table</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-03-24">(accessed on 24 March 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B32-metabolites-12-00435">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Averick</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>McGowan</surname>
            <given-names>L.D.</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Grolemund</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Welcome to the Tidyverse</article-title>
        <source>J. Open Source Softw.</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>1686</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      </element-citation>
    </ref>
    <ref id="B33-metabolites-12-00435">
      <label>33.</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wing</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Keefer</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Kenkel</surname>
            <given-names>B.</given-names>
          </name>
          <collab>R Core Team</collab>
          <etal/>
        </person-group>
        <article-title>Caret: Classification and Regression Training</article-title>
        <comment>Available online: <ext-link xlink:href="https://CRAN.R-project.org/package=caret" ext-link-type="uri">https://CRAN.R-project.org/package=caret</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2022-03-24">(accessed on 24 March 2022)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B34-metabolites-12-00435">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>N.-Q.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H.-X.</given-names>
          </name>
        </person-group>
        <article-title>Contribution of Phenylpropanoid Metabolism to Plant Development and Plant–Environment Interactions</article-title>
        <source>J. Integr. Plant Biol.</source>
        <year>2021</year>
        <volume>63</volume>
        <fpage>180</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1111/jipb.13054</pub-id>
        <pub-id pub-id-type="pmid">33325112</pub-id>
      </element-citation>
    </ref>
    <ref id="B35-metabolites-12-00435">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Parihar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Grotewold</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Doseff</surname>
            <given-names>A.I.</given-names>
          </name>
        </person-group>
        <article-title>Flavonoid Dietetics: Mechanisms and Emerging Roles of Plant Nutraceuticals</article-title>
        <source>Pigments in Fruits and Vegetables: Genomics and Dietetics</source>
        <person-group person-group-type="editor">
          <name>
            <surname>Chen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <publisher-name>Springer</publisher-name>
        <publisher-loc>New York, NY, USA</publisher-loc>
        <year>2015</year>
        <fpage>93</fpage>
        <lpage>126</lpage>
        <isbn>978-1-4939-2356-4</isbn>
      </element-citation>
    </ref>
    <ref id="B36-metabolites-12-00435">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Doseff</surname>
            <given-names>A.I.</given-names>
          </name>
          <name>
            <surname>Grotewold</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Flavones: From Biosynthesis to Health Benefits</article-title>
        <source>Plants Basel Switz.</source>
        <year>2016</year>
        <volume>5</volume>
        <elocation-id>27</elocation-id>
        <pub-id pub-id-type="doi">10.3390/plants5020027</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig position="float" id="metabolites-12-00435-f001">
    <label>Figure 1</label>
    <caption>
      <p>Simulated data produced by the ‘simulate_data()’ function. For each compound queried in the user provided structure-data file (SDF), a simulated peak area matrix with arbitrary units of area (AUA) is returned, along with four additional matrices, each with a different signal drift effect type applied. SDF files are available through the MassBank of North America (MoNA). The larger points in each plot represent the simulated QC samples, and smaller points represent non-QC simulated data points.</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g001" position="float"/>
  </fig>
  <fig position="float" id="metabolites-12-00435-f002">
    <label>Figure 2</label>
    <caption>
      <p>Visual representation of the outlier detection approach implemented in the ‘pw_outlier()’ function. Given a peak area matrix for a particular compound or feature, all pairwise differences between sample replicates are computed. The distribution of these differences is expected to be positively skewed, with values surpassing a given quantile threshold (0.95% shown) marked as potential outliers.</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g002" position="float"/>
  </fig>
  <fig position="float" id="metabolites-12-00435-f003">
    <label>Figure 3</label>
    <caption>
      <p>The parameters (<bold>A</bold>–<bold>D</bold>) optimized for ‘pseudo_sdc()’ that minimize the criteria set by the user. The parameter name is given in the title of each plot, and all computations are made using arbitrary units of area (AUA). By default, the mean squared error is minimized between estimated pseudoQC and true QC samples in the training batch (<bold>E</bold>).</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g003" position="float"/>
  </fig>
  <fig position="float" id="metabolites-12-00435-f004">
    <label>Figure 4</label>
    <caption>
      <p>Comparison of different non-QC-based corrections applied to the maize LC–MS peak area matrix. The correction method and resultant peak area matrix used to calculate the first two PCs is labeled on each respective bi-plot. The maximum distance (maxDist) represents the largest distance between any two trueQC points in the bi-plot.</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g004" position="float"/>
  </fig>
  <fig position="float" id="metabolites-12-00435-f005">
    <label>Figure 5</label>
    <caption>
      <p>Batch-to-batch and intra-batch signal drift effects before and after correction with different non-QC-based corrections. Plotted are the log2 transformed arbitrary units of area (AUA) for caffeic acid (<bold>A</bold>) and 4-chlorogenic acid (<bold>B</bold>) before correction (raw data) and after correction with each labeled approach.</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g005" position="float"/>
  </fig>
  <fig position="float" id="metabolites-12-00435-f006">
    <label>Figure 6</label>
    <caption>
      <p>Experimental design, data acquisition, and data processing steps. Samples labeled as QC represent a pooled mixture from 100 randomly selected experimental samples. A representation of the LC–MS measurement sequence for each batch and sub-batch during the data acquisition phase is shown. During data processing, the depiction represents the instrument response as a function of the retention time (RT).</p>
    </caption>
    <graphic xlink:href="metabolites-12-00435-g006" position="float"/>
  </fig>
  <table-wrap position="float" id="metabolites-12-00435-t001">
    <object-id pub-id-type="pii">metabolites-12-00435-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Summary of samples per batch, type of standard included, and whether QC samples were represented or not.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Batch</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Num.<break/>Samples</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">External<break/>Standard</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Internal<break/>Standard</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">QC Samples<break/>Represented</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">B1</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">165</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">B2</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">198</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">B3</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">663</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">No</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">B4</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1008</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Yes</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
