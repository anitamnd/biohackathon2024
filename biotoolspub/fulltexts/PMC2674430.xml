<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Struct Biol</journal-id>
    <journal-title>BMC Structural Biology</journal-title>
    <issn pub-type="epub">1472-6807</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2674430</article-id>
    <article-id pub-id-type="publisher-id">1472-6807-9-15</article-id>
    <article-id pub-id-type="pmid">19296847</article-id>
    <article-id pub-id-type="doi">10.1186/1472-6807-9-15</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Structural pattern matching of nonribosomal peptides</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Caboche</surname>
          <given-names>Ségolène</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>segolene.caboche@lifl.fr</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Pupin</surname>
          <given-names>Maude</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>maude.pupin@lifl.fr</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Leclère</surname>
          <given-names>Valérie</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>valerie.leclere@univ-lille1.fr</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Jacques</surname>
          <given-names>Phillipe</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>Philippe.Jacques@polytech-lille.fr</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Kucherov</surname>
          <given-names>Gregory</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>gregory.kucherov@lifl.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Computer Science Laboratory of Lille, UMR USTL/CNRS 8022, INRIA, F59655, Villeneuve d'Ascq, France</aff>
    <aff id="I2"><label>2</label>ProBioGEM (UPRES EA 1026), University of Sciences and Technologies of Lille, F59655, Villeneuve d'Ascq, France</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>3</month>
      <year>2009</year>
    </pub-date>
    <volume>9</volume>
    <fpage>15</fpage>
    <lpage>15</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1472-6807/9/15"/>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>7</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>3</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Caboche et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Caboche et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Caboche
               S&#x000e9;gol&#x000e8;ne
               
               
               segolene.caboche@lifl.fr
            </dc:author><dc:title>
            Structural pattern matching of nonribosomal peptides
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Structural Biology 9(1): 15-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1472-6807(2009)9:1&#x0003c;15&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1472-6807</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Nonribosomal peptides (NRPs), bioactive secondary metabolites produced by many microorganisms, show a broad range of important biological activities (e.g. antibiotics, immunosuppressants, antitumor agents). NRPs are mainly composed of amino acids but their primary structure is not always linear and can contain cycles or branchings. Furthermore, there are several hundred different monomers that can be incorporated into NRPs. The N<sc>ORINE</sc> database, the first resource entirely dedicated to NRPs, currently stores more than 700 NRPs annotated with their monomeric peptide structure encoded by undirected labeled graphs. This opens a way to a systematic analysis of structural patterns occurring in NRPs. Such studies can investigate the functional role of some monomeric chains, or analyse NRPs that have been computationally predicted from the synthetase protein sequence. A basic operation in such analyses is the search for a given structural pattern in the database.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed an efficient method that allows for a quick search for a structural pattern in the N<sc>ORINE</sc> database. The method identifies all peptides containing a pattern substructure of a given size. This amounts to solving a variant of the maximum common subgraph problem on pattern and peptide graphs, which is done by computing cliques in an appropriate compatibility graph.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The method has been incorporated into the N<sc>ORINE</sc> database, available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.lifl.fr/norine"/>. Less than one second is needed to search for a pattern in the entire database.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Nonribosomal Peptides (NRPs) are bioactive compounds having various important biological functions (e.g. as antibiotics, siderophores, antitumor agents, immunosuppressants). NRPs are synthesized by large multi-enzymatic complexes called Nonribosomal Peptide Synthetases (NRPSs) that are modularly organized [<xref ref-type="bibr" rid="B1">1</xref>]. Each module is responsible for the incorporation of a specific monomer and is itself subdivided into domains catalysing specific enzymatic reactions.</p>
    <p>Until about fifteen years ago, the number of known NRPs remained relatively low. However, many new molecules have been reported in the literature during the last years, associated with different biological activities and having a broad range of potential applications. This triggered a considerable interest among the research community in the nonribosomal synthesis pathway.</p>
    <p>Among potential applications of such studies, redesigning natural products by genetic engineering of NRPSs opens an interesting new way in drug discovery [<xref ref-type="bibr" rid="B2">2</xref>]. Indeed, modifying the nucleotide sequence of a natural NRPS or combining modules of different NRPSs could potentially yield a more efficient compound or a product with a new biological activity. However, generating a new peptide with a specific function from a modified NRPS nucleic sequence requires a deep understanding of both the assembly line and the resulting products.</p>
    <p>NRPS enzymes have been well studied for several years. Stachelhaus <italic>et al</italic>. [<xref ref-type="bibr" rid="B3">3</xref>] discovered a specificity-conferring code of adenylation domains. With this discovery, several software programs have been developed [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>] to predict a produced peptide from the NRPS protein sequence. With the increasing number of sequenced genomes, the number of hypothetical NRPSs increases too. Therefore, this raises the problem of verifying whether a peptide predicted to be produced by a NRPS is already known or even corresponds to a part of a known peptide.</p>
    <p>NRP molecules show several important particularities. The first one is related to the incorporation of non-proteinogenic amino acids. Indeed, in addition to the twenty standard amino acids found in proteins, several hundreds of other residues can be encountered in final NRPS products. Incorporated residues can further undergo chemical modifications such as epimerisation or methylation. Products of other biosynthesis pathways, like lipids or carbohydrates, can also be introduced. Because of this composition diversity of NRPs, we will use the term 'monomer' rather than 'amino acid' for NRP structural units. Another interesting property of NRPs is their structure. Unlike regular proteins, the primary structure of NRPs is not always linear but can also be cyclic (partially or totally), branched or even poly-cyclic. A computational treatment of these molecules appears therefore to be very different from standard proteins and requires a development of specific computational methods and resources.</p>
    <p>There exist, however, very few computational resources specifically devoted to NRPs and, until recently, there was no one providing a complete inventory of those. To fill this lack, we have developed the N<sc>ORINE</sc> database [<xref ref-type="bibr" rid="B7">7</xref>] which is the first resource entirely dedicated to NRPs. It contains various annotations of each peptide such as the producing organism, bibliographic references, activities and, most importantly, its monomeric structure. The choice of representing NRP molecules by their monomeric rather than atomic structure reflects the way they are synthesized by successive addition of monomers. This structure is encoded by an undirected labeled graph representing its (possibly nonlinear) structure. Using undirected (rather than directed) edges is justified by the existence of nonpeptide bonds, appearing e.g. in cyclic or branched peptides, for which the orientation can not be naturally defined. Furthermore, using directed edges could be restrictive for the analysis of peptide families: for example, lipopeptides containing an asparagine-serine dipeptide include the iturin family (produced by different <italic>Bacillus </italic>species). Tsuge <italic>et al</italic>. [<xref ref-type="bibr" rid="B8">8</xref>] proposed a model in which iturin or mycosubtilin swapped nucleotide sequences encoding adenylation domains after a common ancestor became established. In this case, looking for a directed asparagine-serine dipeptide would miss mycosubtilin that has a serine-asparagine dipeptide.</p>
    <p>Similar to the search for sequence patterns in genomic and protein databases, N<sc>ORINE</sc> raises the need to efficiently search for <italic>structural </italic>patterns. In the simplest case, one needs to identify if a given peptide is already present in the database. An even more important motivation is provided by the close relation between the structure and the function of the peptide. For example, Minowa <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] identified motifs that are significantly related to some biological activities. Therefore, a search for a structural pattern can help to assign a biological function to a peptide under study.</p>
    <p>In some analyses, one needs to identify a part of the pattern, rather than the whole pattern, occurring in a given peptide. For example, the order of monomers in the resulting peptide can be changed with respect to the order of modules in the synthetase (so-called nonlinear biosynthesis [<xref ref-type="bibr" rid="B10">10</xref>]). For instance, in the biosynthesis of syringomycin [<xref ref-type="bibr" rid="B11">11</xref>], the <italic>Syr</italic>B1 gene responsible for the incorporation of the threonine monomer is located upstream of the <italic>Syr</italic>E gene in the genome, whereas threonine is the final monomer of the peptide. Therefore, a search for the entire pattern predicted from the synthetase does not produce an output, while a search for a common substructure allows one to identify the peptide.</p>
    <p>In this paper, we present an efficient method to identify a substructure of a given structural pattern that occurs in a given NRP, where both the pattern and the peptide are represented by undirected labeled graphs. From the computational viewpoint, this can be expressed as a variant of the Maximum Common Subgraph (MCS) problem, which is NP-complete [<xref ref-type="bibr" rid="B12">12</xref>] i.e. is very unlikely to be solvable by an algorithm with a running time polynomially bounded on the graph size. Another related NP-complete problem, called Graph Motif problem [<xref ref-type="bibr" rid="B13">13</xref>], is to look for a connected subgraph with the given (multi-)set of labels. Despite of the formal NP-completeness of the underlying computation, our method works very efficiently on NRP graphs, taking advantage of their relatively small size and specific structural properties.</p>
    <p>Our method is based on the commonly used construction of a Compatibility Graph (CG), also called association or product graph, in which the largest clique represents a solution to the MCS problem (see [<xref ref-type="bibr" rid="B14">14</xref>] for a review). Here we adapt the method of CG to the structural search for nonribosomal peptides. We propose several ways to reduce the size of the CG, both in terms of number of nodes and edges. Note that the size of the CG is a crucial factor for the efficiency of the whole method, as the clique search in the CG is the computationally most demanding step. We follow the idea of filtration by trying to detect, as early as possible, pairs of nodes that cannot be mapped one to the other by a graph morphism. This considerably reduces the size of the CG and leads to an efficient practical structural search for nonribosomal peptides. The presented algorithm has been implemented in N<sc>ORINE</sc>. Here we present some experimental results showing the efficiency of the method. We also provide some examples of using structural search for nonribosomal peptides in biological studies.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Theory and algorithms</title>
      <sec>
        <title>Graph representation of NRP structure</title>
        <p>We encode the monomeric structure of NRPs by an undirected labeled graph. A <italic>peptide graph </italic>is a graph <italic>G </italic>= (<italic>V</italic>, <italic>E</italic>, <italic>M</italic>, <italic>f</italic>), where <italic>V </italic>is a set of nodes, <italic>E </italic>⊆ <italic>V </italic>× <italic>V </italic>is a set of undirected edges i.e. pairs (<italic>u</italic>, <italic>v</italic>) with <italic>u</italic>, <italic>v </italic>in <italic>V</italic>, and <italic>f</italic>: <italic>V </italic>→ <italic>M </italic>a labeling mapping of nodes. Here nodes represent monomers, edges correspond to chemical bonds between monomers and labels are monomer names. Monomer names are encoded by a set of simple rules inspired by the IUPAC nomenclature [<xref ref-type="bibr" rid="B15">15</xref>]: monomers are denoted by the classical three-letter code, possibly preceded by a symbol of a chemical modification. For example, <italic>NMe-Ala </italic>represents the N-methyl-alanine monomer. Each node in a graph has a unique number in order to distinguish two nodes with the same label. Figure <xref ref-type="fig" rid="F1">1(a)</xref> shows examples of peptide graphs.</p>
        <fig position="float" id="F1">
          <label>Figure 1</label>
          <caption>
            <p><bold>Examples of peptide and pattern graphs</bold>. This figure shows examples of (a) peptide graphs and (b) pattern graphs. Nodes and edges represent monomers and chemical bonds respectively. Labels are the monomer names.</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-1"/>
        </fig>
        <p>A structural pattern is also represented by a graph. Let <italic>P </italic>= (<italic>V</italic><sub><italic>P</italic></sub>, <italic>E</italic><sub><italic>P</italic></sub>, <italic>L</italic>, <italic>f</italic>) be a pattern graph, where <italic>V</italic><sub><italic>P </italic></sub>is a set of nodes, <italic>E</italic><sub><italic>P </italic></sub>⊆ <italic>V</italic><sub><italic>P </italic></sub>× <italic>V</italic><sub><italic>P </italic></sub>a set of undirected edges and <italic>f</italic>: <italic>V</italic><sub><italic>P </italic></sub>→ <italic>L </italic>is the labeling of nodes. The main difference between graphs <italic>G </italic>and <italic>P </italic>is in the set of possible labels: <italic>M </italic>⊂ <italic>L </italic>but <italic>L </italic>contains some additional labels. One of them is the "joker label", denoted 'X', that stands for any monomer. <italic>L </italic>also includes alternative labels denoted by lists of several monomers separated by the '/' symbol. The intended meaning is that any monomer of the list can occur at the corresponding position. Finally, <italic>L </italic>also includes labels formed by the '*' symbol followed by a monomer. This means that any derivative of the monomer can be found at this position. Figure <xref ref-type="fig" rid="F1">1(b)</xref> shows some examples of structural patterns. For example, in pattern P4, <italic>*Orn </italic>means that at this position, ornithine (Orn) or any of its derivatives, such OH-Orn or Fo-OH-Orn, can be found.</p>
      </sec>
      <sec>
        <title>Computing a maximal common substructure using the compatibility graph</title>
        <p>The construction of the compatibility graph (CG) is often used in chemoinformatics to establish a structure mapping between two molecule graphs [<xref ref-type="bibr" rid="B14">14</xref>]. The CG encodes potential mappings between the two graphs. Then, a search for the largest clique in the CG allows one to obtain the maximum common subgraph. First, we describe the classical CG construction.</p>
      </sec>
      <sec>
        <title>Compatibility graph</title>
        <p>The classical definition of the CG of two graphs <italic>P </italic>and <italic>G </italic>is as follows:</p>
        <p>• the set of nodes of CG is the cartesian product <italic>V</italic><sub><italic>P </italic></sub>× <italic>V</italic>, i.e. a node <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) of CG corresponds to the association of a pattern node <italic>u </italic>and a peptide node <italic>u'</italic>; in the case of (unambigously) labeled nodes, only nodes with the same label get associated to form a node of the CG,</p>
        <p>• nodes <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) are adjacent in the CG if and only if <italic>u </italic>≠ <italic>v </italic>and <italic>u' </italic>≠ <italic>v' </italic>and one of the following conditions holds:</p>
        <p>
          <disp-formula id="bmcM1"><label>(1)</label>- <italic>u </italic>is adjacent to <italic>v </italic>in <italic>P </italic>and <italic>u' </italic>is adjacent to <italic>v' </italic>in <italic>G</italic></disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM2"><label>(2)</label>- <italic>u </italic>is not adjacent to <italic>v </italic>in <italic>P </italic>and <italic>u' </italic>is not adjacent to <italic>v' </italic>in <italic>G</italic></disp-formula>
        </p>
        <p>For our purposes, we modify the classical CG definition to only require that associated nodes have compatible labels. If <italic>f </italic>(<italic>u</italic>) ∈ <italic>M </italic>(i.e. the label of <italic>u </italic>is not 'X' nor a "*-label" monomer), then any peptide node <italic>u' </italic>with <italic>f </italic>(<italic>u'</italic>) = <italic>f </italic>(<italic>u</italic>) gets associated with <italic>u</italic>. If <italic>f </italic>(<italic>u</italic>) = 'X', then <italic>u </italic>gets associated with any node <italic>u' </italic>of <italic>G</italic>. Finally, if <italic>f </italic>(<italic>u</italic>) is a "*-label", then <italic>u </italic>naturally gets associated with any node <italic>u' </italic>labeled by a derivative of the corresponding monomer.</p>
        <p>Figure <xref ref-type="fig" rid="F2">2</xref> shows a simple example of CG of a pattern and a peptide graph. Edges between nodes 'a' and 'b' and nodes 'b' and 'c' correspond to condition (1). The edge between nodes 'a' and 'c' corresponds to condition (2).</p>
        <fig position="float" id="F2">
          <label>Figure 2</label>
          <caption>
            <p><bold>A simple example of compatibility graph</bold>. The Figure shows a pattern graph, a peptide graph and the corresponding CG. Each node of pattern and peptide graphs has a label (for example 'Ala') and a number that is a unique identifier of this node. Identifiers of pattern nodes are underlined in order to distinguish them from peptide nodes. A node of the CG corresponds to the association of a node of the pattern graph (underlined number) and a node of the peptide graph with the same label. Nodes of the CG are named by letters. For example, node 'a' corresponds to the association of pattern node <underline>0</underline> and peptide node 1 that have both label 'Ala'. Edges between nodes 'a' and 'b' and between nodes 'b' and 'c' in the CG correspond to condition (1). Edge between nodes 'a' and 'c' corresponds to condition (2) of the definition of CG. A clique of size 3 exists in the CG and corresponds to the occurrence of the pattern in the peptide.</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-2"/>
        </fig>
      </sec>
      <sec>
        <title>Clique computation</title>
        <p>The CG represents all potential mappings between graphs <italic>P </italic>and <italic>G</italic>. Recall that a clique in an undirected graph is a subset of nodes such that every two nodes of this subset are connected by an edge. Each clique in the CG corresponds to a common substructure of graphs <italic>P </italic>and <italic>G</italic>, whose size (number of nodes) is equal to that of the corresponding clique. Consequently, searching for a clique of a given size <italic>k </italic>(<italic>k</italic>-clique) is equivalent to searching for a common subgraph of size <italic>k</italic>. In Figure <xref ref-type="fig" rid="F2">2</xref>, nodes a, b and c form a 3-clique, which corresponds to the occurrence of the whole pattern in the peptide. The general clique detection problem i.e. finding whether there is a <italic>k</italic>-clique in a graph is NP-complete [<xref ref-type="bibr" rid="B12">12</xref>].</p>
      </sec>
      <sec>
        <title>Refining CG building rules</title>
        <p>Our goal is to detect efficiently and exactly whether a part (connected subgraph) of a size <italic>k </italic>of a pattern graph <italic>P </italic>is a substructure of a peptide graph <italic>G</italic>. We assume that parameter <italic>k </italic>is specified by the user. If <italic>k </italic>is equal to the size of the pattern graph, the problem amounts to checking if <italic>P </italic>is a substructure of <italic>G</italic>. In other words, the searched pattern <italic>P </italic>occurs in the tested peptide <italic>G</italic>. The notion of "substructure" needs to be made precise. In the above construction of CG, a clique corresponds to a common <italic>induced </italic>subgraph of both <italic>P </italic>and <italic>G </italic>(see [<xref ref-type="bibr" rid="B14">14</xref>]). In our case, we want to allow a node of <italic>G </italic>to have more incident edges than the associated node of <italic>P</italic>. For example, we want pattern P1 from Figure <xref ref-type="fig" rid="F1">1</xref> to match the peptide graph G1, although there is no edge between the first and the last node in P1 while there is one between the corresponding nodes in G1. In mathematical terms, we are looking for a subset of <italic>k </italic>nodes in <italic>P </italic>such that the corresponding induced subgraph of <italic>P </italic>is connected and occurs as a (not necessarily induced) subgraph of <italic>G</italic>. This asymmetry between <italic>P </italic>and <italic>G </italic>prevents using standard solutions for computing common substructures (see [<xref ref-type="bibr" rid="B14">14</xref>]) and raises the need to develop an efficient method appropriate for our setting. For this purpose, we modify the above solution based on clique search in the compatibility graph.</p>
        <p>We first modify the definition of compatibility graph, taking into account that if two nodes in <italic>G </italic>are connected by an edge, the associated nodes in <italic>P </italic>may or may not be connected. Since the size of the CG (both in terms of the number of nodes and edges) is the crucial factor for efficiency, we need to make sure to keep this size reduced and filter out those node associations which cannot participate in the mapping. Even prior to constructing the CG, we verify simple properties that prevent a common substructure of size <italic>k </italic>to exist. First, the size of <italic>G </italic>must be greater than or equal to <italic>k</italic>. Furthermore, at least <italic>k </italic>nodes of the pattern must be associated to some nodes of the peptide graph. Only if these two simple tests are verified, we proceed to the construction of the CG and searching for a <italic>k</italic>-clique.</p>
      </sec>
      <sec>
        <title>CG nodes</title>
        <p>In order to decrease the number of nodes in the CG, we associate a node <italic>u' </italic>of <italic>G </italic>and a node <italic>u </italic>of <italic>P </italic>only if the degree of <italic>u' </italic>is greater than or equal to the degree of <italic>u</italic>. This is justified by the above definition of common substructure of <italic>P </italic>in <italic>G</italic>.</p>
      </sec>
      <sec>
        <title>CG edges</title>
        <p>According to our definition of common substructure, we have to modify the above definition of an edge in the CG. Conditions (1) and (2) are replaced by the following:</p>
        <p>
          <disp-formula id="bmcM3"><label>(3)</label>• nodes <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) are adjacent in the CG if and only if <italic>u </italic>≠ <italic>v </italic>and <italic>u' </italic>≠ <italic>v' </italic>and <italic>u' </italic>is adjacent to <italic>v' </italic>in <italic>G provided that u </italic>is adjacent to <italic>v </italic>in <italic>P</italic></disp-formula>
        </p>
        <p>In other words, if two nodes in the pattern graph are connected, then the corresponding nodes in the peptide graph must be connected too, but the opposite is not necessarily true. With this definition we achieve that if two nodes <italic>u </italic>and <italic>v </italic>are not connected in the pattern graph <italic>P</italic>, their corresponding nodes <italic>u' </italic>and <italic>v' </italic>in the peptide graph <italic>G </italic>may or may not be connected, in both cases the corresponding nodes <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) in the CG are connected. However, this rule leads to an increase of the number of edges in the CG. Indeed, according to condition (3), the CG has an egde between <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) even if <italic>u </italic>and <italic>v </italic>are not connected in <italic>P </italic>while <italic>u' </italic>and <italic>v' </italic>are connected in <italic>G</italic>. The classical CG constructed according to conditions (1) and (2) would not include an edge in this case. We then introduce a stronger rule in order to reduce the number of edges and to make the search for a <italic>k</italic>-clique efficient. The rule is based on the computation of elementary paths.</p>
        <p>An elementary path (EP) in a graph is a path without loops. For each node in <italic>P </italic>and <italic>G</italic>, we compute the size of all EPs from this node to all the others. Since we are interested in connected subgraphs of size <italic>k</italic>, the EP size in such subgraphs is limited to <italic>k </italic>- 1 (which is the maximal number of nodes that can be visited along an EP in a graph of size <italic>k</italic>). For a graph <italic>G</italic>, we store the EP sizes in a matrix <italic>EPS</italic><sub><italic>G</italic></sub>, where the <italic>EPS</italic><sub><italic>G </italic></sub>[<italic>i</italic>, <italic>j</italic>] contains the list of all EP sizes between the nodes <italic>i </italic>and <italic>j</italic>.</p>
        <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the matrices for pattern graph P1 and peptide graph G1 from the Figure <xref ref-type="fig" rid="F1">1</xref> with <italic>k </italic>equal to the pattern size. For example, there are two EPs between nodes 1 and 4 in G1, one of size 3 (path 1 - 2 - 3 - 4) and another of size 4 (path 1 - 2 - 6 - 5 - 4). Nodes 0 and 4 are connected by two EPs of size 4 and 5, but the second one is not considered as it is greater than <italic>k </italic>- 1 (P1 has 5 nodes).</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p><bold>Matrix of elementary path sizes</bold>. This figure shows matrix of elementary path sizes for (a) P1 of Figure 1 and (b) G1 of Figure 1.</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-3"/>
        </fig>
        <p>We then define an edge between <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) in the CG if and only if the EP size list of (<italic>u</italic>, <italic>v</italic>) in <italic>P </italic>(considered as a multiset) is included in the EP size list of (<italic>u'</italic>, <italic>v'</italic>) in G. This means that the distances between two nodes in P must be included in the respective distances in G in order for an edge in the CG to exist. In other words, the monomers of the EPs beteeen <italic>u </italic>and <italic>v </italic>in <italic>P </italic>and between <italic>u' </italic>and <italic>v' </italic>in <italic>G </italic>are not directly compared but the distances of possible paths in <italic>P </italic>must be also distances of possible paths in <italic>G</italic>. This new rule decreases the number of edges in the CG without losing any information on a possible occurrence of the pattern.</p>
        <p>Figure <xref ref-type="fig" rid="F4">4</xref> shows the resulting CG of P1 and G1 built with the classical and the new CG building rules, with <italic>k </italic>= 5 (size of pattern P1). Observe that there is no edge between nodes <italic>a </italic>and <italic>l </italic>in the CG constructed with classical building rules (nodes 0 and 4 are not adjacent in <italic>P </italic>whereas nodes 4 and 3 are adjacent in <italic>G</italic>) whereas this edge exists in the CG constructed with the new building rules and implies a clique of size 5 that shows that P1 occurs in G1. In addition, the number of nodes and edges in the two CGs are different: the CG obtained with the classical building rules has 13 nodes and 22 edges whereas the CG obtained with the new building rules has 12 nodes and 19 edges. For example, in the CG obtained with the classical building rules there is an edge between nodes <italic>b</italic>(0, 6) and <italic>l</italic>(4, 3) that does not exist in the CG obtained with the new building rules. This is because the EP sizes between nodes 0 and 4 in P1 (here {4}) are not included in the EP sizes between nodes 6 and 3 in G1 (here {2, 3}). The new CG building rules exclude this kind of edges and thus decrease the overall number of edges in the CG.</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Example of compatibility graph constructed with classical and new methods</bold>. The CG of pattern graph <italic>P</italic>1 and peptide graph <italic>G</italic>1 of Figure 1 constructed with (a) classical and (b) new CG building rules. Each CG node is identified by a letter. It represents an association between a node of <italic>P</italic>1 and a node of <italic>G</italic>1 with compatible labels. For example, node 'a' associates node 0 of <italic>P</italic>1 and node 4 of <italic>G</italic>1 that both carry the 'D-Tyr' label. Dashed edges correspond to the edges that differ between the two CGs and the bold edges correspond to a clique of size 5 (size of <italic>P</italic>1).</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-4"/>
        </fig>
      </sec>
      <sec>
        <title>New CG building rules: summary</title>
        <p>We conclude this section by summarizing the CG building rules for a pattern graph <italic>P </italic>and a peptide graph <italic>G</italic>:</p>
        <p>
                  • each CG node <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) corresponds to the association of a node <italic>u </italic>of <italic>P </italic>and a node <italic>u' </italic>of <italic>G </italic>such that <italic>deg</italic>(<italic>u</italic>) ≤ <italic>deg</italic>(<italic>u'</italic>) and <italic>f </italic>(<italic>u</italic>) is compatible with <italic>f </italic>(<italic>u'</italic>).  (4)
               </p>
        <p>
                  • two nodes <italic>U </italic>(<italic>u</italic>, <italic>u'</italic>) and <italic>V </italic>(<italic>v</italic>, <italic>v'</italic>) are adjacent in the CG if and only if <italic>u </italic>≠ <italic>v </italic>and <italic>u' </italic>≠ <italic>v' </italic>and <italic>EPS</italic><sub><italic>P </italic></sub>[<italic>u</italic>, <italic>v</italic>] ⊆ <italic>EPS</italic><sub><italic>G </italic></sub>[<italic>u'</italic>, <italic>v'</italic>]. (5)
               </p>
      </sec>
      <sec>
        <title>Search for a <italic>k</italic>-clique</title>
        <p>The presence of a <italic>k</italic>-clique in the CG implies that there is an induced subgraph of <italic>P </italic>that is a subgraph of <italic>G</italic>. In the case when <italic>k </italic>is smaller than the size of <italic>P</italic>, we have to verify, in addition, that the corresponding subgraph is connected in <italic>P </italic>(and consequently in <italic>G</italic>).</p>
        <p>To search for a <italic>k</italic>-clique, we use a branch and bound algorithm (see Chapter 6 in [<xref ref-type="bibr" rid="B16">16</xref>]). It is essentially an exhaustive algorithm that explores the depth-search tree of the graph. For a node of depth <italic>h </italic>in the tree, we try to extend the current clique of size <italic>h </italic>with a new node in order to obtain a clique of size <italic>h </italic>+ 1. The tree is pruned by not exploring the branches with the length smaller than <italic>k</italic>. Once a <italic>k</italic>-clique is found, the search terminates and the pattern occurrence is output.</p>
        <p>Another heuristic we use to speed up the clique search is based on the fact that once we identified more than (|<italic>V</italic><sub><italic>P</italic></sub>| - <italic>k</italic>) nodes of pattern that do not participate in the clique, the search for a <italic>k</italic>-clique can be stopped. In the case of search for the entire pattern (<italic>k </italic>= |<italic>V</italic><sub><italic>P</italic></sub>|), each pattern node has to contribute to the clique. For example, in Figure <xref ref-type="fig" rid="F4">4(b)</xref> with <italic>k </italic>= 5 (pattern size), node 0 of the pattern participates in two nodes <italic>a </italic>and <italic>b </italic>of the graph, which implies that one of these two nodes must belong to the clique. If a <italic>k</italic>-clique containing one of these two nodes is not found, the search is stopped. Finally, another speeding heuristics is to start the search with CG nodes that correspond to pattern nodes of maximal degree and have therefore most chances to lead to a fast detection of non-occurrence of the pattern. Applying all these heuristics leads to a practically fast and exact clique search, as confirmed by experimental results provided in the next section.</p>
      </sec>
    </sec>
    <sec>
      <title>Testing</title>
      <sec>
        <title>Case study of structural properties of NRPs</title>
        <p>We studied the distribution of patterns of size 4 in all peptides of the database. The results are shown in Figure <xref ref-type="fig" rid="F5">5(a)</xref>. They show that the most frequent 4-pattern is the linear pattern. We also computed the distribution of the number of peptide graphs depending on their size. The results are shown in Figure <xref ref-type="fig" rid="F5">5(b)</xref>. More than 70% of peptides have at least seven monomers. This means that a search for a pattern containing seven 'X' labels triggers the construction of the CG for more than 70% of peptides of the N<sc>ORINE</sc> database.</p>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>Structural properties of NRPs contained in N<sc>ORINE</sc></bold>. Distribution of (a) 4-patterns and (b) peptide sizes in the N<sc>ORINE</sc> database.</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-5"/>
        </fig>
      </sec>
      <sec>
        <title>Efficiency of the method</title>
        <p>In order to test the efficiency of our method, we compared the number of nodes and edges in the CGs obtained with the classical and the new building rules on different examples in the case of search for an entire pattern. The results are shown in Table <xref ref-type="table" rid="T1">1</xref>. In the case of matching P3 against G2, the CG constructed with modified rules has no edges because the EP sizes of the pattern are not included in the corresponding EP sizes of the peptide graph. Indeed, P3 is cyclic and each pair of nodes is connected by two EPs whereas G2 is linear and there is only one EP for each pair of nodes. Therefore, our method outputs the answer without looking for a clique. In the last example corresponding to the linear pattern of 19 'X' against alamethicin F50, the difference in the number of nodes (346 against 380) is due to the additional condition on the degree of associated nodes. Moreover, in this example, our version of CG has about 13 times less edges than the CG constructed with the classical rules. These examples illustrate that our method produces a compact compatibility graph, suitable for an efficient clique search.</p>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>Number of nodes and edges of the CG constructed with classical and new building rules</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td align="center">pattern</td>
                <td align="center">peptide</td>
                <td align="center"># CG nodes</td>
                <td align="center"># CG edges</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center">P1</td>
                <td align="center">G1</td>
                <td align="center">13/<bold>12</bold></td>
                <td align="center">22/<bold>19</bold></td>
              </tr>
              <tr>
                <td align="center">P2</td>
                <td align="center">G1</td>
                <td align="center">16/<bold>16</bold></td>
                <td align="center">43/<bold>29</bold></td>
              </tr>
              <tr>
                <td align="center">P3</td>
                <td align="center">G1</td>
                <td align="center">35/<bold>30</bold></td>
                <td align="center">210/<bold>100</bold></td>
              </tr>
              <tr>
                <td align="center">P3</td>
                <td align="center">G2</td>
                <td align="center">25/<bold>15</bold></td>
                <td align="center">100/<bold>0</bold></td>
              </tr>
              <tr>
                <td align="center">P4</td>
                <td align="center">G2</td>
                <td align="center">10/<bold>8</bold></td>
                <td align="center">14/<bold>9</bold></td>
              </tr>
              <tr>
                <td align="center">Ala-1<sup>(<italic>a</italic>)</sup></td>
                <td align="center">Ala<sup>(<italic>b</italic>)</sup></td>
                <td align="center">73/<bold>73</bold></td>
                <td align="center">1918/<bold>286</bold></td>
              </tr>
              <tr>
                <td align="center">(X)19<sup>(<italic>c</italic>)</sup></td>
                <td align="center">Ala<sup>(<italic>b</italic>)</sup></td>
                <td align="center">380/<bold>346</bold></td>
                <td align="center">53010/<bold>3948</bold></td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Patterns P1–P4 and peptides G1–G2 refer to Figure 1. In all examples, <italic>k </italic>is equal to the pattern size. In columns 3 and 4, data shown in regular and bold font concern respectively the classical and modified CG building rules.</p>
            <p><sup>(<italic>a</italic>) </sup>linear pattern of size 19 corresponding to alamethicin F50 without the last monomer</p>
            <p><sup>(<italic>b</italic>) </sup>alamethicin F50 [N<sc>ORINE</sc>:NOR00007]</p>
            <p><sup>(<italic>c</italic>) </sup>linear pattern of 19 'X' monomers</p>
          </table-wrap-foot>
        </table-wrap>
        <p>In order to validate this speed-up in running time, we measured the search time for different complete patterns in the N<sc>ORINE</sc> database. The results are shown in Figure <xref ref-type="fig" rid="F6">6</xref>. The first observation is that the number of results is often smaller with the classical rules. This is due to the case when the pattern graph has a number of edges different from the peptide graph. In example 6, we search for peptides containing any pair of monomers which is the case for all 711 peptides of N<sc>ORINE</sc>. However, only 698 peptides are output if the classical building rules are used. There are 13 cyclic dipeptides in Norine. This is due to a special case where two nodes of a peptide are connected by two edges, which corresponds to a cyclisation between the two monomers. This special case cannot be detected with the classical building rules but is taken into account by our method.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p><bold>Search time for different complete patterns in the N<sc>ORINE</sc> database</bold>. Here, <italic>k </italic>is equal to the size of the pattern. In the 2nd and 3rd columns, the first and second value corresponds respectively to the classical and new building rules. 'ND' means that the result has not been obtained as the running time exceeded 8 hours.</p>
          </caption>
          <graphic xlink:href="1472-6807-9-15-6"/>
        </fig>
        <p>For the linear pattern of size 7 (example 7), which is contained in more than 70% of the database peptides, the classical rules show a 8-fold slow-down of the running time compared to the new rules. For a linear pattern composed of 14 'X' (example 9), the classical method required 7 hours to produce the result whereas our method took less than 300 ms. Example 12 is the search for a pattern composed of 49 'X', the size of the largest peptide of the database. About 5 minutes were needed for the classical method to obtain the result whereas our method took only about 600 ms. Example 14 represents a negative test as this pattern does not occur in N<sc>ORINE</sc>. In this example, the classical method did not terminate in 8 hours, whereas our method output the result in 280 ms.</p>
        <p>These experiments illustrate the effficiency and adequacy of our method for the search for structural patterns in NRPs.</p>
      </sec>
    </sec>
    <sec>
      <title>Examples of practical applications</title>
      <p>In this part, we give some examples of using structural pattern matching of NRPs in biological studies.</p>
      <sec>
        <title>Structural features</title>
        <p>Structural search can allow one to identify a structural motif common to peptides of a given family. As an example, a search for a cyclic 8-node pattern composed of seven 'X' and a fatty acid moiety (represented by the monomer code '<italic>*R-</italic>'), with <italic>k </italic>= 8, outputs the peptides of the iturin family (iturins, bacillomycins and mycosubtilin), surfactins and lichenysins. Therefore, this pattern represents a common structural feature of this family.</p>
        <p>Another example is the search for a pattern associated with a biological activity. For example, pattern P4 occurs in G2 that represents ornibactin. Ornibactin is a siderophore, an iron-chelating molecule. This type of molecule needs bidendate functions that can ensure a six-fold coordination of the ferric iron. Ornithine and its derivatives can harbour this function. A search for complete pattern P4 returns a list of six siderophore peptides such as ornibactin, pyoverdin or foroxymithine. A search for the pattern R-CO_*OH-Orn_*Asp_*Ser_*Orn derived from ornibactin, with <italic>k </italic>= 2, returns a list of 51 peptides. Among them 46 peptides are annotated as siderophores. This example illustrates that structure-function relationships can also be elucidated by searching for a common substructure between a pattern derived from a peptide characterizing the function and the other peptides of the database.</p>
      </sec>
      <sec>
        <title>Product identification</title>
        <p>Another application of structural pattern matching is the search for a predicted peptide. Several studies (see [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>] for recent examples) start with searching for putative NRPS genes within a genome and predicting the produced peptide out of this sequence. Such a prediction can result in an undetermined monomer or several possible monomers at some positions. The possibility of using 'X' or '/' labels in the structural pattern allows for a look-up for the predicted peptide in the database in order to find out whether the peptide has been discovered before, possibly in another species. To give a concrete example, we submitted six NRPS proteins found in UniProtKB database [<xref ref-type="bibr" rid="B19">19</xref>] ([UniProtKB:Q2VQ12–Q2VQ17]) to the NRPS<sc>PREDICTOR</sc>[<xref ref-type="bibr" rid="B6">6</xref>] and obtained predicted peptides. By combining them, we obtained the structural pattern X_NP_X_NP_NP_NP_X_NP_*Leu_X_*Phe/*Trp/*Tyr_*Leu_NP, where NP stands for non-polar amino acids and corresponds to *Val/*Ile/*Leu/*Abu/*Iva in N<sc>ORINE</sc> notation. A search for this complete pattern in N<sc>ORINE</sc> resulted in only one peptide, BT1583, that is consistent with the bibliographic data of UniProtKB. This example illustrates that the structural search can help associating a product with a set of nonribosomal synthetases.</p>
      </sec>
      <sec>
        <title>Analysis of a putative peptide</title>
        <p>From the analysis of protein sequence similarity, some proteins can be predicted as putative NRPSs. Examples of such predictions can be found in the UniProtKB database. Even though the produced peptide has not been identified, one can infer some properties of a putative NRPS product using the structural search. An example can be provided by the putative NRPS [UniProtKB:Q1I964] from UniProtKB found in <italic>Pseudomonas entomophila</italic>. By studying the sequence of this synthetase, four modules can be predicted. Pattern Val_Leu_Ser_Ile is obtained using the NRPS<sc>PREDICTOR</sc>. This pattern occurs in the lipopeptide putisolvin I stored in N<sc>ORINE</sc>. The search for a more general pattern NP_NP_Ser_NP gives three results, putisolvin I, II and PFL2145, that are all lipopeptides. One can observe that putisolvin I is produced by <italic>Pseudomonas putida</italic>, the same genus of bacteria than [UniProtKB:Q1I694]. This bacteria genus is known to produce various cyclic lipopeptides [<xref ref-type="bibr" rid="B20">20</xref>]. By analysing the gene environment of [UniProtKB:Q1I964], we found another gene coding for a putative NRPS [UniProtKB:Q1I963], which probably produces the beginning of the peptide. A condensation domain characteristic of lipopeptide production can be predicted at the begining of the protein. This domain binds the lipid moiety to the peptide part. This is another clue for lipopeptide production. NRPSpredictor outputs the octapeptide X_NP_NP_X_NP_NP_X_Ser which matches no peptide of N<sc>ORINE</sc>. However, the final product would be composed of 12 monomers and a lipid moiety like putisolvin I. In addition, the composition of the predicted peptide does not match any peptide in Norine but is close to the composition of lipopeptides. Indeed, if we compare the monomeric composition of the predicted peptide with putisolvin I, both compositions are similar. Thus, all data converge to a lipopeptide production. This example illustrates that structural pattern search can assist the biological identification of a predicted peptide by inferring its properties.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Nonribosomal peptides are important bioactive compounds that have various important biological activities and are increasingly studied. With this motivation, we developed the N<sc>ORINE</sc> database [<xref ref-type="bibr" rid="B21">21</xref>] that is the first computational resource entirely devoted to NRPs. All peptides stored in N<sc>ORINE</sc> are annotated with their monomeric (possibly non-linear) structure encoded by undirected labeled graphs.</p>
    <p>In this paper, we presented an efficient dedicated method to search for a structural pattern in the database. We refined the CG building rules previously used in the literature and improved them to adapt to our problem. The main idea of refinement is to use the information on elementary path sizes and on the node degrees in order to decrease the number of nodes and especially the number of edges in the resulting CG. This, in turn, leads to a considerable speed-up in the search for a clique in the CG, which is the final step in the identification of a pattern occurrence.</p>
    <p>As a result, a search for a pattern in the N<sc>ORINE</sc> database currently containing 711 peptide structures takes typically less than one second. Note that the proposed method is exact, i.e. outputs precisely all the peptides that contain the pattern, without any error allowed. Note also that the efficiency of the method can be further increased by pre-computing the matrices of EP sizes for all stored peptides. This would obviously improve the performance of querying the database with different patterns.</p>
    <p>Searching for a structural pattern in the database can be used in different biological studies. For example, it can help to identify members of a peptide family that share common structural properties. It can also help to identify a predicted peptide by searching for it in the N<sc>ORINE</sc> database in case the peptide has been discovered before in other species. Furthermore, a search for a structural pattern can provide new insights into peptide features and help to isolate this peptide experimentally. Finally, it can help to elucidate the relationship between structure and function by searching for patterns occurring in peptides that share a common biological activity.</p>
    <p>An obvious weakness of the method is that in general it might be unable to identify a common structure if the correspondence is not exact, i.e. some monomers "get replaced" by others (not specified explicitely with the joker or alternative labels), or do not have their counterparts at all. Therefore, an interesting direction for future research would be to extend the method to an "error-tolerant" pattern matching dealing with possible deletions, insertions or substitutions of monomers.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>N<sc>ORINE</sc></title>
      <p>The method presented in this paper is included in N<sc>ORINE</sc>. N<sc>ORINE </sc><ext-link ext-link-type="uri" xlink:href="http://bioinfo.lifl.fr/norine"/> is a public Web resource entirely dedicated to NRPs. As of today, N<sc>ORINE</sc> stores 711 peptides, each annotated with different information such as producing organisms, biological activities or its monomeric structure. Monomeric structures are encoded by undirected labeled graphs with nodes representing monomers. Peptides currently stored in N<sc>ORINE</sc> contain overall more than 400 different monomers. Those include all standard amino acids but also many non-standard amino acids incorporated in NRPs during the biosynthesis. Lipids, carbohydrates and polyketides also occur in NRPs and are considered by N<sc>ORINE</sc> as monomers. More details on the N<sc>ORINE</sc> system can be found in [<xref ref-type="bibr" rid="B7">7</xref>].</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>The method has been implemented in Java within the N<sc>ORINE</sc> system. The program looks up for a structural pattern or a common substructure in all the peptides of the N<sc>ORINE</sc> database ([N<sc>ORINE</sc>:NOR00001] to [N<sc>ORINE</sc>:NOR00711] were considered in this publication). All peptides containing the pattern or a common substructure are output. Time measures reported below have been obtained on a PC with a 1.73 GHz processor, 512 MB of RAM and 265 Mflops. The Java code implementing the method can be provided by request to the first author.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>SC carried out most of the work on the algorithm design, implementation in N<sc>ORINE</sc> and experiments. MP and GK participated in the algorithmic setup and the design of computational experiments. VL and PJ contributed to various biological issues related to this study. GK and PJ organized the project. SC, MP and GK wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported by the <italic>PPF bioinformatique </italic>program of the Lille 1 University. S.C. was supported by an INRIA/Région Nord-Pas-de-Calais fellowship. ProBioGEM lab is supported by the region Nord-Pas-de-Calais, the <italic>Ministère de l'Enseignement et de la Recherche</italic>, French ANR agency, and the European Funds for the Regional Development. Funding to pay the Open Access publication charges for this article was provided by INRIA. The authors thank Jesper Jansson for reading and commenting the manuscript.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sieber</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marahiel</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanisms underlying nonribosomal peptide synthesis: approaches to new antibiotics</article-title>
        <source>Chem Rev</source>
        <year>2005</year>
        <volume>105</volume>
        <fpage>715</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="pmid">15700962</pub-id>
        <pub-id pub-id-type="doi">10.1021/cr0301191</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzella</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Reeves</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial biosynthesis for drug development</article-title>
        <source>Curr Opin Microbiol</source>
        <year>2007</year>
        <volume>10</volume>
        <fpage>238</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="pmid">17553731</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.mib.2007.05.005</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stachelhaus</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mootz</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Marahiel</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>The specificity-conferring code of adenylation domains in nonribosomal peptide synthetases</article-title>
        <source>Chem Biol</source>
        <year>1999</year>
        <volume>6</volume>
        <fpage>493</fpage>
        <lpage>505</lpage>
        <pub-id pub-id-type="pmid">10421756</pub-id>
        <pub-id pub-id-type="doi">10.1016/S1074-5521(99)80082-9</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Challis</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Ravel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Townsend</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Predictive, structure-based model of amino acid recognition by nonribosomal peptide synthetase adenylation domains</article-title>
        <source>Chem Biol</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>211</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">10712928</pub-id>
        <pub-id pub-id-type="doi">10.1016/S1074-5521(00)00091-0</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ansari</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Yadav</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gokhale</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Mohanty</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>NRPS-PKS: a knowledge-based resource for analysis of NRPS/PKS megasynthases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <fpage>W405</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="pmid">15215420</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh359</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rausch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Wohlleben</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Specificity prediction of adenylation domains in nonribosomal peptide synthetases (NRPS) using transductive support vector machines (TSVMs)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>5799</fpage>
        <lpage>5808</lpage>
        <pub-id pub-id-type="pmid">16221976</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gki885</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caboche</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pupin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leclère</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Fontaine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jacques</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kucherov</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>NORINE: a database of nonribosomal peptides</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <fpage>D326</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="pmid">17913739</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsuge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Akiyama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shoda</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cloning, sequencing, and characterization of the iturin A operon</article-title>
        <source>J Bacteriol</source>
        <year>2001</year>
        <volume>183</volume>
        <fpage>6265</fpage>
        <lpage>6273</lpage>
        <pub-id pub-id-type="pmid">11591669</pub-id>
        <pub-id pub-id-type="doi">10.1128/JB.183.21.6265-6273.2001</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minowa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Araki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive analysis of distinctive polyketide and nonribosomal peptide structural motifs encoded in microbial genomes</article-title>
        <source>J Mol Biol</source>
        <year>2007</year>
        <volume>368</volume>
        <fpage>1500</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">17400247</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2007.02.099</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mootz</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Schwarzer</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Marahiel</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Ways of assembling complex natural products on modular nonribosomal peptide synthetases</article-title>
        <source>Chembiochem</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>490</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="pmid">12325005</pub-id>
        <pub-id pub-id-type="doi">10.1002/1439-7633(20020603)3:6&lt;490::AID-CBIC490&gt;3.0.CO;2-N</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guenzi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Galli</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grgurina</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gross</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Grandi</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Characterization of the syringomycin synthetase gene cluster. A link between prokaryotic and eukaryotic peptide synthetases</article-title>
        <source>J Biol Chem</source>
        <year>1998</year>
        <volume>273</volume>
        <fpage>32857</fpage>
        <lpage>32863</lpage>
        <pub-id pub-id-type="pmid">9830033</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.273.49.32857</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Garey</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <source>Computers and Intractability: A Guide to the Theory of NP-Completeness</source>
        <year>1979</year>
        <publisher-name>New York, NY, USA: W. H. Freeman &amp; Co</publisher-name>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fellows</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fertin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hermelin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vialette</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Sharp tractability borderlines for finding connected motifs in vertex-colored graphs</article-title>
        <source>Proceedings of the 34th International Colloquium on Automata, Languages and Programming (ICALP), June 9–13, 2007, Wroclaw (Poland)</source>
        <year>2007</year>
        <volume>4596</volume>
        <publisher-name>Lecture Notes in Computer Science, Springer Verlag</publisher-name>
        <fpage>340</fpage>
        <lpage>351</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/content/978-3-540-73419-2"/>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raymond</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Maximum common subgraph isomorphism algorithms for the matching of chemical structures</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2002</year>
        <volume>16</volume>
        <fpage>521</fpage>
        <lpage>533</lpage>
        <pub-id pub-id-type="pmid">12510884</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1021271615909</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <collab>IUPAC, IUB</collab>
        </person-group>
        <article-title>IUPAC-IUB Joint Commission on Biochemical Nomenclature (JCBN). Nomenclature and symbolism for amino acids and peptides. Recommendations 1983</article-title>
        <source>Biochem J</source>
        <year>1984</year>
        <volume>219</volume>
        <fpage>345</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="pmid">6743224</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mehlhorn</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Graph algorithms and NP-completeness</source>
        <year>1984</year>
        <publisher-name>New York, NY, USA: Springer-Verlag New York, Inc</publisher-name>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tobiasen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Aahman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ravnholt</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Bjerrum</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Grell</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Giese</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Nonribosomal peptide synthetase (NPS) genes in Fusarium graminearum, F. culmorum and F. pseudograminearium and identification of NPS2 as the producer of ferricrocin</article-title>
        <source>Curr Genet</source>
        <year>2007</year>
        <volume>51</volume>
        <fpage>43</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="pmid">17043871</pub-id>
        <pub-id pub-id-type="doi">10.1007/s00294-006-0103-0</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bruijn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>de Kock</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>de Waard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>van Beek</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Raaijmakers</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Genome-based discovery, structure prediction and functional analysis of cyclic lipopeptide antibiotics in Pseudomonas species</article-title>
        <source>Mol Microbiol</source>
        <year>2007</year>
        <volume>63</volume>
        <fpage>417</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="pmid">17241198</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1365-2958.2006.05525.x</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="other">
        <article-title>UniProtKB</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org/"/>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raaijmakers</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>de Bruijn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>de Kock</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Cyclic lipopeptide production by plant-associated Pseudomonas spp.: diversity, activity, biosynthesis, and regulation</article-title>
        <source>Mol Plant Microbe Interact</source>
        <year>2006</year>
        <volume>19</volume>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="pmid">16838783</pub-id>
        <pub-id pub-id-type="doi">10.1094/MPMI-19-0699</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="other">
        <article-title>Norine</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioinfo.lifl.fr/norine/"/>
      </citation>
    </ref>
  </ref-list>
</back>
