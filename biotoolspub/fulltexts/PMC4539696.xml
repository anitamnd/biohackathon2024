<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4539696</article-id>
    <article-id pub-id-type="pmid">26283310</article-id>
    <article-id pub-id-type="publisher-id">681</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0681-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SIMAT: GC-SIM-MS data analysis tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nezami Ranjbar</surname>
          <given-names>Mohammad R.</given-names>
        </name>
        <address>
          <email>nranjbar@vt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Poto</surname>
          <given-names>Cristina Di</given-names>
        </name>
        <address>
          <email>cd329@georgetown.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yue</given-names>
        </name>
        <address>
          <email>yuewang@vt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ressom</surname>
          <given-names>Habtom W.</given-names>
        </name>
        <address>
          <email>hwr@georgetown.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0694 4940</institution-id><institution-id institution-id-type="GRID">grid.438526.e</institution-id><institution>Department of Electrical and Computer Engineering, </institution><institution>Virginia Tech, </institution></institution-wrap>Arlington, VA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1955 1644</institution-id><institution-id institution-id-type="GRID">grid.213910.8</institution-id><institution>Department of Oncology, </institution><institution>Georgetown University, </institution></institution-wrap>Washington DC, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>259</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>2</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Nezami Ranjbar et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Gas chromatography coupled with mass spectrometry (GC-MS) is one of the technologies widely used for qualitative and quantitative analysis of small molecules. In particular, GC coupled to single quadrupole MS can be utilized for targeted analysis by selected ion monitoring (SIM). However, to our knowledge, there are no software tools specifically designed for analysis of GC-SIM-MS data. In this paper, we introduce a new R/Bioconductor package called SIMAT for quantitative analysis of the levels of targeted analytes. SIMAT provides guidance in choosing fragments for a list of targets. This is accomplished through an optimization algorithm that has the capability to select the most appropriate fragments from overlapping chromatographic peaks based on a pre-specified library of background analytes. The tool also allows visualization of the total ion chromatograms (TIC) of runs and extracted ion chromatograms (EIC) of analytes of interest. Moreover, retention index (RI) calibration can be performed and raw GC-SIM-MS data can be imported in netCDF or NIST mass spectral library (MSL) formats.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We evaluated the performance of SIMAT using two GC-SIM-MS datasets obtained by targeted analysis of: (1) plasma samples from 86 patients in a targeted metabolomic experiment; and (2) mixtures of internal standards spiked in plasma samples at varying concentrations in a method development study. Our results demonstrate that SIMAT offers alternative solutions to AMDIS and MetaboliteDetector to achieve accurate detection of targets and estimation of their relative intensities by analysis of GC-SIM-MS data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We introduce a new R package called SIMAT that allows the selection of the optimal set of fragments and retention time windows for target analytes in GC-SIM-MS based analysis. Also, various functions and algorithms are implemented in the tool to: (1) read and import raw data and spectral libraries; (2) perform GC-SIM-MS data preprocessing; and (3) plot and visualize EICs and TICs.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0681-2) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Selected ion monitoring</kwd>
      <kwd>Gas chromatography-mass spectrometry</kwd>
      <kwd>Data analysis</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Gas chromatography coupled with mass spectrometry (GC-MS) is one of the technologies widely used for qualitative and quantitative analysis of small molecules. The technology is useful in studies that aim to evaluate the metabolite levels in biofluids and tissues. The use of electron impact (EI) ionization enables the instrument to generate mass spectra for different compounds by shattering biomolecules in multiple fragments.</p>
    <p>Although GC-MS instruments are mostly used for untargeted analysis of metabolites, selected ion monitoring (SIM) allows users to monitor a subset of fragments with their related mass values in a certain retention time (RT) range for a set of targets. This targeted method is expected to lead to increased sensitivity compared to full-scan, as the mass spectrometer monitors a small fraction of the mass range in the former case. The fragments for a targeted method are usually selected in such a way that they are the most unique choices per target. The most unique fragment is used for quantification, whereas the remaining fragments are used as qualifiers to help with the identification. However, it is not always easy to pick appropriate fragments, because of the presence of background analytes overlapping with the targets of interest.</p>
    <p>Several tools have been developed to process the raw GC-MS data. These include freely available tools such as automated mass spectral deconvolution and identification system (AMDIS) [<xref ref-type="bibr" rid="CR1">1</xref>] from NIST, MetaboliteDetector [<xref ref-type="bibr" rid="CR2">2</xref>], TagFinder [<xref ref-type="bibr" rid="CR3">3</xref>], and TargetSearch [<xref ref-type="bibr" rid="CR4">4</xref>] or commercial software such as Mass Profiler Professional (MPP) [<xref ref-type="bibr" rid="CR5">5</xref>] by Agilent and ChromaTOF by Leco [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Although many of these tools can be used for analysis of GC-SIM-MS data, some additional features are desired. For example, after peak deconvolution, it is considerably effective to define only a subset of the fragments from the same chromatographic peak to be used for spectral matching. Although MetaboliteDetector allows manual definition of such mass ranges, one cannot define the mass for each compound separately or at least over a certain range of RT. Also, the values can not be imported from a table at once. Moreover, the user is required to re-enter the values when repeating the same analysis.</p>
    <p>The limitation to define target-specific fragments leads to interfering chromatographic peaks from fragments that do not belong to the analyte of interest. The goal is to ensure that appropriate fragments are selected, particularly the unique mass to be used for the purpose of quantification. Due to a lack of software tools, the selection of such fragments is typically performed manually by the user. Tools such as TagFinder [<xref ref-type="bibr" rid="CR3">3</xref>] and TargetSearch [<xref ref-type="bibr" rid="CR4">4</xref>] limit the peak detection, peak grouping, and analyte identification to apex of the peaks. Although, there are some advantages when working with apex of the peaks in case of interference, in some cases, based on the overlapping pattern of the interfering compound, the location and the intensity of the apex of particular fragments may change significantly.</p>
    <p>Even if other tools such as XCMS [<xref ref-type="bibr" rid="CR7">7</xref>] can be used to perform peak detection and deconvolution, they lack algorithms required for peak grouping followed by spectral matching which are necessary for identification and alignment steps in GC-MS data analysis.</p>
    <p>In addition as in many SIM analyses only a few fragments are selected to be monitored, the regular weighted dot-product used for calculation of spectral matching is not adequate to pinpoint most of the fragment peaks. Also, for a large sample size, the manual curation of error occurred in the peak detection and analyte identification steps is not feasible [<xref ref-type="bibr" rid="CR4">4</xref>]. Therefore, a tool capable of automatically detecting and estimating the intensities of fragment peaks with overlapping components is desired.</p>
    <p>In a response to this demand, we introduce a new tool for analysis of GC-SIM-MS data which addresses the aforementioned shortcomings of available software. Our tool provides guidance to users on the selection of the appropriate fragments before running the experiment based on a pre-specified library of background analytes. Also, the user can provide his or her in-house library including potential background analytes or any combination of libraries at hand. Moreover, we use a combination of both apex and EIC information when performing peak detection to improve the estimation of the similarity scores.</p>
    <p>Although GC-MS instruments are quite reproducible in terms of RT, it is very helpful to use retention index (RI) as a standard method for the purpose of alignment and identification. A mixture of RI standards will be used for this purpose where the RT differences between the standards are known. While several RI standard mixtures, such as FAME and Alkanes are available, users can create their own set of RI standards to use them with their in-house libraries.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>SIMAT has been implemented as an R/Bioconductor package. The run time is shorter than analysis of typical GC-MS data acquired in full-scan mode, because the tool does not search for chromatographic peaks over the entire span of RT.</p>
    <sec id="Sec3">
      <title>Inputs</title>
      <p>First, tools such as HP ChemStation by Agilent and ChromaTOF by Leco are used to convert the data to the standard netCDF format. As GC-SIM-MS analysis is a targeted method, the RT and spectral information of the targets should be provided by the user. In addition, a library can help improve the selection of the appropriate fragments. Also user may provide the preferred fragments per analyte to be used as quantifier mass. However, if user does not provide this information, SIMAT will decide based on other criteria outlined in following sections.</p>
    </sec>
    <sec id="Sec4">
      <title>Algorithm</title>
      <p>As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, SIMAT has several functionalities including optimal fragment selection, baseline correction, peak detection and deconvolution, RI calibration (optional, requires RI standards information), metabolite identification, quantification, and visualization.
<fig id="Fig1"><label>Fig. 1</label><caption><p>SIMAT pipeline. The SIMAT pipeline flowchart for experimental design and analysis of GC-SIM-MS data</p></caption><graphic xlink:href="12859_2015_681_Fig1_HTML" id="MO1"/></fig>
</p>
      <sec id="Sec5">
        <title>Optimal fragment selection</title>
        <p>A list of quantifier and qualifier fragments is required per target analyte prior to analysis by GC-SIM-MS. The most unique fragment from the spectrum of each target is usually selected manually. This is a time consuming task where users are prone to make errors particularly when overlapping fragments are involved. We define two analytes as overlapping if their RTs or RIs are within a pre-specified tolerance criterion. The overlapping analytes can be determined from the target list, by using a comprehensive mass spectral library such as Fiehn [<xref ref-type="bibr" rid="CR8">8</xref>] and NIST [<xref ref-type="bibr" rid="CR9">9</xref>], or an in-house library including known and unknown background analytes from the experimental runs.</p>
        <p>Although the uniqueness of the fragments is the most reasonable feature to decide on the appropriate quantifiers and qualifiers, the relative intensity of the fragments should be taken into account as an important criterion too. In other words, a fragment <italic>F</italic> may be unique for analyte <italic>A</italic> considering the overlapping analytes <italic>B</italic> and <italic>C</italic>, but its relative intensity in the spectrum of the analyte <italic>A</italic> may be too small, e.g. less than 5 % of the top three most abundant fragments. Therefore, <italic>F</italic> is not a good choice as a quantifier of <italic>A</italic>.</p>
        <p>Another important consideration is the grouping of targets in RT windows. This is because the intensity could decrease if too many targets are inserted in one window. Therefore, there is a limit on the number of targets per RT window based on the mass and total number of fragments for each target in that window.</p>
        <p>By providing a library including RTs or RIs for each compound, the tool can come up with a sorted list of preferred fragments and RT windows (segments) for a list of targets. However we recommend the user to run several technical and analytical replicates of exemplar samples, to review the background signals and select candidate fragments for each analyte of interest. This initial evaluation can be done manually or automatically using the optimal fragment selection function in SIMAT.</p>
        <p>By comparing the mass of each fragment for each target with those of other targets or library compounds within a specified range of RT or RI (when provided), we calculate the penalty score as below to sort the fragments for each target:
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} P_{i,j} = \frac{1}{a_{i,j}} \sum\limits_{k=1}^{\mathcal{O}_{m_{i,j}}} \exp \left(-\frac{|r_{i} - r_{k}|}{\delta R} \right) \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>δR</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>where <italic>m</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> and <italic>a</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> are the mass and intensity of the <italic>j</italic>th fragment from the spectrum of the <italic>i</italic>th target, <italic>r</italic>
<sub><italic>i</italic></sub> is the RI of the <italic>i</italic>th target, and <italic>k</italic> is the index of all fragments sharing the same mass of that fragment, i.e. <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}_{m_{i,j}}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_681_IEq1.gif"/></alternatives></inline-formula>. Therefore, a fragment with a lower <italic>P</italic> is preferred. Here, <italic>δ</italic>
<italic>R</italic> is the parameter to control the tolerable range of the difference in RI. Thus, the larger <italic>δ</italic>
<italic>R</italic> means less sensitivity in RI mismatch.</p>
        <p>SIMAT provides users with flexible options regarding the input method of target information and selection of fragments through optimization. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the user can choose among three modes, i.e. target, library, and combined:
<list list-type="bullet"><list-item><p>Target mode: The user provides the targets as an MSL file including RT, mass, and intensity for each fragment.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Optimization flowchart. Flowchart of target list processing and fragment selection by optimization in three different modes</p></caption><graphic xlink:href="12859_2015_681_Fig2_HTML" id="MO2"/></fig>
</p></list-item><list-item><p>Library mode: The user provides a target table, e.g. in csv format, and a library in MSL format. The user may provide either the mass of fragments or the number of desired fragments. Alternatively, the user can provide just the name of the target. In this situation, the tool retrieves the intensity, RT and RI for which the fragment mass are provided by the user. Optimization is done for those targets with no mass information to select the top fragments based on the desired number. If the desired number is not provided, the algorithm uses an adjustable default value.</p></list-item><list-item><p>Combined mode: The user can provide both targets and the library in MSL format. In this case, first, an aggregated library is made by merging the target file and the provided library. Then, the algorithm follows as the previous case with the list of targets obtained from the MSL file.</p></list-item></list>
</p>
        <p>In the above three modes, by setting a flag in the related function, the user may force the optimization algorithm to be applied to all entries whether the mass of fragments are provided or not. However, in this case the algorithm still follows the desired number of fragments if provided by the user, otherwise, a default value is used.</p>
        <p>The optimization module is the most time consuming step in SIMAT. The running time depends on the number of targets as well as the number of compounds in the library and the complexity of their spectra. For a target list of size 50 and a library with 1000 compounds, the optimization may take several minutes on a desktop computer.</p>
      </sec>
      <sec id="Sec6">
        <title>Baseline correction</title>
        <p>Baseline correction is performed at the beginning of the SIMAT processing pipeline. This is done for each fragment separately, as each monitored mass may have a different level of background signal. Alternatively, baseline correction can be performed using the tools applied for data conversion.</p>
      </sec>
      <sec id="Sec7">
        <title>Peak detection and deconvolution</title>
        <p>Before peak detection, a smoothing filter is used. Then, the profiles of the quantifiers are utilized to locate and evaluate the reliability of the corresponding fragment peaks for each target. This is done by comparing the similarity scores of all candidate peaks with the target analyte using spectral matching and RI distance. Therefore, all candidate peaks in vicinity of the expected RT of the target, are evaluated to pinpoint the best fit.</p>
        <p>After peak deconvolution, a peak shape quality score (QS) is assigned to each retrieved EIC by measuring its goodness of fit using a Gaussian shape. The generated QS is used to evaluate the reliability of identification and quantification results to help us decide whether or not to include the EIC of a fragment in calculating the similarity score or estimating the intensity of the analyte.</p>
        <p>Because of the modular design of the tool, the peak detection algorithm can be replaced with any function the user prefers as long as the superseded version provides the location of the fragment peaks in a numeric vector.</p>
      </sec>
      <sec id="Sec8">
        <title>Retention index calibration</title>
        <p>We recommend using RI standards to allow RI calibration as it helps improve peak detection and analyte identification, leading to less false positives. The calibration is done by regressing a piecewise linear model using the RT values of the RI standards. Then, the learned linear model is used to estimate the RI of the target analytes. This information will be used in our peak detection step, i.e., by comparing the RI of detected analyte to those of targets in the library, analyte identification can be performed more reliably. Also, because of the modular design of the tool, the RI calibration function can be any function with the same properties provided by user.</p>
        <p>Although SIMAT provides an RI calibration solution, the user is not limited to using this option. If the user does not provide any RI information, the RTs are directly used to perform the analysis. In this case, it is recommended that the user provides the length of the search window around the expected RT of each target. An estimated value can be obtained by running few samples in full scan (profiling mode) and averaging the shifts in RT of some known compounds. If this value is not provided by user, SIMAT uses a default value of 4 sec.</p>
      </sec>
      <sec id="Sec9">
        <title>Analyte identification</title>
        <p>The regular weighted dot-product-based similarity scores are not adequate for analyte identification based on SIM data in which very few fragments are present for each analyte. Therefore, we used a mixed score, i.e. Eq. <xref rid="Equ2" ref-type="">2</xref>, based on two spectral matching scores: (i) the weighted dot-product of spectra as shown in Eq. <xref rid="Equ3" ref-type="">3</xref>; (ii) the average pairwise intensity comparisons between two spectra using the ratios of all fragments as stated by Eq. <xref rid="Equ4" ref-type="">4</xref>:
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} S_{1,2} = \frac{N_{1} S_{DP} + N_{1\cap 2} S_{PR}}{N_{1} + N_{1\cap 2}}  \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">DP</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PR</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ3">
            <label>(3)</label>
            <alternatives>
              <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} S_{DP} = \frac{\left(\mathbf{m}_{1}^{T}\mathbf{m}_{2}\right)^{w_{m}}\left(\mathbf{a}_{1}^{T}\mathbf{a}_{2}\right)^{w_{a}}}{\sqrt{\left(\sum\limits_{i=1}^{M} m_{1,i}^{2w_{m}}a_{1,i}^{2w_{a}}\right)\left(\sum\limits_{i=1}^{M} m_{2,i}^{2w_{m}}a_{2,i}^{2w_{a}}\right)}}  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M8">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext mathvariant="italic">DP</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">m</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>T</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">m</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msup>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>T</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msqrt>
                            <mml:mrow>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:munderover accent="false" accentunder="false">
                                    <mml:mrow>
                                      <mml:mo>∑</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:munderover>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>w</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>m</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>w</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>a</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:mfenced>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:munderover accent="false" accentunder="false">
                                    <mml:mrow>
                                      <mml:mo>∑</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:munderover>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>w</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>m</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>w</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>a</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                          </mml:msqrt>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_681_Equ3.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ4">
            <label>(4)</label>
            <alternatives>
              <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} S_{PR} = \frac{1}{N_{1\cap2}} \sum\limits_{k=1}^{N_{1\cap2}} \min \left(\alpha_{k}, \frac{1}{\alpha_{k}}\right)  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M10">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext mathvariant="italic">PR</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>∩</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:munderover accent="false" accentunder="false">
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>∩</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mo>min</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>α</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_681_Equ4.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <italic>N</italic>
<sub>1</sub> and <italic>N</italic>
<sub>1∩2</sub> are respectively the number of fragments in the unknown analyte’s spectrum and the number of shared fragments between the unknown analyte and the reference analyte from the library. Also, <bold>m</bold> and <bold>a</bold> are vectors of fragments’ mass and intensities, respectively. The <italic>w</italic>
<sub><italic>m</italic></sub> and <italic>w</italic>
<sub><italic>a</italic></sub> are the weights associated with mass and intensity and <italic>M</italic> is the maximum possible number of fragments. Moreover:
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \alpha_{k} = \frac{a_{2,k}}{a_{2,k-1}}\frac{a_{1,k}}{a_{1,k-1}} \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>which means depending on the size of the product of the ratios of paired intensities, we always select the value to make sure all summation terms in Eq. <xref rid="Equ4" ref-type="">4</xref> are non-negative values less than 1.</p>
        <p>The original idea for the mixed score was introduced in [<xref ref-type="bibr" rid="CR10">10</xref>]. However, we improved the performance of the second score by using all pairwise ratios when performing the comparison between two spectra:
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} S_{PR}^{\ast} = \frac{1}{N_{1\cap2}^{\ast}} \sum\limits_{\substack{k=1\\ \ell&gt;k}}^{N_{1\cap2}} \min \left(\alpha_{k,\ell}^{\ast}, \frac{1}{\alpha_{k,\ell}^{\ast}} \right) \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PR</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ℓ</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo>min</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>where:
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} N_{1\cap2}^{\ast} = \left(\substack{N_{1\cap2}\\ 2} \right) \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∩</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>and:
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \alpha_{k,\ell}^{\ast} = \frac{a_{2,k}}{a_{2,\ell}}\frac{a_{1,k}}{a_{1,\ell}} \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ8.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>Different overlapping patterns may occur depending on the distance of interfering compounds and their relative intensities leading to different and some times quite incomparable spectral matching scores. Therefore the user can choose to use either the AUC-based or apex-based scores. Finally, it is possible to use a weighted combination of the two where the default weights are 0.5, but they can be modified by the user:
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  S_{1,2}^{C} = w S_{1,2}^{Apex} + (1-w) S_{1,2}^{AUC} \end{array} $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Apex</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AUC</mml:mtext></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ9.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>where 0≤<italic>w</italic>≤1.</p>
        <p>The following equation is used to calculate the RI similarity score [<xref ref-type="bibr" rid="CR2">2</xref>]:
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  S_{1,2}^{R} = \exp\left(-\frac{|r_{1} - r_{2}|}{\delta R}\right) \end{array} $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>δR</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_681_Equ10.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>where <italic>δ</italic>
<italic>R</italic> is the decay rate of the difference between RIs. The overall similarity score is then calculated based on the product of <inline-formula id="IEq2"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S^{C}_{1,2}$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_681_IEq2.gif"/></alternatives></inline-formula> from Eq. <xref rid="Equ9" ref-type="">9</xref> and <inline-formula id="IEq3"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S^{R}_{1,2}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_681_IEq3.gif"/></alternatives></inline-formula> from Eq. <xref rid="Equ10" ref-type="">10</xref>. Because of the modular design of the software, the penalty function can be replaced by any other function in case required.</p>
      </sec>
      <sec id="Sec10">
        <title>Quantification</title>
        <p>When the analyte of interest is detected reliably in previous steps, the related intensity is calculated based on both the apex of fragments and the AUC of each fragment using the corresponding EIC. Therefore, the tool provides the intensities for all quantifier and qualifier fragments per analyte. However, it is recommended to use the intensities from the quantifier mass for relative quantitative comparisons.</p>
      </sec>
      <sec id="Sec11">
        <title>Visualization</title>
        <p>The pipeline provides functions which enables the user to plot the TIC of a run, or a set of runs. The tool is also able to visualize the profile of any target in an individual run by plotting the EIC of all corresponding fragments. The EIC plots also include a subplot showing a pseudo chromatographic peak based on the expected EICs for all fragments and the spectral information of the targets. The mass of each fragment is shown while plotted in different colors. In addition, two vertical dashed lines show the expected and attained RTs of the target respectively.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Outputs</title>
      <p>The primary output of the tool is a table including the name of the target analytes with their quantitated intensities across runs. In addition, if the user chooses to use optimal fragment selection, a list of analytes with their preferred fragments will be provided to be used in the GC-SIM-MS data acquisition.</p>
      <p>The tool also provides the EICs of the detected analytes where the user can visually evaluate them. This can be done for individual analytes in a specific run, or by providing a range of runs (using run names or run orders) and a range of compounds (or compound names) from the list of targets. The generated EICs can be used for further analysis, such as visual inspection of randomly selected targets to ensure the accuracy of the data preprocessing step.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results and discussion</title>
    <p>To evaluate the performance of SIMAT, we used two experimental data sets, Data Set 1 and Data Set 2. Data Set 1 is from a targeted metabolomic experiment that includes 86 subjects representing two disease groups. Data Set 2 contains 40 runs from a spike-in experiment using mixtures of four internal standards. We analyzed these two data sets with AMDIS+MPP, MetaboliteDetector, and SIMAT. The evaluation performance was based on the number of correctly detected analytes. The parameter settings are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Also, we illustrate different functions in SIMAT using a demo data set (DSdemo). All three data sets were analyzed by GC-SIM-MS using the metabolite extraction and data acquisition methods described in the following sections.</p>
    <p><bold><italic>Metabolite extraction</italic></bold> Plasma metabolites were extracted by adding 1mL of working solution composed of acetonitrile, isopropanol, and water (3:3:2) containing myristic acid d27 to 30 <italic>μ</italic>L of plasma. After vortexing, samples were centrifuged at 14,500 g for 15min at room temperature. The supernatant was then divided into two, 460 <italic>μ</italic>L each, for analysis by each of the GC-MS system.</p>
    <p>We derivatized the dried samples in each batch prior to injection following a two-stage process of oximation followed by trimethylsilylation (TMS) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Briefly, 20 <italic>μ</italic>L of a 20 mg/mL methoxyamine hydrochloride in pyridine was added to the dried extracts, vortexed and incubated at 80 °C for 20min. After returning the samples at room temperature, 91 <italic>μ</italic>L of MSTFA + RI standards was added, vortexed and incubated at 80 °C for 20 minutes. Samples were then centrifuged at 14,500 rpm for 15min, and 60 <italic>μ</italic>L of the supernatant was transferred into 250 <italic>μ</italic>L clear glass autosampler vials. The labeled internal standards were purchased from CDN isotopes and RI standards were purchased from TCI chemicals.</p>
    <p><bold><italic>Data acquisition</italic></bold> The data sets were acquired by analyzing the metabolite extracts using a 7890A Agilent Gas Chromatograph coupled with a 5975C single quadrupole Mass Spectrometer (GC-qMS). Agilent J&amp;W DB-5MS column (30m × 0.25mm × 0.25 <italic>μ</italic>m film 95 % dimethyl 5 % diphenyl polysiloxane) + 10m Duraguard Capillary column was used. Prior to GC-MS analysis, retention time locking (RTL) was performed using myristic acid d27 at 16.727min. The samples were then injected in splitless mode, with the injection port held at 250 °C. The initial oven temperature was held at 60 °C for one minute and then ramped at 10 °C/min to 325 °C and held for 10min. The post run was one minute to allow the oven cool down to 60 °C. MSD transfer line was held at 290 °C, ion source at 250 °C and the mass analyzer at 150 °C. The GC-qMS data were acquired in 37.5min with 5.9min solvent delay at normal scan rate in the mass range 50-600Da.</p>
    <sec id="Sec14">
      <title>Data Set 1: targeted metabolomic experiment</title>
      <p>Data Set 1 was obtained by a targeted analysis of 69 metabolites in plasma from 86 subjects using an Agilent GC coupled with a single quadruple MSD mass spectrometer in SIM mode.</p>
      <p>Table <xref rid="Tab1" ref-type="table">1</xref> shows a comparison between different tools based on the number of peaks detected with a similarity score higher than a threshold. As shown in the table, SIMAT leads to detection of more metabolites compared to other tools for the same threshold of similarity score. For example, SIMAT detected 85.3 % of the targets with a score higher than 0.8 out of 1.0 while using AMDIS+MPP and MetaboliteDetector, only 34.6 % and 53.7 % of the analytes were detected for the same threshold of 0.8, respectively. At best, we were able to detect 61.9 % of metabolites with a score higher than 0.6 in all runs using AMDIS+MPP. Similarly, using MetaboliteDetector, we detected 70.2 % of total analytes in all runs with a score higher than 0.6. Figure <xref rid="Fig3" ref-type="fig">3</xref> illustrates the histogram of the similarity scores of the targets detected by SIMAT. Also, Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows an example of the EIC obtained by using SIMAT.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Similarity score histogram. Histogram of similarity scores for targets detected in Data Set 1. As shown most of the targets had similarity score above 0.8 threshold</p></caption><graphic xlink:href="12859_2015_681_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Target EIC. Extracted ion chromatogram of monitored fragments for a target in Data Set 1. Using a modified spectral matching score in combination of RI calibration, SIMAT is able to pick the correct chromatographic peak among multiple cases</p></caption><graphic xlink:href="12859_2015_681_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Percentage of detected targets for different similarity score thresholds for Data Set 1</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Score threshold</th><th align="left">0.60</th><th align="left">0.70</th><th align="left">0.80</th></tr></thead><tbody><tr><td align="left">SIMAT</td><td align="left">92.3</td><td align="left">89.0</td><td align="left">85.3</td></tr><tr><td align="left">AMDIS + MPP</td><td align="left">61.9</td><td align="left">47.4</td><td align="left">34.6</td></tr><tr><td align="left">MetaboliteDetector</td><td align="left">70.2</td><td align="left">65.5</td><td align="left">53.7</td></tr></tbody></table></table-wrap>
</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates the histogram of the targets when optimal target selection is not used. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows two analytes to demonstrate the power of using optimal fragment selection versus choosing fragments based on the Fiehn SIM library. As illustrated, the selection of the fragments based on default values suggested by the library is not always efficient. In fact, in some cases, it may even make the detection of the analytes very difficult which subsequently may lead to inaccurate quantification of the targets.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Similarity score histogram. Histogram of similarity scores for detected targets when default fragments from the Fiehn SIM library were used with Data Set 1. Compared to Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the scores are shifted to the left, indicating that the identification is not as confident as the former case, where fragments are selected by optimization</p></caption><graphic xlink:href="12859_2015_681_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>EIC comparison. Comparison between the EICs of two analytes before (top row) and after (bottom row) using optimal fragment selection in Data Set 1. This shows the effectiveness of choosing appropriate fragments by using optimization techniques while a pre-specified library of background compounds is provided by the user</p></caption><graphic xlink:href="12859_2015_681_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
    <sec id="Sec15">
      <title>Data Set 2: spike-in experiment</title>
      <p>Data Set 2 was acquired by the same instrument as Data Set 1. It consists of 40 runs including 39 runs of three technical replicates of four standards (Table <xref rid="Tab2" ref-type="table">2</xref>) at 13 different concentration levels ranging from 1× to 2<sup>−12</sup>×, where the base concentration 1× was specifically determined based on each standard. The standards were spiked-in plasma samples. This allows us to evaluate the power of our tool in quantification of the targets in the presence of background analytes. Also, for quality assessment, a sample including all four standards with the base concentration was ran at the end of queue in full scan.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>List of spike-in internal standards in Data Set 2</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Internal standard</th><th align="left">Quantifier</th><th align="left">Qualifier 1</th><th align="left">Qualifier 2</th></tr></thead><tbody><tr><td align="left">glutamic acid d5</td><td align="left">161</td><td align="left">235</td><td align="left">263</td></tr><tr><td align="left">tryrosine d2</td><td align="left">218</td><td align="left">282</td><td align="left">181</td></tr><tr><td align="left">myristic acid d27</td><td align="left">312</td><td align="left">76</td><td align="left">135</td></tr><tr><td align="left">phenylalanin-phenyl d5</td><td align="left">219</td><td align="left">200</td><td align="left">274</td></tr></tbody></table></table-wrap>
</p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the log intensity of the quantifier and qualifier fragments for the four standards determined by SIMAT. As shown in the figure, because of existing background, some fragments hit the baseline concentration and remain almost flat below a certain level. For instance, in the case of tyrosine d2, the fragment with mass 218 is not a good choice, as its trend shows that another analyte sharing the same fragment exists in vicinity of tyrosine’s elution time. While the background may originate from known or unknown compounds, this example shows that appropriate choice of fragments for monitoring is very important, mainly for low abundant analytes.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Spike-in experiment. Reproducibility of the spike-in standards over a wide range of concentration levels in Data Set 2</p></caption><graphic xlink:href="12859_2015_681_Fig7_HTML" id="MO7"/></fig>
</p>
      <p>In summary, using SIMAT, we were able to detect all the standards in all runs at each concentration level considered in this study using 0.8 as the cutoff score. In comparison, on the basis of the number of missing values and the confidence of the similarity scores, AMDIS+MPP and MetaboliteDetector detected 52 % and 64 % of the total target analytes across all runs with a similarity score threshold of 0.8, respectively.</p>
    </sec>
    <sec id="Sec16">
      <title>Data processing example</title>
      <p>Here, we demonstrate how SIMAT can be used for processing of GC-SIM-MS data through a demo data set embedded in the package. The list of analytes in this data set is shown in Table <xref rid="Tab3" ref-type="table">3</xref>. After installation, we start by loading the package and example data sets included in the SIMAT library:
<table-wrap id="Tab3"><label>Table 3</label><caption><p>List of 17 analytes in the package’s embeded data set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Analyte</th><th align="left">QF</th><th align="left">QL <sub>1</sub>
</th><th align="left">QL <sub>2</sub>
</th><th align="left">QL <sub>3</sub>
</th><th align="left">RI</th></tr></thead><tbody><tr><td align="left">epsilon-caprolactam</td><td align="left">56</td><td align="left">98</td><td align="left">170</td><td align="left">171</td><td align="left">703.8</td></tr><tr><td align="left">norvaline</td><td align="left">72</td><td align="left">73</td><td align="left">74</td><td align="left">75</td><td align="left">791.7</td></tr><tr><td align="left">valine</td><td align="left">144</td><td align="left">73</td><td align="left">147</td><td align="left">218</td><td align="left">897.5</td></tr><tr><td align="left">urea</td><td align="left">189</td><td align="left">66</td><td align="left">74</td><td align="left">190</td><td align="left">920.2</td></tr><tr><td align="left">phosphoric acid</td><td align="left">300</td><td align="left">211</td><td align="left">73</td><td align="left">314</td><td align="left">954.8</td></tr><tr><td align="left">proline</td><td align="left">59</td><td align="left">142</td><td align="left">143</td><td align="left">216</td><td align="left">978.5</td></tr><tr><td align="left">threonine</td><td align="left">117</td><td align="left">218</td><td align="left">219</td><td align="left">291</td><td align="left">1061.8</td></tr><tr><td align="left">trans–hydroxy-L-proline</td><td align="left">230</td><td align="left">231</td><td align="left">304</td><td align="left">147</td><td align="left">1134.2</td></tr><tr><td align="left">aspartic acid</td><td align="left">188</td><td align="left">202</td><td align="left">218</td><td align="left">232</td><td align="left">1191.3</td></tr><tr><td align="left">phenylalanine</td><td align="left">91</td><td align="left">120</td><td align="left">130</td><td align="left">146</td><td align="left">1223.4</td></tr><tr><td align="left">glutamic acid d5</td><td align="left">132</td><td align="left">147</td><td align="left">251</td><td align="left">252</td><td align="left">1289</td></tr><tr><td align="left">glutamic acid</td><td align="left">128</td><td align="left">156</td><td align="left">246</td><td align="left">247</td><td align="left">1292.1</td></tr><tr><td align="left">lauric acid</td><td align="left">257</td><td align="left">129</td><td align="left">132</td><td align="left">57</td><td align="left">1326.6</td></tr><tr><td align="left">arabitol</td><td align="left">217</td><td align="left">205</td><td align="left">117</td><td align="left">319</td><td align="left">1389.4</td></tr><tr><td align="left">sorbose</td><td align="left">103</td><td align="left">217</td><td align="left">218</td><td align="left">307</td><td align="left">1549.7</td></tr><tr><td align="left">linoleic acid</td><td align="left">67</td><td align="left">75</td><td align="left">81</td><td align="left">337</td><td align="left">1880.7</td></tr><tr><td align="left">arachidic acid</td><td align="left">117</td><td align="left">129</td><td align="left">132</td><td align="left">145</td><td align="left">2103.9</td></tr></tbody></table><table-wrap-foot><p>QF: quantifier, QL: qualifier, RI: retention index (FAME)</p></table-wrap-foot></table-wrap>
</p>
      <p>Before advancing to the next steps, we can check the total ion chromatogram (TIC) of the run as shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>:
<fig id="Fig8"><label>Fig. 8</label><caption><p>TIC example. An example of total ion chromatogram (TIC) of a run visualized by SIMAT</p></caption><graphic xlink:href="12859_2015_681_Fig8_HTML" id="MO8"/></fig>
</p>
      <p>To find the corresponding chromatographic peaks in the run, we can call getPeak function:</p>
      <p>Following that, the extracted ion chromatogram (EIC) of the retrieved chromatographic peaks can be visualized using plotEIC function:</p>
      <p>However, the above is done without RI calibration. To adjust for RI, first we call getRI to create a function which can be used to calculate the RI given the RT:</p>
      <p>Here, calcRI is a function which accepts RT values as its argument:</p>
      <p>Also, calcRI can be used with the getPeak function to redo the data preprocessing, but this time, with RI calibration:</p>
      <p>To work with the fragment selection function, i.e. optFrag, we can use the example background library, i.e. Library. This is recommended to be done before the experiment, as after running the experiment, it may not be possible to find an optimum choice among the set of monitored fragments. We can also check the difference between the default set of the fragments, and the ones selected by optFrag function: which gives the mass of fragments as 56, 98, 170, and 171 with relative intensities of 152, 148, 1000, and 156, respectively. On the other hand, we can check the optimization results:</p>
      <p>which generates the mass of fragments as 170, 171, 185, and 112 with relative intensities of 1000, 156, 141, and 36, respectively. Although two of the fragments are the same as the original choice, their order has changed after optimization. Also, two new fragments are selected that can be used as qualifiers. As illustrated, Fig. <xref rid="Fig9" ref-type="fig">9</xref> assures us that the fragment with mass of 170 is a better choice as a quantifier for this analyte.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Target EIC. Extracted ion chromatogram (EIC) of monitored fragments for an analyte. Although 56 is considered as the quantifier fragment, 170 is a better choice as suggested by the optimization algorithm in SIMAT</p></caption><graphic xlink:href="12859_2015_681_Fig9_HTML" id="MO9"/></fig>
</p>
      <p>In the example above, the optFrag function is used directly. However, it is usually used within the getTarget function, where the user can set if optimization is desired.</p>
      <p>More example data sets are available for testing the tool at <ext-link ext-link-type="uri" xlink:href="http://omics.georgetown.edu/SIMAT.html">http://omics.georgetown.edu/SIMAT.html</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We introduce a new R package called SIMAT that allows the selection of the optimal set of fragments and retention time windows for target analytes in GC-SIM-MS based analysis. Also, various functions and algorithms are implemented in the tool to: (1) read and import raw data in netCDF format and spectral libraries in NIST MSL format; (2) perform GC-SIM-MS data preprocessing including baseline correction, peak detection and deconvolution, retention index calibration, analyte identification, and quantification; and (3) plot and visualize EICs and TICs, which can be used for manual curation of the retention times or other parameters used for data preprocessing.</p>
    <p>Because the tool aims to locate selected ions, the processing time is reasonably short compared to algorithms that look for all possible chromatographic peaks. By using experimental data sets, we evaluated the performance of the method and showed that it is capable of retrieving target analytes with a run time as short as 10min for a data set with 86 GC-SIM-MS runs.</p>
    <p>Finally, although SIMAT is tailored to process GC-SIM-MS data, the implemented algorithms can be utilized to search for targets in data acquired in full scan mode. It can also help determine the most appropriate fragment for quantification of analytes in untargeted analyses.</p>
    <p>Future work will focus on development of a GUI for the tool. Other improvements in the peak detection algorithms, data visualization, and supporting more input data formats for the raw and library data will be considered.</p>
  </sec>
  <sec id="Sec18">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> SIMAT<bold>Project home page:</bold>
<ext-link ext-link-type="uri" xlink:href="http://omics.georgetown.edu/SIMAT.html">http://omics.georgetown.edu/SIMAT.html</ext-link>http://omics.georgetown.edu/<ext-link ext-link-type="uri" xlink:href="http://omics.georgetown.edu/SIMAT.html">http://omics.georgetown.edu/SIMAT.html</ext-link>SIMAT.html<bold>Operating system(s):</bold> Platform independent<bold>Programming language:</bold> SIMAT is available as an R package as a free and open-source tool on Bioconductor repository. Moreover, the tool is available as a set of m-files which can be run in MATLAB.<bold>License:</bold> GNU GPL-2<bold>Any restrictions to use by non-academics:</bold> None</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec19">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_681_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Parameter settings and compound names including derivatization.</bold> This file includes parameter settings used in MetaboliteDetector and AMDIS. It also includes the name of the compounds in Table <xref rid="Tab3" ref-type="table">3</xref> with the derivatization as listed in NIST GC-MS library. (PDF 190 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AUC</term>
        <def>
          <p>Area under the curve</p>
        </def>
      </def-item>
      <def-item>
        <term>EIC</term>
        <def>
          <p>Extracted ion chromatogram</p>
        </def>
      </def-item>
      <def-item>
        <term>TIC</term>
        <def>
          <p>Total ion chromatogram</p>
        </def>
      </def-item>
      <def-item>
        <term>TMS</term>
        <def>
          <p>Trimethylsilyl</p>
        </def>
      </def-item>
      <def-item>
        <term>GC-MS</term>
        <def>
          <p>Gas chromatography coupled with mass spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>SIM</term>
        <def>
          <p>Selected ion monitoring, RI: Retention index</p>
        </def>
      </def-item>
      <def-item>
        <term>RT</term>
        <def>
          <p>Retention time</p>
        </def>
      </def-item>
      <def-item>
        <term>IS</term>
        <def>
          <p>Internal standard</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>MRNR designed and implemented the algorithms, helped with the experimental design, and analyzed the data. CDP worked on the sample preparation, experimental design, and data acquisition. The manuscript was written through contributions of all authors. All authors have given approval to the final version of the manuscript. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work has been supported by the National Institutes of Health Grants R01CA143420, U01CA160036, and U01CA185188. We thank Alessia Ferrarini for providing constructive comments.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>An integrated method for spectrum extraction and compound identification from gas chromatography/mass spectrometry data</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>1999</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>770</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/S1044-0305(99)00047-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hiller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hangebrauk</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jäger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spura</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schomburg</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MetaboliteDetector: Comprehensive analysis tool for targeted and nontargeted GC/MS based metabolome analysis</article-title>
        <source>Anal Chem</source>
        <year>2009</year>
        <volume>81</volume>
        <issue>9</issue>
        <fpage>3429</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1021/ac802689c</pub-id>
        <pub-id pub-id-type="pmid">19358599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luedemann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Strassburg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Erban</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kopka</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>TagFinder for the quantitative analysis of gas chromatography-mass spectrometry (GC-MS)-based metabolite profiling experiments</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>732</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn023</pub-id>
        <pub-id pub-id-type="pmid">18204057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuadros-Inostroza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Caldana</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redestig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kusano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lisec</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pena-Cortes</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TargetSearch - a Bioconductor package for the efficient preprocessing of GC-MS metabolite profiling data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>428</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-428</pub-id>
        <pub-id pub-id-type="pmid">20015393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <mixed-citation publication-type="other">Agilent Mass Profiler Professional. <ext-link ext-link-type="uri" xlink:href="http://www.chem.agilent.com/en-US/products-services/Software-Informatics/Mass-Profiler-Professional-Software/Pages">http://www.chem.agilent.com/en-US/products-services/Software-Informatics/Mass-Profiler-Professional-Software/Pages</ext-link>. default.aspx. Accessed 1 May 2015.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Leco ChromoToF. <ext-link ext-link-type="uri" xlink:href="http://www.leco.com/products/separation-science/software-accessories/chromatof-software">http://www.leco.com/products/separation-science/software-accessories/chromatof-software</ext-link>. Accessed 1 May 2015.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>3</issue>
        <fpage>779</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wohlgemuth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Palazoglu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shahbaz</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiehnlib: Mass spectral and retention index libraries for metabolomics based on quadrupole and time-of-flight gas chromatography/mass spectrometry</article-title>
        <source>Anal Chem</source>
        <year>2009</year>
        <volume>81</volume>
        <issue>24</issue>
        <fpage>10038</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1021/ac9019522</pub-id>
        <pub-id pub-id-type="pmid">19928838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">NIST/EPA/NIH Mass Spectral Library. <ext-link ext-link-type="uri" xlink:href="http://www.nist.gov/srd/nist1a.cfm">http://www.nist.gov/srd/nist1a.cfm</ext-link>. Accessed 1 May 2015.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Optimization and testing of mass spectral library search algorithms for compound identification</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>1994</year>
        <volume>5</volume>
        <issue>9</issue>
        <fpage>859</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1016/1044-0305(94)87009-8</pub-id>
        <pub-id pub-id-type="pmid">24222034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Broadhurst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Begley</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zelena</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Francis-McIntyre</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Procedures for large-scale metabolic profiling of serum and plasma using gas chromatography and liquid chromatography coupled to mass spectrometry</article-title>
        <source>Nat Protoc</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>7</issue>
        <fpage>1060</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2011.335</pub-id>
        <pub-id pub-id-type="pmid">21720319</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Metabolite profiling in blood plasma</article-title>
        <source>Methods Mol Biol</source>
        <year>2007</year>
        <volume>358</volume>
        <fpage>3</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-59745-244-1_1</pub-id>
        <pub-id pub-id-type="pmid">17035677</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
