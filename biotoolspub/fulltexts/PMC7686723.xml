<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7686723</article-id>
    <article-id pub-id-type="pmid">33228535</article-id>
    <article-id pub-id-type="publisher-id">7223</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-07223-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>gCAnno: a graph-based single cell type annotation method</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Yang</surname>
          <given-names>Xiaofei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Gao</surname>
          <given-names>Shenghan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Tingjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Boyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dang</surname>
          <given-names>Ningxin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ye</surname>
          <given-names>Kai</given-names>
        </name>
        <address>
          <email>kaiye@xjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.43169.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 0599 1243</institution-id><institution>School of Computer Science and Technology, Faculty of Electronic and Information Engineering, </institution><institution>Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.43169.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 0599 1243</institution-id><institution>MOE Key Lab for Intelligent Networks &amp; Networks Security, Faculty of Electronic and Information Engineering, </institution><institution>Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.43169.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 0599 1243</institution-id><institution>School of Automation Science and Engineering, Faculty of Electronic and Information Engineering, </institution><institution>Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.452438.c</institution-id><institution>Genome Institute, </institution><institution>The First Affiliated Hospital of Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.43169.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 0599 1243</institution-id><institution>The School of Life Science and Technology, </institution><institution>Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>823</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Current single cell analysis methods annotate cell types at cluster-level rather than ideally at single cell level. Multiple exchangeable clustering methods and many tunable parameters have a substantial impact on the clustering outcome, often leading to incorrect cluster-level annotation or multiple runs of subsequent clustering steps. To address these limitations, methods based on well-annotated reference atlas has been proposed. However, these methods are currently not robust enough to handle datasets with different noise levels or from different platforms.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present gCAnno, a graph-based Cell type Annotation method. First, gCAnno constructs cell type-gene bipartite graph and adopts graph embedding to obtain cell type specific genes. Then, naïve Bayes (gCAnno-Bayes) and SVM (gCAnno-SVM) classifiers are built for annotation. We compared the performance of gCAnno to other state-of-art methods on multiple single cell datasets, either with various noise levels or from different platforms. The results showed that gCAnno outperforms other state-of-art methods with higher accuracy and robustness.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">gCAnno is a robust and accurate cell type annotation tool for single cell RNA analysis. The source code of gCAnno is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xjtu-omics/gCAnno">https://github.com/xjtu-omics/gCAnno</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12864-020-07223-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Graph embedding</kwd>
      <kwd>Cell type annotation</kwd>
      <kwd>Single cell RNA analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2018YFC0910400</award-id>
        <award-id>2017YFC0907500</award-id>
        <award-id>2018ZX10302205</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ye</surname>
            <given-names>Kai</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Science Foundation of China</institution>
        </funding-source>
        <award-id>61702406</award-id>
        <award-id>31671372</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ye</surname>
            <given-names>Kai</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>General Financial Grant from the China Postdoctoral Science Foundation</institution>
        </funding-source>
        <award-id>2017M623178</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yang</surname>
            <given-names>Xiaofei</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100012226</institution-id>
            <institution>Fundamental Research Funds for the Central Universities</institution>
          </institution-wrap>
        </funding-source>
        <award-id>xzy012020012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yang</surname>
            <given-names>Xiaofei</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Bulk RNA sequencing measures average gene expression level in a large population of cells, hindering dissection of heterogeneous cell types [<xref ref-type="bibr" rid="CR1">1</xref>]. In 2009, single cell RNA sequencing (scRNA-seq) technology was developed to provide valuable insights into cell heterogeneity [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par14">In general, accurate cell type annotation for single cell data is a prerequisite for any further investigation of cell heterogeneous [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. The commonly used cell type annotation methods, including Seurat [<xref ref-type="bibr" rid="CR7">7</xref>], SCANPY [<xref ref-type="bibr" rid="CR8">8</xref>] and SINCERA [<xref ref-type="bibr" rid="CR9">9</xref>], adopts a similar procedure of data quality control, reads mapping, UMI quantification, expression normalization, clustering, differentially expressed genes (DEGs) of each cluster identification and cell type assignment based on biomarker genes [<xref ref-type="bibr" rid="CR10">10</xref>]. However, those methods report cluster-level rather than truly single cell-level annotation results, masking subtle differences within each cluster. In addition, different clustering methods and many tunable parameters led to uncertain clustering outcome. These above two factors cause incorrect cluster-level annotations or multiple runs of subsequent clustering steps [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par15">To overcome the above issues, two distinct strategies, namely biomarker-based and reference-based approaches, have been proposed. The biomarker-based methods, such as Garnett [<xref ref-type="bibr" rid="CR11">11</xref>] and CellAssign [<xref ref-type="bibr" rid="CR12">12</xref>], aim to establish mappings between the query dataset and the well-studied biomarkers. In particular, Garnett trains a classifier based on the user defined markup language. CellAssign builds a probabilistic model that leverages prior knowledge of cell-type marker genes for annotation. However, collecting a comprehensive biomarker set of different cell types is cumbersome, time-consuming and subjective. Thus recently reference-based approaches, such as Scmap [<xref ref-type="bibr" rid="CR13">13</xref>], Chetah [<xref ref-type="bibr" rid="CR14">14</xref>] and scPred [<xref ref-type="bibr" rid="CR15">15</xref>] have been developed and are gaining popularity after a number of well-annotated single cell data were published, especially the datasets released by human cell atlas (HCA) [<xref ref-type="bibr" rid="CR16">16</xref>]. The reference-based methods follow data-driven strategy and construct mappings between query dataset and the well-annotated reference datasets. For example, Scmap uses drop-based method to select feature genes as variables and constructs mapping by distance and correlation coefficient. Another method, scPred selects differential principle components (PCs) calculated by gene expression value between cell types and trains an SVM model with these PCs. Recently, a comprehensive benchmark study [<xref ref-type="bibr" rid="CR17">17</xref>] of 22 cell type classification methods indicated that SVM classifier has overall the best performance. However, these methods are sensitive to experiment batches, sequencing platforms and noises, all of which are intrinsic properties of the single cell datasets.</p>
    <p id="Par16">Here, we propose a reference-based method, gCAnno, using graph representation feature selection strategy to comprehensively represent the global view of associations between cell types and genes for robust and high accuracy single cell-level annotation. Our gCAnno method starts with construction of a weighted cell type-gene bipartite graph. Then, graph embedding is applied to capture the cell type specific genes and naïve Bayes (gCAnno-Bayes) and SVM (gCAnno-SVM) classifiers are built for further annotation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We compared gCAnno with the state-of-the-art methods on four published datasets as the basic test [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. We also reported the performance comparison on large dataset with deep annotation level [<xref ref-type="bibr" rid="CR18">18</xref>], different single cell platforms, simulated datasets with either various cell type imbalance situations and different dropout noise levels as the advanced test. Finally, runtime is summarized to demonstrate the efficiency of gCAnno.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of gCAnno. <bold>a</bold> Cell type-gene graph building. The graph contains gene nodes (gray circles) and cell type nodes (other color circles). <bold>b</bold> Graph embedding converts graphs into low dimensional vectors. Genes are selected based on the distance between the two types of vectors. <bold>c</bold> Training Naïve Bayes and SVM classifiers for annotation. <bold>d</bold> Cell type annotation for new query dataset</p></caption><graphic xlink:href="12864_2020_7223_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par17">To evaluate the performance of gCAnno, we first evaluated the cell type-gene specific relation, and then compared gCAnno with five state-of-art methods, including Scmap-cell, Scmap-cluster, Chetah, scPred and SVM, in the following four aspects: 1) cell type specificity of gCAnno detected genes, 2) overall performance on different scRNA-seq datasets, 3) robustness test on simulated drop-out and imbalance noise data, 4) cross platform annotation.</p>
    <sec id="Sec3">
      <title>Cell type specificity of gene sets detected by gCAnno</title>
      <p id="Par18">After graph embedding step, gCAnno selects cell type specific gene sets, which largely determines the performance of our approach. Thus, we first evaluated the cell type specificity of gene sets detected in the four datasets. We noticed that clear cell type specific expression patterns are observed for these selected genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S5; Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Figure S6). Among the reported marker genes from the corresponding publications, gCAnno is able to capture an average of 57% of them, indicating gCAnno’s effectiveness of cell type specific gene identification (Additional file <xref rid="MOESM11" ref-type="media">11</xref>: Figure S7; Additional file <xref rid="MOESM12" ref-type="media">12</xref>: Table S4).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Cell type specificity of gene sets detected by gCAnno. <bold>a</bold> The heatmap of the expression of each cell type specific gene sets in liver, pancreas, HCC &amp; ICCA and AT root datasets. The expression values are normalized by <italic>z</italic>-score across different cell types. <bold>b</bold> t-SNE plots showing the expression of rank one cell specific gene in four cell types in liver dataset. (i) t-SNE projection showing a reference map of all cell types. The expression of (ii) <italic>SPARCL1</italic> in Periportal_LSECs, (iii) <italic>TRCA</italic> in AlfaBetaT, (iv) <italic>FXYD2</italic> in Cholangiocytes and (v) <italic>MZB1</italic> in Plasma_cells (t-SNE plots for all cell types are in Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Figure S6)</p></caption><graphic xlink:href="12864_2020_7223_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Overall and large dataset performance evaluation</title>
      <p id="Par19">We next evaluated and compared overall performance of gCAnno, Scmap, scPred, Chetah and SVM with four published scRNA-seq datasets (Table <xref rid="Tab1" ref-type="table">1</xref>). We found that the comprehensive kappa coefficient of both gCAnno was consistently much higher than those of Scmap-cluster, Scmap-cell and scPred, respectively (<italic>p</italic> &lt; 0.05, Wilcoxon rank sum test) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a-d) (Additional file <xref rid="MOESM13" ref-type="media">13</xref>: Table S5), hinting gCAnno’s better performance than other methods on cell type annotation across different species (e.g. human or plant), organs (e.g. liver or pancreases), or disease states (e.g. health or cancer). In 20 mouse organs dataset, the comprehensive kappa coefficient of both gCAnno were 0.74 (gCAnno-Bayes) and 0.94 (gCAnno-SVM), and other methods achieve 0.16 (Scmap-cluster), 0.18 (Scmap-cell), 0.80 (Chetah), 0.63 (scPred) and 0.92 (SVM), respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). We found that gCAnno-SVM achieved highest performance than other methods in large dataset with deep annotation level (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S2; Additional file <xref rid="MOESM14" ref-type="media">14</xref>: Figure S8).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The list of scRNA-seq datasets in overall performance test</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>#Cells</th><th>#Genes</th><th># Cell types</th></tr></thead><tbody><tr><td>Liver [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td>8444</td><td>20,007</td><td>14</td></tr><tr><td>Pancreas [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td>8562</td><td>20,126</td><td>13</td></tr><tr><td>AT root [<xref ref-type="bibr" rid="CR6">6</xref>]</td><td>7053</td><td>32,833</td><td>19</td></tr><tr><td>HCC, ICCA [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td>4729</td><td>19,379</td><td>8</td></tr></tbody></table><table-wrap-foot><p># means the number of</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>Overall performance evaluation. Comparisons of gCAnno with Scmap-Cluster, Scmap-Cell, scPred, Chetah and SVM based on kappa coefficient on <bold>a</bold> liver dataset, <bold>b</bold> pancreas dataset, <bold>c</bold> HCC &amp; ICCA dataset, and <bold>d</bold> AT root dataset. *: <italic>p</italic>-values &lt; 0.1; **: <italic>p</italic>-values &lt; 0.05; ***: <italic>p</italic>-values &lt; 0.01, Wilcoxon rank sum test. The number is the mean of five cross validation. The error bar is the standard deviation. The <italic>y</italic>-axis is the kappa coefficient</p></caption><graphic xlink:href="12864_2020_7223_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Robustness on dropout and imbalance noisy data</title>
      <p id="Par20">Besides basic accuracy, we examined its robustness in the presence of different types of noises. Dropout and cell count imbalance noises are two major types and the most challenging in scRNA-seq data. Dropout is a technical noise in the form of missing value in gene expression [<xref ref-type="bibr" rid="CR10">10</xref>], while cell number imbalance among cell types is coming from biology itself. We found gCAnno achieved the highest and rather stable kappa coefficients for both reference dropout and query dropout tests in four datasets (Fig. <xref rid="Fig4" ref-type="fig">4</xref>; Additional file <xref rid="MOESM15" ref-type="media">15</xref>: Figure S9; Additional file <xref rid="MOESM16" ref-type="media">16</xref>: Table S6; Additional file <xref rid="MOESM17" ref-type="media">17</xref>: Figure S10). Remarkably, gCAnno achieved average kappa coefficients of 0.88 (gCAnno-SVM) and 0.79 (gCAnno-Bayes) even when dropout rate was as high as 50%, while other methods achieve 0 (Scmap-cluster), 0.44 (Scmap-cell), 0.37 (Chetah), 0.25 (scPred) and 0.79 (SVM), respectively. Moreover, we found gCAnno, SVM and Scmap-cell achieved the highest and stable kappa coefficients (average values are about 0.99) for different cell count imbalance ratios (Additional file <xref rid="MOESM15" ref-type="media">15</xref>: Figure S9; Additional file <xref rid="MOESM18" ref-type="media">18</xref>: Table S7). All of these results show gCAnno is better than other methods for dropout and cell count imbalance noises and achieved the best performance on highly noisy data (e.g. 50% dropout rate and 1:0.1 imbalance rate), suggesting the effectiveness of the wCGBG in selecting accurate features in the presence of high noise.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Robustness performance evaluation. Robustness of dropout noise comparisons of gCAnno with Scmap-Cluster, Scmap-Cell, scPred, Chetah and SVM on <bold>a</bold> liver reference dropout dataset, <bold>b</bold> liver query dropout dataset, <bold>c</bold> pancreas reference dropout dataset, <bold>d</bold> pancreas query dropout dataset. The middle point is the mean kappa coefficients of five-fold cross validation. The error bar is the standard deviation. The <italic>y</italic>-axis is the kappa coefficient and the <italic>x</italic>-axis is the dropout rate</p></caption><graphic xlink:href="12864_2020_7223_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Cross platform annotation</title>
      <p id="Par21">Different single cell sequencing platforms have platform specific features or bias [<xref ref-type="bibr" rid="CR19">19</xref>], limiting cross platform cell type annotation. We evaluated the platform compatibility of gCAnno on two liver datasets [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and two pancreas datasets [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] from four platforms (10x, mCel-seq2, Drop-seq, and Smart-seq2) (Table <xref rid="Tab2" ref-type="table">2</xref>). We used one platform dataset as the training data and the other as the testing data. For the performance comparison, gCAnno achieved consistently high kappa coefficient values for liver dataset tests (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a and b) and for pancreas dataset tests (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c and d) (Additional file <xref rid="MOESM19" ref-type="media">19</xref>: Table S8). These results show gCAnno is able to maintain high annotation accuracy for real heterogeneous and cross platform data in the presence of systematic platform specific bias.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>The list of scRNA-seq datasets in cross platform test</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>#Cells</th><th>#Genes</th><th># Cell types</th><th>Platform</th></tr></thead><tbody><tr><td>Liver [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td>8103</td><td>20,007</td><td>7</td><td>10x</td></tr><tr><td>Pancreas [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td>8037</td><td>20,126</td><td>9</td><td>Drop-seq</td></tr><tr><td>Liver [<xref ref-type="bibr" rid="CR20">20</xref>]</td><td>7130</td><td>33,941</td><td>7</td><td>mCel-seq2</td></tr><tr><td>Pancreas [<xref ref-type="bibr" rid="CR21">21</xref>]</td><td>2068</td><td>25,526</td><td>9</td><td>Smart-seq2</td></tr></tbody></table><table-wrap-foot><p># means the number of</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Platform compatibility evaluation. Performance comparisons of gCAnno with Scmap-Cluster, Scmap-Cell, scPred, Chetah and SVM on cross platform datasets. <bold>a</bold> liver datasets, where reference is mCel-seq2 and query is 10x; <bold>b</bold> liver datasets, where reference is 10x and query is mCel-seq2; <bold>c</bold> pancreas dataset, where reference is drop-seq and query is smart-seq2 <bold>d</bold> pancreas datasets, where reference is smart-seq2 and query is drop-seq. The reference is the training data and the query is the testing data</p></caption><graphic xlink:href="12864_2020_7223_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Runtime evaluation</title>
      <p id="Par22">Finally, we evaluated the runtime of gCAnno based on datasets in above tests (Additional file <xref rid="MOESM20" ref-type="media">20</xref>: Table S9; Additional file <xref rid="MOESM21" ref-type="media">21</xref>: Figure S11). We found that the time takes in model building (including graph construction and embedding) step is positive correlated with the number of graph nodes (Pearson’s correlation is 0.94). Once the model has been built, the annotation step only takes less than 1 min (e.g. for mCel-seq2 platform liver dataset with 8103 cells only takes 48 s).</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par23">In this study, we present gCAnno, a novel graph-based cell type identification method for scRNA-seq data. The most significant feature of gCAnno is the construction of wCGBG, enabling gCAnno to capture the global characteristics of association between cell types and genes. This feature allows gCAnno to detect accurate feature genes for each cell type, leading to accurate annotation results and robustness for different noise types and rates. In addition, gCAnno is able to annotate not only human scRNA-seq, but also plant scRNA-seq (e.g. Arabidopsis data) and its stable and high performance across two platforms.</p>
    <p id="Par24">gCAnno contains SVM version (gCAnno-SVM) and naïve Bayes version (gCAnno-Bayes). The SVM version takes into account the effect of expression value while naïve Bayes version only considers the existence of cell type specific genes. From the evaluation result, the SVM version seems suitable for the dataset with deep annotation level and contains largely similar cell types between training and test sets. However, in cross platform datasets from different studies and different sequencing platforms, gene expression value might fluctuate significantly, rendering better performance of naïve Bayes version than SVM version.</p>
    <p id="Par25">Since gCAnno is a reference-based cell type annotation method, it lacks the ability to identify novel cell types. For novel type cells, gCAnno assigns the closest cell types with the most similar expression profiles to them, which might be reasonable in most of applications but probably require further improvement. Integrating the biomarker-based method for novel cell type annotation and reference-based method for accurate pre-defined cell type annotation, we think, will be one direction to explore.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par26">We have implemented a stable and high-performance automated cell type annotation tool, gCAnno, for scRNA-seq datasets. With an easy use Python running script as an example, we hope gCAnno will be useful for the scRNA-seq data analysis.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <p id="Par27">Here we summarized the framework of gCAnno. gCAnno adopts graph structure for cell type specific gene set detection and accurate cell type annotation. Firstly, gCAnno builds cell type-gene bipartite graph based on gene expression abundances and intensities, in which gene expression abundance is the proportion of cells expressing the gene in a given cell type while intensity is the average expression in cells expressing the gene. Then, graph embedding is adopted to obtain the embedding vectors of gene nodes and cell type nodes. Next, gCAnno selects a set of genes for each cell type with similar profiles in the embedding space. Finally, based on the detected cell type specific genes, gCAnno trains naïve Bayes and SVM classifiers. The workflow of gCAnno is depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
    <sec id="Sec11">
      <title>Cell type-gene bipartite graph construction</title>
      <p id="Par28">Starting from the well-annotated reference scRNA-seq data, we constructed a weighted cell type-gene bipartite graph (wCGBG) containing both cell type nodes (CTN) and gene nodes (GN). Edges between CTN and GN indicate the correlation of a gene and a cell type while weight <italic>W</italic> measures significance of correlation. The weight is calculated by:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {w}_{k,j}=\Big\{{\displaystyle \begin{array}{l}\frac{m_{k,j}}{n_k}\times mean\left(\overrightarrow{g_{k,j}}\right),\kern2em if\kern1em {n}_k\ne 0\\ {}0\kern7.8em ,\kern2em others\end{array}}\operatorname{} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mn>0</mml:mn><mml:mspace width="7.8em"/><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:math><graphic xlink:href="12864_2020_7223_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic><sub><italic>k</italic></sub> is the cell count of cell type <italic>k</italic>, <italic>m</italic><sub><italic>j</italic>, <italic>k</italic></sub> is the number of cells expressed gene <italic>j</italic> in cell type <italic>k</italic>. <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{g_{j,k}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2020_7223_Article_IEq1.gif"/></alternatives></inline-formula> is the expression vector of gene <italic>j</italic> in cell type <italic>k</italic>. <italic>W</italic> is the product of the gene expression abundance and intensity. We use gene expression abundance and intensity to establish a relationship between cell types and genes in the form of proportion to reduce the impact of individual gene loss (dropout) or cell number imbalance.</p>
    </sec>
    <sec id="Sec12">
      <title>Graph embedding and cell type-gene specific relation detection</title>
      <p id="Par29">After wCGBG construction, we used node2vec to obtain the low dimensional vectors (the embedding vectors) of gene nodes and cell type nodes. The first step is construction of a neighborhood set <italic>N</italic>(<italic>u</italic>) of each node <italic>u</italic> (either gene or cell type node) by a probability walk [<xref ref-type="bibr" rid="CR22">22</xref>]. Then, we optimized the following objective function <italic>f</italic>(<italic>u</italic>) by maximizing the log-probability of observing a neighborhood set.
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\max}_f\sum \limits_{u\in V}\log P\left(N(u)|f(u)\right) $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mo>max</mml:mo><mml:mi>f</mml:mi></mml:msub><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2020_7223_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par30">This optimization step enables the embedding vectors to capture the specificity and strength of interactions between cell node and gene node, e.g. if one gene is specific and highly expressed in one cell type, the corresponding two embedding vectors are similar. Then, we calculated Euclidean distance between the vector of genes and cell types. We selected top <italic>n</italic> (a user defined parameter, default <italic>n</italic> = 65, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1) closest genes for each cell type as the cell type specific gene set based on the overall performance on the five datasets we used [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Classifier construction</title>
      <p id="Par31">After obtaining the cell type specific gene set, we build naïve Bayes (gCAnno-Bayes) and SVM (gCAnno-SVM) classifiers for annotation. For gCAnno-SVM, we directly use the expression of cell type specific genes as features to train an SVM classifier. For gCAnno-Bayes, we build a binary matrix to presents cell type and its corresponding specific genes, e.g. the element <italic>b</italic><sub><italic>ij</italic></sub> = 1 indicates gene <italic>j</italic> is one of the specific genes in cell type <italic>i</italic>. We train a Bernoulli Naïve Bayes to get genes’ conditional probability in each cell type and the prior probability of cell types. The query dataset is binarized and the annotation is based on maximum posterior probability of single cell’s cell type specific genes expression.</p>
    </sec>
    <sec id="Sec14">
      <title>Performance measurement and dataset</title>
      <sec id="Sec15">
        <title>Performance assessment and comparison</title>
        <p id="Par32">Cell type annotation is a typical multi-classification problem. We applied kappa coefficient as the performance measurement of classification, defined as Eq. (<xref rid="Equ3" ref-type="">3</xref>).
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \kappa =\frac{p_o-{p}_e}{1-{p}_e},\kern0.5em {p}_o=\frac{N_{corr}}{N_t},\kern0.5em {p}_e=\frac{\sum \limits_{i=1}^K{a}_i\times {b}_i}{N_t\times {N}_t} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mtext mathvariant="italic">corr</mml:mtext></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_7223_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par33">where <italic>N</italic><sub>corr</sub> is the ratio of total number of cells with corrected cell type annotation, <italic>N</italic><sub>t</sub> is the total number of cells in the dataset, <italic>K</italic> is the number of truly cell types, <italic>a</italic><sub><italic>i</italic></sub> is the number of corrected annotated cells in the <italic>i</italic>-th cell type, and <italic>b</italic><sub><italic>i</italic></sub> is the number of cells in the <italic>i</italic>-th cell type, <italic>p</italic><sub><italic>o</italic></sub> is the accuracy, <italic>a</italic><sub><italic>i</italic></sub> × <italic>b</italic><sub><italic>i</italic></sub> is the product of the actual and predicted quantity, <italic>p</italic><sub><italic>e</italic></sub> punishes bias for unbalance evaluation.</p>
        <p id="Par34">To evaluate the performance of gCAnno, we performed both cross-validation test and independent heterogeneous test (cross-platform test). First, we adopted the five-fold cross-validation strategy following recent single cell analysis comparison published earlier [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] on four published datasets and simulated noise datasets to evaluate the overall and robustness performance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1). Then, we performed independent test on datasets from different sequencing platforms (the cross-platform testing) to evaluate the generalization capability of gCAnno.</p>
      </sec>
      <sec id="Sec16">
        <title>Tools in comparison</title>
        <p id="Par35">The calculation results of Scmap, Chetah and scPred were obtained from the corresponding publications [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. For SVM, we followed the previous report [<xref ref-type="bibr" rid="CR17">17</xref>] which is using drop-based method [<xref ref-type="bibr" rid="CR23">23</xref>] for feature selection.</p>
      </sec>
      <sec id="Sec17">
        <title>Datasets used in basic overall performance test</title>
        <p id="Par36">To illustrate the stable performance of gCAnno across various species and tissue types, we compared gCAnno with other methods using four published datasets, including liver, pancreas, <italic>Arabidopsis thaliana</italic> root (AT root), hepatocellular carcinoma and intrahepatic cholangiocarcinoma (HCC and ICCA) datasets (Table <xref rid="Tab1" ref-type="table">1</xref>; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1; Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S2; Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1). The true labels of the cells in each dataset are obtained from the corresponding publications.</p>
      </sec>
      <sec id="Sec18">
        <title>Large dataset with deep annotation level</title>
        <p id="Par37">To demonstrate the performance of gCAnno in large dataset (cell number more than 50,000) with deep annotation level (more than 20 cell types). We compared gCAnno with other methods in 20 mouse organs dataset with 54,246 cells, 29 cell types and 23,433 genes. The true labels of the cells in each dataset are also obtained from the original publications [<xref ref-type="bibr" rid="CR18">18</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1; Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S3; Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S2).</p>
      </sec>
      <sec id="Sec19">
        <title>Simulated dropout and imbalance datasets</title>
        <p id="Par38">To evaluate the robustness of gCAnno in the presence of dropout noise, we simulated different dropout rates in four above datasets (Table <xref rid="Tab1" ref-type="table">1</xref>), by modifying the expression level of a random gene subset (10, 20, 30, 40 and 50% of all genes) to zero (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1). Similarly, we used five-fold cross validation to evaluate its performance. In each validation, we simulated the dropout noise in either training group (reference dropout) or test group (query dropout), and calculated the kappa coefficient for each method.</p>
        <p id="Par39">To simulate the cell number imbalance noise, we randomly sampled different proportions (0.1:1, 0.3:1, 0.5:1, 0.7:1, 0.9:1, 1:0.9, 1:0.7, 1:0.5, 1:0.3 and 1:0.1) of cell count in two cell types (Hepatocyte and GamaDetaT) in liver dataset as the reference data for classifier constructing. To get more accuracy testing, this simulation was repeated five times (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1).</p>
      </sec>
      <sec id="Sec20">
        <title>Cross platform datasets</title>
        <p id="Par40">To compare cross platform performance (various studies using different sequencing platforms), we searched and identified four datasets suitable for this purpose, including two liver datasets from 10x and mCel-seq2 platforms and two pancreas datasets from drop-seq and smart-seq2 platforms (Table <xref rid="Tab2" ref-type="table">2</xref>). We noticed that the cell type annotation labels of the same tissue from different platforms are not identical. Thus, we unified the labels by removing cell types absent in either of the datasets (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S4; Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S3; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2020_7223_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold><bold>Figure S1.</bold> The test of gCAnno parameter top closest genes in five evaluation datasets. The parameter is stable in 25 to 85. When top gene select less than 5 (in all datasets) and more than 125 (in Arabidopsis and liver datasets), the performance are not well. In our evaluation, the default top closest genes in each cell type is 65 and user can adjustment by themselves.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2020_7223_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2:</bold><bold>File S1.</bold> Supplementary Materials, including data preparation, cell type information of each datasets, and supplementary methods.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12864_2020_7223_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3:</bold><bold>Figure S2.</bold> The tSNE plot of (a) liver, (b) pancreas, (c) HCC &amp; ICCA and (d) AT root datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12864_2020_7223_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4:</bold><bold>Table S1.</bold> The tSNE result, cell barcodes and cell type labels of (a) liver, (b) pancreas, (c) HCC &amp; ICCA and (d) AT root datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12864_2020_7223_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5:</bold><bold>Figure S3.</bold> The tSNE plot of a large dataset with deep annotation level (20 mouse organs).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12864_2020_7223_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6:</bold><bold>Table S2.</bold> The large dataset kappa coefficient result (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e) and tSNE result.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12864_2020_7223_MOESM7_ESM.pdf">
            <caption>
              <p><bold>Additional file 7:</bold><bold>Figure S4.</bold> The tSNE plot of (a) mCel-seq2 liver, (b) 10x liver, (c) Drop-seq pancreas and (d) Smart-seq2 pancreas.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12864_2020_7223_MOESM8_ESM.xlsx">
            <caption>
              <p><bold>Additional file 8:</bold><bold>Table S3.</bold> The tSNE result, cell barcodes and cell type labels of (a) mCel-seq2 liver, (b) 10x liver, (c) Drop-seq pancreas and (d) Smart-seq2 pancreas.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12864_2020_7223_MOESM9_ESM.pdf">
            <caption>
              <p><bold>Additional file 9:</bold><bold>Figure S5.</bold> The tSNE of embedding vectors of cell type nodes and gene nodes in four datasets. The selecting gene nodes are in red color and non-selecting gene nodes are in grey. The cell type nodes are blue triangles.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12864_2020_7223_MOESM10_ESM.pdf">
            <caption>
              <p><bold>Additional file 10:</bold><bold>Figure S6.</bold> An example of top 2 specific genes in each cell type of liver dataset. In tSNE plot, each gene specific expressed in corresponding cell type in red color. The shade of color means the expression value.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12864_2020_7223_MOESM11_ESM.pdf">
            <caption>
              <p><bold>Additional file 11:</bold><bold>Figure S7.</bold> The overlap of reported marker genes from the corresponding publications in four datasets with selected genes. The circle is selected genes and the square is not selected genes. The marker genes have different color and non-marker genes are gray.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12864_2020_7223_MOESM12_ESM.xlsx">
            <caption>
              <p><bold>Additional file 12:</bold><bold>Table S4.</bold> The statistic of select state of reported marker genes from the corresponding publications in four datasets with selected genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12864_2020_7223_MOESM13_ESM.xlsx">
            <caption>
              <p><bold>Additional file 13:</bold><bold>Table S5.</bold> The statistic of kappa coefficient in overall performance test (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-d).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12864_2020_7223_MOESM14_ESM.pdf">
            <caption>
              <p><bold>Additional file 14:</bold><bold>Figure S8.</bold> The heatmap of each cell type specific genes expression in large dataset (top closest gene number 65). It shows an obvious pattern in diagonal.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="12864_2020_7223_MOESM15_ESM.pdf">
            <caption>
              <p><bold>Additional file 15:</bold><bold>Figure S9.</bold> Comparisons of gCAnno with Scmap-Cluster, Scmap-Cell, scPred, Chetah and SVM on (a) HCC and ICCA reference dropout dataset, (b) HCC and ICCA query dropout dataset, (c) AT root reference dropout dataset, (d) AT root query dropout dataset and (e) imbalance dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM16">
          <media xlink:href="12864_2020_7223_MOESM16_ESM.xlsx">
            <caption>
              <p><bold>Additional file 16:</bold><bold>Table S6.</bold> The statistic of kappa coefficient in dropout test.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM17">
          <media xlink:href="12864_2020_7223_MOESM17_ESM.pdf">
            <caption>
              <p><bold>Additional file 17:</bold><bold>Figure S10.</bold> An example of the existence of selected cell type specific genes in liver ref. dropout test dataset. The red color in more than one type means these types shared this gene. With the increasing of dropout rate, the degree of shared specific genes increased a little, but the specific pattern is still strong even in dropout rate 50%.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM18">
          <media xlink:href="12864_2020_7223_MOESM18_ESM.xlsx">
            <caption>
              <p><bold>Additional file 18:</bold><bold>Table S7.</bold> The statistic of kappa coefficient in imbalance test.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM19">
          <media xlink:href="12864_2020_7223_MOESM19_ESM.xlsx">
            <caption>
              <p><bold>Additional file 19:</bold><bold>Table S8.</bold> The statistic of kappa coefficient in cross platform test.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM20">
          <media xlink:href="12864_2020_7223_MOESM20_ESM.xlsx">
            <caption>
              <p><bold>Additional file 20:</bold><bold>Table S9.</bold> Runtime statistic of gCAnno.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM21">
          <media xlink:href="12864_2020_7223_MOESM21_ESM.pdf">
            <caption>
              <p><bold>Additional file 21:</bold><bold>Figure S11.</bold> The plot of building model time and graph scale. The building model time is correlated with graph node number (correlation coefficient is 0.94).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>kappa</term>
        <def>
          <p id="Par4">Kappa coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>DEGs</term>
        <def>
          <p id="Par5">Differentially expressed genes</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p id="Par6">Unique Molecular Identifier</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par7">Single-cell RNA-seq</p>
        </def>
      </def-item>
      <def-item>
        <term>PCs</term>
        <def>
          <p id="Par8">Principle components</p>
        </def>
      </def-item>
      <def-item>
        <term>HCA</term>
        <def>
          <p id="Par9">Human cell atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>wCGBG</term>
        <def>
          <p id="Par10">Weighted cell type-gene bipartite graph</p>
        </def>
      </def-item>
      <def-item>
        <term>10x</term>
        <def>
          <p id="Par11">10x Genomics platform</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par12">Support Vector Machine</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xiaofei Yang, Shenghan Gao and Tingjie Wang contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Yujing Liu, Peng Jia and Yongyong Kang for their important suggestions and feedback.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KY and XY conceived the study. SG and TW designed and performed the experiments. SG, TW and BY analysed the data. SG developed the program. XY and SG wrote the manuscript. SG and ND completed figures of manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China (2018YFC0910400, 2017YFC0907500 and 2018ZX10302205), the National Science Foundation of China (61702406 and 31671372), the General Financial Grant from the China Postdoctoral Science Foundation (2017 M623178) and the Fundamental Research Funds for the Central Universities (xzy012020012).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets used for the analyses in this study are summarized in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1. The source code of gCAnno is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xjtu-omics/gCAnno">https://github.com/xjtu-omics/gCAnno</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par41">This study used previously published data and did not obtain any new data directly involved humans, plants or animals.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par42">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par43">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The technology and biology of single-cell RNA sequencing</article-title>
        <source>Mol Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <issue>4</issue>
        <fpage>610</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.04.005</pub-id>
        <pub-id pub-id-type="pmid">26000846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bodeau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tuch</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Siddiqui</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>346</fpage>
        <lpage>360.e344</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacParland</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>XZ</given-names>
          </name>
          <name>
            <surname>Innes</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Bartczak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Gage</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Manuel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Khuu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Echeverri</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Linares</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell RNA sequencing of human liver reveals distinct intrahepatic macrophage populations</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>4383</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06318-7</pub-id>
        <pub-id pub-id-type="pmid">30348985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rae</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumor cell biodiversity drives microenvironmental reprogramming in liver cancer</article-title>
        <source>Cancer Cell</source>
        <year>2019</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>418</fpage>
        <lpage>430.e416</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2019.08.007</pub-id>
        <pub-id pub-id-type="pmid">31588021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>TQ</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZG</given-names>
          </name>
          <name>
            <surname>Shang</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>A single-cell RNA sequencing profiles the developmental landscape of Arabidopsis root</article-title>
        <source>Mol Plant</source>
        <year>2019</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molp.2019.04.004</pub-id>
        <pub-id pub-id-type="pmid">31004836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Whitsett</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SINCERA: a pipeline for single-cell RNA-Seq profiling analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>e1004575</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id>
        <pub-id pub-id-type="pmid">26600239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0535-3</pub-id>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>O'Flanagan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>JLP</given-names>
          </name>
          <name>
            <surname>Ceglia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wiens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hewitson</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0529-1</pub-id>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FCP</given-names>
          </name>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>16</issue>
        <fpage>e95</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz543</pub-id>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alquicira-Hernandez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sathe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>264</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1862-5</pub-id>
        <pub-id pub-id-type="pmid">31829268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Benoist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clatworthy</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human cell atlas</article-title>
        <source>Elife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>e27041</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.27041</pub-id>
        <pub-id pub-id-type="pmid">29206104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>194</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1795-z</pub-id>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Tabula Muris C</collab>
          <collab>Overall c</collab>
          <collab>Logistical c</collab>
          <collab>Organ c, processing</collab>
          <collab>Library p, sequencing</collab>
          <collab>Computational data a</collab>
          <collab>Cell type a</collab>
          <collab>Writing g</collab>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <issue>7727</issue>
        <fpage>367</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziegenhain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Parekh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guillaumet-Adkins</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smets</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leonhardt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hellmann</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Enard</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>65</volume>
        <issue>4</issue>
        <fpage>631</fpage>
        <lpage>643.e634</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id>
        <pub-id pub-id-type="pmid">28212749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aizarani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Saviano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sagar</surname>
          </name>
          <name>
            <surname>Mailly</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Pessaux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Baumert</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A human liver cell atlas reveals heterogeneity and epithelial progenitors</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>572</volume>
        <issue>7768</issue>
        <fpage>199</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1373-2</pub-id>
        <pub-id pub-id-type="pmid">31292543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Andreasson</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grover</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>node2vec: scalable feature learning for networks</article-title>
        <source>KDD</source>
        <year>2016</year>
        <volume>2016</volume>
        <fpage>855</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1145/2939672.2939754</pub-id>
        <pub-id pub-id-type="pmid">27853626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>M3Drop: dropout-based feature selection for scRNASeq</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>16</issue>
        <fpage>2865</fpage>
        <lpage>2867</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1044</pub-id>
        <pub-id pub-id-type="pmid">30590489</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
