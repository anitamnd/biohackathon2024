<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7332572</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa290</article-id>
    <article-id pub-id-type="publisher-id">btaa290</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>genozip: a fast and efficient compression tool for VCF files</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9794-6825</contrib-id>
        <name>
          <surname>Lan</surname>
          <given-names>Divon</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa290-cor1"/>
        <!--<email>divon.lan@adelaide.edu.au</email>-->
        <xref ref-type="aff" rid="btaa290-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4603-1473</contrib-id>
        <name>
          <surname>Tobler</surname>
          <given-names>Raymond</given-names>
        </name>
        <xref ref-type="aff" rid="btaa290-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Souilmi</surname>
          <given-names>Yassine</given-names>
        </name>
        <xref ref-type="author-notes" rid="btaa290-FM1"/>
        <xref ref-type="aff" rid="btaa290-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5550-9176</contrib-id>
        <name>
          <surname>Llamas</surname>
          <given-names>Bastien</given-names>
        </name>
        <xref ref-type="author-notes" rid="btaa290-FM1"/>
        <xref ref-type="aff" rid="btaa290-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa290-aff1"><institution>School of Biological Sciences</institution>, The Environment Institute, Faculty of Sciences, The University of Adelaide, Adelaide, SA 5005, <country country="AU">Australia</country></aff>
    <author-notes>
      <fn id="btaa290-FM1">
        <label>†</label>
        <p>The authors wish it to be known that, in their opinion, Yassine Souilmi and Bastien Llamas should be regarded as Joint Authors.</p>
      </fn>
      <corresp id="btaa290-cor1">To whom correspondence should be addressed. <email>divon.lan@adelaide.edu.au</email> or <email>bastien.llamas@adelaide.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-05-14">
      <day>14</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>13</issue>
    <fpage>4091</fpage>
    <lpage>4092</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa290.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p><monospace>genozip</monospace> is a new lossless compression tool for Variant Call Format (VCF) files. By applying field-specific algorithms and fully utilizing the available computational hardware, <monospace>genozip</monospace> achieves the highest compression ratios amongst existing lossless compression tools known to the authors, at speeds comparable with the fastest multi-threaded compressors.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><monospace>genozip</monospace> is freely available to non-commercial users. It can be installed via conda-forge, Docker Hub, or downloaded from github.com/divonlan/genozip.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000923</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>ARC DP190103705</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>ARC DECRA fellow</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE190101069</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>ARC Future Fellow</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FT170100448</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Large genomic projects are becoming increasingly common, resulting in Variant Call Format (VCF; <xref rid="btaa290-B2" ref-type="bibr">Danecek <italic>et al.</italic>, 2011</xref>) files comprising thousands of individual genomic datasets. Even in their compressed form, such files are very large (typically several GB), rapidly driving up the cost of long-term data storage and file transfer and spurring the development of more efficient compression algorithms.</p>
    <p>While a handful of new compression algorithms have recently emerged that work by compressing genotypes within VCF files (e.g. <xref rid="btaa290-B4" ref-type="bibr">Deorowicz and Danek, 2019</xref>; <xref rid="btaa290-B5" ref-type="bibr">Durbin, 2014</xref>; <xref rid="btaa290-B7" ref-type="bibr">Kelleher <italic>et al.</italic>, 2019</xref>), genotypes are only one data type represented in a VCF file, and are often only a minor contributor to the total data content. For example, in the file used as the real-world example in (<xref rid="btaa290-B5" ref-type="bibr">Durbin, 2014</xref>)—File1 in our benchmarks—the genotypes represent only 7.1% of the uncompressed VCF file data. Thus, it is clear that just compressing the genotypes is not sufficient as a compression strategy for VCF files.</p>
    <p>Here, we present <monospace>genozip</monospace>, a lossless compression tool that greatly improves genomic data compression by utilizing algorithms specific to the data types common to VCF files. <monospace>genozip</monospace> can handle VCF files of any ploidy, phasing structure or variant type with up to 99 alternate alleles per variant, along with any FORMAT and INFO data. While the primary objective of <monospace>genozip</monospace> is optimal packaging of genomic data for efficient and secure storage and distribution, it also includes capabilities for pipeline analyses.</p>
  </sec>
  <sec>
    <title>2 Software description</title>
    <p>The <monospace>genozip</monospace> package runs on all popular operating systems and includes four command line tools—<monospace>genozip</monospace>, <monospace>genounzip</monospace>, <monospace>genocat</monospace> and <monospace>genols</monospace>. <monospace>genozip</monospace> receives one or more .vcf, .vcf.gz, .vcf.bz2, .vcf.xz or .bcf files or urls (FTP or HTTP) as input, and outputs one or more .vcf.genozip files, while <monospace>genounzip</monospace> decompresses .vcf.genozip files back to .vcf or .vcf.gz format and <monospace>genols</monospace> provides statistics regarding the contents of .genozip files.</p>
    <p>To support seamless integration into analytical pipelines, the <monospace>genocat</monospace> command is provided to access data within .vcf.genozip files, and includes options like <monospace>–regions</monospace> and <monospace>–samples</monospace> that allow random access to data. Indexing is done as part of the compression and there is no separate indexing step or index file. In addition, the toolset is designed to enable use of standard input/output streams.</p>
    <p>By encrypting the data with –password (using 256 bit AES), genozip enables efficient and secure distribution of genomic files that comply with stringent privacy requirements. Data integrity is further ensured by generating an MD5 signature with <monospace>–md5.</monospace> Additionally, the -output option concatenates VCF files with identical samples and the original components can be regenerated using<monospace> –split</monospace>.</p>
    <p>We have included several additional options that allow the user to optimize compression according to their needs. First, the <monospace>–optimize</monospace> option improves compression by modifying data in some INFO and FORMAT subfields by rounding floating point numbers to 2 significant digits and capping Phred values. Note that in this case the VCF data are modified, and therefore the compression is not lossless, but this does not impact downstream analytical results. Second, the <monospace>–gtshark</monospace> option makes use of the <monospace>GTShark</monospace> algorithm (<xref rid="btaa290-B4" ref-type="bibr">Deorowicz and Danek, 2019</xref>) that improves compression ratios compared to using either <monospace>genozip</monospace> or <monospace>GTShark</monospace> alone (see Supplementary Material). Finally, the <monospace>–vblock</monospace> and <monospace>–sblock</monospace> options allow the user to control the tradeoff between compression and speed related to subsetting regions and samples.</p>
    <p>Note that some options require the appropriate tools to be installed: compressing .bcf files into .genozip format requires <monospace>bcftools</monospace>, compressing .xz files requires <monospace>XZ Utils</monospace> (<xref rid="btaa290-B1" ref-type="bibr">Collin, 2011</xref>), decompressing into .vcf.gz requires <monospace>bgzip</monospace>, using <monospace>–gtshark</monospace> requires <monospace>GTShark,</monospace> and compressing from an URL requires <monospace>cURL</monospace> (<xref rid="btaa290-B6" ref-type="bibr">Hostetter <italic>et al.</italic>, 1997</xref>).</p>
  </sec>
  <sec>
    <title>3 Benchmark</title>
    <p>To evaluate <monospace>genozip’</monospace>s performance, we compared its compression ratios and speeds on two different VCF files from <xref rid="btaa290-B9" ref-type="bibr">The 1000 Genomes Project Consortium (2012)</xref>—‘File1' which is rich in FORMAT subfields and 'File2' which is rich in genotype data (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>)—against a wide range of tools. All benchmarks were conducted on the same machine that has 56 physical cores (4 X Intel<sup>®</sup> Xeon<sup>®</sup> Gold 6132 CPU @ 2.60 GHz) and 755 GB of usable memory. More details, including benchmarks against genotype compression tools such as <monospace>BGT</monospace> (<xref rid="btaa290-B8" ref-type="bibr">Li, 2016</xref>) and <monospace>GTC</monospace> (<xref rid="btaa290-B3" ref-type="bibr">Danek and Deorowicz, 2018</xref>) that are not capable of compressing arbitrary VCF files losslessly are available in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
    <p>For both tested VCF files, the compression ratios achieved by <monospace>genozip</monospace> are considerably higher than other tested tools (<xref ref-type="fig" rid="btaa290-F1">Fig. 1a</xref>). Further, <monospace>genozip</monospace> offers one of the fastest compression/decompression speeds amongst the tested tools (<xref ref-type="fig" rid="btaa290-F1">Fig. 1b</xref>), indicating that performance gains are achieved without negatively impacting run times. To achieve high processing speeds, <monospace>genozip</monospace> implements an advanced memory and thread management strategy that scales across 10 s of cores (<xref ref-type="fig" rid="btaa290-F1">Fig. 1c</xref>).</p>
    <fig id="btaa290-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Benchmarking <monospace>genozip</monospace> performance. (<bold>a</bold>) Compression ratios for <monospace>genozip</monospace> using three different options relative to five other commonly used compression tools (see labels) for two VCF files, the FORMAT-subfields-rich data (<italic>x</italic>-axis) and genotype-rich data dominant (<italic>y</italic>-axis). (<bold>b</bold>) Compression (<italic>x</italic>-axis) and decompression (<italic>y</italic>-axis) rates for <monospace>genozip</monospace> and five other tools on the two VCF files (see inset key), and the rates (<bold>c</bold>) <monospace>genozip</monospace> execution scalability with used CPU cores (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>)</p>
      </caption>
      <graphic xlink:href="btaa290f1"/>
    </fig>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p><monospace>genozip</monospace> is a user friendly and fully featured compression software that readily integrates into any standard bioinformatics pipeline. <monospace>genozip</monospace> achieves compression ratios significantly better than other standard tools, by exploiting redundancies in the data that are specific to biological data and that are not evident by textual analysis alone. Moreover, <monospace>genozip</monospace> achieves significant gains to compression speed relative to other tools by taking full advantage of modern computational hardware, including multi-core processors and multi-gigabyte RAM, whenever available. By default, <monospace>genozip</monospace> dynamically balances its internal execution pipelines to maximize utilization of all the available resources.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa290_Supplementary_Data</label>
      <media xlink:href="btaa290_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Christian Huber, Heng Li and two anonymous reviewers for comments on the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>D.L. is supported by a scholarship from the University of Adelaide. Y.S. is supported by the Australian Research Council (ARC DP190103705). R.T. is an ARC DECRA fellow (DE190101069). B.L. is an ARC Future Fellow (FT170100448). </p>
      <p><italic>Conflict of Interest</italic>: D.L. intends to receive royalties from commercial users of <monospace>genozip</monospace>. </p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa290-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Collin</surname><given-names>L.</given-names></name></person-group> (<year>2011</year>) <italic>XZ Utils</italic>
<ext-link ext-link-type="uri" xlink:href="https://tukaani.org/xz/">https://tukaani.org/xz/</ext-link>. (1 April 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btaa290-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danecek</surname><given-names>P.</given-names></name></person-group><etal>et al</etal>; 1000 Genomes Project Analysis Group. (<year>2011</year>) 
<article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danek</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Deorowicz</surname><given-names>S.</given-names></name></person-group> (<year>2018</year>) 
<article-title>GTC: how to maintain huge genotype collections in a compressed form</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1834</fpage>–<lpage>1840</lpage>.<pub-id pub-id-type="pmid">29351600</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Deorowicz</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Danek</surname><given-names>A.</given-names></name></person-group> (<year>2019</year>) 
<article-title>GTShark: genotype compression in large projects</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4791</fpage>–<lpage>4793</lpage>.<pub-id pub-id-type="pmid">31225861</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Efficient haplotype matching and storage using the positional Burrows–Wheeler transform (PBWT)</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1266</fpage>–<lpage>1272</lpage>.<pub-id pub-id-type="pmid">24413527</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hostetter</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>Curl: a gentle slope language for the Web</article-title>. <source>World Wide Web J. Biol</source>., <volume>2</volume>, <fpage>121</fpage>–<lpage>134</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa290-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kelleher</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Inferring whole-genome histories in large population datasets</article-title>. <source>Nat. Genet</source>., <volume>51</volume>, <fpage>1330</fpage>–<lpage>1338</lpage>.<pub-id pub-id-type="pmid">31477934</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2016</year>) 
<article-title>BGT: efficient and flexible genotype query across many samples</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>590</fpage>–<lpage>592</lpage>.<pub-id pub-id-type="pmid">26500154</pub-id></mixed-citation>
    </ref>
    <ref id="btaa290-B9">
      <mixed-citation publication-type="journal">The 1000 Genomes Project Consortium (<year>2012</year>) 
<article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>, <volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
