<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6116485</article-id>
    <article-id pub-id-type="publisher-id">2336</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2336-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Rapid and precise alignment of raw reads against redundant databases with KMA</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8197-7520</contrib-id>
        <name>
          <surname>Clausen</surname>
          <given-names>Philip T. L. C.</given-names>
        </name>
        <address>
          <phone>+45 6071 9145</phone>
          <email>plan@food.dtu.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aarestrup</surname>
          <given-names>Frank M.</given-names>
        </name>
        <address>
          <email>fmaa@food.dtu.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lund</surname>
          <given-names>Ole</given-names>
        </name>
        <address>
          <email>olund@bioinformatics.dtu.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 8870</institution-id><institution-id institution-id-type="GRID">grid.5170.3</institution-id><institution>Department of Bioinformatics, </institution><institution>Technical University of Denmark, </institution></institution-wrap>2800 Kgs Lyngby, Denmark </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 8870</institution-id><institution-id institution-id-type="GRID">grid.5170.3</institution-id><institution>Research Group for Genomic Epidemiology, National Food Institute, </institution><institution>Technical University of Denmark, </institution></institution-wrap>2800 Kgs Lyngby, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>307</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">As the cost of sequencing has declined, clinical diagnostics based on next generation sequencing (NGS) have become reality. Diagnostics based on sequencing will require rapid and precise mapping against redundant databases because some of the most important determinants, such as antimicrobial resistance and core genome multilocus sequence typing (MLST) alleles, are highly similar to one another.</p>
        <p id="Par2">In order to facilitate this, a novel mapping method, KMA (<italic>k</italic>-mer alignment), was designed. KMA is able to map raw reads directly against redundant databases, it also scales well for large redundant databases. KMA uses <italic>k</italic>-mer seeding to speed up mapping and the Needleman-Wunsch algorithm to accurately align extensions from <italic>k</italic>-mer seeds. Multi-mapping reads are resolved using a novel sorting scheme (ConClave scheme), ensuring an accurate selection of templates.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">The functionality of KMA was compared with SRST2, MGmapper, BWA-MEM, Bowtie2, Minimap2 and Salmon, using both simulated data and a dataset of <italic>Escherichia coli</italic> mapped against resistance genes and core genome MLST alleles. KMA outperforms current methods with respect to both accuracy and speed, while using a comparable amount of memory.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par4">With KMA, it was possible map raw reads directly against redundant databases with high accuracy, speed and memory efficiency.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2336-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Union’s Horizon 2020 research and innovation programme</institution>
        </funding-source>
        <award-id>643476</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">In bioinformatics, the oldest and probably the single most important tool is the alignment of one or more sequences. Alignments informs us how similar a sequence is compared with another sequence and can be used to quantify the abundance of any similar sequence pattern. If the found pattern has an annotation, this can be transferred to the query sequence. The proper choice of alignment method is thus critical for the further investigations [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p id="Par13">Over the past decade several mapping methods have been developed that enable direct mapping of raw reads against target sequences. Previous studies have shown read-mapping based approaches to be superior to the more traditional methods where the reads are first assembled, and the assembly is hereafter BLAST’ed. against a database. The success of such methods are highly dictated by the quality of the assembly, because BLAST remains too slow to map the raw reads directly. Which is problematic within repeat and low depth regions of the genome, where the assembly often results in gaps between the assembled contigs, leading to missing data [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Today Bowtie2 [<xref ref-type="bibr" rid="CR4">4</xref>], BWA-MEM [<xref ref-type="bibr" rid="CR5">5</xref>] and Minimap2 [<xref ref-type="bibr" rid="CR6">6</xref>] are popular mapping methods that allows for fast mapping and alignment of raw reads against large reference genomes. All of these methods can be adapted to map against entire databases of sequences, but suffer from random selection when there is a tie for best match. In order to resolve these ties, several tools have been designed to resolve these random selections with extensive pre- and post-processing. Examples of these are SRST2 [<xref ref-type="bibr" rid="CR3">3</xref>] and MGmapper [<xref ref-type="bibr" rid="CR7">7</xref>] which both pre- and post-process the sequences for mapping with Bowtie2 and BWA-MEM, respectively. Other methods, such as Salmon [<xref ref-type="bibr" rid="CR8">8</xref>], uses the EM algorithm in order to estimate the sequencing level of homologous templates from mappings generated by traditional methods.</p>
    <p id="Par14">The redundant databases used in genomic epidemiology are however still posing a challenge regarding mapping raw reads directly. When databases are constantly updated with new sequences due to natural evolution, the results are in a constantly changing state, making clustering difficult. This feature of the databases makes direct mapping of raw reads troublesome, as there is no guarantee that the read will cover a unique part of a reference sequence, resulting in a tie for best match. Redundancy is a problem when mapping to bacterial databases, but to a lesser degree since these databases are not as redundant as some of the gene databases, and better use can be made of paired end reads since only one of the ends will often map to single genes. There is a need for new methods to resolve the issue with redundancy in an accurate and fast manner so that acute decisions can be made. In response to this need, a new alignment method, KMA (<italic>k</italic>-mer alignment), was developed. KMA introduces a novel sorting scheme, ConClave, in order to distinguish homologous templates.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par15">We introduce a novel alignment method, KMA, and scoring scheme, ConClave, which allows for mapping of raw reads directly against redundant databases. KMA diverges from known mappers by allowing redundancy within the databases, and KMA also produces consensus sequences and a result overview. KMA was created to be as intuitive and user friendly as possible, based on our current user demands and analysis challenges. In order to solve this, KMA works in five main steps: trimming of reads, heuristic <italic>k</italic>-mer mapping, fine alignment, ConClave scoring and reference assembly (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of step 1–4 of the KMA algorithm. 1: trim reads. 2. Match k-mers between query and database. 3a: Extend matching k-mer seeds, and identify regions with mismatches. 3b: Use the Needleman-Wunsch algorithm to align regions of mismatching k-mers. 4: Conclave scoring used to choose one best-aligning template per query sequence.</p></caption><graphic xlink:href="12859_2018_2336_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Heuristic <italic>k</italic>-mer mapping</title>
      <p id="Par16">When mapping against databases, a query sequence can fall within two categories: the query does not look like anything in the database or the query looks like something in the database. Depending on the database, it is therefore necessary to determine at an early stage whether alignment of a given sequence is feasible or if the sequence should be discarded from further analysis. Computationally, it is much faster to map raw reads against template sequences and determine their approximate origin than it is to perform alignment giving the exact differences between sequences. In order to exploit this, KMA maps <italic>k</italic>-mers between the query sequence and template database. The matching <italic>k</italic>-mers are then used to produce a mapping score where a matching <italic>k</italic>-mer is rewarded with a score of <italic>k</italic> while <italic>k</italic>-mer mismatches are penalized with − 1. For a query sequence to be accepted for alignment, it must have a positive score based on this mapping, equivalent to a minimum identity of (<italic>k</italic> + 1)<sup>− 1</sup> in <italic>k</italic>-mer space. In the case where a query sequence is accepted, the potential template candidates are limited by linking the matching <italic>k</italic>-mers to their respective template sequences.</p>
    </sec>
    <sec id="Sec4">
      <title>Fine alignment</title>
      <p id="Par17">KMA uses a hash map of indexed <italic>k</italic>-mers from which to start alignment, where this indexing is computed for templates passing the heuristic <italic>k</italic>-mer mapping. The indexed <italic>k</italic>-mers are then used as seeds from which to start alignment, where each matching seed is extended to give an optimal score. To enable a high resolution of gaps and mismatches, KMA utilizes the Needleman-Wunsch algorithm [<xref ref-type="bibr" rid="CR9">9</xref>] to align the pieces of query and template sequence between seed-extends. The tails of the alignment, before the first seed and after the last, are aligned with a specialized version of the Needleman-Wunsch algorithm allowing for early stopping so that leading and trailing gaps can be skipped.</p>
    </sec>
    <sec id="Sec5">
      <title>ConClave scoring</title>
      <p id="Par18">As KMA is designed to map sequences against redundant databases, the possibility of a tie for best matching template should be considered more as rule than an exception. For KMA to be able to find the one most likely template for each query sequence, a novel scoring scheme, ConClave, was developed.</p>
      <p id="Par19">The ConClave scoring scheme requires that all best matching templates are initially accepted for all best matching query sequences. The alignment scores obtained are then summed together for each template candidate in order to form the ConClave score, in this way reflecting a maximum score for each template. For alignments where ties do not occur, a second score is conducted as the unique ConClave score, which are used to reflect the unique alignments.</p>
      <p id="Par20">Ties for best matching templates can now be resolved by choosing the most likely template based on the ConClave score. In case of a tie on the ConClave score, the unique ConClave score is used to choose a best matching template. For samples were two templates are equally well-suited candidates, reflected by identical ConClave scores, the algorithm will choose the first sequence added to the database.</p>
    </sec>
    <sec id="Sec6">
      <title>Reference assembly</title>
      <p id="Par21">The ConClave scoring and alignment of reads enables assembly guided by a reference, resulting in a consensus sequence for the given reference / template. From the alignment, the differences between each read and the associated template are known, and this gives information about which nucleotides are called at each position in the template. Each nucleotide is then determined by majority voting, where the strength of the called nucleotide is tested with a McNemar test, giving a robust base calling performance across different sequencing platforms [<xref ref-type="bibr" rid="CR10">10</xref>]. In case a nucleotide is not significantly overrepresented according to the McNemar test (according to a user specified α, default 0.05), it is reported in lower case.</p>
      <p id="Par22">After reference assembly, statistics for each template are collected in a single file, containing features such as template identity, coverage and depth.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance evaluation and comparison</title>
      <p id="Par23">The performance of KMA was evaluated on a dataset of 13 <italic>Escherichia coli</italic> from Grad et al. (2012). The dataset included 11 <italic>E. coli</italic> from the German / French outbreak in 2011 and two historical <italic>E. coli</italic> [<xref ref-type="bibr" rid="CR11">11</xref>]. Phenotypic susceptibility tests were known for all of the 13 <italic>E. coli</italic>, and the presence of the beta-lactamase blaCTX-M-15 were verified by PCR [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
      <p id="Par24">The 13 <italic>E. coli</italic> were mapped to the ResFinder database of known resistance genes [<xref ref-type="bibr" rid="CR12">12</xref>], where the associated phenotype of each gene were compared with phenotypic susceptibility tests.</p>
      <p id="Par25">In order to measure the performance on larger databases, a core genome MLST (cgMLST) database for <italic>E. coli</italic> was downloaded from EnteroBase (available at: <ext-link ext-link-type="uri" xlink:href="http://enterobase.warwick.ac.uk">http://enterobase.warwick.ac.uk</ext-link> [Accessed 18 January 2018]. The cgMLST scheme contains 2447741 closely related genes, which together matches the size of the human genome.</p>
      <p id="Par26">KMA was compared with six different methods: SRST2 (v. 0.1.8) [<xref ref-type="bibr" rid="CR3">3</xref>], MGmapper (v. 2.7) [<xref ref-type="bibr" rid="CR7">7</xref>], BWA-MEM (v- 0.7.15) [<xref ref-type="bibr" rid="CR5">5</xref>], Bowtie2 (v. 2.2.4) [<xref ref-type="bibr" rid="CR4">4</xref>], MiniMap2 (v. 2.6) [<xref ref-type="bibr" rid="CR6">6</xref>] and Salmon (v. 0.9.1) [<xref ref-type="bibr" rid="CR8">8</xref>], each capable of mapping raw reads directly against entire databases of sequences.</p>
      <p id="Par27">SRST2 uses Bowtie2 to map against a homology-reduced database, clustered at 90% identity using CD-hit [<xref ref-type="bibr" rid="CR13">13</xref>]. From each cluster, one allele is chosen, as the one with the highest alignment score from all alignments towards that cluster. After mapping and alignment, SRST2 performs SNP calling and reports the differences between query and template sequences [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
      <p id="Par28">For MGmapper to accept a template, it has to contain at least one unique mapping read when mapped with BWA-MEM. After mapping the reads, MGmapper reports the depth and template coverage of the accepted genes [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
      <p id="Par29">Salmon was developed for quantifying RNA transcript levels using the EM-algorithm. Which partially matches the redundant database problem, as only a subset of the templates in the database are likely to be present. Salmon can be used as an extension to BWA-MEM, Bowtie2 and Minimap2, when the alignment method is set to report several alignments per read [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par30">SAMtools and BEDTools were used to estimate depth and template coverage of mappings performed with BWA-MEM, Bowtie2 and Minimap2 so that these could be used for a more direct comparison as well [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par31">To prove the difficulty of mapping raw reads directly against redundant databases, a simulated dataset of single-end and paired-end reads was created, where each gene in the ResFinder database was split into raw reads with a length 100 bp, and an insert size of 250 for the paired end set. Error and indel rates were set to zero so that the simulated reads would represent the perfect case scenario of short-read sequencers. Meaning, that any inconsistencies from the mapping methods, would reveal each of their weaknesses in mapping against redundant databases, and give a clear view of their assumptions. Simulated reads were created with chopDB, which is included alongside the commands used to compare KMA with existing methods and the ResFinder database.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p id="Par32">Salmon was not used in combination with Minimap2, because Minimap2 did not report more than one alignment per read no matter how the “-N” and “-p” options were set.</p>
    <sec id="Sec9">
      <title>Simulated datasets</title>
      <p id="Par33">For the simulated datasets, the comparison was straight forward as the location of every read was known.</p>
      <p id="Par34">For both the single and paired-end datasets, KMA mapped everything correctly, where every read in each sample was mapped to the correct template only (see Table <xref rid="Tab1" ref-type="table">1</xref>). For all samples, SRST2 mapped almost all reads to the correct template, only differing by a read in most cases. However, since SRST2 allows for one read to map towards several templates and even several places within each template, a large number of false positives were achieved, thus giving a lower correlation score (see Table <xref rid="Tab1" ref-type="table">1</xref>). For a few genes, SRST2 accepted up to 21 alignments (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). MGmapper did not assign any false positives, but underestimated the depth of the correct templates. This was especially the case for the paired-end dataset where MGmapper seemingly had trouble with coupling of the reads. This resulted in MGmapper only being able to assign 19.6% of the actual reads. BWA-MEM and MiniMap2 follow a similar pattern compared with MGmapper, where the methods are driven towards false negatives (FN). They do however perform better on the paired end reads. In contrast to the other methods tested, Bowtie2 has a more equal distribution between false positives (FP) and FN. Only BWA-MEM had improved predictions when post processed with Salmon, but only fro the single end reads, whereas Bowtie2 had a performance decrease, on both the single and paired end datasets (see Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of KMA, SRST2, MGmapper, BWA-MEM, Bowtie2, Minimap2 and Salmon, on simulated data generated from the ResFinder database. A minimum mapping quality of 1 was used to ensure reproducibility</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Method / Performance</th><th colspan="3">Single end read set</th><th colspan="3">Paired end read set</th></tr><tr><th>MCC</th><th>Sensitivity</th><th>PPV</th><th>MCC</th><th>Sensitivity</th><th>PPV</th></tr></thead><tbody><tr><td>KMA</td><td>1.000</td><td>1.000</td><td>1.000</td><td>1.000</td><td>1.000</td><td>1.000</td></tr><tr><td>SRST2</td><td>0.591</td><td>0.999</td><td>0.350</td><td>0.659</td><td>0.999</td><td>0.436</td></tr><tr><td>MGmapper</td><td>0.676</td><td>0.457</td><td>1.000</td><td>0.443</td><td>0.196</td><td>1.000</td></tr><tr><td>BWA-MEM</td><td>0.585</td><td>0.342</td><td>1.000</td><td>0.580</td><td>0.337</td><td>1.000</td></tr><tr><td>Bowtie2</td><td>0.480</td><td>0.480</td><td>0.480</td><td>0.577</td><td>0.577</td><td>0.577</td></tr><tr><td>Minimap2</td><td>0.591</td><td>0.353</td><td>0.988</td><td>0.671</td><td>0.455</td><td>0.991</td></tr><tr><td>BWA-MEM / Salmon</td><td>0.720</td><td>0.720</td><td>0.720</td><td>0.500</td><td>0.353</td><td>0.707</td></tr><tr><td>Bowtie2 / Salmon</td><td>0.390</td><td>0.389</td><td>0.398</td><td>0.250</td><td>0.177</td><td>0.368</td></tr></tbody></table><table-wrap-foot><p><italic>MCC</italic> Matthews correlation coefficient<italic>, PPV</italic> Positive Prediction Value</p></table-wrap-foot></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>Distribution of false positives (FP) and false negatives (FN), for KMA, SRST2, MGmapper, Bowtie2, BWA-MEM, MiniMap2 and Bowtie2 and BWA-MEM post processed with Salmon when mapping simulated reads from the ResFinder database back to the ResFinder database. A minimum mapping quality of 1 was used to ensure reproducibility.</p></caption><graphic xlink:href="12859_2018_2336_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>German / French <italic>E. coli</italic> outbreak</title>
      <p id="Par35">Ninety percent template coverage, 90% template identity and a minimum depth of 5 were the thresholds for predicting genes with KMA and SRST2. The identity threshold was skipped for MGmapper and methods post processed by SAMtools and BEDTools because introducing an identity threshold would require further post-processing, while only giving lower correlation scores. Only the depth threshold was used for Salmon, because Salmon only estimates the transcript levels of each template. Meaning that the exact location of each read is lost, making the analysis of template coverage and identity impossible.</p>
      <p id="Par36">MGmapper crashed when mapping the paired end reads, but succeeded in single end mode when only the forward reads were used. Paired end reads were converted to interleaved format for BWA-MEM because it crashed when the reads were split into two files.</p>
    </sec>
    <sec id="Sec11">
      <title>Predicting antimicrobial resistance</title>
      <p id="Par37">Full concordance between phenotypic susceptibility tests and the predicted antimicrobial resistance genes were achieved for both KMA and SRST2. Results for nalidixic acid resistance were excluded, since it is caused by chromosomal resistance genes that were not included in this study [<xref ref-type="bibr" rid="CR16">16</xref>]. The only disagreement between KMA and SRST2 for this dataset were that SRST2 predicted the presence of dfrA17 and dfrA32 in addition to the dfrA7 gene predicted by KMA, in all of the outbreak strains (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). A closer examination of this result revealed that the two additional genes predicted by SRST2 were due to multi mapping reads between them and dfrA7.</p>
      <p id="Par38">As for the simulated dataset, MGmapper had no FP predictions, but it missed most of the phenotypes. Even though the outbreak strains are thought to be highly similar, the results from MGmapper showed a highly diverse pattern between the samples (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Neither BWA-MEM, Bowtie2 nor Minimap2 predicted any genes exceeding the thresholds, no matter the settings of SAMtools and BEDTools (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
      <p id="Par39">Better results were achieved for BWA-MEM and Bowtie2 when using Salmon, raising their correlation coefficient to 0.828 and 0.623, respectively (see Table <xref rid="Tab2" ref-type="table">2</xref>). As for SRST2, the post-processing with Salmon gave several different hits for each allele, giving a bias towards FP. BWA-MEM combined with Salmon gave the same results for all outbreak strains, with no false negatives. A single false positive did however show up in all of the outbreak strains, the catB4 gene conferring resistance to chloramphenicol, which were tested phenotypically determined as susceptible. No clear pattern was observed for Bowtie2 combined with Salmon, where the predicted genes showed a diverse pattern across all outbreak strains.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance measures of KMA, SRST2, MGmapper, BWA-MEM, Bowtie2, Minimap2 and Salmon, for predicting genes directly from raw reads. Thresholds for predicting a gene has been set to: 90% coverage, 90% identity and a minimum depth of 5. A minimum mapping quality of 10 was used for methods relying on post processing with SAMtools and BEDTools, as this gave the best performance across the tested thresholds</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Mapping method</th><th>Post- processing method</th><th>Avg. mapping CPU time</th><th>Avg. post- processing CPU time</th><th>Peak memory</th><th>MCC</th></tr></thead><tbody><tr><td colspan="6">Predicting antimicrobial resistance</td></tr><tr><td> KMA</td><td>NA</td><td>00:00:24.6</td><td>NA</td><td>42.3 MB</td><td>1.000</td></tr><tr><td> SRST2</td><td>NA</td><td>00:10:21.3</td><td>NA</td><td>165.0 MB</td><td>1.000</td></tr><tr><td> MGmapper<sup>a</sup></td><td>NA</td><td>00:13:14.2</td><td>NA</td><td>101.4 MB</td><td>0.288</td></tr><tr><td> BWA-MEM</td><td>SAMtools / BEDTools</td><td>00:07:35.5</td><td>00:00:06.1</td><td>113.0 MB</td><td>0.000</td></tr><tr><td> BWA-MEM<sup>b</sup></td><td>Salmon</td><td>00:07:34.5</td><td>00:00:12.2</td><td>694.9 MB</td><td>0.828</td></tr><tr><td> Bowtie2</td><td>SAMtools / BEDTools</td><td>00:02:35.5</td><td>00:00:06.7</td><td>33.7 MB</td><td>0.000</td></tr><tr><td> Bowtie2<sup>b</sup></td><td>Salmon</td><td>00:03:16.4</td><td>00:02:24.5</td><td>935.8 MB</td><td>0.623</td></tr><tr><td> Minimap2</td><td>SAMtools / BEDTools</td><td>00:02:18.6</td><td>00:00:06.0</td><td>517.3 MB</td><td>0.000</td></tr><tr><td colspan="6">Mapping towards cgMLST alleles</td></tr><tr><td> KMA</td><td>NA</td><td>00:07:02.1</td><td>NA</td><td>8.3 GB</td><td>0.998</td></tr><tr><td> SRST2</td><td>NA</td><td>&gt; 99:99:99.9</td><td>NA</td><td>NA</td><td>NA</td></tr><tr><td> MGmapper<sup>a</sup></td><td>NA</td><td>01:23:21.5</td><td>NA</td><td>8.7 GB</td><td>0.062</td></tr><tr><td> BWA-MEM</td><td>SAMtools / BEDTools</td><td>02:14:50.8</td><td>00:14:06.7</td><td>8.9 GB</td><td>0.021</td></tr><tr><td> BWA-MEM<sup>b</sup></td><td>Salmon</td><td>03:22:45.4</td><td>04:41:09.6</td><td>104.2 GB<sup>P</sup></td><td>0.530</td></tr><tr><td> Bowtie2</td><td>SAMtools / BEDTools</td><td>01:50:56.8</td><td>00:15:23.5</td><td>4.1 GB</td><td>0.035</td></tr><tr><td> Bowtie2<sup>b</sup></td><td>Salmon</td><td>&gt; 99:99:99.9</td><td>NA</td><td>NA</td><td>NA</td></tr><tr><td> Minimap2</td><td>SAMtools / BEDTools</td><td>01:20:56.2</td><td>00:13:11.7</td><td>33.6 GB</td><td>0.035</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup> MGmapper was executed on the forward reads only, as paired end mode crashed</p><p><sup>b</sup> Report all alignments</p><p><sup>P</sup> The post processing method was responsible for the peak memory consumption</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Mapping towards cgMLST alleles</title>
      <p id="Par40">The performance of each method was measured as their ability to find one allele within each locus of the cgMLST database, which together make the core genome of the bacteria.</p>
      <p id="Par41">As for the antimicrobial resistance genes, BWA-MEM, Bowtie2 and Minimap2 had trouble assigning genes exceeding the thresholds, thus giving a low correlation coefficient (see Table <xref rid="Tab2" ref-type="table">2</xref>). The performance of MGmapper was slightly better than that of BWA-MEM used directly, giving a correlation of 0.062 compared with BWA-MEM with a correlation of 0.021 (see Table <xref rid="Tab2" ref-type="table">2</xref>). As for the resistance gene prediction, the correlation of BWA-MEM was improved when using Salmon. In this case, however, Salmon did take up the majority of the computational resources when compared with the mapping. When estimating the allele abundances, Salmon had a peak memory consumption of 104.2 GB, and used more time on the post-processing than BWA-MEM used on mapping (see Table <xref rid="Tab2" ref-type="table">2</xref>). KMA outperformed all of the methods with a correlation of 0.998, only missing two genes and detecting three duplicates on average.</p>
      <p id="Par42">SRST2 and Bowtie2 combined with Salmon were stopped after 100 h, where neither method had completed a single sample.</p>
    </sec>
    <sec id="Sec13">
      <title>Runtime analysis</title>
      <p id="Par43">CPU time and peak memory requirements were measured with GNU time (v1.7), mapping and post-processing were measured separately for all methods, unless included in the method. KMA outperformed all of the existing methods on speed when mapping both resistance genes and cgMLST genes. The memory usage of KMA was above that of Bowtie2, but just below that of MGmapper and BWA-MEM, and less than a fourth of MiniMap2 (see Table <xref rid="Tab2" ref-type="table">2</xref>). The memory consumption and speed of KMA is thus feasible to carry out on a laptop, with results accurate enough to be used in surveillance.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par44">BWA-MEM, Bowtie2 and Minimap2 were not designed to map against redundant databases, as they are based on unique mappings and therefore do not deal with multi mapping reads. This is also reflected by MGmapper, albeit relying on only one unique mapping.</p>
    <p id="Par45">Salmon was designed to predict RNA transcript levels, which includes a certain level of redundancy. The expression pattern seen in bacteria differs from that of eukaryotes, which Salmon was designed for, explaining some of the variation seen here. Salmon does, however, improve the predictions when used with BWA-MEM, with the major problem being over prediction, resulting in a number of FPs. Even though Salmon provides better predictions, it is hard to control the output because alignments are not included. This makes it difficult to sort out partial mapping templates, which might have improved the predictions.</p>
    <p id="Par46">SRST2 uses clustering of the template database in order to minimize the redundancy problem. It then uses Bowtie2 to map against the clusters and accepts all mappings, meaning that a single read can be assigned to several clusters. This is where SRST2 has its major drawback, as the clustering does not reflect the mapping performed afterwards. As recommended by SRST2, the databases were clustered with a 90% similarity threshold using CD-hit [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. However, two sequences being less than 90% identical can still share large stretches of identical DNA, opening the possibility for ties on a best matching template, which reduces the PPV for SRST2. Clustering based on identity will thus not give a non-redundant database, but rather make a stochastic limitation of the redundancy. This clustering of SRST2 may therefore be solved by clustering sequences together with long identical stretches of DNA, where the length of the stretch should conform to the read length used to map afterwards. When predicting phenotypic susceptibility, this feature of SRST2 is of less importance, as long as SRST2 finds at least one allele for each of the resistance genes present.</p>
    <p id="Par47">KMA was designed as a specialized solution for mapping against redundant databases, such as those seen in genomic epidemiology, and is therefore not a general solution compared with BWA-MEM, Bowtie2 and Minimap2. The memory usage of the index used with KMA is not linear, and is dependent on the redundancy within a given database. The higher the redundancy the slower the increase is in database size, whereas for non-redundant databases the indexing will grow faster than for BWA-MEM and Bowtie2.</p>
    <p id="Par48">BWA-MEM, Bowtie2 and Minimap2 have a large variety of parameters to set, but none of the parameters seem to have a dramatic effect on the results achieved here.</p>
    <p id="Par49">The ConClave scoring scheme is the major difference between KMA and the methods compared, with respect to the prediction performance. If the ConClave scoring had been adapted to analyze SAM-format, BWA-MEM and Bowtie2 would probably have had a similar prediction performance compared with that of KMA. The speed advantage of KMA lies mainly in the heuristic <italic>k</italic>-mer mapping, which makes KMA able to discard non-mapping sequences at an early state or at least limit the search space.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par50">Alignment of sequences plays a crucial role in bioinformatics, and is often the cornerstone in sequence analysis. Choosing the right alignment method for the right problem is thus evident for the further analysis. For aligning raw reads directly against redundant databases, KMA outperforms existing methods on both speed, precision and sensitivity.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2336_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>Table S1 includes a detailed overview of the predicted resistance genes from each sample, using the methods described in this study. Table S2 extends Table <xref rid="Tab2" ref-type="table">2</xref>, by measuring Matthews correlation coefficient under different thresholds on mapping quality and whether the reads are properly paired. (DOCX 79 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>FN</term>
        <def>
          <p id="Par5">False negative</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p id="Par6">False positive</p>
        </def>
      </def-item>
      <def-item>
        <term>MCC</term>
        <def>
          <p id="Par7">Matthews correlation coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>MLST</term>
        <def>
          <p id="Par8">Multi locus sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>PPV</term>
        <def>
          <p id="Par9">Positive predictive value</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p id="Par10">True negative</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p id="Par11">True positive</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful for the feedback from our current core users of KMA, who have helped achieve the desired output of KMA: Pimlapas Leekitcharoenphon, Rolf S. Kaas, Camilla Hundahl, Judit Szarvas, Rosa L. Allesøe, Camilla K. Lemvigh, Henrik Hasman, Søren Overballe-Petersen, Mette V. Larsen &amp; Vanessa R. Marcelino.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par57">This study has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement no 643476 (COMPARE) and the Center for Genomic Epidemiology (Grant 09–067103/DSF).</p>
      <p id="Par58">The funding body did not play any role in the design of the study, writing of the manuscript nor did they have any influence on the data collection, analysis or interpretation of the data and results.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par59">The <italic>E. coli</italic> sequences with the following accession number: SRR341549, SRR341551, SRR341552, SRR341555, SRR341557, SRR341559, SRR341561, SRR341563, SRR341565, SRR341567, SRR341569, SRR341571, SRR341580, were downloaded from SRA: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>. The cgMLST database for <italic>E. coli</italic> was downloaded from Enterobase [online] <ext-link ext-link-type="uri" xlink:href="http://enterobase.warwick.ac.uk">Enterobase.warwick.ac.uk</ext-link>: <ext-link ext-link-type="uri" xlink:href="http://enterobase.warwick.ac.uk">http://enterobase.warwick.ac.uk</ext-link> [Accessed 18 January 2018]. The ResFinder database, together with in-house scripts used in the comparison and the exact options used with the different methods, have been collected as a tar-gzip archive along with the KMA source code on bitbucket: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/kma">https://bitbucket.org/genomicepidemiology/kma</ext-link>.</p>
    </sec>
    <sec id="FPar7">
      <title>Availability and requirements</title>
      <p>KMA algorithm: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/kma">https://bitbucket.org/genomicepidemiology/kma</ext-link></p>
      <p>KMA web-service: <ext-link ext-link-type="uri" xlink:href="https://cge.cbs.dtu.dk/services/KMA">https://cge.cbs.dtu.dk/services/KMA/</ext-link></p>
      <p>Operating system(s): Platform independent.</p>
      <p>Programming language: C.</p>
      <p>Other requirements: None.</p>
      <p>License: Apache v2.0.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>PTLCC designed and developed KMA, and performed the analysis. OL and FMA provided intellectual insight into the structure of the problems solved. PTLCC and OL made KMA available as web-service. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Li H, Homer N. “A survey of sequence alignment algorithms for next-generation sequencing.” Bioinformatics. 2010;11(5):473–83.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Clausen PTLC, Zankari E, Aarestrup FM, Lund O. Benchmarking of methods for identification of antimicrobial resistance genes in bacterial whole genome data. J Antimicrob Chemother. 2016;71(9):2484–88.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inouye</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SRST2: rapid genomic surveillance for public health and hospital microbiology labs</article-title>
        <source>Genome Med</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>11</issue>
        <fpage>90</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-014-0090-6</pub-id>
        <?supplied-pmid 25422674?>
        <pub-id pub-id-type="pmid">25422674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Li H. “Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM” arXiv Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1303.3997">https://arxiv.org/abs/1303.3997</ext-link>. 2013.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Li H. "Minimap2: pairwise alignment for nucleotide sequences." Bioinformatics. 2018. 10.1093/bioinformatics/bty191.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petersen</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MGmapper: reference based mapping and taxonomy annotation of metagenomics sequence reads</article-title>
        <source>PLoS One</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>e0176469</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0176469</pub-id>
        <?supplied-pmid 28467460?>
        <pub-id pub-id-type="pmid">28467460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <?supplied-pmid 28263959?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <?supplied-pmid 5420325?>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaas</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Leekitcharoenphon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aarestrup</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Solving the problem of comparing whole bacterial genomes across different sequencing platforms</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>e104984</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0104984</pub-id>
        <?supplied-pmid 25110940?>
        <pub-id pub-id-type="pmid">25110940</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grad</surname>
            <given-names>YH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic epidemiology of the Escherichia coli O104:H4 outbreaks in Europe 2011</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>8</issue>
        <fpage>3065</fpage>
        <lpage>3070</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1121491109</pub-id>
        <?supplied-pmid 22315421?>
        <pub-id pub-id-type="pmid">22315421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zankari</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of acquired antimicrobial resistance genes</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2012</year>
        <volume>67</volume>
        <issue>11</issue>
        <fpage>2640</fpage>
        <lpage>2644</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks261</pub-id>
        <?supplied-pmid 22782487?>
        <pub-id pub-id-type="pmid">22782487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>13</issue>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <?supplied-pmid 20110278?>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zankari</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genotyping using whole-genome sequencing is a realistic alternative to surveillance based on phenotypic antimicrobial susceptibility testing</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2013</year>
        <volume>68</volume>
        <issue>4</issue>
        <fpage>771</fpage>
        <lpage>777</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks496</pub-id>
        <?supplied-pmid 23233485?>
        <pub-id pub-id-type="pmid">23233485</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
