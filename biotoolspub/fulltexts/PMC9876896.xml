<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9876896</article-id>
    <article-id pub-id-type="pmid">36697464</article-id>
    <article-id pub-id-type="publisher-id">27813</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-023-27813-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CusProSe: a customizable protein annotation software with an application to the prediction of fungal secondary metabolism genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Oliveira</surname>
          <given-names>Leonor</given-names>
        </name>
        <address>
          <email>leonor.oliveira@i2bc.paris-saclay.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chevrollier</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dallery</surname>
          <given-names>Jean-Felix</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Connell</surname>
          <given-names>Richard J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lebrun</surname>
          <given-names>Marc-Henri</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Viaud</surname>
          <given-names>Muriel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lespinet</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.457334.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0667 2738</institution-id><institution>Institute for Integrative Biology of the Cell (I2BC), </institution><institution>Université Paris-Saclay, CEA, CNRS, </institution></institution-wrap>91198 Gif-sur-Yvette, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.507621.7</institution-id><institution>Université Paris-Saclay, INRAE, UR BIOGER, </institution></institution-wrap>78850 Thiverval-Grignon, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7429.8</institution-id><institution-id institution-id-type="ISNI">0000000121866389</institution-id><institution>Present Address: Orphanet-INSERM, US14, Plateforme des Maladies Rares, </institution></institution-wrap>Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1417</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We report here a new application, CustomProteinSearch (CusProSe), whose purpose is to help users to search for proteins of interest based on their domain composition. The application is customizable. It consists of two independent tools, IterHMMBuild and ProSeCDA. IterHMMBuild allows the iterative construction of Hidden Markov Model (HMM) profiles for conserved domains of selected protein sequences, while ProSeCDA scans a proteome of interest against an HMM profile database, and annotates identified proteins using user-defined rules. CusProSe was successfully used to identify, in fungal genomes, genes encoding key enzyme families involved in secondary metabolism, such as polyketide synthases (PKS), non-ribosomal peptide synthetases (NRPS), hybrid PKS-NRPS and dimethylallyl tryptophan synthases (DMATS), as well as to characterize distinct terpene synthases (TS) sub-families. The highly configurable characteristics of this application makes it a generic tool, which allows the user to refine the function of predicted proteins, to extend detection to new enzymes families, and may also be applied to biological systems other than fungi and to other proteins than those involved in secondary metabolism.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Microbiology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>ANR (Agence National pour la Recherche), France</institution>
        </funding-source>
        <award-id>Herbifun project 16-CE20-0023-01</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par21">Fungal secondary metabolites (SM), also known as specialized metabolites, are an important source of compounds of pharmaceutical and agrochemical interest. These include antibiotics, immunosuppressants, and phytotoxins with a wide range of molecular targets<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. Although fungi have been exploited for decades for their potential in antibiotic and pharmaceutical production, the chemical diversity of fungal SM and their potential biological activities remain under-explored. Indeed, the analysis of fungal genomes has revealed the presence of huge repertoires of genes involved in the biosynthesis of SM, indicating that these organisms have the capacity to produce many more compounds than those described to date<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. In particular, the genome analysis of plant and insect pathogenic fungi has revealed their potential to produce a wide range of previously uncharacterized compounds<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par22">The genes encoding enzymes involved in the biosynthetic pathways producing secondary metabolites fall into two categories: genes encoding key enzymes and genes encoding accessory enzymes. Key enzymes are involved in the essential step of the biosynthetic pathway, usually the first step in this pathway that leads to the synthesis of the metabolite skeleton<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. In the absence of this enzyme, the final metabolite is not produced. The main families of fungal SM key enzymes (SMKEs) are (i) polyketide synthases (PKS), (ii) non-ribosomal peptide synthetases (NRPS), (iii) hybrid PKS-NRPS, (iv) dimethylallyl tryptophan synthases (DMATS), and (v) terpene synthases (TS)<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Accessory enzymes act upstream or downstream of the essential stage of the biosynthetic pathway, either producing precursors used by the key enzyme or modifying the metabolite produced. Most frequently accessory enzymes are glycosyl transferases, methyltransferases, reductases and oxidases, particularly cytochromes P450 oxidoreductases<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. The genes encoding key and accessory enzymes of a given SM pathway are usually physically linked into a gene cluster with a shared transcriptional control<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. The annotation of secondary metabolism genes in fungal genomes is of great interest for the discovery of new bioactive compounds and for the understanding of their biosynthesis.</p>
    <p id="Par23">In the past years, several computational methods have been developed to help researchers in mining microorganism genomes for SM genes and clusters, and multiple reviews have been published comparing the algorithmic logic behind each software, as well as their advantages and limitations<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>. Classically, genome mining approaches focus on the identification of genes encoding SMKEs, based on their sequence conservation. Some of these tools are dedicated to specific classes of SMKEs, mostly PKS and/or NRPS<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>. Other software search for complete SM gene clusters. Examples are the “Secondary Metabolite Unknown Region Finder” (SMURF)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, a web-based tool for the mining of fungal genome sequences for PKS, NRPS, hybrid PKS-NRPS, and DMATS gene clusters, and “antibiotics and Secondary Metabolite Analysis SHell” (antiSMASH)<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, for the identification of secondary metabolite biosynthetic gene clusters in fungal and bacterial genomes. These available genome mining tools are powerful and have led to the identification of new enzymes, compounds, and elucidation of biosynthetic pathways. However, some caveats still exist. One important limitation is the fact that most genome mining platforms use rule-based approaches in which pre-defined rules are implemented in the software. This means that only enzymes/pathways for which rules were previously established can be found.</p>
    <p id="Par24">In the present work, we developed a novel software, CusProSe, to assist users in mining genomes for proteins of interest based on their conserved functional domains. Unlike similar existing tools, CusProSe was designed to be a totally flexible workflow where the user can define not only their own protein families of interest but also the searching rules. Here, we used CusProSe for identifying SMKEs in phylogenetically diverged fungal species, as an example of application, and compared the results obtained with those from the existing predictors SMURF and antiSMASH.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Development of the CusProSe software</title>
      <p id="Par25">CustomProteinSearch (CusProSe) is a generic genome mining software, consisting of two distinct but complementary customizable programs: IterHMMBuild and ProSeCDA. IterHMMBuild is an HMM profile building tool based on an iterative learning process. ProSeCDA is a protein search and annotation tool based on user-defined domain architectures. The two programs can be run independently. An overview of the CusProSe workflow and package functionalities is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Detailed information about its implementation and functioning is provided in the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section as well as in the CusProSe documentation page (<ext-link ext-link-type="uri" xlink:href="https://i2bc.github.io/CusProSe/">https://i2bc.github.io/CusProSe/</ext-link>).<fig id="Fig1"><label>Figure 1</label><caption><p>CusProSe package functionalities. (<bold>a</bold>) Overview of CusProSe. CusProSe contains two independent but complementary programs, IterHMMBuild and ProSeCDA. The figure schematizes the functioning of these tools. The IterHMMBuild program provides users with representative HMM protein profiles of interest, constructed by an iterative enrichment process, starting from a small set of defined protein seed sequences. Two inputs are required in a fasta file format: original seed sequence(s), (examplified here as a.fa b.fa c.fa and x.fa) and a set of other protein sequences such as a proteome (named here as dataset.fa) to iteratively feed the HMM profile. The output of iterHMMBuild includes, for each protein/protein domain of interest, the final HMM profile file (enriched.hmm). The different HMM profiles are then concatenated, and a database of profiles (database.hmm) is created and displayed in the output directory. ProSeCDA allows to search in a given protein dataset for multiple proteins of interest, defined by a user-specified set of domains and rules. The program takes as input a protein dataset of interest such as a proteome (dataset_2.fa file), an HMM profile database (database.hmm file) and a user-defined set of rules (rules.yaml file). The HMM profile database can the one created with IterHMMBuild or, alternative, any other user defined compatible database (in hmm format). (<bold>b</bold>) Overview of the IterHMMBuild iterative enrichement process. In the first step of the procedure an HMM profile model is build from the query protein sequences (x.hmm). This initial profile is then used to identify sequences with similar domains in the user-specified protein sequence dataset (dataset.fa). If matching sequences are found, they are added to the initial query sequence file (creating a new file named x-enriched.fa), and a new HMM profile is built. This process is repeated until no new sequences are recovered (i.e. convergence is reached). When convergence is reached a final HMM file is build (named here as x-enriched.hmm) and dispalyed in the output directory. (<bold>c</bold>) Overview of the ProSeCDA steps. The first step of the procedure consists in the annotation of the protein dataset of interest used to mine proteins (such as a proteome, named here as dataset_2.fa), with protein domains from a user-specified HMM profile database (HMM DB). In the next step, the annotated proteins (dataset_2.domtblout file) are filtered according to user-specified rules (rules.yaml file). Each rule is defined by different features including the protein family name, the “mandatory” list of domains (list of domains the protein must contain, green), and the “forbidden” list of domains (optional, list of domain the protein must not contain, red). All proteins matching those rules are selected and accessible in the output files. More details of Prosecda outputs are presented in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.</p></caption><graphic xlink:href="41598_2023_27813_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par26">The CusProSe IterHMMBuild tool allows the users to construct HMM profiles representatives of their protein sequences of interest, by an iterative learning process starting from seed sequences and a fasta protein dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a,b). The IterHMMBuild procedure starts building an HMM profile from a set of related protein or protein domain seed sequences or from a single query sequence. This initial HMM profile is then used to identify sequences with similar domains in any user-specified protein sequence dataset, in order to enrich the profile model. If matching sequences are found, they are added to the initial query sequences and a new HMM profile model is built. This new HMM profile is then searched against the same target dataset in order to find more distant similar sequences to the original query sequence(s)<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. This process is repeated (iterations) until convergence is reached, i.e., no new sequences are recovered from the dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) (see also the supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref> and “<xref rid="Sec9" ref-type="sec">Methods</xref>” section for technical details). When convergence is reached a final HMM enriched profile is build. A database of HMM profiles is then created by concatenation of the individual final profiles, either automatically or manually depending on input parameters and the user’s choice. Additional information about the HMM database creation procedure can be found in the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section and in the Documentation page in the IterHMMBuild usage guideline chapter. As regards ProSeCDA, the tool allows to search in a given protein dataset, for multiple proteins of interest defined by a user-specified set of rules (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a,c). The first step of the ProSeCDA pipeline is to annotate the protein dataset of interest, with functional protein domains from a user-specified HMM profile database (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). This database can be the one generated using the IterHMMBuild package of CusProSe, as exemplified in the scheme of Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, or, alternatively, any other compatible HMM profile database (.hmm file format). In the second step, annotated proteins are filtered following a set of rules which are also user-determined (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The rules describe any protein families of interest based on the user-defined specific domain architectures. Features defining each rule include the protein family name, the “mandatory” domains (list of domains the protein must contain) and the “forbidden” domains (optional, list of domain the protein must not contain). All proteins matching those rules are then finally accessible in the ProSeCDA output files directory. The output files include, for each identified protein, a summary in xml format, containing information such as the protein sequence and the boundaries of the conserved domain architectures (.xml), the protein sequence in fasta format (.fa), as well as plots showing a graphical representation of all of the domains that matched to the rules at the pdf format (optional, .pdf). (Figs. <xref rid="Fig1" ref-type="fig">1</xref>c, <xref rid="Fig2" ref-type="fig">2</xref>b,c). An interactive web page allowing to visualize the ProSeCDA annotation results is also created (index.html file). This web page is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a.<fig id="Fig2"><label>Figure 2</label><caption><p>Output of ProSeCDA. (<bold>a</bold>) Interactive web page allowing to visualize the annotation results. The page displays different pannels. The user can get detailed information about each one by clicking on the “i” located on each pannel header, on the right. The left pannel is a list of the user-defined protein families for which proteins have been found. The user picks a protein family to visualize by clicking on the protein family name to select it, and update its related informations visible in the other pannels. (<bold>b</bold>) XML file showing details of an individual annotated protein. (<bold>c</bold>) Schematic visualization of the protein identified domains in pdf format (optional parameter of ProSeCDA). Two types of pdf files are generated: upper panel, a file containing graphical representations of the most-likely domain architecture of all the proteins matching the user-defined family rule. Only one protein is shown here as an example. Lower panel, a file for each individual protein representing all the domains that matched the protein sequence during the annotation step.</p></caption><graphic xlink:href="41598_2023_27813_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Application of CusProSe to the prediction of fungal SMKEs</title>
      <p id="Par27">As an example of application, CusProSe was used to identify major families of SMKEs in fungi. The tools developed were first tested to detect PKS, NRPS, hybrid PKS-NRPS (including NRPS-PKS), and DMATS enzymes, in four species of phylogenetically unrelated plant pathogenic fungi with different host spectra, infection lifestyles and SM repertoires: (i) <italic>Botrytis cinerea</italic> (Leotiomycetes), a necrotrophic pathogen responsible for gray mold on more than 200 dicotyledons including grapevine, (ii) <italic>Colletotrichum higginsianum</italic> (Sordariomycetes), a hemibiotroph which attacks many cultivated plants among Brassicaceae as well as the model plant <italic>Arabidopsis thaliana</italic>, (iii) <italic>Zymoseptoria tritici</italic> (Dothideomycetes), a hemibiotroph which causes the most important foliar disease of wheat (“Septoria tritici blotch”) and (iv) <italic>Magnaporthe oryzae</italic> (Sordariomycetes), also a hemibiotroph, responsible for the most important disease of rice worldwide, rice blast<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR24">24</xref></sup>.</p>
      <p id="Par28">First, HMM profiles were constructed using <italic>M. oryzae</italic> protein sequences of conserved functional domains (Table <xref rid="Tab1" ref-type="table">1</xref>) characteristic of PKS, NRPS, PKS-NRPS and DMATS enzymes<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. At this stage three PKS, three NRPS, three hybrid PKS-NRPS and three DMATS were used to seed IterHMMBuild (Supplementary Data <xref rid="MOESM1" ref-type="media">S1</xref>). HMM profiles were also constructed for type III PKS (t3PKS), using conserved domain sequences of two <italic>M. oryzae</italic> t3PKS enzymes (Supplementary Data <xref rid="MOESM1" ref-type="media">S1</xref>). These initial domain profile models were then used to screen the <italic>M. oryzae</italic> proteome to identify potential new domains by homology search, to improve the HMM profiles. The database of domain profiles generated by IterHMMBuild was then given as input to ProSeCDA to annotate the <italic>M. oryzae</italic> proteome, together with the rules file. The rules used to define each type of SMKE above cited can be found in the supplementary File S1. This protocol made it possible to detect all PKS, NRPS, PKS-NRPS and DMATS from <italic>M. oryzae</italic><sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. The enriched HMM domain profile models were subsequently used to screen the <italic>C. higginsianum</italic> proteome, which again led to the identification of all SMKEs and to further enrich the HMM profiles. The same process was applied to <italic>B. cinerea</italic> and to <italic>Z. tritici</italic>. The identified proteins were manually validated at each step of the analysis. Comparison with existing data showed that the results obtained with CusProSe for these four fungi were consistent with previous SMKEs annotations<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>List of PKS, NRPS and DMATS essential functional domains.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Class</th><th align="left">Full name</th><th align="left">Essential domains</th></tr></thead><tbody><tr><td align="left" rowspan="3">PKS</td><td align="left" rowspan="3">Polyketide synthase</td><td align="left">Acyl transferase (AT)</td></tr><tr><td align="left">Ketoacyl synthase (KS)</td></tr><tr><td align="left">Phosphopantetheine binding domain (PP-binding)</td></tr><tr><td align="left" rowspan="3">NRPS</td><td align="left" rowspan="3">Non-ribosomal peptide synthetase</td><td align="left">Adenylation (A)</td></tr><tr><td align="left">Condensation (C)</td></tr><tr><td align="left">Phosphopantetheine binding domain (PP-binding)</td></tr><tr><td align="left">DMATS</td><td align="left"> Dimethylallyl tryptophan synthase</td><td align="left">Trp_DMAT</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Comparison of CusProSe with existing SMKEs predictors</title>
      <p id="Par29">To assess the performance of CusProSe in predicting SMKEs relative to other predictors, the catalogs of proteins obtained for each fungus were compared to those obtained with antiSMASH<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and SMURF<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The total numbers of SMKEs detected with the three predictors are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The list of all proteins identified is available in supplementary data (File S3). Comparisons of the results obtained with the three software are also presented in Venn diagrams and tables of Fig. <xref rid="Fig4" ref-type="fig">4</xref>. As shown in both Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, the effectiveness of CusProSe, antiSMASH and SMURF software varies according to the families of SMKEs. For DMATS, all members of this family were detected by the three software (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In contrast, differences were observed between the software for both the number of sequences recovered and the number of sequences correctly assigned, regarding PKS, NRPS and the PKS-NRPS hybrid enzymes. For PKS-NRPS enzymes, a significant number of false negatives (FN) were observed with antiSMASH and SMURF (Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>). These missed enzymes were wrongly annotated as NRPS or PKS. For instance, the <italic>M. oryzae</italic> NRPS-PKS hybrid MGG_07803 enzyme, involved in tenuazonic acid biosynthesis<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, was assigned as NRPS by both antiSMASH and SMURF, while it was correctly detected as a hybrid enzyme by CusProSe. Overall, antiSMASH correctly assigned 14 of the 19 hybrid enzymes (74%), whereas only 9 were identified by SMURF (47%)<italic>.</italic> In contrast, CusProSe successfully detected all the 19 PKS-NRPS/NRPS-PKS hybrids in the four fungal genomes analyzed<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>.<fig id="Fig3"><label>Figure 3</label><caption><p>Number of fungal SMKEs identified by CusProSe, antiSMASH and SMURF. The graphic displays the number of proteins identified with CusProSe, antiSMASH and SMURF for PKS and PKS-like, NRPS and NRPS-like, PKS-NRPS (also including NRPS-PKS) and DMATS SMKEs families from <italic>Magnaporthe oryzae</italic> (blue), <italic>Colletotrichum higginsianum</italic> (red)<italic>, Botrytis cinerea</italic> (yellow) <italic>and Zymoseptoria tritici</italic> (green)<italic>.</italic></p></caption><graphic xlink:href="41598_2023_27813_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Figure 4</label><caption><p>Venn diagrams of SMKEs detected with CusProSe, antiSMASH and SMURF. (<bold>a</bold>) PKS-NRPS*; (<bold>b</bold>) PKS; (<bold>c</bold>) NRPS. CusProSe SMKEs are labeled in red, while antiSMASH and SMURF SMKEs are labeled in green and blue, respectively. Tables on the right for each (<bold>a–c</bold>) panels highlight the proteins differing in their annotation prediction according to the different predictors. The color code is the same as in the Venn diagrams. MGG_ID: <italic>Magnaporthe oryzae</italic>, CH63R_ID: <italic>Colletotrichum higginsianum</italic><italic>, </italic><italic>BcinID: Botrytis cinerea, Mycgr3PID, Zymoseptoria tritici</italic>. Asterisk, includes NRPS-PKS hybrids.</p></caption><graphic xlink:href="41598_2023_27813_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par30">As concerns the total number of PKS, 89 proteins were detected with CusProSe compared to 96 and 92 with antiSMASH and SMURF, respectively. As discussed above, some of the SMKEs detected as PKS by antiSMASH and SMURF are actually PKS-NRPS hybrids and can therefore be considered false positives (FP). Among the seven antiSMASH additional PKS, four were in reality PKS-NRPS hybrids (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) attested by the presence of NRPS domains in addition to the PKS module<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>. The three other antiSMASH additional PKS were identified as PKS-like by CusProSe. A careful examination of these three proteins revealed that the PP-binding domain, one of the three essential domains of PKS enzymes, is absent from these protein sequences. We made the choice, in our rules file, of considering as PKS only enzymes with all three essential functional domains KS, AT and PP-binding. Those proteins with one missing domain were therefore classified as PKS-like enzymes by CusProSe (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The same holds true for the NRPS enzymes. Regarding SMURF, nine predicted PKS were found to be hybrid PKS-NRPS enzymes by CusProSe. SMURF also missed the five PKS belonging to the type III PKSs (t3PKS), unlike CusProSe and antiSMASH which both have specific profiles / rules for these PKS enzymes.</p>
      <p id="Par31">For NRPS, 40 proteins were detected by CusProSe compared to 45 and 34 by antiSMASH and SMURF, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The different annotation predictions are illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c. Thirty-three proteins were identified as NRPS by the three predictors, but for 17 cases differences were observed. Regarding the six proteins annotated as NRPS by CusProSe and antiSMASH only, two were missed by SMURF, whereas the four others were annotated by SMURF as “NRPS-like”. Nine proteins were annotated by antiSMASH only as NRPS. From these, two were annotated by CusProSe and SMURF as NRPS-like, whereas the seven others were identifed by CusProSe as NRPS-like (they missed one of the 3 essential domains, Table <xref rid="Tab1" ref-type="table">1</xref>) or “dom_A” (only an isolated adenylation domain was detected). In contrast, one protein was annotated as NRPS by CusProSe alone, being classified as “NRPS-like” by both antiSMASH and SMURF. Finally, as discussed previously, one SMKE detected as NRPS by antiSMASH and SMURF is in fact a hybrid enzyme (NRPS-PKS)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, as annotated by CusProSe.</p>
    </sec>
    <sec id="Sec6">
      <title>Identification of Terpene synthase family enzymes</title>
      <p id="Par32">CusProSe was used to improve the detection of Terpene synthases (TS, also referred to as TC or Terpene Cyclases)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. TS are SMKEs involved in the biosynthesis of terpenoids, which are among the most structurally and functionally diverse natural compounds<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. They are synthesized in various organisms such as plants, bacteria and fungi<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. The TS are highly variable both in the type of their functional protein domains and in their protein sequences, as compared to other SMKEs<sup><xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. This particularity renders more difficult their detection by bioinformatic methods. As a consequence, TS analysis was not considered in the SMURF software<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, whereas antiSMASH does not distinguish between the different families of TS. The lack of a good TS detection method by currently available tools was therefore a challenging issue.</p>
      <p id="Par33">HMM profiles were constructed separately for five different families of TS, including sesquiterpenes, diterpenes, phytoenes, squalenes, and chimeric TS. These last enzymes are bi-functional proteins presenting both TS and prenyltransferase domains<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Specific profiles for sub-families of sesquiterpene synthases, which are the most abundant fungal TS enzymes, were also built. The rules file was enriched to include information on the different TS domain architectures of each sub-family (supplementary File S2). We started from a small number of well-defined fungal TS protein sequences from each of the different TS enzyme sub-families. The set included biochemically characterized proteins and manually annotated and reviewed sequences from the UniprotKB/Swiss-Prot section of the Uniprot knowledgebase<sup><xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR41">41</xref></sup> (Data <xref rid="MOESM1" ref-type="media">S4</xref>). HMM profile models for the different TS families were constructed with IterHMMBuild and used to screen the <italic>M. oryzae, C. higginsianum, B. cinerea</italic> and <italic>Z. tritici</italic> proteomes<italic>.</italic> As the SMURF algorithm does not include TS detection, we compared CusProSe predictions to those of antiSMASH only. As can be seen in the data presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, our profiles and rules lead to a more precise classification of TS. Indeed, we were able to identify the sub-families of TS present in the four different fungi, with additional TS enzymes found relative to the antiSMASH predictions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a,b). CusProSe particularly outperforms antiSMASH for the chimeric TS, but also performed better for diterpene synthases, sesquiterpene synthases, and squalane-hopene synthases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, see also Fig. <xref rid="MOESM1" ref-type="media">S2</xref>). In addition, CusProSe avoids false positives such as prenyltransferases (PT), that are implicated in terpenoids biosynthetic pathways but are not TS enzymes per se<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. These proteins were classified as TS by antiSMASH (5 FP) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Parallel phylogenetic analyses confirmed our classification of TS into these sub-families (supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>A,B).<fig id="Fig5"><label>Figure 5</label><caption><p>Identification of TS by CusProSe in four fungal genomes and comparison with antiSMASH. (<bold>a</bold>) Number of TS identified by CusProSe and antiSMASH in <italic>Magnaporthe oryzae</italic>, <italic>Colletotrichum higginsianum, Botrytis cinerea, and Zymoseptoria tritici</italic>. (<bold>b</bold>) Number of TS identified with CusProSe for each sub-family in the four fungal genomes (<bold>c</bold>) Venn diagram representing the efficiency of CusProSe for detection of TS compared to antiSMASH. The number of CusProSe annotated TS enzymes are shown in red in the Venn diagrams, while the number of TS detected using antiSMASH are shown in green. On the right, proteins differing in their annotation prediction according to predictors.</p></caption><graphic xlink:href="41598_2023_27813_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Application of CusProSe to other fungal genomes</title>
      <p id="Par34">To further evaluate the efficiency of our HMM profiles and rules in identifying fungal SMKEs, they were both used to mine other unrelated fungal genomes. We chose representative fungal species with well-annotated genomes from different taxonomic classes : <italic>Aspergillus nidulans</italic> and <italic>Aspergillus niger</italic> from Eurotiomycetes, <italic>Fusarium fujikuroi</italic> and <italic>Fusarium graminearum</italic> from Sordariomycetes, and <italic>Leptosphaeria maculans</italic> from Dothideomycetes<sup><xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR46">46</xref></sup>. The SMKEs identified for each fungus using the custom HMM profiles and ProSeCDA annotation rules were carefully analyzed and compared to previously published annotations<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. The number and lists of all SMKEs are displayed respectively in Fig. <xref rid="MOESM1" ref-type="media">S4</xref> and File S5. A comparison with the results obtained with antiSMASH showed that CusProSe performed particularly better in the identification of the distinct TS enzymes (Figs. <xref rid="MOESM1" ref-type="media">S5</xref>, <xref rid="MOESM1" ref-type="media">S6</xref>). Beyond confirming the accuracy of the CusProSe predictions, these novel analyses of fungal genome mining for SMKEs further enriched the fungal-specific HMM profiles of each family, with additional sequences from phylogenetically diverse fungi. These HMM models may be useful to the scientific community interested in fungal SM and we hope they can contribute to identifying other as-yet-unknown KEs.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par35">CusProSe, a novel protein annotation software, is a versatile and flexible tool that can be customized to suit different types of genome/proteome analyses. As an illustration, this software was here used to mine fungal genomes for key enzymes involved in SM.</p>
    <p id="Par36">One of the goals of CusProSe was to improve the accuracy of detection of each type of fungal SMKEs. Our HMM profiles were built exclusively from well-annotated fungal genome sequences already mined for SMKEs. Our main purpose was to carry out a careful analysis of the output of CusProSe including a manual examination of the predicted enzymes. We focused our search on major fungal SMKEs such as PKS, NRPS, hybrid PKS-NRPS, DMATS, and the large family of TS.</p>
    <p id="Par37">CusProSe performance was either similar to, or better than, antiSMASH and SMURF for the identification of fungal SMKEs. This is due to a combination of both specific profiles and strict and carefully defined rules. In particular, CusProSe performed better for PKS-NRPS hybrids. CusProSe also clearly differentiated complete PKS and NRPS from PKS-like or NRPS-like enzymes. Moreover, for TS CusProSe was more sensitive than antiSMASH as it allowed the detection of all TS types and their classification into distinct sub-families, thanks to sub-family specific HMM profiles and rules, avoiding false positives. This is a major novelty and advantage as regards the search for TS enzymes, relatively to the existing predictors. Finally, our data demonstrate that, using HMM profiles built from a few well-annotated and representative proteins, and well-defined and adequate rules, it is possible to accurately identify candidate proteins of each enzyme family with high sensitivity and specificity.</p>
    <p id="Par38">CusProSe has so far been successfully used with genomes from well-known fungal species, representing the Eurotiomycetes, Leotiomycetes, Sordariomycetes and Dothideomycetes classes of the Ascomycota. Different species representing these or other fungal classes may also be mined<italic>.</italic> Our HMMs models may be further enriched by mining additional fungal genomes, including genome sequences from representatives of the Basidiomycota. The database of fungal HMM profiles created within the framework of the present study is available to the community, as well as the file of rules used by ProSeCDA for protein annotation. Each user can either use these tools directly or adapt them/create new ones according to specific needs. The rules file can evolve to take into account new requirements, for example detection of a new protein family or sub-family. This means that a rule for a novel protein family can be added. A rule can also be easily deleted, or modified, in this case by adding a new “mandatory” or “forbidden” protein domain for example. A completely new rules file can also be constructed either manually using the required yaml format or the proposed graphical interface, as specified in the CusProSe Documentation. Importantly, CusProSe is not restricted to the prediction of SMKEs. It is a custom genome mining software package, whose integrating tools can be exploited in the context of any protein family / biological system. Its successful utilization for a fast, easy and accurate prediction of major fungal SMKEs presented here illustrates its interest to a broad community of biologists.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Implementation, system requirements and availability</title>
      <p id="Par39">CusProSe was coded on Python 3, and details on its implementation can be found at the Documentation page <ext-link ext-link-type="uri" xlink:href="https://i2bc.github.io/CusProSe/">https://i2bc.github.io/CusProSe/</ext-link>. The application requires Python version 3.7. The external dependencies are the programs HMMER (version 3.3)<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, MUSCLE (version 3.8.1551)<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, and Usearch<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. CusProSe is freely available. Its source code is distributed at <ext-link ext-link-type="uri" xlink:href="https://github.com/i2bc/CusProSe">https://github.com/i2bc/CusProSe</ext-link> and updated versions will be accessible there. CusProSe is compatible with all platforms supporting Python, HMMER, and MUSCLE. The user runs the CusProSe tools IterHMMBuild and/or ProSeCDA from the command line. The two packages can be run independently. The main steps of both pipelines are summarized in this “<xref rid="Sec9" ref-type="sec">Methods</xref>” section. A usage guideline with more detailed information and examples is available at the CusProSe Documentation page (<ext-link ext-link-type="uri" xlink:href="https://i2bc.github.io/CusProSe/">https://i2bc.github.io/CusProSe/</ext-link>).</p>
    </sec>
    <sec id="Sec11">
      <title>IterHMMbuild package</title>
      <sec id="Sec12">
        <title>Rationale, input and outputs of IterHMMBuild</title>
        <p id="Par40">The CusProSe IterHMMBuild tool allows the user to build an HMM profile representative of (a) seed protein sequence(s) by using a set of other defined protein sequences to iteratively feed the HMM profile (training set). Two inputs are required in a fasta file format: (i) either a fasta file with at least one protein sequence or a directory location where multiple individual fasta files are stored and (ii) a fasta file of protein sequences (dataset), such as a proteome, used to enrich initial protein sequence(s) of interest. There is no limit on protein sequence length, genome size or any other similar constraints for the input files. Input working examples are available in the cusProSe/iterhmmbuild/datas directory of the CusProSe archive (<ext-link ext-link-type="uri" xlink:href="https://github.com/i2bc/CusProSe">https://github.com/i2bc/CusProSe</ext-link>). The fasta sequences of each seed set are aligned with MUSCLE and the resulting multiple sequence alignment is given as input to HMMER (both integrated in the IterHMMBuild software). The HMM profiles are then built for each domain/family with an iterative search protocol (see Sequence enrichment step below). An output directory includes, for each protein/protein domain of interest, the final HMM profile file (domain.hmm), the final sequences file in fasta format used to build the HMM profile (domain_seed.fa), the multiple alignment file of those sequences at Clustal W format (domain_seed.clw), a log file containing a summary of the computation (info.log), and iter_i directories containing files obtained at each iteration cycle (i). More details on the iter_i/ files as well on the usage of IterHMMBuild and its different possibilities and parameters can be found at the IterHMMBuild Usage guideline section of the Documentation file (<ext-link ext-link-type="uri" xlink:href="https://i2bc.github.io/CusProSe/ihb_usage.html">https://i2bc.github.io/CusProSe/ihb_usage.html</ext-link>).</p>
      </sec>
      <sec id="Sec13">
        <title>Sequence enrichment step</title>
        <p id="Par41">The HMM profiles initially built are searched against the protein dataset given as input using the hmmsearch command from HMMER, integrated in the software. The purpose is to enrich the HMM profile models. All matching sequences with E-values less than 0.01 (default value) and an expected accuracy per residue of the alignment above or equal to 0.6 (default value) are retrieved. Those sequences are then merged to the initial input sequences. To ensure that sequences are not redundant, Usearch is applied with a threshold identity value of 90%. A new HMM profile is then build and the process is repeated until convergence is reached. The convergence is reached when the number of sequences at iteration i + 1 (Nseq<sup>i+1</sup>) is strictly equal to the number of sequences at iteration i (Nseq<sup>i</sup>). However, because the number of new sequences found after multiple consecutive iterations can be really low, or even negative, a counter is also used to evaluate the convergence status in order to prevent unnecessary iterations (i. e. iterations that will increase the computation time without significantly enrich the number of new sequences). This counter is incremented each time the difference between Nseq<sup>i+1</sup> and Nseq<sup>i</sup> is negative or equal to 1 (default value). The convergence is then also reached when the value of this counter is equal to 3 (default value). In the end of the process a last HMM profile is build, the final enriched HMM profile.</p>
      </sec>
      <sec id="Sec14">
        <title>Building the HMM profile database</title>
        <p id="Par42">An HMM profile database from a set of individual enriched HMM profiles representative of different domain sequences of interest can be generated manually, by concatenation of the profiles, with the command create_hmmdb. This is the case when profiles for each protein domain of interest are constructed separately in different runs, with a single seed domain fasta file given as input at each run. As an alternative the HMM database can also be built automatically when running IterHMMBuild, if a directory with multiple individual fasta files is given as input (see Documentation for further information on the different possibilities of HMM profiles and database constructions).</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>ProSeCDA package</title>
      <sec id="Sec16">
        <title>Rationale, input and outputs of ProSeCDA</title>
        <p id="Par43">The CusProSe ProSeCDA tool allows the user to detect proteins matching specific given domain architectures rules, defined by the user, in any desired dataset of proteins, such as a proteome. Three input files are required: a dataset of proteins in fasta format (dataset.fa), an HMM profile database (database.hm), and a file describing the rules (rules.yaml). As for IterHMMBuild there are no particular input constraints besides the specified file format. Input working examples are available at the cusProSe/prosecda/datas directory of the CusProSe archive (<ext-link ext-link-type="uri" xlink:href="https://github.com/i2bc/CusProSe">https://github.com/i2bc/CusProSe</ext-link>). The output of ProSeCDA includes (i) a info.log file containing the summary log of the computation run, (ii) an output file of hmmsearch for the protein dataset analyzed (dataset.domtblout), (iii) an interactive web page allowing to visualize the results (index.html), (iv) 3 additional folders containing files read by index.html (css/ js/ and images/) and (v) a directory nammed "<xref rid="Sec2" ref-type="sec">Results</xref>" containing different output files for rules matching proteins. This directory contains sub-directories for each rule for which proteins have been found, where the user can find, for each identified protein, an individual summary at an xml format, containing information such as the protein sequence and the boundaries of the conserved domain architectures (protein_ID.xml). The protein sequence file in fasta format is also provided for each individual match (protein_ID.fa). Plots at the pdf format (protein_ID.pdf) showing a graphical representation of all of the domains that matched to the rules for a given protein can also be created (optional) and are displayed in the results/ sub-directories. Examples are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> of the manuscript. The computation time of an average Prosecda run with default parameters, on a computer with a Intel<sup>®</sup> Core™ i7-4900MQ CPU @ 2.80 GHz × 8 processor running the Linux operating system, was about 2.4 sec. This time was increased to 2.5 min on average with the plots at the pdf format option.</p>
      </sec>
      <sec id="Sec17">
        <title>Creation of rules</title>
        <p id="Par44">Rules are written in a specific yaml (Yet Another Markup Language) format (<ext-link ext-link-type="uri" xlink:href="https://yaml.org/">https://yaml.org/</ext-link>). A Graphical User Interface (GUI) accessible by running the create_rules script was implemented to help users in this task (see details in the CusProSe Documentation file). Each rule was defined by different features: Name (protein category/family name), Comment (optional feature; can be used to describe the rule), Mandatory list (list of domain names the protein must contain), and Forbidden list (optional list of domain names the protein must not contain).</p>
      </sec>
      <sec id="Sec18">
        <title>Annotation step: selection of matching domains</title>
        <p id="Par45">The annotation step of ProSeCDA assigns domains from the user-defined HMM profile database to matching sequences from a protein dataset of interest. The annotation procedure uses hmmsearch from HMMER to search for each of the HMM domain profile present in the user-defined rules file (see Creation of rules above) against the protein dataset. All matching sequences with an E-value less than 0.01 (default value) and an expected accuracy per residue of the alignment above or equal to 0.6 (default value) are then retrieved. The E-value and accuracy can be changed by the user. Both conditional and independent E-values from HMMER are evaluated.</p>
        <p id="Par46">To resolve overlapping domains (we considered that two domains are overlapping if at least 40% of the shortest domain sequence overlap with the other domain), an approach similar to the heaviest weighted clique-finding method described by Yeats and collaborators<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> was used. When multiple matching domains are found for a protein sequence and some of those domains overlap, all possible domain architectures defined by a set of non-overlapping domains are identified, with each domain being assigned a score corresponding to -log(E-value). An alternative score is also used in case the E-value associated with a match is equal to 0.0. In that case, the bit score from HMMER is assigned to each domain instead of the -log(E-value) which cannot be computed. The protein is then assigned to the most-likely domain architecture which is defined as the combination of non-overlapping domains that gives the highest total score.</p>
      </sec>
      <sec id="Sec19">
        <title>Filtering step</title>
        <p id="Par47">The filtering step searches in all previously annotated proteins the domain architectures matching those described in the set of rules defined by the user. A match with a user-defined family is valid for a protein if its most-likely domain architecture fits the mandatory domains and if no forbidden domains are present. Moreover, if an E-value threshold is specified in the rules for a given mandatory domain, this domain must match with an E-value at least below this threshold.</p>
      </sec>
      <sec id="Sec20">
        <title>Annotation of SMKEs with CusProSe and comparison with antiSMASH and SMURF</title>
        <p id="Par48">The test sets used to evaluate CusProSe predictions were composed of protein sequences from known protein families from manually-anotated and revised fungal genomes and also from experimentally characterized proteins. The sequences are available in the Supplementary material (Folders Data <xref rid="MOESM1" ref-type="media">S1</xref> and Data <xref rid="MOESM1" ref-type="media">S2</xref>). The initial training set was the genome of the fungus Magnaporthe oryzae (v. 8, Broad Institute) used to create the first hmm models. These were latter enriched by screening other fungal genomes. The enriched hmm models were then tested in a second round of analysis on additional well annotated fungi representive of different species and classes. The same fungal genomes mined with our tool (same version coming from the same public database) were given as input to antiSMASH<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and SMURF<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> software (FASTA + GFF3 files as recommended) and the programs were run using their respective integrated profiles and rules.</p>
      </sec>
      <sec id="Sec21">
        <title>Phylogenetic analysis</title>
        <p id="Par49">All sequences were aligned with muscle 3.8 and maximum likelihood trees were made with phyml 3.3 (<ext-link ext-link-type="uri" xlink:href="https://ngphylogeny.fr">https://ngphylogeny.fr</ext-link>). The chosen substitution model is LG with an initial BioNJ tree. The bootstrap values obtained after 100 replicates are shown on the tree branches. Trees were generated using Interative Tree of Life (<ext-link ext-link-type="uri" xlink:href="https://itol.embl.de">https://itol.embl.de</ext-link>).</p>
      </sec>
      <sec id="Sec22">
        <title>Fungal genomes and proteomes</title>
        <p id="Par50">Genomes /proteomes used in this work are listed in Table <xref rid="MOESM1" ref-type="media">S2</xref> and were downloaded from their respective databases as indicated.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2023_27813_MOESM1_ESM.zip">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SM</term>
        <def>
          <p id="Par2">Secondary metabolism</p>
        </def>
      </def-item>
      <def-item>
        <term>SMKE</term>
        <def>
          <p id="Par3">Secondary metabolism key enzymes</p>
        </def>
      </def-item>
      <def-item>
        <term>PKS</term>
        <def>
          <p id="Par4">Polyketide synthases</p>
        </def>
      </def-item>
      <def-item>
        <term>NRPS</term>
        <def>
          <p id="Par5">Non-ribosomal peptide synthetases</p>
        </def>
      </def-item>
      <def-item>
        <term>PKS-NRPS</term>
        <def>
          <p id="Par6">PKS-NRPS or NRPS-PKS hybrid enzymes</p>
        </def>
      </def-item>
      <def-item>
        <term>DMATS</term>
        <def>
          <p id="Par7">Dimethylallyl tryptophan synthases</p>
        </def>
      </def-item>
      <def-item>
        <term>TS</term>
        <def>
          <p id="Par8">Terpene synthases</p>
        </def>
      </def-item>
      <def-item>
        <term>ABA</term>
        <def>
          <p id="Par9">Abscisic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>Tri</term>
        <def>
          <p id="Par10">Trichodiene</p>
        </def>
      </def-item>
      <def-item>
        <term>PT</term>
        <def>
          <p id="Par11">Prenyltransferases</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>M. oryzae</italic>
        </term>
        <def>
          <p id="Par12">
            <italic>Magnaporthe oryzae</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>C. higginsianum</italic>
        </term>
        <def>
          <p id="Par13">
            <italic>Colletotrichum higginsianum</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>B. cinerea</italic>
        </term>
        <def>
          <p id="Par14">
            <italic>Botrytis cinerea</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>Z. tritici</italic>
        </term>
        <def>
          <p id="Par15">
            <italic>Zymoseptoria tritici</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>A. nidulans</italic>
        </term>
        <def>
          <p id="Par16">
            <italic>Aspergillus nidulans</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>A. niger</italic>
        </term>
        <def>
          <p id="Par17">
            <italic>Aspergillus niger</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>F. fujikuroi</italic>
        </term>
        <def>
          <p id="Par18">
            <italic>Fusarium fujikuroi</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>F. graminearum</italic>
        </term>
        <def>
          <p id="Par19">
            <italic>Fusarium graminearum</italic>
          </p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>L. maculans</italic>
        </term>
        <def>
          <p id="Par20">
            <italic>Leptosphaeria maculans</italic>
          </p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-023-27813-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work and N.C. were supported by a grant from the ANR (Agence National pour la Recherche, France, Herbifun project 16-CE20-0023-01). We would like to thank all members of the Herbifun consortium for helpful discussions. We thank particularly Adeline Simon for sharing expertise on Botrytis cinerea secondary metabolism enzymes. The INRAE BIOGER unit benefits from the support of the Saclay Plant Sciences-SPS (ANR-17-EUR-0007).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.O., N.C., O.L. designed research and the CusProSe software. L.O., O.L. coordinated the study. L.O., N.C. carried out bioinformatic analyses. J.F.D., R.O., M.H.L., M.V., O.L contributed to the analyses with helpful comments and feedback. L.O. wrote the first draft of the manuscript. O.L. N.C. J.F.D. R.O. M.V. M.H.L. helped draft the manuscript and critically revised it.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Files.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par51">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dayan</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Duke</surname>
            <given-names>SO</given-names>
          </name>
        </person-group>
        <article-title>Natural compounds as next-generation herbicides</article-title>
        <source>Plant Physiol.</source>
        <year>2014</year>
        <volume>166</volume>
        <fpage>1090</fpage>
        <lpage>1105</lpage>
        <pub-id pub-id-type="doi">10.1104/pp.114.239061</pub-id>
        <pub-id pub-id-type="pmid">24784133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robey</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Caesar</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Drott</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>An interpreted atlas of biosynthetic gene clusters from 1,000 fungal genomes</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2020230118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amselem</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic analysis of the necrotrophic fungal pathogens <italic>Sclerotinia sclerotiorum</italic> and <italic>Botrytis cinerea</italic></article-title>
        <source>PLoS Genet.</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>e1002230</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dallery</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapless genome assembly of Colletotrichum higginsianum reveals chromosome structure and association of transposable elements with secondary metabolite gene clusters</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>667</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4083-x</pub-id>
        <pub-id pub-id-type="pmid">28851275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhnert</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Collemare</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A genomic journey in the secondary metabolite diversity of fungal plant and insect pathogens: From functional to population genomics</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <year>2022</year>
        <volume>69</volume>
        <fpage>102178</fpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2022.102178</pub-id>
        <pub-id pub-id-type="pmid">35870224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>NP</given-names>
          </name>
        </person-group>
        <article-title>Fungal secondary metabolism: regulation, function and drug discovery</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>167</fpage>
        <lpage>180</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-018-0121-1</pub-id>
        <pub-id pub-id-type="pmid">30531948</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hertweck</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The biosynthetic logic of polyketide diversity</article-title>
        <source>Angew. Chem. Int. Ed.</source>
        <year>2009</year>
        <volume>48</volume>
        <fpage>4688</fpage>
        <lpage>4716</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.200806121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Hohn</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Metabolic pathway gene clusters in filamentous fungi</article-title>
        <source>Fungal Genet. Biol.</source>
        <year>1997</year>
        <volume>21</volume>
        <fpage>17</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1006/fgbi.1997.0970</pub-id>
        <pub-id pub-id-type="pmid">9126615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersen</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate prediction of secondary metabolite gene clusters in filamentous fungi</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>99</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1205532110</pub-id>
        <pub-id pub-id-type="pmid">23248268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>In silico tools for the analysis of antibiotic biosynthetic pathways</article-title>
        <source>Int. J. Med. Microbiol.</source>
        <year>2014</year>
        <volume>304</volume>
        <fpage>230</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijmm.2014.02.001</pub-id>
        <pub-id pub-id-type="pmid">24631213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziemer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Alanjary</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The evolution of genome mining in microbes</article-title>
        <source>Nat. Prod. Rep.</source>
        <year>2016</year>
        <volume>33</volume>
        <fpage>988</fpage>
        <lpage>1005</lpage>
        <pub-id pub-id-type="doi">10.1039/C6NP00025H</pub-id>
        <pub-id pub-id-type="pmid">27272205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Medema</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Recent development of antiSMASH and other computational approaches to mine secondary metabolite biosynthetic gene clusters</article-title>
        <source>Brief. Bioinform.</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>1103</fpage>
        <lpage>1113</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx146</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chavali</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Rhee</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics tools for the identification of gene clusters that biosynthesize specialized metabolite</article-title>
        <source>Brief. Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1022</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx020</pub-id>
        <pub-id pub-id-type="pmid">28398567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yadav</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gokhale</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Mohanty</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SEARCHPKS: A program for detection and analysis of polyketide synthase domains</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3654</fpage>
        <lpage>3658</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg607</pub-id>
        <pub-id pub-id-type="pmid">12824387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rottig</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NRPSpredictor2—a web server for predicting NRPS adenylation domain specificity</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39(Web Server issue)</volume>
        <fpage>W362</fpage>
        <lpage>W367</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr323</pub-id>
        <pub-id pub-id-type="pmid">21558170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khaldi</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SMURF: Genomic mapping of fungal secondary metabolite clusters</article-title>
        <source>Fungal Genet. Biol.</source>
        <year>2010</year>
        <volume>47</volume>
        <fpage>736</fpage>
        <lpage>741</lpage>
        <pub-id pub-id-type="doi">10.1016/j.fgb.2010.06.003</pub-id>
        <pub-id pub-id-type="pmid">20554054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medema</surname>
            <given-names>MH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>antiSMASH: Rapid identification, annotation and analysis of secondary metabolite biosynthesis gene clusters in bacterial and fungal genome sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39(Web Server issue)</volume>
        <fpage>W339</fpage>
        <lpage>W346</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr466</pub-id>
        <pub-id pub-id-type="pmid">21672958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>antiSMASH 6.0: Improving cluster detection and comparison capabilities</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49(Web Server issue)</volume>
        <fpage>W29</fpage>
        <lpage>W35</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab335</pub-id>
        <pub-id pub-id-type="pmid">33978755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Portugaly</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Hidden Markov model speed heuristic and iterative HMM search procedure</article-title>
        <source>BMC Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>431</fpage>
        <lpage>438</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dean</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome sequence of the rice blast fungus <italic>Magnaporthe grisea</italic></article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>434</volume>
        <fpage>980</fpage>
        <lpage>986</lpage>
        <pub-id pub-id-type="doi">10.1038/nature03449</pub-id>
        <pub-id pub-id-type="pmid">15846337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Motoyama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Osada</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Biosynthesis and biological function of secondary metabolites of the rice blast fungus <italic>Pyricularia oryzae</italic></article-title>
        <source>J. Ind. Microbiol. Biotechnol.</source>
        <year>2021</year>
        <volume>48</volume>
        <fpage>9</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1093/jimb/kuab058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Collado, I. G., &amp; Viaud, M. Secondary metabolism in <italic>Botrytis cinerea</italic>: Combining genomic and metabolomic approaches. in <italic>Botrytis—The Fungus, the Pathogen and Its Management in Agricultural Systems.</italic> (eds. Fillinger, S., Elad, Y. &amp; Vivier, M.) (Springer, 2016).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Connell</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lifestyle transitions in plant pathogenic <italic>Colletotrichum fungi</italic> deciphered by genome and transcriptome analyses</article-title>
        <source>Nat. Genet.</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>1060</fpage>
        <lpage>1065</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2372</pub-id>
        <pub-id pub-id-type="pmid">22885923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cairns</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>In silico prediction and characterization of secondary metabolite biosynthetic gene clusters in the wheat pathogen <italic>Zymoseptoria tritici</italic></article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>631</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-3969-y</pub-id>
        <pub-id pub-id-type="pmid">28818040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collemare</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Billard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Böhnert</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Lebrun</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Biosynthesis of secondary metabolites in the rice blast fungus <italic>Magnaporthe grisea</italic>: The role of hybrid PKS-NRPS in pathogenicity</article-title>
        <source>Mycol. Res.</source>
        <year>2008</year>
        <volume>112</volume>
        <fpage>207</fpage>
        <lpage>215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mycres.2007.08.003</pub-id>
        <pub-id pub-id-type="pmid">18272356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yun</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Motoyama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Osada</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Biosynthesis of the mycotoxin tenuazonic acid by a fungal NRPS-PKS hybrid enzyme</article-title>
        <source>Nat. Commun.</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>8758</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms9758</pub-id>
        <pub-id pub-id-type="pmid">26503170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christianson</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Structural biology and chemistry of the terpenoid cyclases</article-title>
        <source>Chem. Rev.</source>
        <year>2006</year>
        <volume>106</volume>
        <fpage>3412</fpage>
        <lpage>3442</lpage>
        <pub-id pub-id-type="doi">10.1021/cr050286w</pub-id>
        <pub-id pub-id-type="pmid">16895335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oldfield</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>Terpene biosynthesis: Modularity rules</article-title>
        <source>Angew. Chem. Int. Ed. Engl.</source>
        <year>2012</year>
        <volume>51</volume>
        <fpage>1124</fpage>
        <lpage>1137</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.201103110</pub-id>
        <pub-id pub-id-type="pmid">22105807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pemberton</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the influence of domain architecture on the catalytic function of diterpene synthases</article-title>
        <source>Biochemistry</source>
        <year>2017</year>
        <volume>56</volume>
        <fpage>2010</fpage>
        <lpage>2023</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.biochem.7b00137</pub-id>
        <pub-id pub-id-type="pmid">28362483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Honzatko</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Terpenoid synthase structures: A so far incomplete view of complex catalysis</article-title>
        <source>Nat. Prod. Rep.</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>1153</fpage>
        <lpage>1175</lpage>
        <pub-id pub-id-type="doi">10.1039/c2np20059g</pub-id>
        <pub-id pub-id-type="pmid">22907771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinedo</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sesquiterpene synthase from the botrydial biosynthetic gene cluster of the phytopathogen Botrytis cinerea</article-title>
        <source>ACS Chem. Biol.</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>791</fpage>
        <lpage>801</lpage>
        <pub-id pub-id-type="doi">10.1021/cb800225v</pub-id>
        <pub-id pub-id-type="pmid">19035644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Towsend</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Structural studies of natural product biosynthetic proteins</article-title>
        <source>Chem. Biol.</source>
        <year>1997</year>
        <volume>4</volume>
        <fpage>721</fpage>
        <lpage>730</lpage>
        <pub-id pub-id-type="doi">10.1016/S1074-5521(97)90310-0</pub-id>
        <pub-id pub-id-type="pmid">9375250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Fungal secondary metabolism-From biochemistry to genomics</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>937</fpage>
        <lpage>947</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1286</pub-id>
        <pub-id pub-id-type="pmid">16322742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toyomasu</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fusicoccins are biosynthesized by an unusual chimera diterpene synthase in fungi</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>3084</fpage>
        <lpage>3088</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0608426104</pub-id>
        <pub-id pub-id-type="pmid">17360612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zang</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>Agrocybe aegerita</italic> serves as a gateway for identifying sesquiterpene biosynthetic enzymes in higher fungi</article-title>
        <source>ACS Chem. Biol.</source>
        <year>2020</year>
        <volume>15</volume>
        <fpage>1268</fpage>
        <lpage>1277</lpage>
        <pub-id pub-id-type="doi">10.1021/acschembio.0c00155</pub-id>
        <pub-id pub-id-type="pmid">32233445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oikawa</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cloning and functional expression of cDNA encoding aphidicolan-16 beta-ol synthase: A key enzyme responsible for formation of an unusual diterpene skeleton in biosynthesis of aphidicolin</article-title>
        <source>J. Am. Chem. Soc.</source>
        <year>2001</year>
        <volume>123</volume>
        <fpage>5154</fpage>
        <lpage>5155</lpage>
        <pub-id pub-id-type="doi">10.1021/ja015747j</pub-id>
        <pub-id pub-id-type="pmid">11457369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rynkiewicz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cane</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Christianson</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Structure of trichodiene synthase from <italic>Fusarium sporotrichioides</italic> provides mechanistic inferences on the terpene cyclization cascade</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>13543</fpage>
        <lpage>13548</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.231313098</pub-id>
        <pub-id pub-id-type="pmid">11698643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonsch</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of genes encoding squalestatin S1 biosynthesis and in vitro production of new squalestatin analogues</article-title>
        <source>Chem. Commun.</source>
        <year>2016</year>
        <volume>52</volume>
        <fpage>6777</fpage>
        <lpage>6780</lpage>
        <pub-id pub-id-type="doi">10.1039/C6CC02130A</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Elliot</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Idnurm</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Identification of a gene cluster for the synthesis of the plant hormone abscisic acid in the plant pathogen <italic>Leptosphaeria maculans</italic></article-title>
        <source>Fungal Gen. Biol.</source>
        <year>2019</year>
        <volume>130</volume>
        <fpage>62</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1016/j.fgb.2019.04.015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Characterization and biosynthesis of a rare fungal hopane-type triterpenoid glycoside involved in the antistress property of <italic>Aspergillus fumigatus</italic></article-title>
        <source>Org. Lett.</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>3252</fpage>
        <lpage>3256</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.orglett.9b00984</pub-id>
        <pub-id pub-id-type="pmid">30977375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>UniProt</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>UniProt: The universal protein knowledgebase</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D158</fpage>
        <lpage>D169</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1099</pub-id>
        <pub-id pub-id-type="pmid">27899622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">David, E. M., &amp; Croteau R. Cyclization enzymes in the biosynthesis of monoterpenes, sesquiterpenes, and diterpenes. in <italic>Biosynthesis. Topics in Current Chemistry</italic> (Leeper, F. J., Vederas, J. C. eds.). Vol. 209. 53–95 (2000).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inglis</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive annotation of secondary metabolite biosynthetic genes and gene clusters of <italic>Aspergillus nidulans</italic>, <italic>A. fumigatus</italic>, <italic>A. niger</italic> and <italic>A. oryzae</italic></article-title>
        <source>BMC Microbiol.</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>91</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2180-13-91</pub-id>
        <pub-id pub-id-type="pmid">23617571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janeveska</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tudzynski</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Secondary metabolism in <italic>Fusarium fujikuroi</italic>: Strategies to unravel the function of biosynthetic pathways</article-title>
        <source>Appl. Microbiol. Biotechnol.</source>
        <year>2018</year>
        <volume>102</volume>
        <fpage>615</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1007/s00253-017-8679-5</pub-id>
        <pub-id pub-id-type="pmid">29204899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FGDB: Revisiting the genome annotation of the plant pathogen <italic>Fusarium graminearum</italic></article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D637</fpage>
        <lpage>D639</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1016</pub-id>
        <pub-id pub-id-type="pmid">21051345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutreux</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly and annotation of three <italic>Leptosphaeria</italic> genomes using Oxford nanopore MinION sequencing</article-title>
        <source>Sci. Data</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>180235</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2018.235</pub-id>
        <pub-id pub-id-type="pmid">30398473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sieber</surname>
            <given-names>CMK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The <italic>Fusarium graminearum</italic> genome reveals more secondary metabolite gene clusters and hints of horizontal gene transfer</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e110311</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0110311</pub-id>
        <pub-id pub-id-type="pmid">25333987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gay</surname>
            <given-names>EJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale transcriptomics to dissect 2 years of the life of a fungal phytopathogen interacting with its host plant</article-title>
        <source>BMC Biol.</source>
        <year>2021</year>
        <volume>19</volume>
        <fpage>55</fpage>
        <pub-id pub-id-type="doi">10.1186/s12915-021-00989-3</pub-id>
        <pub-id pub-id-type="pmid">33757516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated profile HMM searches</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
        <pub-id pub-id-type="pmid">22039361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: Multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2460</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id>
        <pub-id pub-id-type="pmid">20709691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeats</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redfern</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Orengo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A fast and automated solution for accurately resolving protein domain architectures</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>745</fpage>
        <lpage>751</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq034</pub-id>
        <pub-id pub-id-type="pmid">20118117</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
