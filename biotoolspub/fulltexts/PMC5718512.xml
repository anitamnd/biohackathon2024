<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5718512</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-10884</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0189012</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolites</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Pathways</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Enzymology</subject>
            <subj-group>
              <subject>Enzyme Chemistry</subject>
              <subj-group>
                <subject>Enzyme Metabolism</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Models</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Enzymology</subject>
            <subj-group>
              <subject>Enzymes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Enzymes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pharmacology</subject>
          <subj-group>
            <subject>Pharmacokinetics</subject>
            <subj-group>
              <subject>Drug Metabolism</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Null diffusion-based enrichment for metabolomics data</article-title>
      <alt-title alt-title-type="running-head">Null diffusion-based enrichment for metabolomics data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6426-8204</contrib-id>
        <name>
          <surname>Picart-Armada</surname>
          <given-names>Sergio</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fernández-Albert</surname>
          <given-names>Francesc</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff008">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vinaixa</surname>
          <given-names>Maria</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rodríguez</surname>
          <given-names>Miguel A.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aivio</surname>
          <given-names>Suvi</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stracker</surname>
          <given-names>Travis H.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yanes</surname>
          <given-names>Oscar</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perera-Lluna</surname>
          <given-names>Alexandre</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Departament d’Enginyeria de Sistemes, Automàtica i Informàtica Industrial, Universitat Politècnica de Catalunya, Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Networking Biomedical Research Centre in the subject area of Bioengineering, Biomaterials and Nanomedicine (CIBER-BBN), Madrid, Spain</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institut de Recerca Pediàtrica Hospital Sant Joan de Déu, Esplugues de Llobregat, Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Centre for Omic Sciences, Rovira i Virgili University, Reus, Spain</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Electronic Engineering, Rovira i Virgili University, Tarragona, Spain</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Metabolomics Platform, Spanish Biomedical Research Centre in Diabetes and Associated Metabolic Disorders, Madrid, Spain</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Institute for Research in Biomedicine, Barcelona Institute of Science and Technology, Barcelona, Spain</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>Takeda Cambridge Ltd, Cambridge, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Weiner</surname>
          <given-names>Joel H.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Alberta, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>We have the following interests: Francesc Fernández-Albert has been employed by Takeda Cambridge Ltd. There are no patents, products in development or marketed products to declare. This does not alter our adherence to all the PLOS ONE policies on sharing data and materials, as detailed online in the guide for authors.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sergi.picart@upc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>12</month>
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>12</issue>
    <elocation-id>e0189012</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Picart-Armada et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Picart-Armada et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0189012.pdf"/>
    <abstract>
      <p>Metabolomics experiments identify metabolites whose abundance varies as the conditions under study change. Pathway enrichment tools help in the identification of key metabolic processes and in building a plausible biological explanation for these variations. Although several methods are available for pathway enrichment using experimental evidence, metabolomics does not yet have a comprehensive overview in a network layout at multiple molecular levels. We propose a novel pathway enrichment procedure for analysing summary metabolomics data based on sub-network analysis in a graph representation of a reference database. Relevant entries are extracted from the database according to statistical measures over a null diffusive process that accounts for network topology and pathway crosstalk. Entries are reported as a sub-pathway network, including not only pathways, but also modules, enzymes, reactions and possibly other compound candidates for further analyses. This provides a richer biological context, suitable for generating new study hypotheses and potential enzymatic targets. Using this method, we report results from cells depleted for an uncharacterised mitochondrial gene using GC and LC-MS data and employing KEGG as a knowledge base. Partial validation is provided with NMR-based tracking of <sup>13</sup>C glucose labelling of these cells.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BFU2012-39521</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stracker</surname>
            <given-names>Travis H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BFU2015-68354</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stracker</surname>
            <given-names>Travis H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TEC2014-60337-R</award-id>
        <principal-award-recipient>
          <name>
            <surname>Perera-Lluna</surname>
            <given-names>Alexandre</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SAF2011-30578</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yanes</surname>
            <given-names>Oscar</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BFU2014-57466</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yanes</surname>
            <given-names>Oscar</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by the Spanish Ministry of Economy and Competitiveness (<ext-link ext-link-type="uri" xlink:href="http://www.mineco.gob.es">www.mineco.gob.es</ext-link>) [BFU2012-39521 and BFU2015-68354 to T.S., TEC2014-60337-R to A.P., SAF2011-30578 and BFU2014-57466 to O.Y.]. O.Y., A.P. and S.P. thank for funding the Spanish Biomedical Research Centre in Diabetes and Associated Metabolic Disorders (CIBERDEM) and the Networking Biomedical Research Centre in the subject area of Bioengineering, Biomaterials and Nanomedicine (CIBER-BBN), both initiatives of Instituto de Investigación Carlos III (ISCIII). S.A. was supported by a Finnish Cultural Society Fellowship. S.P. thanks the AGAUR FI-scholarship programme. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. Takeda Cambridge Ltd provided support in the form of salaries for authors [FF], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="4"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Metabolomics is the science that studies the chemical reactions taking place in a living organism by measuring their lightweight reactants and products, also called metabolites. Metabolomics is used in the study of human disease, biomarker identification, drug evaluation and treatment prognosis [<xref rid="pone.0189012.ref001" ref-type="bibr">1</xref>]. Metabolomics datasets are generated from the identification and quantification of the metabolites in a sample. Afterwards, statistical analysis of the datasets enables researchers to devise a plausible explanation for the changes identified and to understand the underlying biological processes involved [<xref rid="pone.0189012.ref002" ref-type="bibr">2</xref>].</p>
    <p>Current methods to measure metabolites mainly rely on Nuclear Magnetic Resonance (NMR) and Mass Spectrometry (MS) technologies [<xref rid="pone.0189012.ref003" ref-type="bibr">3</xref>], the latter consisting of two broad categories: Liquid Chromatography and Gas Chromatography coupled to MS (LC/MS and GC/MS). Raw data processing, also known as primary analysis, can be achieved using tools including MeltDB [<xref rid="pone.0189012.ref004" ref-type="bibr">4</xref>], MetaboAnalyst [<xref rid="pone.0189012.ref005" ref-type="bibr">5</xref>], MAIT [<xref rid="pone.0189012.ref006" ref-type="bibr">6</xref>], along with spectral databases [<xref rid="pone.0189012.ref007" ref-type="bibr">7</xref>] like the Human Metabolome Database [<xref rid="pone.0189012.ref008" ref-type="bibr">8</xref>], resulting in a table of relative metabolite abundances.</p>
    <p>Data interpretation, known as secondary analysis, benefits from the identification of metabolic pathways to draw conclusions, encouraging the use of so-called pathway enrichment techniques. Their purpose is to provide the metabolites with their biological context, drawing from comprehensive databases like Kyoto Encyclopedia of Genes and Genomes, KEGG [<xref rid="pone.0189012.ref009" ref-type="bibr">9</xref>], Reactome [<xref rid="pone.0189012.ref010" ref-type="bibr">10</xref>], WikiPathways [<xref rid="pone.0189012.ref011" ref-type="bibr">11</xref>] and the Small Molecule Pathway Database [<xref rid="pone.0189012.ref011" ref-type="bibr">11</xref>]. Enrichment outputs can be further analysed by manual network manipulation through tools such as Cytoscape [<xref rid="pone.0189012.ref012" ref-type="bibr">12</xref>], whose plug-in MetScape [<xref rid="pone.0189012.ref013" ref-type="bibr">13</xref>] builds networks containing compounds, reactions, enzymes and genes. In this work, pathway enrichment techniques will be divided into three generations, following the review in [<xref rid="pone.0189012.ref014" ref-type="bibr">14</xref>].</p>
    <p>The first generation of enrichment techniques is based on Over Representation Analysis (ORA), a statistical test that assesses whether the occurrence of a label within a subset is greater than expected by chance in the background population. Applied to metabolomics, it takes as input the identifiers of affected metabolites (previously determined through a statistical test involving conditions) and assesses a p-value for each pathway. ORA is available through the web tools IMPaLA [<xref rid="pone.0189012.ref015" ref-type="bibr">15</xref>], MetaboAnalyst, MBRole and MPEA [<xref rid="pone.0189012.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0189012.ref017" ref-type="bibr">17</xref>]. Limitations of ORA include an oversimplification of the biology, a thresholding decision issue when generating the input metabolite list and a lower power for capturing subtle and coordinated changes within a pathway [<xref rid="pone.0189012.ref018" ref-type="bibr">18</xref>].</p>
    <p>A second generation of enrichment methods, Functional Class Scoring (FCS), avoids the cutoff choice in generating the affected metabolite list and claims the capability of capturing subtle but consistent changes in concentration [<xref rid="pone.0189012.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0189012.ref019" ref-type="bibr">19</xref>]. This concept was imported from Gene Set Enrichment Analysis [<xref rid="pone.0189012.ref018" ref-type="bibr">18</xref>] and is available through MSEA [<xref rid="pone.0189012.ref020" ref-type="bibr">20</xref>] in MetaboAnalyst and IMPaLA. A shortcoming of FCS methods is that they ignore the network nature of biological pathways [<xref rid="pone.0189012.ref014" ref-type="bibr">14</xref>]. As biological datasets are heterogeneous, and as no method is always best, the researcher’s expertise and prior knowledge remain key factors when choosing between ORA and FCS [<xref rid="pone.0189012.ref021" ref-type="bibr">21</xref>].</p>
    <p>The third generation of enrichment techniques attempts to incorporate topological data on the underlying biological networks. This concept was applied early to genetic data through ScorePAGE [<xref rid="pone.0189012.ref022" ref-type="bibr">22</xref>] and is available in current tools like Pathway-Express [<xref rid="pone.0189012.ref023" ref-type="bibr">23</xref>]. For metabolomics data, MetaboAnalyst assigns each metabolic pathway a topological score accounting for the centrality of measured metabolites.</p>
    <p>Pathway enrichment techniques face challenges, such as dealing with pathway crosstalk and overlap [<xref rid="pone.0189012.ref014" ref-type="bibr">14</xref>] or generating comprehensive outputs rather than pathway p-value lists [<xref rid="pone.0189012.ref021" ref-type="bibr">21</xref>]. Statistical tests that account for pathway crosstalk and overlap have been proposed for gene data [<xref rid="pone.0189012.ref024" ref-type="bibr">24</xref>, <xref rid="pone.0189012.ref025" ref-type="bibr">25</xref>]. Although pathway analysis techniques constitute essential resources for metabolomics secondary analysis, the abstract and artificial borders between pathways may not faithfully reflect biological mechanisms [<xref rid="pone.0189012.ref002" ref-type="bibr">2</xref>]. This issue can be bypassed using sub-network analysis, a secondary analysis procedure to infer relevant biological modules under the condition of study [<xref rid="pone.0189012.ref026" ref-type="bibr">26</xref>] without being limited by pathway definitions. Sub-network analysis has also been applied to the canonical pathways to obtain enrichment in a sub-pathway scale for gene and protein data [<xref rid="pone.0189012.ref027" ref-type="bibr">27</xref>, <xref rid="pone.0189012.ref028" ref-type="bibr">28</xref>]. Some methods, such as jActiveModules [<xref rid="pone.0189012.ref029" ref-type="bibr">29</xref>], define scores and attempt to find optimally scoring sub-networks. Likewise, diffusion kernels and random walk algorithms that score the nodes of a network, such as PageRank [<xref rid="pone.0189012.ref030" ref-type="bibr">30</xref>], have been applied to genetic data [<xref rid="pone.0189012.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0189012.ref032" ref-type="bibr">32</xref>] and metabolic networks [<xref rid="pone.0189012.ref033" ref-type="bibr">33</xref>].</p>
    <p>The HotNet algorithm [<xref rid="pone.0189012.ref031" ref-type="bibr">31</xref>], applied to gene networks, computes pairwise influence measures from node <italic>g</italic><sub><italic>s</italic></sub> to node <italic>g</italic><sub><italic>i</italic></sub>, by introducing a flow on <italic>g</italic><sub><italic>s</italic></sub> and allowing it to leave through all the nodes. The diffusion score of node <italic>g</italic><sub><italic>i</italic></sub>, <inline-formula id="pone.0189012.e001"><alternatives><graphic xlink:href="pone.0189012.e001.jpg" id="pone.0189012.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, is interpreted as the influence <italic>i</italic>(<italic>g</italic><sub><italic>s</italic></sub>, <italic>g</italic><sub><italic>i</italic></sub>). A new undirected graph is built using the weights <italic>w</italic>(<italic>g</italic><sub><italic>j</italic></sub>, <italic>g</italic><sub><italic>k</italic></sub>) = min[<italic>i</italic>(<italic>g</italic><sub><italic>j</italic></sub>, <italic>g</italic><sub><italic>k</italic></sub>), <italic>i</italic>(<italic>g</italic><sub><italic>k</italic></sub>, <italic>g</italic><sub><italic>j</italic></sub>)], in which sub-networks encompassing a large number of gene mutations are sought. TieDIE [<xref rid="pone.0189012.ref032" ref-type="bibr">32</xref>] applies a similar concept, aiming to connect a source and a target gene set. Flow is introduced between the source and the target sets, giving rise to two diffusion processes that score all the nodes. The linking score of each node, defined as the minimum of its two diffusion scores, serves as a ranking to apply a global threshold and report the resulting sub-network.</p>
    <p>Here we describe the development of an innovative methodology that combines the usefulness of pathway enrichment with the flexibility of sub-network analysis. Starting from summary metabolomics data, we apply a null diffusive process over a network-based representation of the KEGG database and derive a relevant sub-network. Besides offering an overview in the form of a list of affected pathways, we propose a novel sub-pathway representation at several molecular levels that justifies the reported pathways through additional biological entities (reactions, enzymes and KEGG modules) to identify candidates for further study. All of the reported entries, along with their annotations, are drawn in a heterogeneous network layout.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Overview</title>
      <p>An overall scheme of the proposed methodology is presented (<xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>): on the one hand, we retrieve knowledge from KEGG as a graph object; on the other hand, the input to our algorithm is a list of significantly affected metabolites from an experimental study, obtained for example by applying a non-parametric Wilcoxon test to each metabolite’s abundance. Afterwards, the graph is regarded as a meshed object in which the nodes representing the affected metabolites introduce unitary flow. The resulting node scores are normalised using a null diffusive model, and the top scores define an interpretable relevant subgraph. All this work has been implemented in the R language [<xref rid="pone.0189012.ref034" ref-type="bibr">34</xref>] and the network algorithms rely on the igraph R package [<xref rid="pone.0189012.ref035" ref-type="bibr">35</xref>]. Our R code is under active development and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/b2slab/FELLA">https://github.com/b2slab/FELLA</ext-link>.</p>
      <fig id="pone.0189012.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Workflow summary.</title>
          <p>Contextual knowledge is extracted from KEGG as a graph object while experimental data is introduced as a list of affected metabolites. A null diffusive model assesses, and reports in a subgraph, which part of the KEGG graph is relevant for the input metabolites.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g001"/>
      </fig>
      <p>Contextual knowledge is depicted according to the KEGG database (<xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>), through the following categories: compounds, reactions, enzymes, modules and pathways. This network is specific for Homo sapiens and its construction is detailed in <xref ref-type="supplementary-material" rid="pone.0189012.s004">S1 Appendix</xref>.</p>
    </sec>
    <sec id="sec004">
      <title>Scoring algorithms</title>
      <p>We derived scores for all the nodes through random walks on the KEGG graph, in order to assess their importance relative to the metabolites in the input. Performing random walks on the undirected graph is equivalent to running a diffusion process; specifically, we model heat diffusion. Conversely, if the graph is directed, the problem matches the PageRank algorithm for website ranking. Both the undirected and the directed versions are applied and referred to as diffusive processes (<xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>).</p>
      <p>In the undirected graph case, using a heat diffusion model, we model the biological perturbation in the KEGG graph as heat flow that traverses our KEGG graph. It is important to emphasise that this heat diffusion approach is purely a knowledge propagation abstraction, in no way simulating heat diffusion on the actual biological entities. Heat is forced to flow from nodes corresponding to affected metabolites and through database annotations, leading to a score for each node in the KEGG graph: its stationary temperature (<xref ref-type="disp-formula" rid="pone.0189012.e002">Eq 1</xref>). The rationale behind this approach is that nodes lying close to the affected metabolites, which are heat sources, will hold a higher stationary temperature. This can happen due to great proximity to a particular heat source or to overall closeness to multiple ones. In order to determine the temperatures, we apply the finite difference formulation [<xref rid="pone.0189012.ref036" ref-type="bibr">36</xref>] of the heat equation, using the explicit method, applied to a meshed object (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2a</xref>) [<xref rid="pone.0189012.ref037" ref-type="bibr">37</xref>].
<disp-formula id="pone.0189012.e002"><alternatives><graphic xlink:href="pone.0189012.e002.jpg" id="pone.0189012.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <fig id="pone.0189012.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Nodes arrangement for (a) heat diffusion and (b) PageRank.</title>
          <p>The affected metabolites are highlighted with a black ring. For heat diffusion <bold>(a)</bold>, affected metabolites are forced to generate unitary flow. Every pathway is highlighted with a blue ring, representing its connection to a cool boundary node. In equilibrium, the highest temperature pathways (and nodes) will have the greatest heat flow, suggesting a relevant role in the experiment. For PageRank <bold>(b)</bold>, affected metabolites are the start of random walks. PageRank scores, represented by the intensity of the blue colour, will attain higher values in the frequently reached random walk nodes.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g002"/>
      </fig>
      <p>On the one hand, <italic>KI</italic> is the conductance matrix, where <italic>KI</italic> = <italic>L</italic> + <italic>B</italic>, <italic>L</italic> being the unnormalised graph Laplacian and <italic>B</italic> the diagonal adjacency matrix with <italic>B</italic><sub><italic>ii</italic></sub> = 1 if node <italic>i</italic> is a pathway and <italic>B</italic><sub><italic>ii</italic></sub> = 0 otherwise. The matrix <italic>B</italic> ensures that flow can leave the graph through pathways nodes. The matrix <italic>R</italic><sub><italic>HD</italic></sub> is defined as −<italic>KI</italic><sup>−1</sup>, the linear mapping to compute the temperatures. On the other hand, <italic>G</italic> is the heat generation vector, whose entries <italic>G</italic><sub><italic>i</italic></sub> are unitary if <italic>i</italic> is an affected metabolite and 0 otherwise.</p>
      <p>In our node arrangement (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2a</xref>), the affected metabolites constantly introduce heat flow into the structure and only the nodes in the top level (metabolic pathways) are allowed to disperse it. Further details are available in <xref ref-type="supplementary-material" rid="pone.0189012.s005">S2 Appendix</xref>.</p>
      <p>In the directed graph case, the PageRank scoring algorithm is a web model that assigns each website a score reflecting the number of incoming hyperlinks as well as the quality of their respective websites. The web surfer performs random walks on a directed graph, with an initial probability distribution over the nodes. In each step, the surfer resumes his random walk with probability <italic>d</italic> and restarts it with probability 1 − <italic>d</italic>, where <italic>d</italic> is the damping factor. If the surfer continues, he or she will choose an edge with a probability proportional to its weight. The default computation of PageRank scores is iterative for efficiency reasons, although a formula similar to (<xref ref-type="disp-formula" rid="pone.0189012.e002">Eq 1</xref>) can be derived and will be used in the proposed methods. The damping factor is set to <italic>d</italic> = 0.85 as in the original publication.</p>
      <p>The arrangement of nodes for the PageRank calculation is identical to the one for diffusion (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2b</xref>), being edges directed towards the upper levels. Random walks start only at the affected metabolites and explore all the reachable nodes. Further details are available in <xref ref-type="supplementary-material" rid="pone.0189012.s006">S3 Appendix</xref>.</p>
    </sec>
    <sec id="sec005">
      <title>Null models</title>
      <p>The ranking of the network nodes is not achieved through raw scores, due to potential biases related to topological features. This is also the case in classical over-representation analysis, as it can be rephrased as a particular case of heat diffusion (<xref ref-type="fig" rid="pone.0189012.g003">Fig 3</xref>) where the observed statistic is the node temperature and its null distribution is the hypergeometric distribution. In view of this, our approach also includes a permutation analysis in the input, leading to a null distribution of scores for each node. Node scores are normalised using their null distributions and ranked, allowing a subgraph (<xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>) to be extracted. Further details can be found in <xref ref-type="supplementary-material" rid="pone.0189012.s007">S4 Appendix</xref>.</p>
      <fig id="pone.0189012.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Toy example of an over-representation analysis of a hypothetical “pathway A” containing 3 metabolites out of a total of 10.</title>
          <p>The list to be enriched contains 4 metabolites, showing 2 hits in the pathway. The corresponding (Fisher’s exact test) over-representation can be understood as a diffusion process on the depicted network followed by a null model. The temperature of pathway A is always coincident with the number of hits in the pathway, implying that its null distribution is the hypergeometric distribution, to which a one-tailed temperature comparison is made.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g003"/>
      </fig>
      <p>The null model will be introduced in the heat diffusion scenario (the PageRank case is analogous). Let <italic>n</italic><sub><italic>in</italic></sub> be the number of compounds in the input. Then, exactly <italic>n</italic><sub><italic>in</italic></sub> different KEGG compounds are chosen at random following dependent Bernoulli distributions, so that <italic>X</italic><sub><italic>i</italic></sub> = 1 if <italic>i</italic> is chosen and <italic>X</italic><sub><italic>i</italic></sub> = 0 otherwise. Normalisation can be performed using (i) the theoretical mean and variance of the scores, which can be obtained from <xref ref-type="disp-formula" rid="pone.0189012.e002">Eq 1</xref>, using the fact that, for the null model, <italic>G</italic> is a random vector <italic>X</italic> with known mean and covariance matrix:
<disp-formula id="pone.0189012.e003"><alternatives><graphic xlink:href="pone.0189012.e003.jpg" id="pone.0189012.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi mathvariant="double-struck">E</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mstyle mathvariant="normal"><mml:mi mathvariant="double-struck">E</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pone.0189012.e004"><alternatives><graphic xlink:href="pone.0189012.e004.jpg" id="pone.0189012.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Σ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>Σ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>The normalised score (z-score) of node <italic>i</italic> is defined in terms of the expected value <inline-formula id="pone.0189012.e010"><alternatives><graphic xlink:href="pone.0189012.e010.jpg" id="pone.0189012.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mi mathvariant="double-struck">E</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and standard deviation <inline-formula id="pone.0189012.e005"><alternatives><graphic xlink:href="pone.0189012.e005.jpg" id="pone.0189012.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>Σ</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>
<disp-formula id="pone.0189012.e006"><alternatives><graphic xlink:href="pone.0189012.e006.jpg" id="pone.0189012.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>Then, nodes with the top <italic>k</italic> scores are kept and reported. Alternatively, scores can be normalised through (ii) Monte Carlo simulations with <italic>n</italic><sub><italic>perm</italic></sub> permutations, which provide an estimate of the probability <italic>p</italic><sub><italic>i</italic></sub> that the null distribution attains a score greater than or equal to the observed one. Estimation of <italic>p</italic><sub><italic>i</italic></sub> involves the empirical cumulative distribution function with a small correction [<xref rid="pone.0189012.ref038" ref-type="bibr">38</xref>], <italic>r</italic><sub><italic>i</italic></sub> being the number of permutations in which the null score of node <italic>i</italic> is greater or equal than <italic>T</italic><sub><italic>i</italic></sub>:
<disp-formula id="pone.0189012.e007"><alternatives><graphic xlink:href="pone.0189012.e007.jpg" id="pone.0189012.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
      <p>A consensus solution is derived from <italic>n</italic><sub><italic>vote</italic></sub> independent sets of Monte Carlo trials, each trial reporting the top <italic>k</italic> nodes. The consensus solution may therefore report a node count not exactly equal to <italic>k</italic>.</p>
    </sec>
    <sec id="sec006">
      <title>NMR validation</title>
      <p>The reported subgraphs contain entities other than pathways and compounds that can be useful for the researchers. Among these, the highlighted reactions have been partially validated by quantifying their distance to an independent second set of affected metabolites.</p>
      <p>In order to analyse the reactions in the scope of a metabolic network, distances are computed on the unweighted, maximal connected subgraph containing all the compounds and reactions from the KEGG graph, referred to as the reaction-compound graph. The validation metric is the resistance distance, previously used in the chemical literature [<xref rid="pone.0189012.ref039" ref-type="bibr">39</xref>]. Under these settings, the reported reactions are compared to all the reactions that involve the input metabolites (their nearest neighbours) in terms of their resistance distance to the second set of metabolites.</p>
    </sec>
    <sec id="sec007">
      <title>Evaluation with synthetic signals</title>
      <p>In order to deploy an analysis of true and false positive pathway identifications, we opted to statistically characterize the pathway prioritisation induced by the diffusion scores. Artificial pathway signals have been generated to (a) find biases in the absence of a signal that might cause false positives, and to (b) quantify the ability to recover true positive pathways. The proposed methods are not directly compared to IMPaLA and MetaboAnalyst due to the lack of a batch analysis mode, but instead to their underlying distribution using Fisher’s exact test. Our Monte Carlo approaches have not been aggregated into consensus solutions. The performance metric is the pathway rank in the list ordered by a method, where <inline-formula id="pone.0189012.e008"><alternatives><graphic xlink:href="pone.0189012.e008.jpg" id="pone.0189012.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula> is the best rank and 1 is the worst one, <italic>n</italic><sub><italic>p</italic></sub> being the number of pathways in the KEGG graph. Ranks in Fisher’s exact test are computed using the raw p-values, so that top ranked pathways correspond to lowest p-values. To compute the p-values, a metabolite is considered to belong to a pathway if it can be reached via the pathway in our directed KEGG graph (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2</xref>).</p>
      <p>In (a), noisy signals are generated and the ranks of all the pathways are calculated within signals. Then, the mean rank of a specific pathway <italic>i</italic> is computed across all the signals. This measure can reveal pathways that tend to have an extreme rank irrespective of the input.</p>
      <p>In (b), a target pathway generates the signal and its rank is used as the metric of interest. Methods able to recover the signal will show low ranks in general terms.</p>
    </sec>
    <sec id="sec008">
      <title>Description of the experimental data</title>
      <p>Our method has been tested using data from a case-control experiment aimed at determining the function of an uncharacterised mitochondrial protein by silencing the gene using short hairpin RNAs (shRNA). Metabolites abundances were determined from five replicates of cell cultures expressing either control or experimental shRNA.</p>
      <p>Metabolite measurements were performed by Metabolon platform (<ext-link ext-link-type="uri" xlink:href="http://www.metabolon.com">www.metabolon.com</ext-link>) using GC/MS (Thermo-Finnigan Trace DSQ single-quadrupole) and LC/MS (Waters ACQUITY UPLC and a Thermo-Finnigan LTQ-FT). The proprietary Metabolon analysis reported 168 quantified metabolites annotated in the KEGG database.</p>
      <p>In addition, we have used NMR following the labelling of the same cells with [U-<sup>13</sup>C] glucose [<xref rid="pone.0189012.ref040" ref-type="bibr">40</xref>] to trace carbon atoms, in order to further validate the conclusions of our new method. The reported reactions are evaluated in terms of their resistance distance to the affected metabolites found by NMR.</p>
    </sec>
    <sec id="sec009">
      <title>Description of the synthetic data</title>
      <p>All the signals generate a list with fixed length <italic>n</italic><sub><italic>in</italic></sub> = 35 for each one of the <italic>n</italic><sub><italic>p</italic></sub> pathway nodes in the KEGG graph. Three sampling types have been defined—differences arise in the specification of how much more probable compounds in the target pathway are.</p>
      <p>The first signal is a uniform sampling of <italic>n</italic><sub><italic>in</italic></sub> compounds that imitates noise: the probability of drawing a compound <italic>j</italic> within pathway <italic>i</italic>, <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub>, is <italic>k</italic><sub><italic>i</italic></sub> = 1 times more likely to be drawn than compounds outside the pathway, and thus does not depend on the pathway.</p>
      <p>In the second signal, compounds belonging to pathway <italic>i</italic> are <italic>k</italic><sub><italic>i</italic></sub> = 10 times more likely to be drawn. Therefore, there are two different probability values: inside pathway and outside pathway. This sampling is affine to the assumptions in Fisher’s exact test from ORA.</p>
      <p>As for the third signal, <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> is proportional to the quantity <italic>R</italic><sub><italic>HD</italic></sub><sub><italic>ij</italic></sub>, which is greater in compounds close to the pathway. This takes into account the whole KEGG graph, thus being influenced by indirect connections and compound specificity.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec010">
    <title>Results</title>
    <sec id="sec011">
      <title>Input for the algorithms</title>
      <p>After the curation step, our knowledge base graph contains 10,183 nodes and 31,539 edges. The nodes are stratified in 288 pathways, 178 modules, 1,149 enzymes, 4,699 reactions and 3,869 compounds. The degree distribution of its vertices follow a scale-free network model, where <italic>P</italic>(<italic>k</italic>)∼<italic>k</italic><sup>−<italic>γ</italic></sup>, with <italic>γ</italic> = 2.084 ∈ [2, 3], see <xref ref-type="supplementary-material" rid="pone.0189012.s004">S1 Appendix</xref>.</p>
      <p>On the other hand, MS led to 168 quantified metabolites from KEGG. Two identifiers that each appeared twice have been dropped, as well as a KEGG drug, excluded from the KEGG compound category. The remaining 163 metabolites have been tested between both conditions, leading to 38 significant metabolites (two-tailed non-parametric Wilcoxon, FDR &lt; 0.05), of which 33 have been mapped to our KEGG graph.</p>
      <p>The 33 MS-derived compounds served as input for each of the proposed enrichment algorithms. Heat Diffusion (<italic>HD</italic>) and PageRank (<italic>PR</italic>) are followed by <italic>norm</italic> (z-score normalisation) or <italic>sim</italic> (Monte Carlo permutations). Normalised scores have been computed through the null models with <italic>n</italic><sub><italic>in</italic></sub> = 33, followed with subgraph selection with a desired number of nodes <italic>k</italic> = 250. For simulated methods, a consensus subgraph using <italic>n</italic><sub><italic>vote</italic></sub> = 9 runs of <italic>n</italic><sub><italic>perm</italic></sub> = 10,000 permutations each has been derived by majority vote on each node.</p>
      <p>Regardless of the specific details, high diffusion scores are an indicator of overall closeness to the MS-derived metabolites and potential relevance in the condition being studied. This intuition, known as guilt-by-association, can be phrased in the context of heat diffusion: high temperatures are found close to the heat sources. Therefore, warm nodes are candidates for further study as they are easily reached through database annotations from the input metabolites.</p>
    </sec>
    <sec id="sec012">
      <title>Null model impact</title>
      <p>The impact of using the null model in HD and an overview of the random temperatures behaviour is described in <xref ref-type="fig" rid="pone.0189012.g004">Fig 4</xref>. The null model is closely related to the graph structure and node topology, quantified through the vertex degree. In <xref ref-type="fig" rid="pone.0189012.g004">Fig 4a</xref>, the mean temperatures show different trends for the five levels in the graph; in particular, there is an increase in the mean pathway temperature as the pathway becomes larger. This implies that, regardless of the input, larger pathways will generally show warmer temperatures and the results will be biased towards them. Likewise, the standard deviations of the null temperatures show level-specific changes (<xref ref-type="fig" rid="pone.0189012.g004">Fig 4b</xref>), with the compounds being the most affected entities—the higher the degree of the compound, the lower its standard deviation.</p>
      <fig id="pone.0189012.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <p>Expected value <bold>(a)</bold> and standard deviation <bold>(b)</bold> of the null temperatures, stratified by level—jitter applied for visual purposes and 0.95 confidence intervals computed by the default GAM models in ggplot2 R library [<xref rid="pone.0189012.ref041" ref-type="bibr">41</xref>]. Clear biases arise due to the node degree, a topological property of the nodes: the larger the pathway, the higher its mean value, and the more connected a compound is, the smaller its variance. If pathways are ranked by raw temperatures, a large pathway will have an undesired, consistent advantage over small ones and will be reported too often. The usage of z-scores <bold>(d)</bold> instead of raw temperatures <bold>(c)</bold> to select the top 250 nodes addresses these biases and highlights pathway and module nodes that were eclipsed by other compounds and reactions with higher mean null temperatures.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g004"/>
      </fig>
      <p>The usage of z-scores instead of raw temperatures has consequences in the highlighted nodes. Reporting the nodes with the top 250 raw temperatures does not reveal any pathway (<xref ref-type="fig" rid="pone.0189012.g004">Fig 4c</xref>), whereas five pathways lay among the top 250 z-scores (<xref ref-type="fig" rid="pone.0189012.g004">Fig 4d</xref>). Likewise, if only pathway nodes are considered, their ranking using raw temperatures is closely related to the ranking using the mean temperatures from the null model (<xref ref-type="fig" rid="pone.0189012.g005">Fig 5a</xref>), which is a property of the graph but not of the experimental data; using z-scores instead corrects this bias (<xref ref-type="fig" rid="pone.0189012.g005">Fig 5b</xref>). If the top 20 pathways are selected through their raw temperature, some of them are even below their mean null temperature (<xref ref-type="fig" rid="pone.0189012.g005">Fig 5c</xref>), whereas keeping the top 20 z-scores removes the bias towards larger pathways and suggests otherwise overlooked pathways (<xref ref-type="fig" rid="pone.0189012.g005">Fig 5d</xref>).</p>
      <fig id="pone.0189012.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <p>Ranking the 288 KEGG pathways—lower is best– using raw temperatures <bold>(a)</bold> biases the ranks towards pathways with higher mean null temperature, which in turn tend to be large pathways. Using the z-scores instead <bold>(b)</bold> breaks this clear dependence and avoids reporting pathways just because of their size. The top 20 pathways through raw temperatures <bold>(c)</bold>, depicted as black dots, include pathways that are even below their mean value, while the top 20 z-scores <bold>(d)</bold> suggest smaller pathways that were penalised by the aforementioned bias.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g005"/>
      </fig>
    </sec>
    <sec id="sec013">
      <title>Subgraph extraction</title>
      <p>Four subgraphs have been extracted using the MS-derived compounds. The desired number of nodes <italic>k</italic> for each approach, together with the actual number of reported nodes and the number of KEGG pathways, are shown in <xref ref-type="table" rid="pone.0189012.t001">Table 1</xref>. A connected component (CC) of an undirected graph is a maximal connected subgraph so that any two nodes in the subgraph are connected by a path. For the directed graphs, the weak CC definition is used, in which directed edges are considered as undirected when computing the CC. The number of nodes belonging to each solution subgraph, along with its largest CC and the number of CCs, are also reported. Additional details regarding the largest CC and number of CCs for other values of <italic>k</italic> can be found in <xref ref-type="supplementary-material" rid="pone.0189012.s008">S5 Appendix</xref>.</p>
      <table-wrap id="pone.0189012.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Summary of the outputs.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0189012.t001g" xlink:href="pone.0189012.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Name</th>
                <th align="center" rowspan="1" colspan="1">k</th>
                <th align="left" rowspan="1" colspan="1">Pathways</th>
                <th align="right" rowspan="1" colspan="1">Nodes</th>
                <th align="right" rowspan="1" colspan="1">#CC</th>
                <th align="right" rowspan="1" colspan="1">Largest CC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">HD norm</td>
                <td align="center" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">hsa00250, hsa00270, hsa00480, hsa05230, hsa05231</td>
                <td align="right" rowspan="1" colspan="1">250</td>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="right" rowspan="1" colspan="1">206</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HD sim</td>
                <td align="center" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">hsa00250, hsa00270, hsa00330, hsa00480, hsa05230, hsa05231</td>
                <td align="right" rowspan="1" colspan="1">261</td>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="right" rowspan="1" colspan="1">221</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">PR norm</td>
                <td align="center" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">hsa00250, hsa00270, hsa00480, hsa05231</td>
                <td align="right" rowspan="1" colspan="1">250</td>
                <td align="right" rowspan="1" colspan="1">9</td>
                <td align="right" rowspan="1" colspan="1">187</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">PR sim</td>
                <td align="center" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">hsa00250, hsa00270, hsa00480, hsa05231</td>
                <td align="right" rowspan="1" colspan="1">279</td>
                <td align="right" rowspan="1" colspan="1">10</td>
                <td align="right" rowspan="1" colspan="1">152</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Summary of the outputs, using diffusion (HD) as well as PageRank (PR), and normalising the scores with Monte Carlo simulations (sim) or z-scores (norm). Monte Carlo simulations have been run 10,000 times per solution, and 9 solutions have been computed to build a consensus solution. Note that the desired number of nodes <italic>k</italic> is slightly different to the number of nodes actually reported in the Monte Carlo simulations. The last two columns contain the number of connected components (<italic>CC</italic>) and the number of nodes in the largest CC.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Defining the overlap coefficient between two solutions <italic>G</italic><sub>1</sub> and <italic>G</italic><sub>2</sub> as <inline-formula id="pone.0189012.e009"><alternatives><graphic xlink:href="pone.0189012.e009.jpg" id="pone.0189012.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mtext>overlap</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, solutions tend to overlap despite their differences (<xref ref-type="table" rid="pone.0189012.t002">Table 2</xref>). Regarding the stratification of the subgraphs in terms of KEGG categories, they follow a trend similar to the KEGG graph (<xref ref-type="supplementary-material" rid="pone.0189012.s008">S5 Appendix</xref>).</p>
      <table-wrap id="pone.0189012.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Solutions overlap.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0189012.t002g" xlink:href="pone.0189012.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">HD norm</td>
                <td align="center" rowspan="1" colspan="1">HD sim</td>
                <td align="center" rowspan="1" colspan="1">PR norm</td>
                <td align="center" rowspan="1" colspan="1">PR sim</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HD norm</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">0.82</td>
                <td align="center" rowspan="1" colspan="1">0.88</td>
                <td align="center" rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HD sim</td>
                <td align="center" rowspan="1" colspan="1">0.82</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">0.77</td>
                <td align="center" rowspan="1" colspan="1">0.83</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">PR norm</td>
                <td align="center" rowspan="1" colspan="1">0.88</td>
                <td align="center" rowspan="1" colspan="1">0.77</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">0.84</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">PR sim</td>
                <td align="center" rowspan="1" colspan="1">0.82</td>
                <td align="center" rowspan="1" colspan="1">0.83</td>
                <td align="center" rowspan="1" colspan="1">0.84</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>Overlap coefficient statistics for HD and PR. The overlapping nature of solutions is a sign of consistency among approaches.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec014">
      <title>Pathway analysis</title>
      <p>Our methods are compared to IMPaLA and MetaboAnalyst to verify the concordance in terms of metabolic pathways. All the approaches have been compared using the example data from IMPaLA (<xref ref-type="supplementary-material" rid="pone.0189012.s002">S2 Table</xref>) and MetaboAnalyst (<xref ref-type="supplementary-material" rid="pone.0189012.s003">S3 Table</xref>), and they show consistent and compatible reports.</p>
      <p>The results for our dataset are summarised in <xref ref-type="table" rid="pone.0189012.t003">Table 3</xref> and described in <xref ref-type="supplementary-material" rid="pone.0189012.s001">S1 Table</xref>, together with further details about the reports of the alternative tools. The metabolic pathways Alanine, aspartate and glutamate metabolism (hsa00250), Cysteine and methionine metabolism (hsa00270) and especially the Glutathione metabolism (hsa00480) recur in all of the approaches. Some of our solutions are more specific, suggesting the module Glutathione Biosynthesis (M00118) as well. Our null model takes pathway overlap and crosstalk into account and allows a visualisation of the pathway structure through the null diffusion correlation matrix (<xref ref-type="supplementary-material" rid="pone.0189012.s007">S4 Appendix</xref>).</p>
      <table-wrap id="pone.0189012.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Reported pathways.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0189012.t003g" xlink:href="pone.0189012.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">KEGG id</th>
                <th align="left" rowspan="1" colspan="1">Pathway name</th>
                <th align="center" rowspan="1" colspan="1">HD norm</th>
                <th align="center" rowspan="1" colspan="1">HD sim</th>
                <th align="center" rowspan="1" colspan="1">PR norm</th>
                <th align="center" rowspan="1" colspan="1">PR sim</th>
                <th align="center" rowspan="1" colspan="1">MA FCS</th>
                <th align="center" rowspan="1" colspan="1">MA ORA</th>
                <th align="center" rowspan="1" colspan="1">IMPaLA ORA</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00250</td>
                <td align="left" rowspan="1" colspan="1">Alanine, aspartate and glutamate metabolism</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00270</td>
                <td align="left" rowspan="1" colspan="1">Cysteine and methionine metabolism</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00480</td>
                <td align="left" rowspan="1" colspan="1">Glutathione metabolism</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa05230 (hsa00970)</td>
                <td align="left" rowspan="1" colspan="1">Central carbon metabolism in cancer</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">+</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa05231 (hsa00564)</td>
                <td align="left" rowspan="1" colspan="1">Choline metabolism in cancer</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00260 (M00020)</td>
                <td align="left" rowspan="1" colspan="1">Glycine, serine and threonine metabolism</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00330 (M00133)</td>
                <td align="left" rowspan="1" colspan="1">Arginine and proline metabolism</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">+</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">+</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hsa00510 (M00073)</td>
                <td align="left" rowspan="1" colspan="1">N-Glycan biosynthesis</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">*</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t003fn001">
            <p>Pathways reported by our methods. ‘+’ means a hit for the term reported in the KEGG id column, ‘*’ stands for a hit of the closely related term in parenthesis in the same column and ‘-’ states no hit. Our 4 solutions are compared to MetaboAnalyst (MA), using ORA and FCS, and IMPaLA using ORA. Pathways hsa00250, hsa00270 and hsa00480 are repeatedly reported by all the methodologies. Pathways hsa05230 and hsa05231 are reported by some of our methods, while alternative approaches find some close (*) and exact (+) matches. In some cases, instead of reporting a whole pathway, only specific modules within it are reported as relevant; this is the case of M00133 and M00073. Furthermore, module M00073 does not contain any compounds, being out of the scope of MetaboAnalyst and IMPaLA, but is reported by one of our methods due to the presence of other indirect relationships through enzymes in the graph.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The subgraph resulting from applying HD sim (<xref ref-type="fig" rid="pone.0189012.g006">Fig 6</xref>) inherits the scale-free structure from the whole graph and enrols the three recurrently reported pathways in the same connected component: hsa00250, hsa00270 and hsa00480. The biological perturbation stemming from the MS-derived compounds can be tracked in terms of reactions, enzymes and modules, up to the relevant pathways.</p>
      <fig id="pone.0189012.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Subgraph reported through HD norm, the names of reactions and enzymes have been omitted for clarity.</title>
          <p>Compounds are green, reactions are blue, enzymes are orange, modules are purple and pathways are red. The compounds in the input are highlighted as green squares to ease the tracing of the biological perturbation up to the pathways. The presence of reactions and enzymes that link pathways in this subgraph might suggest relevant entities by which affected pathways crosstalk. All the reported pathways and modules lie in a large CC, as well as a newly proposed metabolite (L-Glutamate).</p>
        </caption>
        <graphic xlink:href="pone.0189012.g006"/>
      </fig>
      <p>On the other hand, results on the recovery of synthetic signals can be found in <xref ref-type="fig" rid="pone.0189012.g007">Fig 7</xref>. In (a) absence of signal, HD ranks pathways with a mean rank close to 0.5, and only a few are biased to the top or the bottom of the list. Mean ranks in Fisher’s exact test and PR are also centered around 0.5, but have more dispersion. In (b) the presence of a target pathway, three sampling schemes have been explored. In (1) the signal is actually noise and the target pathway is a decoy. The rank of the target pathway for HD and PR is uniformly spread in [0, 1], whereas Fisher’s exact test shows some asymmetry in the rank distribution. In (2), the sampling probability depends on the presence or absence of the metabolite in the pathway. Fisher’s exact test outperforms HD and PR as the median rank of the target pathway is closer to 0, as expected by its optimality. However, in (3), the sampling probability is network-based and HD outperforms PR, which in turn outperforms Fisher’s exact test. Differences between sim (Monte Carlo trials) and norm (parametric approach) are subtle.</p>
      <fig id="pone.0189012.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Synthetic signals evaluation using the pathway rank as a metric to assess orderings.</title>
          <p>Lowest ranks correspond to best ranked pathways. The proposed methodology is compared to ORA, represented by Fisher’s exact test. <bold>(a)</bold> 288 noisy signals have been generated, and every pathway has been ranked in each of the 288 runs. Data points for a given methodology are the mean rank of each pathway, giving 288 data points per box. <bold>(b)</bold> 288 signals with a target pathway have been generated, in three scenarios: pure noise, proportion-based sampling and network-based sampling. Each box contains the rank of the target pathway, leading to 288 data points per box.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g007"/>
      </fig>
    </sec>
    <sec id="sec015">
      <title>NMR analysis</title>
      <p>NMR carbon tracking revealed 13 isotopically enriched metabolites from <sup>13</sup>C-glucose, showing differential fractional enrichment between case-control, of which 5 had already been found through MS; some of these metabolites can be seen in <xref ref-type="fig" rid="pone.0189012.g008">Fig 8</xref> in the context of the Glutathione metabolism. Our solutions are assessed in terms of the resistance distance from the reported reactions to the remaining 8 metabolites. The smaller the overall distance of a solution, the more related its nodes are to the 8 metabolites proven affected by NMR. The resistance distances have been computed on the reaction-compound graph, which is the largest CC of the subgraph that contains all the reactions and compounds in the KEGG graph.</p>
      <fig id="pone.0189012.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>KEGG representation of the Glutathione metabolism (hsa00480).</title>
          <p>KEGG compounds found affected through MS (orange) and NMR (blue) are pinpointed in the figure. Additionally, enzymes and compounds reported by HD norm are depicted in red. Our approach provides a criterion for highlighting a pathway together with the entities it contains, for example its reported enzymes, to build a sub-pathway representation richer than the classical methods that rely solely on pathways and compounds. Reprinted from <ext-link ext-link-type="uri" xlink:href="http://www.genome.jp">www.genome.jp</ext-link> under a CC BY license, with permission from Kanehisha Laboratories, original copyright 2014.</p>
        </caption>
        <graphic xlink:href="pone.0189012.g008"/>
      </fig>
      <p>The reactions suggested in our subgraphs show lower resistance distances to the 8 NMR-derived metabolites than the totality of reactions in the reaction-compound graph (<xref ref-type="table" rid="pone.0189012.t004">Table 4</xref>). Furthermore, they are also lower than the resistance distances from the neighbouring reactions of the MS-derived metabolites to the 8 NMR metabolites (FDR &lt; 0.01).</p>
      <table-wrap id="pone.0189012.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189012.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Distance to NMR metabolites.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0189012.t004g" xlink:href="pone.0189012.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="right" rowspan="1" colspan="1">Graph order</th>
                <th align="right" rowspan="1" colspan="1">C00299</th>
                <th align="right" rowspan="1" colspan="1">C00122</th>
                <th align="right" rowspan="1" colspan="1">C00116</th>
                <th align="right" rowspan="1" colspan="1">C00105</th>
                <th align="right" rowspan="1" colspan="1">C00020</th>
                <th align="right" rowspan="1" colspan="1">C00581</th>
                <th align="right" rowspan="1" colspan="1">C00300</th>
                <th align="right" rowspan="1" colspan="1">C00025</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Reaction-compound graph</td>
                <td align="right" rowspan="1" colspan="1">4539[8008]</td>
                <td align="right" rowspan="1" colspan="1">0.56(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.56(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.57(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.54(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.47(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.93(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.82(0.62)</td>
                <td align="right" rowspan="1" colspan="1">0.47(0.62)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">First neighbours</td>
                <td align="right" rowspan="1" colspan="1">414[447]</td>
                <td align="right" rowspan="1" colspan="1">0.42(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.43(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.44(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.40(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.33(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.79(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.68(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.33(0.12)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HD norm</td>
                <td align="right" rowspan="1" colspan="1">147[250]</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.40(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.37(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.76(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.65(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.10)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HD sim</td>
                <td align="right" rowspan="1" colspan="1">148[261]</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.40(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.37(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.76(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.65(0.09)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.09)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PR norm</td>
                <td align="right" rowspan="1" colspan="1">143[250]</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.39(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.40(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.37(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.75(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.65(0.10)</td>
                <td align="right" rowspan="1" colspan="1">0.30(0.10)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PR sim</td>
                <td align="right" rowspan="1" colspan="1">172[279]</td>
                <td align="right" rowspan="1" colspan="1">0.40(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.41(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.42(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.38(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.31(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.77(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.66(0.12)</td>
                <td align="right" rowspan="1" colspan="1">0.31(0.12)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t004fn001">
            <p>Mean resistance distance between the reactions reported in our solutions and each compound reported using NMR, with their standard deviations in parentheses. For each subgraph of KEGG graph, the number of reactions and the total number of nodes (in square brackets) are displayed. The reaction-compound subgraph contains the largest connected component having all the reactions and compounds in the KEGG graph. The first neighbours subgraph contains the MS-derived metabolites and all the reactions in which they participate. Resistance distances are computed on the reaction-compound graph. For every NMR-derived metabolite, there is a significant difference in resistance distances between the reactions proposed in our solutions and the reactions involving any of the MS-derived metabolite (one-sided Wilcoxon test, FDR &lt; 0.01 for the 32 possible comparisons: 8 NMR metabolites, tests of 4 solutions against the first neighbours reactions). This implies that the reported reactions are closer to the NMR-derived compounds than the bulk of neighbouring reactions.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec016">
    <title>Discussion</title>
    <p>Our approach for enriching summary metabolomics data, <xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>, is based on diffusion processes over a graph drawn from several KEGG categories (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2</xref>). KEGG is the database of choice due to its level of curation and structure, which eases the graph representation. Specifically, the definition of KEGG categories naturally allows a hierarchical arrangement of levels. Our graph design is enhanced by the compound-reaction-enzyme-gene networks built by MetScape (<xref ref-type="supplementary-material" rid="pone.0189012.s004">S1 Appendix</xref>), and the inclusion of modules and pathways in our arrangement allows a comprehensive picture of the affected biology.</p>
    <p>The graph contains all the KEGG compounds and the subset of affected metabolites forced to diffuse inside it (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2</xref>). The closer a node is to the affected compounds, the higher its score becomes. Likewise, the top scoring candidates naturally involve higher flow and become relevant in the flow discharge from the graph. Because our KEGG graph is conceived and curated in a bottom-up manner, diffusion is expected to follow that trend too: the perturbation in the lowest level will diffuse to the upper levels to exit the graph. Ideally, a relevant subgraph found through this diffusion (<xref ref-type="fig" rid="pone.0189012.g006">Fig 6</xref>) would inherit the stratification of the KEGG graph, thus allowing the extrapolation of knowledge in terms of compounds to the rest of categories. This allows holistic picturing of pathways of interest, such as Glutathione metabolism (<xref ref-type="fig" rid="pone.0189012.g008">Fig 8</xref>) and importantly, it relates affected pathways through reactions, enzymes and compounds.</p>
    <p>The mathematical formulation of the heat diffusion stationary temperatures is equivalent to the scores in HotNet and TieDIE, with ad-hoc boundary conditions (<xref ref-type="fig" rid="pone.0189012.g002">Fig 2</xref>). Conversely, our settings for PageRank force upwards diffusion and allow exit from every node through the damping factor. Node selection for HotNet follows a combinatorial model, whereas TieDIE applies a unique threshold for all the scores, which in turn come from two diffusive processes. In our case, selection is achieved through a unique diffusion followed by a null model that normalises the scores. Comparing raw scores between nodes can lead to biases related to the node level and topology (<xref ref-type="fig" rid="pone.0189012.g004">Fig 4a and 4b</xref>), pathway nodes clearly being affected by their degree and, in addition, overshadowed by other compounds and reactions with higher mean null temperatures. Without further action, the temperatures of larger pathways are systematically warmer regardless of the input, thus biasing all the results and any biological interpretation. Instead, our concept of a high score for a given node relies on comparing its score to its null distribution, treating each node according to its own topological features (<xref ref-type="fig" rid="pone.0189012.g001">Fig 1</xref>).</p>
    <p>This is consistent with the pathway over-representation analysis, as the latter can be posed as a very simple diffusion problem that needs the null model to translate the observed statistics into p-values that are comparable across pathways (<xref ref-type="fig" rid="pone.0189012.g003">Fig 3</xref>). Ranking pathways by the number of hits and ignoring the null model would bias the results towards larger pathways, which is also what happens in our diffusion approach if raw temperatures are used (<xref ref-type="fig" rid="pone.0189012.g005">Fig 5a and 5b</xref>).</p>
    <p>Finally, we extract four subgraphs by considering the top <italic>k</italic> scores for HD norm, HD sim, PR norm and PR sim. Spurious highlighted nodes are expected to appear as isolated or having very small CCs, similar to random selection of nodes in a sparse graph, whereas strong biological perturbations yield larger CCs. Therefore, the large CCs reported in the four subgraphs (<xref ref-type="table" rid="pone.0189012.t001">Table 1</xref>) are natural goodness-of-solution indicators.</p>
    <p>Analysing the two statistical approaches, we suggest both deterministic parametric techniques and stochastic non-parametric ones. Computing a z-score is simple and fast, giving insights into how high a score is in terms of standard deviations from the mean value. On the other hand, Monte Carlo trials can show some variability between solutions, so an ensemble approach can address this, while providing confidence measures for each reported node. Conversely, several quantiles can be estimated and stored if the graph is unchanged for further analyses, which is reasonable for a given KEGG database release.</p>
    <p>Regarding time and memory complexity, the complete analysis of the database requires a one-off computation the inverse of the conductance matrix of the graph, which is feasible in our scenario and already pre-computed for our public package. The cost of the Monte Carlo trials is benchmarked in <xref ref-type="supplementary-material" rid="pone.0189012.s008">S5 Appendix</xref>. Comparing both random walk approaches, we observe a tendency to report larger CCs through heat diffusion (<xref ref-type="table" rid="pone.0189012.t001">Table 1</xref>), because it can propose new compounds in the solution that connect otherwise disjoint CCs. This is not the case for PageRank, as forcing the diffusion upwards excludes other compounds from being visited by the random walks. As expected, all the approaches tend to report the metabolites that were specified in the input, although the z-scores can be more restrictive when suggesting new compounds in heat diffusion, possibly due to their high variance. Despite the differences between scoring methods and statistical approximations, solutions show a consistency because of their high overlap (<xref ref-type="table" rid="pone.0189012.t002">Table 2</xref>). Furthermore, reporting subgraphs with a stratification similar to the KEGG graph (<xref ref-type="supplementary-material" rid="pone.0189012.s008">S5 Appendix</xref>) indicates perturbation traceability and allows inference on various KEGG categories by measuring only compounds.</p>
    <p>As a pathway enrichment method, our procedure shows results consistent with the state of the art. Artificial signals have been generated to discover biases in particular pathways and assess the goodness of the rankings produced by the methods. In (a) the absence of signal, the mean rank of a pathway is expected to be uniform on [0, 1] and have a mean value of 0.5. If the mean value is closer to 0, the pathway might be systematically favoured in any analysis and could become a recurrent false positive. HD shows small deviations from 0.5 in the mean rank of the 288 pathways in the KEGG graph while PR and Fisher’s exact test show more dispersion. This may be due to the discrete nature of Fisher’s exact test, which is partly inherited by PR as it only allows upwards propagation. In (b) the presence of signal, a target pathway generates the signal and is ranked in the prioritisation of each method. In the first sampling scheme, the target pathway is actually a decoy and is expected to be ranked uniformly on [0, 1]. This is the case for HD and PR, but Fisher’s exact test shows an asymmetrical distribution, probably a consequence of pathways tied at 0 hits. If the sampling strategy is affine to Fisher’s exact test alternative hypothesis, this test has an edge over HD and PR in terms of discovering the true positive. Conversely, if the sampling is network-based, HD and PR perform better, as the binary nature of Fisher’s exact test cannot account for metabolites close to, but not inside of, a target pathway. This sampling generates signals that are harder to recover because of the network topology: crosstalk effects are present and unspecific metabolites divide their contribution over all the pathways to which they belong. This implies that, focusing on the pathway ranking problem, the optimal choice between Fisher’s exact test and HR or PR depends on the network influence in the generative model of the data.</p>
    <p>An added value of our approach is in providing further details about the reported pathways, together with more specificity due to the presence of KEGG modules. Our results offer sub-pathway resolution and, unlike other sub-pathway focused tools, details at several molecular levels between the metabolites and the pathways. Entities like enzymes or metabolites that appear relevant and shared among pathways can give insights of pathway overlap and crosstalk that is specific to the condition under study. Our pathway hits are consistent with the current techniques, both using list format and abundance data (<xref ref-type="table" rid="pone.0189012.t003">Table 3</xref>). The same tendency is observed when benchmarking with IMPaLA and MetaboAnalyst example data, details in <xref ref-type="supplementary-material" rid="pone.0189012.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0189012.s003">S3</xref> Tables. However, the nature of our scores takes into account pathway overlap, which is not the case for IMPaLA (ORA) and MetaboAnalyst (ORA and MSEA).</p>
    <p>Our prior studies [<xref rid="pone.0189012.ref042" ref-type="bibr">42</xref>] suggest that the Glutathione metabolism (<xref ref-type="fig" rid="pone.0189012.g008">Fig 8</xref>) is of particular interest and it is consistently pinpointed by the enrichment methods. Its study is illustrative of the workings of our methodology: nodes surrounding the input metabolites support warmer temperatures and hence the proposed enzymes within the pathway are close to the MS-derived metabolites. The suggestion of these enzymes gives a richer view within the pathway and can help generate new biological hypotheses. This context also depicts L-glutamate, an extra metabolite suggested by the method, which is surrounded by MS-derived metabolites and also found through NMR.</p>
    <p>The lack of a gold standard procedure and a reference benchmark dataset with known biology for pathway enrichment [<xref rid="pone.0189012.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0189012.ref021" ref-type="bibr">21</xref>] encouraged the analysis of metabolic changes using isotopic labelling and NMR. The novelty of our tool includes the generation of a comprehensive subgraph that contains more than pathways and compounds—consequently we also partially validate the reactions that appear in the subgraph. The definition of performance is not straightforward, given the lack of means to prove that a node (compound, reaction) is not affected, so the usual quality measures (false positives, true negatives) are not applicable. Results show that our reported reactions have lower resistance distances to the 8 metabolites found by NMR than all the reactions involving any of the MS-derived metabolites (<xref ref-type="table" rid="pone.0189012.t004">Table 4</xref>). The choice of resistance distance as a validation metric is motivated by the presence of hubs in the metabolic network that affect the usual shortest paths metrics, meaning that connections through very specific metabolic reactions are masked by very general reactions involving hubs like adenosine triphosphate (ATP). As resistance distance takes into account the whole graph structure, and specifically the presence of multiple shortest paths, it is more informative than shortest paths distance.</p>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Conclusions</title>
    <p>We propose a secondary analysis methodology for summary metabolomics data that combines pathway enrichment and sub-network analysis. Instead of reporting a list of pathways, we build meaningful sub-pathway representations of the biology at several molecular levels, derived through a null diffusive process on a curated graph object built from the KEGG database. This approach accounts for pathway over-representation, topology and crosstalk. Nodes reported as relevant are drawn in a comprehensive heterogeneous network that contains not only pathways and compounds, but also enzymes, reactions and KEGG modules. This richer biological context adds value to the top pathway hits by suggesting possible paths through which affected compounds translate into dysregulated pathways.</p>
    <p>The proposed methodology has been tested and assessed in a case-control study, where the suggested pathways are consistent with alternative pathway enrichment techniques and the reported reactions have been partially validated through NMR-based tracking of glucose carbon. Our analysis suggests that the Glutathione metabolism is one of the most affected pathways. Glutathione is critical for the suppression of reactive oxygen species and this result is consistent with our preliminary observations that these cells exhibit higher levels of mitochondrial reactive oxygen species. Tests on simulated data suggest that our methodology can benefit from pathway signals whose generative model is network-based. These results support the potential of our novel methods for aiding in the interpretation of complex metabolomics datasets.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec018">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0189012.s001">
      <label>S1 Table</label>
      <caption>
        <title>Experimental data results.</title>
        <p>Reported subgraphs and pathway analysis using IMPaLA and MetaboAnalyst on the experimental dataset.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0189012.s001.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s002">
      <label>S2 Table</label>
      <caption>
        <title>IMPaLA example data.</title>
        <p>Reported pathways for the IMPaLA example data using top 250 z-scores in heat diffusion, IMPaLA and MetaboAnalyst.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0189012.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s003">
      <label>S3 Table</label>
      <caption>
        <title>MetaboAnalyst example data.</title>
        <p>Reported pathways for the MetaboAnalyst example data using top 250 z-scores in heat diffusion, IMPaLA and MetaboAnalyst.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0189012.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s004">
      <label>S1 Appendix</label>
      <caption>
        <title>Graph structure and curation.</title>
        <p>Details on how to generate and curate the KEGG graph.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0189012.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s005">
      <label>S2 Appendix</label>
      <caption>
        <title>Heat diffusion process.</title>
        <p>Formulation of the heat diffusion scoring method.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0189012.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s006">
      <label>S3 Appendix</label>
      <caption>
        <title>PageRank.</title>
        <p>Formulation of the PageRank web ranking algorithm.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0189012.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s007">
      <label>S4 Appendix</label>
      <caption>
        <title>Null models.</title>
        <p>Definition of the null models and visualisation of the pathway correlation matrix.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0189012.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0189012.s008">
      <label>S5 Appendix</label>
      <caption>
        <title>Details on reported solutions.</title>
        <p>Solution stratification, CC evolution, computational cost of Monte Carlo permutations and damping factor influence.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0189012.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by the Spanish Ministry of Economy and Competitiveness (<ext-link ext-link-type="uri" xlink:href="http://www.mineco.gob.es">www.mineco.gob.es</ext-link>) [BFU2012-39521 and BFU2015-68354 to T.S., TEC2014-60337-R to A.P., SAF2011-30578 and BFU2014-57466 to O.Y.].</p>
    <p>O.Y., A.P. and S.P. thank for funding the Spanish Biomedical Research Centre in Diabetes and Associated Metabolic Disorders (CIBERDEM) and the Networking Biomedical Research Centre in the subject area of Bioengineering, Biomaterials and Nanomedicine (CIBER-BBN), both initiatives of Instituto de Investigación Carlos III (ISCIII). S.A. was supported by a Finnish Cultural Society Fellowship. S.P. thanks the AGAUR FI-scholarship programme. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    <p>Takeda Cambridge Ltd provided support in the form of salaries for authors [FF], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the “author contributions” section.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0189012.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Nicholson</surname><given-names>JK</given-names></name>, <name><surname>Connelly</surname><given-names>J</given-names></name>, <name><surname>Lindon</surname><given-names>JC</given-names></name>, <name><surname>Holmes</surname><given-names>E</given-names></name>. <article-title>Metabonomics: a platform for studying drug toxicity and gene function</article-title>. <source>Nat Rev Drug Discov</source>. <year>2002</year>;<volume>1</volume>(<issue>2</issue>):<fpage>153</fpage>–<lpage>161</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrd728">10.1038/nrd728</ext-link></comment><?supplied-pmid 12120097?><pub-id pub-id-type="pmid">12120097</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Chagoyen</surname><given-names>M</given-names></name>, <name><surname>Pazos</surname><given-names>F</given-names></name>. <article-title>Tools for the functional interpretation of metabolomic experiments</article-title>. <source>Brief Bioinform</source>. <year>2013</year>;<volume>14</volume>(<issue>6</issue>):<fpage>737</fpage>–<lpage>744</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bib/bbs055">10.1093/bib/bbs055</ext-link></comment><?supplied-pmid 23063930?><pub-id pub-id-type="pmid">23063930</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Weckwerth</surname><given-names>W</given-names></name>. <article-title>Metabolomics in Systems Biology</article-title>. <source>Annu Rev Plant Biol</source>. <year>2003</year>;<volume>54</volume>(<issue>1</issue>):<fpage>669</fpage>–<lpage>689</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.arplant.54.031902.135014">10.1146/annurev.arplant.54.031902.135014</ext-link></comment><?supplied-pmid 14503007?><pub-id pub-id-type="pmid">14503007</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Kessler</surname><given-names>N</given-names></name>, <name><surname>Neuweger</surname><given-names>H</given-names></name>, <name><surname>Bonte</surname><given-names>A</given-names></name>, <name><surname>Langenkämper</surname><given-names>G</given-names></name>, <name><surname>Niehaus</surname><given-names>K</given-names></name>, <name><surname>Nattkemper</surname><given-names>TW</given-names></name>, <etal>et al</etal><article-title>MeltDB 2.0-advances of the metabolomics software system</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>19</issue>):<fpage>2452</fpage>–<lpage>2459</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt414">10.1093/bioinformatics/btt414</ext-link></comment><?supplied-pmid 23918246?><pub-id pub-id-type="pmid">23918246</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>J</given-names></name>, <name><surname>Sinelnikov</surname><given-names>IV</given-names></name>, <name><surname>Han</surname><given-names>B</given-names></name>, <name><surname>Wishart</surname><given-names>DS</given-names></name>. <article-title>MetaboAnalyst 3.0—making metabolomics more meaningful</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>Web Server issue</issue>):<fpage>W251</fpage>–<lpage>W257</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv380">10.1093/nar/gkv380</ext-link></comment><?supplied-pmid 25897128?><pub-id pub-id-type="pmid">25897128</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Fernández-Albert</surname><given-names>F</given-names></name>, <name><surname>Llorach</surname><given-names>R</given-names></name>, <name><surname>Andrés-Lacueva</surname><given-names>C</given-names></name>, <name><surname>Perera</surname><given-names>A</given-names></name>. <article-title>An R package to analyse LC/MS metabolomic data: MAIT (Metabolite Automatic Identification Toolkit)</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>13</issue>):<fpage>1937</fpage>–<lpage>1939</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btu136">10.1093/bioinformatics/btu136</ext-link></comment><?supplied-pmid 24642061?><pub-id pub-id-type="pmid">24642061</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Vinaixa</surname><given-names>M</given-names></name>, <name><surname>Schymanski</surname><given-names>EL</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>, <name><surname>Navarro</surname><given-names>M</given-names></name>, <name><surname>Salek</surname><given-names>RM</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>. <article-title>Mass spectral databases for LC/MS and GC/MS-based metabolomics: state of the field and future prospects</article-title>. <source>TrAC-Trend Anal Chem</source>. <year>2015</year>;<volume>78</volume>:<fpage>23</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.trac.2015.09.005">10.1016/j.trac.2015.09.005</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Wishart</surname><given-names>DS</given-names></name>, <name><surname>Jewison</surname><given-names>T</given-names></name>, <name><surname>Guo</surname><given-names>A</given-names></name>, <name><surname>Wilson</surname><given-names>M</given-names></name>, <name><surname>Knox</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>HMDB 3.0—The Human Metabolome Database in 2013</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>Database issue</issue>):<fpage>D801</fpage>–<lpage>D807</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gks1065">10.1093/nar/gks1065</ext-link></comment><?supplied-pmid 23161693?><pub-id pub-id-type="pmid">23161693</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Araki</surname><given-names>M</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <name><surname>Hattori</surname><given-names>M</given-names></name>, <name><surname>Hirakawa</surname><given-names>M</given-names></name>, <name><surname>Itoh</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>KEGG for linking genomes to life and the environment</article-title>. <source>Nucleic Acids Res</source>. <year>2008</year>;<volume>36</volume>(<issue>Database issue</issue>):<fpage>D480</fpage>–<lpage>D484</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkm882">10.1093/nar/gkm882</ext-link></comment><?supplied-pmid 18077471?><pub-id pub-id-type="pmid">18077471</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Croft</surname><given-names>D</given-names></name>, <name><surname>Mundo</surname><given-names>AF</given-names></name>, <name><surname>Haw</surname><given-names>R</given-names></name>, <name><surname>Milacic</surname><given-names>M</given-names></name>, <name><surname>Weiser</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>The Reactome pathway knowledgebase</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(<issue>Database issue</issue>):<fpage>D472</fpage>–<lpage>D477</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt1102">10.1093/nar/gkt1102</ext-link></comment><?supplied-pmid 24243840?><pub-id pub-id-type="pmid">24243840</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Kelder</surname><given-names>T</given-names></name>, <name><surname>van Iersel</surname><given-names>MP</given-names></name>, <name><surname>Hanspers</surname><given-names>K</given-names></name>, <name><surname>Kutmon</surname><given-names>M</given-names></name>, <name><surname>Conklin</surname><given-names>BR</given-names></name>, <name><surname>Evelo</surname><given-names>CT</given-names></name>, <etal>et al</etal><article-title>WikiPathways: building research communities on biological pathways</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>(<issue>Database issue</issue>):<fpage>D1301</fpage>–<lpage>D1307</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkr1074">10.1093/nar/gkr1074</ext-link></comment><?supplied-pmid 22096230?><pub-id pub-id-type="pmid">22096230</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Smoot</surname><given-names>ME</given-names></name>, <name><surname>Ono</surname><given-names>K</given-names></name>, <name><surname>Ruscheinski</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>PL</given-names></name>, <name><surname>Ideker</surname><given-names>T</given-names></name>. <article-title>Cytoscape 2.8: new features for data integration and network visualization</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>3</issue>):<fpage>431</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq675">10.1093/bioinformatics/btq675</ext-link></comment><?supplied-pmid 21149340?><pub-id pub-id-type="pmid">21149340</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Karnovsky</surname><given-names>A</given-names></name>, <name><surname>Weymouth</surname><given-names>TE</given-names></name>, <name><surname>Hull</surname><given-names>T</given-names></name>, <name><surname>Tarcea</surname><given-names>VG</given-names></name>, <name><surname>Scardoni</surname><given-names>G</given-names></name>, <name><surname>Laudanna</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Metscape 2 bioinformatics tool for the analysis and visualization of metabolomics and gene expression data</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>3</issue>):<fpage>373</fpage>–<lpage>380</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr661">10.1093/bioinformatics/btr661</ext-link></comment><?supplied-pmid 22135418?><pub-id pub-id-type="pmid">22135418</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Sirota</surname><given-names>M</given-names></name>, <name><surname>Butte</surname><given-names>AJ</given-names></name>. <article-title>Ten Years of Pathway Analysis: Current Approaches and Outstanding Challenges</article-title>. <source>PLOS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002375">10.1371/journal.pcbi.1002375</ext-link></comment><?supplied-pmid 22383865?><pub-id pub-id-type="pmid">22383865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kamburov</surname><given-names>A</given-names></name>, <name><surname>Cavill</surname><given-names>R</given-names></name>, <name><surname>Ebbels</surname><given-names>TMD</given-names></name>, <name><surname>Herwig</surname><given-names>R</given-names></name>, <name><surname>Keun</surname><given-names>HC</given-names></name>. <article-title>Integrated pathway-level analysis of transcriptomics and metabolomics data with IMPaLA</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>20</issue>):<fpage>2917</fpage>–<lpage>2918</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr499">10.1093/bioinformatics/btr499</ext-link></comment><?supplied-pmid 21893519?><pub-id pub-id-type="pmid">21893519</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Chagoyen</surname><given-names>M</given-names></name>, <name><surname>Pazos</surname><given-names>F</given-names></name>. <article-title>MBRole: enrichment analysis of metabolomic data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>5</issue>):<fpage>730</fpage>–<lpage>731</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr001">10.1093/bioinformatics/btr001</ext-link></comment><?supplied-pmid 21208985?><pub-id pub-id-type="pmid">21208985</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kankainen</surname><given-names>M</given-names></name>, <name><surname>Gopalacharyulu</surname><given-names>P</given-names></name>, <name><surname>Holm</surname><given-names>L</given-names></name>, <name><surname>Orešič</surname><given-names>M</given-names></name>. <article-title>MPEA—metabolite pathway enrichment analysis</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>13</issue>):<fpage>1878</fpage>–<lpage>1879</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr278">10.1093/bioinformatics/btr278</ext-link></comment><?supplied-pmid 21551139?><pub-id pub-id-type="pmid">21551139</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Mootha</surname><given-names>VK</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Ebert</surname><given-names>BL</given-names></name>, <name><surname>Gillette</surname><given-names>MA</given-names></name>, <etal>et al</etal><article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>15550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0506580102">10.1073/pnas.0506580102</ext-link></comment><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Alonso</surname><given-names>A</given-names></name>, <name><surname>Marsal</surname><given-names>S</given-names></name>, <name><surname>Julià</surname><given-names>A</given-names></name>. <article-title>Analytical methods in untargeted metabolomics: state of the art in 2015</article-title>. <source>Front Bioeng Biotechnol</source>. <year>2015</year>;<volume>3</volume>(<issue>23</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fbioe.2015.00023">10.3389/fbioe.2015.00023</ext-link></comment><?supplied-pmid 25798438?><pub-id pub-id-type="pmid">25798438</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>J</given-names></name>, <name><surname>Wishart</surname><given-names>DS</given-names></name>. <article-title>MSEA: a web-based tool to identify biologically meaningful patterns in quantitative metabolomic data</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>(<issue>Web Server issue</issue>):<fpage>W71</fpage>–<lpage>W77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkq329">10.1093/nar/gkq329</ext-link></comment><?supplied-pmid 20457745?><pub-id pub-id-type="pmid">20457745</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>DW</given-names></name>, <name><surname>Sherman</surname><given-names>BT</given-names></name>, <name><surname>Lempicki</surname><given-names>RA</given-names></name>. <article-title>Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkn923">10.1093/nar/gkn923</ext-link></comment><pub-id pub-id-type="pmid">19033363</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Domingues</surname><given-names>FS</given-names></name>, <name><surname>Maydt</surname><given-names>J</given-names></name>, <name><surname>Lengauer</surname><given-names>T</given-names></name>. <article-title>Calculating the statistical significance of changes in pathway activity from gene expression data</article-title>. <source>Stat Appl Genet Mol</source>. <year>2004</year>;<volume>3</volume>(<issue>1</issue>).</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Draghici</surname><given-names>S</given-names></name>, <name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Tarca</surname><given-names>AL</given-names></name>, <name><surname>Amin</surname><given-names>K</given-names></name>, <name><surname>Done</surname><given-names>A</given-names></name>, <name><surname>Voichita</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A systems biology approach for pathway level analysis</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>(<issue>10</issue>):<fpage>1537</fpage>–<lpage>1545</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.6202607">10.1101/gr.6202607</ext-link></comment><?supplied-pmid 17785539?><pub-id pub-id-type="pmid">17785539</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Donato</surname><given-names>M</given-names></name>, <name><surname>Xu</surname><given-names>Z</given-names></name>, <name><surname>Tomoiaga</surname><given-names>A</given-names></name>, <name><surname>Granneman</surname><given-names>JG</given-names></name>, <name><surname>MacKenzie</surname><given-names>RG</given-names></name>, <name><surname>Bao</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Analysis and correction of crosstalk effects in pathway analysis</article-title>. <source>Genome Res</source>. <year>2013</year>;<volume>23</volume>(<issue>11</issue>):<fpage>1885</fpage>–<lpage>1893</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.153551.112">10.1101/gr.153551.112</ext-link></comment><?supplied-pmid 23934932?><pub-id pub-id-type="pmid">23934932</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Tarca</surname><given-names>AL</given-names></name>, <name><surname>Draghici</surname><given-names>S</given-names></name>, <name><surname>Bhatti</surname><given-names>G</given-names></name>, <name><surname>Romero</surname><given-names>R</given-names></name>. <article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinform</source>. <year>2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>136</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-13-136">10.1186/1471-2105-13-136</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Mitra</surname><given-names>K</given-names></name>, <name><surname>Carvunis</surname><given-names>AR</given-names></name>, <name><surname>Ramesh</surname><given-names>SK</given-names></name>, <name><surname>Ideker</surname><given-names>T</given-names></name>. <article-title>Integrative approaches for finding modular structure in biological networks</article-title>. <source>Nat Rev Genet</source>. <year>2013</year>;<volume>14</volume>(<issue>10</issue>):<fpage>719</fpage>–<lpage>732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3552">10.1038/nrg3552</ext-link></comment><?supplied-pmid 24045689?><pub-id pub-id-type="pmid">24045689</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Haynes</surname><given-names>WA</given-names></name>, <name><surname>Higdon</surname><given-names>R</given-names></name>, <name><surname>Stanberry</surname><given-names>L</given-names></name>, <name><surname>Collins</surname><given-names>D</given-names></name>, <name><surname>Kolker</surname><given-names>E</given-names></name>. <article-title>Differential expression analysis for pathways</article-title>. <source>PLOS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e1002967</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002967">10.1371/journal.pcbi.1002967</ext-link></comment><?supplied-pmid 23516350?><pub-id pub-id-type="pmid">23516350</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Shen</surname><given-names>L</given-names></name>, <name><surname>Shang</surname><given-names>X</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>. <article-title>Subpathway analysis based on signaling-pathway impact analysis of signaling pathway</article-title>. <source>PLOS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e0132813</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0132813">10.1371/journal.pone.0132813</ext-link></comment><?supplied-pmid 26207919?><pub-id pub-id-type="pmid">26207919</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Ideker</surname><given-names>T</given-names></name>, <name><surname>Ozier</surname><given-names>O</given-names></name>, <name><surname>Schwikowski</surname><given-names>B</given-names></name>, <name><surname>Siegel</surname><given-names>AF</given-names></name>. <article-title>Discovering regulatory and signalling circuits in molecular interaction networks</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>suppl 1</issue>):<fpage>S233</fpage>–<lpage>S240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/18.suppl_1.S233">10.1093/bioinformatics/18.suppl_1.S233</ext-link></comment><?supplied-pmid 12169552?><pub-id pub-id-type="pmid">12169552</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref030">
      <label>30</label>
      <mixed-citation publication-type="book"><name><surname>Page</surname><given-names>L</given-names></name>, <name><surname>Brin</surname><given-names>S</given-names></name>, <name><surname>Motwani</surname><given-names>R</given-names></name>, <name><surname>Winograd</surname><given-names>T</given-names></name>. <source>The PageRank citation ranking: bringing order to the Web</source>. <publisher-name>Stanford InfoLab</publisher-name>; <year>1999</year>.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Vandin</surname><given-names>F</given-names></name>, <name><surname>Upfal</surname><given-names>E</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>. <article-title>Algorithms for detecting significantly mutated pathways in cancer</article-title>. <source>J Comput Biol</source>. <year>2011</year>;<volume>18</volume>(<issue>3</issue>):<fpage>507</fpage>–<lpage>522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2010.0265">10.1089/cmb.2010.0265</ext-link></comment><?supplied-pmid 21385051?><pub-id pub-id-type="pmid">21385051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Paull</surname><given-names>EO</given-names></name>, <name><surname>Carlin</surname><given-names>DE</given-names></name>, <name><surname>Niepel</surname><given-names>M</given-names></name>, <name><surname>Sorger</surname><given-names>PK</given-names></name>, <name><surname>Haussler</surname><given-names>D</given-names></name>, <name><surname>Stuart</surname><given-names>JM</given-names></name>. <article-title>Discovering causal pathways linking genomic events to transcriptional states using Tied Diffusion Through Interacting Events (TieDIE)</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>21</issue>):<fpage>2757</fpage>–<lpage>2764</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt471">10.1093/bioinformatics/btt471</ext-link></comment><?supplied-pmid 23986566?><pub-id pub-id-type="pmid">23986566</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Faust</surname><given-names>K</given-names></name>, <name><surname>Dupont</surname><given-names>P</given-names></name>, <name><surname>Callut</surname><given-names>J</given-names></name>, <name><surname>van Helden</surname><given-names>J</given-names></name>. <article-title>Pathway discovery in metabolic networks by subgraph extraction</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>9</issue>):<fpage>1211</fpage>–<lpage>1218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq105">10.1093/bioinformatics/btq105</ext-link></comment><?supplied-pmid 20228128?><pub-id pub-id-type="pmid">20228128</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref035">
      <label>35</label>
      <mixed-citation publication-type="other">Csardi G, Nepusz T. The igraph software package for complex network research. InterJournal. 2006;Complex Systems:1695.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref036">
      <label>36</label>
      <mixed-citation publication-type="other">Reddy JN, Gartling DK. The finite element method in heat transfer and fluid dynamics; 2010.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Bonals LA. Transferència de calor: apunts de classe; 2005.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>North</surname><given-names>BV</given-names></name>, <name><surname>Curtis</surname><given-names>D</given-names></name>, <name><surname>Sham</surname><given-names>PC</given-names></name>. <article-title>A note on the calculation of empirical P values from Monte Carlo procedures</article-title>. <source>Am J Hum Genet</source>. <year>2002</year>;<volume>71</volume>(<issue>2</issue>):<fpage>439</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1086/341527">10.1086/341527</ext-link></comment><?supplied-pmid 12111669?><pub-id pub-id-type="pmid">12111669</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Bapat</surname><given-names>R</given-names></name>. <article-title>Resistance matrix of a weighted graph</article-title>. <source>MATCH-COMMUN MATH CO</source>. <year>2004</year>;<volume>50</volume>:<fpage>73</fpage>–<lpage>82</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>DeBerardinis</surname><given-names>RJ</given-names></name>, <name><surname>Mancuso</surname><given-names>A</given-names></name>, <name><surname>Daikhin</surname><given-names>E</given-names></name>, <name><surname>Nissim</surname><given-names>I</given-names></name>, <name><surname>Yudkoff</surname><given-names>M</given-names></name>, <name><surname>Wehrli</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Beyond aerobic glycolysis: transformed cells can engage in glutamine metabolism that exceeds the requirement for protein and nucleotide synthesis</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2007</year>;<volume>104</volume>(<issue>49</issue>):<fpage>19345</fpage>–<lpage>19350</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0709747104">10.1073/pnas.0709747104</ext-link></comment><?supplied-pmid 18032601?><pub-id pub-id-type="pmid">18032601</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189012.ref041">
      <label>41</label>
      <mixed-citation publication-type="book"><name><surname>Wickham</surname><given-names>H</given-names></name>. <source>ggplot2: Elegant Graphics for Data Analysis</source>. <publisher-name>Springer-Verlag</publisher-name><publisher-loc>New York</publisher-loc>; <year>2009</year> Available from: <ext-link ext-link-type="uri" xlink:href="http://ggplot2.org">http://ggplot2.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0189012.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Aivio SM, Stracker TH. The Role of EXD2 in the maintenance of mithocondrial homeostasis [Doctoral Thesis]. Universitat Pompeu Fabra. Departament de Ciències Experimentals i de la Salut; 2014.</mixed-citation>
    </ref>
  </ref-list>
</back>
