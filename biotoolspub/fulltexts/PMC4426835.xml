<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4426835</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu864</article-id>
    <article-id pub-id-type="publisher-id">btu864</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Functional Gene Networks: R/Bioc package to generate and analyse gene networks derived from functional enrichment and clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Aibar</surname>
          <given-names>Sara</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontanillo</surname>
          <given-names>Celia</given-names>
        </name>
        <xref ref-type="author-notes" rid="btu864-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Droste</surname>
          <given-names>Conrad</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Las Rivas</surname>
          <given-names>Javier</given-names>
        </name>
        <xref ref-type="corresp" rid="btu864-COR1">*</xref>
      </contrib>
      <aff>Bioinformatics and Functional Genomics Research Group, Cancer Research Center (Consejo Superior de Investigaciones Científicas, Universidad de Salamanca and Instituto de Investigación Biomédica de Salamanca, CSIC/USAL/IBSAL), Salamanca, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu864-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btu864-FN2">
        <p><sup>†</sup>Present address: Celgene Institute for Translational Research Europe (CITRE), Sevilla, Spain</p>
      </fn>
      <fn id="btu864-FN1">
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>10</issue>
    <fpage>1686</fpage>
    <lpage>1688</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Functional Gene Networks (<italic>FGNet</italic>) is an R/Bioconductor package that generates gene networks derived from the results of functional enrichment analysis (FEA) and annotation clustering. The sets of genes enriched with specific biological terms (obtained from a FEA platform) are transformed into a network by establishing links between genes based on common functional annotations and common clusters. The network provides a new view of FEA results revealing gene modules with similar functions and genes that are related to multiple functions. In addition to building the functional network, <italic>FGNet</italic> analyses the similarity between the groups of genes and provides a distance heatmap and a bipartite network of functionally overlapping genes. The application includes an interface to directly perform FEA queries using different external tools: <italic>DAVID</italic>, <italic>GeneTerm Linker</italic>, <italic>TopGO</italic> or <italic>GAGE</italic>; and a graphical interface to facilitate the use.</p>
      <p><bold>Availability and implementation:</bold><italic>FGNet</italic> is available in Bioconductor, including a tutorial. URL: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/FGNet.html">http://bioconductor.org/packages/release/bioc/html/FGNet.html</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>jrivas@usal.es</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu864/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Due to the increasing number of omic studies, efficient functional analysis of large lists of genes or proteins is essential to understand the biological processes in which they are involved. Functional enrichment analysis (FEA) is the most popular bioinformatic methodology to obtain significant functional information from sets of cooperating genes. FEA methods search in biological databases (such as Gene Ontology and KEGG pathways, among others) and use statistical testing to find biological terms and functional annotations that are significantly enriched in a list of genes. However, in most cases the results of these analyses are very long lists of biological terms associated to genes that are difficult to digest and interpret. Some tools cluster the FEA results, like <italic>DAVID-FAC</italic> (<xref rid="btu864-B2" ref-type="bibr">Huang <italic>et al.</italic>, 2009</xref>) and <italic>GeneTerm Linker</italic> (<xref rid="btu864-B1" ref-type="bibr">Fontanillo <italic>et al.</italic>, 2011</xref>), but their output is provided as large tables and there are not many tools to integrate and visualize these results. Here we present Functional Gene Networks (<italic>FGNet</italic>), an R/Bioconductor package that uses FEA results to perform network-based analyses and visualization. The main network is built by establishing links between genes annotated to similar functional terms. In this way, <italic>FGNet</italic> generates and provides a network representing the links and associations between the clusters of genes and enriched terms. The network summarizes and facilitates the interpretation of the biological processes significantly enriched in the initial list of genes, revealing important information such as: distance and overlap between clusters, identification of modules and hubs. The tool can also help to disclose new associations among genes cooperating in hidden biological processes not annotated yet, which can be revealed by the topology of the functional network.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Input: functional enrichment and clustering</title>
      <p><italic>FGNet</italic> builds functional networks based on the groups obtained from clustering <italic>gene-term sets</italic> (<italic>gtsets</italic>, genes and terms associated by an enrichment p-value) returned by a FEA. The package includes an interface to do queries with gene lists using four FEA tools: <italic>DAVID</italic> with <italic>Functional Annotation Clustering</italic> (that returns clustered <italic>gtsets</italic>, Cl); <italic>GAGE</italic> (that also provides clusters) (<xref rid="btu864-B4" ref-type="bibr">Luo <italic>et al</italic>., 2009</xref>); <italic>GeneCodis</italic> with <italic>GeneTerm Linker</italic> (that returns metagroups, Mg) and <italic>TopGO</italic> (that only returns <italic>gtsets</italic>) (<xref rid="btu864-B3" ref-type="bibr">Alexa <italic>et al</italic>., 2010</xref>). The package can be also applied to the results from other EA tools, as long as the input results are transformed into tables of genes and associated terms.</p>
    </sec>
    <sec>
      <title>2.2 Construction of the functional network</title>
      <p>The functional network is built based on the analysis of all the <italic>gtsets</italic> provided by the FEA tool. These sets allow to generate a boolean matrix <italic>M</italic> of <italic>genes</italic> by <italic>gtsets</italic>, in which each element <inline-formula><mml:math id="MM1"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if gene <italic>g</italic> is in set <italic>s</italic>. This membership matrix is then transformed into an adjacency matrix <italic>A n</italic> × <italic>n</italic>; being <italic>n</italic> the total number of genes and <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the number of <italic>gtsets s</italic> in which a gene-pair is included: <inline-formula><mml:math id="MM3"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, where <italic>δ</italic> is a <italic>Kronecker</italic> delta (<inline-formula><mml:math id="MM4"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <italic>i </italic>= <italic>j</italic>, <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="MM6"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>). This adjacency matrix is used to generate the functional network by establishing a weighted link between each pair of genes (<italic>g<sub>i</sub></italic>, <italic>g<sub>j</sub></italic>) in which <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Finally, the clustering of <italic>gtsets</italic> provided by the FEA tool is used to generate a second genes’ adjacency matrix with the number of common clusters/metagroups (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>A), that is used to define and allocate gene groups. The network produced is provided as an <italic>igraph</italic> object for further analysis, and can be exported to other network-based tools like <italic>Cytoscape</italic>.
<fig id="btu864-F1" position="float"><label>Fig. 1.</label><caption><p>Schematic workflow. A query gene list is analysed through a FEA tool and the generated <italic>gene-term sets</italic> are used to build: (<bold>A</bold>) gene’s adjacency matrices; (<bold>B</bold>) a functional network (general view); (<bold>C</bold>) a distance heatmap and (<bold>D</bold>) an intersection network (to highlight multifunctional genes)</p></caption><graphic xlink:href="btu864f1p"/></fig>
</p>
    </sec>
    <sec>
      <title>2.3 Visualization and plots of the functional network</title>
      <p>The main plot of the network presents the functionally associated genes (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>B). Edges link the genes that are in the same <italic>g</italic><italic>t</italic><italic>sets</italic>. Nodes within the same Cl/Mg are placed together using a force-directed <italic>Fruchterman</italic><italic>–</italic><italic>Reingold</italic> layout, within a common background colour. Genes in only one Cl/Mg are plotted with the colour of such group, while genes that are included in more than one Cl/Mg are left white.</p>
    </sec>
    <sec>
      <title>2.4 Analysis of functional modules in the network</title>
      <p>To facilitate the analysis and quantification of the modules and the overlap between groups, <italic>FGNet</italic> also provides a distance matrix and a heatmap (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>C), plus an intersection network (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>D). The distance matrix is calculated based on the pairwise binary distance in the adjacency matrix of common Cls/Mgs. These distances are analysed by hierarchical average linkage and plotted as a heatmap that reveals the proximity and similarity between the groups of genes (Cls/Mgs). The intersection network is a bipartite network which includes only the genes associated to several Cls/Mgs (white nodes in <xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>B,D), showing their connectivity to such Cls/Mgs. This intersection network facilitates the identification of <italic>multifunctional</italic> genes. (For more details see <italic>FGNet</italic> documentation in Bioconductor).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Example of use</title>
    <p>We applied the method to several datasets and confirmed that the functional network greatly facilitates the analysis of enrichment results. <xref ref-type="fig" rid="btu864-F1">Figure 1</xref> shows the results of <italic>FGNet</italic> for a list of 175 genes differentially expressed in human samples of entorhinal cortex neurons from Alzheimer’s disease (AD) patients (obtained from Gene Expression Omnibus database, GEO: dataset GSE4757). Performing a FEA through <italic>GeneTerm Linker</italic>, we obtained six metagroups that we labelled according to their main annotations: (Mg1) cell adhesion; (Mg2) voltage-gated ion/potassium channels; (Mg3) axon and cell projection; (Mg4) dendrite and neuronal cell body; (Mg5) synaptic neuroactive ligand-receptor interaction and (Mg6) MAPK signaling and Alzheimer. The network of these six Mgs (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>B) provides a global overview of the functionally overlapping genes and allows to identify hub genes that interconnect groups. For example, CNTNAP1 and NLGN4X appear as hubs in Mg1. CNTNAP1 (that regulates distribution of K+ channels) links Mg1 and 2; and NLGN4X (that facilitates synaptic neurotransmission) links Mg1 with 4 and 5. NLGN4X is the gene with highest betweenness centrality in this network. Another important hub is APOE, recently associated to Alzheimer. The distance matrix (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>C) allows to quantify the similarity between gene groups, showing that the closest Mgs are 3, 4 and 6, sharing eight nodes. This is also presented in the intersection network (<xref ref-type="fig" rid="btu864-F1">Fig. 1</xref>D). Finally, the functional network can reveal further information about some Mgs. For example, if a Mg shares many genes with several other Mgs, it will indicate that such Mg brings the most common features that define the studied biological state. This is the case for Mg6, which, in fact, is annotated to Alzheimer's Disease.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the “Accion Estrategica en Salud” (AES) of the “Instituto de Salud Carlos III” (ISCiii) from the Spanish Government (projects granted to J.D.L.R.: PS09/00843 and PI12/00624); and by the “Consejeria de Educación” of the “Junta Castilla y Leon” (JCyL) and the European Social Fund (ESF) with grants given to S.A. and C.D.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_10_1686__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu864_FGNet_R_vignette.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btu864-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexa</surname><given-names>A.</given-names></name><name><surname>Rahnenfuhrer</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>). <article-title>topGO: Enrichment analysis for Gene Ontology</article-title>. <comment>R package version 2.18.0</comment>.</mixed-citation>
    </ref>
    <ref id="btu864-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fontanillo</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Functional analysis beyond enrichment: non-redundant reciprocal linkage of genes and biological terms</article-title>. <source>PLoS One</source><italic>,</italic>
<volume>6</volume>, <fpage>e24289</fpage>.<pub-id pub-id-type="pmid">21949701</pub-id></mixed-citation>
    </ref>
    <ref id="btu864-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Systematic and integrative analysis of large gene lists using DAVID Bioinformatics Resources</article-title>. <source>Nat. Protoc.</source><italic>,</italic>
<volume>4</volume>, <fpage>44</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">19131956</pub-id></mixed-citation>
    </ref>
    <ref id="btu864-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>GAGE: generally applicable gene set enrichment for pathway analysis</article-title>. <source>BMC Bioinformatics</source><italic>,</italic>
<volume>10</volume>, <fpage>161</fpage>.<pub-id pub-id-type="pmid">19473525</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
