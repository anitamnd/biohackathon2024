<?properties open_access?>
<?subarticle report17881?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5130069</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.10082.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Animal Genetics</subject>
        </subj-group>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Disambiguate: An open-source application for disambiguating two species in next generation sequencing data from grafted samples</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; referees: 2 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ahdesmäki</surname>
          <given-names>Miika J.</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gray</surname>
          <given-names>Simon R.</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Johnson</surname>
          <given-names>Justin H.</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lai</surname>
          <given-names>Zhongwu</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label>AstraZeneca IMED Oncology, Cambridge, UK</aff>
      <aff id="a2"><label>2</label>AstraZeneca R&amp;D Information, Cambridge, UK</aff>
      <aff id="a3"><label>3</label>AstraZeneca Oncology iMed, Waltham, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:miika.ahdesmaki@astrazeneca.com">miika.ahdesmaki@astrazeneca.com</email>
      </corresp>
      <fn fn-type="con">
        <p>MA authored the bwa and rna-star disambiguation algorithms, co-authored the manuscript and implemented the algorithms in Python. SG wrote the C++ implementation of the algorithms. JJ co-authored the manuscript. ZL designed and implemented the original Tophat (and Hisat2) disambiguation algorithm and co-authored the manuscript.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>All authors are employees of AstraZeneca.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>2741</elocation-id>
    <history>
      <date date-type="accepted">
        <day>23</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2017 Ahdesmäki MJ et al.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-5-11519.pdf"/>
    <abstract>
      <p>Grafting of cell lines and primary tumours is a crucial step in the drug development process between cell line studies and clinical trials.
<italic>Disambiguate </italic>is a program for computationally separating the sequencing reads of two species derived from grafted samples.
<italic>Disambiguate </italic>operates on DNA or RNA-seq alignments to the two species and separates the components at very high sensitivity and specificity as illustrated in artificially mixed human-mouse samples. This allows for maximum recovery of data from target tumours for more accurate variant calling and gene expression quantification. Given that no general use open source algorithm accessible to the bioinformatics community exists for the purposes of separating the two species data, the proposed
<italic>Disambiguate </italic>tool presents a novel approach and improvement to performing sequence analysis of grafted samples. Both Python and C++ implementations are available and they are integrated into several open and closed source pipelines.
<italic>Disambiguate </italic>is open source and is freely available at
<ext-link ext-link-type="uri" xlink:href="https://github.com/AstraZeneca-NGS/disambiguate">https://github.com/AstraZeneca-NGS/disambiguate</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>NGS</kwd>
      <kwd>patient derived xenograft</kwd>
      <kwd>explant</kwd>
      <kwd>disambiguation</kwd>
      <kwd>sequencing</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>The author(s) declared that no grants were involved in supporting this work.</funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>The text has been updated to address the comments of the reviewers, namely to combine the tables, redraw Figure 1 with more explanations and colour, spell out the disambiguation steps, and include a comparison to Xenome and generally make the text clearer.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Xenografts, both cell line and primary tumour, are routinely profiled in preclinical and translational research. Xenografts are used to study everything from new target identification to responses to targeted therapeutics and mechanisms of resistance
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> in an environment that is more realistic than just 2D cell lines. However, due to mouse stromal contamination of the human tumour, not all the data resulting from studying the extracted samples are guaranteed to be of human origin.</p>
    <p>Direct high throughput sequencing of grafted samples with a mixture of two species is routine practice. However, the origin species of each read or read pair is unknown and needs to be determined informatically. With the high volume of data and computational challenges of alignment and kmer identification, new computational strategies are required to computationally separate the two species’ components for more accurate downstream analysis
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>, especially for the reduction of variant calling artefacts. However, the two-species alignment approach proposed in Bradford
<italic>et al</italic>.
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> excludes reads that align to both organisms, clearly dismissing a large portion of the data as evidenced in
<xref ref-type="table" rid="T1">Table 1</xref> when observing cross species alignment rates.</p>
    <p>Algorithms designed for disambiguating the host and tumour sequences include e.g. the xenome tool
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>, which is based on analysing k-mers from both species and performing simple set operations to assign reads to either species. Xenome was made available as open source via the
<ext-link ext-link-type="uri" xlink:href="https://github.com/data61/gossamer">gossamer</ext-link> repository after the initial publication of this manuscript and therefore results from xenome are now included in an updated comparison. In
<xref rid="ref-3" ref-type="bibr">3</xref> the authors also aligned the reads to both species, but no attempt was taken to disambiguate the data and no implementation is readily available.</p>
    <table-wrap id="T1" orientation="portrait" position="anchor">
      <label>Table 1. </label>
      <caption>
        <title>Read pairs assigned human (hg19) and mouse (mm10) by both the disambiguate and xenome algorithms.</title>
        <p id="fn1">The ’ambiguous’ column includes reads that aligned but could not be unambiguously disambiguated. The
<sup><xref ref-type="other" rid="fn1">†</xref></sup> symbol and the numbers in parentheses indicate false positive reads prior to applying the disambiguation algorithm on the raw alignments. TP denotes true positive and FP false positive.</p>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="left" valign="top" rowspan="1" colspan="1">Tool</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Material</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Sample</th>
            <th align="left" valign="top" rowspan="1" colspan="1">Total
<break/>reads</th>
            <th align="right" valign="top" rowspan="1" colspan="1">Mouse mm10</th>
            <th align="right" valign="top" rowspan="1" colspan="1">Human hg19</th>
            <th align="right" valign="top" rowspan="1" colspan="1">ambiguous</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" rowspan="1" colspan="1">disambiguate</td>
            <td valign="top" rowspan="1" colspan="1">DNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1176814 (mouse)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">47312349</td>
            <td align="right" valign="top" rowspan="1" colspan="1">47197650 (99.76%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">26157(0.06%) FP
<break/>(25638785 (54.19%))
<sup><xref ref-type="other" rid="fn1">†</xref></sup>
</td>
            <td align="right" valign="top" rowspan="1" colspan="1">88542 (0.19%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">xenome</td>
            <td valign="top" rowspan="1" colspan="1">DNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1176814 (mouse)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">47312349</td>
            <td align="right" valign="top" rowspan="1" colspan="1">46889894 (99.11%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">20031 (0.04%) FP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">339326 (0.72%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">disambiguate</td>
            <td valign="top" rowspan="1" colspan="1">DNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1528269 (human)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">77268164</td>
            <td align="right" rowspan="1" colspan="1">11502 (0.01%) FP
<break/>(39686392 (51.36%))
<sup><xref ref-type="other" rid="fn1">†</xref></sup>
</td>
            <td align="right" valign="top" rowspan="1" colspan="1">77102895 (99.79%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">153767 (0.20%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">xenome</td>
            <td valign="top" rowspan="1" colspan="1">DNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1528269 (human)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">77268164</td>
            <td align="right" valign="top" rowspan="1" colspan="1">3291 (0.004%) FP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">76593625 (99.13%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">521239 (0.67%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">disambiguate</td>
            <td valign="top" rowspan="1" colspan="1">RNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1930152 (mouse)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">24056144</td>
            <td align="right" valign="top" rowspan="1" colspan="1">23126086 (96.13%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">80694 (0.34%) FP
<break/>(3005372 (12.49%))
<sup><xref ref-type="other" rid="fn1">†</xref></sup>
</td>
            <td align="right" valign="top" rowspan="1" colspan="1">849364 (3.53%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">xenome</td>
            <td valign="top" rowspan="1" colspan="1">RNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR1930152 (mouse)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">24056144</td>
            <td align="right" valign="top" rowspan="1" colspan="1">23071432 (95.91%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">43294 (0.18%) FP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">625302 (2.60%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">disambiguate</td>
            <td valign="top" rowspan="1" colspan="1">RNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR387400 (human)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">59653070</td>
            <td align="right" valign="top" rowspan="1" colspan="1">94289 (0.16%) FP
<break/>(6001230 (10.06%))
<sup><xref ref-type="other" rid="fn1">†</xref></sup>
</td>
            <td align="right" valign="top" rowspan="1" colspan="1">49677937 (83.28%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">9880844 (16.56%)</td>
          </tr>
          <tr>
            <td valign="top" rowspan="1" colspan="1">xenome</td>
            <td valign="top" rowspan="1" colspan="1">RNA</td>
            <td valign="top" rowspan="1" colspan="1">SRR387400 (human)</td>
            <td align="left" valign="top" rowspan="1" colspan="1">59653070</td>
            <td align="right" valign="top" rowspan="1" colspan="1">83621 (0.14%) FP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">53851984 (90.28%) TP</td>
            <td align="right" valign="top" rowspan="1" colspan="1">2043780 (3.43%)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Here, an alternative approach using read alignment quality is proposed to further disambiguate reads that can be mapped to both species. Alignment is first performed to both species independently and the reads are disambiguated as a post-processing step, assigning reads to the species with higher quality alignments. There is no requirement to maintain pseudo reference indices based on combinations of reference sequences. This approach shows a very high sensitivity and specificity on artificially generated samples obtained by mixing reads from the individual species. The
<italic>Disambiguate</italic> tool is community supported and widely used in several open and closed source pipelines.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation</title>
      <p>The
<italic>Disambiguate</italic> algorithm works by operating on natural name sorted BAM files from alignments to two species. Name sorting is a critical part in not having to read all the data from both species’ alignments into memory simultaneously; the same read aligned to both species is disambiguated on the fly by going through both alignment files synchronously. For reads that have alignments to both species and therefore require disambiguation, the specific details of the disambiguation process are slightly different for the different aligners. Thus far the algorithm has been tested for BWA MEM
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> and Bowtie2
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> for DNA-seq, and TopHat2
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>, STAR
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> and Hisat2
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> for RNA-seq. Illumina’s paired end sequencing is preferred as the mate can often break a tie.
<xref ref-type="fig" rid="f1">Figure 1</xref> illustrates the disambiguation process.</p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="float">
        <label>Figure 1. </label>
        <caption>
          <title>The disambiguation process illustrated.</title>
          <p>Alignment is first performed against both species. The disambiguation application then operates on the raw, natural name sorted BAM files to assign the read pairs into one of the two species or as ambiguous for unresolved cases.</p>
        </caption>
        <graphic xlink:href="f1000research-5-11519-g0000"/>
      </fig>
      <p><italic>Disambiguate</italic> assigns the reads on a per-pair basis, based on the highest quality alignment of the read pair. For BWA and STAR the alignment score (AS tag, higher better) is used as the primary disambiguation metric followed by edit distance (NM, lower better) to the reference for any ties.</p>
      <p>Allowing multiple alignments, let
<italic>QS</italic> be an array of size 4 of the highest quality scores (AS primarily, –NM secondarily) for all read 1 species 1, read 2 species 1, read 1 species 2 and read 2 species 2. Then</p>
      <list list-type="simple">
        <list-item>
          <label>1. </label>
          <p>If max(QS
<sub>1,2</sub>) &gt; max(QS
<sub>3,4</sub>) or max(QS
<sub>1,2</sub>) == max(QS
<sub>3,4</sub>) and min(QS
<sub>1,2</sub>) &gt; min(QS
<sub>3,4</sub>) assign to species 1</p>
        </list-item>
        <list-item>
          <label>2. </label>
          <p>If max(QS
<sub>1,2</sub>) &lt; max(QS
<sub>3,4</sub>) or max(QS
<sub>1,2</sub>) == max(QS
<sub>3,4</sub>) and min(QS
<sub>1,2</sub>) &lt; min(QS
<sub>3,4</sub>) assign to species 2</p>
        </list-item>
        <list-item>
          <label>3. </label>
          <p>If AS did not resolve, repeat for –NM</p>
        </list-item>
        <list-item>
          <label>4. </label>
          <p>If neither AS nor –NM resolved, assign ambiguous</p>
        </list-item>
      </list>
      <p>For Tophat2 and Hisat2 based alignments the sum (lower better) of edit distance, number of reported alignments (NH) and the number of gap opens (XO) is used. Let
<italic>QS</italic> =
<italic>NM</italic> +
<italic>NH</italic> +
<italic>XO</italic>. Then</p>
      <list list-type="simple">
        <list-item>
          <label>1. </label>
          <p>If the scores are identical for the highest ranking reads for both species, assign ambiguous</p>
        </list-item>
        <list-item>
          <label>2. </label>
          <p>If min(QS
<sub>1,2</sub>) &lt; min(QS
<sub>3,4</sub>) or min(QS
<sub>1,2</sub>) == min(QS
<sub>3,4</sub>) and max(QS
<sub>1,2</sub>) &lt; max(QS
<sub>3,4</sub>) assign to species 1</p>
        </list-item>
        <list-item>
          <label>3. </label>
          <p>Else assign to species 2</p>
        </list-item>
      </list>
      <p>Aligner tags for BWA and STAR are almost identical, as are the aligner tags for Tophat2 and Hisat2. However STAR and BWA lack most of the tags used by Tophat2/Hisat2, for which the original disambiguation scheme was developed. This is the underlying reason for using two separate schemes. Relative weighting schemes could potentially also be considered for the tag values to improve sensitivity and specificity. This would run the risk of overfitting to the data though and would need to be evaluated over a very large data set.</p>
    </sec>
    <sec>
      <title>Operation</title>
      <p>The algorithm is implemented in Python (with dependency on the
<ext-link ext-link-type="uri" xlink:href="https://github.com/pysam-developers/pysam">Pysam</ext-link> package) and C++ (with dependency on
<ext-link ext-link-type="uri" xlink:href="https://github.com/pezmaster31/bamtools">BamTools</ext-link>), with the C++ version being approximately four times faster than the Python code. 64 bit unix/linux systems are supported.</p>
      <p>Given name sorted alignment (BAM) files aligned to the two species of interest (e.g. human and mouse), the algorithm infers for each read the most likely origin. The output contains BAM files for both species, BAM files for ambiguous reads and a text file describing how many read pairs were assigned to each BAM file. The simplest way to perform all of the alignment and disambiguation is by running
<ext-link ext-link-type="uri" xlink:href="https://github.com/chapmanb/bcbio-nextgen">bcbio</ext-link>, in which
<italic>Disambiguate</italic> is integrated, on the raw sequencing data.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>To illustrate the utility of
<italic>Disambiguate</italic>, raw publicly available human and mouse sequencing data was downloaded. First exome sequencing reads (100bp paired end Illumina data) were obtained from the European Nucleotide Archive (
<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena">ENA</ext-link>) with Run Accessions
<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/data/view/SRR1176814">SRR1176814</ext-link> and
<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/data/view/SRR1528269">SRR1528269</ext-link>.</p>
    <p>The reads were aligned against hg19 and mm10 using BWA MEM, and processed using
<italic>Disambiguate</italic> and xenome. Pre-disambiguation, for the human sample (SRR1528269), there were 39686392 read pairs (out of total 77268164), for which at least one read aligned to mouse. Similarly, for the mouse sample (SRR1176814), there were 25638785 read pairs (out of total 47312349) for which at least one read aligned to human.
<xref ref-type="table" rid="T1">Table 1</xref> summarises the disambiguation results. As can be seen, the disambiguation algorithm correctly pulls apart virtually all of the read pairs.
<italic>Disambiguate</italic> shows slightly more true and false positives in comparison to xenome. In other internal studies,
<italic>Disambiguate</italic> has time and again highlighted samples with low human assigned component, correlating with poor extraction or lack of growth of the tumour cells in the host.</p>
    <p>For RNA-seq, STAR aligned human (SRR387400) and mouse (SRR1930152) data was also analysed with very similar results. For the mouse sample
<italic>Disambiguate</italic> displays again slightly more true and false positives compared to xenome but for SRR387400 xenome shows clearly more true positives.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>In summary,
<italic>Disambiguate</italic> provides an important tool for computationally separating sequence reads originating from two species. In human-mouse studies it also allows the study of the mouse stromal component for gene expression and DNA variation. The results presented here show excellent separation of the host and graft. Future work includes evaluating how the performance is affected by the use of very highly mutated tumour xenografts based on for example MCF7.</p>
    <p>In addition to RNA-seq and whole genome sequencing, it is worth highlighting that for targeted hybridisation capture sequencing of xenograft samples, where baits from a single species are used, disambiguation is still highly recommended. This is best seen in
<xref ref-type="table" rid="T1">Table 1</xref> where a large number of human exome reads aligned to mouse and would potentially affect downstream interpretation without disambiguation.</p>
    <p><italic>Disambiguate</italic> has been well adopted in the open source community; it is integrated in the open source
<ext-link ext-link-type="uri" xlink:href="https://github.com/chapmanb/bcbio-nextgen">bcbio</ext-link> pipeline and has been successfully used in both RNA and DNA sequencing of xenografts both at AstraZeneca and other research institutes. This is evidenced by the number support tickets from a variety of organisations on the bcbio-nextgen Github page.</p>
  </sec>
  <sec>
    <title>Data availability</title>
    <p>The data referenced by this article are under copyright with the following copyright statement: Copyright: © 2017 Ahdesmäki MJ et al.</p>
    <p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/"/>
</p>
    <p>The data used here is available from the European Nucleotide Archive with Run Accession numbers SRR1176814 and SRR1528269.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>Software integrating
<italic>Disambiguate</italic> available from:
<ext-link ext-link-type="uri" xlink:href="https://github.com/chapmanb/bcbio-nextgen">https://github.com/chapmanb/bcbio-nextgen</ext-link>
</p>
    <p>Latest source code:
<ext-link ext-link-type="uri" xlink:href="https://github.com/AstraZeneca-NGS/disambiguate">https://github.com/AstraZeneca-NGS/disambiguate</ext-link>
</p>
    <p>Archived source code as at time of publication: DOI:
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.166017">10.5281/zenodo.166017</ext-link>
</p>
    <p>License: MIT</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors wish to thank Brad Chapman, Rory Kirchner and Eric Schelhorn for feedback and fixes on
<italic>Disambiguate</italic>.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradford</surname><given-names>JR</given-names></name><name><surname>Farren</surname><given-names>M</given-names></name><name><surname>Powell</surname><given-names>SJ</given-names></name><etal/></person-group>:
<article-title>RNA-Seq Differentiates Tumour and Host mRNA Expression Changes Induced by Treatment of Human Tumour Xenografts with the VEGFR Tyrosine Kinase Inhibitor Cediranib.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e66003</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0066003</pub-id><!--<pub-id pub-id-type="pmcid">3686868</pub-id>--><?supplied-pmid 23840389?><pub-id pub-id-type="pmid">23840389</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conway</surname><given-names>T</given-names></name><name><surname>Wazny</surname><given-names>J</given-names></name><name><surname>Bromage</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Xenome--a tool for classifying reads from xenograft samples.</article-title><source><italic>Bioinformatics.</italic></source><year>2012</year>;<volume>28</volume>(<issue>12</issue>):<fpage>i172</fpage>–<lpage>i178</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts236</pub-id><!--<pub-id pub-id-type="pmcid">3371868</pub-id>--><?supplied-pmid 22689758?><pub-id pub-id-type="pmid">22689758</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossello</surname><given-names>FJ</given-names></name><name><surname>Tothill</surname><given-names>RW</given-names></name><name><surname>Britt</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Next-generation sequence analysis of cancer xenograft models.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e74432</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0074432</pub-id><!--<pub-id pub-id-type="pmcid">3784448</pub-id>--><?supplied-pmid 24086345?><pub-id pub-id-type="pmid">24086345</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group>:
<article-title>Aligning sequence reads, clone sequences and assembly contigs with bwa-mem.</article-title><source><italic>bioRxiv.</italic></source>arXiv:1303.3997 q–bio.GN.<year>2013</year>;<fpage>1</fpage>–<lpage>3</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/1303.3997v2.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>:
<article-title>Fast gapped-read alignment with Bowtie 2.</article-title><source><italic>Nat Methods.</italic></source><year>2012</year>;<volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>359</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><!--<pub-id pub-id-type="pmcid">3322381</pub-id>--><?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions.</article-title><source><italic>Genome Biol.</italic></source><year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R36</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id><!--<pub-id pub-id-type="pmcid">4053844</pub-id>--><?supplied-pmid 23618408?><pub-id pub-id-type="pmid">23618408</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><etal/></person-group>:
<article-title>STAR: ultrafast universal RNA-seq aligner.</article-title><source><italic>Bioinformatics.</italic></source><year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>21</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id><!--<pub-id pub-id-type="pmcid">3530905</pub-id>--><?supplied-pmid 23104886?><pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group>:
<article-title>HISAT: a fast spliced aligner with low memory requirements.</article-title><source><italic>Nat Methods.</italic></source><year>2015</year>;<volume>12</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>360</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id><!--<pub-id pub-id-type="pmcid">4655817</pub-id>--><?supplied-pmid 25751142?><pub-id pub-id-type="pmid">25751142</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report17881" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.10863.r17881</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Oliver</surname>
          <given-names>Gavin R.</given-names>
        </name>
        <xref ref-type="aff" rid="r17881a1">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nair</surname>
          <given-names>Asha</given-names>
        </name>
        <xref ref-type="aff" rid="r17881a2">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r17881a1"><label>1</label>Department of Health Sciences Research, Mayo Clinic, Rochester, MN, USA</aff>
      <aff id="r17881a2"><label>2</label>Mayo Clinic</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e1132" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.10082.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>We believe that overall the software tool article by Ahdesmäki 
<italic>et al. </italic>seems sound and provides a solution to a problem that appears to be inadequately addressed in the field currently. </p>
    <p> Nonetheless, we believe the manuscript would benefit from some minor amendments in order to increase its utility and accessibility to readers.</p>
    <p> In brief:</p>
    <p>
      <bold>
        <underline>Intro/Background</underline>
      </bold>
    </p>
    <p> Needs expanded slightly to better set the scene and describe the general approach of read disambiguation.</p>
    <p>
      <bold>
        <underline>Methodology</underline>
      </bold>
    </p>
    <p> The methodology should be expanded slightly and made more explicit.</p>
    <p>
      <bold>
        <underline>Tables 1&amp;2:</underline>
      </bold>
      <list list-type="bullet">
        <list-item>
          <p>Combine 1 &amp; 2 into a single table and label the samples by data type, i.e DNA and RNA</p>
        </list-item>
        <list-item>
          <p>Show %s as well as numbers</p>
        </list-item>
        <list-item>
          <p>Clearly label the species in the tables</p>
        </list-item>
        <list-item>
          <p>Clearly label correctly mapped/incorrectly mapped reads in table</p>
        </list-item>
        <list-item>
          <p>Clearly label human and mouse genomes as such</p>
        </list-item>
        <list-item>
          <p>Tables should clearly show all numbers pre- and post- disambiguation, rather than having superscripted references in the table legend</p>
        </list-item>
        <list-item>
          <p>Essentially, a novice should be able to read the paper and extract relevant info more easily.</p>
        </list-item>
      </list>
    </p>
    <p>
      <underline>
        <bold>Figure 1 </bold>
      </underline>
      <list list-type="bullet">
        <list-item>
          <p>Should be more granular, informative and descriptive of the process. Include read alignment etc.  Describe the Disambiguate process</p>
        </list-item>
        <list-item>
          <p>Use same font size for all text in the Figure</p>
        </list-item>
      </list>
    </p>
    <p>
      <bold>
        <underline>Comparison with a competitor product</underline>
      </bold>
    </p>
    <p> This is something that is clearly missing. If it is literally impossible to compare to a competitor because the software is not accessible, this should be stated clearly as a reason for the lack of comparison in the paper.</p>
    <p>
      <bold>
        <underline>Tumor samples</underline>
      </bold>
    </p>
    <p> It would be interesting to know how performance is affected by use of highly mutated tumor xenografts. This is arguably beyond the scope of the paper, but warrants at least some mention.</p>
    <p>We have read this submission. We believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment2423" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Ahdesmäki</surname>
            <given-names>Miika</given-names>
          </name>
          <aff/>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>NA</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>11</day>
        <month>1</month>
        <year>2017</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Dear Gavin and Asha, </p>
      <p> Many thanks for the very detailed review and comments. We have addressed your points in v2 of the manuscript.  </p>
      <p> Into/background: </p>
      <p> We have added the text in braces: "Direct high throughput sequencing of grafted samples with a mixture of two species is routine practice. {However, the origin species of each read or read pair is unknown and needs to be determined informatically.}" to better set the scene. Further, the operation of xenome is now updated and xenome is now included in a comparison study. We have more explicitly stated that "Alignment is first performed to both species independently and the reads are disambiguated as a post-processing step, {assigning reads to the species with higher quality alignments}" </p>
      <p> Methodology: </p>
      <p> We have clarified the methodology section by spelling out the disambiguation algorithm and giving the reasoning why two schemes are used.  </p>
      <p> Table 1&amp;2: </p>
      <p> We have combined Tables 1&amp;2 and revised the contents to address these points. </p>
      <p> Figure 1: </p>
      <p> We have redrawn the figure to be more descriptive. </p>
      <p> Comparison to competitor product: </p>
      <p> We have now compared our approach to Xenome, which was recently open sourced, and included the results of the comparison in the updated table with discussion. </p>
      <p> Tumor samples: </p>
      <p> We agree that evaluating the performance of the disambiguation algorithm in a messy cancer genome like the highly rearranged MCF7 would be extremely interesting. If we get our hands on appropriate data we will consider publishing the results on the program Github page.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report17879" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.10863.r17879</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Eldridge</surname>
          <given-names>Matthew D.</given-names>
        </name>
        <xref ref-type="aff" rid="r17879a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r17879a1"><label>1</label>Cancer Research UK Cambridge Institute, University of Cambridge, Cambridge, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e1345" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.10082.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This paper describes a computational tool for separating sequencing reads from a sample that contains DNA or RNA from two species. This is a necessary pre-processing step for genomic or transcriptomic analysis of patient-derived xenograft cancer models.</p>
    <p> The approach is based on alignments of sequence reads to the reference genome sequences for the two species in question. The authors have tested their approach on DNA-seq data from publicly available human and mouse exome datasets concatenated to simulate a xenograft sample. The results presented in Table 1 show very good separation of reads from the two species datasets with only a small percentage of reads being assigned to the wrong species (0.06% and 0.01%) and a higher but still very low percentage of reads flagged as ambiguous, i.e. align equally well to both genomes. Similar results were presented for RNA-seq data, although here the percentages of incorrectly assigned and ambiguous reads are unsurprisingly higher than for DNA-seq.</p>
    <p> Use of the alignment scores, and in the event of a tie the edit distance, is a reasonable approach to disambiguate reads and is the method used for BWA and STAR alignments. For TopHat2 and HISAT2 a different scoring function is required, although the reasons for this are not given. Further, the choice of function (sum of edit distance, number of reported alignments and number of gap opens) is not completely obvious and raises the question of whether the authors have attempted to tune the function, e.g. by adjusting the weighting of each component.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment2424" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Ahdesmäki</surname>
            <given-names>Miika</given-names>
          </name>
          <aff/>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>NA</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>11</day>
        <month>1</month>
        <year>2017</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Dear Mathew, </p>
      <p> Many thanks for reviewing our manuscript and the comments. We have modified v2 of the manuscript to address the points you raise, namely: 
<list list-type="order"><list-item><p>The aligner tags are very similar between BWA and STAR; and between TopHat2 and HISAT2. However, fairly different between BWA/STAR vs TopHat2/Hisat2 and therefore we couldn't use the same scheme originally developed for TopHat2 with BWA/STAR. With the appearance of HISAT2 especially for hg38 we decided to utilise the TopHat2 scheme for HISAT2 given their outputs are almost interchangeable. We have mentioned this in the updated text. </p></list-item><list-item><p>The sum of edit distance, number of reported alignments and number of hap opens has always worked for us well out of the box (as illustrated in the tables) and while tuning their weights may yield some minor benefits, it would risk overfitting to existing data. Any benefits of the weight tuning would have to be measured over a very long time, running multiple versions of weighted and the unweighted algorithms side by side. We have given this reasoning (complexity) in the text as our excuse of not tuning the weights further.  </p></list-item></list>  </p>
      <p> Thank you again for the comments and helping us improve the manuscript.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report17877" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.10863.r17877</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nicorici</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="r17877a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r17877a1"><label>1</label>Orion Corporation Orion Pharma, Espoo, Finland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e1441" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.10082.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This papers introduces a tool, named Disambiguate, for computationally separating the DNA/RNA sequencing reads of two species, like for example in case of xenograft samples. The tool takes as input BAM files from wide range of NGS aligners.</p>
    <p> I have made the following minor observations: 
<list list-type="order"><list-item><p>The tool Disambiguate works on RNA-seq and DNA-seq data and this is mentioned for the first time in Methods section. Probably it would help to have this mentioned much earlier, like for example in the abstract too.</p></list-item><list-item><p>In order to improve the clarity, to the Tables 1 and 2 could be added also the percentages where is relevant, like for example, "26157" would become "26157 (0.0553%)" and so on.</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment2425" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Ahdesmäki</surname>
            <given-names>Miika</given-names>
          </name>
          <aff/>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>NA</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>11</day>
        <month>1</month>
        <year>2017</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Dear Daniel, </p>
      <p> Thank you for the review, your comments are much appreciated. We have addressed your points in v2 of the manuscript. 
<list list-type="order"><list-item><p>We have explicitly mentioned in the abstract and the introduction that the tool can be used for both DNA and RNA-seq data </p></list-item><list-item><p>We have added percentages into the tables as you suggested </p></list-item></list>
</p>
      <p> Thank you for the review and helping us improve the manuscript.</p>
    </body>
  </sub-article>
</sub-article>
