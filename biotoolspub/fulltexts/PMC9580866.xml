<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Bioinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2673-7647</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9580866</article-id>
    <article-id pub-id-type="publisher-id">826701</article-id>
    <article-id pub-id-type="doi">10.3389/fbinf.2021.826701</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RecruitPlotEasy: An Advanced Read Recruitment Plot Tool for Assessing Metagenomic Population Abundance and Genetic Diversity</article-title>
      <alt-title alt-title-type="left-running-head">Gerhardt et al.</alt-title>
      <alt-title alt-title-type="right-running-head">RecruitPlotEasy</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gerhardt</surname>
          <given-names>Kenji</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1398429/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruiz-Perez</surname>
          <given-names>Carlos A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rodriguez-R</surname>
          <given-names>Luis M.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/214413/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conrad</surname>
          <given-names>Roth E.</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Konstantinidis</surname>
          <given-names>Konstantinos T.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/332782/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>School of Biological Sciences</institution>, <addr-line>Atlanta</addr-line>, <addr-line>GA</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Center for Bioinformatics and Computational Genomics</institution>, <addr-line>Atlanta</addr-line>, <addr-line>GA</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Microbiology and Digital Science Center (DiSC)</institution>, <institution>University of Innsbruck</institution>, <addr-line>Innsbruck</addr-line>, <country>Austria</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Ocean Science &amp; Engineering</institution>, <addr-line>Atlanta</addr-line>, <addr-line>GA</addr-line>, <country>United States</country></aff>
    <aff id="aff5"><sup>5</sup><institution>School of Civil and Environmental Engineering</institution>, <institution>Georgia Institute of Technology</institution>, <addr-line>Atlanta</addr-line>, <addr-line>GA</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/403977/overview" ext-link-type="uri">Nikos Kyrpides</ext-link>, Joint Genome Institute, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/618308/overview" ext-link-type="uri">Neha Jacob Varghese</ext-link>, Joint Genome Institute, United States</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/1134341/overview" ext-link-type="uri">Stephen Nayfach</ext-link>, Lawrence Berkeley National Laboratory, United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Konstantinos T. Konstantinidis, <email>kostas@ce.gatech.edu</email>
</corresp>
      <fn fn-type="equal" id="fn1">
        <label>
          <sup>†</sup>
        </label>
        <p>These authors have contributed equally to this work</p>
      </fn>
      <fn fn-type="other">
        <p>This article was submitted to Genomic Analysis, a section of the journal Frontiers in Bioinformatics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>1</volume>
    <elocation-id>826701</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Gerhardt, Ruiz-Perez, Rodriguez-R, Conrad and Konstantinidis.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Gerhardt, Ruiz-Perez, Rodriguez-R, Conrad and Konstantinidis</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Mapping of short metagenomic (or metatranscriptomic) read data to reference isolate or single-cell genomes or metagenome-assembled genomes (MAGs) to assess microbial population relative abundance and/or structure represents an essential task of many studies across environmental and clinical settings. The filtering for the quality of the read match and assessment of read mapping results are frequently performed without visual aids or with the assistance of visualizations produced through ad-hoc, in-house approaches. Here, we introduce RecruitPlotEasy, a fully automated, user-friendly pipeline for these purposes that integrates statistical approaches to quantify intra-population sequence and gene-content diversity and identify co-occurring relative populations in the sample. Hence, RecruitPlotEasy should also greatly facilitate population genetics studies.</p>
      <p>RecruitPlotEasy is implemented in Python and R languages and is freely available open source software under the Artistic License 2.0 from <ext-link xlink:href="https://github.com/KGerhardt/RecruitPlotEasy" ext-link-type="uri">https://github.com/KGerhardt/RecruitPlotEasy</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>bioinformatics</kwd>
      <kwd>software</kwd>
      <kwd>metagenomics</kwd>
      <kwd>MAG</kwd>
      <kwd>population diversity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">
          <institution-wrap>
            <institution>National Science Foundation
</institution>
            <institution-id institution-id-type="doi">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id award-type="contract" rid="cn001">1759831</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Metagenomics studies of natural microbial populations have recently revealed that bacteria and archaea predominantly form sequence-discrete populations with intra-population genomic sequence relatedness typically ranging from ∼95 to 100% genome-aggregate average nucleotide identity (or ANI) depending on the population considered (e.g., younger populations since the last population diversity sweep event show lower levels of intra-population diversity and thus, higher ANI). In contrast, ANI values between distinct populations are typically lower than 90% [<xref rid="F1" ref-type="fig">Figure 1</xref> and reviewed in (<xref rid="B1" ref-type="bibr">Caro-Quintero and Konstantinidis, 2012</xref>)]. Such sequence-discrete populations were recovered from many different habitats, including marine, freshwater, soils, sediment, human gut and biofilms, and were typically persistent over time and space [e.g., (<xref rid="B4" ref-type="bibr">Konstantinidis and DeLong 2008</xref>; <xref rid="B5" ref-type="bibr">Meziti et al., 2019</xref>; <xref rid="B7" ref-type="bibr">Olm et al., 2020</xref>)]. Therefore, these populations appear to be “species-like” and may constitute important units of microbial communities. This discovery is also important in medical microbiology; for instance, in identifying which population is the causative agent of disease (<xref rid="B8" ref-type="bibr">Pena-Gonzalez et al., 2019</xref>). More recent work has even shown that intermediate identity genotypes, for example, sharing 85–95% ANI, when present, are ecologically differentiated and thus, should probably be considered distinct species (<xref rid="B2" ref-type="bibr">Conrad et al., 2021</xref>; <xref rid="B11" ref-type="bibr">Rodriguez-R et al., 2021</xref>), rather than representing cultivation (or other sampling) biases (<xref rid="B6" ref-type="bibr">Murray et al., 2021</xref>).</p>
    <fig position="float" id="F1">
      <label>FIGURE 1</label>
      <caption>
        <p>Recruitment plot displaying gut metagenomic reads mapped to a single <italic>Staphylococcus aureus</italic> reference genome. <bold>(A)</bold> is a 2-D histogram displaying the percent identity of reads to the reference genome on the y-axis and the position in the genome on the x-axis. Cell fill color darkens as more reads fall within the cell, i.e., the region of the genome and percent identity window the cell represents, in a logarithmic scale. Shaded in dark blue is a region indicates the plot’s current within-population percent nucleotide identity threshold, here shown at the tool’s default 95%. <bold>(B)</bold> is a line plot of the average depth of coverage per genome region on the main panel. The dark blue line displays depth of coverage for reads mapping to regions of the genome within the population threshold from panel <bold>(A)</bold>, and the light blue line displays depth for reads outside this population. Note the logarithmic scale in the base pair counts axis as well as the highlighted area of lower coverage, representing a reference genomic region not shared by the majority of the metagenomic population. <bold>(C)</bold> is a histogram of depths of coverage across the entire genome, with colors corresponding to within and outside-population as in panel. <bold>(D)</bold> is a histogram of the number of bases displayed in panel <bold>(A)</bold> (x-axis) which fall into particular percent identity windows (y-axis), here displayed in log scale. Note the second peak in the number of bases mapping in the 94–95% identity range, representing a co-occurring <italic>S. aureus</italic>-like population. See also main text for further details.</p>
      </caption>
      <graphic xlink:href="fbinf-01-826701-g001" position="float"/>
    </fig>
    <p>Read recruitment plots are one of the most in-depth analyses to reveal and study sequence-discrete populations. In these plots, the reads of a metagenome are mapped against a genomic reference sequence that is representative of the population to be studied (e.g., an isolate genome or MAG). The mapping patterns that are revealed are informative about how well the metagenomic population matches the reference genome, gene content differences if any, the level of intra-population sequence diversity, and regions of sequence-discontinuity (<xref rid="B12" ref-type="bibr">Rusch et al., 2007</xref>; <xref rid="B4" ref-type="bibr">Konstantinidis and DeLong 2008</xref>) (<xref rid="F1" ref-type="fig">Figure 1</xref>). Thus, read recruitment plots can provide a thorough and quantitative view of the natural population in a sample and its diversity, which represents highly useful information for several downstream analyses. Accordingly, several tools that can plot read mapping patterns have been developed for this purpose e.g., (<xref rid="B9" ref-type="bibr">Robinson et al., 2011</xref>; <xref rid="B13" ref-type="bibr">Zhu et al., 2013</xref>; <xref rid="B3" ref-type="bibr">Jaenicke et al., 2018</xref>). However, these tools typically provide no additional information or capabilities such as they do not include appropriate statistics to characterize the genome, gene allelic, and gene content diversity in spatial or time-series metagenomes and thus, do not allow targeted analyses of specific gene-based traits and exploration of selection pressure and population bottlenecks (<xref rid="B5" ref-type="bibr">Meziti et al., 2019</xref>).</p>
    <p>Recently, we have developed bioinformatic scripts that can be applied to the read mapping output of a read recruitment plot to provide information based on read mapping that is not available by previous tools such as what is the average coverage of the genome by reads (a proxy for relative metagenome abundance), whether or not co-occurring populations exist in the dataset (sample) (<xref rid="B10" ref-type="bibr">Rodriguez and Konstantinidis, 2016</xref>), and which genes of the reference genome in the plot (isolate or MAG) are shared or not by the metagenomic population (<xref rid="B5" ref-type="bibr">Meziti, et al., 2019</xref>). Here, we present RecruitPlotEasy, a pipeline that integrates all these scripts into a single tool and represents a completely redesigned tool compared to that originally introduced as part of the enveomics script collection (<xref rid="B10" ref-type="bibr">Rodriguez and Konstantinidis, 2016</xref>) in order to scale-up with more data. RecruitPlotEasy also includes new, additional features such as the possibility to simultaneously view plots of multiple reference genomes and/or metagenomic read datasets and is interactive in that the user can browse over the plot to identify genes of interest and view their associated functional annotation (when provided) and relative abundance in the metagenome. Based on previous literature, we employed a (user-adjustable) 95% nucleotide identity threshold to identify reads that represent the same (target) population (a.k.a. <italic>within</italic> population diversity), while reads showing lower than 95% identity are considered to represent distinct, co-occurring populations (a.k.a. <italic>outside</italic> population). Using the RecruitPlotEasy tool requires no previous bioinformatics or coding skills.</p>
  </sec>
  <sec id="s2">
    <title>Installation and Inputs</title>
    <p>RecruitPlotEasy is operated entirely through a graphical user interface (GUI) which manages the selection of inputs, the manipulation of data, and the creation of plots through simple buttons and drop-down menus. Further, all menus and options are annotated with tooltips and reports that help the user easily navigate the workflow of the Recruitment Plot without prior experience using the tool. RecruitPlotEasy is written in a pair of scripts, one in R and one in Python 3. This two-script design takes advantage of multiple visualization libraries and the GUI of the Shiny library available in R, while operating with modest computational resources enabled by Python.</p>
    <p>To use the tool, the user needs only to download and install R, Rstudio, and then run a single command from the R terminal. This command installs any missing R dependencies, installs Miniconda if it is absent (to ensure that the right version of Python is subsequently installed), retrieves the R and Python functions, and launches the GUI for the user. While installation only occurs on the first use of RecruitPlotEasy, this same command is used in subsequent sessions to activate the GUI again. RecruitPlotEasy requires a user to supply one (or more) genome file(s) in FASTA format and at least one set of reads mapped to that genome file in either tabular BLAST or SAM/BAM formats. Users may optionally supply gene functional annotation in GFF for gene-level analysis.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <p>The graphical interface of RecruitPlotEasy opens in the user’s default web browser. This interface is organized into 4 tabs: Database Creation, Database Management, Recruitment Plot, and Interactive Plot (<xref rid="s10" ref-type="sec">Supplementary Figure S8</xref>). The tabs organize the workflow of RecruitPlotEasy into smaller, manageable tasks where the options available on each page are directly relevant to the task that page supports. For instance, input selection occurs on the database creation tab, assessment of the contents of a database and the control of advanced options occurs on the database management tab, and the creation of plots occurs on the recruitment plot and interactive plot tabs. The workflow of the recruitment plot is further guided by multiple forms of user feedback. All buttons and input fields are annotated with tooltips that inform the user of the actions each button will perform upon hovering their cursor over it. This includes guidance on the type of file and the kind of data required in each input, and the consequences of changes made to plotting parameters. As inputs are selected, their formats are also checked for basic appropriateness.</p>
    <p>The underlying data shown in a recruitment plot is a 2-dimensional matrix (or table) of counts. For a given genome, columns of this matrix correspond to successive regions of the genome and rows correspond to windows of percent nucleotide identity values. The width and height of each cell of the matrix are defined by the user, with defaults of 1000 base pairs for width and 0.5% identity for height. If viewing genes, percent identity windows are determined in the same way, but genome regions instead correspond exactly to the starts and ends of the gene sequences, with intergenic regions forming additional columns, as needed, to fill in the rest of the matrix. The cells of the matrix effectively form a 2-dimensional histogram of bins into which reads may fall.</p>
    <p>To fill the matrix, reads aligning to the genome are assigned to their appropriate percent identity window and genome position bin. A user may choose to define percent identity to the reference as either the number of matches divided by the alignment length (local alignment) or matches divided by the entire length of the read, including unaligned sections (global alignment). After the percent identity row is determined, the read will increase the base pair (bp) count of the bin it falls into by its length. Should a read span two or more bins, each bin will receive its respective share of the read’s length according to exactly where the read mapped to the genome and the boundaries of the bins. The count for each bin represents the sum of all bases of all reads that map within the corresponding percent identity and region of the genome. Once every read has been processed, the filled matrix is passed to the plotting component of RecruitPlotEasy.</p>
    <p>Reads may also be filtered based on minimum alignment length, minimum percent of the read aligning to the reference (not available for tabular BLAST), and by selecting only those reads which map best to the currently viewed genome (i.e. allowing each read to map only once across the set of genomes available in the database). Reads are not processed in any way prior to their selection from the database, meaning that any plot and any statistics or data export based on a plot are created only from the reads which pass the filtering parameters selected by the user (or the defaults when user makes no choices). A record of the exact query used to select reads from the current RecruitPlotEasy database is exported alongside any saved plot or data export in order to ensure that the reads used to generate a plot can be recovered at later dates.</p>
  </sec>
  <sec id="s4">
    <title>Output and Results</title>
    <p>The recruitment plots from RecPlotEasy show four views of a single dataset; the main panel of a recruitment plot directly displays the underlying counts matrix, while the other three panels display useful summaries derived from the data in the main panel. <xref rid="F1" ref-type="fig">Figure 1</xref> shows an example of the read recruitment plot obtained with a single gut metagenome mapped against a <italic>Staphylococcus aureus</italic> reference genome. We consider the subplot in the bottom left the main panel, which shows how metagenomic reads of sufficient nucleotide identity and alignment (user defined) thresholds map against the reference genome. Because read recruitment plots commonly recruit tens of thousands to millions of reads from a metagenome it is computationally intractable to directly plot each read individually. Instead, we plot the sum of all bases from the reads that fall within a specific region of the main panel defined as a grid with cells consisting of base pair width (x-axis; default = 1000) and percent sequence identity of the read alignment height (y-axis; default = 0.5%) (Methods section above).</p>
    <p>The panel on the bottom right shows the number of nucleotide bases (i.e., density of reads) at each unit of nucleotide identity (y-axis) in the main panel. Note that the specific case in <xref rid="F1" ref-type="fig">Figure 1</xref> shows an abundant <italic>S. aureus</italic> population in the sample, represented by a high density of high identity (&gt;98% identity) reads mapping evenly across the reference genome along with a less abundant, closely related and co-occurring <italic>S. aureus</italic>-like population represented by the second lower peak in the number of mapped bases in the 94–95% identity range. The region between these two peaks shows the sequence discontinuity between the two sequence-discrete populations, one representing the reference genome and the other representing the sum of the remaining genomes.</p>
    <p>Similarly, the upper left panel shows the coverage (i.e., how many times a base of the reference sequence is covered by mapped reads) of the genome at each unit of genomic position (x-axis) in the main panel. The darker blue color represents reads within the target population (default &gt;95% nucleotide identity to the reference sequence) while the lighter blue represents lower identity reads considered outside the population (nucleotide threshold can be adjusted by the user). Note in <xref rid="F1" ref-type="fig">Figure 1</xref> that the top left panel shows fairly even read coverage across the genome for the target population with the exception of a few lower coverage regions while the outside of population coverage is more variable. This is an expected result for a single, homogenous population that is a good match to the reference genome. When no reads map to a genomic region (i.e., the region shows zero coverage), the region is displayed at the bottom of the panel for its respective group (dark blue target or light blue off-target), discontinuous from the rest of the line chart. Such low- or zero-coverage windows typically occur when a reference gene(s) is absent in the sampled population; browsing over the windows in the interactive mode can reveal which genes are found in these windows and their functional annotation, when the latter information is provided at the input stage. Hence, RecruitPlotEasy can reveal the gene content differences between the reference genome and the metagenomic population.</p>
    <p>Finally, the top-right panel shows the histogram of coverage depth values over regions of the genome, which should reveal a tight distribution around the mean in cases where the reference genome represents a single population and a not-chimeric genome, like in the <italic>S. aureus</italic> example in <xref rid="F1" ref-type="fig">Figure 1</xref>. A wider distribution would have been expected in the case of a chimeric genome that represents two or more populations with distinct <italic>in-situ</italic> abundances. For further details on the panels, see also <xref rid="s10" ref-type="sec">Supplementary Figure S4</xref>. <xref rid="s10" ref-type="sec">Supplementary Material</xref> includes additional methodological details; <xref rid="s10" ref-type="sec">Supplementary Figures S5–S7</xref> provide additional (less common) examples and use cases.</p>
    <p>RecruitPlotEasy provides the user with the option to export their plots as high-quality figures and save the plotting data used to create them. Once the user has decided that they are satisfied with their plot as it appears in the GUI, they may provide a name and save the plotting data used to generate each recruitment plot sub-plot three in tab-delimited files and save a PDF of the plot image, laid out in a 16:9 aspect ratio to match the majority of modern screens. While RecruitPlotEasy uses the PDF format to save its plots, the graphics within each PDF are ultimately saved as an SVG that is both infinitely scalable without any loss in the figure’s resolution (i.e. it can be zoomed in on as much as desired without losing any clarity) and can be easily imported into common figure editing software that support SVG manipulation such as Adobe Illustrator for further editing, labelling, or other manipulations desired by a user.</p>
    <p>The interactive plots created by RecruitPlotEasy may also be exported, but the files produced are quite different from the PDFs that are generated by the normal plotting approach. The R Plotly library is used to generate interactive recruitment plots, and these interactive plots are saved as HTML files that contain an independent copy of the data used to create the plot and the graphical results. These can be subsequently opened by most internet browsers, and do not require RecruitPlotEasy, R at all, or any other external software to be shared and viewed.</p>
    <p>To better support integration in workflows, RecruitPlotEasy also includes a built-in read filtering function. When a database is built, RecrutPlotEasy makes a note of the location of each input read file and indexes reads by their name and the genome each mapped to. When viewing plots, reads at or above a user-defined percent identity cutoff may be added to a cart. By returning to the database management tab of the GUI, reads in the cart can be exported to filtered outputs in the same format as the inputs (although BAM is converted to SAM format) that will contain only those reads matching the selection criteria currently chosen by the user. Depending on the users’ chosen options, this can (and will, under default settings) include filtering reads to only their best matches, thus removing instances of reads mapping to multiple locations, filtering poorly aligned reads, selecting only reads mapping to specific genomes, and selecting only reads sufficiently similar to the reference sequence. This function is intended to be used in tandem with the plot saving component of RecruitPlotEasy: a user may inspect their read mapping results, tailor their filtering settings to match the properties of each genome as needed, and export reads alongside one or multiple recruitment plots that aid in justifying the choice of filtering parameters.</p>
    <p>In summary, we have presented an advanced read recruitment plot tool that can provide a thorough and quantitative view of the natural population in a metagenome and its diversity, which represents highly useful information for several downstream analyses. Accordingly, we expect that RecruitPlotEasy will greatly facilitate microbiome research across the clinical and environmental fields and advance the toolbox for the analysis and summarization of large-scale genomic/metagenomic data and the communication of those results.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank members of the Konstantinidis Lab for their comments and suggestions on read recruitment plots through the past decade.</p>
  </ack>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>Publicly available datasets were analyzed in this study. This data can be found here: <ext-link xlink:href="https://github.com/KGerhardt/RecruitPlotEasy/tree/main/pub_data" ext-link-type="uri">https://github.com/KGerhardt/RecruitPlotEasy/tree/main/pub_data</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>KTK and LMR-R conceived and designed research; LMR-R developed the first version of the code, which was substantially revised and improved by KG and CAR-P. REC provided useful suggestions regarding calling absent genes and identifying sequence gaps. Hence, all authors listed have made a substantial, direct, and intellectual contribution to the work and approved it for publication.</p>
  </sec>
  <sec id="s7">
    <title>Funding</title>
    <p>This work has been supported by the US National Science Foundation (Award No 1759831 and 2129823)</p>
  </sec>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec id="s10">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fbinf.2021.826701/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fbinf.2021.826701/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="Image3.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM2" position="float" content-type="local-data">
      <media xlink:href="Image1.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM3" position="float" content-type="local-data">
      <media xlink:href="Image5.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM4" position="float" content-type="local-data">
      <media xlink:href="Image9.TIF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM5" position="float" content-type="local-data">
      <media xlink:href="DataSheet1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM6" position="float" content-type="local-data">
      <media xlink:href="Image8.TIF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM7" position="float" content-type="local-data">
      <media xlink:href="Image6.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM8" position="float" content-type="local-data">
      <media xlink:href="Image2.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM9" position="float" content-type="local-data">
      <media xlink:href="Image4.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM10" position="float" content-type="local-data">
      <media xlink:href="Image7.TIFF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caro-Quintero</surname><given-names>A.</given-names></name><name><surname>Konstantinidis</surname><given-names>K. T.</given-names></name></person-group> (<year>2012</year>). <article-title>Bacterial Species May Exist, Metagenomics Reveal</article-title>. <source>Environ. Microbiol.</source>
<volume>14</volume> (<issue>2</issue>), <fpage>347</fpage>–<lpage>355</lpage>. <pub-id pub-id-type="doi">10.1111/j.1462-2920.2011.02668.x</pub-id>
<pub-id pub-id-type="pmid">22151572</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conrad</surname><given-names>R.</given-names></name><name><surname>Viver</surname><given-names>T.</given-names></name><name><surname>Gago</surname><given-names>J. T.</given-names></name><name><surname>Hatt</surname><given-names>J. K.</given-names></name><name><surname>Venter</surname><given-names>F.</given-names></name><name><surname>Rosselló-Móra</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Toward Quantifying the Adaptive Role of Bacterial Pangenomes during Environmental Perturbations</article-title>. <source>ISME J.</source>
<comment>Accepted</comment>. <pub-id pub-id-type="doi">10.1038/s41396-021-01149-9</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaenicke</surname><given-names>S.</given-names></name><name><surname>Albaum</surname><given-names>S. P.</given-names></name><name><surname>Blumenkamp</surname><given-names>P.</given-names></name><name><surname>Linke</surname><given-names>B.</given-names></name><name><surname>Stoye</surname><given-names>J.</given-names></name><name><surname>Goesmann</surname><given-names>A.</given-names></name></person-group> (<year>2018</year>). <article-title>Flexible Metagenome Analysis Using the MGX Framework</article-title>. <source>Microbiome</source>
<volume>6</volume> (<issue>4</issue>), <fpage>76</fpage>. <pub-id pub-id-type="doi">10.1186/s40168-018-0460-1</pub-id>
<pub-id pub-id-type="pmid">29690922</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Konstantinidis</surname><given-names>K. T.</given-names></name><name><surname>DeLong</surname><given-names>E. F.</given-names></name></person-group> (<year>2008</year>). <article-title>Genomic Patterns of Recombination, Clonal Divergence and Environment in marine Microbial Populations</article-title>. <source>ISME J.</source>
<volume>2</volume> (<issue>10</issue>), <fpage>1052</fpage>–<lpage>1065</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2008.62</pub-id>
<pub-id pub-id-type="pmid">18580971</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meziti</surname><given-names>A.</given-names></name><name><surname>Tsementzi</surname><given-names>D.</given-names></name><name><surname>Rodriguez-R</surname><given-names>L. M.</given-names></name><name><surname>Hatt</surname><given-names>J. K.</given-names></name><name><surname>Karayanni</surname><given-names>H.</given-names></name><name><surname>Kormas</surname><given-names>K. A.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Quantifying the Changes in Genetic Diversity within Sequence-Discrete Bacterial Populations across a Spatial and Temporal Riverine Gradient</article-title>. <source>ISME J.</source>
<volume>13</volume> (<issue>3</issue>), <fpage>767</fpage>–<lpage>779</lpage>. <pub-id pub-id-type="doi">10.1038/s41396-018-0307-6</pub-id>
<pub-id pub-id-type="pmid">30397261</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname><given-names>C. S.</given-names></name><name><surname>Gao</surname><given-names>Y.</given-names></name><name><surname>Wu</surname><given-names>M.</given-names></name></person-group> (<year>2021</year>). <article-title>Re-evaluating the Evidence for a Universal Genetic Boundary Among Microbial Species</article-title>. <source>Nat. Commun.</source>
<volume>12</volume> (<issue>1</issue>), <fpage>4059</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-021-24128-2</pub-id>
<pub-id pub-id-type="pmid">34234129</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olm</surname><given-names>M. R.</given-names></name><name><surname>Crits-Christoph</surname><given-names>A.</given-names></name><name><surname>Diamond</surname><given-names>S.</given-names></name><name><surname>Lavy</surname><given-names>A.</given-names></name><name><surname>Matheus Carnevali</surname><given-names>P. B.</given-names></name><name><surname>Banfield</surname><given-names>J. F.</given-names></name></person-group> (<year>2020</year>). <article-title>Consistent Metagenome-Derived Metrics Verify and Delineate Bacterial Species Boundaries</article-title>. <source>mSystems</source>
<volume>5</volume> (<issue>1</issue>), <fpage>e00731-19</fpage>. <pub-id pub-id-type="doi">10.1128/mSystems.00731-19</pub-id>
<pub-id pub-id-type="pmid">31937678</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peña-Gonzalez</surname><given-names>A.</given-names></name><name><surname>Soto-Girón</surname><given-names>M. J.</given-names></name><name><surname>Smith</surname><given-names>S.</given-names></name><name><surname>Sistrunk</surname><given-names>J.</given-names></name><name><surname>Montero</surname><given-names>L.</given-names></name><name><surname>Páez</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Metagenomic Signatures of Gut Infections Caused by Different <italic>Escherichia coli</italic> Pathotypes</article-title>. <source>Appl. Environ. Microbiol.</source>
<volume>85</volume> (<issue>24</issue>), <fpage>e01820-19</fpage>. <pub-id pub-id-type="doi">10.1128/AEM.01820-19</pub-id>
<pub-id pub-id-type="pmid">31585992</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>J. T.</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>H.</given-names></name><name><surname>Winckler</surname><given-names>W.</given-names></name><name><surname>Guttman</surname><given-names>M.</given-names></name><name><surname>Lander</surname><given-names>E. S.</given-names></name><name><surname>Getz</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Integrative Genomics Viewer</article-title>. <source>Nat. Biotechnol.</source>
<volume>29</volume> (<issue>1</issue>), <fpage>24</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez</surname><given-names>-R.</given-names></name><name><surname>Konstantinidis</surname><given-names>K. T.</given-names></name></person-group> (<year>2016</year>). <article-title>The Enveomics Collection: a Toolbox for Specialized Analyses of Microbial Genomes and Metagenomes</article-title>. <source>PeerJ Preprints</source>, <fpage>e1900v1</fpage>. </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez-R</surname><given-names>L. M.</given-names></name><name><surname>Jain</surname><given-names>C.</given-names></name><name><surname>Conrad</surname><given-names>R. E.</given-names></name><name><surname>Aluru</surname><given-names>S.</given-names></name><name><surname>Konstantinidis</surname><given-names>K. T.</given-names></name></person-group> (<year>2021</year>). <article-title>Re-Evaluating the Evidence for a Universal Genetic Boundary Among Microbial Species</article-title>. <source>Narure Commun.</source>
<volume>12</volume> (<issue>1</issue>), <fpage>4060</fpage>. </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rusch</surname><given-names>D. B.</given-names></name><name><surname>Halpern</surname><given-names>A. L.</given-names></name><name><surname>Sutton</surname><given-names>G.</given-names></name><name><surname>Heidelberg</surname><given-names>K. B.</given-names></name><name><surname>Williamson</surname><given-names>S.</given-names></name><name><surname>Yooseph</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2007</year>). <article-title>The Sorcerer II Global Ocean Sampling Expedition: Northwest Atlantic through Eastern Tropical Pacific</article-title>. <source>Plos Biol.</source>
<volume>5</volume> (<issue>3</issue>), <fpage>e77</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.0050077</pub-id>
<pub-id pub-id-type="pmid">17355176</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Z.</given-names></name><name><surname>Niu</surname><given-names>B.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Wu</surname><given-names>S.</given-names></name><name><surname>Sun</surname><given-names>S.</given-names></name><name><surname>Li</surname><given-names>W.</given-names></name></person-group> (<year>2013</year>). <article-title>MGAviewer: a Desktop Visualization Tool for Analysis of Metagenomics Alignment Data</article-title>. <source>Bioinformatics</source>
<volume>29</volume> (<issue>1</issue>), <fpage>122</fpage>–<lpage>123</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts567</pub-id>
<pub-id pub-id-type="pmid">23044549</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
