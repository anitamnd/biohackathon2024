<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4382908</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu791</article-id>
    <article-id pub-id-type="publisher-id">btu791</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaPSICOV: combining coevolution methods for accurate prediction of contacts and long range hydrogen bonding in proteins</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jones</surname>
          <given-names>David T.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Singh</surname>
          <given-names>Tanya</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kosciolek</surname>
          <given-names>Tomasz</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tetchner</surname>
          <given-names>Stuart</given-names>
        </name>
      </contrib>
      <aff>Bioinformatics Group, Department of Computer Science, University College London, London WC1E 6BT, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu789-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Anna Tramontano</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>7</issue>
    <fpage>999</fpage>
    <lpage>1006</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Recent developments of statistical techniques to infer direct evolutionary couplings between residue pairs have rendered covariation-based contact prediction a viable means for accurate 3D modelling of proteins, with no information other than the sequence required. To extend the usefulness of contact prediction, we have designed a new meta-predictor (MetaPSICOV) which combines three distinct approaches for inferring covariation signals from multiple sequence alignments, considers a broad range of other sequence-derived features and, uniquely, a range of metrics which describe both the local and global quality of the input multiple sequence alignment. Finally, we use a two-stage predictor, where the second stage filters the output of the first stage. This two-stage predictor is additionally evaluated on its ability to accurately predict the long range network of hydrogen bonds, including correctly assigning the donor and acceptor residues.</p>
      <p><bold>Results:</bold> Using the original PSICOV benchmark set of 150 protein families, MetaPSICOV achieves a mean precision of 0.54 for top-<italic>L</italic> predicted long range contacts—around 60% higher than PSICOV, and around 40% better than CCMpred. In <italic>de novo</italic> protein structure prediction using FRAGFOLD, MetaPSICOV is able to improve the TM-scores of models by a median of 0.05 compared with PSICOV. Lastly, for predicting long range hydrogen bonding, MetaPSICOV-HB achieves a precision of 0.69 for the top-<italic>L</italic>/10 hydrogen bonds compared with just 0.26 for the baseline MetaPSICOV.</p>
      <p><bold>Availability and implementation:</bold> MetaPSICOV is available as a freely available web server at <ext-link ext-link-type="uri" xlink:href="http://bioinf.cs.ucl.ac.uk/MetaPSICOV">http://bioinf.cs.ucl.ac.uk/MetaPSICOV</ext-link>. Raw data (predicted contact lists and 3D models) and source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://bioinf.cs.ucl.ac.uk/downloads/MetaPSICOV">http://bioinf.cs.ucl.ac.uk/downloads/MetaPSICOV</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>d.t.jones@ucl.ac.uk</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Determining protein structure from its amino acid sequence remains an unsolved problem within bioinformatics (<xref rid="btu791-B6" ref-type="bibr">Dill and MacCallum, 2012</xref>). In order to make this notoriously complex goal more tractable, one simplification which can be made is to reduce the problem to identifying pairs of interacting residue pairs within the native structure, termed ‘contacts’. For many years, accurate contact prediction was hampered by the effects of the relatedness of homologous sequences and the inability to extract correct residue pairings from vastly intertwined networks of contacts (<xref rid="btu791-B5" ref-type="bibr">de Juan <italic>et al.</italic>, 2013</xref>). Recently, there has been considerable progress in reducing the effects of these two sources of noise, allowing for superior prediction accuracy (<xref rid="btu791-B27" ref-type="bibr">Taylor <italic>et al.</italic>, 2013</xref>).</p>
    <p>Current methods for contact prediction use large multiple sequence alignments to identify interacting residues through correlated mutation analysis. Extracting contacts using correlated mutation analysis exploits the observation that within protein structures, interacting residue pairs are under evolutionary pressure to maintain their interaction (<xref rid="btu791-B1" ref-type="bibr">Altschuh <italic>et al.</italic>, 1987</xref>; <xref rid="btu791-B18" ref-type="bibr">Neher, 1994</xref>; <xref rid="btu791-B22" ref-type="bibr">Poon and Chao, 2005</xref>). In the event that one residue of such an interacting pair mutates, the effect of the mutation can be accommodated by the ‘correlated’ mutation of its interacting partner. Therefore, by identifying positions within a multiple sequence alignment which appear to coevolve, it is possible to infer that these positions are in close proximity in the native protein structure.</p>
    <p>Contact maps derived from correlated mutation analyses are now of sufficient quality to enable accurate <italic>de novo</italic> structural modelling of both globular (<xref rid="btu791-B14" ref-type="bibr">Kosciolek and Jones, 2014</xref>; <xref rid="btu791-B15" ref-type="bibr">Marks <italic>et al.</italic>, 2011</xref>; <xref rid="btu791-B16" ref-type="bibr">Michel <italic>et al.</italic>, 2014</xref>) and membrane proteins (<xref rid="btu791-B9" ref-type="bibr">Hopf <italic>et al.</italic>, 2012</xref>; <xref rid="btu791-B19" ref-type="bibr">Nugent and Jones, 2012</xref>), as well as identifying residues at the interface of protein complexes (<xref rid="btu791-B21" ref-type="bibr">Ovchinnikov <italic>et al.</italic>, 2014</xref>; <xref rid="btu791-B28" ref-type="bibr">Weigt <italic>et al.</italic>, 2009</xref>). Whilst contacts are clearly useful for constraining modelling procedures, even small numbers of incorrect predictions are drastically detrimental to the modelling process (<xref rid="btu791-B13" ref-type="bibr">Konopka <italic>et al.</italic>, 2014</xref>). Despite considerable progress in the accuracy of predicted contacts from sequence, further increased precision will allow for more accurate models to be produced (<xref rid="btu791-B16" ref-type="bibr">Michel <italic>et al.</italic>, 2014</xref>).</p>
    <p>It has been shown recently that the incorporation of two different coevolution methods, based on distinct underlying principles, is able to increase the accuracy of contact prediction (<xref rid="btu791-B25" ref-type="bibr">Skwark <italic>et al.</italic>, 2013</xref>). In this study, we develop MetaPSICOV, a hybrid method that combines a classical neural network-based contact prediction method with three different coevolution methods, in order to improve the accuracy of predicted contacts from multiple sequence alignments. An additional aspect of MetaPSICOV is to modulate predictions according to both the local and global quality of the multiple sequence alignment. Thus for alignments that have little depth, either in local regions or over the entire length of the target protein, MetaPSICOV can effectively down-weight the optimal contributions that should be made by coevolution compared with more traditional features such as predicted secondary structure and solvent accessibility. This means that for poor alignments, MetaPSICOV will behave more like a standard machine learning-based contact prediction method, whereas for deep high-quality alignments more emphasis will be placed on coevolution signals.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Datasets for training and benchmarking</title>
      <p>The benchmark test set for this study is the original PSICOV test set of 150 single domain monomeric proteins with the same alignments as made publicly available back in 2011 (<xref rid="btu791-B11" ref-type="bibr">Jones <italic>et al.</italic>, 2012</xref>). To ensure full comparability with earlier work, no attempt was made to extend the alignments using more up to date sequence data banks.</p>
      <p>The neural network components of MetaPSICOV were trained on a set of 624 highly resolved protein chains with no overlap to the test set. To start with, we took a non-redundant (percent sequence identity &lt;25%) set of 1780 protein chains from PDB (<xref rid="btu791-B2" ref-type="bibr">Berman <italic>et al.</italic>, 2000</xref>) with resolution ≤1.5 Å and chain lengths between 50 and 500 residues. Overlapping proteins between the original PSICOV test set and the initial training set were identified by using HHSEARCH (<xref rid="btu791-B26" ref-type="bibr">Söding, 2005</xref>) to align test set sequences with training set HMMs. Alignments and HMMs for the training set were calculated using three iterations of HHBLITS (<xref rid="btu791-B23" ref-type="bibr">Remmert <italic>et al.</italic>, 2012</xref>) with an <italic>E</italic>-value threshold of 10<sup>−3</sup> and the March 2013 release of the UNIPROT20 HMM library. The alignments were stored in both PSICOV (<xref rid="btu791-B11" ref-type="bibr">Jones <italic>et al.</italic>, 2012</xref>) native and A3M formats. Any chain in the initial training set matching a test set sequence with an HHSEARCH E-value &lt;10<sup>−</sup><sup>3</sup> was excluded, leaving a final training and validation set of 624 chains (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S1</ext-link>).</p>
      <p>To investigate performance of MetaPSICOV on smaller protein families, we collected an additional set of PDB chains with no overlap with the training set (HHSEARCH <italic>E</italic>-value &gt;1.0), resolution ≤2.0 Å and chain lengths between 50 and 400 residues. For these protein chains, alignments were generated with HHBLITS as described above, and chains with between 50 and 500 homologous sequences were selected as the second test set. This second test set comprised 434 chains (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S2</ext-link>).</p>
      <p>Three separate coevolution calculations on the alignments were carried out using PSICOV v2.1, mean field DCA as implemented in the FreeContact package (<xref rid="btu791-B12" ref-type="bibr">Kaján <italic>et al.</italic>, 2014</xref>) and CCMpred (<xref rid="btu791-B24" ref-type="bibr">Seemayer <italic>et al.</italic>, 2014</xref>). The same alignments were used in each case, in PSICOV format for PSICOV and FreeContact and A3M format for CCMpred.</p>
      <p>In addition to the coevolution features, a number of other simple statistics are computed from the same alignments using a C program (alnstats). These statistics are listed in the feature set section below, and are divided into single alignment column-based statistics (e.g. the amino acid frequencies in each column) and pairwise column statistics (e.g. mutual information scores between each pair of columns).</p>
    </sec>
    <sec>
      <title>2.2 MetaPSICOV input features</title>
      <p>A total of 672 input features are used in the first stage classifier to predict the likelihood of residue <italic>i</italic> and <italic>j</italic> being in contact. As a starting point for input features, we considered the feature set used in the SVMcon method (<xref rid="btu791-B4" ref-type="bibr">Cheng and Baldi, 2007</xref>). Here, in both training and predicting, three windows are defined: one nine residue window centred at position <italic>i</italic>, one nine-residue window at position <italic>j</italic> and a central window of five residues at the midpoint <italic>½</italic>(<italic>i</italic> + <italic>j</italic>). At every position in each window, 21 features provide information on the amino acid composition in alignment columns <italic>i</italic>, <italic>j</italic> and <italic>½</italic>(<italic>i</italic> + <italic>j</italic>), counting gaps as the 21st amino acid type. The next four column features are the probabilities of helix, strand and coil states, and a predicted solvent accessibility in the range 0–1 (0 being completely buried and 1 being fully exposed). The secondary structure probabilities are derived from PSIPRED (<xref rid="btu791-B10" ref-type="bibr">Jones, 1999</xref>), and the solvent exposure from a derivative of PSIPRED called SOLVPRED. The final two column features are the Shannon entropy (−<italic>∑k p<sub>k</sub></italic> log <italic>p<sub>k</sub></italic>) of the alignment column and an extra input to indicate missing data, i.e. where the window exceeds the limits of the sequence.</p>
      <p>The next set of input features (six in total) provide coevolution information for each pair of alignment columns, and are as follows: mutual information, normalized mutual information (<xref rid="btu791-B7" ref-type="bibr">Dunn <italic>et al.</italic>, 2008</xref>), mean contact potential, PSICOV score, mfDCA score and CCMpred score. The mean contact potential is computed by averaging contact potential terms (<xref rid="btu791-B3" ref-type="bibr">Betancourt and Thirumalai, 1999</xref>; <xref rid="btu791-B17" ref-type="bibr">Miyazawa and Jernigan, 1985</xref>) across the two alignment columns.</p>
      <p>To encode the sequence separation |<italic>i</italic> − <italic>j</italic>|, 16 features are used to represent values in the following ranges: |<italic>i</italic> − <italic>j</italic>| &lt; 5, |<italic>i</italic> − <italic>j</italic>| = {5,6,…,13}, 14 ≤ |<italic>i</italic> − <italic>j</italic>| &lt; 18, 18 ≤ |<italic>i</italic> − <italic>j</italic>| &lt; 23, 23 ≤ |<italic>i</italic> − <italic>j</italic>| &lt; 28, 28 ≤ |<italic>i</italic> − <italic>j</italic>| &lt; 38, 38 ≤ |<italic>i</italic> − <italic>j</italic>| &lt; 48, |<italic>i</italic> − <italic>j</italic>| ≥ 48.</p>
      <p>The remaining features are derived from the whole alignment and do not depend on the window locations: global alignment amino acid composition (21 features including gap composition), global fractions of predicted secondary structure states (three features), global average-predicted solvent exposure, log sequence length, log number of sequences in the alignment, log effective number of sequences in the alignment and global average Shannon entropy. Effective sequence counts were calculated by clustering protein sequences with a 62% sequence identity threshold, and then assigning equal fractional weights (<italic>w<sub>i</sub> = </italic>1/<italic>n</italic>) to sequences in each cluster, where <italic>n</italic> is the cluster size. Effective sequence counts are then calculated as <italic>N</italic><sub>eff</sub> = ∑<italic>w<sub>i</sub></italic>. A summary table of the features used is given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S3</ext-link>.</p>
      <p>For the second stage classifier, which correlates the outputs of the first stage classifier, a total of 731 input features are used. In this case, two windows of 11 alignment columns are defined at location <italic>i,</italic>
<italic>j</italic>, though the central window is omitted in this case. The same column features defined for the first stage classifier are also used for the two windows in the second stage. In addition the same sequence separation features are included. The remaining 121 features comprised an 11 × 11 matrix of values, centred at location <italic>i,</italic>
<italic>j</italic> which are taken from the relevant outputs of the first stage (summarized in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S3</ext-link>). This matrix therefore represents a 2D (square) window on the first stage predicted contact map, and thus allows a refined contact map to be generated by taking into account correlations between nearby predicted contacts from the first stage network. This second stage also allows us to predict other kinds of inter-residue interactions, e.g. main chain hydrogen bonding, as described later.</p>
    </sec>
    <sec>
      <title>2.3 Neural network architectures and training procedure</title>
      <p>Both first and second stage classifiers are classic feed-forward neural networks, with 55 hidden units and a single output unit. To train these very large networks, alternate rounds of offline and online training are carried out until no further improvement in accuracy is obtained on a separate validation set, which comprises 10% of the original training data.</p>
      <p>The classification of residues as contacting (true positive) or non-contacting (true negative) was made by calculating Cβ–Cβ distances in the protein chains, with different thresholds. For glycine residues, the Cα position was used in place of the Cβ. In final benchmarking, only the usual threshold of 8 Å was used, but in training we used five different contact distance thresholds: 6, 7.5, 8, 8.5 and 10 Å. An additional criterion that was used was to set a threshold distance of 8 Å, but then only consider negatives where the distance exceeded a second threshold of 11 Å. In this latter case, residue pairs with an intermediate distance were excluded from the training process. Each of these six thresholds was used to generate a separate neural net and in making a prediction, the outputs of the six networks are combined by averaging. As Cβ–Cβ contacts are symmetric, for each <italic>L</italic> residue protein chain in the training set, ½<italic>L</italic>(<italic>L</italic> − 1) residue pairs are considered in testing and training.</p>
      <p>The training data are obviously highly unbalanced given that only around 5% of residue pairs make contacts in a typical protein fold. However, we find that subsequent calibration of the network outputs is a better way of handling this bias than either undersampling negative cases or oversampling the positive cases. Once the network training is complete, the outputs can be transformed to estimated Positive Predictive Values (PPVs) by a log-linear function:
<disp-formula><mml:math id="MM1"><mml:mrow><mml:mi>PPV</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>a</italic>, <italic>b</italic> and <italic>c</italic> are adjustable parameters obtained by least-squares fitting to the observed PPVs when the training data are re-presented to the networks and binned according to neural network output score (<italic>x</italic>).</p>
    </sec>
    <sec>
      <title>2.4 MetaPSICOV-HB</title>
      <p>By a small modification to the second stage classifier and the training scheme, it is straightforward to develop an additional predictor which can specifically predict main chain hydrogen bonding patterns rather than generic residue–residue contacts. In this case, positive cases will be residue pairs where the first residue acts as donor for a backbone hydrogen bond (N–H···O = C) to the other. In this case, the relevant contact is directional and so the resulting contact map can no longer be assumed to be symmetric. In antiparallel sheets, of course, a symmetric pair of contacts can occur, as a bridged pair of residues will be involved in two hydrogen bonds going in opposite directions.</p>
      <p>In training and testing, we arbitrarily assign the donor role to residue <italic>i</italic> and the acceptor role to residue <italic>j</italic>, and a true positive is only considered where the amino nitrogen in <italic>i</italic> is within 3.5 Å of the carbonyl oxygen in <italic>j</italic>. No attempt was made to reconstruct the amide hydrogen positions as for main chain hydrogen bonds in highly resolved proteins, the heavy atom distance criterion is generally sufficient on its own to determine whether an energetically favourable hydrogen bond is formed. Short range (sequence separation &lt;5) hydrogen bonds are not considered because these mostly relate to alpha helices and can be trivially inferred from secondary structure prediction alone, and so the sequence separation binary input for the |<italic>i</italic> − <italic>j</italic>| &lt; 5 case was replaced by a binary feature which simply indicates pairs where <italic>i</italic> &gt; <italic>j</italic>, which is needed because pairs <italic>i,</italic>
<italic>j</italic> and <italic>j,</italic>
<italic>i</italic> can no longer be considered equivalent.</p>
    </sec>
    <sec>
      <title>2.5 Folding simulations</title>
      <p>To evaluate the usefulness of MetaPSICOV contacts in <italic>de novo</italic> protein structure prediction, we carried out a benchmark on contact-assisted fragment assembly using FRAGFOLD (<xref rid="btu791-B29" ref-type="bibr">Jones <italic>et al.</italic>, 2005</xref>). Details of the benchmark have already been described (<xref rid="btu791-B14" ref-type="bibr">Kosciolek and Jones, 2014</xref>), where we evaluated the usefulness of PSICOV contacts in assisting <italic>de novo</italic> protein structure prediction. Two slight modifications were made here. First, a slightly revised FRAGFOLD energy function is used, with short range (|<italic>i</italic> − <italic>j</italic>| &lt; 23) and long range contacts treated as two separate equally weighted energy terms. Second, to select a single representative model from each ensemble, the model with the lowest total FRAGFOLD energy was selected. This is a more conservative selection procedure than our previous study, where we took the best model from the five lowest energy models, but this more closely represents the way in which models would be selected in practice.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <p>The accuracies of MetaPSICOV and the component methods were evaluated on the widely-used benchmark dataset of 150 proteins used to test the original PSICOV algorithm (<xref rid="btu791-B11" ref-type="bibr">Jones <italic>et al.</italic>, 2012</xref>). <xref ref-type="fig" rid="btu791-F1">Figure 1</xref> shows the relative overlap between the three component coevolution methods applied to this set, which clearly demonstrates the value of a three-way consensus, with at least 10% of correct contacts (13% in the case of CCMpred) being unique to each method.
<fig id="btu791-F1" position="float"><label>Fig. 1.</label><caption><p>Distribution of predictions for 9678 observed true contacts, as predicted by PSICOV, DCA and CCMpred. Data are the top <italic>L</italic>/2 correct contact predictions from each method (for sequence separation &gt;=5 residues), for a set of 150 Pfam families (<xref rid="btu791-B11" ref-type="bibr">Jones <italic>et al.</italic>, 2012</xref>)</p></caption><graphic xlink:href="btu791f1p"/></fig>
</p>
    <p>The analysis of results is divided into two parts, based on the sequence separation of predicted pairs, as contact predictions between residue pairs lying far apart in the sequence are more difficult to predict than the ones closer in sequence separation. With this in mind, mean precision scores are given at sequence separation ≥5 and ≥23 residues, respectively. Two residues are considered to be in contact with each other if the Cβ–Cβ distance is &lt;8 Å, which is in accordance with the standard assessment procedure introduced in the Critical Assessment of protein Structure Prediction experiment (<xref rid="btu791-B8" ref-type="bibr">Ezkurdia <italic>et al.</italic>, 2009</xref>). <xref ref-type="table" rid="btu791-T1">Table 1</xref> depicts the mean precision values obtained for different methods including PSICOV, DCA, CCMpred and both stages of MetaPSICOV for the top-<italic>L</italic>/10, top-<italic>L</italic>/5, top-<italic>L</italic>/2 and top-<italic>L</italic> contacts where <italic>L</italic> is the length of the target protein, the thresholds used commonly in contact prediction assessment methods, for sequence separation ≥5 and ≥23 simultaneously (<xref rid="btu791-B8" ref-type="bibr">Ezkurdia <italic>et al.</italic>, 2009</xref>).
<table-wrap id="btu791-T1" position="float"><label>Table 1.</label><caption><p>Mean precision values for the top-<italic>L</italic>, top-<italic>L</italic>/2, top-<italic>L</italic>/5 and top-<italic>L</italic>/10 contacts, <italic>L</italic> = length of target protein, at different sequence separation ranges <italic>i</italic> − <italic>j</italic> ≥ 5 and <italic>i</italic> − <italic>j</italic> ≥ 23, where the Cβ–Cβ distance &lt;8 Å</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1"/><th colspan="4" align="center" rowspan="1">[<italic>i</italic> − <italic>j</italic>] ≥ 5<hr/></th><th colspan="4" align="center" rowspan="1">[<italic>i</italic> − <italic>j</italic>] ≥ 23<hr/></th></tr><tr><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1"><italic>L</italic>/2</th><th rowspan="1" colspan="1"><italic>L</italic>/5</th><th rowspan="1" colspan="1"><italic>L</italic>/10</th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1"><italic>L</italic>/2</th><th rowspan="1" colspan="1"><italic>L</italic>/5</th><th rowspan="1" colspan="1"><italic>L</italic>/10</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Net only</td><td rowspan="1" colspan="1">0.37</td><td rowspan="1" colspan="1">0.41</td><td rowspan="1" colspan="1">0.52</td><td rowspan="1" colspan="1">0.66</td><td rowspan="1" colspan="1">0.25</td><td rowspan="1" colspan="1">0.32</td><td rowspan="1" colspan="1">0.40</td><td rowspan="1" colspan="1">0.43</td></tr><tr><td rowspan="1" colspan="1">PSICOV</td><td rowspan="1" colspan="1">0.45</td><td rowspan="1" colspan="1">0.60</td><td rowspan="1" colspan="1">0.73</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1">0.34</td><td rowspan="1" colspan="1">0.48</td><td rowspan="1" colspan="1">0.65</td><td rowspan="1" colspan="1">0.73</td></tr><tr><td rowspan="1" colspan="1">DCA</td><td rowspan="1" colspan="1">0.45</td><td rowspan="1" colspan="1">0.56</td><td rowspan="1" colspan="1">0.66</td><td rowspan="1" colspan="1">0.72</td><td rowspan="1" colspan="1">0.36</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">0.64</td><td rowspan="1" colspan="1">0.71</td></tr><tr><td rowspan="1" colspan="1">CCMpred</td><td rowspan="1" colspan="1">0.52</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">0.77</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">0.39</td><td rowspan="1" colspan="1">0.55</td><td rowspan="1" colspan="1">0.71</td><td rowspan="1" colspan="1">0.76</td></tr><tr><td rowspan="1" colspan="1">Consensus only</td><td rowspan="1" colspan="1">0.51</td><td rowspan="1" colspan="1">0.65</td><td rowspan="1" colspan="1">0.77</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">0.39</td><td rowspan="1" colspan="1">0.54</td><td rowspan="1" colspan="1">0.70</td><td rowspan="1" colspan="1">0.77</td></tr><tr><td rowspan="1" colspan="1">PconsC</td><td rowspan="1" colspan="1">0.56</td><td rowspan="1" colspan="1">0.69</td><td rowspan="1" colspan="1">0.77</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1">0.46</td><td rowspan="1" colspan="1">0.62</td><td rowspan="1" colspan="1">0.75</td><td rowspan="1" colspan="1">0.80</td></tr><tr><td rowspan="1" colspan="1">MetaPSICOV (stage 1)</td><td rowspan="1" colspan="1">0.66</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">0.47</td><td rowspan="1" colspan="1">0.63</td><td rowspan="1" colspan="1">0.78</td><td rowspan="1" colspan="1">0.85</td></tr><tr><td rowspan="1" colspan="1">MetaPSICOV (stage 2)</td><td rowspan="1" colspan="1">0.71</td><td rowspan="1" colspan="1">0.83</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">0.54</td><td rowspan="1" colspan="1">0.70</td><td rowspan="1" colspan="1">0.83</td><td rowspan="1" colspan="1">0.88</td></tr></tbody></table></table-wrap></p>
    <p>To allow the relative contributions of individual components to be gauged, various subsets of features were also evaluated. The main subsets are shown in <xref ref-type="table" rid="btu791-T1">Table 1</xref>, and some additional subsets in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S4</ext-link>.</p>
    <p>The worst performing subset is unsurprisingly the subset excluding the three coevolution methods, though the true positive rate, even in this case, is far from negligible. One surprise is that a pure consensus (‘Consensus only’) of the coevolution methods performs no better than the best single method (CCMpred). This suggests that the additional features in MetaPSICOV are vital in correctly deciding the relative weighting to assign to the different coevolution inputs. A network without any of the coevolution inputs (‘Net only’) performs very poorly on long range contacts, though when shorter range contacts are included, a reasonable level of prediction accuracy is obtained.</p>
    <p>The seven different combinations of coevolution methods are evaluated in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S4</ext-link>, where it can be seen that a combination of all three methods performs optimally.</p>
    <p><xref ref-type="fig" rid="btu791-F2">Figure 2</xref> shows the overall performance of MetaPSICOV in terms of its mean precision, both after the first stage and the second filtering stage. For comparison, results for CCMpred (<xref rid="btu791-B24" ref-type="bibr">Seemayer <italic>et al.</italic>, 2014</xref>), PSICOV (<xref rid="btu791-B11" ref-type="bibr">Jones <italic>et al.</italic>, 2012</xref>) and DCA (<xref rid="btu791-B15" ref-type="bibr">Marks <italic>et al.</italic>, 2011</xref>) are also shown. Clearly, both stages of MetaPSICOV significantly outperform the other methods at both sequence separation ranges and all four contact subsets. To see this in more detail, <xref ref-type="fig" rid="btu791-F3">Figure 3</xref> shows a scatter plot between the mean <italic>L</italic>/2 precision against the three component coevolution methods. Again, MetaPSICOV shows substantially higher accuracy precisions than any of the other tested component methods in almost every case.
<fig id="btu791-F2" position="float"><label>Fig. 2.</label><caption><p>Mean precision of contact prediction against increasing number of predicted pairs for (<bold>a</bold>) sequence separation ≥5, (<bold>b</bold>) for sequence separation ≥23 and (<bold>c</bold>) for sequence separation ≥23 with redundant contact predictions excluded (see text for details)</p></caption><graphic xlink:href="btu791f2p"/></fig>
<fig id="btu791-F3" position="float"><label>Fig. 3.</label><caption><p>MetaPSICOV top-<italic>L</italic>/2 precision plotted against (<bold>a</bold>) PSICOV precision, (<bold>b</bold>) DCA precision and (<bold>c</bold>) CCMpred precision for sequence separation ≥5 (line <italic>x</italic> = <italic>y</italic> shown for reference)</p></caption><graphic xlink:href="btu791f3p"/></fig>
</p>
    <p>To check for possible bias from very distant relationships between domains in the training set and domains in the testing set that could not be detected by HMM–HMM comparison, we recalculated the performance of MetaPSICOV on a subset of the PSICOV training set with no domain superfamilies in common with the training set, according to the CATH structure-based classification (release 4.0; <xref rid="btu791-B20" ref-type="bibr">Orengo <italic>et al.</italic>, 1997</xref>). This additional constraint reduces the PSICOV test set from 150 to 101 proteins (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S5a</ext-link>). Using a standard <italic>t</italic> test, for all mean precision values calculated for MetaPSICOV, no significant differences were observed after further structure-based cross-validation (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Tables S5b</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">S5c</ext-link>).</p>
    <p>One aspect of contact prediction assessment that is typically ignored is the relative redundancy between different predicted contact maps. Let us suppose that we already know that there is a contact between residues <italic>i</italic> and <italic>j</italic> in a particular protein. Without even looking at the structure or making a calculation we can guess that residues in the immediate sequence neighbourhood of this contacting pair (<italic>i</italic> + 1, <italic>j</italic> − 1 for example) are also likely to be in contact. Of course not all of these contacts in the immediate neighbourhood will be correct, and the exact pattern will depend on whether the chain segments are in beta sheets and then in a parallel or antiparallel conformation. Nevertheless, it is fair to say that pairs of contacts that are close together along the chain can be considered somewhat redundant in terms of predicting the overall chain fold.</p>
    <p>To evaluate the effects of redundancy on our comparison of methods, we recalculated the benchmark results after filtering out any lower scoring predicted contacts that are immediately adjacent (<italic>i</italic> ± 1, <italic>j</italic> ± 1) to any higher scoring predictions. Filtering was applied to both correct and incorrect contacts; therefore, methods are on the one hand not credited for making multiple adjacent correct contact predictions, and on the other hand, not multiply penalized for making adjacent incorrect predictions. This is admittedly a very conservative benchmarking strategy, as neighbouring contacts clearly have at least some additional value in constraining the chain fold, but their value is clearly much less than unique long range contacts that are correctly predicted. <xref ref-type="fig" rid="btu791-F2">Figure 2</xref>c shows the impact of excluding multiple predicted adjacent contacts. Firstly, it is clear that all the methods are much more similar in terms of overall performance. Furthermore, at least some of the differences between the component methods derive from more redundant contacts. MetaPSICOV still outperforms the other methods, albeit with a reduced margin, but there is now no difference between the first and second stage classifiers. This is entirely unsurprising, as the whole point of the second stage network is to analyze the neighbourhood of predicted contacts from the first stage network in order to add missed contacts or remove spurious predictions.</p>
    <p>As a final test, we tested MetaPSICOV on a set of target proteins with much smaller sequence families than the original PSICOV test set (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S2</ext-link>). <xref ref-type="fig" rid="btu791-F4">Figure 4</xref> summarizes the results for MetaPSICOV compared with the trivial consensus of covariation methods and the traditional contact prediction (network-only) results (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Fig. S1</ext-link> for related plots of top <italic>L</italic>/5, <italic>L</italic>/2 and <italic>L</italic> contacts). Here it is evident that, as expected, MetaPSICOV relies heavily on the traditional contact prediction features where few sequences are available, but steadily increases weight on the covariation data as the number of effective sequences approaches 200. Another interesting point is that performance of MetaPSICOV with 200 effective sequences is roughly the same as the best individual covariation-based method with a median effective sequence count of 621 (the median for the original PSICOV test set). Thus, MetaPSICOV is able to extend the usefulness of covariation-based contact prediction to significantly smaller families than those that have been the focus of earlier studies.
<fig id="btu791-F4" position="float"><label>Fig. 4.</label><caption><p>All contacts (<bold>a</bold>) and long-range contacts (<bold>b</bold>) top-<italic>L</italic>/10 mean precision for alignments with varying numbers of effective sequences (<italic>N</italic><sub>eff</sub>)</p></caption><graphic xlink:href="btu791f4p"/></fig>
</p>
    <p>It is of course of interest to compare MetaPSICOV with the recently published coevolution-based contact metapredictor, PconsC. Although the general idea of combining multiple coevolution methods is the same in both cases, the philosophy behind the ways in which variation in alignment quality is taken into account is substantially different. In the case of PconsC, to achieve maximum performance a set of eight different alignments are required, from two different alignment methods and four parameters settings in each case. In the case of MetaPSICOV, however, a single alignment is used, but is supplemented by an array of features which describe the local and global quality of the given alignment. As both methods make use of the same testing set of 150 proteins used in testing PSICOV, it is also possible to make at least a rough quantitative comparison between them. One slight complication is that PconsC does not make use of the original PSICOV alignments, but instead uses several combined alignments that clearly will include more up-to-date sequence data. That being said, MetaPSICOV still appears to perform well in comparison to PconsC, as can be seen in <xref ref-type="table" rid="btu791-T1">Table 1</xref>.</p>
    <p>The fact that MetaPSICOV can achieve better results than PconsC without requiring sets of alignments to be generated from different methods and different runtime parameters is clearly advantageous in terms of convenience and reduced computation. This also possibly insulates MetaPSICOV from systematic changes in both the underlying sequence data banks and the alignment methods as time goes on. However, it is certainly worth considering that MetaPSICOV might be further improved by also being trained on a range of alignments, and this is something that we may explore in the future.</p>
    <p>The mean precision scores for MetaPSICOV-HB and a naïve method based on the standard MetaPSICOV algorithm for the top-<italic>L</italic>/10 contacts is reported in <xref ref-type="table" rid="btu791-T2">Table 2</xref>. The top-<italic>L</italic>/10 contacts are chosen in this case as there are significantly fewer long range hydrogen bonds in proteins compared with general long range contacts. For the naïve method, any top-<italic>L</italic>/10 contact predicted by MetaPSICOV between residues in predicted beta strands is assumed to be a donor/acceptor pair, but with the donor–acceptor labelling being ignored. For MetaPSICOV-HB, however, only correctly labelled donor–acceptor pairs are counted as true positives. <xref ref-type="table" rid="btu791-T2">Table 2</xref> clearly shows the added value that MetaPSICOV-HB gives over the standard method when predicting the hydrogen bonding networks in proteins, with a mean precision value 0.69 for long range hydrogen bonds compared to 0.26 for the naïve method. This additional information on the directions of hydrogen-bonded residue pairs could be invaluable in improving the quality of models produced by <italic>de novo</italic> methods, though finding the optimal way to use this information will take some effort.
<table-wrap id="btu791-T2" position="float"><label>Table 2.</label><caption><p>Mean precision values for the Top-<italic>L</italic>/10 predicted main chain hydrogen bonds at different sequence separation ranges, where residue <italic>i</italic> donates a main chain hydrogen bond to residue <italic>j</italic> (N–H···O = C distance &lt;3.5 Å)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1"/><th rowspan="1" colspan="1">[<italic>i</italic> − <italic>j</italic>] ≥ 5</th><th rowspan="1" colspan="1">[<italic>i</italic> − <italic>j</italic>] ≥ 23</th></tr><tr><th rowspan="1" colspan="1"><italic>L</italic>/10</th><th rowspan="1" colspan="1"><italic>L</italic>/10</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MetaPSICOV</td><td rowspan="1" colspan="1">0.43</td><td rowspan="1" colspan="1">0.26</td></tr><tr><td rowspan="1" colspan="1">MetaPSICOV-HB</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">0.69</td></tr></tbody></table><table-wrap-foot><fn id="btu791-TF1"><p>The 17 mainly helical targets with fewer than <italic>L</italic>/10 true hydrogen bonds were omitted from this analysis.</p></fn></table-wrap-foot></table-wrap></p>
    <p>The last part of this study involves evaluating the use of MetaPSICOV contact constraints for improving <italic>de novo</italic> protein structure models. For each of the 150 benchmark proteins, 20 models were generated by FRAGFOLD using three different predicted contact sets: PSICOV, MetaPSICOV stage 1 and MetaPSICOV stage 2 contacts (9000 models in total). To ensure that all useful contact information was being used, each contact list was cut off at a precision threshold of 0.5, i.e. all the contacts used were estimated to have a &gt;0.5 probability of being correct.</p>
    <p>Without any contact constraints, the median TM-score for FRAGFOLD without contact constraints is 0.27, compared with 0.41 for PSICOV, 0.46 for the first stage MetaPSICOV contacts and 0.43 for the second stage contacts. <xref ref-type="fig" rid="btu791-F5">Figure 5</xref> shows the distributions of TM-score differences between the PSICOV representative models and the MetaPSICOV models from each target ensemble. Scatter plots for each comparison along with the underlying data are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Figure S2 and</ext-link>
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu791/-/DC1">Supplementary Table S6</ext-link>. For 108 targets out of 150, the first stage MetaPSICOV contacts produce better models than PSICOV with a median improvement of 0.05 TM score units. For 40 targets, however, the improvement is quite substantial with an improvement of at least 0.1 TM units. Surprisingly, given that more correct long range contacts are included in the second stage contact lists, results are slightly worse than those from the first stage, with only 99 targets showing an improvement, and a median improvement of only 0.02 TM units. Although this looks puzzling at first glance, the explanation is almost certainly down to the same redundancy issue that has been described previously. Suppose we were to predict the full set of contacts between a pair of hydrogen-bonded beta strands, but just two contacts between a pair of helices elsewhere in the structure. The additional contacts along the strands are not particularly informative as most derive purely from the regular hydrogen bonding pattern. In this case, therefore, correctly modelling the beta strand pairing might satisfy five times as many constraints as correctly modelling the pair of helices, even though the helices may contribute far more to the overall model TM score. Consequently, the global optimization procedure is likely to be strongly biased towards satisfying the beta strand constraints rather than the constraints between the helices in this hypothetical case. Note that this is only an issue because the contact constraints are probabilistic in nature. If all the constraints were real, then it is obvious that the best possible model would then result from simply satisfying all of the contacts.
<fig id="btu791-F5" position="float"><label>Fig. 5.</label><caption><p>Differences in mean TM-scores for the 150 benchmark proteins obtained by FRAGFOLD using (<bold>a</bold>) MetaPSICOV stage 1 contacts and (<bold>b</bold>) MetaPSICOV stage 2 contacts compared with PSICOV contacts</p></caption><graphic xlink:href="btu791f5p"/></fig>
</p>
    <p>By analyzing the test set by fold class (α, αβ and β) we see some support for this hypothesis. Ignoring the 10 targets with few secondary structures, for the 16 all-α targets, a positive median TM-score difference of 0.04 is indeed observed between the first and second stage results, whereas for the 93 αβ and α + β targets a median difference of −0.05 is observed. For the 31 all-β targets no difference is observed.</p>
    <p>Although the sample sizes make firm conclusions impossible, these results do suggest that appropriate balancing between α-helix and β-sheet contacts is needed to exploit the second stage predicted contacts properly. Not only do short range contacts need to be separated from long range contacts (as we already do), but the redundancy in 3D constraints between neighbouring contacts also needs to be considered in an ideal weighting scheme. How this should best be done is as yet unclear. It would obviously be easy to exclude neighbouring contacts as shown in <xref ref-type="fig" rid="btu791-F2">Figure 2</xref>c, but then the additional information would just be lost. A better approach may be to cluster the contacts into groups, according to secondary structure and sequence separation, perhaps, and then apply a suitable weighting to each cluster.</p>
  </sec>
  <sec>
    <title/>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Although recent developments in algorithms to determine coevolution patterns in large multiple sequence alignments have created a lot of excitement in structural bioinformatics, coevolution alone is clearly not enough to derive all of the likely contacts in a protein structure. Although it is an impressive feat to deduce distance constraints purely from a statistical analysis of a multiple sequence alignment, it is evident that other sources of information can also contribute to producing more accurate-predicted contact maps. It makes no sense to limit one’s analysis solely to one source of information and ignore other sources, albeit sources that are weaker predictors in their own right.</p>
    <p>MetaPSICOV is an effective hybrid of a fairly standard machine learning-based contact prediction method with three state-of-the-art coevolution-based methods. The neural network is able to make a balanced decision between the coevolution signals and the generic structural features that provide orthogonal information on the likelihood of residue pairs making a contact. For target proteins with poor quality or sparse multiple sequence alignments, the appropriate strategy is to de-emphasize coevolution in favour of generic structural features, but where sufficient homologous sequences are available, the overwhelming value of coevolution is clear.</p>
    <p>Compared with the best single coevolution method, MetaPSICOV achieves a precision that is 38% higher than the best individual coevolution method (CCMpred) for the top-<italic>L</italic> long range contacts. Furthermore, the mean precision for MetaPSICOV of 0.54 indicates that correct predicted contacts are more likely than incorrect contacts, which is an important performance threshold in terms of accurate 3D model building from predicted contacts (<xref rid="btu791-B9" ref-type="bibr">Hopf <italic>et al.</italic>, 2012</xref>; <xref rid="btu791-B14" ref-type="bibr">Kosciolek and Jones, 2014</xref>; <xref rid="btu791-B15" ref-type="bibr">Marks <italic>et al.</italic>, 2011</xref>; <xref rid="btu791-B16" ref-type="bibr">Michel <italic>et al.</italic>, 2014</xref>; <xref rid="btu791-B19" ref-type="bibr">Nugent and Jones, 2012</xref>).</p>
    <p>One of the more interesting observations has been the apparent effect of redundancy in predicted contacts. By constructing a two-stage classifier it is possible to produce a more accurate contact predictor, but at the expense of biasing the distribution of contacts to regions of the protein where adjacent contacts are made (beta sheets). Although benchmarks clearly show that more correct contacts are predicted by the second stage of the MetaPSICOV, the added bias in fact results in generally poorer 3D models when the contacts are used for <italic>de novo</italic> structure prediction using FRAGFOLD. Better contact constraint scoring functions, which more evenly weight contact constraints according to both sequence separation and neighbourhood density, are needed to deal with this problem.</p>
    <p>Comparing MetaPSICOV to PconsC, another published coevolution-based consensus contact predictor, MetaPSICOV, evidently outperforms the earlier method on the same benchmark set. However, there are interesting aspects of PconsC that are not currently considered within the MetaPSICOV feature set, e.g. features from sampling more than one sequence alignment from different methods or alignment parameters. Consequently, even better hybrid methods may be envisaged by considering even larger feature spaces.</p>
    <p>Finally we show that it is possible to apply MetaPSICOV to predicting not just contacting residue pairs, but explicitly identifying donor/acceptor pairings in beta sheets. By combining the accurate prediction of side chain contacts with this much more discriminating structural information, it should be possible to greatly enhance the quality of <italic>de novo</italic> modelling in beta-sheet rich target proteins.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study was funded by the <funding-source>Biotechnology and Biological Sciences Research Council</funding-source> [grant number <award-id>BB/L018330/1</award-id>; T.S. and D.T.J.] and the <funding-source>Wellcome Trust</funding-source> [grant number <award-id>096624/Z/11/Z</award-id> to T.K. and grant number <award-id>096622/Z/11/Z</award-id> to S.T.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_7_999__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu791_btu791-metapsicov_supplementary_v1_0.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btu791-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschuh</surname><given-names>D.</given-names></name><etal/></person-group> (<year>1987</year>) <article-title>Correlation of co-ordinated amino acid substitutions with function in viruses related to tobacco mosaic virus.</article-title>
<source>J. Mol. Biol.</source>, <volume>193</volume>, <fpage>693</fpage>–<lpage>707</lpage>.<pub-id pub-id-type="pmid">3612789</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>H.M.</given-names></name><etal/></person-group> (<year>2000</year>) <article-title>The protein data bank.</article-title>
<source>Nucleic Acids Res.</source>, <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Betancourt</surname><given-names>M.R.</given-names></name><name><surname>Thirumalai</surname><given-names>D</given-names></name></person-group> (<year>1999</year>) <article-title>Pair potentials for protein folding: choice of reference states and sensitivity of predicted native states to variations in the interaction schemes.</article-title>
<source>Protein Sci.</source>, <volume>8</volume>, <fpage>361</fpage>–<lpage>369</lpage>.<pub-id pub-id-type="pmid">10048329</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>J.</given-names></name><name><surname>Baldi</surname><given-names>P</given-names></name></person-group> (<year>2007</year>) <article-title>Improved residue contact prediction using support vector machines and a large feature set.</article-title>
<source>BMC Bioinformatics</source>, <volume>8</volume>, <fpage>113</fpage>.<pub-id pub-id-type="pmid">17407573</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Juan</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Emerging methods in protein co-evolution.</article-title>
<source>Nat. Rev. Genet.</source>, <volume>14</volume>, <fpage>249</fpage>–<lpage>261</lpage>.<pub-id pub-id-type="pmid">23458856</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dill</surname><given-names>K.A.</given-names></name><name><surname>MacCallum</surname><given-names>J.L</given-names></name></person-group> (<year>2012</year>) <article-title>The protein-folding problem, 50 years on.</article-title>
<source>Science</source>, <volume>338</volume>, <fpage>1042</fpage>–<lpage>1046</lpage>.<pub-id pub-id-type="pmid">23180855</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>S.D.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction.</article-title>
<source>Bioinformatics</source>, <volume>24</volume>, <fpage>333</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">18057019</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ezkurdia</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Assessment of domain boundary predictions and the prediction of intramolecular contacts in CASP8.</article-title>
<source>Proteins</source>, <volume>77</volume>, <fpage>196</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">19714769</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname><given-names>T.A.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Three-dimensional structures of membrane proteins from genomic sequencing.</article-title>
<source>Cell</source>, <volume>149</volume>, <fpage>1607</fpage>–<lpage>1621</lpage>.<pub-id pub-id-type="pmid">22579045</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T</given-names></name></person-group> (<year>1999</year>) <article-title>Protein secondary structure prediction based on position-specific scoring matrices.</article-title>
<source>J. Mol. Biol.</source>, <volume>292</volume>, <fpage>195</fpage>–<lpage>202</lpage>.<pub-id pub-id-type="pmid">10493868</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Prediction of novel and analogous folds using fragment assembly and fold recognition</article-title>. <source>PROTEINS: Structure, Function, and Bioinformatics</source>, <volume>61</volume>, <fpage>143</fpage>–<lpage>151</lpage>.</mixed-citation>
    </ref>
    <ref id="btu791-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments.</article-title>
<source>Bioinformatics</source>, <volume>28</volume>, <fpage>184</fpage>–<lpage>190</lpage>.<pub-id pub-id-type="pmid">22101153</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaján</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>FreeContact: fast and free software for protein contact prediction from residue co-evolution.</article-title>
<source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>85</fpage>.<pub-id pub-id-type="pmid">24669753</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Konopka</surname><given-names>B.M.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Automated procedure for contact-map-based protein structure reconstruction.</article-title>
<source>J. Membrane Biol.</source>, <volume>247</volume>, <fpage>409</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">24682239</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosciolek</surname><given-names>T.</given-names></name><name><surname>Jones</surname><given-names>D.T</given-names></name></person-group> (<year>2014</year>) <article-title>De novo structure prediction of globular proteins aided by sequence variation-derived contacts.</article-title>
<source>PLoS ONE</source>, <volume>9</volume>, <fpage>e92197</fpage>.<pub-id pub-id-type="pmid">24637808</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marks</surname><given-names>D.S.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Protein 3D structure computed from evolutionary sequence variation.</article-title>
<source>PLoS ONE</source>, <volume>6</volume>, <fpage>e28766</fpage>.<pub-id pub-id-type="pmid">22163331</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michel</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>PconsFold: improved contact predictions improve protein models.</article-title>
<source>Bioinformatics</source>, <volume>30</volume>, <fpage>i482</fpage>–<lpage>i488</lpage>.<pub-id pub-id-type="pmid">25161237</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyazawa</surname><given-names>S.</given-names></name><name><surname>Jernigan</surname><given-names>R.L</given-names></name></person-group> (<year>1985</year>) <article-title>Estimation of effective interresidue contact energies from protein crystal structures: quasi-chemical approximation.</article-title>
<source>Macromolecules</source>, <volume>18</volume>, <fpage>534</fpage>–<lpage>552</lpage>.</mixed-citation>
    </ref>
    <ref id="btu791-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neher</surname><given-names>E</given-names></name></person-group> (<year>1994</year>) <article-title>How frequent are correlated changes in families of protein sequences?</article-title>
<source>Proc. Natl Acad. Sci. USA</source>, <volume>91</volume>, <fpage>98</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">8278414</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nugent</surname><given-names>T.</given-names></name><name><surname>Jones</surname><given-names>D.T</given-names></name></person-group> (<year>2012</year>) <article-title>Accurate de novo structure prediction of large transmembrane protein domains using fragment-assembly and correlated mutation analysis.</article-title>
<source>Proc. Natl Acad. Sci. USA</source>, <volume>109</volume>, <fpage>E1540</fpage>–<lpage>E1547</lpage>.<pub-id pub-id-type="pmid">22645369</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orengo</surname><given-names>C.A.</given-names></name><etal/></person-group> (<year>1997</year>) <article-title>CATH—a hierarchic classification of protein domain structures.</article-title>
<source>Structure</source>, <volume>5</volume>, <fpage>1093</fpage>–<lpage>1109</lpage>.<pub-id pub-id-type="pmid">9309224</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ovchinnikov</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Robust and accurate prediction of residue–residue interactions across protein interfaces using evolutionary information.</article-title>
<source>eLife</source>, <volume>3</volume>,<fpage> e02030</fpage>.<pub-id pub-id-type="pmid">24842992</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poon</surname><given-names>A.</given-names></name><name><surname>Chao</surname><given-names>L</given-names></name></person-group> (<year>2005</year>) <article-title>The rate of compensatory mutation in the DNA bacteriophage φX174.</article-title>
<source>Genetics</source>, <volume>170</volume>, <fpage>989</fpage>–<lpage>999</lpage>.<pub-id pub-id-type="pmid">15911582</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Remmert</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM–HMM alignment.</article-title>
<source>Nat. Methods</source>, <volume>9</volume>, <fpage>173</fpage>–<lpage>175</lpage>.<pub-id pub-id-type="pmid">22198341</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemayer</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>CCMpred—fast and precise prediction of protein residue–residue contacts from correlated mutations.</article-title>
<source>Bioinformatics</source>, <volume>30</volume>, <fpage>3128</fpage>–<lpage>3130</lpage>.<pub-id pub-id-type="pmid">25064567</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skwark</surname><given-names>M.J.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>PconsC: combination of direct information methods and alignments improves contact prediction.</article-title>
<source>Bioinformatics</source>, <volume>29</volume>, <fpage>1815</fpage>–<lpage>1816</lpage>.<pub-id pub-id-type="pmid">23658418</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Söding</surname><given-names>J</given-names></name></person-group> (<year>2005</year>) <article-title>Protein homology detection by HMM–HMM comparison.</article-title>
<source>Bioinformatics</source>, <volume>21</volume>, <fpage>951</fpage>–<lpage>960</lpage>.<pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>W.R.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Prediction of contacts from correlated sequence substitutions.</article-title>
<source>Curr. Opin. Struct. Biol.</source>, <volume>23</volume>, <fpage>473</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">23680395</pub-id></mixed-citation>
    </ref>
    <ref id="btu791-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weigt</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein–protein interaction by message passing.</article-title>
<source>Proc. Natl Acad. Sci. USA</source>, <volume>106</volume>, <fpage>67</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">19116270</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
