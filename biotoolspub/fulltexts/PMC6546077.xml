<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">peerj</journal-id>
    <journal-id journal-id-type="pmc">peerj</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6546077</article-id>
    <article-id pub-id-type="publisher-id">7008</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.7008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Funmap2: an R package for QTL mapping using longitudinal phenotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Nating</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Chu</surname>
          <given-names>Tinyi</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Luo</surname>
          <given-names>Jiangtao</given-names>
        </name>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Rongling</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <contrib id="author-5" contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Zhong</given-names>
        </name>
        <email>zw355@cornell.edu</email>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-4">4</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>College of Biological Sciences and Technology, Beijing Forestry University</institution>, <city>Beijing</city>, <country>China</country></aff>
      <aff id="aff-2"><label>2</label><institution>Graduate field of Computational Biology, Cornell University</institution>, <city>Ithaca</city>, <state>NY</state>, <country>United States of America</country></aff>
      <aff id="aff-3"><label>3</label><institution>Department of Biostatistics, College of Public Health, University of Nebraska Medical Center</institution>, <city>Omaha</city>, <state>NE</state>, <country>United States of America</country></aff>
      <aff id="aff-4"><label>4</label><institution>Baker Institute for Animal Health, College of Veterinary Medicine, Cornell College</institution>, <city>Ithaca</city>, <state>NY</state>, <country>United States of America</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Broman</surname>
          <given-names>Karl</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2019-05-31">
      <day>31</day>
      <month>5</month>
      <year iso-8601-date="2019">2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e7008</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2018-10-26">
        <day>26</day>
        <month>10</month>
        <year iso-8601-date="2018">2018</year>
      </date>
      <date date-type="accepted" iso-8601-date="2019-04-23">
        <day>23</day>
        <month>4</month>
        <year iso-8601-date="2019">2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2019 Wang et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Wang et al.</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/7008"/>
    <abstract>
      <p>Quantitative trait locus (QTL) mapping has been used as a powerful tool for inferring the complexity of the genetic architecture that underlies phenotypic traits. This approach has shown its unique power to map the developmental genetic architecture of complex traits by implementing longitudinal data analysis. Here, we introduce the R package <italic>Funmap2</italic> based on the functional mapping framework, which integrates prior biological knowledge into the statistical model. Specifically, the functional mapping framework is engineered to include longitudinal curves that describe the genetic effects and the covariance matrix of the trait of interest. <italic>Funmap2</italic> chooses the type of longitudinal curve and covariance matrix automatically using information criteria. <italic>Funmap2</italic> is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2">https://github.com/wzhy2000/Funmap2</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>QTL mapping</kwd>
      <kwd>Quantitative trait loci</kwd>
      <kwd>Functional mapping</kwd>
      <kwd>Longitudinal traits</kwd>
      <kwd>Log-likelihood ratio test</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>National Natural Science Foundation of China</funding-source>
        <award-id>31470675</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Fundamental Research Funds for the Central Universities</funding-source>
        <award-id>BLX2013026</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>National Training Program of Innovation and Entrepreneurship for Undergraduates</funding-source>
        <award-id>201510022069</award-id>
      </award-group>
      <funding-statement>This study was supported by the National Natural Science Foundation of China (No. 31470675), the Fundamental Research Funds for the Central Universities (No. BLX2013026) and the National Training Program of Innovation and Entrepreneurship for Undergraduates (No. 201510022069). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Advances in sequencing technologies have dramatically increased the number of molecular markers available for studying an organism’s genome. QTL mapping exploits these markers to identify the genomic regions associated with the quantitative traits within an inbred population. In the past 20 years, a variety of statistical models have been developed to detect QTLs, which has greatly facilitated the identification of the genomic regions that control biological traits. In addition to the study of additive and dominant effects, QTL mapping has been applied successfully to the study of epistasis effects, allometric growth, and pleiotropic effects.</p>
    <p><xref rid="ref-6" ref-type="bibr">Lander &amp; Botstein (1989)</xref> established tractable statistical methodologies to map QTLs on one chromosomal interval bracketed by two flanking markers, which is known as the interval mapping method. Later, composite interval mapping improved interval mapping by including markers from other intervals as covariates to control the overall genetic background (<xref rid="ref-29" ref-type="bibr">Zeng, 1994</xref>). <xref rid="ref-4" ref-type="bibr">Kao, Zeng &amp; Teasdale (1999)</xref> proposed the simultaneous use of multiple marker intervals to map multiple QTLs of epistatic interactions throughout a linkage map. Since then, mapping QTLs in complicated genetic and genomic problems has increased dramatically.</p>
    <p>Even though there have been advances in mapping resolution and extension to more complicated mapping problems, conventional mapping approaches are restricted to phenotypic data measured at a single point in time. In many important biological problems, however, genotypes that control longitudinal traits, such as those measured during developmental processes and environmental changes, cannot be accommodated effectively under the framework of single trait QTL mapping. Several approaches (<xref rid="ref-12" ref-type="bibr">Ma, Casella &amp; Wu, 2002</xref>; <xref rid="ref-23" ref-type="bibr">Wu et al., 2002</xref>; <xref rid="ref-27" ref-type="bibr">Yang, Tian &amp; Xu, 2006</xref>; <xref rid="ref-5" ref-type="bibr">Kwak et al., 2014</xref>) have been developed for QTL mapping of such function valued traits. Functional mapping (<xref rid="ref-12" ref-type="bibr">Ma, Casella &amp; Wu, 2002</xref>; <xref rid="ref-22" ref-type="bibr">Wu &amp; Lin, 2006</xref>; <xref rid="ref-16" ref-type="bibr">Sun et al., 2015</xref>) is a statistical framework derived to map genes that control the dynamic biological process of complex traits. In this framework, a mixture model is fitted using an EM algorithm by maximizing likelihood, followed by hypothesis testing of the significance of association. In addition, model parameters that describe growth trajectories can also be estimated. Functional mapping has shown remarkable performance in associating QTLs with dynamic traits in plants (<xref rid="ref-31" ref-type="bibr">Zhao et al., 2004b</xref>; <xref rid="ref-10" ref-type="bibr">Li et al., 2010b</xref>; <xref rid="ref-26" ref-type="bibr">Yang et al., 2011</xref>, <xref rid="ref-15" ref-type="bibr">Sillanpää et al., 2012</xref>), animals (<xref rid="ref-30" ref-type="bibr">Zhao et al., 2004a</xref>; <xref rid="ref-24" ref-type="bibr">Xiong et al., 2011</xref>), and humans (<xref rid="ref-8" ref-type="bibr">Li, Das &amp; Wu, 2009</xref>). Its application can be extended to genetic dissection of developmental processes that include growth trajectory and allometric scaling (<xref rid="ref-11" ref-type="bibr">Ma et al., 2003</xref>; <xref rid="ref-7" ref-type="bibr">Li et al., 2014</xref>), phenotypic plasticity based on gene-environment interaction (<xref rid="ref-21" ref-type="bibr">Wang et al., 2013a</xref>), drug response (<xref rid="ref-20" ref-type="bibr">Wang et al., 2013b</xref>), and morphological shape (<xref rid="ref-2" ref-type="bibr">Fu et al., 2013</xref>). Recently, the integration of functional mapping and differential equations (<xref rid="ref-3" ref-type="bibr">Fu et al., 2011</xref>; <xref rid="ref-20" ref-type="bibr">Wang et al., 2013b</xref>) has also been applied to widely emergent applications of dynamic systems.</p>
    <p>The <italic>Funmap2</italic> package is developed to identify QTLs for a longitudinal trait based on functional mapping. It is implemented as a package for the freely accessible statistical software R (<xref rid="ref-14" ref-type="bibr">R Core Team, 2019</xref>). <italic>Funmap2</italic> implements a complete pipeline, which includes data loading, QTL scanning, computing of significance values, and reporting of significant QTL. The essence of functional mapping relies on the longitudinal curve of genetic effects and the covariance matrix that characterize the longitudinal relationship of the trait. Although a logistic curve may describe the genetic effects in most biological processes, the reaction norm in continuously varying environmental problems may not follow a sigmoid shape. To address this, <italic>Funmap2</italic> provides sigmoid, Legendre, and Pharmacology as built-in curves, and it also allows users to customize the curve equation. Furthermore, to increase statistical power, the covariance matrix can be chosen from several covariance structures used in IBM SPSS software, such as autoregressive, ante-dependence, or autoregressive moving average (<xref rid="ref-9" ref-type="bibr">Li et al., 2010a</xref>). Because of the difficulty of knowing which combination of curve shapes and covariance structures is the best for a longitudinal trait beforehand, we enabled <italic>Funmap2</italic> to choose the best curve shape and covariance structure automatically from the built-in resources based on information criteria.</p>
    <p>In addition to statistical analysis, <italic>Funmap2</italic> generates a PDF report that visualizes all results, which include phenotype traits, QTL profiles, significant QTL curves, and permutation results. Additionally, the package provides a simulation module for testing the performance and demonstrating the use of <italic>Funmap2</italic> on data generated by different models.</p>
    <p><italic>Funmap2</italic> is a QTL mapping tool for longitudinal traits with an open source software license. It is available publicly under an open-source software license: <ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2">https://github.com/wzhy2000/Funmap2</ext-link>. In the following sections, we give a brief review of functional mapping in terms of its statistical model. Then, we focus on the detailed workflow of <italic>Funmap2</italic>. Lastly, we provide one example with codes and figures.</p>
  </sec>
  <sec>
    <title>Materials &amp; Methods</title>
    <sec>
      <title>Statistical methods</title>
      <p>Functional mapping is a statistical framework aimed at identifying QTLs that are associated significantly with a longitudinal phenotype of interest in an experimental population, such as recombinant inbred lines (RIL) or a doubled-haploid (DH) population. Functional mapping computes maximum likelihood estimation (MLE) of mixture models that integrate the likelihood over QTL genotypes. The model also accounts for the (1) longitudinal trend of the trait using a continuous curve (i.e., growth trajectory for time-dependent traits and reaction norm for environment-dependent traits), and (2) internal correlation of traits across longitudinal measurements using a covariance matrix.</p>
      <p>The model assumes that the longitudinal trend of the trait follows a particular mathematical curve. In a statistical setting, the phenotypes of the trait at all time points follow a multivariate normal distribution, which can be described by the following <xref ref-type="disp-formula" rid="eqn-1">Eq. (1)</xref>: <disp-formula id="eqn-1"><label>(1)</label><alternatives><graphic xlink:href="peerj-07-7008-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{\mathrm{f}}_{\mathrm{j}} \left( {\mathrm{y}}_{\mathrm{i}} \right) = \frac{1}{(2\pi )^{ \frac{\mathrm{m}}{2} }{ \left\vert \sum \right\vert }^{ \frac{1}{2} }} \exp \nolimits \left[ -{ \left( {\mathrm{y}}_{\mathrm{i}}-\alpha {\mathrm{X}}_{\mathrm{i}}-{\mathrm{g}}_{\mathrm{j}} \right) }^{\mathrm{T}}{\sum \nolimits }^{-1}({\mathrm{y}}_{\mathrm{ i}}-\alpha {\mathrm{X}}_{\mathrm{i}}-{\mathrm{g}}_{\mathrm{j}})/2 \right] .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced separators="" open="|" close="|"><mml:mrow><mml:mo mathsize="big" movablelimits="false">∑</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo class="qopname"> exp</mml:mo><mml:mfenced separators="" open="[" close="]"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo mathsize="big" movablelimits="false"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>Assuming that y<sub>i</sub> is a vector of measured values for individual <italic>i</italic> at <italic>m</italic> time points, which describes the phenotypic values, g<sub>j</sub> denotes the overall mean vector for genotype <italic>j</italic> that is described as a mathematical curve, X<sub>i</sub> denotes the covariate for individual <italic>i</italic>, <italic>α</italic> is a vector of coefficient value for each covariate, and∑ is the covariance matrix. Therefore, <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i001.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{f}}_{\mathrm{j}} \left( {\mathrm{y}}_{\mathrm{i}} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-7"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> is the probability density function that relates the measured traits of individual <italic>i</italic> to the combination of the genetic effects contributed by genotype <italic>j</italic> and covariate effects of individual <italic>i.</italic> In Functional mapping, we assume the genetic effects of each genotype vary from time to time and follow a trajectory which can be defined by a mathematical curve (g<sub>j</sub>), such as the logistic, Legendre or other type curves (<xref rid="ref-12" ref-type="bibr">Ma, Casella &amp; Wu, 2002</xref>). For the logistic curve, (g<sub>j</sub>) can be described by <disp-formula id="eqn-2"><label>(2)</label><alternatives><graphic xlink:href="peerj-07-7008-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{\mathrm{g}}_{\mathrm{j}} \left( {t}_{i} \right) = \frac{{a}_{j}}{1+{b}_{j}{\mathrm{e}}^{-{r}_{j}{t}_{i}}} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:math></alternatives></disp-formula>where <italic>a</italic><sub><italic>j</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub> and <italic>r</italic><sub><italic>j</italic></sub> are the parameters for genotype <italic>j</italic>.</p>
      <p>The estimated likelihood of genotype <italic>j</italic> for individual <italic>i</italic> are summed, weighted by the corresponding conditional probability of the QTL genotype, given the adjacent marker and inbred type. Therefore, the functional mapping method formulates the likelihood calculation of the mixture model as: <disp-formula id="eqn-3"><label>(3)</label><alternatives><graphic xlink:href="peerj-07-7008-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\text{logL} \left( \hat {\Omega } \right) =\sum _{\mathrm{i}=1}^{\mathrm{N}}\log \nolimits \left[ \sum _{\mathrm{j}=1}^{\mathrm{J}}{\mathrm{p}}_{\mathrm{ ij}}{\mathrm{f}}_{\mathrm{j}}({\mathrm{y}}_{\mathrm{i}}) \right] \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-3"><mml:mstyle displaystyle="true"><mml:mtext>logL</mml:mtext><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big" movablelimits="false"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:munderover><mml:mo class="qopname"> log</mml:mo><mml:mfenced separators="" open="[" close="]"><mml:mrow><mml:munderover><mml:mrow><mml:mo mathsize="big" movablelimits="false">∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mrow></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula>where each element p<sub>ij</sub> indicates the genotypic possibility of subject <italic>i</italic> for gene <italic>j</italic> (QQ, Qq, or qq), <bold><italic>N</italic></bold> denotes the individual number in the experimental population, and <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i002.jpg"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\Omega }$\end{document}</tex-math><mml:math id="mml-ieqn-16"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> denotes the variables in this log-likelihood function that include the covariate coefficient, curve parameters for multiple genotypes, and covariance parameters. In <xref ref-type="disp-formula" rid="eqn-3">Eq. (3)</xref>, we prefer to use the log-likelihood function.</p>
      <p>The likelihood function for the null hypothesis model, in which QTL does not affect the trait, is built as follows, <disp-formula id="eqn-4"><label>(4)</label><alternatives><graphic xlink:href="peerj-07-7008-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\text{logL} \left( \tilde {\Omega } \right) =\sum _{\mathrm{i}=1}^{\mathrm{N}}\log \nolimits ({\mathrm{f}}_{0} \left( {\mathrm{y}}_{\mathrm{i}} \right) )\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-4"><mml:mstyle displaystyle="true"><mml:mtext>logL</mml:mtext><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ~</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big" movablelimits="false"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:munderover><mml:mo class="qopname"> log</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:mstyle></mml:math></alternatives></disp-formula>where <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i003.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{f}}_{0} \left( {\mathrm{y}}_{\mathrm{i}} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-18"><mml:msub><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> differs from (1) in g <sub>j</sub> by assuming the same longitudinal curve for all genotypes. <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i004.jpg"/><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tilde {\Omega }$\end{document}</tex-math><mml:math id="mml-ieqn-20"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ~</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> denotes the estimated parameters in this log-likelihood function.</p>
      <p>The goal of functional mapping is to compute the log-likelihood ratio (LR) for each QTL, defined by the following equation, and then to choose the significant QTL with a high value of LR. <disp-formula id="eqn-5"><label>(5)</label><alternatives><graphic xlink:href="peerj-07-7008-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{LR}2=-2\log \nolimits \left[ \frac{L \left( \tilde {\Omega } \right) }{L \left( \hat {\Omega } \right) } \right] .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-5"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">LR</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo class="qopname">log</mml:mo><mml:mfenced separators="" open="[" close="]"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ~</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>Intuitively, the null hypothesis H<sub>0</sub> is that there is no gene that controls the growth process, and the alternative hypothesis H<sub>1</sub> is that growth processes are different across the QTL genotypes. <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i005.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tilde {\Omega }$\end{document}</tex-math><mml:math id="mml-ieqn-22"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ~</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="peerj-07-7008-i006.jpg"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\Omega }$\end{document}</tex-math><mml:math id="mml-ieqn-23"><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> are the maximum likelihood estimates of parameters under the hypotheses H<sub>0</sub> and H<sub>1</sub>, respectively.</p>
      <p>To conduct a log-likelihood ratio test on complicated statistical models like the one used in functional mapping, a permutation test is usually used to derive and to compare against the null distribution (<xref rid="ref-1" ref-type="bibr">Churchill &amp; Doerge, 1994</xref>). Because the permutation test is generally applicable to various models, it is intensive to implement computationally. To address this, we proposed a new approach called the filtering method to improve the computational efficiency of a permutation test. We first quantified the correlation between QTL and the longitudinal data using a genotype-oriented curve clustering method. Then, the QTLs that are highly correlated with the outcome were computed in the improved permutation tests (<xref rid="ref-18" ref-type="bibr">Wang et al., 2017</xref>). As a result, this reduced the amount of computation in permutation tests significantly and sped up the computation for data analysis in functional mapping.</p>
    </sec>
    <sec>
      <title>Package workflow</title>
      <p>The <italic>Funmap2</italic> package is an open source package for R with automated data analysis for identifying the significant QTLs for the longitudinal traits that were measured. The <italic>Funmap2</italic> pipeline includes modules for data import, curve fitting, QTL scanning, MLE computation, hypothesis testing, and data visualization (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>).</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.7008/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The workflow process in the Funmap2 package.</title>
          <p>The top row shows the analysis steps and the bottom row shows the corresponding output obtained in each step. The chromosome image is used under Pixabay’s license (<ext-link ext-link-type="uri" xlink:href="https://pixabay.com/en/service/license/">https://pixabay.com/en/service/license/</ext-link>).</p>
        </caption>
        <graphic xlink:href="peerj-07-7008-g001"/>
      </fig>
      <p>The user may either run the entire <italic>Funmap2</italic> workflow in one function call or step-by-step with customization. Often it is more convenient to call the main function <italic>FM2.pipe,</italic> which automatically implements all tasks and outputs the summary information and figures in PDF format. In this function, sub-modules are called successively. Functions include data loading (<italic>FM2.load.data</italic>), data estimation (<italic>FM2.estimate.data</italic>) for curve fitting and covariance selection, QTL scanning (<italic>FM2.qtlscan</italic>), and permutation (<italic>FM.permutation)</italic>, and report generation (<italic>FM2.report</italic>). The typical calling is shown below.</p>
      <p>
        <boxed-text id="bx1" position="float" orientation="portrait">
          <label>Box 1</label>
          <p>#<monospace> Call the pipeline in parallel computing.</monospace></p>
          <p>
            <monospace>r &lt; - FM2.pipe( file.pheno.csv, NULL, file.geno.csv,file.marker.csv, ”BC”,</monospace>
          </p>
          <p>
            <monospace>curve.type=”logistic”,</monospace>
          </p>
          <p>
            <monospace> covar.type=”auto”,</monospace>
          </p>
          <p>
            <monospace>options=list(n.cores=10) )</monospace>
          </p>
        </boxed-text>
      </p>
      <p><italic>Funmap2</italic> requires users to provide experimental data and to specify several parameters. The phenotype file that contains longitudinal traits, one genotype marker file for the experimental population, and one genetic marker information file are required. A covariate file is optional and is not provided in the above example. In addition to these experimental data, users need to specify the cross type of QTL mapping. Four available types are provided in <italic>Funmap2</italic>: Backcrossing, F2, RIL, and DH. Note that in this automated run, the user may either let <italic>Funmap2</italic> choose the optimal curve type and covariance structure or the user may specify their values as functional arguments.</p>
      <p>Alternatively, the data analysis can be conducted by customizing the workflow by running sub-modules of <italic>Funmap2</italic> successively, as illustrated below.</p>
      <sec>
        <title>Data loading</title>
        <p>Input files for <italic>Funmap2</italic>, which include the marker definition file, the genetic marker file, the phenotype file, and the covariate file, should be formatted in CSV format according to the description in the vignette of <italic>Funmap2</italic>. The function <italic>FM2.load.data</italic> reads these data files, checks the correctness of data format and the consistency of individual IDs across all files and, finally, returns an R data object which can be called by the generic functions, such as show, print, plot. Phenotypic traits, and the curves that describe the longitudinal trend (if curve.type is specified) can be visualized by calling the plot function directly on the returned R object.</p>
      </sec>
      <sec>
        <title>Curve fitting and selection of the covariance matrix</title>
        <p>The function <italic>FM2.estimate.data</italic> may be invoked to facilitate the manual selection of curve type and covariance structure. The most commonly used curve function is sigmoid, and it is generally used to characterize growth curves of populations of plants and animals. Curves other than sigmoid, such as those that describe environment-dependent traits for which reaction norms are measured, are also provided. In total, <italic>Funmap2</italic> software implements nine curves in the current version, which include logistic, composite, and those generated by nonparametric methods. When running the automated mode (i.e., curve type is not specified during the data loading), least square curve fitting followed by AIC (Akaike Information criterion) and BIC (Bayesian Information criterion) is used to determine the best curve type.</p>
        <p>The internal correlation of traits measured at different longitudinal points are described using the covariance matrix, which is essential in the likelihood calculation. We included a comprehensive set of 13 covariance matrices, which include those employed by SPSS software and first order ante-dependence (<xref rid="ref-28" ref-type="bibr">Yap, Fan &amp; Wu, 2009</xref>). <italic>Funmap2</italic> also implements an automated way to select a covariance matrix using the AIC or MLE method. Users should be cautious of the cost of computational time when over-parametrizing the covariance matrix. The details of curves and covariance matrices are available in the vignette of <italic>Funmap2</italic>.</p>
      </sec>
      <sec>
        <title>QTL scanning</title>
        <p>The function <italic>FM2.qtlscan</italic> estimates the effects of QTLs and parameters that characterize longitudinal trend curves by scanning across all QTL positions. Specifically, the function tests H<sub>0</sub> and H<sub>1</sub> hypotheses using the MLE method and calculates LR2 values in <xref ref-type="disp-formula" rid="eqn-5">Eq. (5)</xref> at each QTL marker at every 1 cM position. The MLE method also outputs covariate coefficients, curve parameters and covariance parameters that optimize the log-likelihood. When finished, <italic>FM2.qtlscan</italic>, by default, generates the LR2 profile figure and highlights QTLs with the highest LR2 value for each chromosome. To determine the significant QTLs, the user needs to run the permutation test (see the following section).</p>
      </sec>
      <sec>
        <title>Permutation test</title>
        <p>The distribution of the log-likelihood ratio is difficult to derive in analytical form, especially for complicated distribution functions. To overcome this difficulty, a permutation test is generally used to obtain the null distribution and declare statistical significance of a QTL. One commonly encountered issue with a permutation test, however, is the high cost of computational time, which becomes especially prominent when running the entire genome. The function <italic>FM.permutation</italic> includes two methods to address this issue. The first option is to parallelize the computation in a unix-based operating system provided that multiple processor threads are available. The second option is to apply a filtering method to reduce the computational intensity. This is done by pre-selecting the candidate QTLs that have a high QTL-trait correlation.</p>
      </sec>
      <sec>
        <title>Report</title>
        <p>The resulting objects returned by individual functions contain summary information (by the summary function), and they can be visualized by the plot function. In addition, <italic>Funmap2</italic> includes the function <italic>FM2.report</italic> that can generate reports automatically, which include tiled/overlapping curves that describe the longitudinal trait, LR profile for all chromosomes, multiple LR2 profiles for the significant QTLs, and the curves for the significant QTLs.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>We use a data set from the pre-installed Populus data set (<xref rid="ref-12" ref-type="bibr">Ma, Casella &amp; Wu, 2002</xref>) in this package as an example. The data are composed of 90 backcross individuals with 22 linkage groups and 275 molecular markers. The phenotypic values were measured throughout 11 years. The code for analyzing the data is shown below, and the results for QTL mapping are plotted (<xref ref-type="fig" rid="fig-2">Figs. 2</xref> and <xref ref-type="fig" rid="fig-3">3</xref>). The computational burden of Funmap2 roughly comes from genome length and permutation. In addition, the computational cost also depends on the sample size and the number of measurements. The analysis of the Populus data set on the whole genome 3611 QTLs with 1000 conventional permutations took 110.2 hr on an Intel(R) Xeon(R) CPU E5-4620 @ 2.6 GHZ computing cluster with 16 cores. This result demonstrates that Funmap2 is computationally intensive for large-scale studies using the conventional permutation method. In order to reduce the computational time of permutation, we proposed a new method that reduces the number of QTLs during the permutation computation because QTLs are highly correlated with the outcome (<xref rid="ref-18" ref-type="bibr">Wang et al., 2017</xref>). In Funmap2, this new permutation can reduce 80% to 95% of the computational cost.</p>
    <fig id="fig-2" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.7008/fig-2</object-id>
      <label>Figure 2</label>
      <caption>
        <title>Profile of the likelihood ratio (LR) for the 8th chromosome.</title>
        <p>This figure shows 14 markers in this chromosome, with their names and genetic distance for each interval highlighted at the bottom. The peak with LR2=89.47 at interval [GT/CAG-725—GT/CAG-750R] is located at 3 cM from GT/CAG-725, which suggests a potential locus for a significant QTL.</p>
      </caption>
      <graphic xlink:href="peerj-07-7008-g002"/>
    </fig>
    <fig id="fig-3" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.7008/fig-3</object-id>
      <label>Figure 3</label>
      <caption>
        <title>Growth curve for the QTL selected from <xref ref-type="fig" rid="fig-2">Fig. 2</xref>.</title>
        <p>The logistic curve was chosen by curve fitting. The curves are colored by genotype. Note that two genotypes show similar growth at early stages, but diverge at later stages, which suggests there is a QTL associated with growth kinetics. The two genotypes have different parameter values in the growth trajectory function defined by g<sub><italic>j</italic></sub> in <xref ref-type="disp-formula" rid="eqn-2">Eq. (2)</xref>.</p>
      </caption>
      <graphic xlink:href="peerj-07-7008-g003"/>
    </fig>
    <boxed-text id="bx2" position="float" orientation="portrait">
      <label>Box 2</label>
      <p>#<monospace> Load the pre-installed data for the example</monospace></p>
      <p>
        <monospace>file.pheno.csv &lt;- system.file(”extdata”,”populus.BC.pheno.csv”, package=”Funmap2”)</monospace>
      </p>
      <p>
        <monospace>file.geno.csv &lt;- system.file(”extdata”,”populus.BC.geno.csv”, package=”Funmap2”)</monospace>
      </p>
      <p>
        <monospace>file.marker.csv &lt;- system.file(”extdata”,”populus.BC.marker.csv”, package=”Funmap2”)</monospace>
      </p>
      <p>
        <monospace>r &lt;- FM2.pipe( file.pheno.csv, NULL, file.geno.csv, file.marker.csv, ”BC”,</monospace>
      </p>
      <p>
        <monospace>curve.type=”auto”, covar.type=”AR1”, options=list (n.cores=10))</monospace>
      </p>
    </boxed-text>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Functional mapping models assume that longitudinal traits follow a parametric or non-parametric curve, such as a growth trajectory, Legendre polynomial, or B-Spline (<xref rid="ref-25" ref-type="bibr">Yang, Wu &amp; Casella, 2009</xref>). Under this assumption, the likelihood ratio and QTL effects that are derived from the parameters of a parametric or a non-parametric curve are calculated by the MLE function over all linkage groups. <italic>Funmap2</italic> implements the functional mapping framework with nine curves and 13 covariance structures. Importantly, any new curve functions that are not implemented by <italic>Funmap2</italic> can be imported easily into the package and assembled into the framework of MLE. It has an open architecture, so the longitudinal traits can be fitted to any biological curve.</p>
    <p>The longitudinal traits tend to correlate strongly between time points (time-dependent) or reaction norms (environment-dependent). Functional mapping models this internal relation using a covariance matrix, which may increase the statistical power for QTL detection (<xref rid="ref-12" ref-type="bibr">Ma, Casella &amp; Wu, 2002</xref>). Whereas previous publications on functional mapping recommended the use of the most parsimonious covariance matrix (<xref rid="ref-28" ref-type="bibr">Yap, Fan &amp; Wu, 2009</xref>), such as autoregressive, ante-dependence, or autoregressive moving average (<xref rid="ref-9" ref-type="bibr">Li et al., 2010a</xref>), <italic>Funmap2</italic> also provides other covariance matrices implemented in IBM SPSS software, such as Compound Symmetry, Factor Analytic, Huynh-Feldt, and Toeplitz. Although a parsimonious covariance matrix can be efficient computationally, non-parsimonious covariance structures contain more parameters and, hence, richer structures, which may potentially lead to better data fitting while minimizing the pitfall of overfitting when guided by information criteria (<xref rid="ref-32" ref-type="bibr">Zimmerman et al., 2001</xref>).</p>
    <p>Since Functional Mapping was proposed in 2002, two programs, <italic>FunMap</italic> (<xref rid="ref-13" ref-type="bibr">Ma, Wu &amp; Casella, 2004</xref>) and <italic>3Funmap</italic> (<xref rid="ref-17" ref-type="bibr">Tong et al., 2011</xref>), have been released. <italic>FunMap</italic> employed 3 curve functions and the first-order autoregressive model to implement a basic framework as a web application which is unavailable. <italic>3FunMap</italic>, a Windows Application in Visual C++, implemented linkage map construction and QTL mapping using the Legendre polynomial curve and the first-order autoregressive model. Although <italic>Funmap2</italic> inherited from same framework, it increased model flexibility and software usability with many new features, such as implementing covariates for each individual, more trajectories and covariance matrices available in the mixture model, parallel computing, and using open source development platform. We believe <italic>Funmap2</italic> is the best choice to map QTL for functional trails so far.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Studies of QTL mapping for longitudinal traits other than functional mapping are unexpectedly rare, compared to that for QTL mapping of a trait that was measured at a single point. As a result, research on the genetic basis that underlies biological development and gene-environment interaction are greatly limited. <italic>Funmap2</italic> provides a user-friendly way to dissect these problems, and it facilitates the building of precise genotype-phenotype relation models through QTL mapping. In addition to mapped QTLs, estimates from curve functions may also provide insights for the understanding of the genetic, biochemical, and physiological pathways that govern developmental change (<xref rid="ref-19" ref-type="bibr">Wang et al., 2012</xref>). We are making the endeavor to develop a GUI version <italic>Funmap2</italic> to facilitate the extraction and interpretation of data further. At present, <italic>Funmap2</italic> supports experimental populations derived from a cross between two inbred lines, and it is limited to four types: F2, backcross, recombinant inbred lines, and double-haploid populations. Future versions of <italic>Funmap2</italic> will be able to accommodate populations of more diverse structures and even multiple traits, epistasis effects, allometric, and QTL-QTL interaction.</p>
  </sec>
</body>
<back>
  <ack>
    <p>I would like to thank Thomas A. Gavin, Professor Emeritus, Cornell University, for help with editing this paper.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Nating Wang</xref> performed the experiments, analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Tinyi Chu</xref> prepared figures and/or tables, authored or reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-3" fn-type="con">
        <p><xref ref-type="contrib" rid="author-3">Jiangtao Luo</xref> performed the experiments, analyzed the data.</p>
      </fn>
      <fn id="contribution-4" fn-type="con">
        <p><xref ref-type="contrib" rid="author-4">Rongling Wu</xref> conceived and designed the experiments.</p>
      </fn>
      <fn id="contribution-5" fn-type="con">
        <p><xref ref-type="contrib" rid="author-5">Zhong Wang</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The raw example data (Ma, Casella and Wu, 2002) is provided in the package <italic>Funmap2</italic>, and <italic>Funmap2</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2">https://github.com/wzhy2000/Funmap2</ext-link>. Users can use the example in the package or check the contents in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/wzhy2000/Funmap2/tree/master/Funmap2/inst/extdata">https://github.com/wzhy2000/Funmap2/tree/master/Funmap2/inst/extdata</ext-link>).</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Churchill &amp; Doerge (1994)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Churchill</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Doerge</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>Empirical threshold values for quantitative trait mapping</article-title>
        <source>Genetics</source>
        <volume>138</volume>
        <issue>3</issue>
        <fpage>963</fpage>
        <lpage>971</lpage>
        <pub-id pub-id-type="pmid">7851788</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Fu et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <article-title>Mapping shape quantitative trait loci using a radius-centroid-contour model</article-title>
        <source>Heredity</source>
        <volume>110</volume>
        <issue>6</issue>
        <fpage>511</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1038/hdy.2012.97</pub-id>
        <pub-id pub-id-type="pmid">23572125</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Fu et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>A mathematical framework for functional mapping of complex phenotypes using delay differential equations</article-title>
        <source>Journal of Theoretical Biology</source>
        <volume>289</volume>
        <fpage>206</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2011.08.002</pub-id>
        <pub-id pub-id-type="pmid">21871898</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Kao, Zeng &amp; Teasdale (1999)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kao</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>ZB</given-names>
          </name>
          <name>
            <surname>Teasdale</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Multiple interval mapping for quantitative trait loci</article-title>
        <source>Genetics</source>
        <volume>152</volume>
        <issue>3</issue>
        <fpage>1203</fpage>
        <lpage>1216</lpage>
        <pub-id pub-id-type="pmid">10388834</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Kwak et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwak</surname>
            <given-names>IY</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Spalding</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Broman</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>A simple regression-based method to map quantitative trait loci underlying function-valued phenotypes</article-title>
        <source>Genetics</source>
        <volume>197</volume>
        <issue>4</issue>
        <fpage>1409</fpage>
        <lpage>1416</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.114.166306</pub-id>
        <pub-id pub-id-type="pmid">24931408</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Lander &amp; Botstein (1989)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>Mapping mendelian factors underlying quantitative traits using RFLP linkage maps</article-title>
        <source>Genetics</source>
        <volume>121</volume>
        <issue>1</issue>
        <fpage>185</fpage>
        <lpage>199</lpage>
        <pub-id pub-id-type="pmid">2563713</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Li et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>A novel QTL mapping model for allometric growth and pleiotropic extension</article-title>
        <source>Journal of Nanjing Forestry University (Natural Sciences Edition), China</source>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>35</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Li, Das &amp; Wu (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Functional mapping of human growth trajectories</article-title>
        <source>Journal of Theoretical Biology</source>
        <volume>261</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2009.07.020</pub-id>
        <pub-id pub-id-type="pmid">19632241</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Li et al. (2010a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McMurry</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Berceli</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2010a</year>
        <article-title>Functional clustering of periodic transcriptional profiles through ARMA (p, q)</article-title>
        <source>PLOS ONE</source>
        <volume>5</volume>
        <issue>4</issue>
        <elocation-id>e9894</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009894</pub-id>
        <pub-id pub-id-type="pmid">20419127</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Li et al. (2010b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2010b</year>
        <article-title>Functional mapping of genotype-environment interactions for soybean growth by a semiparametric approach</article-title>
        <source>Plant Methods</source>
        <volume>6</volume>
        <issue>1</issue>
        <comment>Article 13</comment>
        <pub-id pub-id-type="doi">10.1186/1746-4811-6-13</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Ma et al. (2003)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>CX</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Littell</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Khuri</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Exponential mapping of quantitative traits governing allometric relationships in organisms</article-title>
        <source>Journal of Mathematical Biology</source>
        <volume>47</volume>
        <fpage>313</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1007/s00285-003-0212-z</pub-id>
        <pub-id pub-id-type="pmid">14523575</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Ma, Casella &amp; Wu (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>CX</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Functional mapping of quantitative trait loci underlying the character process: a theoretical framework</article-title>
        <source>Genetics</source>
        <volume>161</volume>
        <issue>4</issue>
        <fpage>1751</fpage>
        <lpage>1762</lpage>
        <pub-id pub-id-type="pmid">12196415</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Ma, Wu &amp; Casella (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>CX</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>FunMap: functional mapping of complex traits</article-title>
        <source>Bioinformatics</source>
        <volume>20</volume>
        <issue>11</issue>
        <fpage>1808</fpage>
        <lpage>1811</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth156</pub-id>
        <pub-id pub-id-type="pmid">14988108</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>R Core Team (2019)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <year>2019</year>
        <data-title>R: a language and environment for statistical computing</data-title>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <publisher-loc>Vienna</publisher-loc>
        <uri xlink:href="https://www.R-project.org/">https://www.R-project.org/</uri>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Sillanpää et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sillanpää</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pikkuhookana</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Abrahamsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Knürr</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fries</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lerceteau</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Waldmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>García-Gil</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Simultaneous estimation of multiple quantitative trait loci and growth curve parameters through hierarchical Bayesian modeling</article-title>
        <source>Heredity</source>
        <volume>108</volume>
        <issue>2</issue>
        <fpage>134</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1038/hdy.2011.56</pub-id>
        <pub-id pub-id-type="pmid">21792229</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Sun et al. (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gosik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Functional mapping: how to map genes for phenotypic plasticity of development</article-title>
        <source>Evolutionary biology: biodiversification from genotype to phenotype</source>
        <publisher-name>Springer International Publishing</publisher-name>
        <publisher-loc>Cham</publisher-loc>
        <fpage>3</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Tong et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>3FunMap: full-sib family functional mapping of dynamic traits</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <issue>14</issue>
        <fpage>2006</fpage>
        <lpage>2008</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr306</pub-id>
        <pub-id pub-id-type="pmid">21586519</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Wang et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Fast computation of significance threshold in QTL mapping of dynamic quantitative traits</article-title>
        <source>Journal of Biometrics and Biostatistics</source>
        <volume>8</volume>
        <comment>Article 329</comment>
        <pub-id pub-id-type="doi">10.4172/2155-6180.1000329</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Wang et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Berceli</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>How to cluster gene expression dynamics in response to environmental signals</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>13</volume>
        <issue>2</issue>
        <fpage>162</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbr032</pub-id>
        <pub-id pub-id-type="pmid">21746694</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Wang et al. (2013b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2013b</year>
        <article-title>Stochastic modeling of systems mapping in pharmacogenomics</article-title>
        <source>Advanced Drug Delivery Reviews</source>
        <volume>65</volume>
        <issue>7</issue>
        <fpage>912</fpage>
        <lpage>917</lpage>
        <pub-id pub-id-type="doi">10.1016/j.addr.2013.03.004</pub-id>
        <pub-id pub-id-type="pmid">23528445</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Wang et al. (2013a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2013a</year>
        <article-title>A dynamic framework for quantifying the genetic architecture of phenotypic plasticity</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>82</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs009</pub-id>
        <pub-id pub-id-type="pmid">22396460</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Wu &amp; Lin (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Functional mapping-how to map and study the genetic architecture of dynamic complex traits</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>229</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg1804</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Wu et al. (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Mapping of quantitative trait loci based on growth models</article-title>
        <source>Theoretical and Applied Genetics</source>
        <volume>105</volume>
        <issue>6–7</issue>
        <fpage>1043</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-002-1052-8</pub-id>
        <pub-id pub-id-type="pmid">12582932</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Xiong et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Goulding</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Tecott</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Sen</surname>
            <given-names>Ś</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>A flexible estimating equations approach for mapping function-valued traits</article-title>
        <source>Genetics</source>
        <volume>189</volume>
        <issue>1</issue>
        <fpage>305</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.111.129221</pub-id>
        <pub-id pub-id-type="pmid">21705752</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Yang, Wu &amp; Casella (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Nonparametric functional mapping of quantitative trait loci</article-title>
        <source>Biometrics</source>
        <volume>65</volume>
        <issue>1</issue>
        <fpage>30</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2008.01063.x</pub-id>
        <pub-id pub-id-type="pmid">18537950</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Yang et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Bayesian functional mapping of dynamic quantitative traits</article-title>
        <source>Theoretical and Applied Genetics</source>
        <volume>123</volume>
        <issue>3</issue>
        <fpage>483</fpage>
        <lpage>492</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-011-1601-0</pub-id>
        <pub-id pub-id-type="pmid">21573763</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Yang, Tian &amp; Xu (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Mapping quantitative trait loci for longitudinal traits in line crosses</article-title>
        <source>Genetics</source>
        <volume>173</volume>
        <issue>4</issue>
        <fpage>2339</fpage>
        <lpage>2356</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.105.054775</pub-id>
        <pub-id pub-id-type="pmid">16751670</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Yap, Fan &amp; Wu (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Nonparametric modeling of longitudinal covariance structure in functional mapping of quantitative trait loci</article-title>
        <source>Biometrics</source>
        <volume>65</volume>
        <issue>4</issue>
        <fpage>1068</fpage>
        <lpage>1077</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2009.01222.x</pub-id>
        <pub-id pub-id-type="pmid">19302406</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Zeng (1994)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>ZB</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>Precision mapping of quantitative trait loci</article-title>
        <source>Genetics</source>
        <volume>136</volume>
        <issue>4</issue>
        <fpage>1457</fpage>
        <lpage>1468</lpage>
        <pub-id pub-id-type="pmid">8013918</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Zhao et al. (2004a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cheverud</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2004a</year>
        <article-title>A unifying statistical model for QTL mapping of genotype × sex interaction for developmental trajectories</article-title>
        <source>Physiological Genomics</source>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>218</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1152/physiolgenomics.00129.2004</pub-id>
        <pub-id pub-id-type="pmid">15304622</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Zhao et al. (2004b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gallo-Meagher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2004b</year>
        <article-title>A unified statistical model for functional mapping of environment-dependent genetic expression and genotype ×environment interactions for ontogenetic development</article-title>
        <source>Genetics</source>
        <volume>168</volume>
        <issue>3</issue>
        <fpage>1751</fpage>
        <lpage>1762</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.104.031484</pub-id>
        <pub-id pub-id-type="pmid">15579721</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Zimmerman et al. (2001)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmerman</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Núñez Antón</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gregoire</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Schabenberger</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Kenward</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Molenberghs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Verbeke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pourahmadi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vieu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zimmerman</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Parametric modelling of growth curve data: an overview</article-title>
        <source>Test</source>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02595823</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
