<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Evol Bioinform Online</journal-id>
    <journal-id journal-id-type="iso-abbrev">Evol. Bioinform. Online</journal-id>
    <journal-id journal-id-type="publisher-id">101256319</journal-id>
    <journal-title-group>
      <journal-title>Evolutionary Bioinformatics Online</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1176-9343</issn>
    <publisher>
      <publisher-name>Libertas Academica</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4362911</article-id>
    <article-id pub-id-type="doi">10.4137/EBO.S21501</article-id>
    <article-id pub-id-type="publisher-id">ebo-11-2015-043</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software or Database Review</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A RESTful API for Access to Phylogenetic Tools via the CIPRES Science Gateway</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Miller</surname>
          <given-names>Mark A</given-names>
        </name>
        <xref ref-type="aff" rid="af1-ebo-11-2015-043">1</xref>
        <xref ref-type="corresp" rid="c1-ebo-11-2015-043"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schwartz</surname>
          <given-names>Terri</given-names>
        </name>
        <xref ref-type="aff" rid="af1-ebo-11-2015-043">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pickett</surname>
          <given-names>Brett E</given-names>
        </name>
        <xref ref-type="aff" rid="af2-ebo-11-2015-043">2</xref>
        <xref ref-type="author-notes" rid="fn1-ebo-11-2015-043">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Sherry</given-names>
        </name>
        <xref ref-type="aff" rid="af3-ebo-11-2015-043">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klem</surname>
          <given-names>Edward B</given-names>
        </name>
        <xref ref-type="aff" rid="af3-ebo-11-2015-043">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scheuermann</surname>
          <given-names>Richard H</given-names>
        </name>
        <xref ref-type="aff" rid="af2-ebo-11-2015-043">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Passarotti</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="af4-ebo-11-2015-043">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaufman</surname>
          <given-names>Seth</given-names>
        </name>
        <xref ref-type="aff" rid="af4-ebo-11-2015-043">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Leary</surname>
          <given-names>Maureen A</given-names>
        </name>
        <xref ref-type="aff" rid="af5-ebo-11-2015-043">5</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-ebo-11-2015-043"><label>1</label>San Diego Supercomputer Center, University of California, San Diego, La Jolla, CA, USA.</aff>
    <aff id="af2-ebo-11-2015-043"><label>2</label>J. Craig Venter Institute, La Jolla, CA, USA.</aff>
    <aff id="af3-ebo-11-2015-043"><label>3</label>Northrop Grumman Health Solutions, Rockville, MD, USA.</aff>
    <aff id="af4-ebo-11-2015-043"><label>4</label>Whirl-i-gig, Brooklyn, NY, USA.</aff>
    <aff id="af5-ebo-11-2015-043"><label>5</label>Department of Anatomical Sciences, Stony Brook University, Stony Brook, NY, USA.</aff>
    <author-notes>
      <corresp id="c1-ebo-11-2015-043">CORRESPONDENCE: <email>mmiller@sdsc.edu</email></corresp>
      <fn id="fn1-ebo-11-2015-043">
        <label>*</label>
        <p>Current address: Thomson Reuters Intellectual Property and Science; Carlsbad, CA, USA.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>3</month>
      <year>2015</year>
    </pub-date>
    <volume>11</volume>
    <fpage>43</fpage>
    <lpage>48</lpage>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>1</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2015 the author(s), publisher and licensee Libertas Academica Ltd.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="open-access">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons CC-BY-NC 3.0 License.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The CIPRES Science Gateway is a community web application that provides public access to a set of parallel tree inference and multiple sequence alignment codes run on large computational resources. These resources are made available at no charge to users by the NSF Extreme Science and Engineering Discovery Environment (XSEDE) project. Here we describe the CIPRES RESTful application programmer interface (CRA), a web service that provides programmatic access to all resources and services currently offered by the CIPRES Science Gateway. Software developers can use the CRA to extend their web or desktop applications to include the ability to run MrBayes, BEAST, RAxML, MAFFT, and other computationally intensive algorithms on XSEDE. The CRA also makes it possible for individuals with modest scripting skills to access the same tools from the command line using curl, or through any scripting language. This report describes the CRA and its use in three web applications (Influenza Research Database – <ext-link ext-link-type="uri" xlink:href="http://www.fludb.org">www.fludb.org</ext-link>, Virus Pathogen Resource – <ext-link ext-link-type="uri" xlink:href="http://www.viprbrc.org">www.viprbrc.org</ext-link>, and MorphoBank – <ext-link ext-link-type="uri" xlink:href="http://www.morphobank.org">www.morphobank.org</ext-link>). The CRA is freely accessible to registered users at <ext-link ext-link-type="uri" xlink:href="https://cipresrest.sdsc.edu/cipresrest/v1">https://cipresrest.sdsc.edu/cipresrest/v1</ext-link>; supporting documentation and registration tools are available at <ext-link ext-link-type="uri" xlink:href="https://www.phylo.org/restusers">https://www.phylo.org/restusers</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>CIPRES</kwd>
      <kwd>RESTful API</kwd>
      <kwd>MrBayes</kwd>
      <kwd>BEAST</kwd>
      <kwd>RAxML</kwd>
      <kwd>MAFFT</kwd>
      <kwd>jMODELTEST2</kwd>
      <kwd>Science Gateway</kwd>
      <kwd>phylogenetics</kwd>
      <kwd>computational biology</kwd>
      <kwd>web portal</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The decreasing cost and increasing rate of DNA sequence acquisition, together with improved tools for phylogenetic analysis,<xref rid="b1-ebo-11-2015-043" ref-type="bibr">1</xref>,<xref rid="b2-ebo-11-2015-043" ref-type="bibr">2</xref> have made it possible to analyze evolutionary relationships in unprecedented detail. The massive amount of sequence data available, whether used alone or in concert with phenomic data,<xref rid="b3-ebo-11-2015-043" ref-type="bibr">3</xref> offers great potential for new insights into the evolutionary history of life on earth. However, many of the best methods currently available for sequence alignment and phylogenetic tree inference are computationally intensive. This fact makes access to computational power an increasingly important factor in determining which analyses are tractable for individual researchers. Individuals who do not have access to large computer clusters, the knowledge of how to operate them, and/or the attendant resources to maintain them can be severely limited in the kinds of analyses they can perform.</p>
    <p>The CIPRES Science Gateway (CIPRES)<xref rid="b4-ebo-11-2015-043" ref-type="bibr">4</xref> and the University of Oslo Bioportal (<ext-link ext-link-type="uri" xlink:href="http://www.bioportal.uio.no">http://www.bioportal.uio.no</ext-link>) were created as first-generation web portals to enable computationally demanding phylogenetic inference analyses for the broad scientific community. Both these web applications offered public access to parallel phylogenetic codes run on powerful computational resources through a browser interface. Both web applications provided users with the ability to upload a data-set, configure a job run using a particular community code (eg, MrBayes or RAxML), run that job efficiently on a multicore compute cluster, and retrieve the results. The need for this type of access is clear: over the past 4 years, phylogenetic analyses conducted using CIPRES and the Oslo Bioportal have been part of more than 1700 publications. Although the Oslo Bioportal ceased public operations in 2013, CIPRES continues to provide public access to large Linux clusters made available through the US National Science Foundation’s Extreme Science and Engineering Discovery Environment (XSEDE) project, and its rate of usage continues to grow.</p>
    <p>The access to computational resources provided by CIPRES can dramatically decrease the amount of time required to complete a phylogenetic analysis: the parallel codes available at CIPRES are 5–60-fold faster than comparable codes on a single-core desktop machine, and users can submit and run multiple jobs simultaneously. For example, an analysis involving 10 datasets, each of which requires 24 hours to analyze on a local desktop resource, will take at least 10 days to complete, but the same 10 datasets can be submitted to CIPRES simultaneously and the analysis will be completed in a few hours. For individuals with no alternative access to multicore compute resources, CIPRES represents a significant enabling technology.</p>
    <p>To date, CIPRES has provided access to computational resources only via a web browser interface. In this mode, each job must be configured and submitted sequentially through a set of point-and-click operations. The results must then be manually downloaded into a local work environment and imported into additional software packages for further analysis. While browser-based access is clearly useful for many kinds of analyses (in 2014, CIPRES ran more than 160,000 jobs for 4600 users), it can also be cumbersome and restrictive. To make public access to HPC resources more flexible and dynamic, we created a new set of CIPRES web services so that CIPRES capabilities can be accessed by developers and individuals with basic scripting skills outside of a web browser interface. These web services are accessible through a public CIPRES RESTful application programmer interface (CRA). The CRA provides registered users with access to all services currently supported by the browser-based CIPRES web application (<ext-link ext-link-type="uri" xlink:href="http://www.phylo.org/portal2">www.phylo.org/portal2</ext-link>).</p>
    <p>The CRA was created to benefit projects and individual scientists in three specific situations. First, for users who find the current browser interface cumbersome, the CRA makes it possible to run analyses outside the confines of the browser interface. Any person with basic knowledge of a scripting language can create a simple script that will submit jobs to CIPRES resources and retrieve the results. For example, an individual who wishes to deploy 20 analyses using the current browser interface must do so by repeating a tedious set of point-and-click operations 20 times. Using the CRA, however, an individual with basic knowledge of a scripting language can construct an appropriate script and submit the same 20 jobs from their desktop with much less effort. Moreover, with appropriate scripting, it is possible to create a workflow that chains multiple analyses, with the output of one being submitted as input to the next. The current CIPRES interface does not support this type of chained workflow.</p>
    <p>Second, a number of desktop software applications support sequence alignment and tree inference (eg, raxmlGUI,<xref rid="b5-ebo-11-2015-043" ref-type="bibr">5</xref> siMBa,<xref rid="b6-ebo-11-2015-043" ref-type="bibr">6</xref> and Mesquite<xref rid="b7-ebo-11-2015-043" ref-type="bibr">7</xref>), but these applications can access only the computing power available on the desktop computer where they are installed. Desktop computing is often inadequate for modern sequence alignment and tree inference problems, and large datasets may cause the desktop resource to become unresponsive for long periods while the job completes. The CRA makes it possible for developers to incorporate the ability to submit jobs to the powerful CIPRES compute resources into desktop applications with only minor changes to the existing code. Once implemented, users of tools like raxmlGUI, Mesquite, etc can run analyses on CIPRES resources, and use their desktop resource for other activities. The result will be a dramatic increase in the size and number of datasets that can be analyzed conveniently using popular desktop software packages.</p>
    <p>Finally, the CRA allows developers of web portals to incorporate compute-intensive sequence alignment and tree inference capabilities into their portal by adding a code that contacts the CRA, submits jobs, and retrieves results. The overhead for doing this is modest, and involves much less effort than creating and maintaining these capabilities themselves. CRA services have already been incorporated into three production web sites: the Influenza Research Database<xref rid="b8-ebo-11-2015-043" ref-type="bibr">8</xref> (IRD; <ext-link ext-link-type="uri" xlink:href="http://www.fludb.org">www.fludb.org</ext-link>), Virus Pathogen Resource<xref rid="b9-ebo-11-2015-043" ref-type="bibr">9</xref> (ViPR; <ext-link ext-link-type="uri" xlink:href="http://www.viprbrc.org">www.viprbrc.org</ext-link>), and MorphoBank<xref rid="b10-ebo-11-2015-043" ref-type="bibr">10</xref>,<xref rid="b11-ebo-11-2015-043" ref-type="bibr">11</xref> (<ext-link ext-link-type="uri" xlink:href="http://www.morphobank.org">www.morphobank.org</ext-link>). The use of CRA by these web sites is described further below.</p>
    <p>In short, the CRA provides a new, flexible mechanism to run analyses on large compute clusters. Currently, parallel codes for BEAST (v1.8 and 2),<xref rid="b12-ebo-11-2015-043" ref-type="bibr">12</xref>,<xref rid="b13-ebo-11-2015-043" ref-type="bibr">13</xref> FastTree2,<xref rid="b14-ebo-11-2015-043" ref-type="bibr">14</xref> GARLI,<xref rid="b15-ebo-11-2015-043" ref-type="bibr">15</xref> jModelTest2,<xref rid="b16-ebo-11-2015-043" ref-type="bibr">16</xref> MAFFT,<xref rid="b17-ebo-11-2015-043" ref-type="bibr">17</xref> MrBayes,<xref rid="b18-ebo-11-2015-043" ref-type="bibr">18</xref> PhyloBayes,<xref rid="b19-ebo-11-2015-043" ref-type="bibr">19</xref> and RAxML<xref rid="b20-ebo-11-2015-043" ref-type="bibr">20</xref> can be accessed through the CRA. It is important to note that while the CRA provides additional flexibility by allowing access outside the CIPRES browser interface, these services can only be accessed by third-party client software or scripts. The basic design of the CRA, information on registration, some practical examples, and future directions are provided below.</p>
  </sec>
  <sec>
    <title>CRA Structure and Design</title>
    <p>CIPRES was constructed from a software package that consists of two components: a software development kit called the Workbench Framework (WF), which performs the executive functions of the Gateway (eg, job submission and tracking, user authentication)<xref rid="b21-ebo-11-2015-043" ref-type="bibr">21</xref> and a web application that creates the CIPRES browser interface (CBI). The CBI allows users to create jobs and download results through a web browser. The CRA uses the WF for its executive functions, but since no graphical user interface (GUI) is required for programmatic access, the CRA uses a much simpler web application to process calls from remote applications. The CRA was constructed using Jersey (<ext-link ext-link-type="uri" xlink:href="https://jersey.java.net">https://jersey.java.net</ext-link>),<xref rid="b23-ebo-11-2015-043" ref-type="bibr">23</xref> an extensible open-source JAX-RS (JSR 311) reference implementation for building RESTful Web services. JAX-RS is a natural fit for the Java/Struts2 platform used to construct the CBI/WF. Because the WF is shared by both the CBI and the CRA, the CRA provides programmatic access to all services available through the CBI. Improvements to the WF will benefit both the CRA and CBI applications.</p>
  </sec>
  <sec>
    <title>Using the CRA</title>
    <p>Use of the CRA requires some form of client application to access the services. Programmatic access must be initiated from a registered client application by a registered user. Client applications are typically developed by users outside the CIPRES project group, and can be anything from a simple set of command line instructions to a complex Java web application. We have identified three specific use cases for the CRA, and these are described briefly below. Complete user documentation is provided at the CRA web site.</p>
    <sec>
      <title>Command line access</title>
      <p>Individuals with scripting skills can access the CRA from the command line via their preferred scripting language. A simple example of this type of access is via a bash shell script that uses the Linux curl or wget commands to submit jobs to the CRA and then retrieve the results. Scripting languages can also be used in combination with an HTTP library. For example, with Python, the Requests library can be used, and with PERL the LWP library can be used. With command line submissions, the user is responsible for the organization, storage, and persistence of all results produced. This use case expands the capabilities of individuals who are doing research where rapid, repetitive job submissions are required, a mode where the CIPRES browser interface can be unwieldy. Documentation and examples to support individuals who wish to access CRA via scripts are available on the CRA web site. Scripts that use CRA services must be registered at the CRA web site by their creators, and job submissions must include the CRA username and password, as well as the application ID provided by CIPRES when the script is registered.</p>
    </sec>
    <sec>
      <title>Access through desktop applications</title>
      <p>The CRA can also be accessed by phylogenetic applications that have a GUI and run on a user’s desktop. There are a number of community-created applications that provide a GUI for a locally installed copy of command line multiple sequence alignment and tree inference programs. Some (eg, raxml-GUI,<xref rid="b5-ebo-11-2015-043" ref-type="bibr">5</xref> and siMBa<xref rid="b6-ebo-11-2015-043" ref-type="bibr">6</xref>) support only tree inference. There are other graphical desktop applications, such as Mesquite,<xref rid="b7-ebo-11-2015-043" ref-type="bibr">7</xref> that support many forms of pre-tree data preparation and post-tree analysis, as well as alignment and tree inference. Some of these applications also provide data management, provenance, and persistence. Desktop applications like these can be adapted to make remote calls to CRA services for some or all of their sequence alignment and tree inference functions, enabling the application to handle more computationally intensive analysis than is available on the local resource where it is installed.</p>
      <p>Desktop applications that use CRA services must also be registered at the CRA web site by their developers. On registration, application developers will receive a CRA application ID that must be included in distributions of their software. Each request that an application sends to the CRA must include the application ID, together with the CRA username and password of the person running the application. This use case expands the computing power available to applications in a desktop environment.</p>
    </sec>
    <sec>
      <title>Access through web applications</title>
      <p>A number of web applications currently provide registered users with access to phylogenetic tools. These applications give their users access to some of the same phylo genetic tree-building algorithms as the CRA (eg, MrBayes, PAUP, and RAxML) or to pre-tree data preparation tools (eg, MorphoBank) and provide the infrastructure to store, organize, share, persist, and integrate results. These applications can be integrated with the CRA to give users the ability to run much larger, more computationally intensive analysis on XSEDE resources. Users gain access to phylogenetic algorithms on HPC resources without having to leave a software environment where they are already comfortable and productive, and where they have access to other integrated data and metadata for downstream visualization and analysis of the resulting alignments and phylogenetic trees.</p>
      <p>The developer of a web application such as this must register the application with the CRA and obtain an application ID, username, and password to include in its requests to the CRA. The application will authenticate to the CRA with this single username and password. Each job submission request that the application makes to the CRA will use custom request headers to identify the end user on whose behalf the submission is being made. Registered users of this type of web application do not need to register with the CRA. In fact, the use of the CRA can be as transparent to the users as the developer desires. This use case expands the capabilities of other web applications that benefit from access to powerful tree inference capabilities in their supported workflow.</p>
    </sec>
    <sec>
      <title>Registration/Authentication</title>
      <p>A key requirement of the CRA is that it must be possible to assign each submission to a specific, unique individual. Accordingly, individual users of scripted/command line and desktop clients must register for CRA access at the CRA web site. Any registered user may use <italic>and</italic> develop applications/scripts that use the CRA services.</p>
      <p>Registered applications use either “DIRECT” or “UMBRELLA” authentication. Most applications will use DIRECT authentication. With DIRECT authentication, the application uses HTTP basic authentication over https to send the username and password of the person running the application, and jobs are submitted on behalf of this user only. DIRECT authentication is appropriate for individuals creating ad hoc scripts and for installed desktop applications, where each user has his or her own copy of the client script or application. On the other hand, web applications are often designed to submit jobs on behalf of a set of registered users (eg, ViPR,<xref rid="b9-ebo-11-2015-043" ref-type="bibr">9</xref> see below), but it is disruptive to ask each user to provide additional (CRA) authentication for each submission. In this situation, UMBRELLA authentication is used: the application sends the username and password <italic>of the application’s administrator</italic> in HTTP basic authentication headers, and each job submission includes information that identifies the application user who submitted the job (typically by providing an email address). The UMBRELLA mechanism allows CIPRES to map each submission from a web application to a particular individual, but uses a single CRA account for authentication. Because UMBRELLA authentication allows web applications to submit jobs for numerous users, CIPRES requires an additional vetting process before enabling job submissions from such applications. The goal of the vetting process is simply to establish trust in the UMBRELLA web application’s user management strategy.</p>
    </sec>
    <sec>
      <title>Restrictions/Controls</title>
      <p>Although access to the CRA is provided at no cost to the user, the project has an established set of policies governing fair use of CRA resources. These are implemented as a series of controls enforced by the CRA application. Users at U.S. institutions are allowed to use up to 50,000 core hours of computational time from the CIPRES community allocation in each calendar year, and those at non- U.S. institutions are allowed up to 30,000 core hours. Individuals at institutions in the U.S. and those with collaborators in the U.S. are eligible to apply for additional computational time from the XSEDE project through a competitive allocation process. We are currently working to make it possible for users who do not have collaborators in the U.S. to purchase additional computational time at cost.</p>
      <p>Submissions made by individual users are controlled so that users do not exceed their available allocation of compute time. New submissions by a given user will be blocked whenever the number of core hours that could potentially be consumed by their currently running jobs exceeds the amount of time remaining in their allocation. For example, a user with an allocation of 30,000 core hours would not be allowed to submit more than five jobs that are configured to run on 32 cores for a maximum of 168 hours, since six such jobs would consume more than their allocation limit (32,256 core hours) if they ran for the full 168 hours. However, if these runs each completed in 1 hour, the unused time becomes available to the user again immediately.</p>
    </sec>
  </sec>
  <sec>
    <title>Usage Examples</title>
    <p>Three web applications currently are using the CRA to provide access to CIPRES resources: MorphoBank,<xref rid="b10-ebo-11-2015-043" ref-type="bibr">10</xref>,<xref rid="b11-ebo-11-2015-043" ref-type="bibr">11</xref> IRD,<xref rid="b8-ebo-11-2015-043" ref-type="bibr">8</xref> and ViPR.<xref rid="b9-ebo-11-2015-043" ref-type="bibr">9</xref> MorphoBank supports scoring morphological characters, particularly by collaborative teams to create matrices for inferring phylogenetic trees. Matrices are the raw data that are used to build phylogenetic trees, and they consist of scientific observations about the distribution of heritable traits (“characters”) such as molecular sequence data, anatomy, physiology, or behavior. The creation of “supermatrices” is the well-established practice of “combining all systematic characters into a single, giant phylogenetic matrix and then analyzing all the characters simultaneously”<xref rid="b2-ebo-11-2015-043" ref-type="bibr">2</xref> so that all traits may impact tree structure. The organization and databasing of traits such as anatomy, physiology, and behavior that form parts of supermatrices is relatively challenging and complex, often requiring image display and metadata tools, and the web application MorphoBank was built to assist scientists who are collecting and databasing such information. MorphoBank has a highly developed interface for scoring characters, organizing and archiving metadata about characters (eg, notes, citations), and adding media that can be zoomed and labeled to illustrate what is meant by a particular homology. It automatically archives these matrices and metadata, as well as other supporting materials (eg, trees) associated with peer-reviewed phylogenetic work. Prior to adopting the CRA, it had no support for running tree inference on user-created matrices. Developers at MorphoBank incorporated tree inference via the CRA by creating a web form that allows users to configure runs for the parsimony tool PAUPrat (<xref ref-type="fig" rid="f1-ebo-11-2015-043">Fig. 1</xref>) seamlessly without leaving the MorphoBank web site. On submission, MorphoBank creates the necessary instruction set, forwards the job submission to the CRA, retrieves the results, and displays them in the user area for download. The implementation of PAUPrat represents a proof-of-concept exercise to test the integration of CIPRES tools into the MorphoBank workflow. Integration of additional CRA tools into the MorphoBank site is planned.</p>
    <p>The IRD and ViPR are public database and analysis resources for the study of influenza viruses and Category A–C priority pathogens, respectively. Both resources provide a workbench with integrated database and computational support for virus research. The IRD and ViPR web applications natively support tree inference and other computational biology methods using several community tools. IRD and ViPR have historically provided web forms and required infrastructure to manage job submissions and results retrieval. However, with the continued growth of available data, IRD/ViPR developers sought a mechanism to support analysis tasks that exceeded the capacity of their available compute resources. Using the CRA, IRD/ViPR now facilitates direct access to the RAxML tool on XSEDE (RAXMLHPC2_TGB) through their existing phylogenetic tree analysis portal. The tree analysis input page in IRD/ViPR allows users to configure parameters for RAxML runs. On submission, when the number and size of the input sequences exceeds a prespecified threshold, a light-box appears to recommend that the user submit their job to CIPRES through the existing IRD/ViPR interface (<xref ref-type="fig" rid="f2-ebo-11-2015-043">Fig. 2</xref>). A REST client using the Jersey framework implemented in IRD/ViPR then communicates with the RESTful services at CIPRES. After jobs are successfully submitted to CIPRES, IRD and ViPR periodically poll the job status and retrieve the results once the jobs are finished. The results are then saved to the user’s private workbench area in IRD or ViPR for further use. Thus, the results obtained either from local IRD and VIPR or CIPRES resources can be accessed, visualized, and analyzed seamlessly by the user without ever leaving the IRD and ViPR web sites.</p>
  </sec>
  <sec>
    <title>Future Directions</title>
    <p>Our ongoing development plans include incorporating CRA services into the desktop applications such as raxmlGUI,<xref rid="b5-ebo-11-2015-043" ref-type="bibr">5</xref> siMBa,<xref rid="b6-ebo-11-2015-043" ref-type="bibr">6</xref> and Mesquite.<xref rid="b7-ebo-11-2015-043" ref-type="bibr">7</xref> Each of these applications can run one or more tree inference codes on the desktop. In all cases, we are working to implement the ability to submit large tree inference calculations to the CRA from within these desktop applications. The highly developed graphical interfaces for each of these tools will make it easy for users to configure their analyses on the desktop, and submission of the jobs to CIPRES will free up the desktop machine for other tasks. CRA services will also be made available through the web application offered by the National Center for Genome Analysis Support (NCGAS<xref rid="b22-ebo-11-2015-043" ref-type="bibr">22</xref>). Plans are also under way to incorporate CRA services into the bioKepler workflow tool,<xref rid="b23-ebo-11-2015-043" ref-type="bibr">23</xref> so that CRA tree inference services can be incorporated into more complex workflows in a visual programming environment.</p>
    <p>The CIPRES group is developing worked examples/code samples to help individual scientists who wish to access the CRA using command line/scripting tools and will support users who wish to incorporate the CRA services into their applications. Java and Python examples are available from the CRA web site <ext-link ext-link-type="uri" xlink:href="https://www.phylo.org/restusers">https://www.phylo.org/restusers</ext-link>. Perl and Javascript examples will be available in the near future.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors wish also to thank the support staff of the XSEDE project and system administrators of the Trestles, Gordon, and TSCC computers at SDSC for their help in managing issues as they arose.</p>
  </ack>
  <fn-group>
    <fn id="fn2-ebo-11-2015-043">
      <p><bold>ACADEMIC EDITOR:</bold> Jike Cui, Associate Editor</p>
    </fn>
    <fn id="fn3-ebo-11-2015-043">
      <p><bold>FUNDING:</bold> The work described here was supported by NSF DBI-1262628 and a generous award (TG-DEB090011) of computer time and development support from the XSEDE project (also sponsored by the U.S. National Science Foundation). MorphoBank development work was sponsored by NSF DEB–1208270. The IRD and ViPR development work was funded by NIAID contracts HHSN272200900041C and HHSN272201400028C. Initial software development for the workbench framework was also supported by NIH GM73931-01. The authors confirm that the funder had no influence over the study design, content of the article, or selection of this journal.</p>
    </fn>
    <fn id="fn4-ebo-11-2015-043">
      <p><bold>COMPETING INTERESTS:</bold> Authors disclose no potential conflicts of interest.</p>
    </fn>
    <fn id="fn5-ebo-11-2015-043">
      <p>Paper subject to independent expert blind peer review by minimum of two reviewers. All editorial decisions made by independent academic editor. Upon submission manuscript was subject to anti-plagiarism scanning. Prior to publication all authors have given signed confirmation of agreement to article publication and compliance with all applicable ethical and legal requirements, including the accuracy of author and contributor information, disclosure of competing interests and funding sources, compliance with ethical requirements relating to human and animal study participants, and compliance with any copyright requirements of third parties. This journal is a member of the Committee on Publication Ethics (COPE).</p>
    </fn>
    <fn id="fn6-ebo-11-2015-043">
      <p>
        <bold>Author Contributions</bold>
      </p>
      <p>Conceived and designed the experiments: TS, SK, SH. Ana-lyzed the data: TS, SK, SH, MP. Wrote the first draft of the manuscript: MAM. Contributed to the writing of the manuscript: TS, EBK, MO. Agree with manuscript results and conclusions: MAM, TS, BEP, SH, EBK, RHS, MP, SK, MO. Jointly developed the structure and arguments for the paper: MAM, TS, MO, EBK. Made critical revisions and approved final version: MAM, TS, EBK, RHS, MO. All authors reviewed and approved of the final manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1-ebo-11-2015-043">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Alphonse</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alverson</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation phenomics for the tree of life</article-title>
        <source>PLoS Curr</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="b2-ebo-11-2015-043">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Queiroz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The supermatrix approach to systematics</article-title>
        <source>Trends Ecol Evol</source>
        <year>2007</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>34</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="pmid">17046100</pub-id>
      </element-citation>
    </ref>
    <ref id="b3-ebo-11-2015-043">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bloch</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>The placental mammal ancestor and the post–K-Pg radiation of placentals</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <issue>6120</issue>
        <fpage>662</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">23393258</pub-id>
      </element-citation>
    </ref>
    <ref id="b4-ebo-11-2015-043">
      <label>4</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Pfeiffer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Creating the CIPRES Science Gateway for Inference of Large Phylogenetic Trees</source>
        <conf-name>SC10 Workshop on Gateway Computing Environments (GCE10)</conf-name>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="b5-ebo-11-2015-043">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silvestro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Michalak</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>raxmlGUI: a graphical front-end for RAxML</article-title>
        <source>Org Divers Evol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>335</fpage>
        <lpage>7</lpage>
      </element-citation>
    </ref>
    <ref id="b6-ebo-11-2015-043">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mishra</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thines</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>siMBa—a simple graphical user interface for the Bayesian phylogenetic inference program MrBayes</article-title>
        <source>Mycol Prog</source>
        <year>2014</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>1255</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="b7-ebo-11-2015-043">
      <label>7</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <source>Mesquite: A Modular System for Evolutionary Analysis Version 2.5</source>
        <year>2008</year>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org">http://mesquiteproject.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="b8-ebo-11-2015-043">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Squires</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Noronha</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Influenza research database: an integrated bioinformatics resource for influenza research and surveillance</article-title>
        <source>Influenza Other Respi Viruses</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>6</issue>
        <fpage>404</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="b9-ebo-11-2015-043">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickett</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Sadat</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViPR: an open bioinformatics database and analysis resource for virology research</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D593</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">22006842</pub-id>
      </element-citation>
    </ref>
    <ref id="b10-ebo-11-2015-043">
      <label>10</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary MA</surname>
            <given-names>Kaufman SG</given-names>
          </name>
        </person-group>
        <source>MorphoBank 3.0: Web Application for Morphological Phylogenetics and Taxonomy</source>
        <year>2012</year>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.morphobank.org">http://www.morphobank.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="b11-ebo-11-2015-043">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary MA</surname>
            <given-names>Kaufman S</given-names>
          </name>
        </person-group>
        <article-title>MorphoBank: phylophenomics in the “cloud”</article-title>
        <source>Cladistics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>529</fpage>
        <lpage>37</lpage>
      </element-citation>
    </ref>
    <ref id="b12-ebo-11-2015-043">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title>
        <source>BMC Evol Biol</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>214</fpage>
        <pub-id pub-id-type="pmid">17996036</pub-id>
      </element-citation>
    </ref>
    <ref id="b13-ebo-11-2015-043">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouckaert</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kühnert</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BEAST 2: a software platform for bayesian evolutionary analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>e1003537</fpage>
        <pub-id pub-id-type="pmid">24722319</pub-id>
      </element-citation>
    </ref>
    <ref id="b14-ebo-11-2015-043">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2 – approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>e9490</fpage>
        <pub-id pub-id-type="pmid">20224823</pub-id>
      </element-citation>
    </ref>
    <ref id="b15-ebo-11-2015-043">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zwickl</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <source>Genetic Algorithm Approaches for the Phylogenetic Analysis of Large Biological Sequence Datasets Under the Maximum Likelihood Criterion</source>
        <publisher-loc>Austin, TX</publisher-loc>
        <publisher-name>The University of Texas at Austin</publisher-name>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="b16-ebo-11-2015-043">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darriba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taboada</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Doallo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>jModelTest 2: more models, new heuristics and parallel computing</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>772</fpage>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/nmeth/journal/v9/n8/abs/nmeth.2109.html">http://www.nature.com/nmeth/journal/v9/n8/abs/nmeth.2109.html</ext-link></comment>
        <pub-id pub-id-type="pmid">22847109</pub-id>
      </element-citation>
    </ref>
    <ref id="b17-ebo-11-2015-043">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Parallelization of the MAFFT multiple sequence alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>15</issue>
        <fpage>1899</fpage>
        <lpage>900</lpage>
        <pub-id pub-id-type="pmid">20427515</pub-id>
      </element-citation>
    </ref>
    <ref id="b18-ebo-11-2015-043">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>MrBayes: Bayesian inference of phylogeny</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>754</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">11524383</pub-id>
      </element-citation>
    </ref>
    <ref id="b19-ebo-11-2015-043">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lartillot</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lepage</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Blanquart</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PhyloBayes 3: a Bayesian software package for phylogenetic reconstruction and molecular dating</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>2286</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">19535536</pub-id>
      </element-citation>
    </ref>
    <ref id="b20-ebo-11-2015-043">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1312</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="pmid">24451623</pub-id>
      </element-citation>
    </ref>
    <ref id="b21-ebo-11-2015-043">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rifaieh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Unwin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carver</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>SWAMI: Integrating biological databases and analysis tools within user friendly environment</article-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Cohen-Boulakia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tannen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Data Integration in Life Sciences</source>
        <volume>4544</volume>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <year>2007</year>
        <fpage>48</fpage>
        <lpage>58</lpage>
      </element-citation>
    </ref>
    <ref id="b22-ebo-11-2015-043">
      <label>22</label>
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>National Center for Genome Analysis Support</source>
        <year>2013</year>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://ncgas.org/index.php">http://ncgas.org/index.php</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="b23-ebo-11-2015-043">
      <label>23</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Altintas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crawl</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Challenges and approaches for distributed workflow-driven analysis of large-scale biological data</source>
        <conf-name>Proceedings of the Workshop on Data analytics in the Cloud at EDBT/ICDT 2012 Conference, DanaC2012</conf-name>
        <year>2012</year>
        <fpage>73</fpage>
        <lpage>78</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="f1-ebo-11-2015-043" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Screen shot showing web form for access to PAUPRat in MorphoBank.</p>
    </caption>
    <graphic xlink:href="ebo-11-2015-043f1"/>
  </fig>
  <fig id="f2-ebo-11-2015-043" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Screen shot showing IRD/ViPR lightbox pop up, prompting user to choose the option of running the analysis task using the CIPRES resource.</p>
    </caption>
    <graphic xlink:href="ebo-11-2015-043f2"/>
  </fig>
</floats-group>
