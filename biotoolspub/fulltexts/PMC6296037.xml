<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6296037</article-id>
    <article-id pub-id-type="publisher-id">2557</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2557-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>NIPTeR</italic>: an R package for fast and accurate trisomy prediction in non-invasive prenatal testing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4914-3737</contrib-id>
        <name>
          <surname>Johansson</surname>
          <given-names>Lennart F.</given-names>
        </name>
        <address>
          <email>l.johansson@umcg.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Weerd</surname>
          <given-names>Hendrik A.</given-names>
        </name>
        <address>
          <email>dirkdeweerd.work@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Boer</surname>
          <given-names>Eddy N.</given-names>
        </name>
        <address>
          <email>e.n.de.boer@umcg.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Dijk</surname>
          <given-names>Freerk</given-names>
        </name>
        <address>
          <email>freerk.van.dijk@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>te Meerman</surname>
          <given-names>Gerard J.</given-names>
        </name>
        <address>
          <email>g.j.te.meerman@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sijmons</surname>
          <given-names>Rolf H.</given-names>
        </name>
        <address>
          <email>r.h.sijmons@umcg.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sikkema-Raddatz</surname>
          <given-names>Birgit</given-names>
        </name>
        <address>
          <email>b.sikkema01@umcg.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Swertz</surname>
          <given-names>Morris A.</given-names>
        </name>
        <address>
          <email>m.a.swertz@umcg.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9558 4598</institution-id><institution-id institution-id-type="GRID">grid.4494.d</institution-id><institution>Department of Genetics, </institution><institution>University of Groningen, University Medical Center Groningen, </institution></institution-wrap>Groningen, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9558 4598</institution-id><institution-id institution-id-type="GRID">grid.4494.d</institution-id><institution>Genomics Coordination Center, </institution><institution>University of Groningen, University Medical Center Groningen, </institution></institution-wrap>Groningen, The Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2254 0954</institution-id><institution-id institution-id-type="GRID">grid.412798.1</institution-id><institution>School of Bioscience, Systems biology research center, </institution><institution>University of Skövde, </institution></institution-wrap>Skövde, Sweden </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>531</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Various algorithms have been developed to predict fetal trisomies using cell-free DNA in non-invasive prenatal testing (NIPT). As basis for prediction, a control group of non-trisomy samples is needed. Prediction accuracy is dependent on the characteristics of this group and can be improved by reducing variability between samples and by ensuring the control group is representative for the sample analyzed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2"><italic>NIPTeR</italic> is an open-source R Package that enables fast NIPT analysis and simple but flexible workflow creation, including variation reduction, trisomy prediction algorithms and quality control. This broad range of functions allows users to account for variability in NIPT data, calculate control group statistics and predict the presence of trisomies.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3"><italic>NIPTeR</italic> supports laboratories processing next-generation sequencing data for NIPT in assessing data quality and determining whether a fetal trisomy is present. <italic>NIPTeR</italic> is available under the GNU LGPL v3 license and can be freely downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/molgenis/NIPTeR">https://github.com/molgenis/NIPTeR</ext-link> or CRAN.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2557-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>NIPT</kwd>
      <kwd>Trisomy prediction</kwd>
      <kwd>Next-generation sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Genius</institution>
        </funding-source>
        <award-id>CVON-2011-19</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NWO VIDI</institution>
        </funding-source>
        <award-id>917.164.455</award-id>
        <principal-award-recipient>
          <name>
            <surname>Swertz</surname>
            <given-names>Morris A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Non-invasive prenatal testing (NIPT) is rapidly becoming the new standard in prenatal screening for fetal aneuploidy [<xref ref-type="bibr" rid="CR1">1</xref>]. In NIPT, cell-free DNA from the pregnant woman’s blood plasma, which consists of both maternal and fetal DNA fragments, is analysed. Next to SNP-based methods [<xref ref-type="bibr" rid="CR2">2</xref>], low-coverage whole genome next-generation sequencing (NGS) is often used [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], and various algorithms, software programs and packages have been developed to analyse this type of data [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. In literature, many methods have been described that depend on a statistical comparison between a sample of interest and a reference set of non-trisomy control samples [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The <italic>RAPIDR</italic> and <italic>DASAF</italic> R packages, for instance, have been described [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] and they made several of these algorithms available, including GC-correction, the standard Z-score and the Normalized Chromosome Value (NCV), to create an analysis workflow in R. However, those packages lack features like chi-squared-based variation reduction (χ<sup>2</sup>VR), regression-based Z-score (RBZ) and Match QC. These are all algorithms that we have extensively discussed before [<xref ref-type="bibr" rid="CR11">11</xref>]. In short, χ<sup>2</sup>VR detects chromosomal regions that have a higher variability than expected by chance and reduces their weight so that, after correction, they have less impact on the fraction of reads mapped to the different chromosomes. The RBZ is an alternative Z-score calculation based on stepwise regression with forward selection. In the RBZ positive or negative correlation between chromosomal fractions is used to predict the number of reads to map onto the chromosome of interest if no trisomy is present. The Match QC score is a sum-of-squares-based approach to compare chromosomal fractions between the test sample and controls, and it provides a measure by which to determine whether a control group is representative for a specific sample. Here we report <italic>NIPTeR</italic>, an R package that provides fast NIPT analysis for research and diagnostics and provides users with multiple methods for variation reduction, prediction and quality control based upon comparison of a sample with a set of negative control samples.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par10"><italic>NIPTeR</italic> users can create different workflows for variation reduction and aneuploidy prediction using thirteen functions as building blocks (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). A stepwise practical example for using these building blocks is presented as a case report in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow and functions of <italic>NIPTeR</italic>. <bold>a</bold> A BAM file is transformed into an NIPTSample object; <bold>b</bold> a series of NIPTSample objects can then be transformed into an NIPTControlGroup object; <bold>c</bold> optional LOESS or weighted bin GC correction; <bold>d</bold> optional chi-squared-based variation reduction; <bold>e</bold> optional comparison of NIPTSample and NIPTControlGroup and possible selection of a subset that best-matches the control group samples; <bold>f</bold> three different prediction methods: Z-score, normalized chromosome value or regression-based Z-score; <bold>g</bold> optional check of control group statistics</p></caption><graphic xlink:href="12859_2018_2557_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par11"><italic>NIPTeR</italic> analysis uses two core objects. The first object is <italic>NIPTSample</italic>, which contains the counts of aligned sequence reads in 50,000 bp bins for a specific sample. The second object is <italic>NIPTControlGroup</italic>, which contains a series of NIPTSamples for comparison. Users generate <italic>NIPTSample</italic> using the function <italic>bin_bam_sample</italic>, which needs a BAM file [<xref ref-type="bibr" rid="CR14">14</xref>] as input. The user can optionally select to count reads mapped to the forward and reverse strands separately, so that they can each be used as a separate predictor. The <italic>as_control_group</italic> function converts a series of <italic>NIPTSample</italic> objects into a <italic>NIPTControlGroup</italic>. Within <italic>NIPTeR</italic>, users can manage an existing <italic>NIPTControlGroup</italic> using the <italic>add_samples_controlgroup</italic>, <italic>remove_sample_controlgroup</italic> and <italic>remove_duplicates_controlgroup</italic> functions.</p>
    <p id="Par12">Both <italic>NIPTSample</italic> and <italic>NIPTControlGroup</italic> can undergo one or more variation reduction steps to adjust the bin read counts, either using the <italic>gc_correct</italic> function for weighted bin GC correction [<xref ref-type="bibr" rid="CR10">10</xref>] or LOESS GC correction [<xref ref-type="bibr" rid="CR15">15</xref>] or the <italic>chi_correct</italic> function for χ<sup>2</sup>VR. Each <italic>NIPTSample</italic> object shows the correction status for the autosomes and the sex chromosomes separately and indicates which variation reduction methods have been performed (or that they are ‘uncorrected’). χ<sup>2</sup>VR can be applied to uncorrected or GC-corrected samples, and makes use of a <italic>NIPTSample</italic> and a <italic>NIPTControlGroup</italic> having an identical correction status.</p>
    <p id="Par13">Using the fractions of reads mapped to the different chromosomes, trisomy prediction can be generated for a given <italic>NIPTSample</italic> based on the <italic>NIPTControlGroup</italic> using three different prediction algorithms: (1) <italic>calculate_z_score</italic>, which uses a standard Z-score [<xref ref-type="bibr" rid="CR3">3</xref>]; (2) <italic>calculate_ncv_score</italic>, which uses an NCV [<xref ref-type="bibr" rid="CR4">4</xref>]; and (3) <italic>perform_regression</italic>, which uses RBZ. All three trisomy prediction functions use <italic>NIPTControlGroup</italic> to calculate the expected fraction of reads on the chromosome of interest. For NCV, this calculation is done in a separate function, <italic>prepare_ncv</italic>, because the calculation is time-intensive and only has to be performed once for each <italic>NIPTControlGroup</italic>. The prediction functions then compare the observed fraction of reads of the chromosome of interest in the <italic>NIPTSample</italic> with the expected fraction. In NCV and RBZ calculations, users have the option of excluding selected chromosomes as predictors. Since chromosomes 13, 18 and 21 are the most likely candidates for a trisomy, these are excluded by default, but users do have the option of including them. The functions <italic>prepare_ncv</italic> and <italic>perform_regression</italic> provide users the option of using a train and test set to prevent over-fitting the models they create.</p>
    <p id="Par14">In addition to providing Z-scores, the functions also produce control group statistics. The function <italic>match_control_group</italic> provides a Match QC score, a calculation that shows how well the sample fits within the control group based on the fraction of reads mapped to the different chromosomes, a measure that can be shown in a report. Alternately, users can select a subset of best-matching control samples as a sample-specific control group using the arguments mode = “report” or “subset”. When a sample has an anomalously high Match QC score, the control samples being used are not suitable as a control group for the sample being analyzed. A second quality control function, <italic>diagnose_control_group</italic>, calculates Z-scores for all samples and chromosomes in a <italic>NIPTControlGroup</italic> as well as the mean, standard deviation and Shapiro-Wilk test of those Z-scores. This information can be used to curate the control group as explained in detail in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>Workflow</title>
      <p id="Par15">All these <italic>NIPTeR</italic> building blocks can be combined into an analysis workflow. For example, the <italic>NIPTeR</italic> workflow for the Fan &amp; Quake analysis [<xref ref-type="bibr" rid="CR10">10</xref>], using a weighted bin GC correction and a standard Z-score prediction for trisomy 21, and given a GC-corrected control group is:</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Figa_HTML" id="MO2"/>
      <p id="Par16">In addition, control group statistics and the match control of the sample to the control group can be performed:</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Figb_HTML" id="MO3"/>
    </sec>
    <sec id="Sec5">
      <title>Prediction and control group statistics</title>
      <p id="Par17">The output formats of the <italic>calculate_z_score</italic> and <italic>calculate_ncv_score</italic> functions are similar. An example result of the main output reads:</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Figc_HTML" id="MO4"/>
      <p id="Par18">Here, the Z-score is 0.45, which falls within the − 3 to 3 range and leads to the conclusion that this sample does not have a trisomy 21. The control_group_statistics show the mean fraction of sequence reads mapping to chromosome 21 and the standard deviation (SD) of the fractions between the control samples. The Shapiro_P_value tests for control group normality, and control groups with a value above 0.05 can be considered to be normally distributed.</p>
      <p id="Par19">The output of <italic>perform_regression</italic> is slightly different and gives four predictions based on different models when set to the default setting:</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Figd_HTML" id="MO5"/>
      <p id="Par20">Here, in addition to the RBZ, the coefficient of variation (CV) of the test set is given as a measure of control group variability. The type of CV is given as well, in which “Practical CV” is the true CV. If there is a risk of over-fitting the model on the control set, a theoretical CV is used. In addition to the Shapiro <italic>P</italic> value, <italic>perform_regression</italic> reports the mean of the test set (which should be close to one) and the CV of the training set (based on which the chromosomes used to create the prediction model are selected), where reads mapped to the forward and reverse strands are used as separate entities.</p>
    </sec>
    <sec id="Sec6">
      <title>Quality control</title>
      <p id="Par21">Using the <italic>diagnose_control_group</italic> function, control samples that have outliers that could hamper prediction can be detected.</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Fige_HTML" id="MO6"/>
      <p id="Par22">This example shows that, for many chromosomes in sample 21 one or both of the strands have a Z-score higher than 3. This means that there is more variability in this sample than expected, pointing to a low quality sample. As explained in more detail in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, we recommend that users remove samples that have more than one aberrant score (Z-score outside the − 3 to 3 range) from the control group.</p>
      <p id="Par23">When looking at the individual Match QC scores of the GC corrected <italic>NIPTSample</italic> compared to the GC corrected <italic>NIPTControlGroup</italic>, the list of sum of squares of differences in chromosomal fractions of the test sample compared to each control sample is shown:</p>
      <graphic position="anchor" xlink:href="12859_2018_2557_Figf_HTML" id="MO7"/>
      <p id="Par24">In general, the lower the sum of squares, the more representative a control sample is for the test sample. The average of all sum of squares for an <italic>NIPTSample</italic> is the Match QC score. A Match QC score for a specific sample that falls outside 3 SD of the control group Match QC, indicates that the control group is not suitable for analysis of the sample.</p>
      <p id="Par25">Further examples and results can be found in the <italic>NIPTeR</italic> package vignette [<xref ref-type="bibr" rid="CR16">16</xref>] and the case report provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. A demonstration of the <italic>NIPTeR</italic> GC-correction methods is given in Additional file <xref rid="MOESM2" ref-type="media">2</xref> and a comparison of <italic>NIPTeR</italic> results with manual calculations is available for the χ2VR in Additional file <xref rid="MOESM3" ref-type="media">3</xref> and for the prediction methods and Match QC score in Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p>
      <p id="Par26">The <italic>NIPTeR</italic> package requires R 3.1.0 or higher, the stats and sets packages as available on CRAN, and the RSamtools and S4Vectors Bioconductor packages.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance</title>
      <p id="Par27"><italic>NIPTeR</italic> performance was tested on three different machines and operating systems (Additional file <xref rid="MOESM5" ref-type="media">5</xref>). Given a pre-processed control group of 100 samples, one sample was processed in 3 to 4 min (on average), including both GC correction and χ<sup>2</sup>VR and using the Z-score and RBZ as prediction algorithms for chromosomes 13, 18 and 21. NCV analysis was performed in an additional 1 to 6 min using a maximum number of 6 to 9 chromosomes as denominator.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par28"><italic>NIPTeR</italic> allows for fast NIPT analysis and flexible workflow creation and includes variation correction and prediction algorithms as well as QC control. Algorithms used in <italic>NIPTeR</italic> are validated as described in Johansson and de Boer et al. (2017) [<xref ref-type="bibr" rid="CR11">11</xref>]. <italic>NIPTeR</italic> is available under the GNU GPL open source license and can be freely downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/molgenis/NIPTeR">https://github.com/molgenis/NIPTeR</ext-link> or CRAN.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p id="Par29"><bold> Project name:</bold> NIPTeR.</p>
    <p id="Par30">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=NIPTeR">https://CRAN.R-project.org/package=NIPTeR</ext-link>
    </p>
    <p id="Par31">
      <bold>Source page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/molgenis/NIPTeR">https://github.com/molgenis/NIPTeR</ext-link>
    </p>
    <p id="Par32"><bold>Operating system(s)</bold>: Linux, MacOS, Windows.</p>
    <p id="Par33"><bold>Programming language:</bold> R.</p>
    <p id="Par34"><bold>Other requirements:</bold> R (3.1.0 or higher), RSamtools, sets, stats, S4Vectors.</p>
    <p id="Par35"><bold>Licence:</bold> GNU Lesser General Public License v3.0.</p>
    <p id="Par36"><bold>Any restrictions to use by non-academics:</bold> none.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec10">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2557_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>A step by step case report describing how to create a control group and how to analyse a sample using <italic>NIPTeR</italic>. (DOCX 53 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2018_2557_MOESM2_ESM.docx">
            <label>Additional file 2:</label>
            <caption>
              <p>Supplemental information showing the functionality of <italic>NIPTeR</italic> bin and LOESS GC correction. (DOCX 682 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2018_2557_MOESM3_ESM.xlsx">
            <label>Additional file 3:</label>
            <caption>
              <p>Supplemental information comparing the <italic>NIPTeR</italic> chi-squared based variation reduction calculation with a manual calculation. (XLSX 67 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2018_2557_MOESM4_ESM.xlsx">
            <label>Additional file 4:</label>
            <caption>
              <p>Supplemental information comparing the manual calculations for the standard Z-score, Normalized Chromosome Value, Regression-based Z-score and the Match QC with <italic>NIPTeR</italic> calculations. (XLSX 426 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2018_2557_MOESM5_ESM.xlsx">
            <label>Additional file 5:</label>
            <caption>
              <p>Supplemental information showing run times per <italic>NIPTeR</italic> function on Linux, MacIntosh and Windows platforms. (XLSX 29 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CV</term>
        <def>
          <p id="Par4">Coefficient of variation</p>
        </def>
      </def-item>
      <def-item>
        <term>NCV</term>
        <def>
          <p id="Par5">Normalized Chromosome Value</p>
        </def>
      </def-item>
      <def-item>
        <term>NIPT</term>
        <def>
          <p id="Par6">Non-invasive prenatal testing</p>
        </def>
      </def-item>
      <def-item>
        <term>RBZ</term>
        <def>
          <p id="Par7">Regression based Z-score</p>
        </def>
      </def-item>
      <def-item>
        <term>χ<sup>2</sup>VR</term>
        <def>
          <p id="Par8">Chi-squared based variation reduction</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Kate Mc Intyre for editorial advice.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par37">FvD is supported by the Netherlands CardioVascular Research Initiative (CVON2011–19; Genius). We also acknowledge the Netherlands Organization or Scientific Research (NOW) VIDI grant number 917.164.455 to MS. No funding body influenced the development of this software or the writing of the manuscript.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LJ is the main author. LJ and HdW conceived and designed the <italic>NIPTeR</italic> package. Together with FvD they developed and implemented the application. LJ, HdW, EdB and GtM designed and validated algorithms and implementation. RS, BS and MS were responsible for project administration and supervision. All authors read and approved the final version of this manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar3">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allyse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Minear</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Berson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sridhar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rote</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandrasekharan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Non-invasive prenatal testing: a review of international implementation and challenges</article-title>
        <source>Int J Womens Health</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>113</fpage>
        <lpage>126</lpage>
        <pub-id pub-id-type="doi">10.2147/IJWH.S67124</pub-id>
        <pub-id pub-id-type="pmid">25653560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zimmerman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sigurionsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westmeyer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saucier</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-invasive prenatal detection of trisomy 13 using a single nucleotide polymorphism- and informatics-based approach</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>e96677</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0096677</pub-id>
        <pub-id pub-id-type="pmid">24805989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>RWK</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>KCA</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>VYM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>TY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Noninvasive prenatal diagnosis of fetal chromosomal aneuploidy by massively parallel genomics sequencing of DNA in maternal plasma</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>20458</fpage>
        <lpage>20463</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0810641105</pub-id>
        <pub-id pub-id-type="pmid">19073917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sehnert</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rhees</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Comstock</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>de Feo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Heilek</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rava</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>Optimal detection of fetal chromosomal abnormalities by massively parallel DNA sequencing of cell-free fetal DANN from maternal blood</article-title>
        <source>Clin Chem</source>
        <year>2011</year>
        <volume>57</volume>
        <fpage>1042</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2011.165910</pub-id>
        <pub-id pub-id-type="pmid">21519036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Chen Z. Development of Bioinformatics Algorithms for Trisomy 13 and 18 Detection by Next Generation Sequencing of Maternal Plasma DNA 2011. The Chinese University of Hong Kong.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Straver</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sistermans</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Visser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Oudejans</surname>
            <given-names>CBM</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
        </person-group>
        <article-title>WISECONDOR: detection of fetal aberrations from shallow sequencing maternal plasma based on a within-sample comparison scheme</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>5</issue>
        <fpage>e31</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt992</pub-id>
        <pub-id pub-id-type="pmid">24170809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Yang J, Ding X and Zhu W. Improving the calling of non-invasive prenatal testing on 13−/18−/21-trisomy by support vector machine discrimination, <italic>BioRxiv</italic> Preprint first posted online Nov 9, 2017.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sauk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zilina</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kurg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ustay</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paluoja</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roost</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NIPTmer: rapid k-mer-based software package for detection of fetal aneuploidies</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>5616</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-23589-8</pub-id>
        <pub-id pub-id-type="pmid">29618827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Pham M-D, Nguyen TV, Trinh HNT, Vo BT, Nguyen TM, Nguyen NH, et al. Establishing and validating noninvasive prenatal testing procedure for fetal aneuploidies in Vietnam. J Matern Neonatal Med. 2018. 10.1080/14767058.2018.1481032.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Sensitivity of noninvasive prenatal detection of fetal aneuploidy from maternal plasma using shotgun sequencing is limited only by statistics</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e10439</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0010439</pub-id>
        <pub-id pub-id-type="pmid">20454671</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johansson</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>de Boer</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>de Weerd</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>van Dijk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Elferink</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Schuring-Blom</surname>
            <given-names>GH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel algorithms for improved sensitivity in non-invasive prenatal testing</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1838</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-02031-5</pub-id>
        <pub-id pub-id-type="pmid">28500333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Boustred</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chitty</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Plagnol</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>RAPIDR: an analysis package for non-invasive prenatal testing of aneuploidy</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2965</fpage>
        <lpage>2967</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu419</pub-id>
        <pub-id pub-id-type="pmid">24990604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Liu B, Tang X, Qiu F, Tao C, Gao J, Ma M, et al. DASAF: an R package for deep sequencing-based detection of fetal autosomal abnormalities from maternal cell-free DNA. Biomed Res Int. 2016:2714341.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/MAP format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>RWK</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Akolekar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>KCA</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>TY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Noninvasive prenatal diagnosis of fetal trisomy 18 and trisomy 13 by maternal plasma DNA sequencing</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e21791</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0021791</pub-id>
        <pub-id pub-id-type="pmid">21755002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Johansson LF, de Weerd HA. NIPTeR vignette. 2016 [Online] <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/NIPTeR/vignettes/NIPTeR.html">https://cran.r-project.org/web/packages/NIPTeR/vignettes/NIPTeR.html</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
