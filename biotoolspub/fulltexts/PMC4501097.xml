<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4501097</article-id>
    <article-id pub-id-type="pmid">25944252</article-id>
    <article-id pub-id-type="publisher-id">647</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-015-0647-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Popic</surname>
          <given-names>Victoria</given-names>
        </name>
        <address>
          <email>viq@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salari</surname>
          <given-names>Raheleh</given-names>
        </name>
        <address>
          <email>rahelehs@cs.stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hajirasouliha</surname>
          <given-names>Iman</given-names>
        </name>
        <address>
          <email>imanh@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kashef-Haghighi</surname>
          <given-names>Dorna</given-names>
        </name>
        <address>
          <email>dkashef@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>West</surname>
          <given-names>Robert B</given-names>
        </name>
        <address>
          <email>rbwest@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Batzoglou</surname>
          <given-names>Serafim</given-names>
        </name>
        <address>
          <email>serafim@cs.stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Computer Science, Stanford University, Stanford, CA USA </aff>
      <aff id="Aff2"><label/>Department of Pathology, Stanford University School of Medicine, Stanford, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <issue>1</issue>
    <elocation-id>91</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>4</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Popic et al. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Somatic variants can be used as lineage markers for the phylogenetic reconstruction of cancer evolution. Since somatic phylogenetics is complicated by sample heterogeneity, novel specialized tree-building methods are required for cancer phylogeny reconstruction. We present LICHeE (Lineage Inference for Cancer Heterogeneity and Evolution), a novel method that automates the phylogenetic inference of cancer progression from multiple somatic samples. LICHeE uses variant allele frequencies of somatic single nucleotide variants obtained by deep sequencing to reconstruct multi-sample cell lineage trees and infer the subclonal composition of the samples. LICHeE is open source and available at <ext-link ext-link-type="uri" xlink:href="http://viq854.github.io/lichee">http://viq854.github.io/lichee</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-015-0647-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Cancer is driven by the accumulation of somatic mutations that confer fitness advantages to the tumor cells. Numerous studies have shown tumors to be highly heterogeneous, consisting of mixtures of cell subpopulations with distinct sets of somatic variants (for example see review papers [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>]). With the advent of next-generation sequencing technologies, many large-scale efforts are underway to catalog the somatic mutational events driving the progression of cancer [<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref>] and infer the phylogenetic relationships of tumor subclones. Characterizing the heterogeneity and inferring tumor phylogenies are key steps for developing targeted cancer therapies [<xref ref-type="bibr" rid="CR5">5</xref>] and understanding the biology and progression of cancer.</p>
    <p>To reconstruct tumor phylogenies, studies have utilized variant allele frequency (VAF) data of somatic single nucleotide variants (SSNVs) obtained by whole-genome [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref>], exome [<xref ref-type="bibr" rid="CR8">8</xref>], and targeted deep sequencing [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR9">9</xref>]. Clustering of SSNVs based on VAF similarity [<xref ref-type="bibr" rid="CR10">10</xref>-<xref ref-type="bibr" rid="CR12">12</xref>] and detection of copy number aberrations, while accounting for variable sample purity [<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref>], have been used to differentiate and order groups of mutational events. While many evolutionary studies of cancer have focused on single-sample intra-tumor heterogeneity [<xref ref-type="bibr" rid="CR15">15</xref>], several studies have also compared multiple tumor samples extracted from a single patient either at different points in time during cancer progression [<xref ref-type="bibr" rid="CR16">16</xref>-<xref ref-type="bibr" rid="CR18">18</xref>] or from different regions of the same tumor or its metastases [<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR19">19</xref>-<xref ref-type="bibr" rid="CR23">23</xref>]. In multi-sample approaches, the patterns of SSNV sharing (that is, distinguishing somatic mutations that are omnipresent, partially shared, or private among the samples) can serve as phylogenetic markers from which lineage trees are reconstructed [<xref ref-type="bibr" rid="CR24">24</xref>]. On the basis of the lineage trees, the evolutionary timing of each mutational event can then be inferred with high confidence [<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR25">25</xref>].</p>
    <p>Most existing multi-sample studies with a relatively small number of SSNVs infer the tumor phylogenies manually by analyzing SSNV VAFs and presence patterns across samples [<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR26">26</xref>]. Several other studies used implementations of traditional phylogeny reconstruction methods, such as neighbor joining with Pearson correlation distances [<xref ref-type="bibr" rid="CR27">27</xref>], or maximum parsimony [<xref ref-type="bibr" rid="CR21">21</xref>] on patterns of somatic mutational sharing across samples. However, to scale to datasets comprising large numbers of samples per patient and extract fine-grained SSNV timing information, as well as handle sample heterogeneity, which traditional tree-building techniques are not designed to do, specialized computational approaches need to be developed for tumor cell lineage reconstruction. Several computational methods have been recently developed to address this need. The method SubcloneSeeker [<xref ref-type="bibr" rid="CR28">28</xref>] takes as input clusters of variant cell prevalence (CP) estimates and generates all possible subclone structures in each tumor sample separately. The per-sample solutions are then trimmed by checking their compatibilities during a merge step, which reports which sample trees are compatible across a given pair of samples. However, the merge step is currently designed to check compatibilities of two tumor samples only (for example, relapse/primary tumor sample pairs that are common in clinical studies) and it cannot merge the subclone structures of more than two samples. The method PhyloSub [<xref ref-type="bibr" rid="CR29">29</xref>] infers tumor phylogenies using a Bayesian non-parametric prior over trees and Markov chain Monte Carlo sampling. It performs reasonably on samples with very few mutations that form simple (chain) topologies; however, it produces unsatisfactory results on larger multi-sample datasets, such as [<xref ref-type="bibr" rid="CR21">21</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details). Most recently, PhyloWGS [<xref ref-type="bibr" rid="CR30">30</xref>] was developed for subclonal reconstruction using whole-genome sequencing datasets. PhyloWGS is a probabilistic framework based on the earlier development of PhyloSub. This new algorithm utilizes both VAFs of SSNVs and the effect of copy number variants (CNVs) already inferred in regions overlapping with those SSNVs. Finally, CITUP [<xref ref-type="bibr" rid="CR31">31</xref>] is a combinatorial method that uses an exact quadratic integer programming formulation to obtain optimal lineage trees that are in concordance with the VAF data. CITUP reports higher accuracies when compared to Phylosub [<xref ref-type="bibr" rid="CR31">31</xref>]; however, its optimization problem may be intractable when the lineage tree is arbitrarily large.</p>
    <p>In this work, we introduce LICHeE (Lineage Inference for Cancer Heterogeneity and Evolution), a novel computational method for the reconstruction of multi-sample tumor phylogenies and tumor subclone decomposition from targeted deep-sequencing SSNV datasets. Given SSNV VAFs from multiple samples, LICHeE finds the set of lineage trees that are consistent with the SSNV presence patterns and VAFs within each sample and are valid under the cell division process. Given each such tree, LICHeE provides estimates of the subclonal mixtures of the samples by inferring sample heterogeneity simultaneously with phylogenetic cell lineage tree reconstruction. LICHeE is able to search for lineage trees very efficiently by incorporating the SSNVs into an evolutionary constraint network that embeds all such trees and applying VAF constraints to reduce the search space. LICHeE runs in only a few seconds given hundreds of input SSNVs and does not require data preprocessing.</p>
    <p>We demonstrate that LICHeE is highly effective in reconstructing the lineage trees and sample heterogeneity by evaluating it on simulated trees of heterogeneous cancer cell lineage evolution, as well as on three recently published ultra-deep-sequencing multi-sample datasets of clear cell renal cell carcinoma (ccRCC) by Gerlinger et al. [<xref ref-type="bibr" rid="CR21">21</xref>], high-grade serous ovarian cancer (HGSC) by Bashashati et al. [<xref ref-type="bibr" rid="CR27">27</xref>], and breast cancer xenoengraftment in immunodeficient mice by Eirew et al. [<xref ref-type="bibr" rid="CR32">32</xref>], for which single-cell validation results are also available. LICHeE found unique trees for each ccRCC patient and for all except one patient (for which multiple valid trees were found) of the HGSC study. For the ccRCC dataset, LICHeE trees were nearly identical to the published trees, which are the result of a multi-step thorough analysis of the data, involving SSNV calling, clustering, and tree-building using maximum parsimony. For the HGSC dataset, LICHeE improved on the results reported by the study, producing trees with better support from the data. LICHeE also revealed additional heterogeneity in the samples of both studies. In particular, LICHeE identified subclones in one more sample of the ccRCC study (in addition to the reported six samples) and three samples of the HGSC study, all supported by the data. Finally, the trees reconstructed by LICHeE on the xenoengraftment dataset can be highly validated by the single-cell analysis presented in the paper. LICHeE is open source and freely distributed at [<xref ref-type="bibr" rid="CR33">33</xref>], and includes an intuitive graphical user interface (GUI) that may aid users in performing quality control on the output trees as well as interpreting the trees biologically.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Overview of the multi-sample cancer phylogeny inference method, LICHeE</title>
      <p>LICHeE is a method designed to reconstruct cancer cell lineages using SSNVs from multiple related normal and tumor samples of individual cancer patients, allowing for heterogeneity within each sample. Given a set of validated deeply sequenced SSNVs, LICHeE uses the presence patterns of SSNVs across samples and their VAFs as lineage markers by relying on the perfect phylogeny model [<xref ref-type="bibr" rid="CR34">34</xref>]. This model assumes that mutations do not recur independently in different cells; hence, cells sharing the same mutation must have inherited it from a common ancestral cell. This assumption can be used to derive the following SSNV ordering constraints. Firstly, (1) a mutation present in a given set of samples cannot be a successor of a mutation that is present in a smaller subset of these samples, since it could not have arisen independently by chance in the additional samples. Similarly, (2) a given mutation cannot have a VAF higher than that of its predecessor mutation (except due to CNVs), since all cells containing this mutation will also contain the predecessor. Finally, (3) the sum of the VAFs of mutations disjointly present in distinct subclones cannot exceed the VAF of a common predecessor mutation present in these subclones, since the subclones with the descendent mutations must contain the parent mutations (this constraint is formally defined in ‘<xref rid="Sec9" ref-type="sec">Materials and methods</xref>’). These constraints provide key information about the topology of the true cell lineage tree and are leveraged by LICHeE to define the search space of the possible underlying lineage trees and evaluate the validity of the resulting topologies. The final goal of LICHeE is to find phylogenetic trees encoding an evolutionary ordering of the input SSNVs that does not violate any of these three constraints.</p>
      <p>At a high level, the LICHeE algorithm can be broken down into the following main steps (Figure <xref rid="Fig1" ref-type="fig">1</xref>). First, LICHeE partitions SSNVs into groups based on their occurrence in each sample, such that each group stores all the mutations that were called in the same subset of samples. To separate subclone lineages, the SSNV members of each resulting group are then further clustered based on their VAFs, such that SSNVs with similar VAFs across samples are clustered together. The final lineage tree needs to provide a valid ordering of these resulting SSNV clusters (that is, an ordering that does not violate the three constrains defined above). To find such a tree, we construct an evolutionary constraint network, which encodes whether a given cluster of SSNVs could have preceded another, for each pair of clusters. More specifically, this network is a directed acyclic graph (DAG) that has SSNV clusters as its nodes and whose edges encode possible predecessor relationships among the nodes’ mutations (that is, an edge denotes that the mutations of a given pair of clusters satisfy ordering constraints (1) and (2)). This network greatly reduces the search space of possible valid trees and allows us to formulate the task of inferring such trees as a search for spanning trees of the network that satisfy constraint (3) (within a given error margin), which ensures that the reconstructed trees are composed of parent–daughter edges that exhibit somatic VAF consistency with the cell lineage expansion. If multiple valid lineage trees are found during the search, the trees are ranked based on how well they support the cluster VAF data, the top-ranking tree minimizing the use of the permitted error margin (see ‘<xref rid="Sec9" ref-type="sec">Materials and methods</xref>’ for details). Finally, as shown in Figure <xref rid="Fig1" ref-type="fig">1</xref>, the leaves of the resulting trees are the individual samples (added post-search), whose composition can be reconstructed by tracing back their respective subclone cell lineages in the tree. We detail each of these steps in ‘<xref rid="Sec9" ref-type="sec">Materials and methods</xref>’.
<fig id="Fig1"><label>Figure 1</label><caption><p>LICHeE method overview.<bold>(a)</bold> Toy example of five samples (lymph control and four tumor samples S1 to S4) with one germ-line single nucleotide variant (SNV) and four SSNVs, each associated with a binary sample profile. <bold>(b)</bold> SSNVs are partitioned into groups based on their binary profile (displayed groups contain other SSNVs with varying VAFs). <bold>(c)</bold> SSNV groups are clustered based on their VAFs. <bold>(d)</bold> The clusters of each SSNV group are incorporated into an evolutionary constraint network. An edge is placed between a parent node and child node if, for each sample, the VAF of the parent is greater than or equal to that of the child node. For example, this constraint is violated for the green 01110 node and node 00110. <bold>(e)</bold> The lineage tree is constructed from the constraint network. The leaves of the tree are the individual samples. The horizontal line subdivisions in a sample indicate mixed lineages, separating the different subpopulations of cells in the sample. The colors in each subdivision describe the mutation groups that the cells in this subpopulation have. Consider the orange node 01110, which denotes SSNVs of class 01110. Those SSNVs are found in samples 1, 2, and 3. After an ancestral cell division, the daughter cells’ lineages accumulated SSNVs too (01110, green; 00110) that are now present in their descendent samples or subclones. About 20% of sample 1 are cells that come from the orange and green lineages, and about 40% come from the blue lineage. Samples 1, 2, and 3 grew from two or more subclones, whereas sample 4 only grew from one subclone. SNV, single nucleotide variant; SSNV, somatic single nucleotide variant; VAF, variant allele frequency.</p></caption><graphic xlink:href="13059_2015_647_Fig1_HTML" id="MO1"/></fig></p>
      <p>Since finding true SSNV groups is a crucial step of the algorithm, it is important to minimize false positive and false negative SSNV calls across samples. However, accurately detecting SSNVs in each sample is a challenging task due to high levels of noise in the data, which can come from various sources, such as sequencing errors, systematic amplification bias, mapping errors, and sample impurities. Multiple techniques have been developed to address this problem to date [<xref ref-type="bibr" rid="CR35">35</xref>-<xref ref-type="bibr" rid="CR39">39</xref>], many employing a Bayesian approach to model the distributions of noise and true genotypes in matched-normal samples. LICHeE can work with variant calls produced for each sample by any specialized existing method. However, it does not require the users to preprocess the data using these tools, since it provides its own heuristic mechanism to call SSNVs using the multi-sample VAF data. At a high level, it first finds SSNVs that can be called reliably in each sample using two hard thresholds <italic>T</italic><sub>present</sub> and <italic>T</italic><sub>absent</sub>, above and below which, respectively, the SSNVs are considered robustly present or absent. Then, assuming that the presence patterns of such SSNVs capture most of the topology of the true underlying evolutionary tree, it uses this inferred tree to inform the group assignment of the SSNVs whose VAF falls in between the thresholds (the ’greyzone’).</p>
      <p>Currently LICHeE does not automatically detect or incorporate the CNVs explicitly into the model, although the method can still find valid phylogenies even in the presence of SSNVs within such regions (for example, each patient in the ccRCC dataset had numerous variants from CNV regions). To address this limitation, LICHeE also accepts CP values instead of VAFs, which can be computed by several recently developed tools, such as PyClone [<xref ref-type="bibr" rid="CR12">12</xref>], ABSOLUTE [<xref ref-type="bibr" rid="CR8">8</xref>], and ASCAT [<xref ref-type="bibr" rid="CR40">40</xref>], and account for CNVs, loss of heterozygosity (LOH) status, and sample purity. The same algorithmic steps can then be directly applied to CP values of each variant. It can be easily seen that the three perfect phylogeny ordering constraints still hold for CP values and can be used to search for the underlying lineage tree. Furthermore, to support outputs of specialized clustering approaches (for example, PyClone [<xref ref-type="bibr" rid="CR12">12</xref>]), LICHeE also accepts already computed clusters of mutations (with given CP and VAF-based centroid values) and uses these clusters as nodes of the phylogenetic constraint network.</p>
      <p>We evaluated LICHeE on three recently published ultra-deep-sequencing multi-sample datasets of ccRCC by Gerlinger et al. [<xref ref-type="bibr" rid="CR21">21</xref>], HGSC by Bashashati et al. [<xref ref-type="bibr" rid="CR27">27</xref>], and breast cancer xenoengraftment by Eirew et al. [<xref ref-type="bibr" rid="CR32">32</xref>], as well as on simulated trees of heterogeneous cancer cell lineage evolution. On the ccRCC dataset, LICHeE constructs near-identical trees to the trees published in the study. We show that the interesting difference in the topology of one tree arises due to potential heterogeneity of a sample that cannot be discovered using the traditional maximum parsimony approach and analyze when this approach can fail to detect existing sample subclones. For each patient, LICHeE finds a unique valid tree. On the HGSC datasets we show that the trees generated by LICHeE are better supported by the data and demonstrate why applying neighbor joining with Pearson correlation distance metric, used by the study, might not be suitable for cancer datasets. LICHeE finds a unique valid tree for all patients except Case 5. Finally, we show that the trees inferred by LICHeE on the xenoengraftment dataset are consistent with the single-cell analysis done by the study. On each patient dataset LICHeE takes only a few seconds to run.</p>
    </sec>
    <sec id="Sec4">
      <title>Lineage tree reconstruction on clear cell renal cell carcinoma data</title>
      <p>The ccRCC study by Gerlinger et al. [<xref ref-type="bibr" rid="CR21">21</xref>] validated 602 non-synonymous nucleotide substitutions and indels from multiple samples of eight individuals. It used VAF-based clustering of each sample to detect subclones prior to determining the variant presence patterns used in tree reconstruction. The phylogenetic trees were then reconstructed using maximum parsimony, revealing a branched pattern of ccRCC evolution in all tumors. Figure <xref rid="Fig2" ref-type="fig">2</xref> juxtaposes the trees produced by LICHeE with the trees presented by Gerlinger et al. [<xref ref-type="bibr" rid="CR21">21</xref>] (for details regarding the parameters used by LICHeE and the ccRCC dataset see Additional file <xref rid="MOESM2" ref-type="media">2</xref>). We can see that the trees generated by LICHeE are topologically identical (consisting of the same branches) to the published trees for patients EV005, EV007, RMH002, RMH008, and RK26. Furthermore, LICHeE identified subclones in all the samples reported to be heterogeneous by the study. In particular, it identified the following regions as a mixture of two subclones: EV005 R6 (with frequencies of 0.29 and 0.04), EV007 R3 (0.15 and 0.03), EV007 R9 (0.21 and 0.03), RMH008 R4 (0.19 and 0.14), RMH008 R6 (0.21 and 0.15), and RK26 R5 (0.15 and 0.03). These subclones correspond to the dominant (dom) and minor (min) shown in the published trees. Evidence supporting each subclone can be analyzed using the presented trees.
<fig id="Fig2"><label>Figure 2</label><caption><p>Comparison of lineage trees for eight ccRCC patients. Phylogenetic trees obtained with LICHeE (on the left) are contrasted with the trees published in [<xref ref-type="bibr" rid="CR21">21</xref>] for each patient in the study. ccRCC, clear-cell renal cell carcinoma; dom, dominant; min, minor; GL, germ line; SSNV, somatic single nucleotide variant.</p></caption><graphic xlink:href="13059_2015_647_Fig2_HTML" id="MO2"/></fig></p>
      <p>The trees generated for patients EV003 and EV006 also highly match the published results. For EV006, the LICHeE-generated tree does not contain the following two partially shared groups: (R2, LN1a, and LN1b) and (R3, R1, R4, R7, R15). For the first group we find no evidence in the data: no SSNVs are shared in these three samples and absent from the others. We do find one mutation that supports the second group. Because, by default, LICHeE eliminates nodes that have evidence from only one SSNV, this group is not shown in our tree.</p>
      <p>The RMH004 dataset contains three partially overlapping groups: (R3, VT, R10, R4, R2), (R3, VT, R10, R4, R8), and (R10, R4, R2, R8). These groups represent separate branches where their lowest common ancestor is the group with mutations present across all samples: (R3, VT, R10, R4, R2, R8). However, the VAF of this parent group in sample R10 is 0.34, while the average VAF across each of the three groups is 0.32, 0.27, and 0.21, respectively. Therefore, no more than one of these groups can be a descendant of the parent group, without violating the VAF phylogenetic constraint. To generate a valid tree, the two least populated conflicting branches among the three are removed from the dataset. Similarly, these two groups are ignored by the maximum parsimony algorithm and are not present in the published tree. The difference between our tree and the published one comes from the mixed lineage we observe in sample R4. Due to the VAF of 0.17 of the group of R4 private mutations, the private group is not a descendant of the group shared by R4 and R2 since the average VAF of that node is 0.06, which is too small to be a parent to 0.17. Therefore, our method suggests two different subclones in R4. Since the group (R2, R4) is small (total of three mutations) and has a low frequency in R4, the evidence of the two subclones cannot be considered very strong; however, it does constitute a signal in the data for the R4 mixed lineage possibility.</p>
      <p>While the ccRCC study does perform VAF clustering of each sample to find subclones at the onset, it runs the phylogenetic reconstruction using the presence pattern profiles only. On the other hand, our tree reconstruction with LICHeE applies the VAF constraint to the resulting tree topologies and clusters SSNVs in each group based on their VAFs across all the samples. For patient RMH004, applying the VAF constraint reveals additional sample heterogeneity, for which we produced a potentially improved tree compared to the tree reported using maximum parsimony. It can also be shown that clustering across all the samples rather than each sample individually, is a more appropriate approach for revealing the heterogeneity in the data. For example, if two subclones occur with high and low VAFs in one sample but are uniform in another sample, single-sample clustering will detect them only in the sample where they differ. For example, if the two subclones in samples R3 and R9 of patient EV007 (discussed above) had highly similar VAFs in these samples, clustering would not be able to differentiate the subclones. On the other hand, LICHeE would still be able to detect the mixed lineages in the two samples due to the presence of groups (R1, R2, R3, R5, R6, R7, R9) and (R3, R4, R9) in the data, which must form divergent branches in the lineage tree.</p>
    </sec>
    <sec id="Sec5">
      <title>Lineage tree reconstruction on high-grade serous ovarian cancer data</title>
      <p>We further evaluated LICHeE on the HGSC dataset from the study by Bashashati et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. This study validated 340 somatic mutations from 19 tumor samples of six patients. It used neighbor joining with Pearson correlation distances (computed on the binary sample presence patterns) to infer lineage trees. The trees generated by LICHeE juxtaposed with those presented in the paper are shown in Figure <xref rid="Fig3" ref-type="fig">3</xref> (for details regarding the parameters used by LICHeE and the HGSC dataset see Additional file <xref rid="MOESM3" ref-type="media">3</xref>). In four out of six cases (Cases 2, 3, 4, and 6), the possible tree topologies are very simple and the trees produced by the two methods are unsurprisingly highly similar. Below we discuss the difference between the two remaining trees.
<fig id="Fig3"><label>Figure 3</label><caption><p>Comparison of lineage trees for HGSC Cases 1 to 6. Phylogenetic trees obtained with LICHeE <bold>(a)</bold> are contrasted with the trees published in [<xref ref-type="bibr" rid="CR27">27</xref>] <bold>(b)</bold> for each patient in the study. GL, germ line; HGSC, high-grade serous ovarian cancer; SSNV, somatic single nucleotide variant.</p></caption><graphic xlink:href="13059_2015_647_Fig3_HTML" id="MO3"/></fig></p>
      <p>For Case 1, the tree reported in the paper suggests that sample d diverged first, followed by c. This suggests that there should be a group of mutations shared exclusively between samples a and b and another group shared between samples a, b, and c. However, examining the dataset VAF values, as well as the results of the binomial test determining SSNV presence in the samples used by this study, we found no evidence for these two groups. On the other hand, the tree produced by LICHeE suggests the presence of mutations shared by samples a, b, and d only, which we found both in the results of the study’s binomial test and by applying the LICHeE hard threshold caller.</p>
      <p>For Case 5, the study reports an early divergence of sample c. This suggests that there should be mutations shared between all the samples except c. We have confirmed that no such mutational profile exists in the data. On the other hand, the data shows the presence of mutations that exist in samples a, b, c, e, and f but not in d that cannot be supported by the reported tree. The reason why the neighbor-joining algorithm of the study chose sample c as the first diverging branch of the tree must be because of the large presence of private mutations in sample c, which led to a low Pearson correlation (and hence a greater distance) with the profiles of other samples. This shows that using the Pearson correlation metric is not suitable for this data. Furthermore, directly applying traditional phylogeny reconstruction techniques (for example, neighbor joining) cannot reveal sample heterogeneity.</p>
      <p>The tree produced by LICHeE for Case 5, reveals mixed lineages in samples b, e, and f. Interestingly, LICHeE detects two clusters in group (a, b, c, e, f) with mean VAFs of [0.29, 0.34 0.3, 0.19, 0.4] and [0.17, 0.14, 0.13, 0.1, 0.13], respectively. The two subclones in each sample are then produced by the divergence of the higher VAF cluster into two branches: one branch containing the lower VAF cluster and the other branch containing the group of mutations (e, f, b). While the presence of group (e, f, b) is weak (supported by three mutations only), the presence of group (b, f) is substantial (supported by 14 mutations) and provides strong evidence for the mixed lineage of b and f. Furthermore, due to the presence of group (a, b), the group (b, f) cannot be assigned as a child of the low VAF cluster (a, b, c, e, f) without violating the VAF phylogenetic constraint. However, since there are only three mutations in group (a, b), eliminating this group may be a reasonable alternative reconstruction. Therefore, multiple topologies are possible in this scenario, each supported by varying degrees of evidence. LICHeE presents the tree that best fits the data given input parameters of expected noise level and minimum mutational support needed for a node. Using LICHeE with different parameters and interacting with the trees can allow users to explore other evidence existing in the data. It is important to point out that, as opposed to the results of the neighbor-joining algorithm that produces trees with lack of evidential support in some branches, each branch in a tree reported by LICHeE reflects the presence of the corresponding SSNV groups in the data.</p>
    </sec>
    <sec id="Sec6">
      <title>Lineage tree reconstruction on xenoengraftment data</title>
      <p>The study by Eirew et al. [<xref ref-type="bibr" rid="CR32">32</xref>] used deep-genome and single-cell sequencing to evaluate the clonal dynamics of xenoengraftment of breast cancer tissue into immunodeficient mice. The study applied PyClone [<xref ref-type="bibr" rid="CR12">12</xref>] to infer mutational clusters representing clonal genotypes and then validated these results using single-cell analysis of two cases, SA494 and SA501. The study used Bayesian phylogenetic inference to reconstruct the evolutionary relationships between the single-cell nuclei. We applied LICHeE to the deep-sequencing VAF data of this study. We then compared the results of LICHeE to the single-cell phylogenetic trees and clonal genotypes for both SA494 and SA501.</p>
      <p>Single-cell phylogenetic inference of SA501 passages X1, X2, and X4 reveals an ancestral genotype that branched into two sibling clades A and B. Sequential acquisition of additional mutations in clade B then gave rise to genotypes C, D, and E. Samples X1 and X2 were found to be a mixture of clones with genotypes A, B, C, and D, while, sample X4 was found to be dominated by genotype E and did not contain clones with genotype A (see Figure Two in [<xref ref-type="bibr" rid="CR32">32</xref>]). As can be seen in Figure <xref rid="Fig4" ref-type="fig">4</xref>a, the tree reconstructed by LICHeE mirrors the phylogeny and sample compositions revealed by the study. In particular, it presents the same two sibling clades derived from the ancestral genotype. Samples X1 and X2 both contain subclones with genotype A (with a higher percentage of this genotype in sample X2, as confirmed by the single-cell analysis), while this genotype is missing from sample X4. Similarly, genotype E is found to be private to and dominates sample X4. The only difference in the LICHeE tree is the collapse of genotypes B and C into one cluster; however, examining the bulk CP values reported by the study, we can see that the CP values of these genotypes are highly similar in the three given samples (X1, X2, and X4) and, as a result, cannot get subdivided into two separate clusters during the clustering step (note, the PyClone analysis of the study was simultaneously performed on three additional samples T, X3, and X5, which showed higher CP value differences).
<fig id="Fig4"><label>Figure 4</label><caption><p>LICHeE reconstruction on breast cancer xenoengraftment data [<xref ref-type="bibr" rid="CR32">32</xref>].<bold>(a)</bold> Lineage tree generated by LICHeE (on left) is juxtaposed with the phylogeny derived from single-cell data in the study (on right) for SA501. <bold>(b)</bold> Lineage tree generated by LICHeE for SA494.</p></caption><graphic xlink:href="13059_2015_647_Fig4_HTML" id="MO4"/></fig></p>
      <p>The single-cell analysis of SA494 samples T and X4 reveals two clades, with mutually exclusive sets of mutations, emerging from an ancestral clone present in both samples (see extended data of Figure three in [<xref ref-type="bibr" rid="CR32">32</xref>]). LICHeE reconstructs the exact same topology (Figure <xref rid="Fig4" ref-type="fig">4</xref>b), showing two groups of mutations private to T and X4, respectively. In accordance with the results reported by PyClone, LICHeE also finds two clusters of mutations private to X4 (with the descendent cluster present in about 20% of the sample).</p>
    </sec>
    <sec id="Sec7">
      <title>Simulations</title>
      <p>We developed a cancer cell lineage simulator to better assess the performance of LICHeE. Our simulator models cancer evolution from normal tissue producing a branching hierarchy of monoclonal cell populations in accordance with the branched-tree cancer evolution model [<xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>]. Starting with the normal cell population, the simulator iteratively expands the cell lineage tree by introducing (with some given probability) new daughter cell populations corresponding to newly acquired SSNV or CNV events. In particular, in every iteration, each cell population present in the tree can give rise to a new population of cells (with a given randomly generated size) representing a new SSNV with probability <italic>P</italic><sub>SSNV</sub> or a CNV event with probability <italic>P</italic><sub>CNV</sub>. Each cell population can also undergo a cell death event with probability <italic>P</italic><sub>Death</sub>. Each simulated SSNV is randomly associated with a genome location (chromosome and position) and haplotype; the CNVs are associated with a chromosome arm and haplotype and correspond to a duplication of this chromosome arm. For the evaluation, we generated 100 lineage trees, each expanded over 50 iterations, with the following parameters: <italic>P</italic><sub>SSNV</sub>=0.15; <italic>P</italic><sub>CNV</sub>=0, 0.1, and 0.18; and <italic>P</italic><sub>Death</sub>=0.06. This process results in lineage trees with an arbitrary number of branches and nodes (several hundred to thousands of nodes on average). Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates one such lineage tree.
<fig id="Fig5"><label>Figure 5</label><caption><p>Example of a small simulated lineage tree (with SSNV and CNV events) with localized sampling (nine tumor samples in total indicated by different colors). Each node represents a cell population that contains every mutation in its lineage. Gray indicates dead cell populations. CNV, copy number variant; SSNV, somatic single nucleotide variant.</p></caption><graphic xlink:href="13059_2015_647_Fig5_HTML" id="MO5"/></fig></p>
      <p>Multiple samples are then collected from each lineage tree. Each sample consists of several cell populations (nodes) of the tree, where each such cell population represents a subclone in the sample. We implemented two sampling schemes: <italic>randomized</italic> sampling and <italic>localized</italic> sampling. The randomized sampling process selects a random subset of nodes from the tree for each sample; on the other hand, the localized sampling process is meant to mimic biopsies from spatially distinct sites and selects nodes such that samples mostly contain subclones from distinct branches of the simulated tree. Localized sampling for <italic>n</italic> samples is achieved by selecting <italic>n</italic> disjoint subtrees in the simulated tree using an approach based on breadth-first search, which finds disjoint subtree roots as high on the tree as possible (if <italic>n</italic> disjoint subtrees do not exist in the tree, the maximum number of subtrees is used and some samples are obtained from the same subtree in a round-robin fashion). Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates the localized sampling procedure for ten samples.</p>
      <p>Given a selected subset of cell populations, the sample is then created by obtaining a fraction of the cells from each population by sampling from a multinomial distribution with probabilities corresponding to the cell population sizes. For randomized sampling, we select up to five subclones for each sample. For localized sampling, there can be up to five subclones from the same distinct subtree, exactly one subclone from a neighboring subtree, and some fraction of normal cells to represent normal contamination (the fraction is randomly selected to be from 0% up to 20% of the sample). To determine how the performance of LICHeE degrades as the number of SSNVs located in CNV regions grows, we ran several experiments with increasing numbers of CNV events. In particular, we set <italic>P</italic><sub>CNV</sub> = [0, 0.1, 0.18], which resulted in a total of 0%, 65%, and 80% of SSNVs being affected by CNVs in the collected samples, respectively. Given the sample cell population counts, we can compute the VAF of each SSNV in this sample. In the absence of CNVs, the VAF of a given SSNV is simply the fraction of the cells containing the SSNV out of all the cells in the sample. When CNVs are present, we count the number of haplotypes containing the SSNV and the reference allele across all cells of the sample. Given an SSNV, we consider the chain of mutations present in each cell population affecting its genome position. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${H_{P}^{v}}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_647_Article_IEq1.gif"/></alternatives></inline-formula> be the number of haplotypes containing the SSNV in population <italic>P</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${H_{P}^{r}}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_647_Article_IEq2.gif"/></alternatives></inline-formula> be the number of haplotypes containing the reference allele. The VAF of a given SSNV <italic>M</italic> is then: 
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\operatorname{VAF}(M)=\frac{\sum_{P=1}^{N} {P_{n} \cdot {H_{P}^{v}} }}{\sum_{P=1}^{N}{P_{n} \cdot \left({H_{P}^{v}} + {H_{P}^{r}}\right)}}, $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>VAF</mml:mo><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:munderover><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munderover><mml:mo>+</mml:mo><mml:munderover><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2015_647_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>N</italic> is the total number of selected populations and <italic>P</italic><sub><italic>n</italic></sub> is the number of cells selected from population <italic>P</italic>.</p>
      <p>Finally, given the true VAFs of each SSNV, we add sampling and sequencing noise to each value. In particular, to simulate reads covering each SSNV position, we sample the VAFs from the binomial distribution <italic>B</italic>(<italic>n</italic>,<italic>p</italic>), where <italic>p</italic> is the true VAF of each SSNV and <italic>n</italic> is the total simulated read coverage (100 ×, 1,000 ×, and 10,000 ×); the generated frequencies have a mean <italic>p</italic> and variance <italic>p</italic>(1−<italic>p</italic>)/<italic>n</italic>. We simulate a Q30 (1 in 1,000) base call sequencing accuracy.</p>
      <p>Given the simulated VAFs, we first assessed the performance of LICHeE in SSNV calling. Table <xref rid="Tab1" ref-type="table">1</xref> presents LICHeE’s sensitivity in calling mutations across the samples (that is, the number of SSNVs with correctly identified sample presence patterns out of all the simulated SSNVs) given true VAF values and for coverages of 100 ×, 1,000 ×, and 10,000 ×. As expected, higher coverage results in higher sensitivity. The method achieves 94% to 99% sensitivity across all the experiments (more detailed results are reported in Additional file <xref rid="MOESM3" ref-type="media">3</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p><bold>Sensitivity of assignment to somatic single nucleotide variant groups on simulated data</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2"/><th align="left" colspan="2"><bold>Coverage</bold></th><th align="left"/><th align="left"/></tr><tr><th align="left"><bold>Number of</bold></th><th align="left"><bold>Number of</bold></th><th align="left"><bold>True VAF</bold></th><th align="left"><bold>10,000 ×</bold></th><th align="left"><bold>1,000 ×</bold></th><th align="left"><bold>100 ×</bold></th></tr><tr><th align="left"><bold>samples</bold></th><th align="left"><bold>simulated SSNVs</bold></th><th align="left"><bold>(+CNV)</bold></th><th align="left"><bold>(+CNV)</bold></th><th align="left"><bold>(+CNV)</bold></th><th align="left"><bold>(+CNV)</bold></th></tr></thead><tbody><tr><td align="left">5</td><td align="left">26.6 (42.2)</td><td align="left">99.2 (96.9)</td><td align="left">98.9 (96.7)</td><td align="left">99.1 (96.7)</td><td align="left">97.2 (95.5)</td></tr><tr><td align="left"/><td align="left">25 (44.5)</td><td align="left">99.5 (97.4)</td><td align="left">99.1 (97.3)</td><td align="left">99.3 (97.4)</td><td align="left">97.4 (95.9)</td></tr><tr><td align="left">10</td><td align="left">43.9 (89.7)</td><td align="left">99.2 (97.8)</td><td align="left">98.5 (97.5)</td><td align="left">98.5 (97.7)</td><td align="left">95 (96)</td></tr><tr><td align="left"/><td align="left">40.7 (88.6)</td><td align="left">99.5 (97.5)</td><td align="left">99.1 (97.3)</td><td align="left">99 (97.3)</td><td align="left">96.3 (95.9)</td></tr><tr><td align="left">15</td><td align="left">53.6 (131.1)</td><td align="left">98.8 (96.9)</td><td align="left">98.2 (96.7)</td><td align="left">97.9 (96.5)</td><td align="left">94.2 (95.4)</td></tr><tr><td align="left"/><td align="left">51 (136.1)</td><td align="left">99.1 (97.6)</td><td align="left">98.7 (97.4)</td><td align="left">98.5 (97.2)</td><td align="left">94.5 (95.8)</td></tr></tbody></table><table-wrap-foot><p>Values indicate the number of correctly assigned SSNVs out of the total number of SSNVs collected in each experiment (number of simulated SSNVs). Results are shown for 5, 10, and 15 samples given true VAFs, 10,000 ×, 1,000 ×, and 100 × coverage data obtained with localized (top row in each pair) and randomized (bottom row) sampling, from trees without CNVs and with approximately 80% of SSNVs in CNV regions (in parentheses). All values are averaged over 100 simulated trees. CNV, copy number variant; SSNV, somatic single nucleotide variant; VAF, variant allele frequency.</p></table-wrap-foot></table-wrap></p>
      <p>Next we compared the topology of the reported lineage trees and the simulated trees and measured LICHeE’s accuracy in reconstructing the ancestor–descendant and sibling relationships. For every pair of mutations in the simulated tumor hierarchy, we checked if LICHeE preserved the relationship between them in the generated top tree. More specifically, we checked for the following two types of violations: 1) if an ancestor–descendant relationship was inverted or became a sibling relationship, and 2) if a sibling relationship became an ancestor–descendant relationship. Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> summarize the accuracy of these metrics (more detailed results are reported in Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Since LICHeE may remove nodes from the network representing non-robust SSNV groups if no valid trees are found during the search (as described in ‘<xref rid="Sec9" ref-type="sec">Materials and methods</xref>’), not all of the simulated mutations will be present in the final tree. We report the percentage of the SSNVs and of simulated ancestor–descendant (AD) and sibling (Sib) mutation pairs that are present in the tree. As expected, the number of mutations present in the trees decreases with higher numbers of input samples, lower coverage, and the presence of CNVs (which can significantly alter the VAF values, causing the violation of the VAF ordering constraints). In particular, with a low coverage of 100 × and 15 samples, only 81% of SSNVs are preserved in the tree. Therefore, LICHeE is best applied to data with higher coverage when the number of input samples is high. For instance, with a higher coverage of 1,000 ×, 91% to 94% of SSNVs and 83% to 88% of mutation pairs are present in the trees with 15 samples (although this metric drops with the presence of CNVs to the ranges 91% to 92% for SSNVs and 66% to 70% for SSNV pairs).
<table-wrap id="Tab2"><label>Table 2</label><caption><p><bold>Topological ancestor–descendant and sibling relationship reconstruction on simulated data</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Samples</bold></th><th align="left"><bold>Cov</bold></th><th align="left"><bold>Trees</bold></th><th align="left"><bold>% SSNVs</bold></th><th align="left"><bold>% AD</bold></th><th align="left"><bold>% AD-Ord</bold></th><th align="left"><bold>% AD-Corr</bold></th><th align="left"><bold>% AD →Sib (−priv)</bold></th><th align="left"><bold>% Sib</bold></th><th align="left"><bold>%Sib-Corr</bold></th><th align="left"><bold>% Sib →AD (−priv)</bold></th></tr></thead><tbody><tr><td align="left">5</td><td align="left">t-VAF</td><td align="left">94</td><td align="left">98.9</td><td align="left">99</td><td align="left">41.5</td><td align="left">100</td><td align="left">30.2 (2.6)</td><td align="left">98.2</td><td align="left">83.2</td><td align="left">7.3 (1.5)</td></tr><tr><td align="left"/><td align="left"/><td align="left">98</td><td align="left">99.5</td><td align="left">99.5</td><td align="left">40.4</td><td align="left">100</td><td align="left">26.3</td><td align="left">99.2</td><td align="left">84.8</td><td align="left">6.6 (0.9)</td></tr><tr><td align="left"/><td align="left">10K</td><td align="left">95</td><td align="left">98.8</td><td align="left">98.7</td><td align="left">40.4</td><td align="left">99.9</td><td align="left">30.5 (2.5)</td><td align="left">97.8</td><td align="left">82.5</td><td align="left">7.7 (1.4)</td></tr><tr><td align="left"/><td align="left"/><td align="left">98</td><td align="left">99.2</td><td align="left">98.7</td><td align="left">39</td><td align="left">100</td><td align="left">27.4</td><td align="left">98.8</td><td align="left">84.7</td><td align="left">7 (1.3)</td></tr><tr><td align="left"/><td align="left">1K</td><td align="left">95</td><td align="left">98.6</td><td align="left">97.7</td><td align="left">39.7</td><td align="left">100.0</td><td align="left">30.5 (2.3)</td><td align="left">97.1</td><td align="left">82.8</td><td align="left">7.2 (1.3)</td></tr><tr><td align="left"/><td align="left"/><td align="left">98</td><td align="left">99.4</td><td align="left">99.5</td><td align="left">38.1</td><td align="left">99.7</td><td align="left">29.2</td><td align="left">98.9</td><td align="left">83.9</td><td align="left">7.5 (2.2)</td></tr><tr><td align="left"/><td align="left">100</td><td align="left">97</td><td align="left">96.8</td><td align="left">93.2</td><td align="left">38.7</td><td align="left">99.8</td><td align="left">31.4 (3.5)</td><td align="left">93.1</td><td align="left">81.8</td><td align="left">7.9 (1.7)</td></tr><tr><td align="left"/><td align="left"/><td align="left">97</td><td align="left">97.3</td><td align="left">94.8</td><td align="left">35.2</td><td align="left">99.7</td><td align="left">30.1</td><td align="left">95.3</td><td align="left">83.7</td><td align="left">7.2 (2.2)</td></tr><tr><td align="left">10</td><td align="left">t-VAF</td><td align="left">97</td><td align="left">97.5</td><td align="left">96.2</td><td align="left">58.8</td><td align="left">100</td><td align="left">43.1 (2.2)</td><td align="left">96.9</td><td align="left">94.4</td><td align="left">3.3 (0.2)</td></tr><tr><td align="left"/><td align="left"/><td align="left">95</td><td align="left">97.7</td><td align="left">96.5</td><td align="left">58.2</td><td align="left">100</td><td align="left">38.1 (1.9)</td><td align="left">96.7</td><td align="left">93.5</td><td align="left">4.2 (1.4)</td></tr><tr><td align="left"/><td align="left">10K</td><td align="left">98</td><td align="left">96.5</td><td align="left">94.4</td><td align="left">57.3</td><td align="left">100</td><td align="left">44.9 (4)</td><td align="left">95.2</td><td align="left">94</td><td align="left">3.6 (0.4)</td></tr><tr><td align="left"/><td align="left"/><td align="left">96</td><td align="left">97</td><td align="left">96.1</td><td align="left">56.5</td><td align="left">100</td><td align="left">39.8 (2.3)</td><td align="left">96.2</td><td align="left">93.3</td><td align="left">4.3 (1.2)</td></tr><tr><td align="left"/><td align="left">1K</td><td align="left">98</td><td align="left">97.4</td><td align="left">96.4</td><td align="left">57.5</td><td align="left">99.9</td><td align="left">45.2 (3.9)</td><td align="left">96.8</td><td align="left">94.1</td><td align="left">3.7 (0.4)</td></tr><tr><td align="left"/><td align="left"/><td align="left">96</td><td align="left">97</td><td align="left">95.7</td><td align="left">57.4</td><td align="left">99.9</td><td align="left">38.7 (2.4)</td><td align="left">96</td><td align="left">92.7</td><td align="left">4.8 (1.5)</td></tr><tr><td align="left"/><td align="left">100</td><td align="left">93</td><td align="left">90.8</td><td align="left">75.7</td><td align="left">52.3</td><td align="left">99.7</td><td align="left">38.6 (4.4)</td><td align="left">78.0</td><td align="left">93.9</td><td align="left">3.4 (0.7)</td></tr><tr><td align="left"/><td align="left"/><td align="left">91</td><td align="left">90.5</td><td align="left">80.4</td><td align="left">47.9</td><td align="left">99.5</td><td align="left">40.3 (5.7)</td><td align="left">83.3</td><td align="left">92.8</td><td align="left">4.4 (1.5)</td></tr><tr><td align="left">15</td><td align="left">t-VAF</td><td align="left">99</td><td align="left">91.7</td><td align="left">85</td><td align="left">63.1</td><td align="left">100</td><td align="left">40.8 (2.2)</td><td align="left">88</td><td align="left">96.6</td><td align="left">2 (0.2)</td></tr><tr><td align="left"/><td align="left"/><td align="left">96</td><td align="left">92.1</td><td align="left">87.5</td><td align="left">61.7</td><td align="left">100</td><td align="left">41.5 (2)</td><td align="left">89.1</td><td align="left">96.9</td><td align="left">2 (0.3)</td></tr><tr><td align="left"/><td align="left">10K</td><td align="left">98</td><td align="left">92.3</td><td align="left">85.3</td><td align="left">61.2</td><td align="left">100</td><td align="left">44.3 (3.5)</td><td align="left">87.6</td><td align="left">96.2</td><td align="left">2.4 (0.3)</td></tr><tr><td align="left"/><td align="left"/><td align="left">100</td><td align="left">90.6</td><td align="left">83.6</td><td align="left">59.1</td><td align="left">100</td><td align="left">41.8 (2.6)</td><td align="left">85.8</td><td align="left">96.6</td><td align="left">2.1 (0.3)</td></tr><tr><td align="left"/><td align="left">1K</td><td align="left">93</td><td align="left">94.7</td><td align="left">83.5</td><td align="left">61.5</td><td align="left">99.9</td><td align="left">42.7 (4.3)</td><td align="left">85.4</td><td align="left">96.1</td><td align="left">2.6 (0.6)</td></tr><tr><td align="left"/><td align="left"/><td align="left">100</td><td align="left">91.8</td><td align="left">85.4</td><td align="left">59.1</td><td align="left">100</td><td align="left">43.5 (2.9)</td><td align="left">87.8</td><td align="left">96.7</td><td align="left">2.1 (0.3)</td></tr><tr><td align="left"/><td align="left">100</td><td align="left">92</td><td align="left">81.1</td><td align="left">55.2</td><td align="left">48.4</td><td align="left">99.4</td><td align="left">37.4 (5)</td><td align="left">61.3</td><td align="left">96.1</td><td align="left">2.1 (0.3)</td></tr><tr><td align="left"/><td align="left"/><td align="left">98</td><td align="left">81.8</td><td align="left">57.1</td><td align="left">46.1</td><td align="left">99.8</td><td align="left">36.5 (2.2)</td><td align="left">63.1</td><td align="left">96.2</td><td align="left">2.2 (0.4)</td></tr></tbody></table><table-wrap-foot><p>Results are shown for 5, 10, and 15 samples given true VAFs, 10,000 ×, 1,000 ×, and 100 × coverage data (without CNVs) obtained with localized (top row in each pair) and randomized (bottom row) sampling. All values are averaged over the number of reconstructed trees (Trees) out of 100 simulated trees. The following metrics are presented: SSNVs present in the tree (% SSNVs), ancestor–descendant pairs of mutations in the tree (AD), ordered AD pairs (AD-Ord), correctly ordered AD pairs (AD-Corr), unordered AD pairs reconstructed as siblings (AD →Sib) (with and without private mutation nodes), sibling pairs of mutations in the tree (Sib), correctly reconstructed sibling pairs (Sib-Corr), sibling pairs reconstructed as AD (Sib →AD) (with and without private mutation nodes). AD, ancestor–descendant; CNV, copy number variant; Corr, correctly ordered; Cov, coverage; Ord, ordered; priv, private mutation nodes; Sib, sibling; SSNV, somatic single nucleotide variant; t-VAF, true variant allele frequency; VAF, variant allele frequency.</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p><bold>Topological ancestor–descendant and sibling relationship reconstruction on simulated data in the presence of copy number variants</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Samples</bold></th><th align="left"><bold>Trees</bold></th><th align="left"><bold>% SSNVs</bold></th><th align="left"><bold>% AD</bold></th><th align="left"><bold>% AD-Ord</bold></th><th align="left"><bold>% AD-Corr</bold></th><th align="left"><bold>% AD →Sib (−priv)</bold></th><th align="left"><bold>% Sib</bold></th><th align="left"><bold>% Sib-Corr</bold></th><th align="left"><bold>% Sib →AD (−priv)</bold></th></tr></thead><tbody><tr><td align="left">5</td><td align="left">95</td><td align="left">96.2</td><td align="left">89.1</td><td align="left">14.4</td><td align="left">93.7</td><td align="left">20 (0.4)</td><td align="left">92.6</td><td align="left">80.8</td><td align="left">2.4 (0)</td></tr><tr><td align="left"/><td align="left">98</td><td align="left">97.42</td><td align="left">91.96</td><td align="left">10.74</td><td align="left">96.1</td><td align="left">0.20</td><td align="left">94.85</td><td align="left">80.46</td><td align="left">2 (0.02)</td></tr><tr><td align="left">10</td><td align="left">91</td><td align="left">94.8</td><td align="left">77.1</td><td align="left">14.6</td><td align="left">93.5</td><td align="left">24.9 (0.6)</td><td align="left">90.9</td><td align="left">91.8</td><td align="left">1.3 (0)</td></tr><tr><td align="left"/><td align="left">92</td><td align="left">94.55</td><td align="left">78.97</td><td align="left">11.95</td><td align="left">93.1</td><td align="left">0.41</td><td align="left">90.5</td><td align="left">91.7</td><td align="left">1.1 (0.01)</td></tr><tr><td align="left">15</td><td align="left">97</td><td align="left">91.8</td><td align="left">65.9</td><td align="left">11.1</td><td align="left">92.5</td><td align="left">23.3 (0.4)</td><td align="left">85.5</td><td align="left">94.6</td><td align="left">0.7 (0)</td></tr><tr><td align="left"/><td align="left">94</td><td align="left">92.9</td><td align="left">69.6</td><td align="left">10.8</td><td align="left">94.5</td><td align="left">24.2 (0.35)</td><td align="left">87.5</td><td align="left">94.8</td><td align="left">0.6 (0.01)</td></tr></tbody></table><table-wrap-foot><p>Results are shown for 5, 10, and 15 samples given 1,000 × coverage data obtained with localized (top row in each pair) and randomized (bottom row) sampling with approximately 80% of SSNVs in CNV regions. All values are averaged over the number of reconstructed trees. AD, ancestor–descendant; CNV, copy number variant; Corr, correctly ordered; Cov, coverage; Ord, ordered; priv, private mutation nodes; Sib, sibling; SSNV, somatic single nucleotide variant.</p></table-wrap-foot></table-wrap></p>
      <p>Since LICHeE groups mutations with the same presence patterns across samples and similar VAFs, only the mutations occurring in a different set of samples or with significantly different VAFs will be placed in distinct nodes of the tree. We report the percentage of such ancestor–descendant pairs (AD-Ord) in Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>. We then evaluate how many ordered mutations preserved the correct ancestor–descendant relationship (AD-Corr). Across all the experiments without CNVs, we get 99% to 100% correctness (with less than 1% of pairs being in reversed order). We see 92% to 96% correctness in experiments with 80% of SSNVs located in CNV regions and 1,000 × coverage. AD mutations that were not ordered or grouped in the same node, will be siblings in the reconstructed tree (AD →Sib). We find that the vast majority of such mutation pairs involve private mutations, whose placement in the tree is usually under-constrained (that is, multiple tree nodes can serve as ancestors to such mutation groups). Finally, we can see that the reverse violation of sibling mutations being placed into ancestor–descendant nodes (Sib →AD) is also very rare (up to 7% across all the experiments). Therefore, we conclude that the trees reconstructed by LICHeE provide highly accurate ordering of the mutations in its nodes.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>LICHeE has been designed to automatically infer cell lineages of multiple tumor samples and the sample subclone decomposition. Our analysis shows that LICHeE is highly effective in reconstructing the phylogenies and uncovering the heterogeneity of previously published datasets and in simulations, improving not only upon traditional tree-building methods, but also on recent developments specialized for cancer data. Currently LICHeE works with deep-sequencing data that provide VAF estimates with low variance (as well as on CP values that can be obtained from existing tools and can correct for CNVs, LOH, and sample purity). SSNV data obtained from deep whole-genome sequencing, targeted resequencing of informative SSNVs, or exome sequencing in tumors with a high degree of somatic SSNVs present in exomes, should be appropriate inputs to LICHeE. Several directions for future work are open: extension of this method to lower coverage whole-genome sequencing data and incorporation of aneuploidies and large CNVs directly into the model.</p>
  </sec>
  <sec id="Sec9" sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec id="Sec10">
      <title>Grouping and clustering somatic single nucleotide variants</title>
      <p>When partitioning SSNVs into groups based on sample occurrence, each SSNV is first associated with a binary sample profile denoting its presence or absence in each sample. Given <italic>S</italic> samples from an individual, the <italic>binary profile</italic> is defined as a binary sequence of length <italic>S</italic> where the <italic>i</italic>th bit is set to 1 if this SSNV is called in the <italic>i</italic>th sample, and is 0 otherwise (for example, given five samples, an SSNV with the profile 01011 is called in samples 2, 4, and 5). SSNVs with the same profile are assigned to the same SSNV group (for example, a group with the profile 01101 will contain all the SSNVs occurring in samples 2, 3, and 5). The group with the profile consisting entirely of 1s will contain SSNVs that occur in all the samples and are, therefore, germ-line variants (assuming that the sample set includes a normal control sample).</p>
      <p>The SSNV binary profiles can be passed as input or computed from SSNV VAFs as follows. First two hard VAF thresholds, <italic>T</italic><sub>present</sub> and <italic>T</italic><sub>absent</sub>, are used to determine if an SSNV is robustly present or absent from a sample. An SSNV profile is classified as robust if its VAF is above or below the two thresholds, respectively, and if at least a minimum number of other robust SSNVs (default set to 1) have the same binary profile. All other SSNVs are considered non-robust and are assigned to a group as follows. Given a non-robust SSNV <italic>m</italic>, its VAF across samples can either fall below (marked 0), above (marked 1), or in between (marked*) the thresholds <italic>T</italic><sub>present</sub> and <italic>T</italic><sub>absent</sub>, resulting in a profile such as 01*11. The candidate groups, to which <italic>m</italic> can be assigned, must have an identical profile in all the samples that are marked 0 or 1 (for example, for profile 01*11, two valid candidate groups are 01111 and 01011). Since <italic>m</italic> can be assigned to more than one target group, we consider that the group containing a robust SSNV that is most similar in VAF to <italic>m</italic> is the best candidate. The following metric is used to compute the similarity between two SSNVs <italic>m</italic> and <italic>n</italic>: 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\text{sim}_{mn} = \sum_{i \in \text{samples}}{\frac{\min(m.\text{VAF}_{i}, n.\text{VAF}_{i})}{\max(m.\text{VAF}_{i}, n.\text{VAF}_{i})}}},  $$ \end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">mn</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>samples</mml:mtext></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>m.</mml:mi><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>n.</mml:mi><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:mi>m.</mml:mi><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>n.</mml:mi><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2015_647_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>m</italic>.VAF<sub><italic>i</italic></sub> is the VAF of <italic>m</italic> in sample <italic>i</italic>. If the maximum similarity is higher than a given threshold, <italic>m</italic> is assigned to the group of argmax<sub><italic>n</italic>∈Candidates</sub>sim<sub><italic>mn</italic></sub>. Unassigned non-robust SSNVs will form new profile groups. We minimize the number of such new groups by formulating this task as a set cover problem. In particular, let <italic>X</italic> be the set of all unassigned SNVs. Denote <italic>Y</italic> as the set of subsets of <italic>X</italic>, where each subset represents mutations that can be assigned to the same potential target group. The target groups are a list of all possible binary profiles that the SSNVs can be assigned to, obtained by substituting all *’s by 0 or 1. We want to find the minimum number of target groups (that is, the smallest subset of <italic>Y</italic>), which cover all mutations in <italic>X</italic>. This problem is known to be NP-complete and searching for the exact solution is not feasible. Instead we apply the standard greedy algorithm by choosing (at each stage) the target group that covers the largest number of non-robust SSNVs. For SSNVs whose targets are not supported by any other mutations, we convert each * to 1 or 0 depending on whether the VAF is closest to <italic>T</italic><sub>present</sub> or <italic>T</italic><sub>absent</sub>, respectively.</p>
      <p>Once the SSNVs are partitioned into groups, the SSNVs of each group are further clustered based on their sample VAFs. Each SSNV group is associated with a matrix <italic>M</italic> of VAFs of size <italic>n</italic>×<italic>s</italic>, where <italic>n</italic> is the number of SSNVs in this group and <italic>s</italic> is the number of represented samples (for example, <italic>s</italic>=3 for a group with the profile 0110001). The expectation-maximization clustering algorithm for Gaussian mixture models is run on the resulting VAF matrix <italic>M</italic> using [<xref ref-type="bibr" rid="CR43">43</xref>]. The result is a set of SSNV clusters with an associated VAF centroid vector, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {\overline {VAF}}$\end{document}</tex-math><mml:math id="M10"><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="13059_2015_647_Article_IEq3.gif"/></alternatives></inline-formula>. To handle the high variance in the VAF data due to noise, some of the resulting clusters are eliminated (based on size) or collapsed with neighboring clusters, based on the distance between their centroid vectors.</p>
    </sec>
    <sec id="Sec11">
      <title>Evolutionary constraint network construction</title>
      <p>Given the clusters of each SSNV group, we construct an evolutionary constraint network to capture valid evolutionary timing relationships between the mutations of each cluster pair. The network is a DAG, where each node corresponds to an SSNV cluster (except the root, which represents the germ line) and each edge between two nodes, (<italic>u</italic>→<italic>v</italic>) denotes that parent node <italic>u</italic> could be an evolutionary predecessor of child node <italic>v</italic> (that is, that SSNVs in cluster <italic>u</italic> could have ‘happened before’ SSNVs in cluster <italic>v</italic>). In particular, an edge (<italic>u</italic>→<italic>v</italic>) is added only if the nodes satisfy the following two constraints ∀<italic>i</italic>∈samples (which guarantee that the network will be acyclic): 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{array}{l} (1)\enspace u.\mathrm{\overline{VAF}}_{i} \geq v.\mathrm{\overline{VAF}}_{i} - \epsilon_{uv} \text{ and} \\ (2)\enspace \text{if } u.\mathrm{\overline{VAF}}_{i} = 0, \quad v.\mathrm{\overline{VAF}}_{i} = 0,\\ \end{array}  $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mi>u.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">uv</mml:mtext></mml:mrow></mml:msub><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mtext>if</mml:mtext><mml:mi>u.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="13059_2015_647_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>ε</italic><sub><italic>uv</italic></sub> is the VAF noise error margin (note, the error margin is the maximum of the sum of the standard errors for sample <italic>i</italic> of the two clusters and a configurable parameter). In the resulting network, each node will have at least one parent (since all nodes can be connected to the root). We avoid checking all node pairs, by organizing the nodes into levels according to the Hamming weight (that is, the number of 1’s) of the binary group profile to which they belong. Nodes that are in the same level and have conflicting binary profiles cannot satisfy the above constraints. Nodes from different levels can only be connected such that the node in the higher level is the parent of the node in the lower level. Finally, for nodes that are in the same level and have the same binary profile, the edge is added in the direction that minimizes VAF<sub>ERR</sub>, where: 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \text{VAF}_{\text{ERR}_{u \rightarrow v}} = \sum_{i \in \text{ samples}}{\textbf{1}_{\text{ERR}_{u \rightarrow v}}(i) \cdot (v.\mathrm{\overline{VAF}}_{i} - u.\mathrm{\overline{VAF}}_{i})^{2}}  $$ \end{document}</tex-math><mml:math id="M14"><mml:mspace width="-3.0pt"/><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>ERR</mml:mtext></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>samples</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">1</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>ERR</mml:mtext></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>u.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2015_647_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>with the indicator function: 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \textbf{1}_{\text{ERR}_{u \rightarrow v}} (i) = \left\{ \begin{array}{l} 1, \quad v.\mathrm{\overline{VAF}}_{i} &gt; u.\mathrm{\overline{VAF}}_{i}, \\ 0, \quad \text{otherwise}. \end{array} \right.  $$ \end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mtext mathvariant="bold">1</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>ERR</mml:mtext></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>u.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>otherwise</mml:mtext><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2015_647_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref> illustrates the constraint network produced for the dataset of ccRCC patient EV007 (described in ‘<xref rid="Sec2" ref-type="sec">Results and discussion</xref>’).
<fig id="Fig6"><label>Figure 6</label><caption><p>Evolutionary constraint network for patient EV007 with 8 tumor samples and 55 SSNVs. Each node is associated with the binary profile of its corresponding SSNV group, the VAF centroid vector, and the number of SSNVs assigned to it. The edges represent the potential precedence relationships between the node SSNVs. The spanning tree reported for patient EV007 is highlighted (see ‘<xref rid="Sec2" ref-type="sec">Results and discussion</xref>’). GL, germ line; SSNV, somatic single nucleotide variant; VAF, variant allele frequency.</p></caption><graphic xlink:href="13059_2015_647_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Phylogenetic tree search</title>
      <p>By the constraint network construction, a valid lineage tree <italic>T</italic> of the SSNV clusters (that is, a tree that does not violate the three constraints of the perfect phylogeny model) must be a spanning tree of the network that satisfies the following requirement ∀ nodes <italic>u</italic>∈<italic>T</italic>: 
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \forall i \in \mathrm{samples \enspace :} \sum_{v \text{s.t.}(u \rightarrow v) \in T}{v.\mathrm{\overline{VAF}}_{i}} \leq u.\mathrm{\overline{VAF}}_{i}+ \epsilon.  $$ \end{document}</tex-math><mml:math id="M18"><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathvariant="normal"><mml:mtext mathvariant="italic">samples</mml:mtext><mml:mo>:</mml:mo></mml:mstyle><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mtext>s.t.</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>u.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ε.</mml:mi></mml:math><graphic xlink:href="13059_2015_647_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>That is, the sum of the VAF centroids of all the children must not exceed the centroid of the parent. We use inequality here since our method does not require all the true lineage branches to have been observed. To tolerate noise in the VAF data, we relax the constraint by allowing the sum of children VAFs to exceed the parent by an error margin <italic>ε</italic>. Given such a valid lineage tree, each sample can then be decomposed into subpopulations by enumerating all the paths in the tree starting with the germ-line root and ending in the last node containing mutations in that sample.</p>
      <p>The problem of finding all such trees is equivalent to the problem of finding <italic>all spanning trees</italic> of the constraint network DAG for which Eq. (<xref rid="Equ5" ref-type="">5</xref>) holds. We have extended the Gabow and Myers spanning tree search algorithm [<xref ref-type="bibr" rid="CR44">44</xref>] to generate all such spanning trees. The original algorithm generates all spanning trees of a directed graph using backtracking and an efficient bridge edge detection method based on depth-first search (DFS). Our extension consists of enforcing Eq. (<xref rid="Equ5" ref-type="">5</xref>) during the tree search by terminating the expansion of a given tree and backtracking as soon as an edge violating Eq. (<xref rid="Equ5" ref-type="">5</xref>) is added (see Algorithm 1). Same as the original algorithm, this search runs in <italic>O</italic>(|<italic>V</italic>|+|<italic>E</italic>|+|<italic>E</italic>|<italic>N</italic>) time, where |<italic>V</italic>| is the number of nodes, |<italic>E</italic>| is the number of edges, and <italic>N</italic> is the number of spanning trees in the network. While the runtime of the program depends on the number of spanning trees in the constraint network, in practice the search is very fast (taking of the order of a few seconds). However, since, in theory, it is possible for the algorithm to take longer on datasets that result in constraint networks with many spanning trees, we provide a bound on the maximum number of lineage trees to generate to avoid searches that are too long. Similarly, we also have a high bound on the number of calls to the GROW procedure in Algorithm 1. We expect these scenarios to be very rare in typical validation datasets. To reduce the search space, we also optionally constrain the placement of private mutation nodes in the constraint network to their closest valid predecessors.</p>
      <p>
        <inline-graphic xlink:href="13059_2015_647_Figa_HTML.gif" id="d30e3083"/>
      </p>
      <p>The above search algorithm will find all spanning trees for which Eq. (<xref rid="Equ5" ref-type="">5</xref>) holds locally at each individual node; however, it is possible that to satisfy this constraint, the centroid values are deviated (within <italic>ε</italic>) in a globally inconsistent way. Therefore, to enforce consistency, we apply one additional requirement to the trees returned by the search. In particular, we formulate the following quadratic programming (QP) problem to find a set of <italic>e</italic><sub><italic>v</italic>,<italic>i</italic></sub> such that for every sample <italic>i</italic> and node <italic>v</italic>:
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{array}{l} \text{minimize} \sum_{v} \sum_{i} e_{v,i}^{2} \\ \text{subject to} \\ \sum_{v \text{ s.t.} (u \rightarrow v) \in T} \left({v.\mathrm{\overline{VAF}}_{i}} + e_{v,i} \right) \leq u.\overline{\text{VAF}_{i}} + e_{u,i} \text{ and} \\ |e_{v,i}| \leq \epsilon, e_{v,i} \leq v.\overline{\text{VAF}_{i}} \end{array}  $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>minimize</mml:mtext><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>subject to</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mtext>s.t.</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>→</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>v.</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">VAF</mml:mtext></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mi>u.</mml:mi><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>v.</mml:mi><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mtext>VAF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_647_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>If no solution exists, the tree is considered invalid. Since multiple valid lineage trees can be generated, we rank them using the resulting <italic>e</italic><sub><italic>v</italic>,<italic>i</italic></sub> solution, which corresponds to how well each tree fits the VAF data. The top-ranking tree will be the tree with the minimum sum of squared deviations: <inline-formula id="IEq4"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{v} \sum _{i} e_{v,i}^{2}$\end{document}</tex-math><mml:math id="M22"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_647_Article_IEq4.gif"/></alternatives></inline-formula>. Since for certain networks the total number of valid lineage trees can be large, it is impractical to run a QP program on each tree. Therefore, we first rank the trees based on the sum of squared deviations computed locally at each node, and then run QP on the resulting top <italic>k</italic> trees.</p>
      <p>Multiple lineage trees can support a dataset equally well since the placement of certain nodes in the tree may be ambiguous using perfect phylogeny SSNV ordering constraints only (especially when not all lineage branches have been observed). In these cases, more sophisticated custom evaluation criteria would be required to rank the trees. We do not address defining such criteria in this work. Instead we report all the produced trees to the user ranked by their associated score (the number of trees reported is configurable) and provide a GUI to allow the user to easily explore the differences in the topologies (see ‘<xref rid="Sec13" ref-type="sec">Visualization</xref>’ for details). We expect that under any optimality criteria, the suboptimal trees can also represent signals in the data of potential biological significance.</p>
      <p>It is also possible that no valid lineage trees are found during the search. This can happen if the noise error margin is too narrow or the network contains nodes corresponding to SSNV groups with a misclassified binary profile. In this case, the network is adjusted and searched again. Currently the network adjustment procedure will remove one by one all the nodes that belong to non-robust SSNV groups (smallest nodes first). Other adjustments, such as increasing the noise error margin, are also possible but not currently implemented.</p>
    </sec>
    <sec id="Sec13">
      <title>Visualization</title>
      <p>The constraint network and the phylogenetic trees can be visualized and interacted with in GUI form. The JUNG graph library [<xref ref-type="bibr" rid="CR45">45</xref>] is used to generate the resulting graphs. When visualizing lineage trees, each input sample appears as a leaf in the tree and is connected to the nodes that contain SSNVs present in the sample. By clicking on the nodes of a tree, it is possible to obtain additional information about each node. The information displayed about an internal (non-sample) tree node consists of its binary group profile, its cluster centroid and standard deviation vectors, and the list of the SSNVs in its cluster (these SSNVs can be annotated with information from public databases such as COSMIC, TCGA, etc.). If a sample leaf node is clicked, the information displayed consists of the lineage of this specific sample obtained by doing a DFS traversal of the tree starting with the germ-line root. Finally, the user can rearrange the nodes in the tree, as well as remove nodes and collapse nodes (provided they are clusters of the same group). See Figures <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig8" ref-type="fig">8</xref> for several examples. In addition to the GUI, the program reports the number of trees found and the score of the highest-ranking tree. The user can control how many trees to display.
<fig id="Fig7"><label>Figure 7</label><caption><p>LICHeE graphical user interface output for top lineage tree of ccRCC patient RK26 with node selection. Information is displayed about the SSNV members of the selected node. ccRCC, clear-cell renal cell carcinoma; SSNV, somatic single nucleotide variant; Stdev, standard deviation; VAF, variant allele frequency.</p></caption><graphic xlink:href="13059_2015_647_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Figure 8</label><caption><p>LICHeE graphical user interface output for top lineage tree of ccRCC patient RK26 with sample selection. Information is displayed about the sample composition. ccRCC, clear-cell renal cell carcinoma.</p></caption><graphic xlink:href="13059_2015_647_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Implementation</title>
      <p>The LICHeE algorithm was implemented in Java. It is open source and freely available online at [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13059_2015_647_MOESM1_ESM.zip" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Evaluation of Phylosub.</bold> Performance evaluation of the Phylosub [<xref ref-type="bibr" rid="CR29">29</xref>] program on the ccRCC dataset.</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13059_2015_647_MOESM2_ESM.pdf" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p><bold>Experimental details of the ccRCC, HGSC, and xenoengraftment comparison.</bold> It includes a description of the dataset and LICHeE parameter settings.</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13059_2015_647_MOESM3_ESM.xlsx" id="MOESM3">
            <label>Additional file 3</label>
            <caption>
              <p>
                <bold>Detailed simulation results.</bold>
              </p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AD</term>
        <def>
          <p>ancestor–descendant</p>
        </def>
      </def-item>
      <def-item>
        <term>ccRCC</term>
        <def>
          <p>clear-cell renal cell carcinoma</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p>copy number variant</p>
        </def>
      </def-item>
      <def-item>
        <term>Corr</term>
        <def>
          <p>correctly ordered</p>
        </def>
      </def-item>
      <def-item>
        <term>Cov</term>
        <def>
          <p>coverage</p>
        </def>
      </def-item>
      <def-item>
        <term>CP</term>
        <def>
          <p>cell prevalence</p>
        </def>
      </def-item>
      <def-item>
        <term>DAG</term>
        <def>
          <p>directed acyclic graph</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p>graphical user interface</p>
        </def>
      </def-item>
      <def-item>
        <term>HGSC</term>
        <def>
          <p>high-grade serous ovarian cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>Ord</term>
        <def>
          <p>ordered</p>
        </def>
      </def-item>
      <def-item>
        <term>QP</term>
        <def>
          <p>quadratic programming</p>
        </def>
      </def-item>
      <def-item>
        <term>Sib</term>
        <def>
          <p>sibling</p>
        </def>
      </def-item>
      <def-item>
        <term>SSNV</term>
        <def>
          <p>somatic single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p>variant allele frequency</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>SB is a founding advisor of DNAnexus Inc, and member of the Scientific Advisory Boards of 23andMe and Eve Biomedical.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>VP, RS, and SB developed the method. VP implemented the LICHeE program and simulator and drafted the manuscript. RS, SB, DK, and IH contributed to the manuscript. VP, RS, and SB performed the evaluation and analysis. All authors were involved in discussions. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Arend Sidow for valuable discussions and Aaron C Abajian for contributing to the simulation studies. VP was supported by the Stanford-KAUST grant. RS and IH were also supported by Natural Sciences and Engineering Research Council of Canada (NSERC) Postdoctoral Fellowships. DK was supported by an STMicroelectronics Stanford Graduate Fellowship. This work was funded by a grant from KAUST to SB.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yates</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Evolution of the cancer genome</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>795</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3317</pub-id>
        <?supplied-pmid 23044827?>
        <pub-id pub-id-type="pmid">23044827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marusyk</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Almendro</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Polyak</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Intra-tumour heterogeneity: a looking glass for cancer?</article-title>
        <source>Nat Rev Cancer</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>323</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc3261</pub-id>
        <?supplied-pmid 22513401?>
        <pub-id pub-id-type="pmid">22513401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pettett</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dogan</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cosmic (catalogue of somatic mutations in cancer) database and website</article-title>
        <source>Br J Cancer</source>
        <year>2004</year>
        <volume>91</volume>
        <fpage>355</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 15188009?>
        <pub-id pub-id-type="pmid">15188009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Mapping the cancer genome</article-title>
        <source>Sci Am</source>
        <year>2007</year>
        <volume>296</volume>
        <fpage>50</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/scientificamerican0307-50</pub-id>
        <?supplied-pmid 17348159?>
        <pub-id pub-id-type="pmid">17348159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pusztai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cancer heterogeneity: implications for targeted therapeutics</article-title>
        <source>Br J Cancer</source>
        <year>2013</year>
        <volume>108</volume>
        <fpage>479</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1038/bjc.2012.581</pub-id>
        <?supplied-pmid 23299535?>
        <pub-id pub-id-type="pmid">23299535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Becq</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Humphray</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alexa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clifford</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>
        <source>Blood</source>
        <year>2012</year>
        <volume>120</volume>
        <fpage>4191</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2012-05-433540</pub-id>
        <?supplied-pmid 22915640?>
        <pub-id pub-id-type="pmid">22915640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newburger</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Kashef-Haghighi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sweeney</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Brunner</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome evolution during progression to breast cancer</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>1097</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.151670.112</pub-id>
        <?supplied-pmid 23568837?>
        <pub-id pub-id-type="pmid">23568837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Helman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zack</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Absolute quantification of somatic DNA alterations in human cancer</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>413</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2203</pub-id>
        <?supplied-pmid 22544022?>
        <pub-id pub-id-type="pmid">22544022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Pleasance</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dicks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rance</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Goodhead</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Subclonal phylogenetic structures in cancer revealed by ultra-deep sequencing</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>13081</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0801523105</pub-id>
        <?supplied-pmid 18723673?>
        <pub-id pub-id-type="pmid">18723673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Greenman</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>KW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The life history of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <fpage>994</fpage>
        <lpage>1007</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.023</pub-id>
        <?supplied-pmid 22608083?>
        <pub-id pub-id-type="pmid">22608083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goya</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oloumi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The clonal and mutational evolution spectrum of primary triple-negative breast cancers</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>395</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22495314?>
        <pub-id pub-id-type="pmid">22495314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pyclone: statistical inference of clonal population structure in cancer</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>396</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id>
        <?supplied-pmid 24633410?>
        <pub-id pub-id-type="pmid">24633410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oesper</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mahmoody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>THetA: inferring intra-tumor heterogeneity from high-throughput DNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-7-r80</pub-id>
        <?supplied-pmid 23895164?>
        <pub-id pub-id-type="pmid">23895164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>LM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Titan: inference of copy number architectures in clonal cell populations from tumor whole-genome sequence data</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1881</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.180281.114</pub-id>
        <?supplied-pmid 25060187?>
        <pub-id pub-id-type="pmid">25060187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mahmoody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>78</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu284</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>506</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10738</pub-id>
        <?supplied-pmid 22237025?>
        <pub-id pub-id-type="pmid">22237025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landau</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Stojanov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stevenson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution and impact of subclonal mutations in chronic lymphocytic leukemia</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>152</volume>
        <fpage>714</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.01.019</pub-id>
        <?supplied-pmid 23415222?>
        <pub-id pub-id-type="pmid">23415222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McFadden</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Papagiannakopoulos</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic and clonal dissection of murine small cell lung carcinoma progression by genome sequencing</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>156</volume>
        <fpage>1298</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.02.031</pub-id>
        <?supplied-pmid 24630729?>
        <pub-id pub-id-type="pmid">24630729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Yachida</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mudie</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Pleasance</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Stebbings</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and dynamics of genomic instability in metastatic pancreatic cancer</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>1109</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09460</pub-id>
        <?supplied-pmid 20981101?>
        <pub-id pub-id-type="pmid">20981101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yachida</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bozic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Antal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Leary</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distant metastasis occurs late during the genetic evolution of pancreatic cancer</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>1114</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09515</pub-id>
        <?supplied-pmid 20981102?>
        <pub-id pub-id-type="pmid">20981102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Horswell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rowan</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Salm</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Varela</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <fpage>225</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2891</pub-id>
        <?supplied-pmid 24487277?>
        <pub-id pub-id-type="pmid">24487277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Irish</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kihira</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hierarchy in somatic mutations arising during genomic evolution and progression of follicular lymphoma</article-title>
        <source>Blood</source>
        <year>2013</year>
        <volume>121</volume>
        <fpage>1604</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2012-09-457283</pub-id>
        <?supplied-pmid 23297126?>
        <pub-id pub-id-type="pmid">23297126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bruin</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>McGranahan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mitter</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial and temporal diversity in genomic instability processes defines lung cancer evolution</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>251</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1253462</pub-id>
        <?supplied-pmid 25301630?>
        <pub-id pub-id-type="pmid">25301630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Reconstructing mutational history in multiply sampled tumors using perfect phylogeny mixtures</article-title>
        <source>Algorithms in bioinformatics</source>
        <year>2014</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Saleh</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Kashef-Haghighi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Khavari</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Newburger</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inference of tumor phylogenies with improved somatic mutation discovery</article-title>
        <source>J Comput Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>933</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2013.0106</pub-id>
        <?supplied-pmid 24195709?>
        <pub-id pub-id-type="pmid">24195709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rowan</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Horswell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Endesfelder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gronroos</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>
        <source>N Engl J Med</source>
        <year>2012</year>
        <volume>366</volume>
        <fpage>883</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1113205</pub-id>
        <?supplied-pmid 22397650?>
        <pub-id pub-id-type="pmid">22397650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bashashati</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct evolutionary trajectories of primary high-grade serous ovarian cancers revealed through spatial mutational profiling</article-title>
        <source>J Pathol</source>
        <year>2013</year>
        <volume>231</volume>
        <fpage>21</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1002/path.4230</pub-id>
        <?supplied-pmid 23780408?>
        <pub-id pub-id-type="pmid">23780408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Jazaeri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Verhaak</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Subcloneseeker: a computational framework for reconstructing tumor clone structure for cancer variant interpretation and prioritization</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>443</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0443-x</pub-id>
        <?supplied-pmid 25160522?>
        <pub-id pub-id-type="pmid">25160522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-35</pub-id>
        <?supplied-pmid 24484323?>
        <pub-id pub-id-type="pmid">24484323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PhyloWGS: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id>
        <?supplied-pmid 25786235?>
        <pub-id pub-id-type="pmid">25786235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Donmez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1349</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv003</pub-id>
        <?supplied-pmid 25568283?>
        <pub-id pub-id-type="pmid">25568283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eirew</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Farahani</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamics of genomic clones in breast cancer patient xenografts at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>518</volume>
        <fpage>422</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13952</pub-id>
        <?supplied-pmid 25470049?>
        <pub-id pub-id-type="pmid">25470049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">LICHeE Github Repository. <ext-link ext-link-type="uri" xlink:href="http://viq854.github.io/lichee/">http://viq854.github.io/lichee/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for inferring evolutionary trees</article-title>
        <source>Networks</source>
        <year>1991</year>
        <volume>21</volume>
        <fpage>19</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1002/net.3230210104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rechsteiner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wild</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schraml</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moch</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reliable detection of subclonal single-nucleotide variants in tumour cell populations</article-title>
        <source>Nat Commun</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>811</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms1814</pub-id>
        <?supplied-pmid 22549840?>
        <pub-id pub-id-type="pmid">22549840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alakus</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Matsui</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schwab</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jepsen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Frazer</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutascope: sensitive detection of somatic mutations from deep amplicon sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1908</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt305</pub-id>
        <?supplied-pmid 23712659?>
        <pub-id pub-id-type="pmid">23712659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Abbott</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Dooling</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somaticsniper: identification of somatic point mutations in whole genome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>311</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr665</pub-id>
        <?supplied-pmid 22155872?>
        <pub-id pub-id-type="pmid">22155872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Varscan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>568</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id>
        <?supplied-pmid 22300766?>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saunders</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Swamy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Becq</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Cheetham</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strelka: accurate somatic small-variant calling from sequenced tumor–normal sample pairs</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1811</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts271</pub-id>
        <?supplied-pmid 22581179?>
        <pub-id pub-id-type="pmid">22581179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nordgard</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Lingjærde</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Russnes</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Rye</surname>
            <given-names>IH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Allele-specific copy number analysis of tumors</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>16910</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1009843107</pub-id>
        <?supplied-pmid 20837533?>
        <pub-id pub-id-type="pmid">20837533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greaves</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Clonal evolution in cancer</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>306</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10762</pub-id>
        <?supplied-pmid 22258609?>
        <pub-id pub-id-type="pmid">22258609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Gerlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Pusztai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Intratumor heterogeneity: seeing the wood for the trees</article-title>
        <source>Sci Transl Med</source>
        <year>2012</year>
        <volume>4</volume>
        <fpage>127ps10</fpage>
        <?supplied-pmid 22461637?>
        <pub-id pub-id-type="pmid">22461637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pfahringer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reutemann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>IH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The WEKA data mining software: an update</article-title>
        <source>ACM SIGKDD Explorations Newsl</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>10</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1145/1656274.1656278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabow</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Finding all spanning trees of directed and undirected graphs</article-title>
        <source>SIAM J Comput</source>
        <year>1978</year>
        <volume>7</volume>
        <fpage>280</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1137/0207024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Madadhain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boey</surname>
            <given-names>YB</given-names>
          </name>
        </person-group>
        <article-title>Analysis and visualization of network data using JUNG</article-title>
        <source>J Stat Soft</source>
        <year>2005</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>35</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
